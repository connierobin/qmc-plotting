Rank =    0  Free Memory = 53993 MB
Rank =    1  Free Memory = 53987 MB
Rank =    2  Free Memory = 53986 MB
Rank =    3  Free Memory = 53986 MB
Rank =    4  Free Memory = 53986 MB
Rank =    5  Free Memory = 53986 MB
Rank =    6  Free Memory = 53986 MB
Rank =    7  Free Memory = 53986 MB
Rank =    8  Free Memory = 53986 MB
Rank =    9  Free Memory = 53986 MB
Rank =   10  Free Memory = 53986 MB
Rank =   11  Free Memory = 53986 MB
Rank =   12  Free Memory = 53986 MB
Rank =   13  Free Memory = 53985 MB
Rank =   14  Free Memory = 53985 MB
Rank =   15  Free Memory = 53971 MB
Rank =   16  Free Memory = 53967 MB
Rank =   17  Free Memory = 53967 MB
Rank =   18  Free Memory = 53967 MB
Rank =   19  Free Memory = 53967 MB
Rank =   20  Free Memory = 53967 MB
Rank =   21  Free Memory = 53967 MB
Rank =   22  Free Memory = 53967 MB
Rank =   23  Free Memory = 53967 MB
Rank =   24  Free Memory = 59263 MB
Rank =   25  Free Memory = 59263 MB
Rank =   26  Free Memory = 59263 MB
Rank =   27  Free Memory = 59263 MB
Rank =   28  Free Memory = 59263 MB
Rank =   29  Free Memory = 59263 MB
Rank =   30  Free Memory = 59263 MB
Rank =   31  Free Memory = 59262 MB
Rank =   32  Free Memory = 59262 MB
Rank =   33  Free Memory = 59262 MB
Rank =   34  Free Memory = 59262 MB
Rank =   35  Free Memory = 59262 MB
Rank =   36  Free Memory = 59262 MB
Rank =   37  Free Memory = 59262 MB
Rank =   38  Free Memory = 59262 MB
Rank =   39  Free Memory = 59262 MB
Rank =   40  Free Memory = 59262 MB
Rank =   41  Free Memory = 59262 MB
Rank =   42  Free Memory = 59262 MB
Rank =   43  Free Memory = 59262 MB
Rank =   44  Free Memory = 59262 MB
Rank =   45  Free Memory = 59262 MB
Rank =   46  Free Memory = 59262 MB
Rank =   47  Free Memory = 59262 MB
Rank =   48  Free Memory = 55903 MB
Rank =   49  Free Memory = 55903 MB
Rank =   50  Free Memory = 55903 MB
Rank =   51  Free Memory = 55903 MB
Rank =   52  Free Memory = 55902 MB
Rank =   53  Free Memory = 55902 MB
Rank =   54  Free Memory = 55902 MB
Rank =   55  Free Memory = 55902 MB
Rank =   56  Free Memory = 55902 MB
Rank =   57  Free Memory = 55902 MB
Rank =   58  Free Memory = 55902 MB
Rank =   59  Free Memory = 55902 MB
Rank =   60  Free Memory = 55902 MB
Rank =   61  Free Memory = 55902 MB
Rank =   62  Free Memory = 55902 MB
Rank =   63  Free Memory = 55902 MB
Rank =   64  Free Memory = 55902 MB
Rank =   65  Free Memory = 55902 MB
Rank =   66  Free Memory = 55902 MB
Rank =   67  Free Memory = 55902 MB
Rank =   68  Free Memory = 55902 MB
Rank =   69  Free Memory = 55902 MB
Rank =   70  Free Memory = 55902 MB
Rank =   71  Free Memory = 55902 MB
Rank =   72  Free Memory = 59747 MB
Rank =   73  Free Memory = 59747 MB
Rank =   74  Free Memory = 59747 MB
Rank =   75  Free Memory = 59747 MB
Rank =   76  Free Memory = 59747 MB
Rank =   77  Free Memory = 59747 MB
Rank =   78  Free Memory = 59747 MB
Rank =   79  Free Memory = 59747 MB
Rank =   80  Free Memory = 59747 MB
Rank =   81  Free Memory = 59747 MB
Rank =   82  Free Memory = 59747 MB
Rank =   83  Free Memory = 59747 MB
Rank =   84  Free Memory = 59747 MB
Rank =   85  Free Memory = 59747 MB
Rank =   86  Free Memory = 59747 MB
Rank =   87  Free Memory = 59746 MB
Rank =   88  Free Memory = 59746 MB
Rank =   89  Free Memory = 59746 MB
Rank =   90  Free Memory = 59746 MB
Rank =   91  Free Memory = 59741 MB
Rank =   92  Free Memory = 59740 MB
Rank =   93  Free Memory = 59740 MB
Rank =   94  Free Memory = 59740 MB
Rank =   95  Free Memory = 59740 MB
  Input file(s): opt_h2o_1b1_gvptt_509dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_509dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 14:20:30 PDT
  host    = n0058.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 30

  Range of prime numbers to use as seeds over processors and threads = 131-719


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.098831e-01    1         1  ON     0
     uu_1                 1.445451e-01    1         1  ON     1
     uu_2                 4.574607e-02    1         1  ON     2
     uu_3                -1.717557e-02    1         1  ON     3
     uu_4                -6.522330e-02    1         1  ON     4
     uu_5                -9.998932e-02    1         1  ON     5
     uu_6                -1.260069e-01    1         1  ON     6
     uu_7                -1.383843e-01    1         1  ON     7
     uu_8                -1.305255e-01    1         1  ON     8
     uu_9                -9.849651e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.279526e-01    1         1  ON     0
     ud_1                 1.728364e-01    1         1  ON     1
     ud_2                 6.205952e-02    1         1  ON     2
     ud_3                -4.765048e-03    1         1  ON     3
     ud_4                -5.994839e-02    1         1  ON     4
     ud_5                -1.015493e-01    1         1  ON     5
     ud_6                -1.300997e-01    1         1  ON     6
     ud_7                -1.482468e-01    1         1  ON     7
     ud_8                -1.517639e-01    1         1  ON     8
     ud_9                -1.405610e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.461843e-01    1         1  ON     0
     eO_1                -4.327626e-01    1         1  ON     1
     eO_2                -1.845826e-02    1         1  ON     2
     eO_3                 2.981615e-01    1         1  ON     3
     eO_4                 5.167902e-01    1         1  ON     4
     eO_5                 4.709097e-01    1         1  ON     5
     eO_6                 2.409283e-01    1         1  ON     6
     eO_7                -5.378139e-02    1         1  ON     7
     eO_8                -2.094878e-01    1         1  ON     8
     eO_9                -6.753627e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.420018e-01    1         1  ON     0
     eH1_1                -1.379308e-01    1         1  ON     1
     eH1_2                -9.593171e-02    1         1  ON     2
     eH1_3                -4.424782e-02    1         1  ON     3
     eH1_4                 1.212424e-02    1         1  ON     4
     eH1_5                 4.908186e-02    1         1  ON     5
     eH1_6                 1.057297e-01    1         1  ON     6
     eH1_7                 1.512600e-01    1         1  ON     7
     eH1_8                 1.602275e-01    1         1  ON     8
     eH1_9                 4.548746e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.405783e-01    1         1  ON     0
     eH2_1                -1.368982e-01    1         1  ON     1
     eH2_2                -9.455254e-02    1         1  ON     2
     eH2_3                -4.289453e-02    1         1  ON     3
     eH2_4                 1.347347e-02    1         1  ON     4
     eH2_5                 5.133490e-02    1         1  ON     5
     eH2_6                 1.082985e-01    1         1  ON     6
     eH2_7                 1.564588e-01    1         1  ON     7
     eH2_8                 1.705159e-01    1         1  ON     8
     eH2_9                 3.170771e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 509 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.987784e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 94 unique up determinants.
Found 94 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6227e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9903
    reference variance = 0.486929
====================================================
  Execution time = 3.7348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4305e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7627e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342991728440
                                         uncertainty =       0.004859637308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342991728440
                                         uncertainty =       0.004859637308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414150185
  error estimate for blocks of size 2^( 2) =       0.000425961415
  error estimate for blocks of size 2^( 3) =       0.000437494351
  error estimate for blocks of size 2^( 4) =       0.000449154153
  error estimate for blocks of size 2^( 5) =       0.000460327938
  error estimate for blocks of size 2^( 6) =       0.000468620574
  error estimate for blocks of size 2^( 7) =       0.000473246399

      target function =                  N/A
              le_mean =     -16.909857599952
             les_mean =     286.286335608258
             stat err =       0.000462837266
             autocorr =       1.248938113610
              std dev =       0.585706179858
             le_variance =       0.343051729124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690985759995e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909857599952       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909867275975       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909876377719       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909879946871       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909885119750       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909886700350       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909884834626       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909884334535       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909884953939       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909885036543       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909885537470       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909885551482       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.740279e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909857599952       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909861367920       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909865491214       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909868074898       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909869115776       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909868699296       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909868643252       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909868428863       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909868449440       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909868436049       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.933407e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909857599952       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909858694544       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909859991828       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909860889394       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909860954864       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909861008460       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909860871929       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909860861167       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909860845364       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.675161e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7220e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.095296e-01                 1 1 ON  0
uu_1  1.442807e-01                 1 1 ON  1
uu_2  4.591029e-02                 1 1 ON  2
uu_3  -1.687320e-02                1 1 ON  3
uu_4  -6.510141e-02                1 1 ON  4
uu_5  -1.000046e-01                1 1 ON  5
uu_6  -1.260909e-01                1 1 ON  6
uu_7  -1.383973e-01                1 1 ON  7
uu_8  -1.305220e-01                1 1 ON  8
uu_9  -9.853976e-02                1 1 ON  9
ud_0  4.285460e-01                 1 1 ON  10
ud_1  1.732170e-01                 1 1 ON  11
ud_2  6.180628e-02                 1 1 ON  12
ud_3  -5.123590e-03                1 1 ON  13
ud_4  -6.002713e-02                1 1 ON  14
ud_5  -1.016317e-01                1 1 ON  15
ud_6  -1.301487e-01                1 1 ON  16
ud_7  -1.484261e-01                1 1 ON  17
ud_8  -1.517824e-01                1 1 ON  18
ud_9  -1.405397e-01                1 1 ON  19
eO_0  -7.467435e-01                1 1 ON  20
eO_1  -4.330529e-01                1 1 ON  21
eO_2  -1.810171e-02                1 1 ON  22
eO_3  2.985322e-01                 1 1 ON  23
eO_4  5.169930e-01                 1 1 ON  24
eO_5  4.710691e-01                 1 1 ON  25
eO_6  2.409228e-01                 1 1 ON  26
eO_7  -5.378676e-02                1 1 ON  27
eO_8  -2.095968e-01                1 1 ON  28
eO_9  -6.764343e-02                1 1 ON  29
eH1_0 -2.423471e-01                1 1 ON  30
eH1_1 -1.380798e-01                1 1 ON  31
eH1_2 -9.603043e-02                1 1 ON  32
eH1_3 -4.440680e-02                1 1 ON  33
eH1_4 1.210972e-02                 1 1 ON  34
eH1_5 4.902493e-02                 1 1 ON  35
eH1_6 1.059203e-01                 1 1 ON  36
eH1_7 1.514765e-01                 1 1 ON  37
eH1_8 1.604127e-01                 1 1 ON  38
eH1_9 4.567458e-02                 1 1 ON  39
eH2_0 -2.408535e-01                1 1 ON  40
eH2_1 -1.368789e-01                1 1 ON  41
eH2_2 -9.472850e-02                1 1 ON  42
eH2_3 -4.310407e-02                1 1 ON  43
eH2_4 1.352533e-02                 1 1 ON  44
eH2_5 5.139179e-02                 1 1 ON  45
eH2_6 1.083722e-01                 1 1 ON  46
eH2_7 1.565187e-01                 1 1 ON  47
eH2_8 1.706805e-01                 1 1 ON  48
eH2_9 3.192572e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9473
    reference variance = 0.330257
====================================================
  Execution time = 3.6588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3918e-01
  Total weights = 2.0001e+06
  Execution time = 4.5124e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338973530001
                                         uncertainty =       0.003625031025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338973530001
                                         uncertainty =       0.003625031025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411658421
  error estimate for blocks of size 2^( 2) =       0.000423820871
  error estimate for blocks of size 2^( 3) =       0.000436563822
  error estimate for blocks of size 2^( 4) =       0.000448233388
  error estimate for blocks of size 2^( 5) =       0.000457968134
  error estimate for blocks of size 2^( 6) =       0.000466722753
  error estimate for blocks of size 2^( 7) =       0.000472376503

      target function =                  N/A
              le_mean =     -16.909896534470
             les_mean =     286.283536794371
             stat err =       0.000461325195
             autocorr =       1.255857427908
              std dev =       0.582182237249
             le_variance =       0.338936157369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339723500175
                                         uncertainty =       0.003645112427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339723500175
                                         uncertainty =       0.003645112427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412113687
  error estimate for blocks of size 2^( 2) =       0.000424236096
  error estimate for blocks of size 2^( 3) =       0.000436940007
  error estimate for blocks of size 2^( 4) =       0.000448570362
  error estimate for blocks of size 2^( 5) =       0.000458279358
  error estimate for blocks of size 2^( 6) =       0.000467021076
  error estimate for blocks of size 2^( 7) =       0.000472642844

      target function =                  N/A
              le_mean =     -16.909897833818
             les_mean =     286.284330831423
             stat err =       0.000461628410
             autocorr =       1.254732020251
              std dev =       0.582826089925
             le_variance =       0.339686251097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339486708985
                                         uncertainty =       0.003640738513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339486708985
                                         uncertainty =       0.003640738513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970024
  error estimate for blocks of size 2^( 2) =       0.000424098891
  error estimate for blocks of size 2^( 3) =       0.000436812785
  error estimate for blocks of size 2^( 4) =       0.000448451946
  error estimate for blocks of size 2^( 5) =       0.000458173566
  error estimate for blocks of size 2^( 6) =       0.000466919121
  error estimate for blocks of size 2^( 7) =       0.000472546011

      target function =                  N/A
              le_mean =     -16.909896621377
             les_mean =     286.284053039617
             stat err =       0.000461522661
             autocorr =       1.255032075940
              std dev =       0.582622917230
             le_variance =       0.339449463681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042546168
                                         uncertainty =       0.003627343022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042546168
                                         uncertainty =       0.003627343022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411700344
  error estimate for blocks of size 2^( 2) =       0.000423857151
  error estimate for blocks of size 2^( 3) =       0.000436595519
  error estimate for blocks of size 2^( 4) =       0.000448260320
  error estimate for blocks of size 2^( 5) =       0.000457993541
  error estimate for blocks of size 2^( 6) =       0.000466746810
  error estimate for blocks of size 2^( 7) =       0.000472396310

      target function =                  N/A
              le_mean =     -16.909895565010
             les_mean =     286.283573044174
             stat err =       0.000461349245
             autocorr =       1.255732601104
              std dev =       0.582241525592
             le_variance =       0.339005194123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909896534470        initial
     2.5000e-01     2.5000e+00             1.7403e-03       -16.909897833818  <--
     1.0000e+00     1.0000e+01             5.9334e-04       -16.909896621377
     4.0000e+00     4.0000e+01             1.6752e-04       -16.909895565010

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.9142e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.089664e-01 1 1  ON 0
 uu_1                 1.440245e-01 1 1  ON 1
 uu_2                 4.609176e-02 1 1  ON 2
 uu_3                -1.643874e-02 1 1  ON 3
 uu_4                -6.487270e-02 1 1  ON 4
 uu_5                -1.000506e-01 1 1  ON 5
 uu_6                -1.263044e-01 1 1  ON 6
 uu_7                -1.385065e-01 1 1  ON 7
 uu_8                -1.305721e-01 1 1  ON 8
 uu_9                -9.868541e-02 1 1  ON 9
 ud_0                 4.296570e-01 1 1  ON 10
 ud_1                 1.738326e-01 1 1  ON 11
 ud_2                 6.163510e-02 1 1  ON 12
 ud_3                -5.695971e-03 1 1  ON 13
 ud_4                -6.031436e-02 1 1  ON 14
 ud_5                -1.018390e-01 1 1  ON 15
 ud_6                -1.302921e-01 1 1  ON 16
 ud_7                -1.488156e-01 1 1  ON 17
 ud_8                -1.518637e-01 1 1  ON 18
 ud_9                -1.404909e-01 1 1  ON 19
 eO_0                -7.479246e-01 1 1  ON 20
 eO_1                -4.337990e-01 1 1  ON 21
 eO_2                -1.758960e-02 1 1  ON 22
 eO_3                 2.994476e-01 1 1  ON 23
 eO_4                 5.176942e-01 1 1  ON 24
 eO_5                 4.715816e-01 1 1  ON 25
 eO_6                 2.409280e-01 1 1  ON 26
 eO_7                -5.381084e-02 1 1  ON 27
 eO_8                -2.099311e-01 1 1  ON 28
 eO_9                -6.796515e-02 1 1  ON 29
eH1_0                -2.432120e-01 1 1  ON 30
eH1_1                -1.385394e-01 1 1  ON 31
eH1_2                -9.640407e-02 1 1  ON 32
eH1_3                -4.481542e-02 1 1  ON 33
eH1_4                 1.194342e-02 1 1  ON 34
eH1_5                 4.888177e-02 1 1  ON 35
eH1_6                 1.064419e-01 1 1  ON 36
eH1_7                 1.521176e-01 1 1  ON 37
eH1_8                 1.609718e-01 1 1  ON 38
eH1_9                 4.623640e-02 1 1  ON 39
eH2_0                -2.415119e-01 1 1  ON 40
eH2_1                -1.370616e-01 1 1  ON 41
eH2_2                -9.515752e-02 1 1  ON 42
eH2_3                -4.357407e-02 1 1  ON 43
eH2_4                 1.347884e-02 1 1  ON 44
eH2_5                 5.155252e-02 1 1  ON 45
eH2_6                 1.086110e-01 1 1  ON 46
eH2_7                 1.567165e-01 1 1  ON 47
eH2_8                 1.711703e-01 1 1  ON 48
eH2_9                 3.257486e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0637e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6969e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1318
    reference variance = 0.673595
====================================================
  Execution time = 3.7470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3947e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450594724
                                         uncertainty =       0.004619793447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450594724
                                         uncertainty =       0.004619793447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411983567
  error estimate for blocks of size 2^( 2) =       0.000423636738
  error estimate for blocks of size 2^( 3) =       0.000436097836
  error estimate for blocks of size 2^( 4) =       0.000447940155
  error estimate for blocks of size 2^( 5) =       0.000458286802
  error estimate for blocks of size 2^( 6) =       0.000467414410
  error estimate for blocks of size 2^( 7) =       0.000472873108

      target function =                  N/A
              le_mean =     -16.909813190173
             les_mean =     286.281253737891
             stat err =       0.000461628619
             autocorr =       1.255525864915
              std dev =       0.582642069444
             le_variance =       0.339471781086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690981319017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909813190173       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909815211041       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909815610188       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909825629738       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909828228347       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909833009227       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909832342337       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909831316776       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909830413814       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909829732618       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909829620988       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909829947092       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909829849816       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909830463053       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.716373e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909813190173       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909814409940       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909814907374       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909819037246       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909821971263       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909821426065       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909821479168       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909821374000       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909820840004       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909820518818       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909820454634       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.099960e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909813190173       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909813661916       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909813959999       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909814602822       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909815600907       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909815793531       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909815675369       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909815694653       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909815611818       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.381759e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7428e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.089440e-01 1 1  ON 0
 uu_1                 1.439408e-01 1 1  ON 1
 uu_2                 4.626098e-02 1 1  ON 2
 uu_3                -1.633494e-02 1 1  ON 3
 uu_4                -6.489802e-02 1 1  ON 4
 uu_5                -1.001030e-01 1 1  ON 5
 uu_6                -1.265399e-01 1 1  ON 6
 uu_7                -1.387623e-01 1 1  ON 7
 uu_8                -1.306130e-01 1 1  ON 8
 uu_9                -9.892386e-02 1 1  ON 9
 ud_0                 4.303281e-01 1 1  ON 10
 ud_1                 1.742989e-01 1 1  ON 11
 ud_2                 6.166439e-02 1 1  ON 12
 ud_3                -5.896364e-03 1 1  ON 13
 ud_4                -6.055303e-02 1 1  ON 14
 ud_5                -1.018399e-01 1 1  ON 15
 ud_6                -1.303769e-01 1 1  ON 16
 ud_7                -1.489960e-01 1 1  ON 17
 ud_8                -1.520682e-01 1 1  ON 18
 ud_9                -1.407135e-01 1 1  ON 19
 eO_0                -7.490246e-01 1 1  ON 20
 eO_1                -4.344795e-01 1 1  ON 21
 eO_2                -1.710101e-02 1 1  ON 22
 eO_3                 3.004753e-01 1 1  ON 23
 eO_4                 5.181517e-01 1 1  ON 24
 eO_5                 4.723391e-01 1 1  ON 25
 eO_6                 2.410153e-01 1 1  ON 26
 eO_7                -5.373130e-02 1 1  ON 27
 eO_8                -2.105262e-01 1 1  ON 28
 eO_9                -6.844642e-02 1 1  ON 29
eH1_0                -2.440859e-01 1 1  ON 30
eH1_1                -1.391830e-01 1 1  ON 31
eH1_2                -9.679358e-02 1 1  ON 32
eH1_3                -4.526950e-02 1 1  ON 33
eH1_4                 1.175959e-02 1 1  ON 34
eH1_5                 4.925845e-02 1 1  ON 35
eH1_6                 1.066815e-01 1 1  ON 36
eH1_7                 1.525045e-01 1 1  ON 37
eH1_8                 1.618153e-01 1 1  ON 38
eH1_9                 4.695557e-02 1 1  ON 39
eH2_0                -2.425906e-01 1 1  ON 40
eH2_1                -1.376195e-01 1 1  ON 41
eH2_2                -9.523735e-02 1 1  ON 42
eH2_3                -4.385465e-02 1 1  ON 43
eH2_4                 1.276825e-02 1 1  ON 44
eH2_5                 5.153606e-02 1 1  ON 45
eH2_6                 1.091874e-01 1 1  ON 46
eH2_7                 1.571185e-01 1 1  ON 47
eH2_8                 1.718507e-01 1 1  ON 48
eH2_9                 3.349863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8788
    reference variance = 0.216525
====================================================
  Execution time = 3.6556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3589e-01
  Total weights = 2.0001e+06
  Execution time = 4.4750e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660754331
                                         uncertainty =       0.003423301740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660754331
                                         uncertainty =       0.003423301740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409669017
  error estimate for blocks of size 2^( 2) =       0.000421460178
  error estimate for blocks of size 2^( 3) =       0.000434061062
  error estimate for blocks of size 2^( 4) =       0.000447305682
  error estimate for blocks of size 2^( 5) =       0.000458670248
  error estimate for blocks of size 2^( 6) =       0.000468033391
  error estimate for blocks of size 2^( 7) =       0.000477302069

      target function =                  N/A
              le_mean =     -16.910310968887
             les_mean =     286.294285044744
             stat err =       0.000462827847
             autocorr =       1.276358642246
              std dev =       0.579368749698
             le_variance =       0.335668148127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336268583516
                                         uncertainty =       0.003427137007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336268583516
                                         uncertainty =       0.003427137007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410039495
  error estimate for blocks of size 2^( 2) =       0.000421815463
  error estimate for blocks of size 2^( 3) =       0.000434392950
  error estimate for blocks of size 2^( 4) =       0.000447611203
  error estimate for blocks of size 2^( 5) =       0.000458948169
  error estimate for blocks of size 2^( 6) =       0.000468278118
  error estimate for blocks of size 2^( 7) =       0.000477500108

      target function =                  N/A
              le_mean =     -16.910310787752
             les_mean =     286.294886305769
             stat err =       0.000463084400
             autocorr =       1.275466103044
              std dev =       0.579892693121
             le_variance =       0.336275535535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336120976386
                                         uncertainty =       0.003426277233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336120976386
                                         uncertainty =       0.003426277233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409949428
  error estimate for blocks of size 2^( 2) =       0.000421726364
  error estimate for blocks of size 2^( 3) =       0.000434310333
  error estimate for blocks of size 2^( 4) =       0.000447538975
  error estimate for blocks of size 2^( 5) =       0.000458886515
  error estimate for blocks of size 2^( 6) =       0.000468222307
  error estimate for blocks of size 2^( 7) =       0.000477436762

      target function =                  N/A
              le_mean =     -16.910312384005
             les_mean =     286.294792578770
             stat err =       0.000463021140
             autocorr =       1.275678014237
              std dev =       0.579765316469
             le_variance =       0.336127822181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335721702418
                                         uncertainty =       0.003423757640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335721702418
                                         uncertainty =       0.003423757640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409706137
  error estimate for blocks of size 2^( 2) =       0.000421494310
  error estimate for blocks of size 2^( 3) =       0.000434092194
  error estimate for blocks of size 2^( 4) =       0.000447334559
  error estimate for blocks of size 2^( 5) =       0.000458696734
  error estimate for blocks of size 2^( 6) =       0.000468055451
  error estimate for blocks of size 2^( 7) =       0.000477313536

      target function =                  N/A
              le_mean =     -16.910310454340
             les_mean =     286.294328475006
             stat err =       0.000462850070
             autocorr =       1.276249921199
              std dev =       0.579421246323
             le_variance =       0.335728980690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910310968887        initial
     6.2500e-02     6.2500e-01             3.7164e-03       -16.910310787752
     2.5000e-01     2.5000e+00             1.1000e-03       -16.910312384005  <--
     1.0000e+00     1.0000e+01             3.3818e-04       -16.910310454340

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.9063e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.089440e-01 1 1  ON 0
 uu_1                 1.439408e-01 1 1  ON 1
 uu_2                 4.626098e-02 1 1  ON 2
 uu_3                -1.633494e-02 1 1  ON 3
 uu_4                -6.489802e-02 1 1  ON 4
 uu_5                -1.001030e-01 1 1  ON 5
 uu_6                -1.265399e-01 1 1  ON 6
 uu_7                -1.387623e-01 1 1  ON 7
 uu_8                -1.306130e-01 1 1  ON 8
 uu_9                -9.892386e-02 1 1  ON 9
 ud_0                 4.303281e-01 1 1  ON 10
 ud_1                 1.742989e-01 1 1  ON 11
 ud_2                 6.166439e-02 1 1  ON 12
 ud_3                -5.896364e-03 1 1  ON 13
 ud_4                -6.055303e-02 1 1  ON 14
 ud_5                -1.018399e-01 1 1  ON 15
 ud_6                -1.303769e-01 1 1  ON 16
 ud_7                -1.489960e-01 1 1  ON 17
 ud_8                -1.520682e-01 1 1  ON 18
 ud_9                -1.407135e-01 1 1  ON 19
 eO_0                -7.490246e-01 1 1  ON 20
 eO_1                -4.344795e-01 1 1  ON 21
 eO_2                -1.710101e-02 1 1  ON 22
 eO_3                 3.004753e-01 1 1  ON 23
 eO_4                 5.181517e-01 1 1  ON 24
 eO_5                 4.723391e-01 1 1  ON 25
 eO_6                 2.410153e-01 1 1  ON 26
 eO_7                -5.373130e-02 1 1  ON 27
 eO_8                -2.105262e-01 1 1  ON 28
 eO_9                -6.844642e-02 1 1  ON 29
eH1_0                -2.440859e-01 1 1  ON 30
eH1_1                -1.391830e-01 1 1  ON 31
eH1_2                -9.679358e-02 1 1  ON 32
eH1_3                -4.526950e-02 1 1  ON 33
eH1_4                 1.175959e-02 1 1  ON 34
eH1_5                 4.925845e-02 1 1  ON 35
eH1_6                 1.066815e-01 1 1  ON 36
eH1_7                 1.525045e-01 1 1  ON 37
eH1_8                 1.618153e-01 1 1  ON 38
eH1_9                 4.695557e-02 1 1  ON 39
eH2_0                -2.425906e-01 1 1  ON 40
eH2_1                -1.376195e-01 1 1  ON 41
eH2_2                -9.523735e-02 1 1  ON 42
eH2_3                -4.385465e-02 1 1  ON 43
eH2_4                 1.276825e-02 1 1  ON 44
eH2_5                 5.153606e-02 1 1  ON 45
eH2_6                 1.091874e-01 1 1  ON 46
eH2_7                 1.571185e-01 1 1  ON 47
eH2_8                 1.718507e-01 1 1  ON 48
eH2_9                 3.349863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0670e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6987e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9196
    reference variance = 0.204842
====================================================
  Execution time = 3.7552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5487e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8790e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354327495399
                                         uncertainty =       0.012817289189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354327495399
                                         uncertainty =       0.012817289189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421224187
  error estimate for blocks of size 2^( 2) =       0.000432737256
  error estimate for blocks of size 2^( 3) =       0.000445127989
  error estimate for blocks of size 2^( 4) =       0.000457092477
  error estimate for blocks of size 2^( 5) =       0.000466974346
  error estimate for blocks of size 2^( 6) =       0.000474285695
  error estimate for blocks of size 2^( 7) =       0.000478468023

      target function =                  N/A
              le_mean =     -16.910278983291
             les_mean =     286.312406102354
             stat err =       0.000469205135
             autocorr =       1.240791791717
              std dev =       0.595710489304
             le_variance =       0.354870987067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691027898329e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910278983291       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910278996947       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910287017821       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910291504976       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910295685598       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910296572848       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910297685447       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910299959523       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910300681926       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910300273032       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910301077008       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910301461711       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910300502115       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910300727289       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.477328e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910278983291       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910278991276       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910283333697       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910287363591       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910286618608       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910287604810       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910287501230       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910287602166       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910287796556       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910287680653       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910287766762       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.141544e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910278983291       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910278986291       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910280442263       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910281909399       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910282061441       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910281961308       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910281903599       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910281904287       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910281939566       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.866323e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7442e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.087257e-01 1 1  ON 0
 uu_1                 1.440333e-01 1 1  ON 1
 uu_2                 4.651735e-02 1 1  ON 2
 uu_3                -1.602818e-02 1 1  ON 3
 uu_4                -6.462612e-02 1 1  ON 4
 uu_5                -9.982316e-02 1 1  ON 5
 uu_6                -1.265666e-01 1 1  ON 6
 uu_7                -1.387989e-01 1 1  ON 7
 uu_8                -1.311388e-01 1 1  ON 8
 uu_9                -9.965515e-02 1 1  ON 9
 ud_0                 4.309722e-01 1 1  ON 10
 ud_1                 1.747845e-01 1 1  ON 11
 ud_2                 6.187270e-02 1 1  ON 12
 ud_3                -6.020147e-03 1 1  ON 13
 ud_4                -6.056674e-02 1 1  ON 14
 ud_5                -1.019762e-01 1 1  ON 15
 ud_6                -1.302744e-01 1 1  ON 16
 ud_7                -1.490713e-01 1 1  ON 17
 ud_8                -1.522648e-01 1 1  ON 18
 ud_9                -1.413098e-01 1 1  ON 19
 eO_0                -7.497230e-01 1 1  ON 20
 eO_1                -4.347589e-01 1 1  ON 21
 eO_2                -1.697969e-02 1 1  ON 22
 eO_3                 3.013018e-01 1 1  ON 23
 eO_4                 5.188803e-01 1 1  ON 24
 eO_5                 4.727719e-01 1 1  ON 25
 eO_6                 2.413972e-01 1 1  ON 26
 eO_7                -5.363591e-02 1 1  ON 27
 eO_8                -2.113778e-01 1 1  ON 28
 eO_9                -6.911587e-02 1 1  ON 29
eH1_0                -2.448968e-01 1 1  ON 30
eH1_1                -1.397280e-01 1 1  ON 31
eH1_2                -9.739570e-02 1 1  ON 32
eH1_3                -4.557876e-02 1 1  ON 33
eH1_4                 1.179215e-02 1 1  ON 34
eH1_5                 4.903232e-02 1 1  ON 35
eH1_6                 1.066386e-01 1 1  ON 36
eH1_7                 1.529115e-01 1 1  ON 37
eH1_8                 1.629568e-01 1 1  ON 38
eH1_9                 4.780816e-02 1 1  ON 39
eH2_0                -2.434514e-01 1 1  ON 40
eH2_1                -1.378373e-01 1 1  ON 41
eH2_2                -9.575470e-02 1 1  ON 42
eH2_3                -4.401705e-02 1 1  ON 43
eH2_4                 1.304377e-02 1 1  ON 44
eH2_5                 5.132233e-02 1 1  ON 45
eH2_6                 1.093858e-01 1 1  ON 46
eH2_7                 1.575128e-01 1 1  ON 47
eH2_8                 1.724474e-01 1 1  ON 48
eH2_9                 3.414540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.082557
====================================================
  Execution time = 3.8656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4158e-01
  Total weights = 2.0001e+06
  Execution time = 4.4931e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457860709
                                         uncertainty =       0.004597468187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457860709
                                         uncertainty =       0.004597468187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413178820
  error estimate for blocks of size 2^( 2) =       0.000424851154
  error estimate for blocks of size 2^( 3) =       0.000436824447
  error estimate for blocks of size 2^( 4) =       0.000447376588
  error estimate for blocks of size 2^( 5) =       0.000456830197
  error estimate for blocks of size 2^( 6) =       0.000464341506
  error estimate for blocks of size 2^( 7) =       0.000469578714

      target function =                  N/A
              le_mean =     -16.909668082369
             les_mean =     286.278318885159
             stat err =       0.000459531751
             autocorr =       1.236957982111
              std dev =       0.584332439622
             le_variance =       0.341444399995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341857173094
                                         uncertainty =       0.004591894893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341857173094
                                         uncertainty =       0.004591894893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413420574
  error estimate for blocks of size 2^( 2) =       0.000425073158
  error estimate for blocks of size 2^( 3) =       0.000437013239
  error estimate for blocks of size 2^( 4) =       0.000447525827
  error estimate for blocks of size 2^( 5) =       0.000456952734
  error estimate for blocks of size 2^( 6) =       0.000464441847
  error estimate for blocks of size 2^( 7) =       0.000469683282

      target function =                  N/A
              le_mean =     -16.909664878577
             les_mean =     286.278610215535
             stat err =       0.000459650923
             autocorr =       1.236152640621
              std dev =       0.584674337286
             le_variance =       0.341844080681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751024318
                                         uncertainty =       0.004590097992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751024318
                                         uncertainty =       0.004590097992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413356441
  error estimate for blocks of size 2^( 2) =       0.000425011992
  error estimate for blocks of size 2^( 3) =       0.000436957105
  error estimate for blocks of size 2^( 4) =       0.000447478562
  error estimate for blocks of size 2^( 5) =       0.000456912258
  error estimate for blocks of size 2^( 6) =       0.000464401682
  error estimate for blocks of size 2^( 7) =       0.000469650453

      target function =                  N/A
              le_mean =     -16.909664239651
             les_mean =     286.278482556797
             stat err =       0.000459610738
             autocorr =       1.236320058430
              std dev =       0.584583638106
             le_variance =       0.341738029941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341494610998
                                         uncertainty =       0.004595828597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341494610998
                                         uncertainty =       0.004595828597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413201121
  error estimate for blocks of size 2^( 2) =       0.000424870033
  error estimate for blocks of size 2^( 3) =       0.000436837953
  error estimate for blocks of size 2^( 4) =       0.000447384877
  error estimate for blocks of size 2^( 5) =       0.000456834941
  error estimate for blocks of size 2^( 6) =       0.000464342155
  error estimate for blocks of size 2^( 7) =       0.000469581607

      target function =                  N/A
              le_mean =     -16.909666304703
             les_mean =     286.278295625395
             stat err =       0.000459535895
             autocorr =       1.236846769798
              std dev =       0.584363978812
             le_variance =       0.341481259733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909668082369        initial  <--
     6.2500e-02     6.2500e-01             4.4773e-03       -16.909664878577
     2.5000e-01     2.5000e+00             1.1415e-03       -16.909664239651
     1.0000e+00     1.0000e+01             2.8663e-04       -16.909666304703

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2448
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.089440e-01 1 1  ON 0
 uu_1                 1.439408e-01 1 1  ON 1
 uu_2                 4.626098e-02 1 1  ON 2
 uu_3                -1.633494e-02 1 1  ON 3
 uu_4                -6.489802e-02 1 1  ON 4
 uu_5                -1.001030e-01 1 1  ON 5
 uu_6                -1.265399e-01 1 1  ON 6
 uu_7                -1.387623e-01 1 1  ON 7
 uu_8                -1.306130e-01 1 1  ON 8
 uu_9                -9.892386e-02 1 1  ON 9
 ud_0                 4.303281e-01 1 1  ON 10
 ud_1                 1.742989e-01 1 1  ON 11
 ud_2                 6.166439e-02 1 1  ON 12
 ud_3                -5.896364e-03 1 1  ON 13
 ud_4                -6.055303e-02 1 1  ON 14
 ud_5                -1.018399e-01 1 1  ON 15
 ud_6                -1.303769e-01 1 1  ON 16
 ud_7                -1.489960e-01 1 1  ON 17
 ud_8                -1.520682e-01 1 1  ON 18
 ud_9                -1.407135e-01 1 1  ON 19
 eO_0                -7.490246e-01 1 1  ON 20
 eO_1                -4.344795e-01 1 1  ON 21
 eO_2                -1.710101e-02 1 1  ON 22
 eO_3                 3.004753e-01 1 1  ON 23
 eO_4                 5.181517e-01 1 1  ON 24
 eO_5                 4.723391e-01 1 1  ON 25
 eO_6                 2.410153e-01 1 1  ON 26
 eO_7                -5.373130e-02 1 1  ON 27
 eO_8                -2.105262e-01 1 1  ON 28
 eO_9                -6.844642e-02 1 1  ON 29
eH1_0                -2.440859e-01 1 1  ON 30
eH1_1                -1.391830e-01 1 1  ON 31
eH1_2                -9.679358e-02 1 1  ON 32
eH1_3                -4.526950e-02 1 1  ON 33
eH1_4                 1.175959e-02 1 1  ON 34
eH1_5                 4.925845e-02 1 1  ON 35
eH1_6                 1.066815e-01 1 1  ON 36
eH1_7                 1.525045e-01 1 1  ON 37
eH1_8                 1.618153e-01 1 1  ON 38
eH1_9                 4.695557e-02 1 1  ON 39
eH2_0                -2.425906e-01 1 1  ON 40
eH2_1                -1.376195e-01 1 1  ON 41
eH2_2                -9.523735e-02 1 1  ON 42
eH2_3                -4.385465e-02 1 1  ON 43
eH2_4                 1.276825e-02 1 1  ON 44
eH2_5                 5.153606e-02 1 1  ON 45
eH2_6                 1.091874e-01 1 1  ON 46
eH2_7                 1.571185e-01 1 1  ON 47
eH2_8                 1.718507e-01 1 1  ON 48
eH2_9                 3.349863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0870e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6958e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 0.303007
====================================================
  Execution time = 3.7435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5288e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0063e+01
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352987557974
                                         uncertainty =       0.015083537146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352987557974
                                         uncertainty =       0.015083537146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420038082
  error estimate for blocks of size 2^( 2) =       0.000431726856
  error estimate for blocks of size 2^( 3) =       0.000443922548
  error estimate for blocks of size 2^( 4) =       0.000455171758
  error estimate for blocks of size 2^( 5) =       0.000465294781
  error estimate for blocks of size 2^( 6) =       0.000473383652
  error estimate for blocks of size 2^( 7) =       0.000480110186

      target function =                  N/A
              le_mean =     -16.909628621842
             les_mean =     286.288415225011
             stat err =       0.000468490094
             autocorr =       1.244008910634
              std dev =       0.594033057003
             le_variance =       0.352875272812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690962862184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909628621842       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909629693589       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909629951032       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909630311567       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909630749210       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909631086175       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909631277657       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909631421527       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909631314310       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.494842e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909628621842       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909628946162       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909629019335       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909629120494       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909629289894       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909629370177       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909629398441       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909629412261       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.231711e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909628621842       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909628707425       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909628726622       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909628753211       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909628801556       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909628820967       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909628826481       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909628828296       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.212835e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7507e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.089640e-01 1 1  ON 0
 uu_1                 1.439658e-01 1 1  ON 1
 uu_2                 4.630414e-02 1 1  ON 2
 uu_3                -1.628425e-02 1 1  ON 3
 uu_4                -6.488264e-02 1 1  ON 4
 uu_5                -1.001255e-01 1 1  ON 5
 uu_6                -1.265791e-01 1 1  ON 6
 uu_7                -1.388162e-01 1 1  ON 7
 uu_8                -1.306664e-01 1 1  ON 8
 uu_9                -9.896684e-02 1 1  ON 9
 ud_0                 4.304198e-01 1 1  ON 10
 ud_1                 1.743271e-01 1 1  ON 11
 ud_2                 6.167038e-02 1 1  ON 12
 ud_3                -5.938812e-03 1 1  ON 13
 ud_4                -6.053256e-02 1 1  ON 14
 ud_5                -1.018538e-01 1 1  ON 15
 ud_6                -1.303862e-01 1 1  ON 16
 ud_7                -1.489951e-01 1 1  ON 17
 ud_8                -1.520788e-01 1 1  ON 18
 ud_9                -1.407549e-01 1 1  ON 19
 eO_0                -7.491477e-01 1 1  ON 20
 eO_1                -4.344770e-01 1 1  ON 21
 eO_2                -1.707506e-02 1 1  ON 22
 eO_3                 3.005691e-01 1 1  ON 23
 eO_4                 5.181902e-01 1 1  ON 24
 eO_5                 4.724020e-01 1 1  ON 25
 eO_6                 2.410391e-01 1 1  ON 26
 eO_7                -5.372388e-02 1 1  ON 27
 eO_8                -2.105979e-01 1 1  ON 28
 eO_9                -6.850082e-02 1 1  ON 29
eH1_0                -2.442042e-01 1 1  ON 30
eH1_1                -1.392601e-01 1 1  ON 31
eH1_2                -9.683991e-02 1 1  ON 32
eH1_3                -4.529569e-02 1 1  ON 33
eH1_4                 1.177469e-02 1 1  ON 34
eH1_5                 4.927952e-02 1 1  ON 35
eH1_6                 1.066994e-01 1 1  ON 36
eH1_7                 1.525552e-01 1 1  ON 37
eH1_8                 1.619058e-01 1 1  ON 38
eH1_9                 4.703370e-02 1 1  ON 39
eH2_0                -2.426909e-01 1 1  ON 40
eH2_1                -1.376473e-01 1 1  ON 41
eH2_2                -9.528913e-02 1 1  ON 42
eH2_3                -4.392523e-02 1 1  ON 43
eH2_4                 1.281975e-02 1 1  ON 44
eH2_5                 5.151727e-02 1 1  ON 45
eH2_6                 1.091954e-01 1 1  ON 46
eH2_7                 1.571729e-01 1 1  ON 47
eH2_8                 1.719246e-01 1 1  ON 48
eH2_9                 3.357954e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.195713
====================================================
  Execution time = 3.6827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3321e-01
  Total weights = 2.0001e+06
  Execution time = 4.4968e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333207659267
                                         uncertainty =       0.003631641744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333207659267
                                         uncertainty =       0.003631641744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408137888
  error estimate for blocks of size 2^( 2) =       0.000420123717
  error estimate for blocks of size 2^( 3) =       0.000433388396
  error estimate for blocks of size 2^( 4) =       0.000445836270
  error estimate for blocks of size 2^( 5) =       0.000458319847
  error estimate for blocks of size 2^( 6) =       0.000466237426
  error estimate for blocks of size 2^( 7) =       0.000473097299

      target function =                  N/A
              le_mean =     -16.908989521915
             les_mean =     286.247090218121
             stat err =       0.000460872710
             autocorr =       1.275111492870
              std dev =       0.577203371851
             le_variance =       0.333163732476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333369866661
                                         uncertainty =       0.003632298115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333369866661
                                         uncertainty =       0.003632298115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408237237
  error estimate for blocks of size 2^( 2) =       0.000420216913
  error estimate for blocks of size 2^( 3) =       0.000433473219
  error estimate for blocks of size 2^( 4) =       0.000445912194
  error estimate for blocks of size 2^( 5) =       0.000458393554
  error estimate for blocks of size 2^( 6) =       0.000466310766
  error estimate for blocks of size 2^( 7) =       0.000473167557

      target function =                  N/A
              le_mean =     -16.908990866796
             les_mean =     286.247297916377
             stat err =       0.000460946018
             autocorr =       1.274896423686
              std dev =       0.577343874687
             le_variance =       0.333325949639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333309659565
                                         uncertainty =       0.003632030529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333309659565
                                         uncertainty =       0.003632030529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408200359
  error estimate for blocks of size 2^( 2) =       0.000420182296
  error estimate for blocks of size 2^( 3) =       0.000433441894
  error estimate for blocks of size 2^( 4) =       0.000445884495
  error estimate for blocks of size 2^( 5) =       0.000458366838
  error estimate for blocks of size 2^( 6) =       0.000466284745
  error estimate for blocks of size 2^( 7) =       0.000473142368

      target function =                  N/A
              le_mean =     -16.908990239774
             les_mean =     286.247216492300
             stat err =       0.000460919611
             autocorr =       1.274980697320
              std dev =       0.577291720145
             le_variance =       0.333265730148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333221127423
                                         uncertainty =       0.003631695285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333221127423
                                         uncertainty =       0.003631695285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408146137
  error estimate for blocks of size 2^( 2) =       0.000420131443
  error estimate for blocks of size 2^( 3) =       0.000433395448
  error estimate for blocks of size 2^( 4) =       0.000445842625
  error estimate for blocks of size 2^( 5) =       0.000458326043
  error estimate for blocks of size 2^( 6) =       0.000466243683
  error estimate for blocks of size 2^( 7) =       0.000473103232

      target function =                  N/A
              le_mean =     -16.908989600157
             les_mean =     286.247106331714
             stat err =       0.000460878896
             autocorr =       1.275094174742
              std dev =       0.577215038000
             le_variance =       0.333177200093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908989521915        initial
     6.2500e-01     6.2500e+00             4.4948e-04       -16.908990866796  <--
     2.5000e+00     2.5000e+01             1.2317e-04       -16.908990239774
     1.0000e+01     1.0000e+02             3.2128e-05       -16.908989600157

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 5.9358e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.090518e-01 1 1  ON 0
 uu_1                 1.440508e-01 1 1  ON 1
 uu_2                 4.642161e-02 1 1  ON 2
 uu_3                -1.617446e-02 1 1  ON 3
 uu_4                -6.484524e-02 1 1  ON 4
 uu_5                -1.001793e-01 1 1  ON 5
 uu_6                -1.266924e-01 1 1  ON 6
 uu_7                -1.389726e-01 1 1  ON 7
 uu_8                -1.308252e-01 1 1  ON 8
 uu_9                -9.909684e-02 1 1  ON 9
 ud_0                 4.306267e-01 1 1  ON 10
 ud_1                 1.744286e-01 1 1  ON 11
 ud_2                 6.169446e-02 1 1  ON 12
 ud_3                -6.004729e-03 1 1  ON 13
 ud_4                -6.050562e-02 1 1  ON 14
 ud_5                -1.018788e-01 1 1  ON 15
 ud_6                -1.304175e-01 1 1  ON 16
 ud_7                -1.489939e-01 1 1  ON 17
 ud_8                -1.521056e-01 1 1  ON 18
 ud_9                -1.408770e-01 1 1  ON 19
 eO_0                -7.494537e-01 1 1  ON 20
 eO_1                -4.345179e-01 1 1  ON 21
 eO_2                -1.700795e-02 1 1  ON 22
 eO_3                 3.008229e-01 1 1  ON 23
 eO_4                 5.183311e-01 1 1  ON 24
 eO_5                 4.725904e-01 1 1  ON 25
 eO_6                 2.411080e-01 1 1  ON 26
 eO_7                -5.369891e-02 1 1  ON 27
 eO_8                -2.108137e-01 1 1  ON 28
 eO_9                -6.866545e-02 1 1  ON 29
eH1_0                -2.445354e-01 1 1  ON 30
eH1_1                -1.394776e-01 1 1  ON 31
eH1_2                -9.698108e-02 1 1  ON 32
eH1_3                -4.538634e-02 1 1  ON 33
eH1_4                 1.179256e-02 1 1  ON 34
eH1_5                 4.933865e-02 1 1  ON 35
eH1_6                 1.067557e-01 1 1  ON 36
eH1_7                 1.527074e-01 1 1  ON 37
eH1_8                 1.621802e-01 1 1  ON 38
eH1_9                 4.727056e-02 1 1  ON 39
eH2_0                -2.429633e-01 1 1  ON 40
eH2_1                -1.377619e-01 1 1  ON 41
eH2_2                -9.544552e-02 1 1  ON 42
eH2_3                -4.411024e-02 1 1  ON 43
eH2_4                 1.291979e-02 1 1  ON 44
eH2_5                 5.148169e-02 1 1  ON 45
eH2_6                 1.092265e-01 1 1  ON 46
eH2_7                 1.573346e-01 1 1  ON 47
eH2_8                 1.721483e-01 1 1  ON 48
eH2_9                 3.382495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0687e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6942e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8962
    reference variance = 0.230888
====================================================
  Execution time = 3.7185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8541e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337794069386
                                         uncertainty =       0.003415981173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337794069386
                                         uncertainty =       0.003415981173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974712
  error estimate for blocks of size 2^( 2) =       0.000422659793
  error estimate for blocks of size 2^( 3) =       0.000435224359
  error estimate for blocks of size 2^( 4) =       0.000447472939
  error estimate for blocks of size 2^( 5) =       0.000457632975
  error estimate for blocks of size 2^( 6) =       0.000465145218
  error estimate for blocks of size 2^( 7) =       0.000469390276

      target function =                  N/A
              le_mean =     -16.910179466171
             les_mean =     286.291980647007
             stat err =       0.000459910352
             autocorr =       1.252322461449
              std dev =       0.581215311034
             le_variance =       0.337811237780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691017946617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910179466171       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180808912       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910181538466       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910183612827       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910183910870       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910185602572       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910185589851       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910185447970       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910185692161       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910186257859       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910186102777       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.429570e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910179466171       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180080064       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910180352761       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910181142649       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910181455242       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910181549286       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910181792352       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910181661740       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910181685339       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.400827e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910179466171       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910179659754       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910179741724       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910179962628       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910180095421       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910180085741       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910180132736       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910180117762       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.272039e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7048e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.089450e-01 1 1  ON 0
 uu_1                 1.440680e-01 1 1  ON 1
 uu_2                 4.651320e-02 1 1  ON 2
 uu_3                -1.605143e-02 1 1  ON 3
 uu_4                -6.481771e-02 1 1  ON 4
 uu_5                -1.001589e-01 1 1  ON 5
 uu_6                -1.266724e-01 1 1  ON 6
 uu_7                -1.390661e-01 1 1  ON 7
 uu_8                -1.310051e-01 1 1  ON 8
 uu_9                -9.931436e-02 1 1  ON 9
 ud_0                 4.310601e-01 1 1  ON 10
 ud_1                 1.747064e-01 1 1  ON 11
 ud_2                 6.175979e-02 1 1  ON 12
 ud_3                -6.074779e-03 1 1  ON 13
 ud_4                -6.057958e-02 1 1  ON 14
 ud_5                -1.019529e-01 1 1  ON 15
 ud_6                -1.304765e-01 1 1  ON 16
 ud_7                -1.491062e-01 1 1  ON 17
 ud_8                -1.522201e-01 1 1  ON 18
 ud_9                -1.410283e-01 1 1  ON 19
 eO_0                -7.498938e-01 1 1  ON 20
 eO_1                -4.347477e-01 1 1  ON 21
 eO_2                -1.669123e-02 1 1  ON 22
 eO_3                 3.011183e-01 1 1  ON 23
 eO_4                 5.186732e-01 1 1  ON 24
 eO_5                 4.727389e-01 1 1  ON 25
 eO_6                 2.412538e-01 1 1  ON 26
 eO_7                -5.373434e-02 1 1  ON 27
 eO_8                -2.111367e-01 1 1  ON 28
 eO_9                -6.886685e-02 1 1  ON 29
eH1_0                -2.446990e-01 1 1  ON 30
eH1_1                -1.397027e-01 1 1  ON 31
eH1_2                -9.721632e-02 1 1  ON 32
eH1_3                -4.550806e-02 1 1  ON 33
eH1_4                 1.167712e-02 1 1  ON 34
eH1_5                 4.938533e-02 1 1  ON 35
eH1_6                 1.067506e-01 1 1  ON 36
eH1_7                 1.529107e-01 1 1  ON 37
eH1_8                 1.624406e-01 1 1  ON 38
eH1_9                 4.755651e-02 1 1  ON 39
eH2_0                -2.433057e-01 1 1  ON 40
eH2_1                -1.380707e-01 1 1  ON 41
eH2_2                -9.571228e-02 1 1  ON 42
eH2_3                -4.425012e-02 1 1  ON 43
eH2_4                 1.284133e-02 1 1  ON 44
eH2_5                 5.157570e-02 1 1  ON 45
eH2_6                 1.092731e-01 1 1  ON 46
eH2_7                 1.576075e-01 1 1  ON 47
eH2_8                 1.725048e-01 1 1  ON 48
eH2_9                 3.417773e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9572
    reference variance = 0.17415
====================================================
  Execution time = 3.7148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4730e-01
  Total weights = 2.0001e+06
  Execution time = 4.4759e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347038663535
                                         uncertainty =       0.005584190930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347038663535
                                         uncertainty =       0.005584190930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416590752
  error estimate for blocks of size 2^( 2) =       0.000428583946
  error estimate for blocks of size 2^( 3) =       0.000441087781
  error estimate for blocks of size 2^( 4) =       0.000453626835
  error estimate for blocks of size 2^( 5) =       0.000464148490
  error estimate for blocks of size 2^( 6) =       0.000473217202
  error estimate for blocks of size 2^( 7) =       0.000476794634

      target function =                  N/A
              le_mean =     -16.909445404723
             les_mean =     286.276450538330
             stat err =       0.000466946790
             autocorr =       1.256364161940
              std dev =       0.589157717922
             le_variance =       0.347106816587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347603666265
                                         uncertainty =       0.005587706427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347603666265
                                         uncertainty =       0.005587706427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416929875
  error estimate for blocks of size 2^( 2) =       0.000428902161
  error estimate for blocks of size 2^( 3) =       0.000441379915
  error estimate for blocks of size 2^( 4) =       0.000453889268
  error estimate for blocks of size 2^( 5) =       0.000464392775
  error estimate for blocks of size 2^( 6) =       0.000473449865
  error estimate for blocks of size 2^( 7) =       0.000477013600

      target function =                  N/A
              le_mean =     -16.909444458414
             les_mean =     286.276983884601
             stat err =       0.000467186377
             autocorr =       1.255608683106
              std dev =       0.589637317537
             le_variance =       0.347672166233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347435417511
                                         uncertainty =       0.005585369504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347435417511
                                         uncertainty =       0.005585369504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416828873
  error estimate for blocks of size 2^( 2) =       0.000428805066
  error estimate for blocks of size 2^( 3) =       0.000441290659
  error estimate for blocks of size 2^( 4) =       0.000453809057
  error estimate for blocks of size 2^( 5) =       0.000464320443
  error estimate for blocks of size 2^( 6) =       0.000473381121
  error estimate for blocks of size 2^( 7) =       0.000476943681

      target function =                  N/A
              le_mean =     -16.909443815210
             les_mean =     286.276793704092
             stat err =       0.000467113576
             autocorr =       1.255825769940
              std dev =       0.589494476726
             le_variance =       0.347503738090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347098722630
                                         uncertainty =       0.005584324426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347098722630
                                         uncertainty =       0.005584324426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416626799
  error estimate for blocks of size 2^( 2) =       0.000428617190
  error estimate for blocks of size 2^( 3) =       0.000441118207
  error estimate for blocks of size 2^( 4) =       0.000453654133
  error estimate for blocks of size 2^( 5) =       0.000464174383
  error estimate for blocks of size 2^( 6) =       0.000473241965
  error estimate for blocks of size 2^( 7) =       0.000476816844

      target function =                  N/A
              le_mean =     -16.909444927772
             les_mean =     286.276494480050
             stat err =       0.000466971831
             autocorr =       1.256281497183
              std dev =       0.589208696694
             le_variance =       0.347166888260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909445404723        initial  <--
     1.5625e-01     1.5625e+00             1.4296e-03       -16.909444458414
     6.2500e-01     6.2500e+00             4.4008e-04       -16.909443815210
     2.5000e+00     2.5000e+01             1.2720e-04       -16.909444927772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.6168
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.090518e-01 1 1  ON 0
 uu_1                 1.440508e-01 1 1  ON 1
 uu_2                 4.642161e-02 1 1  ON 2
 uu_3                -1.617446e-02 1 1  ON 3
 uu_4                -6.484524e-02 1 1  ON 4
 uu_5                -1.001793e-01 1 1  ON 5
 uu_6                -1.266924e-01 1 1  ON 6
 uu_7                -1.389726e-01 1 1  ON 7
 uu_8                -1.308252e-01 1 1  ON 8
 uu_9                -9.909684e-02 1 1  ON 9
 ud_0                 4.306267e-01 1 1  ON 10
 ud_1                 1.744286e-01 1 1  ON 11
 ud_2                 6.169446e-02 1 1  ON 12
 ud_3                -6.004729e-03 1 1  ON 13
 ud_4                -6.050562e-02 1 1  ON 14
 ud_5                -1.018788e-01 1 1  ON 15
 ud_6                -1.304175e-01 1 1  ON 16
 ud_7                -1.489939e-01 1 1  ON 17
 ud_8                -1.521056e-01 1 1  ON 18
 ud_9                -1.408770e-01 1 1  ON 19
 eO_0                -7.494537e-01 1 1  ON 20
 eO_1                -4.345179e-01 1 1  ON 21
 eO_2                -1.700795e-02 1 1  ON 22
 eO_3                 3.008229e-01 1 1  ON 23
 eO_4                 5.183311e-01 1 1  ON 24
 eO_5                 4.725904e-01 1 1  ON 25
 eO_6                 2.411080e-01 1 1  ON 26
 eO_7                -5.369891e-02 1 1  ON 27
 eO_8                -2.108137e-01 1 1  ON 28
 eO_9                -6.866545e-02 1 1  ON 29
eH1_0                -2.445354e-01 1 1  ON 30
eH1_1                -1.394776e-01 1 1  ON 31
eH1_2                -9.698108e-02 1 1  ON 32
eH1_3                -4.538634e-02 1 1  ON 33
eH1_4                 1.179256e-02 1 1  ON 34
eH1_5                 4.933865e-02 1 1  ON 35
eH1_6                 1.067557e-01 1 1  ON 36
eH1_7                 1.527074e-01 1 1  ON 37
eH1_8                 1.621802e-01 1 1  ON 38
eH1_9                 4.727056e-02 1 1  ON 39
eH2_0                -2.429633e-01 1 1  ON 40
eH2_1                -1.377619e-01 1 1  ON 41
eH2_2                -9.544552e-02 1 1  ON 42
eH2_3                -4.411024e-02 1 1  ON 43
eH2_4                 1.291979e-02 1 1  ON 44
eH2_5                 5.148169e-02 1 1  ON 45
eH2_6                 1.092265e-01 1 1  ON 46
eH2_7                 1.573346e-01 1 1  ON 47
eH2_8                 1.721483e-01 1 1  ON 48
eH2_9                 3.382495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0667e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6939e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.225325
====================================================
  Execution time = 3.9424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3291e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7734e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333039999876
                                         uncertainty =       0.003916885507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333039999876
                                         uncertainty =       0.003916885507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407984939
  error estimate for blocks of size 2^( 2) =       0.000420080367
  error estimate for blocks of size 2^( 3) =       0.000432690361
  error estimate for blocks of size 2^( 4) =       0.000444675550
  error estimate for blocks of size 2^( 5) =       0.000455060951
  error estimate for blocks of size 2^( 6) =       0.000461917548
  error estimate for blocks of size 2^( 7) =       0.000468526968

      target function =                  N/A
              le_mean =     -16.909632731645
             les_mean =     286.268593027042
             stat err =       0.000457545254
             autocorr =       1.257708068062
              std dev =       0.576987066048
             le_variance =       0.332914074386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690963273164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632731645       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909633316264       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909633196079       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632827086       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632868018       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909633122707       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909633243717       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909633309943       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.662792e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632731645       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909632891849       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909632869991       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632767413       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632745992       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909632809885       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909632844996       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909632860987       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.318764e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632731645       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909632772682       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909632767894       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632741573       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632733842       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909632749461       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909632758417       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909632762525       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.091069e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9206e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.090342e-01 1 1  ON 0
 uu_1                 1.440427e-01 1 1  ON 1
 uu_2                 4.644544e-02 1 1  ON 2
 uu_3                -1.616246e-02 1 1  ON 3
 uu_4                -6.484400e-02 1 1  ON 4
 uu_5                -1.001907e-01 1 1  ON 5
 uu_6                -1.266996e-01 1 1  ON 6
 uu_7                -1.389869e-01 1 1  ON 7
 uu_8                -1.308313e-01 1 1  ON 8
 uu_9                -9.910462e-02 1 1  ON 9
 ud_0                 4.306390e-01 1 1  ON 10
 ud_1                 1.744480e-01 1 1  ON 11
 ud_2                 6.169837e-02 1 1  ON 12
 ud_3                -6.010704e-03 1 1  ON 13
 ud_4                -6.051099e-02 1 1  ON 14
 ud_5                -1.018749e-01 1 1  ON 15
 ud_6                -1.304180e-01 1 1  ON 16
 ud_7                -1.490042e-01 1 1  ON 17
 ud_8                -1.521187e-01 1 1  ON 18
 ud_9                -1.408906e-01 1 1  ON 19
 eO_0                -7.494890e-01 1 1  ON 20
 eO_1                -4.345488e-01 1 1  ON 21
 eO_2                -1.700272e-02 1 1  ON 22
 eO_3                 3.008580e-01 1 1  ON 23
 eO_4                 5.183664e-01 1 1  ON 24
 eO_5                 4.726202e-01 1 1  ON 25
 eO_6                 2.411202e-01 1 1  ON 26
 eO_7                -5.370232e-02 1 1  ON 27
 eO_8                -2.108414e-01 1 1  ON 28
 eO_9                -6.868459e-02 1 1  ON 29
eH1_0                -2.445649e-01 1 1  ON 30
eH1_1                -1.395019e-01 1 1  ON 31
eH1_2                -9.699795e-02 1 1  ON 32
eH1_3                -4.540023e-02 1 1  ON 33
eH1_4                 1.177719e-02 1 1  ON 34
eH1_5                 4.935139e-02 1 1  ON 35
eH1_6                 1.067622e-01 1 1  ON 36
eH1_7                 1.527240e-01 1 1  ON 37
eH1_8                 1.622145e-01 1 1  ON 38
eH1_9                 4.729659e-02 1 1  ON 39
eH2_0                -2.429894e-01 1 1  ON 40
eH2_1                -1.377892e-01 1 1  ON 41
eH2_2                -9.548870e-02 1 1  ON 42
eH2_3                -4.413946e-02 1 1  ON 43
eH2_4                 1.291810e-02 1 1  ON 44
eH2_5                 5.148139e-02 1 1  ON 45
eH2_6                 1.092465e-01 1 1  ON 46
eH2_7                 1.573565e-01 1 1  ON 47
eH2_8                 1.721899e-01 1 1  ON 48
eH2_9                 3.386647e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8758
    reference variance = 0.184566
====================================================
  Execution time = 3.6608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4822e-01
  Total weights = 2.0001e+06
  Execution time = 4.4797e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348281653671
                                         uncertainty =       0.007416767047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348281653671
                                         uncertainty =       0.007416767047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417262352
  error estimate for blocks of size 2^( 2) =       0.000428761448
  error estimate for blocks of size 2^( 3) =       0.000440928840
  error estimate for blocks of size 2^( 4) =       0.000453898006
  error estimate for blocks of size 2^( 5) =       0.000464911656
  error estimate for blocks of size 2^( 6) =       0.000474074306
  error estimate for blocks of size 2^( 7) =       0.000479180920

      target function =                  N/A
              le_mean =     -16.909056665575
             les_mean =     286.264424029349
             stat err =       0.000468016222
             autocorr =       1.258065951640
              std dev =       0.590107518885
             le_variance =       0.348226883845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348254965753
                                         uncertainty =       0.007414042574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348254965753
                                         uncertainty =       0.007414042574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417246378
  error estimate for blocks of size 2^( 2) =       0.000428745714
  error estimate for blocks of size 2^( 3) =       0.000440912611
  error estimate for blocks of size 2^( 4) =       0.000453881524
  error estimate for blocks of size 2^( 5) =       0.000464895056
  error estimate for blocks of size 2^( 6) =       0.000474056435
  error estimate for blocks of size 2^( 7) =       0.000479160060

      target function =                  N/A
              le_mean =     -16.909057059096
             les_mean =     286.264410676101
             stat err =       0.000467998269
             autocorr =       1.258065757926
              std dev =       0.590084928146
             le_variance =       0.348200222425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348262634642
                                         uncertainty =       0.007415011504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348262634642
                                         uncertainty =       0.007415011504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417250965
  error estimate for blocks of size 2^( 2) =       0.000428750257
  error estimate for blocks of size 2^( 3) =       0.000440917438
  error estimate for blocks of size 2^( 4) =       0.000453886632
  error estimate for blocks of size 2^( 5) =       0.000464900371
  error estimate for blocks of size 2^( 6) =       0.000474062389
  error estimate for blocks of size 2^( 7) =       0.000479167375

      target function =                  N/A
              le_mean =     -16.909056927405
             les_mean =     286.264413878502
             stat err =       0.000468004192
             autocorr =       1.258069940656
              std dev =       0.590091415267
             le_variance =       0.348207878372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348279019955
                                         uncertainty =       0.007416531329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348279019955
                                         uncertainty =       0.007416531329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417260775
  error estimate for blocks of size 2^( 2) =       0.000428759898
  error estimate for blocks of size 2^( 3) =       0.000440927266
  error estimate for blocks of size 2^( 4) =       0.000453896441
  error estimate for blocks of size 2^( 5) =       0.000464910108
  error estimate for blocks of size 2^( 6) =       0.000474072679
  error estimate for blocks of size 2^( 7) =       0.000479179084

      target function =                  N/A
              le_mean =     -16.909056698938
             les_mean =     286.264422525631
             stat err =       0.000468014578
             autocorr =       1.258066623462
              std dev =       0.590105288761
             le_variance =       0.348224251824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909056665575        initial
     1.5625e+00     1.5625e+01             1.6628e-04       -16.909057059096  <--
     6.2500e+00     6.2500e+01             4.3188e-05       -16.909056927405
     2.5000e+01     2.5000e+02             1.0911e-05       -16.909056698938

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.9088e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.089875e-01 1 1  ON 0
 uu_1                 1.440329e-01 1 1  ON 1
 uu_2                 4.650053e-02 1 1  ON 2
 uu_3                -1.612688e-02 1 1  ON 3
 uu_4                -6.484212e-02 1 1  ON 4
 uu_5                -1.002216e-01 1 1  ON 5
 uu_6                -1.267229e-01 1 1  ON 6
 uu_7                -1.390305e-01 1 1  ON 7
 uu_8                -1.308507e-01 1 1  ON 8
 uu_9                -9.912837e-02 1 1  ON 9
 ud_0                 4.306802e-01 1 1  ON 10
 ud_1                 1.745006e-01 1 1  ON 11
 ud_2                 6.171394e-02 1 1  ON 12
 ud_3                -6.026904e-03 1 1  ON 13
 ud_4                -6.052631e-02 1 1  ON 14
 ud_5                -1.018678e-01 1 1  ON 15
 ud_6                -1.304205e-01 1 1  ON 16
 ud_7                -1.490339e-01 1 1  ON 17
 ud_8                -1.521582e-01 1 1  ON 18
 ud_9                -1.409315e-01 1 1  ON 19
 eO_0                -7.495905e-01 1 1  ON 20
 eO_1                -4.346395e-01 1 1  ON 21
 eO_2                -1.698848e-02 1 1  ON 22
 eO_3                 3.009590e-01 1 1  ON 23
 eO_4                 5.184718e-01 1 1  ON 24
 eO_5                 4.727095e-01 1 1  ON 25
 eO_6                 2.411565e-01 1 1  ON 26
 eO_7                -5.371287e-02 1 1  ON 27
 eO_8                -2.109243e-01 1 1  ON 28
 eO_9                -6.874173e-02 1 1  ON 29
eH1_0                -2.446511e-01 1 1  ON 30
eH1_1                -1.395727e-01 1 1  ON 31
eH1_2                -9.704859e-02 1 1  ON 32
eH1_3                -4.544083e-02 1 1  ON 33
eH1_4                 1.173045e-02 1 1  ON 34
eH1_5                 4.938679e-02 1 1  ON 35
eH1_6                 1.067816e-01 1 1  ON 36
eH1_7                 1.527737e-01 1 1  ON 37
eH1_8                 1.623164e-01 1 1  ON 38
eH1_9                 4.737415e-02 1 1  ON 39
eH2_0                -2.430668e-01 1 1  ON 40
eH2_1                -1.378737e-01 1 1  ON 41
eH2_2                -9.561180e-02 1 1  ON 42
eH2_3                -4.422638e-02 1 1  ON 43
eH2_4                 1.290808e-02 1 1  ON 44
eH2_5                 5.148183e-02 1 1  ON 45
eH2_6                 1.093066e-01 1 1  ON 46
eH2_7                 1.574219e-01 1 1  ON 47
eH2_8                 1.723137e-01 1 1  ON 48
eH2_9                 3.399022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0830e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9946
    reference variance = 0.252831
====================================================
  Execution time = 3.7429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4555e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0020e+01
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345614813343
                                         uncertainty =       0.007851173101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345614813343
                                         uncertainty =       0.007851173101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415652835
  error estimate for blocks of size 2^( 2) =       0.000427702458
  error estimate for blocks of size 2^( 3) =       0.000439976247
  error estimate for blocks of size 2^( 4) =       0.000451405935
  error estimate for blocks of size 2^( 5) =       0.000461380138
  error estimate for blocks of size 2^( 6) =       0.000470306981
  error estimate for blocks of size 2^( 7) =       0.000479014712

      target function =                  N/A
              le_mean =     -16.910689506335
             les_mean =     286.316965022454
             stat err =       0.000465526942
             autocorr =       1.254377184874
              std dev =       0.587831281537
             le_variance =       0.345545615554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691068950633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910689506335       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910690113521       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910690342694       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910689934158       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910690733084       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910691566656       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910691523448       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910691771827       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910691775116       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910691993554       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.491597e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910689506335       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910689704000       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910689731107       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910689579051       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910689791490       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910689943760       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910689968753       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910690014776       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910690026613       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.672826e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910689506335       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910689559789       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910689562264       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910689520276       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910689570852       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910689604722       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910689613810       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910689623846       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.375757e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7457e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.089459e-01 1 1  ON 0
 uu_1                 1.440051e-01 1 1  ON 1
 uu_2                 4.650404e-02 1 1  ON 2
 uu_3                -1.612297e-02 1 1  ON 3
 uu_4                -6.481111e-02 1 1  ON 4
 uu_5                -1.002005e-01 1 1  ON 5
 uu_6                -1.267365e-01 1 1  ON 6
 uu_7                -1.390247e-01 1 1  ON 7
 uu_8                -1.308825e-01 1 1  ON 8
 uu_9                -9.916119e-02 1 1  ON 9
 ud_0                 4.307731e-01 1 1  ON 10
 ud_1                 1.746003e-01 1 1  ON 11
 ud_2                 6.172825e-02 1 1  ON 12
 ud_3                -6.088238e-03 1 1  ON 13
 ud_4                -6.056275e-02 1 1  ON 14
 ud_5                -1.019172e-01 1 1  ON 15
 ud_6                -1.304562e-01 1 1  ON 16
 ud_7                -1.491089e-01 1 1  ON 17
 ud_8                -1.521273e-01 1 1  ON 18
 ud_9                -1.409219e-01 1 1  ON 19
 eO_0                -7.497541e-01 1 1  ON 20
 eO_1                -4.347326e-01 1 1  ON 21
 eO_2                -1.691561e-02 1 1  ON 22
 eO_3                 3.010873e-01 1 1  ON 23
 eO_4                 5.186017e-01 1 1  ON 24
 eO_5                 4.727930e-01 1 1  ON 25
 eO_6                 2.411793e-01 1 1  ON 26
 eO_7                -5.372036e-02 1 1  ON 27
 eO_8                -2.110221e-01 1 1  ON 28
 eO_9                -6.880925e-02 1 1  ON 29
eH1_0                -2.447700e-01 1 1  ON 30
eH1_1                -1.395723e-01 1 1  ON 31
eH1_2                -9.716296e-02 1 1  ON 32
eH1_3                -4.550139e-02 1 1  ON 33
eH1_4                 1.169346e-02 1 1  ON 34
eH1_5                 4.937186e-02 1 1  ON 35
eH1_6                 1.068093e-01 1 1  ON 36
eH1_7                 1.528772e-01 1 1  ON 37
eH1_8                 1.624493e-01 1 1  ON 38
eH1_9                 4.746908e-02 1 1  ON 39
eH2_0                -2.432341e-01 1 1  ON 40
eH2_1                -1.380361e-01 1 1  ON 41
eH2_2                -9.570719e-02 1 1  ON 42
eH2_3                -4.432518e-02 1 1  ON 43
eH2_4                 1.291830e-02 1 1  ON 44
eH2_5                 5.151440e-02 1 1  ON 45
eH2_6                 1.093723e-01 1 1  ON 46
eH2_7                 1.575279e-01 1 1  ON 47
eH2_8                 1.724414e-01 1 1  ON 48
eH2_9                 3.414279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.171437
====================================================
  Execution time = 3.6472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3908e-01
  Total weights = 2.0001e+06
  Execution time = 4.4532e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339061058341
                                         uncertainty =       0.004325909417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339061058341
                                         uncertainty =       0.004325909417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411729889
  error estimate for blocks of size 2^( 2) =       0.000423398492
  error estimate for blocks of size 2^( 3) =       0.000435893465
  error estimate for blocks of size 2^( 4) =       0.000448375802
  error estimate for blocks of size 2^( 5) =       0.000459833636
  error estimate for blocks of size 2^( 6) =       0.000467259529
  error estimate for blocks of size 2^( 7) =       0.000473984640

      target function =                  N/A
              le_mean =     -16.909848372610
             les_mean =     286.282025667405
             stat err =       0.000462363402
             autocorr =       1.261078468880
              std dev =       0.582283309265
             le_variance =       0.339053852249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339191746830
                                         uncertainty =       0.004322302010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339191746830
                                         uncertainty =       0.004322302010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411809218
  error estimate for blocks of size 2^( 2) =       0.000423474173
  error estimate for blocks of size 2^( 3) =       0.000435963126
  error estimate for blocks of size 2^( 4) =       0.000448437728
  error estimate for blocks of size 2^( 5) =       0.000459887996
  error estimate for blocks of size 2^( 6) =       0.000467303575
  error estimate for blocks of size 2^( 7) =       0.000474028333

      target function =                  N/A
              le_mean =     -16.909848445712
             les_mean =     286.282158805049
             stat err =       0.000462414408
             autocorr =       1.260870800442
              std dev =       0.582395499368
             le_variance =       0.339184517684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339123884719
                                         uncertainty =       0.004322823552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339123884719
                                         uncertainty =       0.004322823552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411768032
  error estimate for blocks of size 2^( 2) =       0.000423434282
  error estimate for blocks of size 2^( 3) =       0.000435925545
  error estimate for blocks of size 2^( 4) =       0.000448403616
  error estimate for blocks of size 2^( 5) =       0.000459857487
  error estimate for blocks of size 2^( 6) =       0.000467277280
  error estimate for blocks of size 2^( 7) =       0.000474002496

      target function =                  N/A
              le_mean =     -16.909848187896
             les_mean =     286.282082244179
             stat err =       0.000462385220
             autocorr =       1.260963839946
              std dev =       0.582337252846
             le_variance =       0.339116676052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067221173
                                         uncertainty =       0.004325424238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067221173
                                         uncertainty =       0.004325424238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411733631
  error estimate for blocks of size 2^( 2) =       0.000423401959
  error estimate for blocks of size 2^( 3) =       0.000435896483
  error estimate for blocks of size 2^( 4) =       0.000448378343
  error estimate for blocks of size 2^( 5) =       0.000459835713
  error estimate for blocks of size 2^( 6) =       0.000467260886
  error estimate for blocks of size 2^( 7) =       0.000473986079

      target function =                  N/A
              le_mean =     -16.909848315735
             les_mean =     286.282029907773
             stat err =       0.000462365255
             autocorr =       1.261065653084
              std dev =       0.582288602090
             le_variance =       0.339060016124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909848372610        initial
     3.9062e-01     3.9062e+00             6.4916e-04       -16.909848445712  <--
     1.5625e+00     1.5625e+01             1.6728e-04       -16.909848187896
     6.2500e+00     6.2500e+01             4.3758e-05       -16.909848315735

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 5.9517e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088742e-01 1 1  ON 0
 uu_1                 1.439752e-01 1 1  ON 1
 uu_2                 4.650109e-02 1 1  ON 2
 uu_3                -1.611663e-02 1 1  ON 3
 uu_4                -6.475765e-02 1 1  ON 4
 uu_5                -1.001666e-01 1 1  ON 5
 uu_6                -1.267680e-01 1 1  ON 6
 uu_7                -1.390244e-01 1 1  ON 7
 uu_8                -1.309833e-01 1 1  ON 8
 uu_9                -9.926153e-02 1 1  ON 9
 ud_0                 4.310189e-01 1 1  ON 10
 ud_1                 1.748217e-01 1 1  ON 11
 ud_2                 6.179249e-02 1 1  ON 12
 ud_3                -6.196754e-03 1 1  ON 13
 ud_4                -6.067837e-02 1 1  ON 14
 ud_5                -1.020502e-01 1 1  ON 15
 ud_6                -1.305563e-01 1 1  ON 16
 ud_7                -1.493095e-01 1 1  ON 17
 ud_8                -1.520576e-01 1 1  ON 18
 ud_9                -1.408967e-01 1 1  ON 19
 eO_0                -7.501526e-01 1 1  ON 20
 eO_1                -4.349799e-01 1 1  ON 21
 eO_2                -1.678561e-02 1 1  ON 22
 eO_3                 3.014236e-01 1 1  ON 23
 eO_4                 5.189900e-01 1 1  ON 24
 eO_5                 4.730542e-01 1 1  ON 25
 eO_6                 2.412506e-01 1 1  ON 26
 eO_7                -5.374610e-02 1 1  ON 27
 eO_8                -2.113139e-01 1 1  ON 28
 eO_9                -6.900977e-02 1 1  ON 29
eH1_0                -2.450813e-01 1 1  ON 30
eH1_1                -1.396729e-01 1 1  ON 31
eH1_2                -9.743668e-02 1 1  ON 32
eH1_3                -4.568164e-02 1 1  ON 33
eH1_4                 1.157300e-02 1 1  ON 34
eH1_5                 4.933269e-02 1 1  ON 35
eH1_6                 1.068931e-01 1 1  ON 36
eH1_7                 1.531828e-01 1 1  ON 37
eH1_8                 1.628431e-01 1 1  ON 38
eH1_9                 4.775120e-02 1 1  ON 39
eH2_0                -2.437160e-01 1 1  ON 40
eH2_1                -1.384493e-01 1 1  ON 41
eH2_2                -9.600668e-02 1 1  ON 42
eH2_3                -4.460633e-02 1 1  ON 43
eH2_4                 1.287647e-02 1 1  ON 44
eH2_5                 5.160054e-02 1 1  ON 45
eH2_6                 1.095699e-01 1 1  ON 46
eH2_7                 1.578451e-01 1 1  ON 47
eH2_8                 1.728197e-01 1 1  ON 48
eH2_9                 3.459491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0698e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.698428
====================================================
  Execution time = 3.7043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3081e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892827948
                                         uncertainty =       0.003703340047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892827948
                                         uncertainty =       0.003703340047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406690714
  error estimate for blocks of size 2^( 2) =       0.000418207811
  error estimate for blocks of size 2^( 3) =       0.000430482672
  error estimate for blocks of size 2^( 4) =       0.000442323589
  error estimate for blocks of size 2^( 5) =       0.000451933332
  error estimate for blocks of size 2^( 6) =       0.000461742821
  error estimate for blocks of size 2^( 7) =       0.000465371685

      target function =                  N/A
              le_mean =     -16.910500629154
             les_mean =     286.295836622970
             stat err =       0.000455342857
             autocorr =       1.253569861601
              std dev =       0.575156726252
             le_variance =       0.330805259753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691050062915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910500629154       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910500077609       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910503087517       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910503880418       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910505453612       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910503971025       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910503472847       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910504015797       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910504656281       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910503848645       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910504905827       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910505167351       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910505117264       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.401670e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910500629154       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910500352993       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910502217060       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910501758455       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910502103934       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910502369327       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910502021729       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910502052720       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910502222024       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910502019686       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 7.265746e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910500629154       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910500537014       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910501195688       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910501128883       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910501055520       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910501162170       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910501138051       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910501077125       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910501116533       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.928067e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6813e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.087085e-01 1 1  ON 0
 uu_1                 1.441570e-01 1 1  ON 1
 uu_2                 4.662199e-02 1 1  ON 2
 uu_3                -1.600379e-02 1 1  ON 3
 uu_4                -6.476210e-02 1 1  ON 4
 uu_5                -1.002392e-01 1 1  ON 5
 uu_6                -1.270190e-01 1 1  ON 6
 uu_7                -1.391564e-01 1 1  ON 7
 uu_8                -1.310237e-01 1 1  ON 8
 uu_9                -9.947065e-02 1 1  ON 9
 ud_0                 4.311872e-01 1 1  ON 10
 ud_1                 1.749842e-01 1 1  ON 11
 ud_2                 6.189571e-02 1 1  ON 12
 ud_3                -6.315881e-03 1 1  ON 13
 ud_4                -6.080989e-02 1 1  ON 14
 ud_5                -1.021799e-01 1 1  ON 15
 ud_6                -1.307216e-01 1 1  ON 16
 ud_7                -1.492439e-01 1 1  ON 17
 ud_8                -1.521052e-01 1 1  ON 18
 ud_9                -1.409310e-01 1 1  ON 19
 eO_0                -7.504172e-01 1 1  ON 20
 eO_1                -4.353038e-01 1 1  ON 21
 eO_2                -1.676226e-02 1 1  ON 22
 eO_3                 3.017931e-01 1 1  ON 23
 eO_4                 5.197166e-01 1 1  ON 24
 eO_5                 4.732348e-01 1 1  ON 25
 eO_6                 2.412351e-01 1 1  ON 26
 eO_7                -5.374024e-02 1 1  ON 27
 eO_8                -2.116859e-01 1 1  ON 28
 eO_9                -6.931354e-02 1 1  ON 29
eH1_0                -2.453247e-01 1 1  ON 30
eH1_1                -1.402401e-01 1 1  ON 31
eH1_2                -9.793094e-02 1 1  ON 32
eH1_3                -4.593982e-02 1 1  ON 33
eH1_4                 1.158936e-02 1 1  ON 34
eH1_5                 4.947985e-02 1 1  ON 35
eH1_6                 1.069639e-01 1 1  ON 36
eH1_7                 1.533379e-01 1 1  ON 37
eH1_8                 1.634024e-01 1 1  ON 38
eH1_9                 4.827130e-02 1 1  ON 39
eH2_0                -2.443282e-01 1 1  ON 40
eH2_1                -1.387533e-01 1 1  ON 41
eH2_2                -9.645602e-02 1 1  ON 42
eH2_3                -4.480770e-02 1 1  ON 43
eH2_4                 1.291730e-02 1 1  ON 44
eH2_5                 5.173634e-02 1 1  ON 45
eH2_6                 1.097091e-01 1 1  ON 46
eH2_7                 1.580176e-01 1 1  ON 47
eH2_8                 1.733107e-01 1 1  ON 48
eH2_9                 3.518837e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9148
    reference variance = 0.19078
====================================================
  Execution time = 3.6971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3573e-01
  Total weights = 2.0001e+06
  Execution time = 4.4653e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335763504765
                                         uncertainty =       0.004326079539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335763504765
                                         uncertainty =       0.004326079539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409689211
  error estimate for blocks of size 2^( 2) =       0.000421706200
  error estimate for blocks of size 2^( 3) =       0.000434563932
  error estimate for blocks of size 2^( 4) =       0.000446586568
  error estimate for blocks of size 2^( 5) =       0.000458083030
  error estimate for blocks of size 2^( 6) =       0.000466995098
  error estimate for blocks of size 2^( 7) =       0.000475294270

      target function =                  N/A
              le_mean =     -16.909673776468
             les_mean =     286.272768300225
             stat err =       0.000461739742
             autocorr =       1.270239040606
              std dev =       0.579397308848
             le_variance =       0.335701241500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335979126793
                                         uncertainty =       0.004328706255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335979126793
                                         uncertainty =       0.004328706255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409820654
  error estimate for blocks of size 2^( 2) =       0.000421833775
  error estimate for blocks of size 2^( 3) =       0.000434679971
  error estimate for blocks of size 2^( 4) =       0.000446684429
  error estimate for blocks of size 2^( 5) =       0.000458155023
  error estimate for blocks of size 2^( 6) =       0.000467062625
  error estimate for blocks of size 2^( 7) =       0.000475341643

      target function =                  N/A
              le_mean =     -16.909672326437
             les_mean =     286.272934705780
             stat err =       0.000461810930
             autocorr =       1.269815810722
              std dev =       0.579583200468
             le_variance =       0.335916686265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335827382569
                                         uncertainty =       0.004327643360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335827382569
                                         uncertainty =       0.004327643360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409728126
  error estimate for blocks of size 2^( 2) =       0.000421743692
  error estimate for blocks of size 2^( 3) =       0.000434596231
  error estimate for blocks of size 2^( 4) =       0.000446608727
  error estimate for blocks of size 2^( 5) =       0.000458090225
  error estimate for blocks of size 2^( 6) =       0.000467001201
  error estimate for blocks of size 2^( 7) =       0.000475284622

      target function =                  N/A
              le_mean =     -16.909672021986
             les_mean =     286.272772741853
             stat err =       0.000461746194
             autocorr =       1.270033257572
              std dev =       0.579452343667
             le_variance =       0.335765018581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761200651
                                         uncertainty =       0.004326256080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761200651
                                         uncertainty =       0.004326256080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409687796
  error estimate for blocks of size 2^( 2) =       0.000421704656
  error estimate for blocks of size 2^( 3) =       0.000434561903
  error estimate for blocks of size 2^( 4) =       0.000446583351
  error estimate for blocks of size 2^( 5) =       0.000458077962
  error estimate for blocks of size 2^( 6) =       0.000466990048
  error estimate for blocks of size 2^( 7) =       0.000475286604

      target function =                  N/A
              le_mean =     -16.909673264387
             les_mean =     286.272748662886
             stat err =       0.000461734491
             autocorr =       1.270218928783
              std dev =       0.579395307536
             le_variance =       0.335698922395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909673776468        initial  <--
     9.7656e-02     9.7656e-01             2.4017e-03       -16.909672326437
     3.9062e-01     3.9062e+00             7.2657e-04       -16.909672021986
     1.5625e+00     1.5625e+01             1.9281e-04       -16.909673264387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4074
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088742e-01 1 1  ON 0
 uu_1                 1.439752e-01 1 1  ON 1
 uu_2                 4.650109e-02 1 1  ON 2
 uu_3                -1.611663e-02 1 1  ON 3
 uu_4                -6.475765e-02 1 1  ON 4
 uu_5                -1.001666e-01 1 1  ON 5
 uu_6                -1.267680e-01 1 1  ON 6
 uu_7                -1.390244e-01 1 1  ON 7
 uu_8                -1.309833e-01 1 1  ON 8
 uu_9                -9.926153e-02 1 1  ON 9
 ud_0                 4.310189e-01 1 1  ON 10
 ud_1                 1.748217e-01 1 1  ON 11
 ud_2                 6.179249e-02 1 1  ON 12
 ud_3                -6.196754e-03 1 1  ON 13
 ud_4                -6.067837e-02 1 1  ON 14
 ud_5                -1.020502e-01 1 1  ON 15
 ud_6                -1.305563e-01 1 1  ON 16
 ud_7                -1.493095e-01 1 1  ON 17
 ud_8                -1.520576e-01 1 1  ON 18
 ud_9                -1.408967e-01 1 1  ON 19
 eO_0                -7.501526e-01 1 1  ON 20
 eO_1                -4.349799e-01 1 1  ON 21
 eO_2                -1.678561e-02 1 1  ON 22
 eO_3                 3.014236e-01 1 1  ON 23
 eO_4                 5.189900e-01 1 1  ON 24
 eO_5                 4.730542e-01 1 1  ON 25
 eO_6                 2.412506e-01 1 1  ON 26
 eO_7                -5.374610e-02 1 1  ON 27
 eO_8                -2.113139e-01 1 1  ON 28
 eO_9                -6.900977e-02 1 1  ON 29
eH1_0                -2.450813e-01 1 1  ON 30
eH1_1                -1.396729e-01 1 1  ON 31
eH1_2                -9.743668e-02 1 1  ON 32
eH1_3                -4.568164e-02 1 1  ON 33
eH1_4                 1.157300e-02 1 1  ON 34
eH1_5                 4.933269e-02 1 1  ON 35
eH1_6                 1.068931e-01 1 1  ON 36
eH1_7                 1.531828e-01 1 1  ON 37
eH1_8                 1.628431e-01 1 1  ON 38
eH1_9                 4.775120e-02 1 1  ON 39
eH2_0                -2.437160e-01 1 1  ON 40
eH2_1                -1.384493e-01 1 1  ON 41
eH2_2                -9.600668e-02 1 1  ON 42
eH2_3                -4.460633e-02 1 1  ON 43
eH2_4                 1.287647e-02 1 1  ON 44
eH2_5                 5.160054e-02 1 1  ON 45
eH2_6                 1.095699e-01 1 1  ON 46
eH2_7                 1.578451e-01 1 1  ON 47
eH2_8                 1.728197e-01 1 1  ON 48
eH2_9                 3.459491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0724e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8432
    reference variance = 0.267228
====================================================
  Execution time = 3.9220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4053e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7858e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340499519207
                                         uncertainty =       0.005098991541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340499519207
                                         uncertainty =       0.005098991541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412626271
  error estimate for blocks of size 2^( 2) =       0.000424419142
  error estimate for blocks of size 2^( 3) =       0.000437158330
  error estimate for blocks of size 2^( 4) =       0.000449339877
  error estimate for blocks of size 2^( 5) =       0.000459764427
  error estimate for blocks of size 2^( 6) =       0.000468167267
  error estimate for blocks of size 2^( 7) =       0.000475551513

      target function =                  N/A
              le_mean =     -16.909395496017
             les_mean =     286.268187646845
             stat err =       0.000463205771
             autocorr =       1.260184612454
              std dev =       0.583551005822
             le_variance =       0.340531776396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690939549602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909395496017       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909395811817       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909396518002       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909396336758       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909396660927       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909396942652       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909397149651       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909397224740       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909397177969       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.699979e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909395496017       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909395587316       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909395795593       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909395754152       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909395822518       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909395893725       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909395935587       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909395950786       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.767445e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909395496017       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909395519770       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909395574329       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909395564579       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909395581029       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909395598608       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909395608172       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909395611392       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.735651e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9014e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088416e-01 1 1  ON 0
 uu_1                 1.440028e-01 1 1  ON 1
 uu_2                 4.652163e-02 1 1  ON 2
 uu_3                -1.611091e-02 1 1  ON 3
 uu_4                -6.477130e-02 1 1  ON 4
 uu_5                -1.001963e-01 1 1  ON 5
 uu_6                -1.267696e-01 1 1  ON 6
 uu_7                -1.390226e-01 1 1  ON 7
 uu_8                -1.309880e-01 1 1  ON 8
 uu_9                -9.927361e-02 1 1  ON 9
 ud_0                 4.310197e-01 1 1  ON 10
 ud_1                 1.748422e-01 1 1  ON 11
 ud_2                 6.178549e-02 1 1  ON 12
 ud_3                -6.186956e-03 1 1  ON 13
 ud_4                -6.069779e-02 1 1  ON 14
 ud_5                -1.020549e-01 1 1  ON 15
 ud_6                -1.305753e-01 1 1  ON 16
 ud_7                -1.493020e-01 1 1  ON 17
 ud_8                -1.520670e-01 1 1  ON 18
 ud_9                -1.408930e-01 1 1  ON 19
 eO_0                -7.502203e-01 1 1  ON 20
 eO_1                -4.350271e-01 1 1  ON 21
 eO_2                -1.677809e-02 1 1  ON 22
 eO_3                 3.014864e-01 1 1  ON 23
 eO_4                 5.190428e-01 1 1  ON 24
 eO_5                 4.730946e-01 1 1  ON 25
 eO_6                 2.412654e-01 1 1  ON 26
 eO_7                -5.374137e-02 1 1  ON 27
 eO_8                -2.113459e-01 1 1  ON 28
 eO_9                -6.904286e-02 1 1  ON 29
eH1_0                -2.451084e-01 1 1  ON 30
eH1_1                -1.397322e-01 1 1  ON 31
eH1_2                -9.749367e-02 1 1  ON 32
eH1_3                -4.571308e-02 1 1  ON 33
eH1_4                 1.156660e-02 1 1  ON 34
eH1_5                 4.935854e-02 1 1  ON 35
eH1_6                 1.069286e-01 1 1  ON 36
eH1_7                 1.532107e-01 1 1  ON 37
eH1_8                 1.628895e-01 1 1  ON 38
eH1_9                 4.779513e-02 1 1  ON 39
eH2_0                -2.437696e-01 1 1  ON 40
eH2_1                -1.384910e-01 1 1  ON 41
eH2_2                -9.605338e-02 1 1  ON 42
eH2_3                -4.461350e-02 1 1  ON 43
eH2_4                 1.285139e-02 1 1  ON 44
eH2_5                 5.159802e-02 1 1  ON 45
eH2_6                 1.095739e-01 1 1  ON 46
eH2_7                 1.578790e-01 1 1  ON 47
eH2_8                 1.728869e-01 1 1  ON 48
eH2_9                 3.466116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9
    reference variance = 0.438701
====================================================
  Execution time = 3.6918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.6266e-01
  Total weights = 2.0001e+06
  Execution time = 4.5045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362777808035
                                         uncertainty =       0.021142281406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362777808035
                                         uncertainty =       0.021142281406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425823758
  error estimate for blocks of size 2^( 2) =       0.000437098478
  error estimate for blocks of size 2^( 3) =       0.000449299927
  error estimate for blocks of size 2^( 4) =       0.000461186049
  error estimate for blocks of size 2^( 5) =       0.000470966510
  error estimate for blocks of size 2^( 6) =       0.000478325285
  error estimate for blocks of size 2^( 7) =       0.000484662232

      target function =                  N/A
              le_mean =     -16.909282983924
             les_mean =     286.286514199978
             stat err =       0.000473785019
             autocorr =       1.237949337259
              std dev =       0.602215369177
             le_variance =       0.362663350873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362782856337
                                         uncertainty =       0.021145746500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362782856337
                                         uncertainty =       0.021145746500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425826708
  error estimate for blocks of size 2^( 2) =       0.000437100696
  error estimate for blocks of size 2^( 3) =       0.000449301071
  error estimate for blocks of size 2^( 4) =       0.000461186150
  error estimate for blocks of size 2^( 5) =       0.000470963512
  error estimate for blocks of size 2^( 6) =       0.000478316981
  error estimate for blocks of size 2^( 7) =       0.000484656323

      target function =                  N/A
              le_mean =     -16.909283625942
             les_mean =     286.286540936588
             stat err =       0.000473780742
             autocorr =       1.237909833059
              std dev =       0.602219540839
             le_variance =       0.362668375368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362772026202
                                         uncertainty =       0.021144125748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362772026202
                                         uncertainty =       0.021144125748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425820355
  error estimate for blocks of size 2^( 2) =       0.000437094655
  error estimate for blocks of size 2^( 3) =       0.000449295660
  error estimate for blocks of size 2^( 4) =       0.000461181350
  error estimate for blocks of size 2^( 5) =       0.000470960134
  error estimate for blocks of size 2^( 6) =       0.000478315886
  error estimate for blocks of size 2^( 7) =       0.000484654326

      target function =                  N/A
              le_mean =     -16.909283351897
             les_mean =     286.286520847856
             stat err =       0.000473777924
             autocorr =       1.237932044477
              std dev =       0.602210556577
             le_variance =       0.362657554453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362776763206
                                         uncertainty =       0.021142506856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362776763206
                                         uncertainty =       0.021142506856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425823144
  error estimate for blocks of size 2^( 2) =       0.000437097804
  error estimate for blocks of size 2^( 3) =       0.000449299195
  error estimate for blocks of size 2^( 4) =       0.000461185261
  error estimate for blocks of size 2^( 5) =       0.000470965507
  error estimate for blocks of size 2^( 6) =       0.000478323885
  error estimate for blocks of size 2^( 7) =       0.000484661032

      target function =                  N/A
              le_mean =     -16.909283027162
             les_mean =     286.286514615516
             stat err =       0.000473783921
             autocorr =       1.237947172638
              std dev =       0.602214500142
             le_variance =       0.362662304182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909282983924        initial
     9.7656e-01     9.7656e+00             2.7000e-04       -16.909283625942  <--
     3.9062e+00     3.9062e+01             6.7674e-05       -16.909283351897
     1.5625e+01     1.5625e+02             1.7357e-05       -16.909283027162

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 6.0352e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.087777e-01 1 1  ON 0
 uu_1                 1.440741e-01 1 1  ON 1
 uu_2                 4.657056e-02 1 1  ON 2
 uu_3                -1.609517e-02 1 1  ON 3
 uu_4                -6.481126e-02 1 1  ON 4
 uu_5                -1.002732e-01 1 1  ON 5
 uu_6                -1.267870e-01 1 1  ON 6
 uu_7                -1.390249e-01 1 1  ON 7
 uu_8                -1.310039e-01 1 1  ON 8
 uu_9                -9.931049e-02 1 1  ON 9
 ud_0                 4.310419e-01 1 1  ON 10
 ud_1                 1.748944e-01 1 1  ON 11
 ud_2                 6.178088e-02 1 1  ON 12
 ud_3                -6.178686e-03 1 1  ON 13
 ud_4                -6.074056e-02 1 1  ON 14
 ud_5                -1.020799e-01 1 1  ON 15
 ud_6                -1.306289e-01 1 1  ON 16
 ud_7                -1.492896e-01 1 1  ON 17
 ud_8                -1.520986e-01 1 1  ON 18
 ud_9                -1.408823e-01 1 1  ON 19
 eO_0                -7.504061e-01 1 1  ON 20
 eO_1                -4.351655e-01 1 1  ON 21
 eO_2                -1.676089e-02 1 1  ON 22
 eO_3                 3.016607e-01 1 1  ON 23
 eO_4                 5.192011e-01 1 1  ON 24
 eO_5                 4.732182e-01 1 1  ON 25
 eO_6                 2.413099e-01 1 1  ON 26
 eO_7                -5.372862e-02 1 1  ON 27
 eO_8                -2.114431e-01 1 1  ON 28
 eO_9                -6.914334e-02 1 1  ON 29
eH1_0                -2.451943e-01 1 1  ON 30
eH1_1                -1.399001e-01 1 1  ON 31
eH1_2                -9.765830e-02 1 1  ON 32
eH1_3                -4.580651e-02 1 1  ON 33
eH1_4                 1.154210e-02 1 1  ON 34
eH1_5                 4.942656e-02 1 1  ON 35
eH1_6                 1.070332e-01 1 1  ON 36
eH1_7                 1.532954e-01 1 1  ON 37
eH1_8                 1.630298e-01 1 1  ON 38
eH1_9                 4.792849e-02 1 1  ON 39
eH2_0                -2.439252e-01 1 1  ON 40
eH2_1                -1.386149e-01 1 1  ON 41
eH2_2                -9.618367e-02 1 1  ON 42
eH2_3                -4.464961e-02 1 1  ON 43
eH2_4                 1.277753e-02 1 1  ON 44
eH2_5                 5.158458e-02 1 1  ON 45
eH2_6                 1.095854e-01 1 1  ON 46
eH2_7                 1.579805e-01 1 1  ON 47
eH2_8                 1.730897e-01 1 1  ON 48
eH2_9                 3.486215e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0937e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8404
    reference variance = 0.257029
====================================================
  Execution time = 3.7064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3478e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8268e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793555753
                                         uncertainty =       0.004075428123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793555753
                                         uncertainty =       0.004075428123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409125956
  error estimate for blocks of size 2^( 2) =       0.000420707950
  error estimate for blocks of size 2^( 3) =       0.000433323965
  error estimate for blocks of size 2^( 4) =       0.000445576660
  error estimate for blocks of size 2^( 5) =       0.000457634094
  error estimate for blocks of size 2^( 6) =       0.000467729623
  error estimate for blocks of size 2^( 7) =       0.000474921053

      target function =                  N/A
              le_mean =     -16.909493870702
             les_mean =     286.265761603977
             stat err =       0.000461465357
             autocorr =       1.272225632377
              std dev =       0.578600732851
             le_variance =       0.334778808056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690949387070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909493870702       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909494686362       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909496027421       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909497900331       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909499109611       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909498299746       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909498608244       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909499380860       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909499634001       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909499483285       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.033427e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909493870702       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909494173659       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909494721645       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909495193461       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909495326253       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909495305050       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909495245479       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909495446146       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909495470876       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.813470e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909493870702       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909493956909       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909494118372       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909494221746       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909494230762       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909494247660       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909494241722       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909494284476       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.189523e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6899e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088095e-01 1 1  ON 0
 uu_1                 1.441463e-01 1 1  ON 1
 uu_2                 4.662873e-02 1 1  ON 2
 uu_3                -1.602262e-02 1 1  ON 3
 uu_4                -6.485855e-02 1 1  ON 4
 uu_5                -1.002915e-01 1 1  ON 5
 uu_6                -1.268342e-01 1 1  ON 6
 uu_7                -1.391412e-01 1 1  ON 7
 uu_8                -1.311436e-01 1 1  ON 8
 uu_9                -9.944358e-02 1 1  ON 9
 ud_0                 4.311106e-01 1 1  ON 10
 ud_1                 1.749427e-01 1 1  ON 11
 ud_2                 6.176067e-02 1 1  ON 12
 ud_3                -6.210895e-03 1 1  ON 13
 ud_4                -6.081672e-02 1 1  ON 14
 ud_5                -1.021782e-01 1 1  ON 15
 ud_6                -1.306007e-01 1 1  ON 16
 ud_7                -1.492943e-01 1 1  ON 17
 ud_8                -1.520352e-01 1 1  ON 18
 ud_9                -1.408070e-01 1 1  ON 19
 eO_0                -7.505543e-01 1 1  ON 20
 eO_1                -4.353572e-01 1 1  ON 21
 eO_2                -1.676609e-02 1 1  ON 22
 eO_3                 3.018831e-01 1 1  ON 23
 eO_4                 5.194825e-01 1 1  ON 24
 eO_5                 4.732508e-01 1 1  ON 25
 eO_6                 2.413672e-01 1 1  ON 26
 eO_7                -5.370853e-02 1 1  ON 27
 eO_8                -2.115725e-01 1 1  ON 28
 eO_9                -6.926332e-02 1 1  ON 29
eH1_0                -2.453407e-01 1 1  ON 30
eH1_1                -1.401132e-01 1 1  ON 31
eH1_2                -9.783492e-02 1 1  ON 32
eH1_3                -4.593937e-02 1 1  ON 33
eH1_4                 1.142016e-02 1 1  ON 34
eH1_5                 4.948695e-02 1 1  ON 35
eH1_6                 1.071414e-01 1 1  ON 36
eH1_7                 1.534154e-01 1 1  ON 37
eH1_8                 1.632731e-01 1 1  ON 38
eH1_9                 4.814833e-02 1 1  ON 39
eH2_0                -2.441652e-01 1 1  ON 40
eH2_1                -1.387845e-01 1 1  ON 41
eH2_2                -9.637572e-02 1 1  ON 42
eH2_3                -4.469012e-02 1 1  ON 43
eH2_4                 1.275056e-02 1 1  ON 44
eH2_5                 5.157766e-02 1 1  ON 45
eH2_6                 1.097917e-01 1 1  ON 46
eH2_7                 1.581004e-01 1 1  ON 47
eH2_8                 1.732106e-01 1 1  ON 48
eH2_9                 3.507109e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9799
    reference variance = 0.310557
====================================================
  Execution time = 3.7164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.0001e+06
  Execution time = 4.4806e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340485545117
                                         uncertainty =       0.006659214886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340485545117
                                         uncertainty =       0.006659214886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412530536
  error estimate for blocks of size 2^( 2) =       0.000424453518
  error estimate for blocks of size 2^( 3) =       0.000436217675
  error estimate for blocks of size 2^( 4) =       0.000448008031
  error estimate for blocks of size 2^( 5) =       0.000459609973
  error estimate for blocks of size 2^( 6) =       0.000469302186
  error estimate for blocks of size 2^( 7) =       0.000474953147

      target function =                  N/A
              le_mean =     -16.909443153951
             les_mean =     286.269641384486
             stat err =       0.000462968334
             autocorr =       1.259477382454
              std dev =       0.583415613421
             le_variance =       0.340373777983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340667267120
                                         uncertainty =       0.006656282386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340667267120
                                         uncertainty =       0.006656282386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412640566
  error estimate for blocks of size 2^( 2) =       0.000424560403
  error estimate for blocks of size 2^( 3) =       0.000436318041
  error estimate for blocks of size 2^( 4) =       0.000448098785
  error estimate for blocks of size 2^( 5) =       0.000459689236
  error estimate for blocks of size 2^( 6) =       0.000469376448
  error estimate for blocks of size 2^( 7) =       0.000475019233

      target function =                  N/A
              le_mean =     -16.909445053756
             les_mean =     286.269887227386
             stat err =       0.000463045925
             autocorr =       1.259227767356
              std dev =       0.583571222440
             le_variance =       0.340555371660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340592856661
                                         uncertainty =       0.006656259847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340592856661
                                         uncertainty =       0.006656259847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412595518
  error estimate for blocks of size 2^( 2) =       0.000424515978
  error estimate for blocks of size 2^( 3) =       0.000436275986
  error estimate for blocks of size 2^( 4) =       0.000448060582
  error estimate for blocks of size 2^( 5) =       0.000459655958
  error estimate for blocks of size 2^( 6) =       0.000469346646
  error estimate for blocks of size 2^( 7) =       0.000474992046

      target function =                  N/A
              le_mean =     -16.909444509714
             les_mean =     286.269794474316
             stat err =       0.000463013808
             autocorr =       1.259328044185
              std dev =       0.583507512780
             le_variance =       0.340481017470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340500388040
                                         uncertainty =       0.006658772234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340500388040
                                         uncertainty =       0.006658772234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412539525
  error estimate for blocks of size 2^( 2) =       0.000424462085
  error estimate for blocks of size 2^( 3) =       0.000436225654
  error estimate for blocks of size 2^( 4) =       0.000448015243
  error estimate for blocks of size 2^( 5) =       0.000459616341
  error estimate for blocks of size 2^( 6) =       0.000469308471
  error estimate for blocks of size 2^( 7) =       0.000474958653

      target function =                  N/A
              le_mean =     -16.909443324447
             les_mean =     286.269661983368
             stat err =       0.000462974677
             autocorr =       1.259457007348
              std dev =       0.583428325401
             le_variance =       0.340388610880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909443153951        initial
     2.4414e-01     2.4414e+00             1.0334e-03       -16.909445053756  <--
     9.7656e-01     9.7656e+00             2.8135e-04       -16.909444509714
     3.9062e+00     3.9062e+01             7.1895e-05       -16.909443324447

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 6.0546e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.089803e-01 1 1  ON 0
 uu_1                 1.443421e-01 1 1  ON 1
 uu_2                 4.678232e-02 1 1  ON 2
 uu_3                -1.590494e-02 1 1  ON 3
 uu_4                -6.492053e-02 1 1  ON 4
 uu_5                -1.003930e-01 1 1  ON 5
 uu_6                -1.269729e-01 1 1  ON 6
 uu_7                -1.394585e-01 1 1  ON 7
 uu_8                -1.315519e-01 1 1  ON 8
 uu_9                -9.983639e-02 1 1  ON 9
 ud_0                 4.312593e-01 1 1  ON 10
 ud_1                 1.750543e-01 1 1  ON 11
 ud_2                 6.176753e-02 1 1  ON 12
 ud_3                -6.306939e-03 1 1  ON 13
 ud_4                -6.099270e-02 1 1  ON 14
 ud_5                -1.024006e-01 1 1  ON 15
 ud_6                -1.305973e-01 1 1  ON 16
 ud_7                -1.493101e-01 1 1  ON 17
 ud_8                -1.518659e-01 1 1  ON 18
 ud_9                -1.405876e-01 1 1  ON 19
 eO_0                -7.509992e-01 1 1  ON 20
 eO_1                -4.357860e-01 1 1  ON 21
 eO_2                -1.677653e-02 1 1  ON 22
 eO_3                 3.024280e-01 1 1  ON 23
 eO_4                 5.202346e-01 1 1  ON 24
 eO_5                 4.733943e-01 1 1  ON 25
 eO_6                 2.415435e-01 1 1  ON 26
 eO_7                -5.365408e-02 1 1  ON 27
 eO_8                -2.119517e-01 1 1  ON 28
 eO_9                -6.961513e-02 1 1  ON 29
eH1_0                -2.458101e-01 1 1  ON 30
eH1_1                -1.406841e-01 1 1  ON 31
eH1_2                -9.833305e-02 1 1  ON 32
eH1_3                -4.633527e-02 1 1  ON 33
eH1_4                 1.107224e-02 1 1  ON 34
eH1_5                 4.958777e-02 1 1  ON 35
eH1_6                 1.074705e-01 1 1  ON 36
eH1_7                 1.537897e-01 1 1  ON 37
eH1_8                 1.639882e-01 1 1  ON 38
eH1_9                 4.879444e-02 1 1  ON 39
eH2_0                -2.448107e-01 1 1  ON 40
eH2_1                -1.392452e-01 1 1  ON 41
eH2_2                -9.685433e-02 1 1  ON 42
eH2_3                -4.492853e-02 1 1  ON 43
eH2_4                 1.262759e-02 1 1  ON 44
eH2_5                 5.154948e-02 1 1  ON 45
eH2_6                 1.103730e-01 1 1  ON 46
eH2_7                 1.584638e-01 1 1  ON 47
eH2_8                 1.735675e-01 1 1  ON 48
eH2_9                 3.568455e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0745e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9118
    reference variance = 0.241599
====================================================
  Execution time = 3.6909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4675e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8976e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728801466
                                         uncertainty =       0.008741748372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728801466
                                         uncertainty =       0.008741748372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416375757
  error estimate for blocks of size 2^( 2) =       0.000428323652
  error estimate for blocks of size 2^( 3) =       0.000441004439
  error estimate for blocks of size 2^( 4) =       0.000453354413
  error estimate for blocks of size 2^( 5) =       0.000464537503
  error estimate for blocks of size 2^( 6) =       0.000474300614
  error estimate for blocks of size 2^( 7) =       0.000481041520

      target function =                  N/A
              le_mean =     -16.910157869980
             les_mean =     286.300187651454
             stat err =       0.000468308513
             autocorr =       1.265007890013
              std dev =       0.588853663646
             le_variance =       0.346748637190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691015786998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910157869980       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910159877012       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910161140067       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910164572855       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910167311227       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910170687396       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910172330312       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910172905057       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910172238549       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910172619157       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910172870471       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910173276094       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910172977606       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.466077e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910157869980       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910158893301       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910159232062       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910161213871       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910161313787       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910162837589       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910163057102       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910163117191       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910162848121       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910162806519       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.588113e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910157869980       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910158215635       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910158252718       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910158923865       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910159250829       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910159241094       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910159406152       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910159340150       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910159315488       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.286461e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6816e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091328e-01 1 1  ON 0
 uu_1                 1.445160e-01 1 1  ON 1
 uu_2                 4.693128e-02 1 1  ON 2
 uu_3                -1.587713e-02 1 1  ON 3
 uu_4                -6.465163e-02 1 1  ON 4
 uu_5                -1.003127e-01 1 1  ON 5
 uu_6                -1.272453e-01 1 1  ON 6
 uu_7                -1.396618e-01 1 1  ON 7
 uu_8                -1.320610e-01 1 1  ON 8
 uu_9                -1.005213e-01 1 1  ON 9
 ud_0                 4.315110e-01 1 1  ON 10
 ud_1                 1.752512e-01 1 1  ON 11
 ud_2                 6.187774e-02 1 1  ON 12
 ud_3                -6.399687e-03 1 1  ON 13
 ud_4                -6.092118e-02 1 1  ON 14
 ud_5                -1.024324e-01 1 1  ON 15
 ud_6                -1.305940e-01 1 1  ON 16
 ud_7                -1.491345e-01 1 1  ON 17
 ud_8                -1.517908e-01 1 1  ON 18
 ud_9                -1.409481e-01 1 1  ON 19
 eO_0                -7.515660e-01 1 1  ON 20
 eO_1                -4.361212e-01 1 1  ON 21
 eO_2                -1.677634e-02 1 1  ON 22
 eO_3                 3.026099e-01 1 1  ON 23
 eO_4                 5.210158e-01 1 1  ON 24
 eO_5                 4.740174e-01 1 1  ON 25
 eO_6                 2.419782e-01 1 1  ON 26
 eO_7                -5.351347e-02 1 1  ON 27
 eO_8                -2.125675e-01 1 1  ON 28
 eO_9                -7.017625e-02 1 1  ON 29
eH1_0                -2.466531e-01 1 1  ON 30
eH1_1                -1.411913e-01 1 1  ON 31
eH1_2                -9.884070e-02 1 1  ON 32
eH1_3                -4.674367e-02 1 1  ON 33
eH1_4                 1.075935e-02 1 1  ON 34
eH1_5                 4.926397e-02 1 1  ON 35
eH1_6                 1.081731e-01 1 1  ON 36
eH1_7                 1.544524e-01 1 1  ON 37
eH1_8                 1.648470e-01 1 1  ON 38
eH1_9                 4.948503e-02 1 1  ON 39
eH2_0                -2.455758e-01 1 1  ON 40
eH2_1                -1.394114e-01 1 1  ON 41
eH2_2                -9.708494e-02 1 1  ON 42
eH2_3                -4.510649e-02 1 1  ON 43
eH2_4                 1.254360e-02 1 1  ON 44
eH2_5                 5.167517e-02 1 1  ON 45
eH2_6                 1.106456e-01 1 1  ON 46
eH2_7                 1.582824e-01 1 1  ON 47
eH2_8                 1.738318e-01 1 1  ON 48
eH2_9                 3.652570e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.316186
====================================================
  Execution time = 3.6995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4742e-01
  Total weights = 2.0001e+06
  Execution time = 4.6119e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347446262222
                                         uncertainty =       0.007302655120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347446262222
                                         uncertainty =       0.007302655120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416707682
  error estimate for blocks of size 2^( 2) =       0.000428262526
  error estimate for blocks of size 2^( 3) =       0.000440120273
  error estimate for blocks of size 2^( 4) =       0.000453007450
  error estimate for blocks of size 2^( 5) =       0.000463073985
  error estimate for blocks of size 2^( 6) =       0.000469911550
  error estimate for blocks of size 2^( 7) =       0.000471111457

      target function =                  N/A
              le_mean =     -16.910147736580
             les_mean =     286.300397996518
             stat err =       0.000464276111
             autocorr =       1.241336891206
              std dev =       0.589323083894
             le_variance =       0.347301697211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347841553816
                                         uncertainty =       0.007303866350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347841553816
                                         uncertainty =       0.007303866350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416944762
  error estimate for blocks of size 2^( 2) =       0.000428491073
  error estimate for blocks of size 2^( 3) =       0.000440329240
  error estimate for blocks of size 2^( 4) =       0.000453193763
  error estimate for blocks of size 2^( 5) =       0.000463227041
  error estimate for blocks of size 2^( 6) =       0.000470035072
  error estimate for blocks of size 2^( 7) =       0.000471223108

      target function =                  N/A
              le_mean =     -16.910151890524
             les_mean =     286.300933781226
             stat err =       0.000464419746
             autocorr =       1.240692935849
              std dev =       0.589658370980
             le_variance =       0.347696994467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347686685477
                                         uncertainty =       0.007302238236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347686685477
                                         uncertainty =       0.007302238236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416851945
  error estimate for blocks of size 2^( 2) =       0.000428402284
  error estimate for blocks of size 2^( 3) =       0.000440248892
  error estimate for blocks of size 2^( 4) =       0.000453123411
  error estimate for blocks of size 2^( 5) =       0.000463164613
  error estimate for blocks of size 2^( 6) =       0.000469978470
  error estimate for blocks of size 2^( 7) =       0.000471175055

      target function =                  N/A
              le_mean =     -16.910150736171
             les_mean =     286.300739954994
             stat err =       0.000464360387
             autocorr =       1.240928233152
              std dev =       0.589527106027
             le_variance =       0.347542208741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347485242324
                                         uncertainty =       0.007302995175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347485242324
                                         uncertainty =       0.007302995175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416731088
  error estimate for blocks of size 2^( 2) =       0.000428284855
  error estimate for blocks of size 2^( 3) =       0.000440140668
  error estimate for blocks of size 2^( 4) =       0.000453026123
  error estimate for blocks of size 2^( 5) =       0.000463088443
  error estimate for blocks of size 2^( 6) =       0.000469921578
  error estimate for blocks of size 2^( 7) =       0.000471120784

      target function =                  N/A
              le_mean =     -16.910147991252
             les_mean =     286.300445626289
             stat err =       0.000464289232
             autocorr =       1.241267610952
              std dev =       0.589356185956
             le_variance =       0.347340713924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910147736580        initial
     6.1035e-02     6.1035e-01             3.4661e-03       -16.910151890524  <--
     2.4414e-01     2.4414e+00             8.5881e-04       -16.910150736171
     9.7656e-01     9.7656e+00             2.2865e-04       -16.910147991252

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 6.1054e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.096799e-01 1 1  ON 0
 uu_1                 1.450369e-01 1 1  ON 1
 uu_2                 4.733608e-02 1 1  ON 2
 uu_3                -1.562705e-02 1 1  ON 3
 uu_4                -6.448265e-02 1 1  ON 4
 uu_5                -1.003655e-01 1 1  ON 5
 uu_6                -1.277848e-01 1 1  ON 6
 uu_7                -1.403385e-01 1 1  ON 7
 uu_8                -1.332087e-01 1 1  ON 8
 uu_9                -1.023695e-01 1 1  ON 9
 ud_0                 4.321090e-01 1 1  ON 10
 ud_1                 1.757408e-01 1 1  ON 11
 ud_2                 6.223000e-02 1 1  ON 12
 ud_3                -6.217185e-03 1 1  ON 13
 ud_4                -6.082339e-02 1 1  ON 14
 ud_5                -1.024555e-01 1 1  ON 15
 ud_6                -1.306101e-01 1 1  ON 16
 ud_7                -1.491025e-01 1 1  ON 17
 ud_8                -1.515159e-01 1 1  ON 18
 ud_9                -1.417530e-01 1 1  ON 19
 eO_0                -7.527096e-01 1 1  ON 20
 eO_1                -4.368970e-01 1 1  ON 21
 eO_2                -1.694033e-02 1 1  ON 22
 eO_3                 3.030408e-01 1 1  ON 23
 eO_4                 5.226499e-01 1 1  ON 24
 eO_5                 4.758551e-01 1 1  ON 25
 eO_6                 2.433878e-01 1 1  ON 26
 eO_7                -5.310068e-02 1 1  ON 27
 eO_8                -2.143085e-01 1 1  ON 28
 eO_9                -7.182554e-02 1 1  ON 29
eH1_0                -2.485713e-01 1 1  ON 30
eH1_1                -1.427481e-01 1 1  ON 31
eH1_2                -1.003042e-01 1 1  ON 32
eH1_3                -4.807024e-02 1 1  ON 33
eH1_4                 9.698656e-03 1 1  ON 34
eH1_5                 4.860943e-02 1 1  ON 35
eH1_6                 1.095517e-01 1 1  ON 36
eH1_7                 1.563539e-01 1 1  ON 37
eH1_8                 1.674543e-01 1 1  ON 38
eH1_9                 5.159290e-02 1 1  ON 39
eH2_0                -2.468165e-01 1 1  ON 40
eH2_1                -1.402577e-01 1 1  ON 41
eH2_2                -9.782973e-02 1 1  ON 42
eH2_3                -4.578412e-02 1 1  ON 43
eH2_4                 1.211451e-02 1 1  ON 44
eH2_5                 5.160405e-02 1 1  ON 45
eH2_6                 1.113034e-01 1 1  ON 46
eH2_7                 1.580621e-01 1 1  ON 47
eH2_8                 1.746308e-01 1 1  ON 48
eH2_9                 3.898945e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0788e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.963
    reference variance = 0.19264
====================================================
  Execution time = 3.7159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3333e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0014e+01
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333349112095
                                         uncertainty =       0.003997705842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333349112095
                                         uncertainty =       0.003997705842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408242763
  error estimate for blocks of size 2^( 2) =       0.000420304544
  error estimate for blocks of size 2^( 3) =       0.000432735268
  error estimate for blocks of size 2^( 4) =       0.000444861439
  error estimate for blocks of size 2^( 5) =       0.000456165531
  error estimate for blocks of size 2^( 6) =       0.000464850157
  error estimate for blocks of size 2^( 7) =       0.000470428512

      target function =                  N/A
              le_mean =     -16.909789475431
             les_mean =     286.274314910935
             stat err =       0.000459076410
             autocorr =       1.264541138917
              std dev =       0.577351690214
             le_variance =       0.333334974193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690978947543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909789475431       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909787910595       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909792972338       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909793959304       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909798396872       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909794787552       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909796781128       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909792235314       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909794777139       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909804247908       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909806128934       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909810408878       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909809120740       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909810939679       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909810776038       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909810794536       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909810066334       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909809693841       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909809398000       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909809864044       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909809861289       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.702427e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909789475431       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909788207094       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909792113632       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909792769929       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909796510670       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909793377310       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909793540771       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909792085828       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909794585842       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909796306173       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909796350108       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909797250281       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909796651294       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909796881382       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.088648e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909789475431       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909788753927       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909791020817       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909791141303       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909793185339       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909792081990       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909790983598       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909791698151       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909791799080       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909791861785       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.916499e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7188e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.101326e-01 1 1  ON 0
 uu_1                 1.454502e-01 1 1  ON 1
 uu_2                 4.740452e-02 1 1  ON 2
 uu_3                -1.583039e-02 1 1  ON 3
 uu_4                -6.531795e-02 1 1  ON 4
 uu_5                -1.012896e-01 1 1  ON 5
 uu_6                -1.280409e-01 1 1  ON 6
 uu_7                -1.407440e-01 1 1  ON 7
 uu_8                -1.331539e-01 1 1  ON 8
 uu_9                -1.032111e-01 1 1  ON 9
 ud_0                 4.330134e-01 1 1  ON 10
 ud_1                 1.765572e-01 1 1  ON 11
 ud_2                 6.315007e-02 1 1  ON 12
 ud_3                -5.528557e-03 1 1  ON 13
 ud_4                -6.072244e-02 1 1  ON 14
 ud_5                -1.026062e-01 1 1  ON 15
 ud_6                -1.312647e-01 1 1  ON 16
 ud_7                -1.502565e-01 1 1  ON 17
 ud_8                -1.533702e-01 1 1  ON 18
 ud_9                -1.417524e-01 1 1  ON 19
 eO_0                -7.530916e-01 1 1  ON 20
 eO_1                -4.374019e-01 1 1  ON 21
 eO_2                -1.698846e-02 1 1  ON 22
 eO_3                 3.045360e-01 1 1  ON 23
 eO_4                 5.243216e-01 1 1  ON 24
 eO_5                 4.779693e-01 1 1  ON 25
 eO_6                 2.443093e-01 1 1  ON 26
 eO_7                -5.403372e-02 1 1  ON 27
 eO_8                -2.167463e-01 1 1  ON 28
 eO_9                -7.349246e-02 1 1  ON 29
eH1_0                -2.511144e-01 1 1  ON 30
eH1_1                -1.443381e-01 1 1  ON 31
eH1_2                -1.019005e-01 1 1  ON 32
eH1_3                -4.870183e-02 1 1  ON 33
eH1_4                 9.061221e-03 1 1  ON 34
eH1_5                 4.938625e-02 1 1  ON 35
eH1_6                 1.096511e-01 1 1  ON 36
eH1_7                 1.567393e-01 1 1  ON 37
eH1_8                 1.693154e-01 1 1  ON 38
eH1_9                 5.477603e-02 1 1  ON 39
eH2_0                -2.490129e-01 1 1  ON 40
eH2_1                -1.429505e-01 1 1  ON 41
eH2_2                -1.000610e-01 1 1  ON 42
eH2_3                -4.699861e-02 1 1  ON 43
eH2_4                 1.116091e-02 1 1  ON 44
eH2_5                 5.083923e-02 1 1  ON 45
eH2_6                 1.112226e-01 1 1  ON 46
eH2_7                 1.603375e-01 1 1  ON 47
eH2_8                 1.777689e-01 1 1  ON 48
eH2_9                 4.307810e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0036
    reference variance = 0.278297
====================================================
  Execution time = 3.6934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3425e-01
  Total weights = 2.0001e+06
  Execution time = 4.4876e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334014892805
                                         uncertainty =       0.003149362410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334014892805
                                         uncertainty =       0.003149362410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408641334
  error estimate for blocks of size 2^( 2) =       0.000421059535
  error estimate for blocks of size 2^( 3) =       0.000433779703
  error estimate for blocks of size 2^( 4) =       0.000445700785
  error estimate for blocks of size 2^( 5) =       0.000455736609
  error estimate for blocks of size 2^( 6) =       0.000461820658
  error estimate for blocks of size 2^( 7) =       0.000467121818

      target function =                  N/A
              le_mean =     -16.909615527310
             les_mean =     286.269083281300
             stat err =       0.000457594967
             autocorr =       1.253943279611
              std dev =       0.577915363057
             le_variance =       0.333986166858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334642735139
                                         uncertainty =       0.003154293120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334642735139
                                         uncertainty =       0.003154293120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409025356
  error estimate for blocks of size 2^( 2) =       0.000421435351
  error estimate for blocks of size 2^( 3) =       0.000434116137
  error estimate for blocks of size 2^( 4) =       0.000445984094
  error estimate for blocks of size 2^( 5) =       0.000455964873
  error estimate for blocks of size 2^( 6) =       0.000461994871
  error estimate for blocks of size 2^( 7) =       0.000467281459

      target function =                  N/A
              le_mean =     -16.909610452644
             les_mean =     286.269539683719
             stat err =       0.000457806324
             autocorr =       1.252746255579
              std dev =       0.578458460779
             le_variance =       0.334614190846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334562989170
                                         uncertainty =       0.003152514268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334562989170
                                         uncertainty =       0.003152514268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408976768
  error estimate for blocks of size 2^( 2) =       0.000421394585
  error estimate for blocks of size 2^( 3) =       0.000434087649
  error estimate for blocks of size 2^( 4) =       0.000445974701
  error estimate for blocks of size 2^( 5) =       0.000455977476
  error estimate for blocks of size 2^( 6) =       0.000462020913
  error estimate for blocks of size 2^( 7) =       0.000467320416

      target function =                  N/A
              le_mean =     -16.909606839145
             les_mean =     286.269337984810
             stat err =       0.000457823377
             autocorr =       1.253137285670
              std dev =       0.578389745422
             le_variance =       0.334534697609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334104376921
                                         uncertainty =       0.003149433190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334104376921
                                         uncertainty =       0.003149433190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408696195
  error estimate for blocks of size 2^( 2) =       0.000421113908
  error estimate for blocks of size 2^( 3) =       0.000433829981
  error estimate for blocks of size 2^( 4) =       0.000445746652
  error estimate for blocks of size 2^( 5) =       0.000455778440
  error estimate for blocks of size 2^( 6) =       0.000461854337
  error estimate for blocks of size 2^( 7) =       0.000467155313

      target function =                  N/A
              le_mean =     -16.909610569893
             les_mean =     286.269005307620
             stat err =       0.000457633685
             autocorr =       1.253818809370
              std dev =       0.577992949119
             le_variance =       0.334075849231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909615527310        initial  <--
     1.5259e-02     1.5259e-01             1.7024e-02       -16.909610452644
     6.1035e-02     6.1035e-01             4.0886e-03       -16.909606839145
     2.4414e-01     2.4414e+00             9.9165e-04       -16.909610569893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2987
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.096799e-01 1 1  ON 0
 uu_1                 1.450369e-01 1 1  ON 1
 uu_2                 4.733608e-02 1 1  ON 2
 uu_3                -1.562705e-02 1 1  ON 3
 uu_4                -6.448265e-02 1 1  ON 4
 uu_5                -1.003655e-01 1 1  ON 5
 uu_6                -1.277848e-01 1 1  ON 6
 uu_7                -1.403385e-01 1 1  ON 7
 uu_8                -1.332087e-01 1 1  ON 8
 uu_9                -1.023695e-01 1 1  ON 9
 ud_0                 4.321090e-01 1 1  ON 10
 ud_1                 1.757408e-01 1 1  ON 11
 ud_2                 6.223000e-02 1 1  ON 12
 ud_3                -6.217185e-03 1 1  ON 13
 ud_4                -6.082339e-02 1 1  ON 14
 ud_5                -1.024555e-01 1 1  ON 15
 ud_6                -1.306101e-01 1 1  ON 16
 ud_7                -1.491025e-01 1 1  ON 17
 ud_8                -1.515159e-01 1 1  ON 18
 ud_9                -1.417530e-01 1 1  ON 19
 eO_0                -7.527096e-01 1 1  ON 20
 eO_1                -4.368970e-01 1 1  ON 21
 eO_2                -1.694033e-02 1 1  ON 22
 eO_3                 3.030408e-01 1 1  ON 23
 eO_4                 5.226499e-01 1 1  ON 24
 eO_5                 4.758551e-01 1 1  ON 25
 eO_6                 2.433878e-01 1 1  ON 26
 eO_7                -5.310068e-02 1 1  ON 27
 eO_8                -2.143085e-01 1 1  ON 28
 eO_9                -7.182554e-02 1 1  ON 29
eH1_0                -2.485713e-01 1 1  ON 30
eH1_1                -1.427481e-01 1 1  ON 31
eH1_2                -1.003042e-01 1 1  ON 32
eH1_3                -4.807024e-02 1 1  ON 33
eH1_4                 9.698656e-03 1 1  ON 34
eH1_5                 4.860943e-02 1 1  ON 35
eH1_6                 1.095517e-01 1 1  ON 36
eH1_7                 1.563539e-01 1 1  ON 37
eH1_8                 1.674543e-01 1 1  ON 38
eH1_9                 5.159290e-02 1 1  ON 39
eH2_0                -2.468165e-01 1 1  ON 40
eH2_1                -1.402577e-01 1 1  ON 41
eH2_2                -9.782973e-02 1 1  ON 42
eH2_3                -4.578412e-02 1 1  ON 43
eH2_4                 1.211451e-02 1 1  ON 44
eH2_5                 5.160405e-02 1 1  ON 45
eH2_6                 1.113034e-01 1 1  ON 46
eH2_7                 1.580621e-01 1 1  ON 47
eH2_8                 1.746308e-01 1 1  ON 48
eH2_9                 3.898945e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0750e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.307022
====================================================
  Execution time = 3.7507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3494e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8424e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924962479
                                         uncertainty =       0.003758303809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924962479
                                         uncertainty =       0.003758303809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409221867
  error estimate for blocks of size 2^( 2) =       0.000421161493
  error estimate for blocks of size 2^( 3) =       0.000433430202
  error estimate for blocks of size 2^( 4) =       0.000445646280
  error estimate for blocks of size 2^( 5) =       0.000457105882
  error estimate for blocks of size 2^( 6) =       0.000465544933
  error estimate for blocks of size 2^( 7) =       0.000469225627

      target function =                  N/A
              le_mean =     -16.909808025483
             les_mean =     286.276543080990
             stat err =       0.000459380681
             autocorr =       1.260166092039
              std dev =       0.578736373281
             le_variance =       0.334935789758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690980802548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808025483       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808163035       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808038172       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909806281749       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808318150       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909811713297       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909812177103       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909811098632       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909811408581       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909811530228       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909811523432       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909811664245       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.511210e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808025483       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808077575       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808002164       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909806951721       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909807798894       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808812951       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909808781831       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909808634739       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909808613749       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.765500e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808025483       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808040430       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808012999       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909807667537       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909807988174       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808116375       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909808121082       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909808106723       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.383256e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7359e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.098261e-01 1 1  ON 0
 uu_1                 1.451140e-01 1 1  ON 1
 uu_2                 4.746452e-02 1 1  ON 2
 uu_3                -1.547038e-02 1 1  ON 3
 uu_4                -6.456641e-02 1 1  ON 4
 uu_5                -1.004794e-01 1 1  ON 5
 uu_6                -1.277649e-01 1 1  ON 6
 uu_7                -1.405188e-01 1 1  ON 7
 uu_8                -1.333966e-01 1 1  ON 8
 uu_9                -1.026007e-01 1 1  ON 9
 ud_0                 4.322989e-01 1 1  ON 10
 ud_1                 1.758255e-01 1 1  ON 11
 ud_2                 6.237117e-02 1 1  ON 12
 ud_3                -6.082151e-03 1 1  ON 13
 ud_4                -6.087172e-02 1 1  ON 14
 ud_5                -1.023855e-01 1 1  ON 15
 ud_6                -1.305418e-01 1 1  ON 16
 ud_7                -1.490273e-01 1 1  ON 17
 ud_8                -1.517232e-01 1 1  ON 18
 ud_9                -1.420674e-01 1 1  ON 19
 eO_0                -7.527254e-01 1 1  ON 20
 eO_1                -4.368894e-01 1 1  ON 21
 eO_2                -1.700846e-02 1 1  ON 22
 eO_3                 3.031853e-01 1 1  ON 23
 eO_4                 5.228722e-01 1 1  ON 24
 eO_5                 4.760566e-01 1 1  ON 25
 eO_6                 2.433978e-01 1 1  ON 26
 eO_7                -5.303175e-02 1 1  ON 27
 eO_8                -2.145568e-01 1 1  ON 28
 eO_9                -7.210178e-02 1 1  ON 29
eH1_0                -2.488736e-01 1 1  ON 30
eH1_1                -1.429751e-01 1 1  ON 31
eH1_2                -1.003485e-01 1 1  ON 32
eH1_3                -4.822116e-02 1 1  ON 33
eH1_4                 9.571783e-03 1 1  ON 34
eH1_5                 4.861997e-02 1 1  ON 35
eH1_6                 1.095449e-01 1 1  ON 36
eH1_7                 1.566196e-01 1 1  ON 37
eH1_8                 1.678308e-01 1 1  ON 38
eH1_9                 5.184916e-02 1 1  ON 39
eH2_0                -2.469937e-01 1 1  ON 40
eH2_1                -1.404970e-01 1 1  ON 41
eH2_2                -9.797108e-02 1 1  ON 42
eH2_3                -4.589281e-02 1 1  ON 43
eH2_4                 1.200569e-02 1 1  ON 44
eH2_5                 5.165520e-02 1 1  ON 45
eH2_6                 1.114064e-01 1 1  ON 46
eH2_7                 1.581372e-01 1 1  ON 47
eH2_8                 1.748679e-01 1 1  ON 48
eH2_9                 3.928775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9329
    reference variance = 0.193478
====================================================
  Execution time = 3.7365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.0001e+06
  Execution time = 4.4670e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333970205762
                                         uncertainty =       0.002996337064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333970205762
                                         uncertainty =       0.002996337064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408599807
  error estimate for blocks of size 2^( 2) =       0.000420601606
  error estimate for blocks of size 2^( 3) =       0.000433099536
  error estimate for blocks of size 2^( 4) =       0.000444255749
  error estimate for blocks of size 2^( 5) =       0.000455514330
  error estimate for blocks of size 2^( 6) =       0.000464060582
  error estimate for blocks of size 2^( 7) =       0.000470234039

      target function =                  N/A
              le_mean =     -16.909999301486
             les_mean =     286.281994498323
             stat err =       0.000458516175
             autocorr =       1.259253039285
              std dev =       0.577856633626
             le_variance =       0.333918289026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334039656978
                                         uncertainty =       0.002995176776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334039656978
                                         uncertainty =       0.002995176776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408642325
  error estimate for blocks of size 2^( 2) =       0.000420637264
  error estimate for blocks of size 2^( 3) =       0.000433126896
  error estimate for blocks of size 2^( 4) =       0.000444276127
  error estimate for blocks of size 2^( 5) =       0.000455534597
  error estimate for blocks of size 2^( 6) =       0.000464096014
  error estimate for blocks of size 2^( 7) =       0.000470273392

      target function =                  N/A
              le_mean =     -16.910002203346
             les_mean =     286.282162136621
             stat err =       0.000458545033
             autocorr =       1.259149489933
              std dev =       0.577916764287
             le_variance =       0.333987786443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334009325755
                                         uncertainty =       0.002994784602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334009325755
                                         uncertainty =       0.002994784602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408623756
  error estimate for blocks of size 2^( 2) =       0.000420620919
  error estimate for blocks of size 2^( 3) =       0.000433114853
  error estimate for blocks of size 2^( 4) =       0.000444268535
  error estimate for blocks of size 2^( 5) =       0.000455528941
  error estimate for blocks of size 2^( 6) =       0.000464087968
  error estimate for blocks of size 2^( 7) =       0.000470264073

      target function =                  N/A
              le_mean =     -16.910001469812
             les_mean =     286.282106975817
             stat err =       0.000458537379
             autocorr =       1.259221895729
              std dev =       0.577890503237
             le_variance =       0.333957433732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333978723086
                                         uncertainty =       0.002996078496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333978723086
                                         uncertainty =       0.002996078496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408605020
  error estimate for blocks of size 2^( 2) =       0.000420606074
  error estimate for blocks of size 2^( 3) =       0.000433103446
  error estimate for blocks of size 2^( 4) =       0.000444259386
  error estimate for blocks of size 2^( 5) =       0.000455518266
  error estimate for blocks of size 2^( 6) =       0.000464066361
  error estimate for blocks of size 2^( 7) =       0.000470240023

      target function =                  N/A
              le_mean =     -16.909999501766
             les_mean =     286.282009792775
             stat err =       0.000458521009
             autocorr =       1.259247457712
              std dev =       0.577864006485
             le_variance =       0.333926809990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909999301486        initial
     1.5259e-01     1.5259e+00             1.5112e-03       -16.910002203346  <--
     6.1035e-01     6.1035e+00             3.7655e-04       -16.910001469812
     2.4414e+00     2.4414e+01             9.3833e-05       -16.909999501766

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 6.0723e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.101404e-01 1 1  ON 0
 uu_1                 1.453652e-01 1 1  ON 1
 uu_2                 4.773081e-02 1 1  ON 2
 uu_3                -1.524730e-02 1 1  ON 3
 uu_4                -6.461497e-02 1 1  ON 4
 uu_5                -1.006901e-01 1 1  ON 5
 uu_6                -1.278757e-01 1 1  ON 6
 uu_7                -1.409056e-01 1 1  ON 7
 uu_8                -1.338504e-01 1 1  ON 8
 uu_9                -1.032552e-01 1 1  ON 9
 ud_0                 4.327045e-01 1 1  ON 10
 ud_1                 1.761525e-01 1 1  ON 11
 ud_2                 6.271462e-02 1 1  ON 12
 ud_3                -5.793568e-03 1 1  ON 13
 ud_4                -6.078543e-02 1 1  ON 14
 ud_5                -1.022714e-01 1 1  ON 15
 ud_6                -1.303915e-01 1 1  ON 16
 ud_7                -1.489200e-01 1 1  ON 17
 ud_8                -1.521124e-01 1 1  ON 18
 ud_9                -1.429052e-01 1 1  ON 19
 eO_0                -7.528339e-01 1 1  ON 20
 eO_1                -4.368985e-01 1 1  ON 21
 eO_2                -1.698499e-02 1 1  ON 22
 eO_3                 3.035866e-01 1 1  ON 23
 eO_4                 5.233789e-01 1 1  ON 24
 eO_5                 4.766183e-01 1 1  ON 25
 eO_6                 2.434768e-01 1 1  ON 26
 eO_7                -5.280493e-02 1 1  ON 27
 eO_8                -2.152648e-01 1 1  ON 28
 eO_9                -7.293325e-02 1 1  ON 29
eH1_0                -2.496443e-01 1 1  ON 30
eH1_1                -1.435475e-01 1 1  ON 31
eH1_2                -1.007244e-01 1 1  ON 32
eH1_3                -4.862894e-02 1 1  ON 33
eH1_4                 9.206222e-03 1 1  ON 34
eH1_5                 4.854434e-02 1 1  ON 35
eH1_6                 1.095517e-01 1 1  ON 36
eH1_7                 1.574005e-01 1 1  ON 37
eH1_8                 1.689655e-01 1 1  ON 38
eH1_9                 5.264341e-02 1 1  ON 39
eH2_0                -2.475640e-01 1 1  ON 40
eH2_1                -1.410823e-01 1 1  ON 41
eH2_2                -9.840618e-02 1 1  ON 42
eH2_3                -4.623714e-02 1 1  ON 43
eH2_4                 1.170906e-02 1 1  ON 44
eH2_5                 5.164902e-02 1 1  ON 45
eH2_6                 1.116853e-01 1 1  ON 46
eH2_7                 1.584114e-01 1 1  ON 47
eH2_8                 1.756013e-01 1 1  ON 48
eH2_9                 4.020271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0809e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.350889
====================================================
  Execution time = 3.7085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3331e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7755e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333279870487
                                         uncertainty =       0.004451036416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333279870487
                                         uncertainty =       0.004451036416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408228068
  error estimate for blocks of size 2^( 2) =       0.000420152589
  error estimate for blocks of size 2^( 3) =       0.000433087040
  error estimate for blocks of size 2^( 4) =       0.000445458647
  error estimate for blocks of size 2^( 5) =       0.000456343696
  error estimate for blocks of size 2^( 6) =       0.000464925413
  error estimate for blocks of size 2^( 7) =       0.000472068449

      target function =                  N/A
              le_mean =     -16.909112436548
             les_mean =     286.251394202387
             stat err =       0.000459699051
             autocorr =       1.268064926453
              std dev =       0.577330907892
             le_variance =       0.333310977207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690911243655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909112436548       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111383445       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909114697362       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909119049813       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909128807553       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909128388430       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909132577836       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909130634296       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909130179196       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909129441037       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909129722879       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909131322384       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909131277562       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909131526457       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909131936886       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909131673635       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 7.935526e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909112436548       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111672773       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909113210303       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909115362799       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909120076004       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909119609768       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909119750595       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909119527125       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909119403050       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909118994947       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909118991511       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909119238035       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.963062e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909112436548       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909112072665       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909112473865       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909112985114       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909114576535       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909114585128       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909114291747       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909114422974       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909114271773       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.827153e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6872e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.100556e-01 1 1  ON 0
 uu_1                 1.450874e-01 1 1  ON 1
 uu_2                 4.725430e-02 1 1  ON 2
 uu_3                -1.582871e-02 1 1  ON 3
 uu_4                -6.504612e-02 1 1  ON 4
 uu_5                -1.010511e-01 1 1  ON 5
 uu_6                -1.280780e-01 1 1  ON 6
 uu_7                -1.408969e-01 1 1  ON 7
 uu_8                -1.335991e-01 1 1  ON 8
 uu_9                -1.029371e-01 1 1  ON 9
 ud_0                 4.332368e-01 1 1  ON 10
 ud_1                 1.764744e-01 1 1  ON 11
 ud_2                 6.270364e-02 1 1  ON 12
 ud_3                -5.996707e-03 1 1  ON 13
 ud_4                -6.110472e-02 1 1  ON 14
 ud_5                -1.028181e-01 1 1  ON 15
 ud_6                -1.312610e-01 1 1  ON 16
 ud_7                -1.495927e-01 1 1  ON 17
 ud_8                -1.516423e-01 1 1  ON 18
 ud_9                -1.420695e-01 1 1  ON 19
 eO_0                -7.537572e-01 1 1  ON 20
 eO_1                -4.375478e-01 1 1  ON 21
 eO_2                -1.699803e-02 1 1  ON 22
 eO_3                 3.043169e-01 1 1  ON 23
 eO_4                 5.243220e-01 1 1  ON 24
 eO_5                 4.771919e-01 1 1  ON 25
 eO_6                 2.436658e-01 1 1  ON 26
 eO_7                -5.258108e-02 1 1  ON 27
 eO_8                -2.155284e-01 1 1  ON 28
 eO_9                -7.368661e-02 1 1  ON 29
eH1_0                -2.502167e-01 1 1  ON 30
eH1_1                -1.443351e-01 1 1  ON 31
eH1_2                -1.016776e-01 1 1  ON 32
eH1_3                -4.925952e-02 1 1  ON 33
eH1_4                 8.843636e-03 1 1  ON 34
eH1_5                 4.773490e-02 1 1  ON 35
eH1_6                 1.091551e-01 1 1  ON 36
eH1_7                 1.586795e-01 1 1  ON 37
eH1_8                 1.707351e-01 1 1  ON 38
eH1_9                 5.399314e-02 1 1  ON 39
eH2_0                -2.481257e-01 1 1  ON 40
eH2_1                -1.417122e-01 1 1  ON 41
eH2_2                -9.914055e-02 1 1  ON 42
eH2_3                -4.720333e-02 1 1  ON 43
eH2_4                 1.101773e-02 1 1  ON 44
eH2_5                 5.090240e-02 1 1  ON 45
eH2_6                 1.115934e-01 1 1  ON 46
eH2_7                 1.593318e-01 1 1  ON 47
eH2_8                 1.768798e-01 1 1  ON 48
eH2_9                 4.216578e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8323
    reference variance = 0.235103
====================================================
  Execution time = 3.9034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2928e-01
  Total weights = 2.0001e+06
  Execution time = 4.4413e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328633414957
                                         uncertainty =       0.002467219432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328633414957
                                         uncertainty =       0.002467219432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405385415
  error estimate for blocks of size 2^( 2) =       0.000417535194
  error estimate for blocks of size 2^( 3) =       0.000430233460
  error estimate for blocks of size 2^( 4) =       0.000442353022
  error estimate for blocks of size 2^( 5) =       0.000452113682
  error estimate for blocks of size 2^( 6) =       0.000460447452
  error estimate for blocks of size 2^( 7) =       0.000469179008

      target function =                  N/A
              le_mean =     -16.909765824510
             les_mean =     286.268865262097
             stat err =       0.000456023291
             autocorr =       1.265429079955
              std dev =       0.573310724351
             le_variance =       0.328685186656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329732205251
                                         uncertainty =       0.002473375156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329732205251
                                         uncertainty =       0.002473375156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406062462
  error estimate for blocks of size 2^( 2) =       0.000418205625
  error estimate for blocks of size 2^( 3) =       0.000430887053
  error estimate for blocks of size 2^( 4) =       0.000442963192
  error estimate for blocks of size 2^( 5) =       0.000452675151
  error estimate for blocks of size 2^( 6) =       0.000460964148
  error estimate for blocks of size 2^( 7) =       0.000469663432

      target function =                  N/A
              le_mean =     -16.909771412843
             les_mean =     286.270153069133
             stat err =       0.000456566481
             autocorr =       1.264219140102
              std dev =       0.574268229502
             le_variance =       0.329783999415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329840414753
                                         uncertainty =       0.002474400732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329840414753
                                         uncertainty =       0.002474400732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406129153
  error estimate for blocks of size 2^( 2) =       0.000418263129
  error estimate for blocks of size 2^( 3) =       0.000430939622
  error estimate for blocks of size 2^( 4) =       0.000443015072
  error estimate for blocks of size 2^( 5) =       0.000452739076
  error estimate for blocks of size 2^( 6) =       0.000461043052
  error estimate for blocks of size 2^( 7) =       0.000469748736

      target function =                  N/A
              le_mean =     -16.909768309156
             les_mean =     286.270156438768
             stat err =       0.000456636484
             autocorr =       1.264191550650
              std dev =       0.574362546118
             le_variance =       0.329892334383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328868486400
                                         uncertainty =       0.002468708893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328868486400
                                         uncertainty =       0.002468708893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405530379
  error estimate for blocks of size 2^( 2) =       0.000417675730
  error estimate for blocks of size 2^( 3) =       0.000430368878
  error estimate for blocks of size 2^( 4) =       0.000442479456
  error estimate for blocks of size 2^( 5) =       0.000452233669
  error estimate for blocks of size 2^( 6) =       0.000460564210
  error estimate for blocks of size 2^( 7) =       0.000469290809

      target function =                  N/A
              le_mean =     -16.909764905776
             les_mean =     286.269069305103
             stat err =       0.000456142036
             autocorr =       1.265183172558
              std dev =       0.573515737324
             le_variance =       0.328920300959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909765824510        initial
     3.8147e-02     3.8147e-01             7.9355e-03       -16.909771412843  <--
     1.5259e-01     1.5259e+00             1.9631e-03       -16.909768309156
     6.1035e-01     6.1035e+00             4.8272e-04       -16.909764905776

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 6.2359e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.096496e-01 1 1  ON 0
 uu_1                 1.445774e-01 1 1  ON 1
 uu_2                 4.658878e-02 1 1  ON 2
 uu_3                -1.666472e-02 1 1  ON 3
 uu_4                -6.596599e-02 1 1  ON 4
 uu_5                -1.018431e-01 1 1  ON 5
 uu_6                -1.288589e-01 1 1  ON 6
 uu_7                -1.415025e-01 1 1  ON 7
 uu_8                -1.340508e-01 1 1  ON 8
 uu_9                -1.025969e-01 1 1  ON 9
 ud_0                 4.338045e-01 1 1  ON 10
 ud_1                 1.769105e-01 1 1  ON 11
 ud_2                 6.289688e-02 1 1  ON 12
 ud_3                -6.104962e-03 1 1  ON 13
 ud_4                -6.153687e-02 1 1  ON 14
 ud_5                -1.035740e-01 1 1  ON 15
 ud_6                -1.323743e-01 1 1  ON 16
 ud_7                -1.507804e-01 1 1  ON 17
 ud_8                -1.520070e-01 1 1  ON 18
 ud_9                -1.407000e-01 1 1  ON 19
 eO_0                -7.551704e-01 1 1  ON 20
 eO_1                -4.384851e-01 1 1  ON 21
 eO_2                -1.712206e-02 1 1  ON 22
 eO_3                 3.054915e-01 1 1  ON 23
 eO_4                 5.261907e-01 1 1  ON 24
 eO_5                 4.790987e-01 1 1  ON 25
 eO_6                 2.446140e-01 1 1  ON 26
 eO_7                -5.225941e-02 1 1  ON 27
 eO_8                -2.167122e-01 1 1  ON 28
 eO_9                -7.607454e-02 1 1  ON 29
eH1_0                -2.523018e-01 1 1  ON 30
eH1_1                -1.465459e-01 1 1  ON 31
eH1_2                -1.037945e-01 1 1  ON 32
eH1_3                -5.119748e-02 1 1  ON 33
eH1_4                 7.194554e-03 1 1  ON 34
eH1_5                 4.597294e-02 1 1  ON 35
eH1_6                 1.081508e-01 1 1  ON 36
eH1_7                 1.617741e-01 1 1  ON 37
eH1_8                 1.758952e-01 1 1  ON 38
eH1_9                 5.814153e-02 1 1  ON 39
eH2_0                -2.501610e-01 1 1  ON 40
eH2_1                -1.439595e-01 1 1  ON 41
eH2_2                -1.012699e-01 1 1  ON 42
eH2_3                -4.939966e-02 1 1  ON 43
eH2_4                 8.945684e-03 1 1  ON 44
eH2_5                 4.908682e-02 1 1  ON 45
eH2_6                 1.110259e-01 1 1  ON 46
eH2_7                 1.617598e-01 1 1  ON 47
eH2_8                 1.807401e-01 1 1  ON 48
eH2_9                 4.813824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0924e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.181416
====================================================
  Execution time = 3.7592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3304e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8491e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333093946072
                                         uncertainty =       0.005816217717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333093946072
                                         uncertainty =       0.005816217717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408062782
  error estimate for blocks of size 2^( 2) =       0.000419765833
  error estimate for blocks of size 2^( 3) =       0.000431629983
  error estimate for blocks of size 2^( 4) =       0.000442879012
  error estimate for blocks of size 2^( 5) =       0.000453063738
  error estimate for blocks of size 2^( 6) =       0.000461605365
  error estimate for blocks of size 2^( 7) =       0.000466423552

      target function =                  N/A
              le_mean =     -16.909598426417
             les_mean =     286.267559901286
             stat err =       0.000455992917
             autocorr =       1.248711815186
              std dev =       0.577097153979
             le_variance =       0.333041125130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690959842642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909598426417       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909603665019       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909606060298       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909608116852       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909610344014       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909616893465       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909620236688       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909631059366       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909636348879       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909644224240       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909645534568       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909656463812       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909652600123       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909651775781       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909651940046       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909653180552       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909653964670       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909653699071       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909654229126       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909653853385       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909654232373       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909654585205       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.524308e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909598426417       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909603202247       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909605331842       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909607486921       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909608932723       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909611990417       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909613349683       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909619444509       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909620209693       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909619602305       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909620292444       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909622200547       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909620879593       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909620355932       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909620497742       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.984466e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909598426417       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909601955298       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909603676551       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909605285315       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909604975979       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909605644777       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909606403894       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909607948159       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909607454340       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909607319510       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909607516336       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.477224e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7458e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.101555e-01 1 1  ON 0
 uu_1                 1.451258e-01 1 1  ON 1
 uu_2                 4.693165e-02 1 1  ON 2
 uu_3                -1.656754e-02 1 1  ON 3
 uu_4                -6.641082e-02 1 1  ON 4
 uu_5                -1.030642e-01 1 1  ON 5
 uu_6                -1.301723e-01 1 1  ON 6
 uu_7                -1.436908e-01 1 1  ON 7
 uu_8                -1.356859e-01 1 1  ON 8
 uu_9                -1.044043e-01 1 1  ON 9
 ud_0                 4.347627e-01 1 1  ON 10
 ud_1                 1.777416e-01 1 1  ON 11
 ud_2                 6.421947e-02 1 1  ON 12
 ud_3                -4.952535e-03 1 1  ON 13
 ud_4                -6.055937e-02 1 1  ON 14
 ud_5                -1.031095e-01 1 1  ON 15
 ud_6                -1.317692e-01 1 1  ON 16
 ud_7                -1.508494e-01 1 1  ON 17
 ud_8                -1.534340e-01 1 1  ON 18
 ud_9                -1.447720e-01 1 1  ON 19
 eO_0                -7.548713e-01 1 1  ON 20
 eO_1                -4.378439e-01 1 1  ON 21
 eO_2                -1.618871e-02 1 1  ON 22
 eO_3                 3.058364e-01 1 1  ON 23
 eO_4                 5.267501e-01 1 1  ON 24
 eO_5                 4.809150e-01 1 1  ON 25
 eO_6                 2.465129e-01 1 1  ON 26
 eO_7                -5.136437e-02 1 1  ON 27
 eO_8                -2.203375e-01 1 1  ON 28
 eO_9                -7.949665e-02 1 1  ON 29
eH1_0                -2.549885e-01 1 1  ON 30
eH1_1                -1.493942e-01 1 1  ON 31
eH1_2                -1.062500e-01 1 1  ON 32
eH1_3                -5.359918e-02 1 1  ON 33
eH1_4                 5.188202e-03 1 1  ON 34
eH1_5                 4.604117e-02 1 1  ON 35
eH1_6                 1.095779e-01 1 1  ON 36
eH1_7                 1.638566e-01 1 1  ON 37
eH1_8                 1.795600e-01 1 1  ON 38
eH1_9                 6.311277e-02 1 1  ON 39
eH2_0                -2.534817e-01 1 1  ON 40
eH2_1                -1.477115e-01 1 1  ON 41
eH2_2                -1.042241e-01 1 1  ON 42
eH2_3                -5.216116e-02 1 1  ON 43
eH2_4                 7.317329e-03 1 1  ON 44
eH2_5                 4.821496e-02 1 1  ON 45
eH2_6                 1.115292e-01 1 1  ON 46
eH2_7                 1.651350e-01 1 1  ON 47
eH2_8                 1.852115e-01 1 1  ON 48
eH2_9                 5.412271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8208
    reference variance = 0.253364
====================================================
  Execution time = 3.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.0001e+06
  Execution time = 4.4615e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342628928612
                                         uncertainty =       0.003822971212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342628928612
                                         uncertainty =       0.003822971212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413839774
  error estimate for blocks of size 2^( 2) =       0.000425261023
  error estimate for blocks of size 2^( 3) =       0.000437548636
  error estimate for blocks of size 2^( 4) =       0.000449169652
  error estimate for blocks of size 2^( 5) =       0.000459182949
  error estimate for blocks of size 2^( 6) =       0.000465639212
  error estimate for blocks of size 2^( 7) =       0.000471121814

      target function =                  N/A
              le_mean =     -16.910120523841
             les_mean =     286.294713636691
             stat err =       0.000461278407
             autocorr =       1.242401006002
              std dev =       0.585267184392
             le_variance =       0.342537677126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342836025479
                                         uncertainty =       0.003827176111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342836025479
                                         uncertainty =       0.003827176111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413964715
  error estimate for blocks of size 2^( 2) =       0.000425371458
  error estimate for blocks of size 2^( 3) =       0.000437620680
  error estimate for blocks of size 2^( 4) =       0.000449188665
  error estimate for blocks of size 2^( 5) =       0.000459180163
  error estimate for blocks of size 2^( 6) =       0.000465609523
  error estimate for blocks of size 2^( 7) =       0.000471065641

      target function =                  N/A
              le_mean =     -16.910116111384
             les_mean =     286.294771267193
             stat err =       0.000461260998
             autocorr =       1.241557446354
              std dev =       0.585443881224
             le_variance =       0.342744538062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342545489570
                                         uncertainty =       0.003826899650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342545489570
                                         uncertainty =       0.003826899650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413789190
  error estimate for blocks of size 2^( 2) =       0.000425198756
  error estimate for blocks of size 2^( 3) =       0.000437464839
  error estimate for blocks of size 2^( 4) =       0.000449054713
  error estimate for blocks of size 2^( 5) =       0.000459076014
  error estimate for blocks of size 2^( 6) =       0.000465527030
  error estimate for blocks of size 2^( 7) =       0.000471006567

      target function =                  N/A
              le_mean =     -16.910117041502
             les_mean =     286.294512131851
             stat err =       0.000461166081
             autocorr =       1.242099629401
              std dev =       0.585195647445
             le_variance =       0.342453945789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342486099198
                                         uncertainty =       0.003823494173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342486099198
                                         uncertainty =       0.003823494173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413753433
  error estimate for blocks of size 2^( 2) =       0.000425173469
  error estimate for blocks of size 2^( 3) =       0.000437461367
  error estimate for blocks of size 2^( 4) =       0.000449079083
  error estimate for blocks of size 2^( 5) =       0.000459100368
  error estimate for blocks of size 2^( 6) =       0.000465556479
  error estimate for blocks of size 2^( 7) =       0.000471041006

      target function =                  N/A
              le_mean =     -16.910116997473
             les_mean =     286.294451460335
             stat err =       0.000461194234
             autocorr =       1.242466011714
              std dev =       0.585145078854
             le_variance =       0.342394763307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910120523841        initial  <--
     9.5367e-03     9.5367e-02             2.5243e-02       -16.910116111384
     3.8147e-02     3.8147e-01             5.9845e-03       -16.910117041502
     1.5259e-01     1.5259e+00             1.4772e-03       -16.910116997473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4142
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.096496e-01 1 1  ON 0
 uu_1                 1.445774e-01 1 1  ON 1
 uu_2                 4.658878e-02 1 1  ON 2
 uu_3                -1.666472e-02 1 1  ON 3
 uu_4                -6.596599e-02 1 1  ON 4
 uu_5                -1.018431e-01 1 1  ON 5
 uu_6                -1.288589e-01 1 1  ON 6
 uu_7                -1.415025e-01 1 1  ON 7
 uu_8                -1.340508e-01 1 1  ON 8
 uu_9                -1.025969e-01 1 1  ON 9
 ud_0                 4.338045e-01 1 1  ON 10
 ud_1                 1.769105e-01 1 1  ON 11
 ud_2                 6.289688e-02 1 1  ON 12
 ud_3                -6.104962e-03 1 1  ON 13
 ud_4                -6.153687e-02 1 1  ON 14
 ud_5                -1.035740e-01 1 1  ON 15
 ud_6                -1.323743e-01 1 1  ON 16
 ud_7                -1.507804e-01 1 1  ON 17
 ud_8                -1.520070e-01 1 1  ON 18
 ud_9                -1.407000e-01 1 1  ON 19
 eO_0                -7.551704e-01 1 1  ON 20
 eO_1                -4.384851e-01 1 1  ON 21
 eO_2                -1.712206e-02 1 1  ON 22
 eO_3                 3.054915e-01 1 1  ON 23
 eO_4                 5.261907e-01 1 1  ON 24
 eO_5                 4.790987e-01 1 1  ON 25
 eO_6                 2.446140e-01 1 1  ON 26
 eO_7                -5.225941e-02 1 1  ON 27
 eO_8                -2.167122e-01 1 1  ON 28
 eO_9                -7.607454e-02 1 1  ON 29
eH1_0                -2.523018e-01 1 1  ON 30
eH1_1                -1.465459e-01 1 1  ON 31
eH1_2                -1.037945e-01 1 1  ON 32
eH1_3                -5.119748e-02 1 1  ON 33
eH1_4                 7.194554e-03 1 1  ON 34
eH1_5                 4.597294e-02 1 1  ON 35
eH1_6                 1.081508e-01 1 1  ON 36
eH1_7                 1.617741e-01 1 1  ON 37
eH1_8                 1.758952e-01 1 1  ON 38
eH1_9                 5.814153e-02 1 1  ON 39
eH2_0                -2.501610e-01 1 1  ON 40
eH2_1                -1.439595e-01 1 1  ON 41
eH2_2                -1.012699e-01 1 1  ON 42
eH2_3                -4.939966e-02 1 1  ON 43
eH2_4                 8.945684e-03 1 1  ON 44
eH2_5                 4.908682e-02 1 1  ON 45
eH2_6                 1.110259e-01 1 1  ON 46
eH2_7                 1.617598e-01 1 1  ON 47
eH2_8                 1.807401e-01 1 1  ON 48
eH2_9                 4.813824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0788e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9568
    reference variance = 0.21529
====================================================
  Execution time = 3.7217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4058e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7671e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340519165388
                                         uncertainty =       0.004693991699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340519165388
                                         uncertainty =       0.004693991699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412655284
  error estimate for blocks of size 2^( 2) =       0.000424591486
  error estimate for blocks of size 2^( 3) =       0.000437361745
  error estimate for blocks of size 2^( 4) =       0.000450044305
  error estimate for blocks of size 2^( 5) =       0.000460326672
  error estimate for blocks of size 2^( 6) =       0.000466156322
  error estimate for blocks of size 2^( 7) =       0.000472033658

      target function =                  N/A
              le_mean =     -16.909211524731
             les_mean =     286.262013882979
             stat err =       0.000462140239
             autocorr =       1.254217188647
              std dev =       0.583592036583
             le_variance =       0.340579665163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690921152473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909211524731       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909213528766       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909215617371       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909215033666       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909218278162       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909221209172       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909220532914       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909221270930       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909220810024       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909220193944       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909220532910       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909220344177       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.610093e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909211524731       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909212609405       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909213818911       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909213801630       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909214876037       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909215371908       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909214892554       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909215019897       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909215033610       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.376199e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909211524731       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909211907329       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909212401511       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909212516828       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909212511420       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909212746713       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909212614107       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909212676211       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.588355e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6994e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.098196e-01 1 1  ON 0
 uu_1                 1.446315e-01 1 1  ON 1
 uu_2                 4.674186e-02 1 1  ON 2
 uu_3                -1.658121e-02 1 1  ON 3
 uu_4                -6.612131e-02 1 1  ON 4
 uu_5                -1.019833e-01 1 1  ON 5
 uu_6                -1.289555e-01 1 1  ON 6
 uu_7                -1.417963e-01 1 1  ON 7
 uu_8                -1.341574e-01 1 1  ON 8
 uu_9                -1.028007e-01 1 1  ON 9
 ud_0                 4.338057e-01 1 1  ON 10
 ud_1                 1.768097e-01 1 1  ON 11
 ud_2                 6.300444e-02 1 1  ON 12
 ud_3                -6.069032e-03 1 1  ON 13
 ud_4                -6.144055e-02 1 1  ON 14
 ud_5                -1.034218e-01 1 1  ON 15
 ud_6                -1.323686e-01 1 1  ON 16
 ud_7                -1.504635e-01 1 1  ON 17
 ud_8                -1.522327e-01 1 1  ON 18
 ud_9                -1.409756e-01 1 1  ON 19
 eO_0                -7.550054e-01 1 1  ON 20
 eO_1                -4.384226e-01 1 1  ON 21
 eO_2                -1.705136e-02 1 1  ON 22
 eO_3                 3.054937e-01 1 1  ON 23
 eO_4                 5.262851e-01 1 1  ON 24
 eO_5                 4.792184e-01 1 1  ON 25
 eO_6                 2.447663e-01 1 1  ON 26
 eO_7                -5.220227e-02 1 1  ON 27
 eO_8                -2.170761e-01 1 1  ON 28
 eO_9                -7.641087e-02 1 1  ON 29
eH1_0                -2.526931e-01 1 1  ON 30
eH1_1                -1.469147e-01 1 1  ON 31
eH1_2                -1.039881e-01 1 1  ON 32
eH1_3                -5.138413e-02 1 1  ON 33
eH1_4                 6.945072e-03 1 1  ON 34
eH1_5                 4.641414e-02 1 1  ON 35
eH1_6                 1.081908e-01 1 1  ON 36
eH1_7                 1.619578e-01 1 1  ON 37
eH1_8                 1.762936e-01 1 1  ON 38
eH1_9                 5.848445e-02 1 1  ON 39
eH2_0                -2.506548e-01 1 1  ON 40
eH2_1                -1.443803e-01 1 1  ON 41
eH2_2                -1.017195e-01 1 1  ON 42
eH2_3                -4.960238e-02 1 1  ON 43
eH2_4                 8.684413e-03 1 1  ON 44
eH2_5                 4.901482e-02 1 1  ON 45
eH2_6                 1.113087e-01 1 1  ON 46
eH2_7                 1.620829e-01 1 1  ON 47
eH2_8                 1.812582e-01 1 1  ON 48
eH2_9                 4.877586e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9996
    reference variance = 0.248964
====================================================
  Execution time = 3.6984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4000e-01
  Total weights = 2.0001e+06
  Execution time = 4.4406e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340029092426
                                         uncertainty =       0.004394215470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340029092426
                                         uncertainty =       0.004394215470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412332363
  error estimate for blocks of size 2^( 2) =       0.000424165052
  error estimate for blocks of size 2^( 3) =       0.000436538342
  error estimate for blocks of size 2^( 4) =       0.000448580282
  error estimate for blocks of size 2^( 5) =       0.000459500059
  error estimate for blocks of size 2^( 6) =       0.000466386386
  error estimate for blocks of size 2^( 7) =       0.000470633983

      target function =                  N/A
              le_mean =     -16.909848645635
             les_mean =     286.283027884346
             stat err =       0.000461275177
             autocorr =       1.251484063093
              std dev =       0.583135349709
             le_variance =       0.340046836080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931538244
                                         uncertainty =       0.004393537893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931538244
                                         uncertainty =       0.004393537893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412273288
  error estimate for blocks of size 2^( 2) =       0.000424108255
  error estimate for blocks of size 2^( 3) =       0.000436484842
  error estimate for blocks of size 2^( 4) =       0.000448526760
  error estimate for blocks of size 2^( 5) =       0.000459443782
  error estimate for blocks of size 2^( 6) =       0.000466327875
  error estimate for blocks of size 2^( 7) =       0.000470579636

      target function =                  N/A
              le_mean =     -16.909851125616
             les_mean =     286.283014326937
             stat err =       0.000461219513
             autocorr =       1.251540625953
              std dev =       0.583051804212
             le_variance =       0.339949406394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931550108
                                         uncertainty =       0.004393019010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339931550108
                                         uncertainty =       0.004393019010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412273287
  error estimate for blocks of size 2^( 2) =       0.000424108759
  error estimate for blocks of size 2^( 3) =       0.000436487264
  error estimate for blocks of size 2^( 4) =       0.000448531247
  error estimate for blocks of size 2^( 5) =       0.000459451994
  error estimate for blocks of size 2^( 6) =       0.000466340816
  error estimate for blocks of size 2^( 7) =       0.000470592897

      target function =                  N/A
              le_mean =     -16.909850557688
             les_mean =     286.282995117749
             stat err =       0.000461229239
             autocorr =       1.251593415196
              std dev =       0.583051802487
             le_variance =       0.339949404383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340009596848
                                         uncertainty =       0.004393959274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340009596848
                                         uncertainty =       0.004393959274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412320556
  error estimate for blocks of size 2^( 2) =       0.000424153852
  error estimate for blocks of size 2^( 3) =       0.000436528351
  error estimate for blocks of size 2^( 4) =       0.000448570773
  error estimate for blocks of size 2^( 5) =       0.000459490776
  error estimate for blocks of size 2^( 6) =       0.000466377416
  error estimate for blocks of size 2^( 7) =       0.000470625558

      target function =                  N/A
              le_mean =     -16.909848726408
             les_mean =     286.283011142808
             stat err =       0.000461266131
             autocorr =       1.251506644924
              std dev =       0.583118652445
             le_variance =       0.340027362829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909848645635        initial
     9.5367e-02     9.5367e-01             2.6101e-03       -16.909851125616  <--
     3.8147e-01     3.8147e+00             6.3762e-04       -16.909850557688
     1.5259e+00     1.5259e+01             1.5884e-04       -16.909848726408

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 6.0317e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.100709e-01 1 1  ON 0
 uu_1                 1.447918e-01 1 1  ON 1
 uu_2                 4.692252e-02 1 1  ON 2
 uu_3                -1.651667e-02 1 1  ON 3
 uu_4                -6.623384e-02 1 1  ON 4
 uu_5                -1.023024e-01 1 1  ON 5
 uu_6                -1.292595e-01 1 1  ON 6
 uu_7                -1.424307e-01 1 1  ON 7
 uu_8                -1.345020e-01 1 1  ON 8
 uu_9                -1.033841e-01 1 1  ON 9
 ud_0                 4.338959e-01 1 1  ON 10
 ud_1                 1.768969e-01 1 1  ON 11
 ud_2                 6.319600e-02 1 1  ON 12
 ud_3                -5.881812e-03 1 1  ON 13
 ud_4                -6.123371e-02 1 1  ON 14
 ud_5                -1.031898e-01 1 1  ON 15
 ud_6                -1.322806e-01 1 1  ON 16
 ud_7                -1.501543e-01 1 1  ON 17
 ud_8                -1.525891e-01 1 1  ON 18
 ud_9                -1.416553e-01 1 1  ON 19
 eO_0                -7.546831e-01 1 1  ON 20
 eO_1                -4.381886e-01 1 1  ON 21
 eO_2                -1.675552e-02 1 1  ON 22
 eO_3                 3.056513e-01 1 1  ON 23
 eO_4                 5.264326e-01 1 1  ON 24
 eO_5                 4.796030e-01 1 1  ON 25
 eO_6                 2.451949e-01 1 1  ON 26
 eO_7                -5.203839e-02 1 1  ON 27
 eO_8                -2.181197e-01 1 1  ON 28
 eO_9                -7.742776e-02 1 1  ON 29
eH1_0                -2.537513e-01 1 1  ON 30
eH1_1                -1.477613e-01 1 1  ON 31
eH1_2                -1.046824e-01 1 1  ON 32
eH1_3                -5.198964e-02 1 1  ON 33
eH1_4                 6.416299e-03 1 1  ON 34
eH1_5                 4.700464e-02 1 1  ON 35
eH1_6                 1.084532e-01 1 1  ON 36
eH1_7                 1.626162e-01 1 1  ON 37
eH1_8                 1.775003e-01 1 1  ON 38
eH1_9                 5.954392e-02 1 1  ON 39
eH2_0                -2.520265e-01 1 1  ON 40
eH2_1                -1.455726e-01 1 1  ON 41
eH2_2                -1.028482e-01 1 1  ON 42
eH2_3                -5.046187e-02 1 1  ON 43
eH2_4                 7.889572e-03 1 1  ON 44
eH2_5                 4.872963e-02 1 1  ON 45
eH2_6                 1.119956e-01 1 1  ON 46
eH2_7                 1.630434e-01 1 1  ON 47
eH2_8                 1.828362e-01 1 1  ON 48
eH2_9                 5.074833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0734e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.207113
====================================================
  Execution time = 3.7581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4101e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0478e+01
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341093965735
                                         uncertainty =       0.004760595364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341093965735
                                         uncertainty =       0.004760595364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412913463
  error estimate for blocks of size 2^( 2) =       0.000424736418
  error estimate for blocks of size 2^( 3) =       0.000436942660
  error estimate for blocks of size 2^( 4) =       0.000449137695
  error estimate for blocks of size 2^( 5) =       0.000458876907
  error estimate for blocks of size 2^( 6) =       0.000467524137
  error estimate for blocks of size 2^( 7) =       0.000472895264

      target function =                  N/A
              le_mean =     -16.910246692858
             les_mean =     286.297449010880
             stat err =       0.000462108501
             autocorr =       1.252477199025
              std dev =       0.583957162862
             le_variance =       0.341005968058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691024669286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910246692858       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910244843014       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910248907914       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910252723947       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910255131517       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910255754210       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910254504197       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910260956598       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910264699105       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910266664365       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910267626776       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910272523132       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910271262089       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910271091094       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910270164257       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910269236208       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910269347482       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910269617225       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 8.948277e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910246692858       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910245278453       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910248191688       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910250362058       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910251745916       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910251576149       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910250499715       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910252296425       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910253603227       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910253997633       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910253665948       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910254273479       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910254197632       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.281133e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910246692858       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910245964372       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910247273641       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910248024952       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910248681978       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910248455086       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910248094249       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910248151360       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910248698067       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910248654340       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.811524e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8075e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.102598e-01 1 1  ON 0
 uu_1                 1.455482e-01 1 1  ON 1
 uu_2                 4.763413e-02 1 1  ON 2
 uu_3                -1.598869e-02 1 1  ON 3
 uu_4                -6.542964e-02 1 1  ON 4
 uu_5                -1.023054e-01 1 1  ON 5
 uu_6                -1.296300e-01 1 1  ON 6
 uu_7                -1.428721e-01 1 1  ON 7
 uu_8                -1.363262e-01 1 1  ON 8
 uu_9                -1.050462e-01 1 1  ON 9
 ud_0                 4.339916e-01 1 1  ON 10
 ud_1                 1.771775e-01 1 1  ON 11
 ud_2                 6.371473e-02 1 1  ON 12
 ud_3                -5.396246e-03 1 1  ON 13
 ud_4                -6.062593e-02 1 1  ON 14
 ud_5                -1.025291e-01 1 1  ON 15
 ud_6                -1.314037e-01 1 1  ON 16
 ud_7                -1.507095e-01 1 1  ON 17
 ud_8                -1.536618e-01 1 1  ON 18
 ud_9                -1.428563e-01 1 1  ON 19
 eO_0                -7.543854e-01 1 1  ON 20
 eO_1                -4.380636e-01 1 1  ON 21
 eO_2                -1.639993e-02 1 1  ON 22
 eO_3                 3.061303e-01 1 1  ON 23
 eO_4                 5.260923e-01 1 1  ON 24
 eO_5                 4.811173e-01 1 1  ON 25
 eO_6                 2.468559e-01 1 1  ON 26
 eO_7                -5.285910e-02 1 1  ON 27
 eO_8                -2.198541e-01 1 1  ON 28
 eO_9                -7.880541e-02 1 1  ON 29
eH1_0                -2.543113e-01 1 1  ON 30
eH1_1                -1.484743e-01 1 1  ON 31
eH1_2                -1.057589e-01 1 1  ON 32
eH1_3                -5.325808e-02 1 1  ON 33
eH1_4                 5.571198e-03 1 1  ON 34
eH1_5                 4.632135e-02 1 1  ON 35
eH1_6                 1.086371e-01 1 1  ON 36
eH1_7                 1.634163e-01 1 1  ON 37
eH1_8                 1.797814e-01 1 1  ON 38
eH1_9                 6.160675e-02 1 1  ON 39
eH2_0                -2.523409e-01 1 1  ON 40
eH2_1                -1.466665e-01 1 1  ON 41
eH2_2                -1.038523e-01 1 1  ON 42
eH2_3                -5.162016e-02 1 1  ON 43
eH2_4                 6.924798e-03 1 1  ON 44
eH2_5                 4.830096e-02 1 1  ON 45
eH2_6                 1.120266e-01 1 1  ON 46
eH2_7                 1.644475e-01 1 1  ON 47
eH2_8                 1.841679e-01 1 1  ON 48
eH2_9                 5.269510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8141
    reference variance = 0.33188
====================================================
  Execution time = 3.6830e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.0001e+06
  Execution time = 4.4482e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715368008
                                         uncertainty =       0.003865860477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715368008
                                         uncertainty =       0.003865860477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412154696
  error estimate for blocks of size 2^( 2) =       0.000423801524
  error estimate for blocks of size 2^( 3) =       0.000436380487
  error estimate for blocks of size 2^( 4) =       0.000447481473
  error estimate for blocks of size 2^( 5) =       0.000458928413
  error estimate for blocks of size 2^( 6) =       0.000467374936
  error estimate for blocks of size 2^( 7) =       0.000473155563

      target function =                  N/A
              le_mean =     -16.909598605976
             les_mean =     286.274278703362
             stat err =       0.000461735096
             autocorr =       1.255062252831
              std dev =       0.582884086262
             le_variance =       0.339753858018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339437668904
                                         uncertainty =       0.003855660895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339437668904
                                         uncertainty =       0.003855660895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411986262
  error estimate for blocks of size 2^( 2) =       0.000423628565
  error estimate for blocks of size 2^( 3) =       0.000436189478
  error estimate for blocks of size 2^( 4) =       0.000447264469
  error estimate for blocks of size 2^( 5) =       0.000458705692
  error estimate for blocks of size 2^( 6) =       0.000467142595
  error estimate for blocks of size 2^( 7) =       0.000472944835

      target function =                  N/A
              le_mean =     -16.909606611244
             les_mean =     286.274271799699
             stat err =       0.000461514398
             autocorr =       1.254888214135
              std dev =       0.582645880807
             le_variance =       0.339476222421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339001368466
                                         uncertainty =       0.003851162758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339001368466
                                         uncertainty =       0.003851162758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721421
  error estimate for blocks of size 2^( 2) =       0.000423377558
  error estimate for blocks of size 2^( 3) =       0.000435953632
  error estimate for blocks of size 2^( 4) =       0.000447050136
  error estimate for blocks of size 2^( 5) =       0.000458517261
  error estimate for blocks of size 2^( 6) =       0.000466976640
  error estimate for blocks of size 2^( 7) =       0.000472780583

      target function =                  N/A
              le_mean =     -16.909613635655
             les_mean =     286.274073044209
             stat err =       0.000461331155
             autocorr =       1.255505566572
              std dev =       0.582271334155
             le_variance =       0.339039906579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339500637370
                                         uncertainty =       0.003862632154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339500637370
                                         uncertainty =       0.003862632154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024430
  error estimate for blocks of size 2^( 2) =       0.000423674979
  error estimate for blocks of size 2^( 3) =       0.000436254610
  error estimate for blocks of size 2^( 4) =       0.000447357057
  error estimate for blocks of size 2^( 5) =       0.000458810984
  error estimate for blocks of size 2^( 6) =       0.000467262711
  error estimate for blocks of size 2^( 7) =       0.000473047961

      target function =                  N/A
              le_mean =     -16.909601053302
             les_mean =     286.274146739428
             stat err =       0.000461619678
             autocorr =       1.255228214148
              std dev =       0.582699860454
             le_variance =       0.339539127373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909598605976        initial
     2.3842e-02     2.3842e-01             8.9483e-03       -16.909606611244
     9.5367e-02     9.5367e-01             2.2811e-03       -16.909613635655  <--
     3.8147e-01     3.8147e+00             5.8115e-04       -16.909601053302

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 6.0183e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.102598e-01 1 1  ON 0
 uu_1                 1.455482e-01 1 1  ON 1
 uu_2                 4.763413e-02 1 1  ON 2
 uu_3                -1.598869e-02 1 1  ON 3
 uu_4                -6.542964e-02 1 1  ON 4
 uu_5                -1.023054e-01 1 1  ON 5
 uu_6                -1.296300e-01 1 1  ON 6
 uu_7                -1.428721e-01 1 1  ON 7
 uu_8                -1.363262e-01 1 1  ON 8
 uu_9                -1.050462e-01 1 1  ON 9
 ud_0                 4.339916e-01 1 1  ON 10
 ud_1                 1.771775e-01 1 1  ON 11
 ud_2                 6.371473e-02 1 1  ON 12
 ud_3                -5.396246e-03 1 1  ON 13
 ud_4                -6.062593e-02 1 1  ON 14
 ud_5                -1.025291e-01 1 1  ON 15
 ud_6                -1.314037e-01 1 1  ON 16
 ud_7                -1.507095e-01 1 1  ON 17
 ud_8                -1.536618e-01 1 1  ON 18
 ud_9                -1.428563e-01 1 1  ON 19
 eO_0                -7.543854e-01 1 1  ON 20
 eO_1                -4.380636e-01 1 1  ON 21
 eO_2                -1.639993e-02 1 1  ON 22
 eO_3                 3.061303e-01 1 1  ON 23
 eO_4                 5.260923e-01 1 1  ON 24
 eO_5                 4.811173e-01 1 1  ON 25
 eO_6                 2.468559e-01 1 1  ON 26
 eO_7                -5.285910e-02 1 1  ON 27
 eO_8                -2.198541e-01 1 1  ON 28
 eO_9                -7.880541e-02 1 1  ON 29
eH1_0                -2.543113e-01 1 1  ON 30
eH1_1                -1.484743e-01 1 1  ON 31
eH1_2                -1.057589e-01 1 1  ON 32
eH1_3                -5.325808e-02 1 1  ON 33
eH1_4                 5.571198e-03 1 1  ON 34
eH1_5                 4.632135e-02 1 1  ON 35
eH1_6                 1.086371e-01 1 1  ON 36
eH1_7                 1.634163e-01 1 1  ON 37
eH1_8                 1.797814e-01 1 1  ON 38
eH1_9                 6.160675e-02 1 1  ON 39
eH2_0                -2.523409e-01 1 1  ON 40
eH2_1                -1.466665e-01 1 1  ON 41
eH2_2                -1.038523e-01 1 1  ON 42
eH2_3                -5.162016e-02 1 1  ON 43
eH2_4                 6.924798e-03 1 1  ON 44
eH2_5                 4.830096e-02 1 1  ON 45
eH2_6                 1.120266e-01 1 1  ON 46
eH2_7                 1.644475e-01 1 1  ON 47
eH2_8                 1.841679e-01 1 1  ON 48
eH2_9                 5.269510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0828e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 0.267166
====================================================
  Execution time = 3.7278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9081e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125800342
                                         uncertainty =       0.004103599120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125800342
                                         uncertainty =       0.004103599120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134944
  error estimate for blocks of size 2^( 2) =       0.000423436091
  error estimate for blocks of size 2^( 3) =       0.000435922121
  error estimate for blocks of size 2^( 4) =       0.000447882176
  error estimate for blocks of size 2^( 5) =       0.000458652841
  error estimate for blocks of size 2^( 6) =       0.000467224982
  error estimate for blocks of size 2^( 7) =       0.000474419527

      target function =                  N/A
              le_mean =     -16.909294304493
             les_mean =     286.262308409908
             stat err =       0.000462044882
             autocorr =       1.262988932744
              std dev =       0.581441917127
             le_variance =       0.338074702992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690929430449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909294304493       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296870662       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296903320       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909298067884       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909301057960       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909300804349       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909299986525       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909302033659       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909304573624       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909302814756       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909305148083       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909306799794       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909304779978       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909305396707       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909306509627       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909306648540       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909306807468       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909306768318       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 7.957511e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909294304493       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296099168       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296090625       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909297183921       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909297812967       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909298087041       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909297375940       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909297757441       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909298283874       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909297890651       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909298517699       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909298628305       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.887064e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909294304493       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909295119306       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909295177746       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909295753592       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909295859594       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909295681145       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909295485024       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909295496674       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909295704881       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.799543e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7198e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.104406e-01 1 1  ON 0
 uu_1                 1.458894e-01 1 1  ON 1
 uu_2                 4.762994e-02 1 1  ON 2
 uu_3                -1.580758e-02 1 1  ON 3
 uu_4                -6.530295e-02 1 1  ON 4
 uu_5                -1.017761e-01 1 1  ON 5
 uu_6                -1.296517e-01 1 1  ON 6
 uu_7                -1.433425e-01 1 1  ON 7
 uu_8                -1.371171e-01 1 1  ON 8
 uu_9                -1.065529e-01 1 1  ON 9
 ud_0                 4.348487e-01 1 1  ON 10
 ud_1                 1.779803e-01 1 1  ON 11
 ud_2                 6.422230e-02 1 1  ON 12
 ud_3                -4.879713e-03 1 1  ON 13
 ud_4                -6.045917e-02 1 1  ON 14
 ud_5                -1.027001e-01 1 1  ON 15
 ud_6                -1.316429e-01 1 1  ON 16
 ud_7                -1.504834e-01 1 1  ON 17
 ud_8                -1.538693e-01 1 1  ON 18
 ud_9                -1.445704e-01 1 1  ON 19
 eO_0                -7.545347e-01 1 1  ON 20
 eO_1                -4.378045e-01 1 1  ON 21
 eO_2                -1.598601e-02 1 1  ON 22
 eO_3                 3.068115e-01 1 1  ON 23
 eO_4                 5.271773e-01 1 1  ON 24
 eO_5                 4.813940e-01 1 1  ON 25
 eO_6                 2.469776e-01 1 1  ON 26
 eO_7                -5.216305e-02 1 1  ON 27
 eO_8                -2.213166e-01 1 1  ON 28
 eO_9                -8.051438e-02 1 1  ON 29
eH1_0                -2.553201e-01 1 1  ON 30
eH1_1                -1.492841e-01 1 1  ON 31
eH1_2                -1.066167e-01 1 1  ON 32
eH1_3                -5.391116e-02 1 1  ON 33
eH1_4                 4.670408e-03 1 1  ON 34
eH1_5                 4.600235e-02 1 1  ON 35
eH1_6                 1.089534e-01 1 1  ON 36
eH1_7                 1.640413e-01 1 1  ON 37
eH1_8                 1.811881e-01 1 1  ON 38
eH1_9                 6.349382e-02 1 1  ON 39
eH2_0                -2.534273e-01 1 1  ON 40
eH2_1                -1.477433e-01 1 1  ON 41
eH2_2                -1.050303e-01 1 1  ON 42
eH2_3                -5.215577e-02 1 1  ON 43
eH2_4                 6.223549e-03 1 1  ON 44
eH2_5                 4.754565e-02 1 1  ON 45
eH2_6                 1.121299e-01 1 1  ON 46
eH2_7                 1.659259e-01 1 1  ON 47
eH2_8                 1.859297e-01 1 1  ON 48
eH2_9                 5.456582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8488
    reference variance = 0.163078
====================================================
  Execution time = 3.7055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3523e-01
  Total weights = 2.0001e+06
  Execution time = 4.4661e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335005474469
                                         uncertainty =       0.003091634512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335005474469
                                         uncertainty =       0.003091634512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409191288
  error estimate for blocks of size 2^( 2) =       0.000420885970
  error estimate for blocks of size 2^( 3) =       0.000433421827
  error estimate for blocks of size 2^( 4) =       0.000444894924
  error estimate for blocks of size 2^( 5) =       0.000453915172
  error estimate for blocks of size 2^( 6) =       0.000460549559
  error estimate for blocks of size 2^( 7) =       0.000463087586

      target function =                  N/A
              le_mean =     -16.909527223065
             les_mean =     286.266996476456
             stat err =       0.000455611810
             autocorr =       1.239758770060
              std dev =       0.578693127935
             le_variance =       0.334885736320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335563923106
                                         uncertainty =       0.003094868339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335563923106
                                         uncertainty =       0.003094868339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409532068
  error estimate for blocks of size 2^( 2) =       0.000421202503
  error estimate for blocks of size 2^( 3) =       0.000433704709
  error estimate for blocks of size 2^( 4) =       0.000445135510
  error estimate for blocks of size 2^( 5) =       0.000454128614
  error estimate for blocks of size 2^( 6) =       0.000460739793
  error estimate for blocks of size 2^( 7) =       0.000463271048

      target function =                  N/A
              le_mean =     -16.909530820368
             les_mean =     286.267676161112
             stat err =       0.000455818742
             autocorr =       1.238820906246
              std dev =       0.579175071857
             le_variance =       0.335443763860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335718027033
                                         uncertainty =       0.003095682875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335718027033
                                         uncertainty =       0.003095682875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409626130
  error estimate for blocks of size 2^( 2) =       0.000421291863
  error estimate for blocks of size 2^( 3) =       0.000433792800
  error estimate for blocks of size 2^( 4) =       0.000445221176
  error estimate for blocks of size 2^( 5) =       0.000454220673
  error estimate for blocks of size 2^( 6) =       0.000460844640
  error estimate for blocks of size 2^( 7) =       0.000463370703

      target function =                  N/A
              le_mean =     -16.909530048239
             les_mean =     286.267804156095
             stat err =       0.000455914298
             autocorr =       1.238771255890
              std dev =       0.579308097283
             le_variance =       0.335597871577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335179253844
                                         uncertainty =       0.003092572039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335179253844
                                         uncertainty =       0.003092572039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409297396
  error estimate for blocks of size 2^( 2) =       0.000420984002
  error estimate for blocks of size 2^( 3) =       0.000433511219
  error estimate for blocks of size 2^( 4) =       0.000444972999
  error estimate for blocks of size 2^( 5) =       0.000453989238
  error estimate for blocks of size 2^( 6) =       0.000460622645
  error estimate for blocks of size 2^( 7) =       0.000463154658

      target function =                  N/A
              le_mean =     -16.909527052930
             les_mean =     286.267164424214
             stat err =       0.000455684885
             autocorr =       1.239513564610
              std dev =       0.578843189441
             le_variance =       0.335059437962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909527223065        initial
     2.3842e-02     2.3842e-01             7.9575e-03       -16.909530820368  <--
     9.5367e-02     9.5367e-01             1.8871e-03       -16.909530048239
     3.8147e-01     3.8147e+00             4.7995e-04       -16.909527052930

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 6.0448e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.107779e-01 1 1  ON 0
 uu_1                 1.462809e-01 1 1  ON 1
 uu_2                 4.790991e-02 1 1  ON 2
 uu_3                -1.555814e-02 1 1  ON 3
 uu_4                -6.514984e-02 1 1  ON 4
 uu_5                -1.017087e-01 1 1  ON 5
 uu_6                -1.299069e-01 1 1  ON 6
 uu_7                -1.445061e-01 1 1  ON 7
 uu_8                -1.385319e-01 1 1  ON 8
 uu_9                -1.095992e-01 1 1  ON 9
 ud_0                 4.361217e-01 1 1  ON 10
 ud_1                 1.791719e-01 1 1  ON 11
 ud_2                 6.530553e-02 1 1  ON 12
 ud_3                -3.935521e-03 1 1  ON 13
 ud_4                -5.975923e-02 1 1  ON 14
 ud_5                -1.023364e-01 1 1  ON 15
 ud_6                -1.315967e-01 1 1  ON 16
 ud_7                -1.507666e-01 1 1  ON 17
 ud_8                -1.542456e-01 1 1  ON 18
 ud_9                -1.472754e-01 1 1  ON 19
 eO_0                -7.537952e-01 1 1  ON 20
 eO_1                -4.368789e-01 1 1  ON 21
 eO_2                -1.476099e-02 1 1  ON 22
 eO_3                 3.084080e-01 1 1  ON 23
 eO_4                 5.290374e-01 1 1  ON 24
 eO_5                 4.828101e-01 1 1  ON 25
 eO_6                 2.475246e-01 1 1  ON 26
 eO_7                -5.095360e-02 1 1  ON 27
 eO_8                -2.250797e-01 1 1  ON 28
 eO_9                -8.559031e-02 1 1  ON 29
eH1_0                -2.580081e-01 1 1  ON 30
eH1_1                -1.518424e-01 1 1  ON 31
eH1_2                -1.091205e-01 1 1  ON 32
eH1_3                -5.620112e-02 1 1  ON 33
eH1_4                 2.455328e-03 1 1  ON 34
eH1_5                 4.467415e-02 1 1  ON 35
eH1_6                 1.090723e-01 1 1  ON 36
eH1_7                 1.661253e-01 1 1  ON 37
eH1_8                 1.854410e-01 1 1  ON 38
eH1_9                 6.948707e-02 1 1  ON 39
eH2_0                -2.564434e-01 1 1  ON 40
eH2_1                -1.505892e-01 1 1  ON 41
eH2_2                -1.077876e-01 1 1  ON 42
eH2_3                -5.462883e-02 1 1  ON 43
eH2_4                 4.042620e-03 1 1  ON 44
eH2_5                 4.581598e-02 1 1  ON 45
eH2_6                 1.119711e-01 1 1  ON 46
eH2_7                 1.692831e-01 1 1  ON 47
eH2_8                 1.910982e-01 1 1  ON 48
eH2_9                 6.065262e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9835
    reference variance = 0.305645
====================================================
  Execution time = 3.7550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0057e+01
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338538861825
                                         uncertainty =       0.005244806637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338538861825
                                         uncertainty =       0.005244806637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411420486
  error estimate for blocks of size 2^( 2) =       0.000423580888
  error estimate for blocks of size 2^( 3) =       0.000435759920
  error estimate for blocks of size 2^( 4) =       0.000447526135
  error estimate for blocks of size 2^( 5) =       0.000458682681
  error estimate for blocks of size 2^( 6) =       0.000467932488
  error estimate for blocks of size 2^( 7) =       0.000474535350

      target function =                  N/A
              le_mean =     -16.910116994391
             les_mean =     286.290601060594
             stat err =       0.000462169163
             autocorr =       1.261915005258
              std dev =       0.581845740618
             le_variance =       0.338544465875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691011699439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116994391       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910124858607       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910131209482       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910130362728       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910134341235       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910135768433       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910140315677       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910146474848       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910150146154       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910148574865       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910152987825       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910157534896       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910169198449       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910176257487       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910178063557       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910177640335       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910178728101       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910179295596       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910180481888       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910179952172       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910179371885       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910178280382       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910178593020       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910179069447       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910179493376       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 3.403380e-02

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116994391       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910123860776       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910128824838       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910127867549       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910130946630       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910131773813       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910135238983       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910138676328       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910139539944       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910137812100       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910138702226       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910139491320       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910141926185       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910142747384       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910142774383       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910142633453       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910142617221       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 8.674505e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116994391       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910121549113       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910124237321       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910123420547       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910125246461       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910125184757       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910126839385       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910127652651       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910126993887       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910126936455       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910126981688       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910127012935       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.132490e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7627e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.117894e-01 1 1  ON 0
 uu_1                 1.465292e-01 1 1  ON 1
 uu_2                 4.837735e-02 1 1  ON 2
 uu_3                -1.536597e-02 1 1  ON 3
 uu_4                -6.555179e-02 1 1  ON 4
 uu_5                -1.027318e-01 1 1  ON 5
 uu_6                -1.310988e-01 1 1  ON 6
 uu_7                -1.453842e-01 1 1  ON 7
 uu_8                -1.382717e-01 1 1  ON 8
 uu_9                -1.115491e-01 1 1  ON 9
 ud_0                 4.365507e-01 1 1  ON 10
 ud_1                 1.799151e-01 1 1  ON 11
 ud_2                 6.605219e-02 1 1  ON 12
 ud_3                -2.874534e-03 1 1  ON 13
 ud_4                -5.876505e-02 1 1  ON 14
 ud_5                -1.009878e-01 1 1  ON 15
 ud_6                -1.302683e-01 1 1  ON 16
 ud_7                -1.501578e-01 1 1  ON 17
 ud_8                -1.533076e-01 1 1  ON 18
 ud_9                -1.482526e-01 1 1  ON 19
 eO_0                -7.524914e-01 1 1  ON 20
 eO_1                -4.354563e-01 1 1  ON 21
 eO_2                -1.331358e-02 1 1  ON 22
 eO_3                 3.104036e-01 1 1  ON 23
 eO_4                 5.315412e-01 1 1  ON 24
 eO_5                 4.850215e-01 1 1  ON 25
 eO_6                 2.485369e-01 1 1  ON 26
 eO_7                -5.076343e-02 1 1  ON 27
 eO_8                -2.288322e-01 1 1  ON 28
 eO_9                -9.278741e-02 1 1  ON 29
eH1_0                -2.626374e-01 1 1  ON 30
eH1_1                -1.557505e-01 1 1  ON 31
eH1_2                -1.129929e-01 1 1  ON 32
eH1_3                -5.975418e-02 1 1  ON 33
eH1_4                -5.208020e-04 1 1  ON 34
eH1_5                 4.274317e-02 1 1  ON 35
eH1_6                 1.102873e-01 1 1  ON 36
eH1_7                 1.699599e-01 1 1  ON 37
eH1_8                 1.928017e-01 1 1  ON 38
eH1_9                 7.804170e-02 1 1  ON 39
eH2_0                -2.608125e-01 1 1  ON 40
eH2_1                -1.543693e-01 1 1  ON 41
eH2_2                -1.110198e-01 1 1  ON 42
eH2_3                -5.813578e-02 1 1  ON 43
eH2_4                 1.083547e-04 1 1  ON 44
eH2_5                 4.399316e-02 1 1  ON 45
eH2_6                 1.135443e-01 1 1  ON 46
eH2_7                 1.731518e-01 1 1  ON 47
eH2_8                 1.977762e-01 1 1  ON 48
eH2_9                 6.932712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8578
    reference variance = 0.187014
====================================================
  Execution time = 3.7055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4637e-01
  Total weights = 2.0001e+06
  Execution time = 4.4564e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346615362835
                                         uncertainty =       0.008033951690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346615362835
                                         uncertainty =       0.008033951690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416237393
  error estimate for blocks of size 2^( 2) =       0.000427437623
  error estimate for blocks of size 2^( 3) =       0.000439931030
  error estimate for blocks of size 2^( 4) =       0.000451417067
  error estimate for blocks of size 2^( 5) =       0.000460454062
  error estimate for blocks of size 2^( 6) =       0.000467545065
  error estimate for blocks of size 2^( 7) =       0.000474133345

      target function =                  N/A
              le_mean =     -16.909967720409
             les_mean =     286.293526354812
             stat err =       0.000463387385
             autocorr =       1.239384976025
              std dev =       0.588657984550
             le_variance =       0.346518222775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346664686834
                                         uncertainty =       0.008034765812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346664686834
                                         uncertainty =       0.008034765812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416266985
  error estimate for blocks of size 2^( 2) =       0.000427475868
  error estimate for blocks of size 2^( 3) =       0.000439966120
  error estimate for blocks of size 2^( 4) =       0.000451414477
  error estimate for blocks of size 2^( 5) =       0.000460404061
  error estimate for blocks of size 2^( 6) =       0.000467436212
  error estimate for blocks of size 2^( 7) =       0.000473990385

      target function =                  N/A
              le_mean =     -16.909965219593
             les_mean =     286.293491050525
             stat err =       0.000463311284
             autocorr =       1.238801774602
              std dev =       0.588699835192
             le_variance =       0.346567495955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346353599128
                                         uncertainty =       0.008024835007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346353599128
                                         uncertainty =       0.008024835007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416080199
  error estimate for blocks of size 2^( 2) =       0.000427309400
  error estimate for blocks of size 2^( 3) =       0.000439830790
  error estimate for blocks of size 2^( 4) =       0.000451313581
  error estimate for blocks of size 2^( 5) =       0.000460337602
  error estimate for blocks of size 2^( 6) =       0.000467394995
  error estimate for blocks of size 2^( 7) =       0.000473944890

      target function =                  N/A
              le_mean =     -16.909968347569
             les_mean =     286.293285886312
             stat err =       0.000463247767
             autocorr =       1.239574325146
              std dev =       0.588435675025
             le_variance =       0.346256543642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346418958180
                                         uncertainty =       0.008029047034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346418958180
                                         uncertainty =       0.008029047034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416119460
  error estimate for blocks of size 2^( 2) =       0.000427329497
  error estimate for blocks of size 2^( 3) =       0.000439834511
  error estimate for blocks of size 2^( 4) =       0.000451325314
  error estimate for blocks of size 2^( 5) =       0.000460364132
  error estimate for blocks of size 2^( 6) =       0.000467451087
  error estimate for blocks of size 2^( 7) =       0.000474028217

      target function =                  N/A
              le_mean =     -16.909963634657
             les_mean =     286.293191844493
             stat err =       0.000463292188
             autocorr =       1.239578117374
              std dev =       0.588491199776
             le_variance =       0.346321892213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909967720409        initial
     5.9605e-03     5.9605e-02             3.4034e-02       -16.909965219593
     2.3842e-02     2.3842e-01             8.6745e-03       -16.909968347569  <--
     9.5367e-02     9.5367e-01             2.1325e-03       -16.909963634657

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 6.0485e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.117894e-01 1 1  ON 0
 uu_1                 1.465292e-01 1 1  ON 1
 uu_2                 4.837735e-02 1 1  ON 2
 uu_3                -1.536597e-02 1 1  ON 3
 uu_4                -6.555179e-02 1 1  ON 4
 uu_5                -1.027318e-01 1 1  ON 5
 uu_6                -1.310988e-01 1 1  ON 6
 uu_7                -1.453842e-01 1 1  ON 7
 uu_8                -1.382717e-01 1 1  ON 8
 uu_9                -1.115491e-01 1 1  ON 9
 ud_0                 4.365507e-01 1 1  ON 10
 ud_1                 1.799151e-01 1 1  ON 11
 ud_2                 6.605219e-02 1 1  ON 12
 ud_3                -2.874534e-03 1 1  ON 13
 ud_4                -5.876505e-02 1 1  ON 14
 ud_5                -1.009878e-01 1 1  ON 15
 ud_6                -1.302683e-01 1 1  ON 16
 ud_7                -1.501578e-01 1 1  ON 17
 ud_8                -1.533076e-01 1 1  ON 18
 ud_9                -1.482526e-01 1 1  ON 19
 eO_0                -7.524914e-01 1 1  ON 20
 eO_1                -4.354563e-01 1 1  ON 21
 eO_2                -1.331358e-02 1 1  ON 22
 eO_3                 3.104036e-01 1 1  ON 23
 eO_4                 5.315412e-01 1 1  ON 24
 eO_5                 4.850215e-01 1 1  ON 25
 eO_6                 2.485369e-01 1 1  ON 26
 eO_7                -5.076343e-02 1 1  ON 27
 eO_8                -2.288322e-01 1 1  ON 28
 eO_9                -9.278741e-02 1 1  ON 29
eH1_0                -2.626374e-01 1 1  ON 30
eH1_1                -1.557505e-01 1 1  ON 31
eH1_2                -1.129929e-01 1 1  ON 32
eH1_3                -5.975418e-02 1 1  ON 33
eH1_4                -5.208020e-04 1 1  ON 34
eH1_5                 4.274317e-02 1 1  ON 35
eH1_6                 1.102873e-01 1 1  ON 36
eH1_7                 1.699599e-01 1 1  ON 37
eH1_8                 1.928017e-01 1 1  ON 38
eH1_9                 7.804170e-02 1 1  ON 39
eH2_0                -2.608125e-01 1 1  ON 40
eH2_1                -1.543693e-01 1 1  ON 41
eH2_2                -1.110198e-01 1 1  ON 42
eH2_3                -5.813578e-02 1 1  ON 43
eH2_4                 1.083547e-04 1 1  ON 44
eH2_5                 4.399316e-02 1 1  ON 45
eH2_6                 1.135443e-01 1 1  ON 46
eH2_7                 1.731518e-01 1 1  ON 47
eH2_8                 1.977762e-01 1 1  ON 48
eH2_9                 6.932712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0812e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8407
    reference variance = 0.19787
====================================================
  Execution time = 4.0031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4590e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9903e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345913162160
                                         uncertainty =       0.006711359550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345913162160
                                         uncertainty =       0.006711359550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415868484
  error estimate for blocks of size 2^( 2) =       0.000427705351
  error estimate for blocks of size 2^( 3) =       0.000439408095
  error estimate for blocks of size 2^( 4) =       0.000451054700
  error estimate for blocks of size 2^( 5) =       0.000460794406
  error estimate for blocks of size 2^( 6) =       0.000468941258
  error estimate for blocks of size 2^( 7) =       0.000472452407

      target function =                  N/A
              le_mean =     -16.909802991959
             les_mean =     286.287341314064
             stat err =       0.000463310693
             autocorr =       1.241173884651
              std dev =       0.588136259842
             le_variance =       0.345904260141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690980299196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909802991959       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808869936       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909806904444       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909807513657       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909809627086       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909815311309       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909817946458       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909819444270       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909825142852       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909830680504       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909839451491       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909841070067       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909837811610       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909843420509       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909845504939       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909844503692       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909846039072       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909846280033       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909845366080       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909847518975       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909848585717       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909848013972       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909848398993       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.909848460747       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909847707471       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 3.701872e-02

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909802991959       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808368349       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909806518939       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909807231401       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808810801       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909813346166       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909814911077       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909815273326       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909817891603       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909818670317       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909822214041       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909820104222       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909820015859       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909819907366       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909820506161       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909820169833       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909820246628       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 9.324507e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909802991959       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909807000202       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909805546956       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909806407413       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909806669605       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909809487469       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909809627632       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909809516622       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909809756982       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909809694632       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909810374110       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909810288160       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.304704e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0041e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.104027e-01 1 1  ON 0
 uu_1                 1.456281e-01 1 1  ON 1
 uu_2                 4.742083e-02 1 1  ON 2
 uu_3                -1.602421e-02 1 1  ON 3
 uu_4                -6.634209e-02 1 1  ON 4
 uu_5                -1.033282e-01 1 1  ON 5
 uu_6                -1.317924e-01 1 1  ON 6
 uu_7                -1.462882e-01 1 1  ON 7
 uu_8                -1.396599e-01 1 1  ON 8
 uu_9                -1.110570e-01 1 1  ON 9
 ud_0                 4.379167e-01 1 1  ON 10
 ud_1                 1.807944e-01 1 1  ON 11
 ud_2                 6.676736e-02 1 1  ON 12
 ud_3                -2.702058e-03 1 1  ON 13
 ud_4                -5.849865e-02 1 1  ON 14
 ud_5                -1.017003e-01 1 1  ON 15
 ud_6                -1.313406e-01 1 1  ON 16
 ud_7                -1.516334e-01 1 1  ON 17
 ud_8                -1.550966e-01 1 1  ON 18
 ud_9                -1.476239e-01 1 1  ON 19
 eO_0                -7.508774e-01 1 1  ON 20
 eO_1                -4.335514e-01 1 1  ON 21
 eO_2                -1.124535e-02 1 1  ON 22
 eO_3                 3.107346e-01 1 1  ON 23
 eO_4                 5.318869e-01 1 1  ON 24
 eO_5                 4.879298e-01 1 1  ON 25
 eO_6                 2.506893e-01 1 1  ON 26
 eO_7                -5.225345e-02 1 1  ON 27
 eO_8                -2.334812e-01 1 1  ON 28
 eO_9                -9.704661e-02 1 1  ON 29
eH1_0                -2.666709e-01 1 1  ON 30
eH1_1                -1.597265e-01 1 1  ON 31
eH1_2                -1.161686e-01 1 1  ON 32
eH1_3                -6.335496e-02 1 1  ON 33
eH1_4                -2.974030e-03 1 1  ON 34
eH1_5                 4.155623e-02 1 1  ON 35
eH1_6                 1.099934e-01 1 1  ON 36
eH1_7                 1.717892e-01 1 1  ON 37
eH1_8                 1.983389e-01 1 1  ON 38
eH1_9                 8.702822e-02 1 1  ON 39
eH2_0                -2.635614e-01 1 1  ON 40
eH2_1                -1.571876e-01 1 1  ON 41
eH2_2                -1.139871e-01 1 1  ON 42
eH2_3                -6.138325e-02 1 1  ON 43
eH2_4                -2.281422e-03 1 1  ON 44
eH2_5                 4.219441e-02 1 1  ON 45
eH2_6                 1.130520e-01 1 1  ON 46
eH2_7                 1.728215e-01 1 1  ON 47
eH2_8                 2.046741e-01 1 1  ON 48
eH2_9                 7.865163e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9476
    reference variance = 0.188984
====================================================
  Execution time = 3.6793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.0001e+06
  Execution time = 4.4609e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337397702155
                                         uncertainty =       0.006630810924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337397702155
                                         uncertainty =       0.006630810924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410650856
  error estimate for blocks of size 2^( 2) =       0.000422501057
  error estimate for blocks of size 2^( 3) =       0.000434627317
  error estimate for blocks of size 2^( 4) =       0.000446517866
  error estimate for blocks of size 2^( 5) =       0.000455763207
  error estimate for blocks of size 2^( 6) =       0.000463279110
  error estimate for blocks of size 2^( 7) =       0.000467500965

      target function =                  N/A
              le_mean =     -16.909674510975
             les_mean =     286.274370942077
             stat err =       0.000458265287
             autocorr =       1.245341490730
              std dev =       0.580757301799
             le_variance =       0.337279043593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337989795756
                                         uncertainty =       0.006631471855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337989795756
                                         uncertainty =       0.006631471855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411010737
  error estimate for blocks of size 2^( 2) =       0.000422841243
  error estimate for blocks of size 2^( 3) =       0.000434937082
  error estimate for blocks of size 2^( 4) =       0.000446785741
  error estimate for blocks of size 2^( 5) =       0.000455979411
  error estimate for blocks of size 2^( 6) =       0.000463464509
  error estimate for blocks of size 2^( 7) =       0.000467619688

      target function =                  N/A
              le_mean =     -16.909675754458
             les_mean =     286.275004415095
             stat err =       0.000458462337
             autocorr =       1.244230931964
              std dev =       0.581266258360
             le_variance =       0.337870463108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338187546790
                                         uncertainty =       0.006629820109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338187546790
                                         uncertainty =       0.006629820109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411130990
  error estimate for blocks of size 2^( 2) =       0.000422955181
  error estimate for blocks of size 2^( 3) =       0.000435050486
  error estimate for blocks of size 2^( 4) =       0.000446907332
  error estimate for blocks of size 2^( 5) =       0.000456117661
  error estimate for blocks of size 2^( 6) =       0.000463611504
  error estimate for blocks of size 2^( 7) =       0.000467774369

      target function =                  N/A
              le_mean =     -16.909680667313
             les_mean =     286.275368300384
             stat err =       0.000458602716
             autocorr =       1.244264809820
              std dev =       0.581436324052
             le_variance =       0.338068198927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337665433875
                                         uncertainty =       0.006631400757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337665433875
                                         uncertainty =       0.006631400757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410813676
  error estimate for blocks of size 2^( 2) =       0.000422651497
  error estimate for blocks of size 2^( 3) =       0.000434765209
  error estimate for blocks of size 2^( 4) =       0.000446645974
  error estimate for blocks of size 2^( 5) =       0.000455882859
  error estimate for blocks of size 2^( 6) =       0.000463395178
  error estimate for blocks of size 2^( 7) =       0.000467603703

      target function =                  N/A
              le_mean =     -16.909672813310
             les_mean =     286.274581038296
             stat err =       0.000458381929
             autocorr =       1.244988068822
              std dev =       0.580987567726
             le_variance =       0.337546553852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909674510975        initial
     5.9605e-03     5.9605e-02             3.7019e-02       -16.909675754458
     2.3842e-02     2.3842e-01             9.3245e-03       -16.909680667313  <--
     9.5367e-02     9.5367e-01             2.3047e-03       -16.909672813310

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 6.0073e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.104027e-01 1 1  ON 0
 uu_1                 1.456281e-01 1 1  ON 1
 uu_2                 4.742083e-02 1 1  ON 2
 uu_3                -1.602421e-02 1 1  ON 3
 uu_4                -6.634209e-02 1 1  ON 4
 uu_5                -1.033282e-01 1 1  ON 5
 uu_6                -1.317924e-01 1 1  ON 6
 uu_7                -1.462882e-01 1 1  ON 7
 uu_8                -1.396599e-01 1 1  ON 8
 uu_9                -1.110570e-01 1 1  ON 9
 ud_0                 4.379167e-01 1 1  ON 10
 ud_1                 1.807944e-01 1 1  ON 11
 ud_2                 6.676736e-02 1 1  ON 12
 ud_3                -2.702058e-03 1 1  ON 13
 ud_4                -5.849865e-02 1 1  ON 14
 ud_5                -1.017003e-01 1 1  ON 15
 ud_6                -1.313406e-01 1 1  ON 16
 ud_7                -1.516334e-01 1 1  ON 17
 ud_8                -1.550966e-01 1 1  ON 18
 ud_9                -1.476239e-01 1 1  ON 19
 eO_0                -7.508774e-01 1 1  ON 20
 eO_1                -4.335514e-01 1 1  ON 21
 eO_2                -1.124535e-02 1 1  ON 22
 eO_3                 3.107346e-01 1 1  ON 23
 eO_4                 5.318869e-01 1 1  ON 24
 eO_5                 4.879298e-01 1 1  ON 25
 eO_6                 2.506893e-01 1 1  ON 26
 eO_7                -5.225345e-02 1 1  ON 27
 eO_8                -2.334812e-01 1 1  ON 28
 eO_9                -9.704661e-02 1 1  ON 29
eH1_0                -2.666709e-01 1 1  ON 30
eH1_1                -1.597265e-01 1 1  ON 31
eH1_2                -1.161686e-01 1 1  ON 32
eH1_3                -6.335496e-02 1 1  ON 33
eH1_4                -2.974030e-03 1 1  ON 34
eH1_5                 4.155623e-02 1 1  ON 35
eH1_6                 1.099934e-01 1 1  ON 36
eH1_7                 1.717892e-01 1 1  ON 37
eH1_8                 1.983389e-01 1 1  ON 38
eH1_9                 8.702822e-02 1 1  ON 39
eH2_0                -2.635614e-01 1 1  ON 40
eH2_1                -1.571876e-01 1 1  ON 41
eH2_2                -1.139871e-01 1 1  ON 42
eH2_3                -6.138325e-02 1 1  ON 43
eH2_4                -2.281422e-03 1 1  ON 44
eH2_5                 4.219441e-02 1 1  ON 45
eH2_6                 1.130520e-01 1 1  ON 46
eH2_7                 1.728215e-01 1 1  ON 47
eH2_8                 2.046741e-01 1 1  ON 48
eH2_9                 7.865163e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1012e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8413
    reference variance = 0.177445
====================================================
  Execution time = 3.7392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4869e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9146e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348727953071
                                         uncertainty =       0.006817020257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348727953071
                                         uncertainty =       0.006817020257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417541743
  error estimate for blocks of size 2^( 2) =       0.000429428729
  error estimate for blocks of size 2^( 3) =       0.000441898897
  error estimate for blocks of size 2^( 4) =       0.000454068104
  error estimate for blocks of size 2^( 5) =       0.000464784866
  error estimate for blocks of size 2^( 6) =       0.000473586200
  error estimate for blocks of size 2^( 7) =       0.000478887629

      target function =                  N/A
              le_mean =     -16.909541055885
             les_mean =     286.281271918238
             stat err =       0.000467831700
             autocorr =       1.255392391196
              std dev =       0.590502643438
             le_variance =       0.348693371908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690954105589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909541055885       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909544084519       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909545231355       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909544102995       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909541381691       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909545330684       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909548477157       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909559270049       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909557294824       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909554660191       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909556001318       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909572900023       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909573832479       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909574783774       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909570521686       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909571866638       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909572100084       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909575110267       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909576330812       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909577411682       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909576182990       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909577033539       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909577903584       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 4.189516e-02

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909541055885       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909543848225       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909544899952       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909543896832       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909541694489       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909544834888       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909547164517       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909552536027       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909550366606       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909549508011       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909548662639       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909553149843       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909554116196       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909553175076       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909552508905       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909552054421       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909552594854       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 1.070522e-02

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909541055885       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909543184062       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909544019344       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909543340609       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909542542856       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909543217843       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909544925068       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909545106747       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909544849477       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909544784310       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909544533453       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909545218666       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909545494200       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.713502e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7324e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.105284e-01 1 1  ON 0
 uu_1                 1.452000e-01 1 1  ON 1
 uu_2                 4.684533e-02 1 1  ON 2
 uu_3                -1.685811e-02 1 1  ON 3
 uu_4                -6.710112e-02 1 1  ON 4
 uu_5                -1.045584e-01 1 1  ON 5
 uu_6                -1.338016e-01 1 1  ON 6
 uu_7                -1.484447e-01 1 1  ON 7
 uu_8                -1.418000e-01 1 1  ON 8
 uu_9                -1.133007e-01 1 1  ON 9
 ud_0                 4.379257e-01 1 1  ON 10
 ud_1                 1.808582e-01 1 1  ON 11
 ud_2                 6.665800e-02 1 1  ON 12
 ud_3                -2.608903e-03 1 1  ON 13
 ud_4                -5.878434e-02 1 1  ON 14
 ud_5                -1.018273e-01 1 1  ON 15
 ud_6                -1.314803e-01 1 1  ON 16
 ud_7                -1.519131e-01 1 1  ON 17
 ud_8                -1.559173e-01 1 1  ON 18
 ud_9                -1.458040e-01 1 1  ON 19
 eO_0                -7.504417e-01 1 1  ON 20
 eO_1                -4.331655e-01 1 1  ON 21
 eO_2                -1.075221e-02 1 1  ON 22
 eO_3                 3.130446e-01 1 1  ON 23
 eO_4                 5.353628e-01 1 1  ON 24
 eO_5                 4.898885e-01 1 1  ON 25
 eO_6                 2.519323e-01 1 1  ON 26
 eO_7                -5.253450e-02 1 1  ON 27
 eO_8                -2.391236e-01 1 1  ON 28
 eO_9                -1.011032e-01 1 1  ON 29
eH1_0                -2.691776e-01 1 1  ON 30
eH1_1                -1.624326e-01 1 1  ON 31
eH1_2                -1.191148e-01 1 1  ON 32
eH1_3                -6.610352e-02 1 1  ON 33
eH1_4                -6.735392e-03 1 1  ON 34
eH1_5                 3.802142e-02 1 1  ON 35
eH1_6                 1.098966e-01 1 1  ON 36
eH1_7                 1.750823e-01 1 1  ON 37
eH1_8                 2.043912e-01 1 1  ON 38
eH1_9                 9.401022e-02 1 1  ON 39
eH2_0                -2.665724e-01 1 1  ON 40
eH2_1                -1.607530e-01 1 1  ON 41
eH2_2                -1.168358e-01 1 1  ON 42
eH2_3                -6.347001e-02 1 1  ON 43
eH2_4                -3.570750e-03 1 1  ON 44
eH2_5                 3.972897e-02 1 1  ON 45
eH2_6                 1.105069e-01 1 1  ON 46
eH2_7                 1.728740e-01 1 1  ON 47
eH2_8                 2.090762e-01 1 1  ON 48
eH2_9                 8.935685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9311
    reference variance = 0.242156
====================================================
  Execution time = 3.7133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4390e-01
  Total weights = 2.0001e+06
  Execution time = 4.4640e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343541028784
                                         uncertainty =       0.007921632793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343541028784
                                         uncertainty =       0.007921632793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414444200
  error estimate for blocks of size 2^( 2) =       0.000426537591
  error estimate for blocks of size 2^( 3) =       0.000438934409
  error estimate for blocks of size 2^( 4) =       0.000451620630
  error estimate for blocks of size 2^( 5) =       0.000461706856
  error estimate for blocks of size 2^( 6) =       0.000468619470
  error estimate for blocks of size 2^( 7) =       0.000474035253

      target function =                  N/A
              le_mean =     -16.910590979927
             les_mean =     286.311626101008
             stat err =       0.000463995552
             autocorr =       1.253416776100
              std dev =       0.586121985914
             le_variance =       0.343538982371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344214752139
                                         uncertainty =       0.007931896795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344214752139
                                         uncertainty =       0.007931896795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414850278
  error estimate for blocks of size 2^( 2) =       0.000426944355
  error estimate for blocks of size 2^( 3) =       0.000439328532
  error estimate for blocks of size 2^( 4) =       0.000451977605
  error estimate for blocks of size 2^( 5) =       0.000462005610
  error estimate for blocks of size 2^( 6) =       0.000468830088
  error estimate for blocks of size 2^( 7) =       0.000474159445

      target function =                  N/A
              le_mean =     -16.910593017408
             les_mean =     286.312368549154
             stat err =       0.000464243187
             autocorr =       1.252299788412
              std dev =       0.586696276484
             le_variance =       0.344212520841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344297297212
                                         uncertainty =       0.007928120808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344297297212
                                         uncertainty =       0.007928120808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414899939
  error estimate for blocks of size 2^( 2) =       0.000427001341
  error estimate for blocks of size 2^( 3) =       0.000439398226
  error estimate for blocks of size 2^( 4) =       0.000452064248
  error estimate for blocks of size 2^( 5) =       0.000462110644
  error estimate for blocks of size 2^( 6) =       0.000468948904
  error estimate for blocks of size 2^( 7) =       0.000474285758

      target function =                  N/A
              le_mean =     -16.910593474525
             les_mean =     286.312466423715
             stat err =       0.000464352389
             autocorr =       1.252589095677
              std dev =       0.586766508242
             le_variance =       0.344294935194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343704427863
                                         uncertainty =       0.007921596466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343704427863
                                         uncertainty =       0.007921596466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414542692
  error estimate for blocks of size 2^( 2) =       0.000426636098
  error estimate for blocks of size 2^( 3) =       0.000439033416
  error estimate for blocks of size 2^( 4) =       0.000451715002
  error estimate for blocks of size 2^( 5) =       0.000461794494
  error estimate for blocks of size 2^( 6) =       0.000468688403
  error estimate for blocks of size 2^( 7) =       0.000474087425

      target function =                  N/A
              le_mean =     -16.910587554085
             les_mean =     286.311673538449
             stat err =       0.000464071331
             autocorr =       1.253230488839
              std dev =       0.586261277867
             le_variance =       0.343702285926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910590979927        initial
     5.9605e-03     5.9605e-02             4.1895e-02       -16.910593017408
     2.3842e-02     2.3842e-01             1.0705e-02       -16.910593474525  <--
     9.5367e-02     9.5367e-01             2.7135e-03       -16.910587554085

*****************************************************************************
Applying the update for shift_i =   2.3842e-02     and shift_s =   2.3842e-01
*****************************************************************************

  Execution time = 6.0399e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.105284e-01 1 1  ON 0
 uu_1                 1.452000e-01 1 1  ON 1
 uu_2                 4.684533e-02 1 1  ON 2
 uu_3                -1.685811e-02 1 1  ON 3
 uu_4                -6.710112e-02 1 1  ON 4
 uu_5                -1.045584e-01 1 1  ON 5
 uu_6                -1.338016e-01 1 1  ON 6
 uu_7                -1.484447e-01 1 1  ON 7
 uu_8                -1.418000e-01 1 1  ON 8
 uu_9                -1.133007e-01 1 1  ON 9
 ud_0                 4.379257e-01 1 1  ON 10
 ud_1                 1.808582e-01 1 1  ON 11
 ud_2                 6.665800e-02 1 1  ON 12
 ud_3                -2.608903e-03 1 1  ON 13
 ud_4                -5.878434e-02 1 1  ON 14
 ud_5                -1.018273e-01 1 1  ON 15
 ud_6                -1.314803e-01 1 1  ON 16
 ud_7                -1.519131e-01 1 1  ON 17
 ud_8                -1.559173e-01 1 1  ON 18
 ud_9                -1.458040e-01 1 1  ON 19
 eO_0                -7.504417e-01 1 1  ON 20
 eO_1                -4.331655e-01 1 1  ON 21
 eO_2                -1.075221e-02 1 1  ON 22
 eO_3                 3.130446e-01 1 1  ON 23
 eO_4                 5.353628e-01 1 1  ON 24
 eO_5                 4.898885e-01 1 1  ON 25
 eO_6                 2.519323e-01 1 1  ON 26
 eO_7                -5.253450e-02 1 1  ON 27
 eO_8                -2.391236e-01 1 1  ON 28
 eO_9                -1.011032e-01 1 1  ON 29
eH1_0                -2.691776e-01 1 1  ON 30
eH1_1                -1.624326e-01 1 1  ON 31
eH1_2                -1.191148e-01 1 1  ON 32
eH1_3                -6.610352e-02 1 1  ON 33
eH1_4                -6.735392e-03 1 1  ON 34
eH1_5                 3.802142e-02 1 1  ON 35
eH1_6                 1.098966e-01 1 1  ON 36
eH1_7                 1.750823e-01 1 1  ON 37
eH1_8                 2.043912e-01 1 1  ON 38
eH1_9                 9.401022e-02 1 1  ON 39
eH2_0                -2.665724e-01 1 1  ON 40
eH2_1                -1.607530e-01 1 1  ON 41
eH2_2                -1.168358e-01 1 1  ON 42
eH2_3                -6.347001e-02 1 1  ON 43
eH2_4                -3.570750e-03 1 1  ON 44
eH2_5                 3.972897e-02 1 1  ON 45
eH2_6                 1.105069e-01 1 1  ON 46
eH2_7                 1.728740e-01 1 1  ON 47
eH2_8                 2.090762e-01 1 1  ON 48
eH2_9                 8.935685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0773e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8351
    reference variance = 0.289553
====================================================
  Execution time = 3.7087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3650e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.6660e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336144295830
                                         uncertainty =       0.003030877001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336144295830
                                         uncertainty =       0.003030877001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410175598
  error estimate for blocks of size 2^( 2) =       0.000422065516
  error estimate for blocks of size 2^( 3) =       0.000433457698
  error estimate for blocks of size 2^( 4) =       0.000444484800
  error estimate for blocks of size 2^( 5) =       0.000454462317
  error estimate for blocks of size 2^( 6) =       0.000461144714
  error estimate for blocks of size 2^( 7) =       0.000463753682

      target function =                  N/A
              le_mean =     -16.910066520386
             les_mean =     286.286848365198
             stat err =       0.000455961378
             autocorr =       1.235709758875
              std dev =       0.580085174402
             le_variance =       0.336498809561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691006652039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-03, overlap shift 5.9605e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910066520386       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910072186123       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910075463688       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910082909808       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910085536704       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910087001115       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910085954253       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910083715446       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910094779758       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910105239940       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910113115521       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910123842529       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910125087947       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910126827732       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910129522482       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910129157734       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910129991029       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910133194615       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910132232946       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910132229199       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910131385185       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910130576720       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910130524333       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910130291860       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-03 is 3.729612e-02

solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910066520386       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071656763       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910073821941       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910079563755       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910081086592       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910081738214       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910080353659       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910078969224       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910087893453       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910091611726       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910094340387       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910094766817       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910093895310       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910093220194       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910093696900       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910093302632       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910093474000       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 9.735842e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910066520386       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910070259395       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910070795451       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910073800603       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910073983757       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910074003522       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910072764414       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910072946043       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910076100545       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910076622717       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910077027077       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910076475779       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.405289e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6771e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.107454e-01 1 1  ON 0
 uu_1                 1.453117e-01 1 1  ON 1
 uu_2                 4.734076e-02 1 1  ON 2
 uu_3                -1.628265e-02 1 1  ON 3
 uu_4                -6.648463e-02 1 1  ON 4
 uu_5                -1.041231e-01 1 1  ON 5
 uu_6                -1.331211e-01 1 1  ON 6
 uu_7                -1.489970e-01 1 1  ON 7
 uu_8                -1.432264e-01 1 1  ON 8
 uu_9                -1.161171e-01 1 1  ON 9
 ud_0                 4.393218e-01 1 1  ON 10
 ud_1                 1.823687e-01 1 1  ON 11
 ud_2                 6.834997e-02 1 1  ON 12
 ud_3                -1.071256e-03 1 1  ON 13
 ud_4                -5.709774e-02 1 1  ON 14
 ud_5                -1.004772e-01 1 1  ON 15
 ud_6                -1.308944e-01 1 1  ON 16
 ud_7                -1.524418e-01 1 1  ON 17
 ud_8                -1.573636e-01 1 1  ON 18
 ud_9                -1.490059e-01 1 1  ON 19
 eO_0                -7.474071e-01 1 1  ON 20
 eO_1                -4.303078e-01 1 1  ON 21
 eO_2                -8.399114e-03 1 1  ON 22
 eO_3                 3.153868e-01 1 1  ON 23
 eO_4                 5.359750e-01 1 1  ON 24
 eO_5                 4.918106e-01 1 1  ON 25
 eO_6                 2.544429e-01 1 1  ON 26
 eO_7                -5.430726e-02 1 1  ON 27
 eO_8                -2.461937e-01 1 1  ON 28
 eO_9                -1.067607e-01 1 1  ON 29
eH1_0                -2.700243e-01 1 1  ON 30
eH1_1                -1.636153e-01 1 1  ON 31
eH1_2                -1.202157e-01 1 1  ON 32
eH1_3                -6.704369e-02 1 1  ON 33
eH1_4                -7.398743e-03 1 1  ON 34
eH1_5                 3.704691e-02 1 1  ON 35
eH1_6                 1.076083e-01 1 1  ON 36
eH1_7                 1.740923e-01 1 1  ON 37
eH1_8                 2.072515e-01 1 1  ON 38
eH1_9                 9.957193e-02 1 1  ON 39
eH2_0                -2.703673e-01 1 1  ON 40
eH2_1                -1.636930e-01 1 1  ON 41
eH2_2                -1.196212e-01 1 1  ON 42
eH2_3                -6.616628e-02 1 1  ON 43
eH2_4                -6.423335e-03 1 1  ON 44
eH2_5                 3.767020e-02 1 1  ON 45
eH2_6                 1.093150e-01 1 1  ON 46
eH2_7                 1.747172e-01 1 1  ON 47
eH2_8                 2.145692e-01 1 1  ON 48
eH2_9                 9.909269e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9544
    reference variance = 0.158898
====================================================
  Execution time = 3.6788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3966e-01
  Total weights = 2.0001e+06
  Execution time = 4.4739e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225440225
                                         uncertainty =       0.003947383310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225440225
                                         uncertainty =       0.003947383310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412388702
  error estimate for blocks of size 2^( 2) =       0.000424336699
  error estimate for blocks of size 2^( 3) =       0.000436959957
  error estimate for blocks of size 2^( 4) =       0.000448227029
  error estimate for blocks of size 2^( 5) =       0.000459078587
  error estimate for blocks of size 2^( 6) =       0.000467230107
  error estimate for blocks of size 2^( 7) =       0.000472639737

      target function =                  N/A
              le_mean =     -16.909953501153
             les_mean =     286.286667007899
             stat err =       0.000461793865
             autocorr =       1.253957452298
              std dev =       0.583215026208
             le_variance =       0.340139766795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339757970125
                                         uncertainty =       0.003945098371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339757970125
                                         uncertainty =       0.003945098371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412105428
  error estimate for blocks of size 2^( 2) =       0.000424037207
  error estimate for blocks of size 2^( 3) =       0.000436639623
  error estimate for blocks of size 2^( 4) =       0.000447882842
  error estimate for blocks of size 2^( 5) =       0.000458739262
  error estimate for blocks of size 2^( 6) =       0.000466904957
  error estimate for blocks of size 2^( 7) =       0.000472306557

      target function =                  N/A
              le_mean =     -16.909951548675
             les_mean =     286.286133844889
             stat err =       0.000461458404
             autocorr =       1.253858277508
              std dev =       0.582814409714
             le_variance =       0.339672636170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339285340434
                                         uncertainty =       0.003941490452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339285340434
                                         uncertainty =       0.003941490452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411818728
  error estimate for blocks of size 2^( 2) =       0.000423763742
  error estimate for blocks of size 2^( 3) =       0.000436386981
  error estimate for blocks of size 2^( 4) =       0.000447654185
  error estimate for blocks of size 2^( 5) =       0.000458546188
  error estimate for blocks of size 2^( 6) =       0.000466750497
  error estimate for blocks of size 2^( 7) =       0.000472160615

      target function =                  N/A
              le_mean =     -16.909950091844
             les_mean =     286.285612121796
             stat err =       0.000461277871
             autocorr =       1.254622457609
              std dev =       0.582408948016
             le_variance =       0.339200182729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840319512
                                         uncertainty =       0.003944710757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840319512
                                         uncertainty =       0.003944710757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155273
  error estimate for blocks of size 2^( 2) =       0.000424107303
  error estimate for blocks of size 2^( 3) =       0.000436736556
  error estimate for blocks of size 2^( 4) =       0.000448008357
  error estimate for blocks of size 2^( 5) =       0.000458875449
  error estimate for blocks of size 2^( 6) =       0.000467041692
  error estimate for blocks of size 2^( 7) =       0.000472453824

      target function =                  N/A
              le_mean =     -16.909949200530
             les_mean =     286.286136605066
             stat err =       0.000461594830
             autocorr =       1.254296328776
              std dev =       0.582884903246
             le_variance =       0.339754810432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909953501153        initial  <--
     5.9605e-03     5.9605e-02             3.7296e-02       -16.909951548675
     2.3842e-02     2.3842e-01             9.7358e-03       -16.909950091844
     9.5367e-02     9.5367e-01             2.4053e-03       -16.909949200530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0330
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.105284e-01 1 1  ON 0
 uu_1                 1.452000e-01 1 1  ON 1
 uu_2                 4.684533e-02 1 1  ON 2
 uu_3                -1.685811e-02 1 1  ON 3
 uu_4                -6.710112e-02 1 1  ON 4
 uu_5                -1.045584e-01 1 1  ON 5
 uu_6                -1.338016e-01 1 1  ON 6
 uu_7                -1.484447e-01 1 1  ON 7
 uu_8                -1.418000e-01 1 1  ON 8
 uu_9                -1.133007e-01 1 1  ON 9
 ud_0                 4.379257e-01 1 1  ON 10
 ud_1                 1.808582e-01 1 1  ON 11
 ud_2                 6.665800e-02 1 1  ON 12
 ud_3                -2.608903e-03 1 1  ON 13
 ud_4                -5.878434e-02 1 1  ON 14
 ud_5                -1.018273e-01 1 1  ON 15
 ud_6                -1.314803e-01 1 1  ON 16
 ud_7                -1.519131e-01 1 1  ON 17
 ud_8                -1.559173e-01 1 1  ON 18
 ud_9                -1.458040e-01 1 1  ON 19
 eO_0                -7.504417e-01 1 1  ON 20
 eO_1                -4.331655e-01 1 1  ON 21
 eO_2                -1.075221e-02 1 1  ON 22
 eO_3                 3.130446e-01 1 1  ON 23
 eO_4                 5.353628e-01 1 1  ON 24
 eO_5                 4.898885e-01 1 1  ON 25
 eO_6                 2.519323e-01 1 1  ON 26
 eO_7                -5.253450e-02 1 1  ON 27
 eO_8                -2.391236e-01 1 1  ON 28
 eO_9                -1.011032e-01 1 1  ON 29
eH1_0                -2.691776e-01 1 1  ON 30
eH1_1                -1.624326e-01 1 1  ON 31
eH1_2                -1.191148e-01 1 1  ON 32
eH1_3                -6.610352e-02 1 1  ON 33
eH1_4                -6.735392e-03 1 1  ON 34
eH1_5                 3.802142e-02 1 1  ON 35
eH1_6                 1.098966e-01 1 1  ON 36
eH1_7                 1.750823e-01 1 1  ON 37
eH1_8                 2.043912e-01 1 1  ON 38
eH1_9                 9.401022e-02 1 1  ON 39
eH2_0                -2.665724e-01 1 1  ON 40
eH2_1                -1.607530e-01 1 1  ON 41
eH2_2                -1.168358e-01 1 1  ON 42
eH2_3                -6.347001e-02 1 1  ON 43
eH2_4                -3.570750e-03 1 1  ON 44
eH2_5                 3.972897e-02 1 1  ON 45
eH2_6                 1.105069e-01 1 1  ON 46
eH2_7                 1.728740e-01 1 1  ON 47
eH2_8                 2.090762e-01 1 1  ON 48
eH2_9                 8.935685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0981e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.207152
====================================================
  Execution time = 3.6941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3382e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.6618e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333850441992
                                         uncertainty =       0.002893151898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333850441992
                                         uncertainty =       0.002893151898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408541678
  error estimate for blocks of size 2^( 2) =       0.000420772230
  error estimate for blocks of size 2^( 3) =       0.000433074422
  error estimate for blocks of size 2^( 4) =       0.000445678554
  error estimate for blocks of size 2^( 5) =       0.000456766017
  error estimate for blocks of size 2^( 6) =       0.000465565278
  error estimate for blocks of size 2^( 7) =       0.000474667439

      target function =                  N/A
              le_mean =     -16.910086948695
             les_mean =     286.284863733210
             stat err =       0.000460669322
             autocorr =       1.271469205157
              std dev =       0.577774426301
             le_variance =       0.333823287687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691008694870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910086948695       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910085641760       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910082723311       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910082962676       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910083522448       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910083497676       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910085764682       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910085891874       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910085441745       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910087594585       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910087021132       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910086870357       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910086805111       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 4.224157e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910086948695       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910086146293       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084355316       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910083896459       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084563620       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084310389       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910083965729       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910085059233       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910084739554       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910084880226       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.060145e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910086948695       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910086633307       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910085852964       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910085519875       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910085676040       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910085518440       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910085435080       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910085724982       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910085668324       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.675293e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6613e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.104693e-01 1 1  ON 0
 uu_1                 1.451208e-01 1 1  ON 1
 uu_2                 4.691851e-02 1 1  ON 2
 uu_3                -1.683533e-02 1 1  ON 3
 uu_4                -6.730005e-02 1 1  ON 4
 uu_5                -1.047066e-01 1 1  ON 5
 uu_6                -1.336309e-01 1 1  ON 6
 uu_7                -1.487922e-01 1 1  ON 7
 uu_8                -1.417884e-01 1 1  ON 8
 uu_9                -1.134786e-01 1 1  ON 9
 ud_0                 4.378207e-01 1 1  ON 10
 ud_1                 1.807985e-01 1 1  ON 11
 ud_2                 6.682960e-02 1 1  ON 12
 ud_3                -2.395875e-03 1 1  ON 13
 ud_4                -5.881145e-02 1 1  ON 14
 ud_5                -1.016635e-01 1 1  ON 15
 ud_6                -1.315633e-01 1 1  ON 16
 ud_7                -1.520645e-01 1 1  ON 17
 ud_8                -1.558658e-01 1 1  ON 18
 ud_9                -1.460125e-01 1 1  ON 19
 eO_0                -7.499625e-01 1 1  ON 20
 eO_1                -4.331136e-01 1 1  ON 21
 eO_2                -1.070403e-02 1 1  ON 22
 eO_3                 3.133799e-01 1 1  ON 23
 eO_4                 5.353734e-01 1 1  ON 24
 eO_5                 4.901784e-01 1 1  ON 25
 eO_6                 2.520603e-01 1 1  ON 26
 eO_7                -5.274379e-02 1 1  ON 27
 eO_8                -2.396870e-01 1 1  ON 28
 eO_9                -1.016201e-01 1 1  ON 29
eH1_0                -2.695854e-01 1 1  ON 30
eH1_1                -1.628412e-01 1 1  ON 31
eH1_2                -1.195131e-01 1 1  ON 32
eH1_3                -6.637179e-02 1 1  ON 33
eH1_4                -6.940820e-03 1 1  ON 34
eH1_5                 3.797124e-02 1 1  ON 35
eH1_6                 1.094784e-01 1 1  ON 36
eH1_7                 1.751257e-01 1 1  ON 37
eH1_8                 2.052024e-01 1 1  ON 38
eH1_9                 9.507037e-02 1 1  ON 39
eH2_0                -2.667849e-01 1 1  ON 40
eH2_1                -1.603410e-01 1 1  ON 41
eH2_2                -1.169733e-01 1 1  ON 42
eH2_3                -6.380797e-02 1 1  ON 43
eH2_4                -3.792995e-03 1 1  ON 44
eH2_5                 3.934640e-02 1 1  ON 45
eH2_6                 1.103036e-01 1 1  ON 46
eH2_7                 1.731743e-01 1 1  ON 47
eH2_8                 2.093076e-01 1 1  ON 48
eH2_9                 8.993506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.917
    reference variance = 0.182471
====================================================
  Execution time = 3.6974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4185e-01
  Total weights = 2.0001e+06
  Execution time = 4.4484e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342112962675
                                         uncertainty =       0.005023552571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342112962675
                                         uncertainty =       0.005023552571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413563098
  error estimate for blocks of size 2^( 2) =       0.000425014581
  error estimate for blocks of size 2^( 3) =       0.000437107635
  error estimate for blocks of size 2^( 4) =       0.000448465304
  error estimate for blocks of size 2^( 5) =       0.000458403760
  error estimate for blocks of size 2^( 6) =       0.000467584575
  error estimate for blocks of size 2^( 7) =       0.000476306182

      target function =                  N/A
              le_mean =     -16.910498482257
             les_mean =     286.307038566044
             stat err =       0.000462689955
             autocorr =       1.251689421824
              std dev =       0.584875900231
             le_variance =       0.342079818671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757732617
                                         uncertainty =       0.005009761171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757732617
                                         uncertainty =       0.005009761171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413348322
  error estimate for blocks of size 2^( 2) =       0.000424811672
  error estimate for blocks of size 2^( 3) =       0.000436913304
  error estimate for blocks of size 2^( 4) =       0.000448274878
  error estimate for blocks of size 2^( 5) =       0.000458221698
  error estimate for blocks of size 2^( 6) =       0.000467398426
  error estimate for blocks of size 2^( 7) =       0.000476100460

      target function =                  N/A
              le_mean =     -16.910497733237
             les_mean =     286.306658020150
             stat err =       0.000462498866
             autocorr =       1.251955769718
              std dev =       0.584572155670
             le_variance =       0.341724605184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341663637303
                                         uncertainty =       0.005006039611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341663637303
                                         uncertainty =       0.005006039611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413291404
  error estimate for blocks of size 2^( 2) =       0.000424759081
  error estimate for blocks of size 2^( 3) =       0.000436865158
  error estimate for blocks of size 2^( 4) =       0.000448231067
  error estimate for blocks of size 2^( 5) =       0.000458183333
  error estimate for blocks of size 2^( 6) =       0.000467355178
  error estimate for blocks of size 2^( 7) =       0.000476054371

      target function =                  N/A
              le_mean =     -16.910498230127
             les_mean =     286.306580720952
             stat err =       0.000462455987
             autocorr =       1.252068439716
              std dev =       0.584491660010
             le_variance =       0.341630500621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342015588904
                                         uncertainty =       0.005020002827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342015588904
                                         uncertainty =       0.005020002827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413504233
  error estimate for blocks of size 2^( 2) =       0.000424959002
  error estimate for blocks of size 2^( 3) =       0.000437054842
  error estimate for blocks of size 2^( 4) =       0.000448414238
  error estimate for blocks of size 2^( 5) =       0.000458355590
  error estimate for blocks of size 2^( 6) =       0.000467533719
  error estimate for blocks of size 2^( 7) =       0.000476250720

      target function =                  N/A
              le_mean =     -16.910497900641
             les_mean =     286.306921520718
             stat err =       0.000462638567
             autocorr =       1.251767721710
              std dev =       0.584792650532
             le_variance =       0.341982444117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910498482257        initial  <--
     5.9605e-02     5.9605e-01             4.2242e-03       -16.910497733237
     2.3842e-01     2.3842e+00             1.0601e-03       -16.910498230127
     9.5367e-01     9.5367e+00             2.6753e-04       -16.910497900641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3084
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.105284e-01 1 1  ON 0
 uu_1                 1.452000e-01 1 1  ON 1
 uu_2                 4.684533e-02 1 1  ON 2
 uu_3                -1.685811e-02 1 1  ON 3
 uu_4                -6.710112e-02 1 1  ON 4
 uu_5                -1.045584e-01 1 1  ON 5
 uu_6                -1.338016e-01 1 1  ON 6
 uu_7                -1.484447e-01 1 1  ON 7
 uu_8                -1.418000e-01 1 1  ON 8
 uu_9                -1.133007e-01 1 1  ON 9
 ud_0                 4.379257e-01 1 1  ON 10
 ud_1                 1.808582e-01 1 1  ON 11
 ud_2                 6.665800e-02 1 1  ON 12
 ud_3                -2.608903e-03 1 1  ON 13
 ud_4                -5.878434e-02 1 1  ON 14
 ud_5                -1.018273e-01 1 1  ON 15
 ud_6                -1.314803e-01 1 1  ON 16
 ud_7                -1.519131e-01 1 1  ON 17
 ud_8                -1.559173e-01 1 1  ON 18
 ud_9                -1.458040e-01 1 1  ON 19
 eO_0                -7.504417e-01 1 1  ON 20
 eO_1                -4.331655e-01 1 1  ON 21
 eO_2                -1.075221e-02 1 1  ON 22
 eO_3                 3.130446e-01 1 1  ON 23
 eO_4                 5.353628e-01 1 1  ON 24
 eO_5                 4.898885e-01 1 1  ON 25
 eO_6                 2.519323e-01 1 1  ON 26
 eO_7                -5.253450e-02 1 1  ON 27
 eO_8                -2.391236e-01 1 1  ON 28
 eO_9                -1.011032e-01 1 1  ON 29
eH1_0                -2.691776e-01 1 1  ON 30
eH1_1                -1.624326e-01 1 1  ON 31
eH1_2                -1.191148e-01 1 1  ON 32
eH1_3                -6.610352e-02 1 1  ON 33
eH1_4                -6.735392e-03 1 1  ON 34
eH1_5                 3.802142e-02 1 1  ON 35
eH1_6                 1.098966e-01 1 1  ON 36
eH1_7                 1.750823e-01 1 1  ON 37
eH1_8                 2.043912e-01 1 1  ON 38
eH1_9                 9.401022e-02 1 1  ON 39
eH2_0                -2.665724e-01 1 1  ON 40
eH2_1                -1.607530e-01 1 1  ON 41
eH2_2                -1.168358e-01 1 1  ON 42
eH2_3                -6.347001e-02 1 1  ON 43
eH2_4                -3.570750e-03 1 1  ON 44
eH2_5                 3.972897e-02 1 1  ON 45
eH2_6                 1.105069e-01 1 1  ON 46
eH2_7                 1.728740e-01 1 1  ON 47
eH2_8                 2.090762e-01 1 1  ON 48
eH2_9                 8.935685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0694e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.833
    reference variance = 0.429513
====================================================
  Execution time = 3.7069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4408e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8132e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344086356074
                                         uncertainty =       0.004362152743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344086356074
                                         uncertainty =       0.004362152743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414770164
  error estimate for blocks of size 2^( 2) =       0.000426510596
  error estimate for blocks of size 2^( 3) =       0.000439244062
  error estimate for blocks of size 2^( 4) =       0.000452000441
  error estimate for blocks of size 2^( 5) =       0.000462721352
  error estimate for blocks of size 2^( 6) =       0.000472200296
  error estimate for blocks of size 2^( 7) =       0.000479714156

      target function =                  N/A
              le_mean =     -16.909840535301
             les_mean =     286.286786345911
             stat err =       0.000466659062
             autocorr =       1.265856247029
              std dev =       0.586582976766
             le_variance =       0.344079588632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690984053530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909840535301       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909841475261       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909841519104       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909842054893       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909842096223       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909841817928       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909842099905       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909842375194       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909842279298       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.704060e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909840535301       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909840846644       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909840861806       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909840988220       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909840933078       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909840956189       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909841009085       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909841046318       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 9.111028e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909840535301       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909840620018       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909840624556       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909840653791       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909840633695       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909840643884       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909840659688       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909840666669       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.288135e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6891e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.105047e-01 1 1  ON 0
 uu_1                 1.451953e-01 1 1  ON 1
 uu_2                 4.685399e-02 1 1  ON 2
 uu_3                -1.687359e-02 1 1  ON 3
 uu_4                -6.713263e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337883e-01 1 1  ON 6
 uu_7                -1.484374e-01 1 1  ON 7
 uu_8                -1.417964e-01 1 1  ON 8
 uu_9                -1.133097e-01 1 1  ON 9
 ud_0                 4.378845e-01 1 1  ON 10
 ud_1                 1.808263e-01 1 1  ON 11
 ud_2                 6.669365e-02 1 1  ON 12
 ud_3                -2.564265e-03 1 1  ON 13
 ud_4                -5.879665e-02 1 1  ON 14
 ud_5                -1.017972e-01 1 1  ON 15
 ud_6                -1.314828e-01 1 1  ON 16
 ud_7                -1.518915e-01 1 1  ON 17
 ud_8                -1.559366e-01 1 1  ON 18
 ud_9                -1.458179e-01 1 1  ON 19
 eO_0                -7.504050e-01 1 1  ON 20
 eO_1                -4.331395e-01 1 1  ON 21
 eO_2                -1.081010e-02 1 1  ON 22
 eO_3                 3.130724e-01 1 1  ON 23
 eO_4                 5.353915e-01 1 1  ON 24
 eO_5                 4.899233e-01 1 1  ON 25
 eO_6                 2.519622e-01 1 1  ON 26
 eO_7                -5.257418e-02 1 1  ON 27
 eO_8                -2.391604e-01 1 1  ON 28
 eO_9                -1.011437e-01 1 1  ON 29
eH1_0                -2.692042e-01 1 1  ON 30
eH1_1                -1.624726e-01 1 1  ON 31
eH1_2                -1.191464e-01 1 1  ON 32
eH1_3                -6.613433e-02 1 1  ON 33
eH1_4                -6.749349e-03 1 1  ON 34
eH1_5                 3.797952e-02 1 1  ON 35
eH1_6                 1.098680e-01 1 1  ON 36
eH1_7                 1.751123e-01 1 1  ON 37
eH1_8                 2.044575e-01 1 1  ON 38
eH1_9                 9.410133e-02 1 1  ON 39
eH2_0                -2.666237e-01 1 1  ON 40
eH2_1                -1.607332e-01 1 1  ON 41
eH2_2                -1.168548e-01 1 1  ON 42
eH2_3                -6.349955e-02 1 1  ON 43
eH2_4                -3.611591e-03 1 1  ON 44
eH2_5                 3.967331e-02 1 1  ON 45
eH2_6                 1.105191e-01 1 1  ON 46
eH2_7                 1.729311e-01 1 1  ON 47
eH2_8                 2.091114e-01 1 1  ON 48
eH2_9                 8.942314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.353468
====================================================
  Execution time = 3.6723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4140e-01
  Total weights = 2.0001e+06
  Execution time = 4.4642e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341489220856
                                         uncertainty =       0.004598445096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341489220856
                                         uncertainty =       0.004598445096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413180979
  error estimate for blocks of size 2^( 2) =       0.000424922113
  error estimate for blocks of size 2^( 3) =       0.000437073476
  error estimate for blocks of size 2^( 4) =       0.000448598779
  error estimate for blocks of size 2^( 5) =       0.000458031800
  error estimate for blocks of size 2^( 6) =       0.000464155906
  error estimate for blocks of size 2^( 7) =       0.000469888395

      target function =                  N/A
              le_mean =     -16.909421976224
             les_mean =     286.269999367439
             stat err =       0.000460168720
             autocorr =       1.240376554302
              std dev =       0.584335492807
             le_variance =       0.341447968153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328276288
                                         uncertainty =       0.004596529527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328276288
                                         uncertainty =       0.004596529527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413083675
  error estimate for blocks of size 2^( 2) =       0.000424830928
  error estimate for blocks of size 2^( 3) =       0.000436987456
  error estimate for blocks of size 2^( 4) =       0.000448515825
  error estimate for blocks of size 2^( 5) =       0.000457951717
  error estimate for blocks of size 2^( 6) =       0.000464078929
  error estimate for blocks of size 2^( 7) =       0.000469811365

      target function =                  N/A
              le_mean =     -16.909422005309
             les_mean =     286.269839548354
             stat err =       0.000460089459
             autocorr =       1.240533518549
              std dev =       0.584197882039
             le_variance =       0.341287165378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341384959705
                                         uncertainty =       0.004597170457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341384959705
                                         uncertainty =       0.004597170457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413117950
  error estimate for blocks of size 2^( 2) =       0.000424862962
  error estimate for blocks of size 2^( 3) =       0.000437017622
  error estimate for blocks of size 2^( 4) =       0.000448544818
  error estimate for blocks of size 2^( 5) =       0.000457979685
  error estimate for blocks of size 2^( 6) =       0.000464105930
  error estimate for blocks of size 2^( 7) =       0.000469838456

      target function =                  N/A
              le_mean =     -16.909421954513
             les_mean =     286.269894469059
             stat err =       0.000460117222
             autocorr =       1.240477374008
              std dev =       0.584246355551
             le_variance =       0.341343803974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341475395704
                                         uncertainty =       0.004598276847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341475395704
                                         uncertainty =       0.004598276847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413172622
  error estimate for blocks of size 2^( 2) =       0.000424914275
  error estimate for blocks of size 2^( 3) =       0.000437066081
  error estimate for blocks of size 2^( 4) =       0.000448591625
  error estimate for blocks of size 2^( 5) =       0.000458024884
  error estimate for blocks of size 2^( 6) =       0.000464149272
  error estimate for blocks of size 2^( 7) =       0.000469881764

      target function =                  N/A
              le_mean =     -16.909421960549
             les_mean =     286.269985025661
             stat err =       0.000460161886
             autocorr =       1.240389887740
              std dev =       0.584323674409
             le_variance =       0.341434156475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909421976224        initial
     5.9605e-01     5.9605e+00             3.7041e-04       -16.909422005309  <--
     2.3842e+00     2.3842e+01             9.1110e-05       -16.909421954513
     9.5367e+00     9.5367e+01             2.2881e-05       -16.909421960549

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 6.0153e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.104504e-01 1 1  ON 0
 uu_1                 1.451846e-01 1 1  ON 1
 uu_2                 4.685335e-02 1 1  ON 2
 uu_3                -1.690678e-02 1 1  ON 3
 uu_4                -6.720369e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337622e-01 1 1  ON 6
 uu_7                -1.484151e-01 1 1  ON 7
 uu_8                -1.417844e-01 1 1  ON 8
 uu_9                -1.133370e-01 1 1  ON 9
 ud_0                 4.377982e-01 1 1  ON 10
 ud_1                 1.807744e-01 1 1  ON 11
 ud_2                 6.676422e-02 1 1  ON 12
 ud_3                -2.470969e-03 1 1  ON 13
 ud_4                -5.879964e-02 1 1  ON 14
 ud_5                -1.017397e-01 1 1  ON 15
 ud_6                -1.314843e-01 1 1  ON 16
 ud_7                -1.518353e-01 1 1  ON 17
 ud_8                -1.559945e-01 1 1  ON 18
 ud_9                -1.458607e-01 1 1  ON 19
 eO_0                -7.503039e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.090376e-02 1 1  ON 22
 eO_3                 3.131354e-01 1 1  ON 23
 eO_4                 5.354686e-01 1 1  ON 24
 eO_5                 4.900250e-01 1 1  ON 25
 eO_6                 2.520531e-01 1 1  ON 26
 eO_7                -5.269478e-02 1 1  ON 27
 eO_8                -2.392737e-01 1 1  ON 28
 eO_9                -1.012681e-01 1 1  ON 29
eH1_0                -2.692866e-01 1 1  ON 30
eH1_1                -1.625813e-01 1 1  ON 31
eH1_2                -1.192420e-01 1 1  ON 32
eH1_3                -6.622702e-02 1 1  ON 33
eH1_4                -6.808082e-03 1 1  ON 34
eH1_5                 3.785289e-02 1 1  ON 35
eH1_6                 1.097819e-01 1 1  ON 36
eH1_7                 1.752016e-01 1 1  ON 37
eH1_8                 2.046598e-01 1 1  ON 38
eH1_9                 9.438063e-02 1 1  ON 39
eH2_0                -2.667602e-01 1 1  ON 40
eH2_1                -1.607084e-01 1 1  ON 41
eH2_2                -1.169064e-01 1 1  ON 42
eH2_3                -6.358779e-02 1 1  ON 43
eH2_4                -3.730294e-03 1 1  ON 44
eH2_5                 3.950922e-02 1 1  ON 45
eH2_6                 1.105509e-01 1 1  ON 46
eH2_7                 1.731029e-01 1 1  ON 47
eH2_8                 2.092210e-01 1 1  ON 48
eH2_9                 8.962698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0705e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8736
    reference variance = 0.155768
====================================================
  Execution time = 3.7036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3966e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7663e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339619123812
                                         uncertainty =       0.003696562541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339619123812
                                         uncertainty =       0.003696562541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412099867
  error estimate for blocks of size 2^( 2) =       0.000423365102
  error estimate for blocks of size 2^( 3) =       0.000435672549
  error estimate for blocks of size 2^( 4) =       0.000447514991
  error estimate for blocks of size 2^( 5) =       0.000456715166
  error estimate for blocks of size 2^( 6) =       0.000465852965
  error estimate for blocks of size 2^( 7) =       0.000470216799

      target function =                  N/A
              le_mean =     -16.910377993827
             les_mean =     286.300547193743
             stat err =       0.000460074980
             autocorr =       1.246385201673
              std dev =       0.582806545489
             le_variance =       0.339663469465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691037799383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910377993827       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910379304669       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910381188886       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910382123790       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910383177577       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910384459163       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910384386881       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910383127476       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910383501401       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910383671772       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910383717933       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910383709068       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.287765e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910377993827       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910378530210       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910379224842       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910379797376       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910380232675       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910380617179       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910380407864       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910380175165       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910380180777       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.167616e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910377993827       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910378153311       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910378368662       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910378542689       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910378695942       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910378760914       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910378775286       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910378710421       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.760121e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6812e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.104062e-01 1 1  ON 0
 uu_1                 1.452588e-01 1 1  ON 1
 uu_2                 4.691519e-02 1 1  ON 2
 uu_3                -1.680743e-02 1 1  ON 3
 uu_4                -6.723778e-02 1 1  ON 4
 uu_5                -1.045322e-01 1 1  ON 5
 uu_6                -1.337496e-01 1 1  ON 6
 uu_7                -1.485060e-01 1 1  ON 7
 uu_8                -1.418890e-01 1 1  ON 8
 uu_9                -1.135208e-01 1 1  ON 9
 ud_0                 4.377434e-01 1 1  ON 10
 ud_1                 1.808934e-01 1 1  ON 11
 ud_2                 6.690450e-02 1 1  ON 12
 ud_3                -2.419746e-03 1 1  ON 13
 ud_4                -5.868256e-02 1 1  ON 14
 ud_5                -1.016219e-01 1 1  ON 15
 ud_6                -1.313862e-01 1 1  ON 16
 ud_7                -1.517985e-01 1 1  ON 17
 ud_8                -1.561348e-01 1 1  ON 18
 ud_9                -1.461210e-01 1 1  ON 19
 eO_0                -7.502514e-01 1 1  ON 20
 eO_1                -4.330587e-01 1 1  ON 21
 eO_2                -1.070357e-02 1 1  ON 22
 eO_3                 3.132196e-01 1 1  ON 23
 eO_4                 5.355166e-01 1 1  ON 24
 eO_5                 4.901092e-01 1 1  ON 25
 eO_6                 2.521383e-01 1 1  ON 26
 eO_7                -5.279776e-02 1 1  ON 27
 eO_8                -2.395066e-01 1 1  ON 28
 eO_9                -1.014884e-01 1 1  ON 29
eH1_0                -2.694570e-01 1 1  ON 30
eH1_1                -1.626831e-01 1 1  ON 31
eH1_2                -1.192037e-01 1 1  ON 32
eH1_3                -6.627583e-02 1 1  ON 33
eH1_4                -6.848349e-03 1 1  ON 34
eH1_5                 3.777410e-02 1 1  ON 35
eH1_6                 1.097887e-01 1 1  ON 36
eH1_7                 1.751412e-01 1 1  ON 37
eH1_8                 2.048156e-01 1 1  ON 38
eH1_9                 9.464153e-02 1 1  ON 39
eH2_0                -2.667296e-01 1 1  ON 40
eH2_1                -1.606835e-01 1 1  ON 41
eH2_2                -1.170312e-01 1 1  ON 42
eH2_3                -6.375778e-02 1 1  ON 43
eH2_4                -4.008111e-03 1 1  ON 44
eH2_5                 3.940418e-02 1 1  ON 45
eH2_6                 1.105261e-01 1 1  ON 46
eH2_7                 1.731905e-01 1 1  ON 47
eH2_8                 2.094383e-01 1 1  ON 48
eH2_9                 8.994374e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.198992
====================================================
  Execution time = 3.9374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4312e-01
  Total weights = 2.0001e+06
  Execution time = 4.4426e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343219952640
                                         uncertainty =       0.004585344719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343219952640
                                         uncertainty =       0.004585344719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414297500
  error estimate for blocks of size 2^( 2) =       0.000426224565
  error estimate for blocks of size 2^( 3) =       0.000437883456
  error estimate for blocks of size 2^( 4) =       0.000448684582
  error estimate for blocks of size 2^( 5) =       0.000458108186
  error estimate for blocks of size 2^( 6) =       0.000464524108
  error estimate for blocks of size 2^( 7) =       0.000468745346

      target function =                  N/A
              le_mean =     -16.910143290563
             les_mean =     286.296241758156
             stat err =       0.000460015555
             autocorr =       1.232878869272
              std dev =       0.585914518032
             le_variance =       0.343295822441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342914236284
                                         uncertainty =       0.004581125907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342914236284
                                         uncertainty =       0.004581125907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414112828
  error estimate for blocks of size 2^( 2) =       0.000426042452
  error estimate for blocks of size 2^( 3) =       0.000437702307
  error estimate for blocks of size 2^( 4) =       0.000448503426
  error estimate for blocks of size 2^( 5) =       0.000457927104
  error estimate for blocks of size 2^( 6) =       0.000464351186
  error estimate for blocks of size 2^( 7) =       0.000468586624

      target function =                  N/A
              le_mean =     -16.910143225486
             les_mean =     286.295933578832
             stat err =       0.000459842085
             autocorr =       1.233048228295
              std dev =       0.585653347857
             le_variance =       0.342989843857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342864936357
                                         uncertainty =       0.004580563392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342864936357
                                         uncertainty =       0.004580563392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414083046
  error estimate for blocks of size 2^( 2) =       0.000426016664
  error estimate for blocks of size 2^( 3) =       0.000437680256
  error estimate for blocks of size 2^( 4) =       0.000448483618
  error estimate for blocks of size 2^( 5) =       0.000457908288
  error estimate for blocks of size 2^( 6) =       0.000464331356
  error estimate for blocks of size 2^( 7) =       0.000468567289

      target function =                  N/A
              le_mean =     -16.910142960560
             les_mean =     286.295875286073
             stat err =       0.000459822638
             autocorr =       1.233121299461
              std dev =       0.585611228516
             le_variance =       0.342940510964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343148899081
                                         uncertainty =       0.004584438559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343148899081
                                         uncertainty =       0.004584438559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414254597
  error estimate for blocks of size 2^( 2) =       0.000426183291
  error estimate for blocks of size 2^( 3) =       0.000437843326
  error estimate for blocks of size 2^( 4) =       0.000448644952
  error estimate for blocks of size 2^( 5) =       0.000458068857
  error estimate for blocks of size 2^( 6) =       0.000464486007
  error estimate for blocks of size 2^( 7) =       0.000468709757

      target function =                  N/A
              le_mean =     -16.910143097862
             les_mean =     286.296164143488
             stat err =       0.000459977393
             autocorr =       1.232929666945
              std dev =       0.585853842623
             le_variance =       0.343224724917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910143290563        initial  <--
     1.4901e-01     1.4901e+00             1.2878e-03       -16.910143225486
     5.9605e-01     5.9605e+00             3.1676e-04       -16.910142960560
     2.3842e+00     2.3842e+01             7.7601e-05       -16.910143097862

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6957
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.104504e-01 1 1  ON 0
 uu_1                 1.451846e-01 1 1  ON 1
 uu_2                 4.685335e-02 1 1  ON 2
 uu_3                -1.690678e-02 1 1  ON 3
 uu_4                -6.720369e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337622e-01 1 1  ON 6
 uu_7                -1.484151e-01 1 1  ON 7
 uu_8                -1.417844e-01 1 1  ON 8
 uu_9                -1.133370e-01 1 1  ON 9
 ud_0                 4.377982e-01 1 1  ON 10
 ud_1                 1.807744e-01 1 1  ON 11
 ud_2                 6.676422e-02 1 1  ON 12
 ud_3                -2.470969e-03 1 1  ON 13
 ud_4                -5.879964e-02 1 1  ON 14
 ud_5                -1.017397e-01 1 1  ON 15
 ud_6                -1.314843e-01 1 1  ON 16
 ud_7                -1.518353e-01 1 1  ON 17
 ud_8                -1.559945e-01 1 1  ON 18
 ud_9                -1.458607e-01 1 1  ON 19
 eO_0                -7.503039e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.090376e-02 1 1  ON 22
 eO_3                 3.131354e-01 1 1  ON 23
 eO_4                 5.354686e-01 1 1  ON 24
 eO_5                 4.900250e-01 1 1  ON 25
 eO_6                 2.520531e-01 1 1  ON 26
 eO_7                -5.269478e-02 1 1  ON 27
 eO_8                -2.392737e-01 1 1  ON 28
 eO_9                -1.012681e-01 1 1  ON 29
eH1_0                -2.692866e-01 1 1  ON 30
eH1_1                -1.625813e-01 1 1  ON 31
eH1_2                -1.192420e-01 1 1  ON 32
eH1_3                -6.622702e-02 1 1  ON 33
eH1_4                -6.808082e-03 1 1  ON 34
eH1_5                 3.785289e-02 1 1  ON 35
eH1_6                 1.097819e-01 1 1  ON 36
eH1_7                 1.752016e-01 1 1  ON 37
eH1_8                 2.046598e-01 1 1  ON 38
eH1_9                 9.438063e-02 1 1  ON 39
eH2_0                -2.667602e-01 1 1  ON 40
eH2_1                -1.607084e-01 1 1  ON 41
eH2_2                -1.169064e-01 1 1  ON 42
eH2_3                -6.358779e-02 1 1  ON 43
eH2_4                -3.730294e-03 1 1  ON 44
eH2_5                 3.950922e-02 1 1  ON 45
eH2_6                 1.105509e-01 1 1  ON 46
eH2_7                 1.731029e-01 1 1  ON 47
eH2_8                 2.092210e-01 1 1  ON 48
eH2_9                 8.962698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0951e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.268462
====================================================
  Execution time = 3.6997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9196e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333849475330
                                         uncertainty =       0.003290778735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333849475330
                                         uncertainty =       0.003290778735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408528429
  error estimate for blocks of size 2^( 2) =       0.000420417524
  error estimate for blocks of size 2^( 3) =       0.000432444706
  error estimate for blocks of size 2^( 4) =       0.000443036186
  error estimate for blocks of size 2^( 5) =       0.000452645914
  error estimate for blocks of size 2^( 6) =       0.000458804465
  error estimate for blocks of size 2^( 7) =       0.000464149928

      target function =                  N/A
              le_mean =     -16.909659413152
             les_mean =     286.270382937209
             stat err =       0.000454659123
             autocorr =       1.238589098954
              std dev =       0.577755688241
             le_variance =       0.333801635295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690965941315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909659413152       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909660628294       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909660648272       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909660654700       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909660881585       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909660822269       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909660892798       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909660944430       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.155009e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909659413152       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909659737461       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909659748538       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909659757356       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909659822478       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909659803774       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909659814514       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909659826414       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.989605e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909659413152       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909659495622       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909659499042       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909659501823       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909659518782       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909659513982       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909659516238       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909659519067       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.536036e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6925e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.104355e-01 1 1  ON 0
 uu_1                 1.451825e-01 1 1  ON 1
 uu_2                 4.687175e-02 1 1  ON 2
 uu_3                -1.691222e-02 1 1  ON 3
 uu_4                -6.719913e-02 1 1  ON 4
 uu_5                -1.045435e-01 1 1  ON 5
 uu_6                -1.337437e-01 1 1  ON 6
 uu_7                -1.484291e-01 1 1  ON 7
 uu_8                -1.417936e-01 1 1  ON 8
 uu_9                -1.133481e-01 1 1  ON 9
 ud_0                 4.378038e-01 1 1  ON 10
 ud_1                 1.807862e-01 1 1  ON 11
 ud_2                 6.678882e-02 1 1  ON 12
 ud_3                -2.461208e-03 1 1  ON 13
 ud_4                -5.877095e-02 1 1  ON 14
 ud_5                -1.017307e-01 1 1  ON 15
 ud_6                -1.314886e-01 1 1  ON 16
 ud_7                -1.518652e-01 1 1  ON 17
 ud_8                -1.560206e-01 1 1  ON 18
 ud_9                -1.458736e-01 1 1  ON 19
 eO_0                -7.502825e-01 1 1  ON 20
 eO_1                -4.330931e-01 1 1  ON 21
 eO_2                -1.087958e-02 1 1  ON 22
 eO_3                 3.131361e-01 1 1  ON 23
 eO_4                 5.354624e-01 1 1  ON 24
 eO_5                 4.900295e-01 1 1  ON 25
 eO_6                 2.520707e-01 1 1  ON 26
 eO_7                -5.270836e-02 1 1  ON 27
 eO_8                -2.393000e-01 1 1  ON 28
 eO_9                -1.012877e-01 1 1  ON 29
eH1_0                -2.692900e-01 1 1  ON 30
eH1_1                -1.625869e-01 1 1  ON 31
eH1_2                -1.192480e-01 1 1  ON 32
eH1_3                -6.623440e-02 1 1  ON 33
eH1_4                -6.816504e-03 1 1  ON 34
eH1_5                 3.784083e-02 1 1  ON 35
eH1_6                 1.097752e-01 1 1  ON 36
eH1_7                 1.752043e-01 1 1  ON 37
eH1_8                 2.046748e-01 1 1  ON 38
eH1_9                 9.440781e-02 1 1  ON 39
eH2_0                -2.667781e-01 1 1  ON 40
eH2_1                -1.607012e-01 1 1  ON 41
eH2_2                -1.169239e-01 1 1  ON 42
eH2_3                -6.360089e-02 1 1  ON 43
eH2_4                -3.736251e-03 1 1  ON 44
eH2_5                 3.952012e-02 1 1  ON 45
eH2_6                 1.105515e-01 1 1  ON 46
eH2_7                 1.731009e-01 1 1  ON 47
eH2_8                 2.092280e-01 1 1  ON 48
eH2_9                 8.965277e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8684
    reference variance = 0.265614
====================================================
  Execution time = 3.6879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4486e-01
  Total weights = 2.0001e+06
  Execution time = 4.4475e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344874716963
                                         uncertainty =       0.007449339602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344874716963
                                         uncertainty =       0.007449339602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415250884
  error estimate for blocks of size 2^( 2) =       0.000427538157
  error estimate for blocks of size 2^( 3) =       0.000440826983
  error estimate for blocks of size 2^( 4) =       0.000453377634
  error estimate for blocks of size 2^( 5) =       0.000464239929
  error estimate for blocks of size 2^( 6) =       0.000474925546
  error estimate for blocks of size 2^( 7) =       0.000485215317

      target function =                  N/A
              le_mean =     -16.910028660862
             les_mean =     286.293946768329
             stat err =       0.000469439607
             autocorr =       1.278021983430
              std dev =       0.587262828385
             le_variance =       0.344877629602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344808710518
                                         uncertainty =       0.007448257055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344808710518
                                         uncertainty =       0.007448257055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415211140
  error estimate for blocks of size 2^( 2) =       0.000427499512
  error estimate for blocks of size 2^( 3) =       0.000440788791
  error estimate for blocks of size 2^( 4) =       0.000453340616
  error estimate for blocks of size 2^( 5) =       0.000464204114
  error estimate for blocks of size 2^( 6) =       0.000474891339
  error estimate for blocks of size 2^( 7) =       0.000485182124

      target function =                  N/A
              le_mean =     -16.910028198851
             les_mean =     286.293865129393
             stat err =       0.000469404548
             autocorr =       1.278075742470
              std dev =       0.587206621097
             le_variance =       0.344811615860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344834863900
                                         uncertainty =       0.007448626673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344834863900
                                         uncertainty =       0.007448626673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415226887
  error estimate for blocks of size 2^( 2) =       0.000427514913
  error estimate for blocks of size 2^( 3) =       0.000440804116
  error estimate for blocks of size 2^( 4) =       0.000453355551
  error estimate for blocks of size 2^( 5) =       0.000464218549
  error estimate for blocks of size 2^( 6) =       0.000474904977
  error estimate for blocks of size 2^( 7) =       0.000485195467

      target function =                  N/A
              le_mean =     -16.910028355641
             les_mean =     286.293896585888
             stat err =       0.000469418636
             autocorr =       1.278055516730
              std dev =       0.587228890398
             le_variance =       0.344837769718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344869443422
                                         uncertainty =       0.007449242954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344869443422
                                         uncertainty =       0.007449242954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415247709
  error estimate for blocks of size 2^( 2) =       0.000427535085
  error estimate for blocks of size 2^( 3) =       0.000440823964
  error estimate for blocks of size 2^( 4) =       0.000453374721
  error estimate for blocks of size 2^( 5) =       0.000464237109
  error estimate for blocks of size 2^( 6) =       0.000474922826
  error estimate for blocks of size 2^( 7) =       0.000485212697

      target function =                  N/A
              le_mean =     -16.910028617873
             les_mean =     286.293940039902
             stat err =       0.000469436838
             autocorr =       1.278026456753
              std dev =       0.587258337577
             le_variance =       0.344872355054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910028660862        initial  <--
     1.4901e+00     1.4901e+01             1.1550e-04       -16.910028198851
     5.9605e+00     5.9605e+01             2.9896e-05       -16.910028355641
     2.3842e+01     2.3842e+02             7.5360e-06       -16.910028617873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2756
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.104504e-01 1 1  ON 0
 uu_1                 1.451846e-01 1 1  ON 1
 uu_2                 4.685335e-02 1 1  ON 2
 uu_3                -1.690678e-02 1 1  ON 3
 uu_4                -6.720369e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337622e-01 1 1  ON 6
 uu_7                -1.484151e-01 1 1  ON 7
 uu_8                -1.417844e-01 1 1  ON 8
 uu_9                -1.133370e-01 1 1  ON 9
 ud_0                 4.377982e-01 1 1  ON 10
 ud_1                 1.807744e-01 1 1  ON 11
 ud_2                 6.676422e-02 1 1  ON 12
 ud_3                -2.470969e-03 1 1  ON 13
 ud_4                -5.879964e-02 1 1  ON 14
 ud_5                -1.017397e-01 1 1  ON 15
 ud_6                -1.314843e-01 1 1  ON 16
 ud_7                -1.518353e-01 1 1  ON 17
 ud_8                -1.559945e-01 1 1  ON 18
 ud_9                -1.458607e-01 1 1  ON 19
 eO_0                -7.503039e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.090376e-02 1 1  ON 22
 eO_3                 3.131354e-01 1 1  ON 23
 eO_4                 5.354686e-01 1 1  ON 24
 eO_5                 4.900250e-01 1 1  ON 25
 eO_6                 2.520531e-01 1 1  ON 26
 eO_7                -5.269478e-02 1 1  ON 27
 eO_8                -2.392737e-01 1 1  ON 28
 eO_9                -1.012681e-01 1 1  ON 29
eH1_0                -2.692866e-01 1 1  ON 30
eH1_1                -1.625813e-01 1 1  ON 31
eH1_2                -1.192420e-01 1 1  ON 32
eH1_3                -6.622702e-02 1 1  ON 33
eH1_4                -6.808082e-03 1 1  ON 34
eH1_5                 3.785289e-02 1 1  ON 35
eH1_6                 1.097819e-01 1 1  ON 36
eH1_7                 1.752016e-01 1 1  ON 37
eH1_8                 2.046598e-01 1 1  ON 38
eH1_9                 9.438063e-02 1 1  ON 39
eH2_0                -2.667602e-01 1 1  ON 40
eH2_1                -1.607084e-01 1 1  ON 41
eH2_2                -1.169064e-01 1 1  ON 42
eH2_3                -6.358779e-02 1 1  ON 43
eH2_4                -3.730294e-03 1 1  ON 44
eH2_5                 3.950922e-02 1 1  ON 45
eH2_6                 1.105509e-01 1 1  ON 46
eH2_7                 1.731029e-01 1 1  ON 47
eH2_8                 2.092210e-01 1 1  ON 48
eH2_9                 8.962698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0721e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9142
    reference variance = 0.229631
====================================================
  Execution time = 3.7082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3424e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8726e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334120724644
                                         uncertainty =       0.004345411548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334120724644
                                         uncertainty =       0.004345411548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408793763
  error estimate for blocks of size 2^( 2) =       0.000420407314
  error estimate for blocks of size 2^( 3) =       0.000432993923
  error estimate for blocks of size 2^( 4) =       0.000445098292
  error estimate for blocks of size 2^( 5) =       0.000455849951
  error estimate for blocks of size 2^( 6) =       0.000463387621
  error estimate for blocks of size 2^( 7) =       0.000473811808

      target function =                  N/A
              le_mean =     -16.909928642022
             les_mean =     286.279921887346
             stat err =       0.000459536918
             autocorr =       1.263665977524
              std dev =       0.578130933425
             le_variance =       0.334235376182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690992864202e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928642022       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928676624       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909928691922       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909928695589       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909928716198       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909928736316       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909928738722       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909928738450       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.274383e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928642022       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928650734       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909928654583       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909928655525       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909928660768       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909928665786       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909928666407       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909928666371       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.187986e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928642022       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928644204       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909928645168       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909928645405       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909928646722       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909928647975       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909928648132       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909928648125       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.971216e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6963e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.104508e-01 1 1  ON 0
 uu_1                 1.451850e-01 1 1  ON 1
 uu_2                 4.685499e-02 1 1  ON 2
 uu_3                -1.690597e-02 1 1  ON 3
 uu_4                -6.720260e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337638e-01 1 1  ON 6
 uu_7                -1.484181e-01 1 1  ON 7
 uu_8                -1.417860e-01 1 1  ON 8
 uu_9                -1.133373e-01 1 1  ON 9
 ud_0                 4.377982e-01 1 1  ON 10
 ud_1                 1.807750e-01 1 1  ON 11
 ud_2                 6.676394e-02 1 1  ON 12
 ud_3                -2.470178e-03 1 1  ON 13
 ud_4                -5.879854e-02 1 1  ON 14
 ud_5                -1.017388e-01 1 1  ON 15
 ud_6                -1.314843e-01 1 1  ON 16
 ud_7                -1.518347e-01 1 1  ON 17
 ud_8                -1.559954e-01 1 1  ON 18
 ud_9                -1.458623e-01 1 1  ON 19
 eO_0                -7.503012e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.090212e-02 1 1  ON 22
 eO_3                 3.131334e-01 1 1  ON 23
 eO_4                 5.354699e-01 1 1  ON 24
 eO_5                 4.900267e-01 1 1  ON 25
 eO_6                 2.520532e-01 1 1  ON 26
 eO_7                -5.269567e-02 1 1  ON 27
 eO_8                -2.392757e-01 1 1  ON 28
 eO_9                -1.012703e-01 1 1  ON 29
eH1_0                -2.692870e-01 1 1  ON 30
eH1_1                -1.625835e-01 1 1  ON 31
eH1_2                -1.192433e-01 1 1  ON 32
eH1_3                -6.622657e-02 1 1  ON 33
eH1_4                -6.807419e-03 1 1  ON 34
eH1_5                 3.785177e-02 1 1  ON 35
eH1_6                 1.097787e-01 1 1  ON 36
eH1_7                 1.752022e-01 1 1  ON 37
eH1_8                 2.046628e-01 1 1  ON 38
eH1_9                 9.438354e-02 1 1  ON 39
eH2_0                -2.667603e-01 1 1  ON 40
eH2_1                -1.607084e-01 1 1  ON 41
eH2_2                -1.169075e-01 1 1  ON 42
eH2_3                -6.358981e-02 1 1  ON 43
eH2_4                -3.729637e-03 1 1  ON 44
eH2_5                 3.950945e-02 1 1  ON 45
eH2_6                 1.105496e-01 1 1  ON 46
eH2_7                 1.731019e-01 1 1  ON 47
eH2_8                 2.092223e-01 1 1  ON 48
eH2_9                 8.962995e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.275928
====================================================
  Execution time = 3.6792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4297e-01
  Total weights = 2.0001e+06
  Execution time = 4.4486e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342969746843
                                         uncertainty =       0.005911229914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342969746843
                                         uncertainty =       0.005911229914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414102838
  error estimate for blocks of size 2^( 2) =       0.000426061789
  error estimate for blocks of size 2^( 3) =       0.000438826529
  error estimate for blocks of size 2^( 4) =       0.000450071406
  error estimate for blocks of size 2^( 5) =       0.000460336564
  error estimate for blocks of size 2^( 6) =       0.000468488372
  error estimate for blocks of size 2^( 7) =       0.000475005871

      target function =                  N/A
              le_mean =     -16.910141755678
             les_mean =     286.295867321103
             stat err =       0.000463475553
             autocorr =       1.252671652942
              std dev =       0.585639219539
             le_variance =       0.342973295462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968007094
                                         uncertainty =       0.005911264651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968007094
                                         uncertainty =       0.005911264651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414101786
  error estimate for blocks of size 2^( 2) =       0.000426060680
  error estimate for blocks of size 2^( 3) =       0.000438825287
  error estimate for blocks of size 2^( 4) =       0.000450070002
  error estimate for blocks of size 2^( 5) =       0.000460335013
  error estimate for blocks of size 2^( 6) =       0.000468486831
  error estimate for blocks of size 2^( 7) =       0.000475004142

      target function =                  N/A
              le_mean =     -16.910141773152
             les_mean =     286.295866169019
             stat err =       0.000463473997
             autocorr =       1.252669607595
              std dev =       0.585637731370
             le_variance =       0.342971552404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968864637
                                         uncertainty =       0.005911247260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968864637
                                         uncertainty =       0.005911247260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414102304
  error estimate for blocks of size 2^( 2) =       0.000426061227
  error estimate for blocks of size 2^( 3) =       0.000438825899
  error estimate for blocks of size 2^( 4) =       0.000450070694
  error estimate for blocks of size 2^( 5) =       0.000460335779
  error estimate for blocks of size 2^( 6) =       0.000468487591
  error estimate for blocks of size 2^( 7) =       0.000475004993

      target function =                  N/A
              le_mean =     -16.910141764397
             les_mean =     286.295866732112
             stat err =       0.000463474764
             autocorr =       1.252670615680
              std dev =       0.585638464915
             le_variance =       0.342972411588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342969636122
                                         uncertainty =       0.005911232081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342969636122
                                         uncertainty =       0.005911232081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414102771
  error estimate for blocks of size 2^( 2) =       0.000426061718
  error estimate for blocks of size 2^( 3) =       0.000438826450
  error estimate for blocks of size 2^( 4) =       0.000450071317
  error estimate for blocks of size 2^( 5) =       0.000460336466
  error estimate for blocks of size 2^( 6) =       0.000468488274
  error estimate for blocks of size 2^( 7) =       0.000475005761

      target function =                  N/A
              le_mean =     -16.910141756759
             les_mean =     286.295867246733
             stat err =       0.000463475454
             autocorr =       1.252671522793
              std dev =       0.585639124830
             le_variance =       0.342973184531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910141755678        initial
     1.4901e+01     1.4901e+02             1.2744e-05       -16.910141773152  <--
     5.9605e+01     5.9605e+02             3.1880e-06       -16.910141764397
     2.3842e+02     2.3842e+03             7.9712e-07       -16.910141756759

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 6.0045e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.104521e-01 1 1  ON 0
 uu_1                 1.451861e-01 1 1  ON 1
 uu_2                 4.685983e-02 1 1  ON 2
 uu_3                -1.690350e-02 1 1  ON 3
 uu_4                -6.719939e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337683e-01 1 1  ON 6
 uu_7                -1.484272e-01 1 1  ON 7
 uu_8                -1.417909e-01 1 1  ON 8
 uu_9                -1.133384e-01 1 1  ON 9
 ud_0                 4.377984e-01 1 1  ON 10
 ud_1                 1.807770e-01 1 1  ON 11
 ud_2                 6.676320e-02 1 1  ON 12
 ud_3                -2.467850e-03 1 1  ON 13
 ud_4                -5.879523e-02 1 1  ON 14
 ud_5                -1.017362e-01 1 1  ON 15
 ud_6                -1.314844e-01 1 1  ON 16
 ud_7                -1.518331e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458670e-01 1 1  ON 19
 eO_0                -7.502932e-01 1 1  ON 20
 eO_1                -4.330934e-01 1 1  ON 21
 eO_2                -1.089730e-02 1 1  ON 22
 eO_3                 3.131274e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900317e-01 1 1  ON 25
 eO_6                 2.520534e-01 1 1  ON 26
 eO_7                -5.269833e-02 1 1  ON 27
 eO_8                -2.392818e-01 1 1  ON 28
 eO_9                -1.012766e-01 1 1  ON 29
eH1_0                -2.692881e-01 1 1  ON 30
eH1_1                -1.625899e-01 1 1  ON 31
eH1_2                -1.192472e-01 1 1  ON 32
eH1_3                -6.622529e-02 1 1  ON 33
eH1_4                -6.805420e-03 1 1  ON 34
eH1_5                 3.784842e-02 1 1  ON 35
eH1_6                 1.097691e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046716e-01 1 1  ON 38
eH1_9                 9.439227e-02 1 1  ON 39
eH2_0                -2.667607e-01 1 1  ON 40
eH2_1                -1.607085e-01 1 1  ON 41
eH2_2                -1.169106e-01 1 1  ON 42
eH2_3                -6.359581e-02 1 1  ON 43
eH2_4                -3.727706e-03 1 1  ON 44
eH2_5                 3.951016e-02 1 1  ON 45
eH2_6                 1.105457e-01 1 1  ON 46
eH2_7                 1.730989e-01 1 1  ON 47
eH2_8                 2.092261e-01 1 1  ON 48
eH2_9                 8.963884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0701e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.314397
====================================================
  Execution time = 3.7258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5314e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9765e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353214508788
                                         uncertainty =       0.011262475989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353214508788
                                         uncertainty =       0.011262475989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420195475
  error estimate for blocks of size 2^( 2) =       0.000431458743
  error estimate for blocks of size 2^( 3) =       0.000443465931
  error estimate for blocks of size 2^( 4) =       0.000455068089
  error estimate for blocks of size 2^( 5) =       0.000465341170
  error estimate for blocks of size 2^( 6) =       0.000473009848
  error estimate for blocks of size 2^( 7) =       0.000475357636

      target function =                  N/A
              le_mean =     -16.909627530967
             les_mean =     286.288642833688
             stat err =       0.000467194186
             autocorr =       1.236209613874
              std dev =       0.594255647180
             le_variance =       0.353139774206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690962753097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909627530967       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909627430922       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909627622598       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909627641607       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909627607969       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909627607213       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909627622192       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909627618987       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.982996e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909627530967       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909627505109       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909627555271       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909627559452       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909627551634       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909627551042       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909627553817       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909627552899       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.267986e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909627530967       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909627524448       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909627537135       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909627538142       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909627536230       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909627536063       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909627536686       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909627536445       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.184607e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7243e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.104585e-01 1 1  ON 0
 uu_1                 1.451852e-01 1 1  ON 1
 uu_2                 4.686075e-02 1 1  ON 2
 uu_3                -1.690082e-02 1 1  ON 3
 uu_4                -6.719937e-02 1 1  ON 4
 uu_5                -1.045537e-01 1 1  ON 5
 uu_6                -1.337644e-01 1 1  ON 6
 uu_7                -1.484355e-01 1 1  ON 7
 uu_8                -1.417966e-01 1 1  ON 8
 uu_9                -1.133448e-01 1 1  ON 9
 ud_0                 4.378032e-01 1 1  ON 10
 ud_1                 1.807716e-01 1 1  ON 11
 ud_2                 6.676580e-02 1 1  ON 12
 ud_3                -2.469477e-03 1 1  ON 13
 ud_4                -5.878557e-02 1 1  ON 14
 ud_5                -1.017346e-01 1 1  ON 15
 ud_6                -1.314825e-01 1 1  ON 16
 ud_7                -1.518293e-01 1 1  ON 17
 ud_8                -1.560051e-01 1 1  ON 18
 ud_9                -1.458723e-01 1 1  ON 19
 eO_0                -7.502809e-01 1 1  ON 20
 eO_1                -4.330898e-01 1 1  ON 21
 eO_2                -1.089430e-02 1 1  ON 22
 eO_3                 3.131248e-01 1 1  ON 23
 eO_4                 5.354717e-01 1 1  ON 24
 eO_5                 4.900372e-01 1 1  ON 25
 eO_6                 2.520598e-01 1 1  ON 26
 eO_7                -5.270303e-02 1 1  ON 27
 eO_8                -2.392923e-01 1 1  ON 28
 eO_9                -1.012860e-01 1 1  ON 29
eH1_0                -2.692868e-01 1 1  ON 30
eH1_1                -1.625886e-01 1 1  ON 31
eH1_2                -1.192542e-01 1 1  ON 32
eH1_3                -6.622891e-02 1 1  ON 33
eH1_4                -6.802314e-03 1 1  ON 34
eH1_5                 3.783944e-02 1 1  ON 35
eH1_6                 1.097601e-01 1 1  ON 36
eH1_7                 1.752047e-01 1 1  ON 37
eH1_8                 2.046805e-01 1 1  ON 38
eH1_9                 9.440381e-02 1 1  ON 39
eH2_0                -2.667734e-01 1 1  ON 40
eH2_1                -1.607021e-01 1 1  ON 41
eH2_2                -1.169150e-01 1 1  ON 42
eH2_3                -6.359932e-02 1 1  ON 43
eH2_4                -3.733804e-03 1 1  ON 44
eH2_5                 3.950566e-02 1 1  ON 45
eH2_6                 1.105438e-01 1 1  ON 46
eH2_7                 1.731059e-01 1 1  ON 47
eH2_8                 2.092348e-01 1 1  ON 48
eH2_9                 8.964900e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9764
    reference variance = 0.231378
====================================================
  Execution time = 3.8706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4872e-01
  Total weights = 2.0001e+06
  Execution time = 4.4485e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348569445824
                                         uncertainty =       0.007036316844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348569445824
                                         uncertainty =       0.007036316844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417553171
  error estimate for blocks of size 2^( 2) =       0.000429133763
  error estimate for blocks of size 2^( 3) =       0.000441131151
  error estimate for blocks of size 2^( 4) =       0.000451916477
  error estimate for blocks of size 2^( 5) =       0.000461272353
  error estimate for blocks of size 2^( 6) =       0.000469550105
  error estimate for blocks of size 2^( 7) =       0.000472032371

      target function =                  N/A
              le_mean =     -16.910906206371
             les_mean =     286.327461006492
             stat err =       0.000463692826
             autocorr =       1.233210407557
              std dev =       0.590518805950
             le_variance =       0.348712460180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348583661121
                                         uncertainty =       0.007036195096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348583661121
                                         uncertainty =       0.007036195096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417561706
  error estimate for blocks of size 2^( 2) =       0.000429141948
  error estimate for blocks of size 2^( 3) =       0.000441139394
  error estimate for blocks of size 2^( 4) =       0.000451924323
  error estimate for blocks of size 2^( 5) =       0.000461279648
  error estimate for blocks of size 2^( 6) =       0.000469557661
  error estimate for blocks of size 2^( 7) =       0.000472039464

      target function =                  N/A
              le_mean =     -16.910906066586
             les_mean =     286.327470533689
             stat err =       0.000463700274
             autocorr =       1.233199610820
              std dev =       0.590530875686
             le_variance =       0.348726715138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348577660032
                                         uncertainty =       0.007036300404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348577660032
                                         uncertainty =       0.007036300404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417558102
  error estimate for blocks of size 2^( 2) =       0.000429138498
  error estimate for blocks of size 2^( 3) =       0.000441135916
  error estimate for blocks of size 2^( 4) =       0.000451921028
  error estimate for blocks of size 2^( 5) =       0.000461276603
  error estimate for blocks of size 2^( 6) =       0.000469554490
  error estimate for blocks of size 2^( 7) =       0.000472036526

      target function =                  N/A
              le_mean =     -16.910906130937
             les_mean =     286.327466691047
             stat err =       0.000463697162
             autocorr =       1.233204342661
              std dev =       0.590525779315
             le_variance =       0.348720696035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348570509042
                                         uncertainty =       0.007036316435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348570509042
                                         uncertainty =       0.007036316435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417553810
  error estimate for blocks of size 2^( 2) =       0.000429134376
  error estimate for blocks of size 2^( 3) =       0.000441131768
  error estimate for blocks of size 2^( 4) =       0.000451917066
  error estimate for blocks of size 2^( 5) =       0.000461272904
  error estimate for blocks of size 2^( 6) =       0.000469550673
  error estimate for blocks of size 2^( 7) =       0.000472032910

      target function =                  N/A
              le_mean =     -16.910906196621
             les_mean =     286.327461742733
             stat err =       0.000463693388
             autocorr =       1.233209627608
              std dev =       0.590519708533
             le_variance =       0.348713526166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910906206371        initial  <--
     3.7253e+00     3.7253e+01             4.9830e-05       -16.910906066586
     1.4901e+01     1.4901e+02             1.2680e-05       -16.910906130937
     5.9605e+01     5.9605e+02             3.1846e-06       -16.910906196621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0125
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.104521e-01 1 1  ON 0
 uu_1                 1.451861e-01 1 1  ON 1
 uu_2                 4.685983e-02 1 1  ON 2
 uu_3                -1.690350e-02 1 1  ON 3
 uu_4                -6.719939e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337683e-01 1 1  ON 6
 uu_7                -1.484272e-01 1 1  ON 7
 uu_8                -1.417909e-01 1 1  ON 8
 uu_9                -1.133384e-01 1 1  ON 9
 ud_0                 4.377984e-01 1 1  ON 10
 ud_1                 1.807770e-01 1 1  ON 11
 ud_2                 6.676320e-02 1 1  ON 12
 ud_3                -2.467850e-03 1 1  ON 13
 ud_4                -5.879523e-02 1 1  ON 14
 ud_5                -1.017362e-01 1 1  ON 15
 ud_6                -1.314844e-01 1 1  ON 16
 ud_7                -1.518331e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458670e-01 1 1  ON 19
 eO_0                -7.502932e-01 1 1  ON 20
 eO_1                -4.330934e-01 1 1  ON 21
 eO_2                -1.089730e-02 1 1  ON 22
 eO_3                 3.131274e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900317e-01 1 1  ON 25
 eO_6                 2.520534e-01 1 1  ON 26
 eO_7                -5.269833e-02 1 1  ON 27
 eO_8                -2.392818e-01 1 1  ON 28
 eO_9                -1.012766e-01 1 1  ON 29
eH1_0                -2.692881e-01 1 1  ON 30
eH1_1                -1.625899e-01 1 1  ON 31
eH1_2                -1.192472e-01 1 1  ON 32
eH1_3                -6.622529e-02 1 1  ON 33
eH1_4                -6.805420e-03 1 1  ON 34
eH1_5                 3.784842e-02 1 1  ON 35
eH1_6                 1.097691e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046716e-01 1 1  ON 38
eH1_9                 9.439227e-02 1 1  ON 39
eH2_0                -2.667607e-01 1 1  ON 40
eH2_1                -1.607085e-01 1 1  ON 41
eH2_2                -1.169106e-01 1 1  ON 42
eH2_3                -6.359581e-02 1 1  ON 43
eH2_4                -3.727706e-03 1 1  ON 44
eH2_5                 3.951016e-02 1 1  ON 45
eH2_6                 1.105457e-01 1 1  ON 46
eH2_7                 1.730989e-01 1 1  ON 47
eH2_8                 2.092261e-01 1 1  ON 48
eH2_9                 8.963884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0926e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9644
    reference variance = 0.120424
====================================================
  Execution time = 3.7222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7987e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298200498
                                         uncertainty =       0.003255976804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298200498
                                         uncertainty =       0.003255976804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408818290
  error estimate for blocks of size 2^( 2) =       0.000421026266
  error estimate for blocks of size 2^( 3) =       0.000433092039
  error estimate for blocks of size 2^( 4) =       0.000444605595
  error estimate for blocks of size 2^( 5) =       0.000453069179
  error estimate for blocks of size 2^( 6) =       0.000460753034
  error estimate for blocks of size 2^( 7) =       0.000466314909

      target function =                  N/A
              le_mean =     -16.910224100115
             les_mean =     286.289954433419
             stat err =       0.000456185679
             autocorr =       1.245152833814
              std dev =       0.578165620266
             le_variance =       0.334275484458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691022410011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910224100115       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910224109757       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910224124906       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910224129995       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910224143957       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910224137884       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910224136600       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910224137890       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.712822e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910224100115       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910224102534       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910224106349       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910224107636       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910224111169       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910224109662       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910224109318       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910224109626       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.182861e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910224100115       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910224100720       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910224101676       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910224101998       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910224102884       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910224102508       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910224102420       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910224102496       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.960084e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7029e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.104515e-01 1 1  ON 0
 uu_1                 1.451862e-01 1 1  ON 1
 uu_2                 4.685991e-02 1 1  ON 2
 uu_3                -1.690337e-02 1 1  ON 3
 uu_4                -6.719954e-02 1 1  ON 4
 uu_5                -1.045514e-01 1 1  ON 5
 uu_6                -1.337682e-01 1 1  ON 6
 uu_7                -1.484271e-01 1 1  ON 7
 uu_8                -1.417914e-01 1 1  ON 8
 uu_9                -1.133386e-01 1 1  ON 9
 ud_0                 4.377978e-01 1 1  ON 10
 ud_1                 1.807773e-01 1 1  ON 11
 ud_2                 6.676372e-02 1 1  ON 12
 ud_3                -2.467713e-03 1 1  ON 13
 ud_4                -5.879435e-02 1 1  ON 14
 ud_5                -1.017355e-01 1 1  ON 15
 ud_6                -1.314847e-01 1 1  ON 16
 ud_7                -1.518331e-01 1 1  ON 17
 ud_8                -1.559984e-01 1 1  ON 18
 ud_9                -1.458679e-01 1 1  ON 19
 eO_0                -7.502931e-01 1 1  ON 20
 eO_1                -4.330926e-01 1 1  ON 21
 eO_2                -1.089724e-02 1 1  ON 22
 eO_3                 3.131280e-01 1 1  ON 23
 eO_4                 5.354739e-01 1 1  ON 24
 eO_5                 4.900317e-01 1 1  ON 25
 eO_6                 2.520541e-01 1 1  ON 26
 eO_7                -5.269877e-02 1 1  ON 27
 eO_8                -2.392828e-01 1 1  ON 28
 eO_9                -1.012774e-01 1 1  ON 29
eH1_0                -2.692877e-01 1 1  ON 30
eH1_1                -1.625905e-01 1 1  ON 31
eH1_2                -1.192484e-01 1 1  ON 32
eH1_3                -6.622585e-02 1 1  ON 33
eH1_4                -6.805575e-03 1 1  ON 34
eH1_5                 3.784833e-02 1 1  ON 35
eH1_6                 1.097684e-01 1 1  ON 36
eH1_7                 1.752045e-01 1 1  ON 37
eH1_8                 2.046724e-01 1 1  ON 38
eH1_9                 9.439343e-02 1 1  ON 39
eH2_0                -2.667613e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.169111e-01 1 1  ON 42
eH2_3                -6.359632e-02 1 1  ON 43
eH2_4                -3.728500e-03 1 1  ON 44
eH2_5                 3.950973e-02 1 1  ON 45
eH2_6                 1.105453e-01 1 1  ON 46
eH2_7                 1.730998e-01 1 1  ON 47
eH2_8                 2.092267e-01 1 1  ON 48
eH2_9                 8.963988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.191727
====================================================
  Execution time = 3.6815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.0001e+06
  Execution time = 4.4567e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337082602668
                                         uncertainty =       0.004247267959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337082602668
                                         uncertainty =       0.004247267959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410566122
  error estimate for blocks of size 2^( 2) =       0.000422122221
  error estimate for blocks of size 2^( 3) =       0.000434703186
  error estimate for blocks of size 2^( 4) =       0.000446919673
  error estimate for blocks of size 2^( 5) =       0.000457963296
  error estimate for blocks of size 2^( 6) =       0.000466777815
  error estimate for blocks of size 2^( 7) =       0.000472214277

      target function =                  N/A
              le_mean =     -16.909878294404
             les_mean =     286.281123631914
             stat err =       0.000460968765
             autocorr =       1.260598473685
              std dev =       0.580637467736
             le_variance =       0.337139868939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079382302
                                         uncertainty =       0.004247241060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079382302
                                         uncertainty =       0.004247241060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410564162
  error estimate for blocks of size 2^( 2) =       0.000422120331
  error estimate for blocks of size 2^( 3) =       0.000434701359
  error estimate for blocks of size 2^( 4) =       0.000446917876
  error estimate for blocks of size 2^( 5) =       0.000457961519
  error estimate for blocks of size 2^( 6) =       0.000466776051
  error estimate for blocks of size 2^( 7) =       0.000472212593

      target function =                  N/A
              le_mean =     -16.909878279051
             les_mean =     286.281119893729
             stat err =       0.000460967010
             autocorr =       1.260600909210
              std dev =       0.580634695804
             le_variance =       0.337136649972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337080978141
                                         uncertainty =       0.004247254377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337080978141
                                         uncertainty =       0.004247254377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565133
  error estimate for blocks of size 2^( 2) =       0.000422121268
  error estimate for blocks of size 2^( 3) =       0.000434702265
  error estimate for blocks of size 2^( 4) =       0.000446918767
  error estimate for blocks of size 2^( 5) =       0.000457962400
  error estimate for blocks of size 2^( 6) =       0.000466776925
  error estimate for blocks of size 2^( 7) =       0.000472213428

      target function =                  N/A
              le_mean =     -16.909878286649
             les_mean =     286.281121745827
             stat err =       0.000460967880
             autocorr =       1.260599703260
              std dev =       0.580636069422
             le_variance =       0.337138245113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337082399136
                                         uncertainty =       0.004247266257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337082399136
                                         uncertainty =       0.004247266257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565998
  error estimate for blocks of size 2^( 2) =       0.000422122102
  error estimate for blocks of size 2^( 3) =       0.000434703071
  error estimate for blocks of size 2^( 4) =       0.000446919559
  error estimate for blocks of size 2^( 5) =       0.000457963184
  error estimate for blocks of size 2^( 6) =       0.000466777703
  error estimate for blocks of size 2^( 7) =       0.000472214170

      target function =                  N/A
              le_mean =     -16.909878293430
             les_mean =     286.281123395551
             stat err =       0.000460968654
             autocorr =       1.260598627760
              std dev =       0.580637292545
             le_variance =       0.337139665494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909878294404        initial  <--
     3.7253e+01     3.7253e+02             4.7128e-06       -16.909878279051
     1.4901e+02     1.4901e+03             1.1829e-06       -16.909878286649
     5.9605e+02     5.9605e+03             2.9601e-07       -16.909878293430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.1982
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.104521e-01 1 1  ON 0
 uu_1                 1.451861e-01 1 1  ON 1
 uu_2                 4.685983e-02 1 1  ON 2
 uu_3                -1.690350e-02 1 1  ON 3
 uu_4                -6.719939e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337683e-01 1 1  ON 6
 uu_7                -1.484272e-01 1 1  ON 7
 uu_8                -1.417909e-01 1 1  ON 8
 uu_9                -1.133384e-01 1 1  ON 9
 ud_0                 4.377984e-01 1 1  ON 10
 ud_1                 1.807770e-01 1 1  ON 11
 ud_2                 6.676320e-02 1 1  ON 12
 ud_3                -2.467850e-03 1 1  ON 13
 ud_4                -5.879523e-02 1 1  ON 14
 ud_5                -1.017362e-01 1 1  ON 15
 ud_6                -1.314844e-01 1 1  ON 16
 ud_7                -1.518331e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458670e-01 1 1  ON 19
 eO_0                -7.502932e-01 1 1  ON 20
 eO_1                -4.330934e-01 1 1  ON 21
 eO_2                -1.089730e-02 1 1  ON 22
 eO_3                 3.131274e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900317e-01 1 1  ON 25
 eO_6                 2.520534e-01 1 1  ON 26
 eO_7                -5.269833e-02 1 1  ON 27
 eO_8                -2.392818e-01 1 1  ON 28
 eO_9                -1.012766e-01 1 1  ON 29
eH1_0                -2.692881e-01 1 1  ON 30
eH1_1                -1.625899e-01 1 1  ON 31
eH1_2                -1.192472e-01 1 1  ON 32
eH1_3                -6.622529e-02 1 1  ON 33
eH1_4                -6.805420e-03 1 1  ON 34
eH1_5                 3.784842e-02 1 1  ON 35
eH1_6                 1.097691e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046716e-01 1 1  ON 38
eH1_9                 9.439227e-02 1 1  ON 39
eH2_0                -2.667607e-01 1 1  ON 40
eH2_1                -1.607085e-01 1 1  ON 41
eH2_2                -1.169106e-01 1 1  ON 42
eH2_3                -6.359581e-02 1 1  ON 43
eH2_4                -3.727706e-03 1 1  ON 44
eH2_5                 3.951016e-02 1 1  ON 45
eH2_6                 1.105457e-01 1 1  ON 46
eH2_7                 1.730989e-01 1 1  ON 47
eH2_8                 2.092261e-01 1 1  ON 48
eH2_9                 8.963884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0723e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.25826
====================================================
  Execution time = 3.7567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3456e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8614e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334529214031
                                         uncertainty =       0.004542056967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334529214031
                                         uncertainty =       0.004542056967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408993126
  error estimate for blocks of size 2^( 2) =       0.000420778016
  error estimate for blocks of size 2^( 3) =       0.000432742806
  error estimate for blocks of size 2^( 4) =       0.000444748245
  error estimate for blocks of size 2^( 5) =       0.000455493400
  error estimate for blocks of size 2^( 6) =       0.000463102554
  error estimate for blocks of size 2^( 7) =       0.000467914763

      target function =                  N/A
              le_mean =     -16.909687445149
             les_mean =     286.272090784820
             stat err =       0.000457814740
             autocorr =       1.252989773210
              std dev =       0.578412879748
             le_variance =       0.334561459458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690968744515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909687445149       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909687445585       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909687444395       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909687444284       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909687444830       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909687445545       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909687445528       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909687445850       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.707852e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909687445149       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909687445258       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909687444961       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909687444933       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909687445069       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909687445248       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909687445245       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909687445324       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.177042e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909687445149       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909687445176       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909687445102       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909687445095       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909687445129       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909687445173       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909687445174       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909687445194       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 2.942653e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7437e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.104521e-01 1 1  ON 0
 uu_1                 1.451862e-01 1 1  ON 1
 uu_2                 4.685984e-02 1 1  ON 2
 uu_3                -1.690346e-02 1 1  ON 3
 uu_4                -6.719942e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337683e-01 1 1  ON 6
 uu_7                -1.484272e-01 1 1  ON 7
 uu_8                -1.417909e-01 1 1  ON 8
 uu_9                -1.133385e-01 1 1  ON 9
 ud_0                 4.377983e-01 1 1  ON 10
 ud_1                 1.807770e-01 1 1  ON 11
 ud_2                 6.676327e-02 1 1  ON 12
 ud_3                -2.467864e-03 1 1  ON 13
 ud_4                -5.879512e-02 1 1  ON 14
 ud_5                -1.017362e-01 1 1  ON 15
 ud_6                -1.314844e-01 1 1  ON 16
 ud_7                -1.518331e-01 1 1  ON 17
 ud_8                -1.559984e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502931e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.089727e-02 1 1  ON 22
 eO_3                 3.131275e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900317e-01 1 1  ON 25
 eO_6                 2.520535e-01 1 1  ON 26
 eO_7                -5.269837e-02 1 1  ON 27
 eO_8                -2.392819e-01 1 1  ON 28
 eO_9                -1.012767e-01 1 1  ON 29
eH1_0                -2.692882e-01 1 1  ON 30
eH1_1                -1.625900e-01 1 1  ON 31
eH1_2                -1.192473e-01 1 1  ON 32
eH1_3                -6.622530e-02 1 1  ON 33
eH1_4                -6.805387e-03 1 1  ON 34
eH1_5                 3.784836e-02 1 1  ON 35
eH1_6                 1.097690e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046717e-01 1 1  ON 38
eH1_9                 9.439239e-02 1 1  ON 39
eH2_0                -2.667607e-01 1 1  ON 40
eH2_1                -1.607086e-01 1 1  ON 41
eH2_2                -1.169107e-01 1 1  ON 42
eH2_3                -6.359575e-02 1 1  ON 43
eH2_4                -3.727763e-03 1 1  ON 44
eH2_5                 3.951018e-02 1 1  ON 45
eH2_6                 1.105456e-01 1 1  ON 46
eH2_7                 1.730989e-01 1 1  ON 47
eH2_8                 2.092261e-01 1 1  ON 48
eH2_9                 8.963894e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.195712
====================================================
  Execution time = 3.6949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4280e-01
  Total weights = 2.0001e+06
  Execution time = 4.4487e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730540387
                                         uncertainty =       0.004237122063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730540387
                                         uncertainty =       0.004237122063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413999738
  error estimate for blocks of size 2^( 2) =       0.000425745252
  error estimate for blocks of size 2^( 3) =       0.000437514374
  error estimate for blocks of size 2^( 4) =       0.000449315110
  error estimate for blocks of size 2^( 5) =       0.000460424760
  error estimate for blocks of size 2^( 6) =       0.000470148365
  error estimate for blocks of size 2^( 7) =       0.000475714466

      target function =                  N/A
              le_mean =     -16.910602916328
             les_mean =     286.311293357923
             stat err =       0.000463900675
             autocorr =       1.255595863787
              std dev =       0.585493412091
             le_variance =       0.342802535602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730247504
                                         uncertainty =       0.004237120959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730247504
                                         uncertainty =       0.004237120959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413999561
  error estimate for blocks of size 2^( 2) =       0.000425745083
  error estimate for blocks of size 2^( 3) =       0.000437514204
  error estimate for blocks of size 2^( 4) =       0.000449314939
  error estimate for blocks of size 2^( 5) =       0.000460424599
  error estimate for blocks of size 2^( 6) =       0.000470148206
  error estimate for blocks of size 2^( 7) =       0.000475714302

      target function =                  N/A
              le_mean =     -16.910602916370
             les_mean =     286.311293066342
             stat err =       0.000463900511
             autocorr =       1.255596050129
              std dev =       0.585493161870
             le_variance =       0.342802242597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730393802
                                         uncertainty =       0.004237121510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730393802
                                         uncertainty =       0.004237121510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413999650
  error estimate for blocks of size 2^( 2) =       0.000425745168
  error estimate for blocks of size 2^( 3) =       0.000437514289
  error estimate for blocks of size 2^( 4) =       0.000449315024
  error estimate for blocks of size 2^( 5) =       0.000460424679
  error estimate for blocks of size 2^( 6) =       0.000470148285
  error estimate for blocks of size 2^( 7) =       0.000475714384

      target function =                  N/A
              le_mean =     -16.910602916348
             les_mean =     286.311293211967
             stat err =       0.000463900593
             autocorr =       1.255595957069
              std dev =       0.585493286858
             le_variance =       0.342802388956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730522059
                                         uncertainty =       0.004237121994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342730522059
                                         uncertainty =       0.004237121994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413999727
  error estimate for blocks of size 2^( 2) =       0.000425745242
  error estimate for blocks of size 2^( 3) =       0.000437514364
  error estimate for blocks of size 2^( 4) =       0.000449315099
  error estimate for blocks of size 2^( 5) =       0.000460424750
  error estimate for blocks of size 2^( 6) =       0.000470148355
  error estimate for blocks of size 2^( 7) =       0.000475714456

      target function =                  N/A
              le_mean =     -16.910602916330
             les_mean =     286.311293339673
             stat err =       0.000463900665
             autocorr =       1.255595875461
              std dev =       0.585493396433
             le_variance =       0.342802517267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910602916328        initial
     3.7253e+02     3.7253e+03             4.7079e-07       -16.910602916370  <--
     1.4901e+03     1.4901e+04             1.1770e-07       -16.910602916348
     5.9605e+03     5.9605e+04             2.9427e-08       -16.910602916330

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 6.0203e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.104521e-01 1 1  ON 0
 uu_1                 1.451862e-01 1 1  ON 1
 uu_2                 4.685987e-02 1 1  ON 2
 uu_3                -1.690334e-02 1 1  ON 3
 uu_4                -6.719949e-02 1 1  ON 4
 uu_5                -1.045515e-01 1 1  ON 5
 uu_6                -1.337682e-01 1 1  ON 6
 uu_7                -1.484272e-01 1 1  ON 7
 uu_8                -1.417911e-01 1 1  ON 8
 uu_9                -1.133387e-01 1 1  ON 9
 ud_0                 4.377983e-01 1 1  ON 10
 ud_1                 1.807773e-01 1 1  ON 11
 ud_2                 6.676349e-02 1 1  ON 12
 ud_3                -2.467907e-03 1 1  ON 13
 ud_4                -5.879478e-02 1 1  ON 14
 ud_5                -1.017362e-01 1 1  ON 15
 ud_6                -1.314843e-01 1 1  ON 16
 ud_7                -1.518332e-01 1 1  ON 17
 ud_8                -1.559985e-01 1 1  ON 18
 ud_9                -1.458673e-01 1 1  ON 19
 eO_0                -7.502929e-01 1 1  ON 20
 eO_1                -4.330935e-01 1 1  ON 21
 eO_2                -1.089718e-02 1 1  ON 22
 eO_3                 3.131277e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520537e-01 1 1  ON 26
 eO_7                -5.269850e-02 1 1  ON 27
 eO_8                -2.392822e-01 1 1  ON 28
 eO_9                -1.012770e-01 1 1  ON 29
eH1_0                -2.692883e-01 1 1  ON 30
eH1_1                -1.625901e-01 1 1  ON 31
eH1_2                -1.192475e-01 1 1  ON 32
eH1_3                -6.622531e-02 1 1  ON 33
eH1_4                -6.805287e-03 1 1  ON 34
eH1_5                 3.784817e-02 1 1  ON 35
eH1_6                 1.097687e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046720e-01 1 1  ON 38
eH1_9                 9.439274e-02 1 1  ON 39
eH2_0                -2.667607e-01 1 1  ON 40
eH2_1                -1.607087e-01 1 1  ON 41
eH2_2                -1.169108e-01 1 1  ON 42
eH2_3                -6.359558e-02 1 1  ON 43
eH2_4                -3.727934e-03 1 1  ON 44
eH2_5                 3.951023e-02 1 1  ON 45
eH2_6                 1.105454e-01 1 1  ON 46
eH2_7                 1.730988e-01 1 1  ON 47
eH2_8                 2.092262e-01 1 1  ON 48
eH2_9                 8.963924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.834
    reference variance = 0.651669
====================================================
  Execution time = 3.9280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4017e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8279e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340179891129
                                         uncertainty =       0.004986284021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340179891129
                                         uncertainty =       0.004986284021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412406890
  error estimate for blocks of size 2^( 2) =       0.000423967984
  error estimate for blocks of size 2^( 3) =       0.000436569623
  error estimate for blocks of size 2^( 4) =       0.000448962517
  error estimate for blocks of size 2^( 5) =       0.000458916560
  error estimate for blocks of size 2^( 6) =       0.000467373487
  error estimate for blocks of size 2^( 7) =       0.000471714291

      target function =                  N/A
              le_mean =     -16.910450120758
             les_mean =     286.303492886827
             stat err =       0.000461741714
             autocorr =       1.253563671308
              std dev =       0.583240748102
             le_variance =       0.340169770247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691045012076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910450120758       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910450120277       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910450109694       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910450103593       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910450105395       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910450102996       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910450103769       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910450104226       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 3.302272e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910450120758       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910450120638       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910450117985       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910450116454       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910450116906       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910450116304       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910450116496       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910450116612       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 8.273033e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910450120758       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910450120728       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910450120065       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910450119681       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910450119795       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910450119644       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910450119691       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910450119719       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.069346e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9116e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.104513e-01 1 1  ON 0
 uu_1                 1.451865e-01 1 1  ON 1
 uu_2                 4.685998e-02 1 1  ON 2
 uu_3                -1.690298e-02 1 1  ON 3
 uu_4                -6.719956e-02 1 1  ON 4
 uu_5                -1.045516e-01 1 1  ON 5
 uu_6                -1.337677e-01 1 1  ON 6
 uu_7                -1.484273e-01 1 1  ON 7
 uu_8                -1.417911e-01 1 1  ON 8
 uu_9                -1.133389e-01 1 1  ON 9
 ud_0                 4.377986e-01 1 1  ON 10
 ud_1                 1.807771e-01 1 1  ON 11
 ud_2                 6.676367e-02 1 1  ON 12
 ud_3                -2.468064e-03 1 1  ON 13
 ud_4                -5.879452e-02 1 1  ON 14
 ud_5                -1.017361e-01 1 1  ON 15
 ud_6                -1.314845e-01 1 1  ON 16
 ud_7                -1.518333e-01 1 1  ON 17
 ud_8                -1.559985e-01 1 1  ON 18
 ud_9                -1.458673e-01 1 1  ON 19
 eO_0                -7.502931e-01 1 1  ON 20
 eO_1                -4.330931e-01 1 1  ON 21
 eO_2                -1.089711e-02 1 1  ON 22
 eO_3                 3.131280e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520539e-01 1 1  ON 26
 eO_7                -5.269871e-02 1 1  ON 27
 eO_8                -2.392824e-01 1 1  ON 28
 eO_9                -1.012773e-01 1 1  ON 29
eH1_0                -2.692884e-01 1 1  ON 30
eH1_1                -1.625903e-01 1 1  ON 31
eH1_2                -1.192478e-01 1 1  ON 32
eH1_3                -6.622519e-02 1 1  ON 33
eH1_4                -6.805050e-03 1 1  ON 34
eH1_5                 3.784806e-02 1 1  ON 35
eH1_6                 1.097684e-01 1 1  ON 36
eH1_7                 1.752041e-01 1 1  ON 37
eH1_8                 2.046724e-01 1 1  ON 38
eH1_9                 9.439327e-02 1 1  ON 39
eH2_0                -2.667610e-01 1 1  ON 40
eH2_1                -1.607086e-01 1 1  ON 41
eH2_2                -1.169110e-01 1 1  ON 42
eH2_3                -6.359587e-02 1 1  ON 43
eH2_4                -3.727960e-03 1 1  ON 44
eH2_5                 3.951011e-02 1 1  ON 45
eH2_6                 1.105452e-01 1 1  ON 46
eH2_7                 1.730990e-01 1 1  ON 47
eH2_8                 2.092265e-01 1 1  ON 48
eH2_9                 8.963983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.296358
====================================================
  Execution time = 3.7005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4214e-01
  Total weights = 2.0001e+06
  Execution time = 4.4485e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946602385
                                         uncertainty =       0.004400871008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946602385
                                         uncertainty =       0.004400871008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413600219
  error estimate for blocks of size 2^( 2) =       0.000425120040
  error estimate for blocks of size 2^( 3) =       0.000436816186
  error estimate for blocks of size 2^( 4) =       0.000447205397
  error estimate for blocks of size 2^( 5) =       0.000457700498
  error estimate for blocks of size 2^( 6) =       0.000465459120
  error estimate for blocks of size 2^( 7) =       0.000468088657

      target function =                  N/A
              le_mean =     -16.910083399946
             les_mean =     286.293061652413
             stat err =       0.000459613418
             autocorr =       1.234877501777
              std dev =       0.584928397614
             le_variance =       0.342141230335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946471274
                                         uncertainty =       0.004400873195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946471274
                                         uncertainty =       0.004400873195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413600140
  error estimate for blocks of size 2^( 2) =       0.000425119958
  error estimate for blocks of size 2^( 3) =       0.000436816096
  error estimate for blocks of size 2^( 4) =       0.000447205269
  error estimate for blocks of size 2^( 5) =       0.000457700382
  error estimate for blocks of size 2^( 6) =       0.000465458988
  error estimate for blocks of size 2^( 7) =       0.000468088477

      target function =                  N/A
              le_mean =     -16.910083430076
             les_mean =     286.293062541468
             stat err =       0.000459613279
             autocorr =       1.234877222874
              std dev =       0.584928286547
             le_variance =       0.342141100403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946537255
                                         uncertainty =       0.004400872122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946537255
                                         uncertainty =       0.004400872122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413600180
  error estimate for blocks of size 2^( 2) =       0.000425119999
  error estimate for blocks of size 2^( 3) =       0.000436816141
  error estimate for blocks of size 2^( 4) =       0.000447205333
  error estimate for blocks of size 2^( 5) =       0.000457700440
  error estimate for blocks of size 2^( 6) =       0.000465459054
  error estimate for blocks of size 2^( 7) =       0.000468088567

      target function =                  N/A
              le_mean =     -16.910083415048
             les_mean =     286.293062098595
             stat err =       0.000459613349
             autocorr =       1.234877361672
              std dev =       0.584928342445
             le_variance =       0.342141165795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946594251
                                         uncertainty =       0.004400871148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341946594251
                                         uncertainty =       0.004400871148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413600214
  error estimate for blocks of size 2^( 2) =       0.000425120035
  error estimate for blocks of size 2^( 3) =       0.000436816180
  error estimate for blocks of size 2^( 4) =       0.000447205389
  error estimate for blocks of size 2^( 5) =       0.000457700491
  error estimate for blocks of size 2^( 6) =       0.000465459112
  error estimate for blocks of size 2^( 7) =       0.000468088646

      target function =                  N/A
              le_mean =     -16.910083401835
             les_mean =     286.293061708211
             stat err =       0.000459613409
             autocorr =       1.234877484249
              std dev =       0.584928390724
             le_variance =       0.342141222275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910083399946        initial
     9.3132e+01     9.3132e+02             3.3023e-06       -16.910083430076  <--
     3.7253e+02     3.7253e+03             8.2730e-07       -16.910083415048
     1.4901e+03     1.4901e+04             2.0693e-07       -16.910083401835

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 6.0420e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690191e-02 1 1  ON 3
 uu_4                -6.719977e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484276e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133393e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676420e-02 1 1  ON 12
 ud_3                -2.468531e-03 1 1  ON 13
 ud_4                -5.879373e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330917e-01 1 1  ON 21
 eO_2                -1.089689e-02 1 1  ON 22
 eO_3                 3.131290e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269932e-02 1 1  ON 27
 eO_8                -2.392830e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692890e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622484e-02 1 1  ON 33
eH1_4                -6.804337e-03 1 1  ON 34
eH1_5                 3.784774e-02 1 1  ON 35
eH1_6                 1.097673e-01 1 1  ON 36
eH1_7                 1.752038e-01 1 1  ON 37
eH1_8                 2.046734e-01 1 1  ON 38
eH1_9                 9.439486e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359673e-02 1 1  ON 43
eH2_4                -3.728038e-03 1 1  ON 44
eH2_5                 3.950974e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0954e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8345
    reference variance = 0.335882
====================================================
  Execution time = 3.7136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8667e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337315073402
                                         uncertainty =       0.004508757605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337315073402
                                         uncertainty =       0.004508757605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410619108
  error estimate for blocks of size 2^( 2) =       0.000422853008
  error estimate for blocks of size 2^( 3) =       0.000434974204
  error estimate for blocks of size 2^( 4) =       0.000446666027
  error estimate for blocks of size 2^( 5) =       0.000456387488
  error estimate for blocks of size 2^( 6) =       0.000466200897
  error estimate for blocks of size 2^( 7) =       0.000472606463

      target function =                  N/A
              le_mean =     -16.909889691621
             les_mean =     286.281596108860
             stat err =       0.000460465218
             autocorr =       1.257521305003
              std dev =       0.580712402721
             le_variance =       0.337226894674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690988969162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909889691621       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909889684795       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909889698396       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909889680131       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909889681059       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909889680458       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909889679995       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909889683654       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.732457e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909889691621       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909889689907       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909889693314       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909889688693       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909889688898       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909889688698       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909889688598       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909889689516       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.934074e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909889691621       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909889691192       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909889692044       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909889690885       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909889690935       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909889690882       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909889690858       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909889691088       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.835777e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7011e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.104491e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686149e-02 1 1  ON 2
 uu_3                -1.690189e-02 1 1  ON 3
 uu_4                -6.719921e-02 1 1  ON 4
 uu_5                -1.045520e-01 1 1  ON 5
 uu_6                -1.337660e-01 1 1  ON 6
 uu_7                -1.484287e-01 1 1  ON 7
 uu_8                -1.417920e-01 1 1  ON 8
 uu_9                -1.133403e-01 1 1  ON 9
 ud_0                 4.377992e-01 1 1  ON 10
 ud_1                 1.807771e-01 1 1  ON 11
 ud_2                 6.676503e-02 1 1  ON 12
 ud_3                -2.468332e-03 1 1  ON 13
 ud_4                -5.879269e-02 1 1  ON 14
 ud_5                -1.017360e-01 1 1  ON 15
 ud_6                -1.314852e-01 1 1  ON 16
 ud_7                -1.518333e-01 1 1  ON 17
 ud_8                -1.559987e-01 1 1  ON 18
 ud_9                -1.458684e-01 1 1  ON 19
 eO_0                -7.502930e-01 1 1  ON 20
 eO_1                -4.330904e-01 1 1  ON 21
 eO_2                -1.089637e-02 1 1  ON 22
 eO_3                 3.131284e-01 1 1  ON 23
 eO_4                 5.354743e-01 1 1  ON 24
 eO_5                 4.900324e-01 1 1  ON 25
 eO_6                 2.520547e-01 1 1  ON 26
 eO_7                -5.269994e-02 1 1  ON 27
 eO_8                -2.392840e-01 1 1  ON 28
 eO_9                -1.012796e-01 1 1  ON 29
eH1_0                -2.692897e-01 1 1  ON 30
eH1_1                -1.625921e-01 1 1  ON 31
eH1_2                -1.192493e-01 1 1  ON 32
eH1_3                -6.622488e-02 1 1  ON 33
eH1_4                -6.804294e-03 1 1  ON 34
eH1_5                 3.784793e-02 1 1  ON 35
eH1_6                 1.097666e-01 1 1  ON 36
eH1_7                 1.752040e-01 1 1  ON 37
eH1_8                 2.046745e-01 1 1  ON 38
eH1_9                 9.439638e-02 1 1  ON 39
eH2_0                -2.667629e-01 1 1  ON 40
eH2_1                -1.607071e-01 1 1  ON 41
eH2_2                -1.169125e-01 1 1  ON 42
eH2_3                -6.359727e-02 1 1  ON 43
eH2_4                -3.729631e-03 1 1  ON 44
eH2_5                 3.950967e-02 1 1  ON 45
eH2_6                 1.105438e-01 1 1  ON 46
eH2_7                 1.731000e-01 1 1  ON 47
eH2_8                 2.092278e-01 1 1  ON 48
eH2_9                 8.964354e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9357
    reference variance = 0.252568
====================================================
  Execution time = 3.6816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4302e-01
  Total weights = 2.0001e+06
  Execution time = 4.4389e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342890756045
                                         uncertainty =       0.005879704783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342890756045
                                         uncertainty =       0.005879704783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414132905
  error estimate for blocks of size 2^( 2) =       0.000425420219
  error estimate for blocks of size 2^( 3) =       0.000437714816
  error estimate for blocks of size 2^( 4) =       0.000449750204
  error estimate for blocks of size 2^( 5) =       0.000460485148
  error estimate for blocks of size 2^( 6) =       0.000467849756
  error estimate for blocks of size 2^( 7) =       0.000471364009

      target function =                  N/A
              le_mean =     -16.910178501480
             les_mean =     286.297159883420
             stat err =       0.000462362279
             autocorr =       1.246479997217
              std dev =       0.585681742073
             le_variance =       0.343023102998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342887725787
                                         uncertainty =       0.005879740764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342887725787
                                         uncertainty =       0.005879740764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414131076
  error estimate for blocks of size 2^( 2) =       0.000425418401
  error estimate for blocks of size 2^( 3) =       0.000437712982
  error estimate for blocks of size 2^( 4) =       0.000449748449
  error estimate for blocks of size 2^( 5) =       0.000460483413
  error estimate for blocks of size 2^( 6) =       0.000467848015
  error estimate for blocks of size 2^( 7) =       0.000471362238

      target function =                  N/A
              le_mean =     -16.910178499748
             les_mean =     286.297156793844
             stat err =       0.000462360529
             autocorr =       1.246481572191
              std dev =       0.585679154485
             le_variance =       0.343020071998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342889210576
                                         uncertainty =       0.005879722770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342889210576
                                         uncertainty =       0.005879722770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414131972
  error estimate for blocks of size 2^( 2) =       0.000425419292
  error estimate for blocks of size 2^( 3) =       0.000437713882
  error estimate for blocks of size 2^( 4) =       0.000449749310
  error estimate for blocks of size 2^( 5) =       0.000460484265
  error estimate for blocks of size 2^( 6) =       0.000467848869
  error estimate for blocks of size 2^( 7) =       0.000471363108

      target function =                  N/A
              le_mean =     -16.910178500399
             les_mean =     286.297158300993
             stat err =       0.000462361388
             autocorr =       1.246480808238
              std dev =       0.585680422368
             le_variance =       0.343021557145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342890561858
                                         uncertainty =       0.005879707031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342890561858
                                         uncertainty =       0.005879707031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414132788
  error estimate for blocks of size 2^( 2) =       0.000425420102
  error estimate for blocks of size 2^( 3) =       0.000437714699
  error estimate for blocks of size 2^( 4) =       0.000449750092
  error estimate for blocks of size 2^( 5) =       0.000460485037
  error estimate for blocks of size 2^( 6) =       0.000467849645
  error estimate for blocks of size 2^( 7) =       0.000471363896

      target function =                  N/A
              le_mean =     -16.910178501334
             les_mean =     286.297159684238
             stat err =       0.000462362167
             autocorr =       1.246480099359
              std dev =       0.585681576254
             le_variance =       0.343022908763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910178501480        initial  <--
     2.3283e+01     2.3283e+02             7.7325e-06       -16.910178499748
     9.3132e+01     9.3132e+02             1.9341e-06       -16.910178500399
     3.7253e+02     3.7253e+03             4.8358e-07       -16.910178501334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.1879
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690191e-02 1 1  ON 3
 uu_4                -6.719977e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484276e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133393e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676420e-02 1 1  ON 12
 ud_3                -2.468531e-03 1 1  ON 13
 ud_4                -5.879373e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330917e-01 1 1  ON 21
 eO_2                -1.089689e-02 1 1  ON 22
 eO_3                 3.131290e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269932e-02 1 1  ON 27
 eO_8                -2.392830e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692890e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622484e-02 1 1  ON 33
eH1_4                -6.804337e-03 1 1  ON 34
eH1_5                 3.784774e-02 1 1  ON 35
eH1_6                 1.097673e-01 1 1  ON 36
eH1_7                 1.752038e-01 1 1  ON 37
eH1_8                 2.046734e-01 1 1  ON 38
eH1_9                 9.439486e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359673e-02 1 1  ON 43
eH2_4                -3.728038e-03 1 1  ON 44
eH2_5                 3.950974e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0721e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9227
    reference variance = 0.138418
====================================================
  Execution time = 3.7059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4458e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9295e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344522113379
                                         uncertainty =       0.008564728405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344522113379
                                         uncertainty =       0.008564728405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415070156
  error estimate for blocks of size 2^( 2) =       0.000426968898
  error estimate for blocks of size 2^( 3) =       0.000440257290
  error estimate for blocks of size 2^( 4) =       0.000452397804
  error estimate for blocks of size 2^( 5) =       0.000463609965
  error estimate for blocks of size 2^( 6) =       0.000473555359
  error estimate for blocks of size 2^( 7) =       0.000483102851

      target function =                  N/A
              le_mean =     -16.909785083480
             les_mean =     286.285408891439
             stat err =       0.000468166495
             autocorr =       1.272206597722
              std dev =       0.587007235248
             le_variance =       0.344577494234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690978508348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909785083480       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909785086339       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909785085164       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909785083875       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909785083529       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909785084307       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909785083456       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909785083339       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.678378e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909785083480       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909785084195       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909785083901       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909785083579       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909785083492       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909785083686       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909785083473       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909785083444       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.169721e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909785083480       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909785083659       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909785083585       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909785083505       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909785083484       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909785083530       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909785083478       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909785083471       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.424382e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6997e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.104487e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686043e-02 1 1  ON 2
 uu_3                -1.690193e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045519e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417912e-01 1 1  ON 8
 uu_9                -1.133393e-01 1 1  ON 9
 ud_0                 4.377992e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676419e-02 1 1  ON 12
 ud_3                -2.468683e-03 1 1  ON 13
 ud_4                -5.879363e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314850e-01 1 1  ON 16
 ud_7                -1.518334e-01 1 1  ON 17
 ud_8                -1.559984e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330918e-01 1 1  ON 21
 eO_2                -1.089678e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354738e-01 1 1  ON 24
 eO_5                 4.900318e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012783e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192490e-01 1 1  ON 32
eH1_3                -6.622490e-02 1 1  ON 33
eH1_4                -6.804279e-03 1 1  ON 34
eH1_5                 3.784768e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439505e-02 1 1  ON 39
eH2_0                -2.667620e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359679e-02 1 1  ON 43
eH2_4                -3.728173e-03 1 1  ON 44
eH2_5                 3.950965e-02 1 1  ON 45
eH2_6                 1.105445e-01 1 1  ON 46
eH2_7                 1.730996e-01 1 1  ON 47
eH2_8                 2.092275e-01 1 1  ON 48
eH2_9                 8.964182e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.792
    reference variance = 0.644096
====================================================
  Execution time = 3.7027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3272e-01
  Total weights = 2.0001e+06
  Execution time = 4.4468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674685255
                                         uncertainty =       0.002590256717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674685255
                                         uncertainty =       0.002590256717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407863686
  error estimate for blocks of size 2^( 2) =       0.000419487086
  error estimate for blocks of size 2^( 3) =       0.000432000849
  error estimate for blocks of size 2^( 4) =       0.000443515037
  error estimate for blocks of size 2^( 5) =       0.000453494104
  error estimate for blocks of size 2^( 6) =       0.000462944285
  error estimate for blocks of size 2^( 7) =       0.000470869332

      target function =                  N/A
              le_mean =     -16.909662714524
             les_mean =     286.269409171146
             stat err =       0.000457705689
             autocorr =       1.259338681714
              std dev =       0.576815584512
             le_variance =       0.332716218536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674173903
                                         uncertainty =       0.002590252284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674173903
                                         uncertainty =       0.002590252284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407863372
  error estimate for blocks of size 2^( 2) =       0.000419486786
  error estimate for blocks of size 2^( 3) =       0.000432000559
  error estimate for blocks of size 2^( 4) =       0.000443514761
  error estimate for blocks of size 2^( 5) =       0.000453493838
  error estimate for blocks of size 2^( 6) =       0.000462944024
  error estimate for blocks of size 2^( 7) =       0.000470869077

      target function =                  N/A
              le_mean =     -16.909662712479
             les_mean =     286.269408590514
             stat err =       0.000457705425
             autocorr =       1.259339161648
              std dev =       0.576815141159
             le_variance =       0.332715707071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674429122
                                         uncertainty =       0.002590254497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674429122
                                         uncertainty =       0.002590254497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407863529
  error estimate for blocks of size 2^( 2) =       0.000419486936
  error estimate for blocks of size 2^( 3) =       0.000432000704
  error estimate for blocks of size 2^( 4) =       0.000443514899
  error estimate for blocks of size 2^( 5) =       0.000453493970
  error estimate for blocks of size 2^( 6) =       0.000462944154
  error estimate for blocks of size 2^( 7) =       0.000470869205

      target function =                  N/A
              le_mean =     -16.909662713503
             les_mean =     286.269408880424
             stat err =       0.000457705557
             autocorr =       1.259338922078
              std dev =       0.576815362439
             le_variance =       0.332715962346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674653224
                                         uncertainty =       0.002590256440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332674653224
                                         uncertainty =       0.002590256440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407863666
  error estimate for blocks of size 2^( 2) =       0.000419487067
  error estimate for blocks of size 2^( 3) =       0.000432000831
  error estimate for blocks of size 2^( 4) =       0.000443515020
  error estimate for blocks of size 2^( 5) =       0.000453494087
  error estimate for blocks of size 2^( 6) =       0.000462944269
  error estimate for blocks of size 2^( 7) =       0.000470869316

      target function =                  N/A
              le_mean =     -16.909662714396
             les_mean =     286.269409134790
             stat err =       0.000457705673
             autocorr =       1.259338711774
              std dev =       0.576815556740
             le_variance =       0.332716186498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909662714524        initial  <--
     2.3283e+02     2.3283e+03             8.6784e-07       -16.909662712479
     9.3132e+02     9.3132e+03             2.1697e-07       -16.909662713503
     3.7253e+03     3.7253e+04             5.4244e-08       -16.909662714396

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3241
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690191e-02 1 1  ON 3
 uu_4                -6.719977e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484276e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133393e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676420e-02 1 1  ON 12
 ud_3                -2.468531e-03 1 1  ON 13
 ud_4                -5.879373e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330917e-01 1 1  ON 21
 eO_2                -1.089689e-02 1 1  ON 22
 eO_3                 3.131290e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269932e-02 1 1  ON 27
 eO_8                -2.392830e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692890e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622484e-02 1 1  ON 33
eH1_4                -6.804337e-03 1 1  ON 34
eH1_5                 3.784774e-02 1 1  ON 35
eH1_6                 1.097673e-01 1 1  ON 36
eH1_7                 1.752038e-01 1 1  ON 37
eH1_8                 2.046734e-01 1 1  ON 38
eH1_9                 9.439486e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359673e-02 1 1  ON 43
eH2_4                -3.728038e-03 1 1  ON 44
eH2_5                 3.950974e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0733e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.180569
====================================================
  Execution time = 3.9273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8678e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430178743
                                         uncertainty =       0.003272718912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430178743
                                         uncertainty =       0.003272718912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406479488
  error estimate for blocks of size 2^( 2) =       0.000418166511
  error estimate for blocks of size 2^( 3) =       0.000430748411
  error estimate for blocks of size 2^( 4) =       0.000441898832
  error estimate for blocks of size 2^( 5) =       0.000451634538
  error estimate for blocks of size 2^( 6) =       0.000458736413
  error estimate for blocks of size 2^( 7) =       0.000463411301

      target function =                  N/A
              le_mean =     -16.909805865454
             les_mean =     286.271995965183
             stat err =       0.000453920271
             autocorr =       1.247044309013
              std dev =       0.574858002529
             le_variance =       0.330461723072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690980586545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909805865454       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909805865960       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909805866399       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909805866681       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909805866957       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909805867027       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909805867053       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909805866983       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.117460e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909805865454       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909805865580       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909805865690       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909805865761       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909805865826       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909805865840       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909805865847       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909805865838       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.029370e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909805865454       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909805865485       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909805865513       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909805865542       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909805865520       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909805865554       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909805865553       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909805865532       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.073429e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9149e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690190e-02 1 1  ON 3
 uu_4                -6.719978e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484276e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133393e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676422e-02 1 1  ON 12
 ud_3                -2.468533e-03 1 1  ON 13
 ud_4                -5.879371e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458671e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330917e-01 1 1  ON 21
 eO_2                -1.089688e-02 1 1  ON 22
 eO_3                 3.131290e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269933e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622485e-02 1 1  ON 33
eH1_4                -6.804330e-03 1 1  ON 34
eH1_5                 3.784774e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752038e-01 1 1  ON 37
eH1_8                 2.046734e-01 1 1  ON 38
eH1_9                 9.439488e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728039e-03 1 1  ON 44
eH2_5                 3.950975e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964162e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8327
    reference variance = 0.265409
====================================================
  Execution time = 3.6941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4699e-01
  Total weights = 2.0001e+06
  Execution time = 4.4704e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346889012699
                                         uncertainty =       0.004747618099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346889012699
                                         uncertainty =       0.004747618099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416521549
  error estimate for blocks of size 2^( 2) =       0.000428633618
  error estimate for blocks of size 2^( 3) =       0.000441157467
  error estimate for blocks of size 2^( 4) =       0.000453857383
  error estimate for blocks of size 2^( 5) =       0.000464375360
  error estimate for blocks of size 2^( 6) =       0.000475009752
  error estimate for blocks of size 2^( 7) =       0.000483353074

      target function =                  N/A
              le_mean =     -16.909599667930
             les_mean =     286.281552261745
             stat err =       0.000469148892
             autocorr =       1.268663485004
              std dev =       0.589059848881
             le_variance =       0.346991505563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346888973762
                                         uncertainty =       0.004747617845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346888973762
                                         uncertainty =       0.004747617845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416521526
  error estimate for blocks of size 2^( 2) =       0.000428633596
  error estimate for blocks of size 2^( 3) =       0.000441157445
  error estimate for blocks of size 2^( 4) =       0.000453857362
  error estimate for blocks of size 2^( 5) =       0.000464375340
  error estimate for blocks of size 2^( 6) =       0.000475009734
  error estimate for blocks of size 2^( 7) =       0.000483353057

      target function =                  N/A
              le_mean =     -16.909599668069
             les_mean =     286.281552227460
             stat err =       0.000469148873
             autocorr =       1.268663524301
              std dev =       0.589059815803
             le_variance =       0.346991466594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346888993227
                                         uncertainty =       0.004747617972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346888993227
                                         uncertainty =       0.004747617972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416521538
  error estimate for blocks of size 2^( 2) =       0.000428633607
  error estimate for blocks of size 2^( 3) =       0.000441157456
  error estimate for blocks of size 2^( 4) =       0.000453857373
  error estimate for blocks of size 2^( 5) =       0.000464375350
  error estimate for blocks of size 2^( 6) =       0.000475009743
  error estimate for blocks of size 2^( 7) =       0.000483353065

      target function =                  N/A
              le_mean =     -16.909599668000
             les_mean =     286.281552244600
             stat err =       0.000469148883
             autocorr =       1.268663504653
              std dev =       0.589059832339
             le_variance =       0.346991486075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346889010265
                                         uncertainty =       0.004747618084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346889010265
                                         uncertainty =       0.004747618084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416521548
  error estimate for blocks of size 2^( 2) =       0.000428633617
  error estimate for blocks of size 2^( 3) =       0.000441157466
  error estimate for blocks of size 2^( 4) =       0.000453857382
  error estimate for blocks of size 2^( 5) =       0.000464375358
  error estimate for blocks of size 2^( 6) =       0.000475009751
  error estimate for blocks of size 2^( 7) =       0.000483353073

      target function =                  N/A
              le_mean =     -16.909599667939
             les_mean =     286.281552259602
             stat err =       0.000469148891
             autocorr =       1.268663487458
              std dev =       0.589059846813
             le_variance =       0.346991503127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909599667930        initial
     2.3283e+03     2.3283e+04             8.1175e-08       -16.909599668069  <--
     9.3132e+03     9.3132e+04             2.0294e-08       -16.909599668000
     3.7253e+04     3.7253e+05             5.0734e-09       -16.909599667939

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 6.0362e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0952e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8434
    reference variance = 0.197615
====================================================
  Execution time = 3.6991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4473e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7691e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344628494936
                                         uncertainty =       0.005501599905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344628494936
                                         uncertainty =       0.005501599905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415164276
  error estimate for blocks of size 2^( 2) =       0.000426677817
  error estimate for blocks of size 2^( 3) =       0.000438753345
  error estimate for blocks of size 2^( 4) =       0.000450320328
  error estimate for blocks of size 2^( 5) =       0.000460815946
  error estimate for blocks of size 2^( 6) =       0.000467901578
  error estimate for blocks of size 2^( 7) =       0.000473314209

      target function =                  N/A
              le_mean =     -16.909588935797
             les_mean =     286.278931588866
             stat err =       0.000463088015
             autocorr =       1.244191214356
              std dev =       0.587140344046
             le_variance =       0.344733783606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690958893580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909588935797       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909588937461       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909588937047       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909588936257       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909588935832       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909588937076       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909588936975       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909588937040       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.549492e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909588935797       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909588936213       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909588936109       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909588935912       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909588935805       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909588936116       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909588936092       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909588936106       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.873869e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909588935797       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909588935901       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909588935875       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909588935822       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909588935795       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909588935871       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909588935867       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909588935882       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.218476e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6769e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686034e-02 1 1  ON 2
 uu_3                -1.690184e-02 1 1  ON 3
 uu_4                -6.719979e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337663e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807767e-01 1 1  ON 11
 ud_2                 6.676429e-02 1 1  ON 12
 ud_3                -2.468560e-03 1 1  ON 13
 ud_4                -5.879363e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089683e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269936e-02 1 1  ON 27
 eO_8                -2.392832e-01 1 1  ON 28
 eO_9                -1.012783e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625910e-01 1 1  ON 31
eH1_2                -1.192489e-01 1 1  ON 32
eH1_3                -6.622490e-02 1 1  ON 33
eH1_4                -6.804317e-03 1 1  ON 34
eH1_5                 3.784769e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046736e-01 1 1  ON 38
eH1_9                 9.439502e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169118e-01 1 1  ON 42
eH2_3                -6.359675e-02 1 1  ON 43
eH2_4                -3.728083e-03 1 1  ON 44
eH2_5                 3.950973e-02 1 1  ON 45
eH2_6                 1.105445e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092274e-01 1 1  ON 48
eH2_9                 8.964173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0496
    reference variance = 0.285176
====================================================
  Execution time = 3.7025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3626e-01
  Total weights = 2.0001e+06
  Execution time = 4.4973e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360793458
                                         uncertainty =       0.003575012389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360793458
                                         uncertainty =       0.003575012389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410029149
  error estimate for blocks of size 2^( 2) =       0.000421645541
  error estimate for blocks of size 2^( 3) =       0.000432932443
  error estimate for blocks of size 2^( 4) =       0.000445055801
  error estimate for blocks of size 2^( 5) =       0.000455009686
  error estimate for blocks of size 2^( 6) =       0.000461451089
  error estimate for blocks of size 2^( 7) =       0.000467114239

      target function =                  N/A
              le_mean =     -16.909764070914
             les_mean =     286.276379332490
             stat err =       0.000457157704
             autocorr =       1.243090137601
              std dev =       0.579878061858
             le_variance =       0.336258566624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360583166
                                         uncertainty =       0.003575009911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360583166
                                         uncertainty =       0.003575009911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410029021
  error estimate for blocks of size 2^( 2) =       0.000421645417
  error estimate for blocks of size 2^( 3) =       0.000432932321
  error estimate for blocks of size 2^( 4) =       0.000445055681
  error estimate for blocks of size 2^( 5) =       0.000455009564
  error estimate for blocks of size 2^( 6) =       0.000461450967
  error estimate for blocks of size 2^( 7) =       0.000467114120

      target function =                  N/A
              le_mean =     -16.909764070233
             les_mean =     286.276379099119
             stat err =       0.000457157583
             autocorr =       1.243090258761
              std dev =       0.579877880519
             le_variance =       0.336258356315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360688238
                                         uncertainty =       0.003575011149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360688238
                                         uncertainty =       0.003575011149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410029085
  error estimate for blocks of size 2^( 2) =       0.000421645479
  error estimate for blocks of size 2^( 3) =       0.000432932382
  error estimate for blocks of size 2^( 4) =       0.000445055741
  error estimate for blocks of size 2^( 5) =       0.000455009625
  error estimate for blocks of size 2^( 6) =       0.000461451028
  error estimate for blocks of size 2^( 7) =       0.000467114179

      target function =                  N/A
              le_mean =     -16.909764070573
             les_mean =     286.276379215727
             stat err =       0.000457157643
             autocorr =       1.243090198237
              std dev =       0.579877971125
             le_variance =       0.336258461396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360780303
                                         uncertainty =       0.003575012234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336360780303
                                         uncertainty =       0.003575012234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410029141
  error estimate for blocks of size 2^( 2) =       0.000421645533
  error estimate for blocks of size 2^( 3) =       0.000432932435
  error estimate for blocks of size 2^( 4) =       0.000445055793
  error estimate for blocks of size 2^( 5) =       0.000455009678
  error estimate for blocks of size 2^( 6) =       0.000461451082
  error estimate for blocks of size 2^( 7) =       0.000467114231

      target function =                  N/A
              le_mean =     -16.909764070872
             les_mean =     286.276379317891
             stat err =       0.000457157696
             autocorr =       1.243090145180
              std dev =       0.579878050514
             le_variance =       0.336258553468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909764070914        initial  <--
     5.8208e+02     5.8208e+03             3.5495e-07       -16.909764070233
     2.3283e+03     2.3283e+04             8.8739e-08       -16.909764070573
     9.3132e+03     9.3132e+04             2.2185e-08       -16.909764070872

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4606
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0724e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8756
    reference variance = 0.239423
====================================================
  Execution time = 3.7057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8452e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335740319353
                                         uncertainty =       0.003280080535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335740319353
                                         uncertainty =       0.003280080535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409703163
  error estimate for blocks of size 2^( 2) =       0.000421365301
  error estimate for blocks of size 2^( 3) =       0.000433754310
  error estimate for blocks of size 2^( 4) =       0.000445593190
  error estimate for blocks of size 2^( 5) =       0.000456890152
  error estimate for blocks of size 2^( 6) =       0.000464631788
  error estimate for blocks of size 2^( 7) =       0.000469569422

      target function =                  N/A
              le_mean =     -16.908944056660
             les_mean =     286.248113049675
             stat err =       0.000459171138
             autocorr =       1.256060419024
              std dev =       0.579417040030
             le_variance =       0.335724106277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690894405666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908944056660       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908944056691       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908944056739       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908944056840       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908944056843       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908944056877       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908944056821       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908944056824       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.578107e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908944056660       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908944056668       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908944056680       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908944056705       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908944056706       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908944056714       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908944056739       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908944056704       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 8.945602e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908944056660       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908944056662       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908944056665       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908944056668       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908944056658       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908944056618       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908944056755       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908944056664       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.236421e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6911e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468542e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089685e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192489e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439495e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359675e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9867
    reference variance = 0.259045
====================================================
  Execution time = 3.7154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4151e-01
  Total weights = 2.0001e+06
  Execution time = 5.1833e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422170516
                                         uncertainty =       0.004259962548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422170516
                                         uncertainty =       0.004259962548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413219543
  error estimate for blocks of size 2^( 2) =       0.000424801407
  error estimate for blocks of size 2^( 3) =       0.000436318681
  error estimate for blocks of size 2^( 4) =       0.000447918494
  error estimate for blocks of size 2^( 5) =       0.000457585611
  error estimate for blocks of size 2^( 6) =       0.000464726766
  error estimate for blocks of size 2^( 7) =       0.000470275193

      target function =                  N/A
              le_mean =     -16.909497589571
             les_mean =     286.272620270279
             stat err =       0.000460126516
             autocorr =       1.239917576479
              std dev =       0.584390031854
             le_variance =       0.341511709330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422161736
                                         uncertainty =       0.004259962377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422161736
                                         uncertainty =       0.004259962377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413219538
  error estimate for blocks of size 2^( 2) =       0.000424801401
  error estimate for blocks of size 2^( 3) =       0.000436318675
  error estimate for blocks of size 2^( 4) =       0.000447918488
  error estimate for blocks of size 2^( 5) =       0.000457585605
  error estimate for blocks of size 2^( 6) =       0.000464726759
  error estimate for blocks of size 2^( 7) =       0.000470275186

      target function =                  N/A
              le_mean =     -16.909497589282
             les_mean =     286.272620251693
             stat err =       0.000460126510
             autocorr =       1.239917574536
              std dev =       0.584390024314
             le_variance =       0.341511700518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422166126
                                         uncertainty =       0.004259962462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422166126
                                         uncertainty =       0.004259962462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413219540
  error estimate for blocks of size 2^( 2) =       0.000424801404
  error estimate for blocks of size 2^( 3) =       0.000436318678
  error estimate for blocks of size 2^( 4) =       0.000447918491
  error estimate for blocks of size 2^( 5) =       0.000457585608
  error estimate for blocks of size 2^( 6) =       0.000464726762
  error estimate for blocks of size 2^( 7) =       0.000470275190

      target function =                  N/A
              le_mean =     -16.909497589426
             les_mean =     286.272620260986
             stat err =       0.000460126513
             autocorr =       1.239917575506
              std dev =       0.584390028084
             le_variance =       0.341511704924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422169967
                                         uncertainty =       0.004259962537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422169967
                                         uncertainty =       0.004259962537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413219543
  error estimate for blocks of size 2^( 2) =       0.000424801406
  error estimate for blocks of size 2^( 3) =       0.000436318680
  error estimate for blocks of size 2^( 4) =       0.000447918494
  error estimate for blocks of size 2^( 5) =       0.000457585611
  error estimate for blocks of size 2^( 6) =       0.000464726765
  error estimate for blocks of size 2^( 7) =       0.000470275192

      target function =                  N/A
              le_mean =     -16.909497589553
             les_mean =     286.272620269118
             stat err =       0.000460126515
             autocorr =       1.239917576351
              std dev =       0.584390031383
             le_variance =       0.341511708780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909497589571        initial  <--
     5.8208e+03     5.8208e+04             3.5781e-08       -16.909497589282
     2.3283e+04     2.3283e+05             8.9456e-09       -16.909497589426
     9.3132e+04     9.3132e+05             2.2364e-09       -16.909497589553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2612
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0818e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9952
    reference variance = 0.186522
====================================================
  Execution time = 3.7145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4437e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8417e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344207188423
                                         uncertainty =       0.005623135573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344207188423
                                         uncertainty =       0.005623135573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414946609
  error estimate for blocks of size 2^( 2) =       0.000426809719
  error estimate for blocks of size 2^( 3) =       0.000438441183
  error estimate for blocks of size 2^( 4) =       0.000449963498
  error estimate for blocks of size 2^( 5) =       0.000459623878
  error estimate for blocks of size 2^( 6) =       0.000467200307
  error estimate for blocks of size 2^( 7) =       0.000470410778

      target function =                  N/A
              le_mean =     -16.910486334923
             les_mean =     286.308920308447
             stat err =       0.000461799615
             autocorr =       1.238576090365
              std dev =       0.586832511880
             le_variance =       0.344372396999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691048633492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486334923       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486334929       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486334936       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486334939       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486334937       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486334938       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486334943       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910486334899       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.402111e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486334923       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486334925       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486334926       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486334927       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486334928       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486334779       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486334960       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910486334853       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 8.505289e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486334923       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486334924       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486334924       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486334970       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486334994       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486334923       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486334492       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910486336082       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.126323e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6996e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192489e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728042e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.347391
====================================================
  Execution time = 3.6840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3914e-01
  Total weights = 2.0001e+06
  Execution time = 4.4624e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159395059
                                         uncertainty =       0.004409455639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159395059
                                         uncertainty =       0.004409455639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411784131
  error estimate for blocks of size 2^( 2) =       0.000423735032
  error estimate for blocks of size 2^( 3) =       0.000436587244
  error estimate for blocks of size 2^( 4) =       0.000449313882
  error estimate for blocks of size 2^( 5) =       0.000459687390
  error estimate for blocks of size 2^( 6) =       0.000468074934
  error estimate for blocks of size 2^( 7) =       0.000476395059

      target function =                  N/A
              le_mean =     -16.909622190316
             les_mean =     286.274465642600
             stat err =       0.000463367816
             autocorr =       1.266229771580
              std dev =       0.582360020029
             le_variance =       0.339143192928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394097
                                         uncertainty =       0.004409455612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394097
                                         uncertainty =       0.004409455612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411784130
  error estimate for blocks of size 2^( 2) =       0.000423735031
  error estimate for blocks of size 2^( 3) =       0.000436587243
  error estimate for blocks of size 2^( 4) =       0.000449313881
  error estimate for blocks of size 2^( 5) =       0.000459687390
  error estimate for blocks of size 2^( 6) =       0.000468074933
  error estimate for blocks of size 2^( 7) =       0.000476395059

      target function =                  N/A
              le_mean =     -16.909622190315
             les_mean =     286.274465641584
             stat err =       0.000463367816
             autocorr =       1.266229772120
              std dev =       0.582360019203
             le_variance =       0.339143191966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394578
                                         uncertainty =       0.004409455626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394578
                                         uncertainty =       0.004409455626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411784130
  error estimate for blocks of size 2^( 2) =       0.000423735031
  error estimate for blocks of size 2^( 3) =       0.000436587243
  error estimate for blocks of size 2^( 4) =       0.000449313881
  error estimate for blocks of size 2^( 5) =       0.000459687390
  error estimate for blocks of size 2^( 6) =       0.000468074934
  error estimate for blocks of size 2^( 7) =       0.000476395059

      target function =                  N/A
              le_mean =     -16.909622190316
             les_mean =     286.274465642092
             stat err =       0.000463367816
             autocorr =       1.266229771848
              std dev =       0.582360019616
             le_variance =       0.339143192447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394999
                                         uncertainty =       0.004409455638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339159394999
                                         uncertainty =       0.004409455638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411784131
  error estimate for blocks of size 2^( 2) =       0.000423735032
  error estimate for blocks of size 2^( 3) =       0.000436587244
  error estimate for blocks of size 2^( 4) =       0.000449313882
  error estimate for blocks of size 2^( 5) =       0.000459687390
  error estimate for blocks of size 2^( 6) =       0.000468074934
  error estimate for blocks of size 2^( 7) =       0.000476395059

      target function =                  N/A
              le_mean =     -16.909622190316
             les_mean =     286.274465642537
             stat err =       0.000463367816
             autocorr =       1.266229771619
              std dev =       0.582360019977
             le_variance =       0.339143192868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909622190316        initial  <--
     5.8208e+04     5.8208e+05             3.4021e-09       -16.909622190315
     2.3283e+05     2.3283e+06             8.5053e-10       -16.909622190316
     9.3132e+05     9.3132e+06             2.1263e-10       -16.909622190316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2272
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0725e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0052
    reference variance = 0.184108
====================================================
  Execution time = 3.6995e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7719e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338263648135
                                         uncertainty =       0.003420938877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338263648135
                                         uncertainty =       0.003420938877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411201414
  error estimate for blocks of size 2^( 2) =       0.000422602311
  error estimate for blocks of size 2^( 3) =       0.000434799423
  error estimate for blocks of size 2^( 4) =       0.000445393640
  error estimate for blocks of size 2^( 5) =       0.000454629609
  error estimate for blocks of size 2^( 6) =       0.000461645595
  error estimate for blocks of size 2^( 7) =       0.000466018929

      target function =                  N/A
              le_mean =     -16.910144508438
             les_mean =     286.291171155086
             stat err =       0.000456921943
             autocorr =       1.234738046419
              std dev =       0.581535921434
             le_variance =       0.338184027918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691014450844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144508438       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144508439       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144508439       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144508440       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144508525       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144508440       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144508373       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144508471       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.673344e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144508438       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144508438       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144508438       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144509395       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144508416       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144506288       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144511401       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144508514       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.183371e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144508438       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144508438       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144508438       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144514446       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144507254       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144507808       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144491437       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144503343       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.295810e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6775e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9485
    reference variance = 0.215781
====================================================
  Execution time = 3.6886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.0001e+06
  Execution time = 4.4602e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476773064
                                         uncertainty =       0.003368790676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476773064
                                         uncertainty =       0.003368790676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736737
  error estimate for blocks of size 2^( 2) =       0.000422263195
  error estimate for blocks of size 2^( 3) =       0.000434878776
  error estimate for blocks of size 2^( 4) =       0.000446922799
  error estimate for blocks of size 2^( 5) =       0.000456881293
  error estimate for blocks of size 2^( 6) =       0.000464030178
  error estimate for blocks of size 2^( 7) =       0.000468768173

      target function =                  N/A
              le_mean =     -16.910879949416
             les_mean =     286.315280626302
             stat err =       0.000459150611
             autocorr =       1.249635157996
              std dev =       0.580878757965
             le_variance =       0.337420131454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476772525
                                         uncertainty =       0.003368790672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476772525
                                         uncertainty =       0.003368790672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736737
  error estimate for blocks of size 2^( 2) =       0.000422263195
  error estimate for blocks of size 2^( 3) =       0.000434878776
  error estimate for blocks of size 2^( 4) =       0.000446922798
  error estimate for blocks of size 2^( 5) =       0.000456881293
  error estimate for blocks of size 2^( 6) =       0.000464030178
  error estimate for blocks of size 2^( 7) =       0.000468768173

      target function =                  N/A
              le_mean =     -16.910879949415
             les_mean =     286.315280625748
             stat err =       0.000459150611
             autocorr =       1.249635158469
              std dev =       0.580878757501
             le_variance =       0.337420130916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476772794
                                         uncertainty =       0.003368790674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476772794
                                         uncertainty =       0.003368790674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736737
  error estimate for blocks of size 2^( 2) =       0.000422263195
  error estimate for blocks of size 2^( 3) =       0.000434878776
  error estimate for blocks of size 2^( 4) =       0.000446922798
  error estimate for blocks of size 2^( 5) =       0.000456881293
  error estimate for blocks of size 2^( 6) =       0.000464030178
  error estimate for blocks of size 2^( 7) =       0.000468768173

      target function =                  N/A
              le_mean =     -16.910879949416
             les_mean =     286.315280626025
             stat err =       0.000459150611
             autocorr =       1.249635158227
              std dev =       0.580878757733
             le_variance =       0.337420131185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476773030
                                         uncertainty =       0.003368790676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337476773030
                                         uncertainty =       0.003368790676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736737
  error estimate for blocks of size 2^( 2) =       0.000422263195
  error estimate for blocks of size 2^( 3) =       0.000434878776
  error estimate for blocks of size 2^( 4) =       0.000446922799
  error estimate for blocks of size 2^( 5) =       0.000456881293
  error estimate for blocks of size 2^( 6) =       0.000464030178
  error estimate for blocks of size 2^( 7) =       0.000468768173

      target function =                  N/A
              le_mean =     -16.910879949416
             les_mean =     286.315280626268
             stat err =       0.000459150611
             autocorr =       1.249635158019
              std dev =       0.580878757936
             le_variance =       0.337420131421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910879949416        initial  <--
     5.8208e+05     5.8208e+06             3.6733e-10       -16.910879949415
     2.3283e+06     2.3283e+07             9.1834e-11       -16.910879949416
     9.3132e+06     9.3132e+07             2.2958e-11       -16.910879949416

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2067
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9698
    reference variance = 0.244398
====================================================
  Execution time = 3.7175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4251e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342584916568
                                         uncertainty =       0.005792416553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342584916568
                                         uncertainty =       0.005792416553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413821318
  error estimate for blocks of size 2^( 2) =       0.000425743931
  error estimate for blocks of size 2^( 3) =       0.000438125418
  error estimate for blocks of size 2^( 4) =       0.000450151976
  error estimate for blocks of size 2^( 5) =       0.000460482212
  error estimate for blocks of size 2^( 6) =       0.000468695600
  error estimate for blocks of size 2^( 7) =       0.000473569021

      target function =                  N/A
              le_mean =     -16.909673014177
             les_mean =     286.279548401955
             stat err =       0.000463224702
             autocorr =       1.253019132106
              std dev =       0.585241084350
             le_variance =       0.342507126812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690967301418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909673014177       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909673014177       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909673014177       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909673014177       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909673019677       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909673011075       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909673012726       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909673023030       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.098544e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909673014177       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909673014177       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909673014177       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909673010986       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909673014989       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909673020608       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909673028813       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909673009802       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.024621e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909673014177       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909673014177       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909673014177       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909673014177       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909673015553       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909673012200       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909673057085       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909672991849       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.561499e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7078e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.180926
====================================================
  Execution time = 3.8704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.0001e+06
  Execution time = 4.4558e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676354
                                         uncertainty =       0.004568560242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676354
                                         uncertainty =       0.004568560242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410970508
  error estimate for blocks of size 2^( 2) =       0.000422983859
  error estimate for blocks of size 2^( 3) =       0.000435380245
  error estimate for blocks of size 2^( 4) =       0.000447281889
  error estimate for blocks of size 2^( 5) =       0.000457511781
  error estimate for blocks of size 2^( 6) =       0.000465806271
  error estimate for blocks of size 2^( 7) =       0.000472084070

      target function =                  N/A
              le_mean =     -16.910026789699
             les_mean =     286.286810186028
             stat err =       0.000460671003
             autocorr =       1.256494053979
              std dev =       0.581209365528
             le_variance =       0.337804326578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676306
                                         uncertainty =       0.004568560243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676306
                                         uncertainty =       0.004568560243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410970508
  error estimate for blocks of size 2^( 2) =       0.000422983859
  error estimate for blocks of size 2^( 3) =       0.000435380245
  error estimate for blocks of size 2^( 4) =       0.000447281889
  error estimate for blocks of size 2^( 5) =       0.000457511781
  error estimate for blocks of size 2^( 6) =       0.000465806271
  error estimate for blocks of size 2^( 7) =       0.000472084070

      target function =                  N/A
              le_mean =     -16.910026789699
             les_mean =     286.286810185980
             stat err =       0.000460671003
             autocorr =       1.256494054023
              std dev =       0.581209365487
             le_variance =       0.337804326530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676330
                                         uncertainty =       0.004568560243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676330
                                         uncertainty =       0.004568560243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410970508
  error estimate for blocks of size 2^( 2) =       0.000422983859
  error estimate for blocks of size 2^( 3) =       0.000435380245
  error estimate for blocks of size 2^( 4) =       0.000447281889
  error estimate for blocks of size 2^( 5) =       0.000457511781
  error estimate for blocks of size 2^( 6) =       0.000465806271
  error estimate for blocks of size 2^( 7) =       0.000472084070

      target function =                  N/A
              le_mean =     -16.910026789699
             les_mean =     286.286810186004
             stat err =       0.000460671003
             autocorr =       1.256494054008
              std dev =       0.581209365508
             le_variance =       0.337804326554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676351
                                         uncertainty =       0.004568560242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863676351
                                         uncertainty =       0.004568560242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410970508
  error estimate for blocks of size 2^( 2) =       0.000422983859
  error estimate for blocks of size 2^( 3) =       0.000435380245
  error estimate for blocks of size 2^( 4) =       0.000447281889
  error estimate for blocks of size 2^( 5) =       0.000457511781
  error estimate for blocks of size 2^( 6) =       0.000465806271
  error estimate for blocks of size 2^( 7) =       0.000472084070

      target function =                  N/A
              le_mean =     -16.910026789699
             les_mean =     286.286810186025
             stat err =       0.000460671003
             autocorr =       1.256494053994
              std dev =       0.581209365526
             le_variance =       0.337804326575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910026789699        initial  <--
     5.8208e+06     5.8208e+07             4.0985e-11       -16.910026789699
     2.3283e+07     2.3283e+08             1.0246e-11       -16.910026789699
     9.3132e+07     9.3132e+08             2.5615e-12       -16.910026789699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0572
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0914e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.414792
====================================================
  Execution time = 3.7319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0834e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.000064000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8264e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338259766112
                                         uncertainty =       0.003214804984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338259766112
                                         uncertainty =       0.003214804984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244083
  error estimate for blocks of size 2^( 2) =       0.000422846152
  error estimate for blocks of size 2^( 3) =       0.000435210908
  error estimate for blocks of size 2^( 4) =       0.000446519575
  error estimate for blocks of size 2^( 5) =       0.000456540137
  error estimate for blocks of size 2^( 6) =       0.000462674246
  error estimate for blocks of size 2^( 7) =       0.000469261489

      target function =                  N/A
              le_mean =     -16.910029315453
             les_mean =     286.287345495488
             stat err =       0.000458748862
             autocorr =       1.244373274552
              std dev =       0.581596264712
             le_variance =       0.338254215127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691002931545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910029315453       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910029315453       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910029315453       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910029315453       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910029315453       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910029315453       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910029315453       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.924438e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910029315453       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910029315453       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910029315453       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910029315453       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910029365209       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910029311324       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910029475767       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 9.811170e-13

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910029315453       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910029315453       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910029315453       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910029315453       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910029315453       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910029525524       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910029590577       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.452340e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7154e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.273899
====================================================
  Execution time = 3.6840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4916e-01
  Total weights = 2.0001e+06
  Execution time = 4.4630e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854838
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854838
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417823258
  error estimate for blocks of size 2^( 2) =       0.000429526059
  error estimate for blocks of size 2^( 3) =       0.000441292699
  error estimate for blocks of size 2^( 4) =       0.000453345405
  error estimate for blocks of size 2^( 5) =       0.000463107548
  error estimate for blocks of size 2^( 6) =       0.000469648922
  error estimate for blocks of size 2^( 7) =       0.000474385637

      target function =                  N/A
              le_mean =     -16.910682505276
             les_mean =     286.320346342386
             stat err =       0.000465121878
             autocorr =       1.239219713141
              std dev =       0.590900772296
             le_variance =       0.349163722700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854834
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854834
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417823258
  error estimate for blocks of size 2^( 2) =       0.000429526059
  error estimate for blocks of size 2^( 3) =       0.000441292699
  error estimate for blocks of size 2^( 4) =       0.000453345405
  error estimate for blocks of size 2^( 5) =       0.000463107548
  error estimate for blocks of size 2^( 6) =       0.000469648922
  error estimate for blocks of size 2^( 7) =       0.000474385637

      target function =                  N/A
              le_mean =     -16.910682505276
             les_mean =     286.320346342382
             stat err =       0.000465121878
             autocorr =       1.239219713142
              std dev =       0.590900772292
             le_variance =       0.349163722696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854836
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854836
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417823258
  error estimate for blocks of size 2^( 2) =       0.000429526059
  error estimate for blocks of size 2^( 3) =       0.000441292699
  error estimate for blocks of size 2^( 4) =       0.000453345405
  error estimate for blocks of size 2^( 5) =       0.000463107548
  error estimate for blocks of size 2^( 6) =       0.000469648922
  error estimate for blocks of size 2^( 7) =       0.000474385637

      target function =                  N/A
              le_mean =     -16.910682505276
             les_mean =     286.320346342384
             stat err =       0.000465121878
             autocorr =       1.239219713142
              std dev =       0.590900772294
             le_variance =       0.349163722698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854838
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349224854838
                                         uncertainty =       0.005254742112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417823258
  error estimate for blocks of size 2^( 2) =       0.000429526059
  error estimate for blocks of size 2^( 3) =       0.000441292699
  error estimate for blocks of size 2^( 4) =       0.000453345405
  error estimate for blocks of size 2^( 5) =       0.000463107548
  error estimate for blocks of size 2^( 6) =       0.000469648922
  error estimate for blocks of size 2^( 7) =       0.000474385637

      target function =                  N/A
              le_mean =     -16.910682505276
             les_mean =     286.320346342386
             stat err =       0.000465121878
             autocorr =       1.239219713138
              std dev =       0.590900772296
             le_variance =       0.349163722700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910682505276        initial
     5.8208e+07     5.8208e+08             3.9244e-12       -16.910682505276  <--
     2.3283e+08     2.3283e+09             9.8112e-13       -16.910682505276
     9.3132e+08     9.3132e+09             2.4523e-13       -16.910682505276

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 6.0170e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0735e+02 secs
  Total Execution time = 4.3163e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
