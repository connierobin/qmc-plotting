Rank =    0  Free Memory = 88338 MB
Rank =    1  Free Memory = 88338 MB
Rank =    2  Free Memory = 88338 MB
Rank =    3  Free Memory = 88338 MB
Rank =    4  Free Memory = 88338 MB
Rank =    5  Free Memory = 88338 MB
Rank =    6  Free Memory = 88337 MB
Rank =    7  Free Memory = 88337 MB
Rank =    8  Free Memory = 88337 MB
Rank =    9  Free Memory = 88337 MB
Rank =   10  Free Memory = 88337 MB
Rank =   11  Free Memory = 88337 MB
Rank =   12  Free Memory = 88337 MB
Rank =   13  Free Memory = 88337 MB
Rank =   14  Free Memory = 88337 MB
Rank =   15  Free Memory = 88323 MB
Rank =   16  Free Memory = 88323 MB
Rank =   17  Free Memory = 88323 MB
Rank =   18  Free Memory = 88323 MB
Rank =   19  Free Memory = 88323 MB
Rank =   20  Free Memory = 88323 MB
Rank =   21  Free Memory = 88323 MB
Rank =   22  Free Memory = 88323 MB
Rank =   23  Free Memory = 88323 MB
Rank =   24  Free Memory = 88323 MB
Rank =   25  Free Memory = 88322 MB
Rank =   26  Free Memory = 88322 MB
Rank =   27  Free Memory = 88322 MB
Rank =   28  Free Memory = 88322 MB
Rank =   29  Free Memory = 88322 MB
Rank =   30  Free Memory = 88322 MB
Rank =   31  Free Memory = 88322 MB
Rank =   32  Free Memory = 69904 MB
Rank =   33  Free Memory = 69904 MB
Rank =   34  Free Memory = 69903 MB
Rank =   35  Free Memory = 69903 MB
Rank =   36  Free Memory = 69903 MB
Rank =   37  Free Memory = 69903 MB
Rank =   38  Free Memory = 69903 MB
Rank =   39  Free Memory = 69903 MB
Rank =   40  Free Memory = 69903 MB
Rank =   41  Free Memory = 69903 MB
Rank =   42  Free Memory = 69903 MB
Rank =   43  Free Memory = 69903 MB
Rank =   44  Free Memory = 69903 MB
Rank =   45  Free Memory = 69903 MB
Rank =   46  Free Memory = 69903 MB
Rank =   47  Free Memory = 69903 MB
Rank =   48  Free Memory = 69903 MB
Rank =   49  Free Memory = 69903 MB
Rank =   50  Free Memory = 69903 MB
Rank =   51  Free Memory = 69903 MB
Rank =   52  Free Memory = 69903 MB
Rank =   53  Free Memory = 69903 MB
Rank =   54  Free Memory = 69903 MB
Rank =   55  Free Memory = 69903 MB
Rank =   56  Free Memory = 69903 MB
Rank =   57  Free Memory = 69903 MB
Rank =   58  Free Memory = 69903 MB
Rank =   59  Free Memory = 69903 MB
Rank =   60  Free Memory = 69903 MB
Rank =   61  Free Memory = 69903 MB
Rank =   62  Free Memory = 69903 MB
Rank =   63  Free Memory = 69903 MB
Rank =   64  Free Memory = 73862 MB
Rank =   65  Free Memory = 73861 MB
Rank =   66  Free Memory = 73861 MB
Rank =   67  Free Memory = 73861 MB
Rank =   68  Free Memory = 73861 MB
Rank =   69  Free Memory = 73861 MB
Rank =   70  Free Memory = 73861 MB
Rank =   71  Free Memory = 73861 MB
Rank =   72  Free Memory = 73861 MB
Rank =   73  Free Memory = 73861 MB
Rank =   74  Free Memory = 73861 MB
Rank =   75  Free Memory = 73861 MB
Rank =   76  Free Memory = 73861 MB
Rank =   77  Free Memory = 73861 MB
Rank =   78  Free Memory = 73861 MB
Rank =   79  Free Memory = 73861 MB
Rank =   80  Free Memory = 73861 MB
Rank =   81  Free Memory = 73861 MB
Rank =   82  Free Memory = 73861 MB
Rank =   83  Free Memory = 73861 MB
Rank =   84  Free Memory = 73861 MB
Rank =   85  Free Memory = 73861 MB
Rank =   86  Free Memory = 73861 MB
Rank =   87  Free Memory = 73861 MB
Rank =   88  Free Memory = 73861 MB
Rank =   89  Free Memory = 73861 MB
Rank =   90  Free Memory = 73861 MB
Rank =   91  Free Memory = 73861 MB
Rank =   92  Free Memory = 73861 MB
Rank =   93  Free Memory = 73861 MB
Rank =   94  Free Memory = 73861 MB
Rank =   95  Free Memory = 73861 MB
Rank =   96  Free Memory = 87697 MB
Rank =   97  Free Memory = 87697 MB
Rank =   98  Free Memory = 87697 MB
Rank =   99  Free Memory = 87697 MB
Rank =  100  Free Memory = 87697 MB
Rank =  101  Free Memory = 87697 MB
Rank =  102  Free Memory = 87697 MB
Rank =  103  Free Memory = 87697 MB
Rank =  104  Free Memory = 87697 MB
Rank =  105  Free Memory = 87697 MB
Rank =  106  Free Memory = 87697 MB
Rank =  107  Free Memory = 87697 MB
Rank =  108  Free Memory = 87697 MB
Rank =  109  Free Memory = 87697 MB
Rank =  110  Free Memory = 87697 MB
Rank =  111  Free Memory = 87697 MB
Rank =  112  Free Memory = 87697 MB
Rank =  113  Free Memory = 87697 MB
Rank =  114  Free Memory = 87697 MB
Rank =  115  Free Memory = 87697 MB
Rank =  116  Free Memory = 87697 MB
Rank =  117  Free Memory = 87697 MB
Rank =  118  Free Memory = 87696 MB
Rank =  119  Free Memory = 87696 MB
Rank =  120  Free Memory = 87696 MB
Rank =  121  Free Memory = 87696 MB
Rank =  122  Free Memory = 87696 MB
Rank =  123  Free Memory = 87696 MB
Rank =  124  Free Memory = 87696 MB
Rank =  125  Free Memory = 87696 MB
Rank =  126  Free Memory = 87696 MB
Rank =  127  Free Memory = 87696 MB
  Input file(s): opt_h2o_1b1_gvptt_277dets_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_277dets_run001h.xml

  Project = H2O
  date    = 2023-05-15 14:27:41 PDT
  host    = n0064.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 973

  Range of prime numbers to use as seeds over processors and threads = 7687-8849


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.078367e-01    1         1  ON     0
     uu_1                 1.425434e-01    1         1  ON     1
     uu_2                 4.452419e-02    1         1  ON     2
     uu_3                -1.911852e-02    1         1  ON     3
     uu_4                -6.924837e-02    1         1  ON     4
     uu_5                -1.052293e-01    1         1  ON     5
     uu_6                -1.320263e-01    1         1  ON     6
     uu_7                -1.448972e-01    1         1  ON     7
     uu_8                -1.359658e-01    1         1  ON     8
     uu_9                -1.082878e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.398870e-01    1         1  ON     0
     ud_1                 1.814295e-01    1         1  ON     1
     ud_2                 6.642205e-02    1         1  ON     2
     ud_3                -3.253591e-03    1         1  ON     3
     ud_4                -5.895802e-02    1         1  ON     4
     ud_5                -1.021404e-01    1         1  ON     5
     ud_6                -1.321058e-01    1         1  ON     6
     ud_7                -1.527802e-01    1         1  ON     7
     ud_8                -1.564066e-01    1         1  ON     8
     ud_9                -1.474587e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.598025e-01    1         1  ON     0
     eO_1                -4.427200e-01    1         1  ON     1
     eO_2                -2.444857e-02    1         1  ON     2
     eO_3                 3.026644e-01    1         1  ON     3
     eO_4                 5.324548e-01    1         1  ON     4
     eO_5                 4.961119e-01    1         1  ON     5
     eO_6                 2.679592e-01    1         1  ON     6
     eO_7                -3.956929e-02    1         1  ON     7
     eO_8                -2.338418e-01    1         1  ON     8
     eO_9                -9.647660e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.595754e-01    1         1  ON     0
     eH1_1                -1.546545e-01    1         1  ON     1
     eH1_2                -1.088141e-01    1         1  ON     2
     eH1_3                -5.661541e-02    1         1  ON     3
     eH1_4                -4.861409e-03    1         1  ON     4
     eH1_5                 3.172065e-02    1         1  ON     5
     eH1_6                 9.672006e-02    1         1  ON     6
     eH1_7                 1.599821e-01    1         1  ON     7
     eH1_8                 1.967106e-01    1         1  ON     8
     eH1_9                 9.469430e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.531265e-01    1         1  ON     0
     eH2_1                -1.480854e-01    1         1  ON     1
     eH2_2                -1.023244e-01    1         1  ON     2
     eH2_3                -5.002865e-02    1         1  ON     3
     eH2_4                 1.388630e-03    1         1  ON     4
     eH2_5                 3.639509e-02    1         1  ON     5
     eH2_6                 1.002474e-01    1         1  ON     6
     eH2_7                 1.599911e-01    1         1  ON     7
     eH2_8                 1.962441e-01    1         1  ON     8
     eH2_9                 7.481333e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 277 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 5.965900e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 70 unique up determinants.
Found 70 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9605e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8811
    reference variance = 0.257834
====================================================
  Execution time = 2.4841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323559674981
                                         uncertainty =       0.002930505236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323559674981
                                         uncertainty =       0.002930505236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387224
  error estimate for blocks of size 2^( 2) =       0.000414463178
  error estimate for blocks of size 2^( 3) =       0.000426244516
  error estimate for blocks of size 2^( 4) =       0.000437919474
  error estimate for blocks of size 2^( 5) =       0.000447923948
  error estimate for blocks of size 2^( 6) =       0.000456425406
  error estimate for blocks of size 2^( 7) =       0.000461135321

      target function =                  N/A
              le_mean =     -16.910757257549
             les_mean =     286.297541817220
             stat err =       0.000450851037
             autocorr =       1.255387445274
              std dev =       0.569061468894
             le_variance =       0.323830955379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691075725755e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910757257549       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910774887183       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910776977820       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910776107271       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910775097918       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910774534276       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910774763314       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910774616509       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910775187249       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910775314845       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910775312636       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.844913e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910757257549       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910763891340       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910764846144       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910764921429       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910764379085       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910763935532       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910764050699       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910764058114       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910764089999       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.423218e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910757257549       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910759155707       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910759461643       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910759519826       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910759382100       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910759218419       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910759248777       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910759252392       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910759253127       residual = 9.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.967668e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1160e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.079694e-01                 1 1 ON  0
uu_1  1.425291e-01                 1 1 ON  1
uu_2  4.443405e-02                 1 1 ON  2
uu_3  -1.911068e-02                1 1 ON  3
uu_4  -6.925925e-02                1 1 ON  4
uu_5  -1.052114e-01                1 1 ON  5
uu_6  -1.320883e-01                1 1 ON  6
uu_7  -1.449287e-01                1 1 ON  7
uu_8  -1.359952e-01                1 1 ON  8
uu_9  -1.083126e-01                1 1 ON  9
ud_0  4.398720e-01                 1 1 ON  10
ud_1  1.815751e-01                 1 1 ON  11
ud_2  6.649874e-02                 1 1 ON  12
ud_3  -3.171906e-03                1 1 ON  13
ud_4  -5.904600e-02                1 1 ON  14
ud_5  -1.021062e-01                1 1 ON  15
ud_6  -1.320669e-01                1 1 ON  16
ud_7  -1.528048e-01                1 1 ON  17
ud_8  -1.564957e-01                1 1 ON  18
ud_9  -1.475045e-01                1 1 ON  19
eO_0  -7.595163e-01                1 1 ON  20
eO_1  -4.424753e-01                1 1 ON  21
eO_2  -2.479089e-02                1 1 ON  22
eO_3  3.024579e-01                 1 1 ON  23
eO_4  5.324788e-01                 1 1 ON  24
eO_5  4.962117e-01                 1 1 ON  25
eO_6  2.680253e-01                 1 1 ON  26
eO_7  -3.952198e-02                1 1 ON  27
eO_8  -2.339316e-01                1 1 ON  28
eO_9  -9.659270e-02                1 1 ON  29
eH1_0 -2.596454e-01                1 1 ON  30
eH1_1 -1.546704e-01                1 1 ON  31
eH1_2 -1.088330e-01                1 1 ON  32
eH1_3 -5.659137e-02                1 1 ON  33
eH1_4 -4.989454e-03                1 1 ON  34
eH1_5 3.156361e-02                 1 1 ON  35
eH1_6 9.678689e-02                 1 1 ON  36
eH1_7 1.600172e-01                 1 1 ON  37
eH1_8 1.967849e-01                 1 1 ON  38
eH1_9 9.482764e-02                 1 1 ON  39
eH2_0 -2.532226e-01                1 1 ON  40
eH2_1 -1.481839e-01                1 1 ON  41
eH2_2 -1.022668e-01                1 1 ON  42
eH2_3 -5.004658e-02                1 1 ON  43
eH2_4 1.340661e-03                 1 1 ON  44
eH2_5 3.631066e-02                 1 1 ON  45
eH2_6 1.001804e-01                 1 1 ON  46
eH2_7 1.600182e-01                 1 1 ON  47
eH2_8 1.963506e-01                 1 1 ON  48
eH2_9 7.500289e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.13457
====================================================
  Execution time = 2.4447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3555e-01
  Total weights = 2.0000e+06
  Execution time = 2.7816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335728108016
                                         uncertainty =       0.004926449421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335728108016
                                         uncertainty =       0.004926449421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409641045
  error estimate for blocks of size 2^( 2) =       0.000421407234
  error estimate for blocks of size 2^( 3) =       0.000432924561
  error estimate for blocks of size 2^( 4) =       0.000444120285
  error estimate for blocks of size 2^( 5) =       0.000454286273
  error estimate for blocks of size 2^( 6) =       0.000461608749
  error estimate for blocks of size 2^( 7) =       0.000468306080

      target function =                  N/A
              le_mean =     -16.911395079054
             les_mean =     286.330894923692
             stat err =       0.000457080347
             autocorr =       1.245025267261
              std dev =       0.579319921674
             le_variance =       0.335611571648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335575020832
                                         uncertainty =       0.004921334289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335575020832
                                         uncertainty =       0.004921334289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409547592
  error estimate for blocks of size 2^( 2) =       0.000421304342
  error estimate for blocks of size 2^( 3) =       0.000432811219
  error estimate for blocks of size 2^( 4) =       0.000444006445
  error estimate for blocks of size 2^( 5) =       0.000454182546
  error estimate for blocks of size 2^( 6) =       0.000461494202
  error estimate for blocks of size 2^( 7) =       0.000468227966

      target function =                  N/A
              le_mean =     -16.911397681372
             les_mean =     286.330829829898
             stat err =       0.000456977790
             autocorr =       1.245034632222
              std dev =       0.579187758941
             le_variance =       0.335458460108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335617496730
                                         uncertainty =       0.004922371372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335617496730
                                         uncertainty =       0.004922371372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409573519
  error estimate for blocks of size 2^( 2) =       0.000421333082
  error estimate for blocks of size 2^( 3) =       0.000432842247
  error estimate for blocks of size 2^( 4) =       0.000444036615
  error estimate for blocks of size 2^( 5) =       0.000454209457
  error estimate for blocks of size 2^( 6) =       0.000461520359
  error estimate for blocks of size 2^( 7) =       0.000468245595

      target function =                  N/A
              le_mean =     -16.911396795753
             les_mean =     286.330842350185
             stat err =       0.000457003007
             autocorr =       1.245014403959
              std dev =       0.579224425004
             le_variance =       0.335500934521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335708484952
                                         uncertainty =       0.004925790658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335708484952
                                         uncertainty =       0.004925790658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409629068
  error estimate for blocks of size 2^( 2) =       0.000421394247
  error estimate for blocks of size 2^( 3) =       0.000432910319
  error estimate for blocks of size 2^( 4) =       0.000444105755
  error estimate for blocks of size 2^( 5) =       0.000454272682
  error estimate for blocks of size 2^( 6) =       0.000461593244
  error estimate for blocks of size 2^( 7) =       0.000468294726

      target function =                  N/A
              le_mean =     -16.911395001160
             les_mean =     286.330872663653
             stat err =       0.000457066602
             autocorr =       1.245023196279
              std dev =       0.579302983079
             le_variance =       0.335591946204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911395079054        initial
     2.5000e-01     2.5000e+00             8.8449e-04       -16.911397681372  <--
     1.0000e+00     1.0000e+01             3.4232e-04       -16.911396795753
     4.0000e+00     4.0000e+01             9.9677e-05       -16.911395001160

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.8282e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.080815e-01 1 1  ON 0
 uu_1                 1.424471e-01 1 1  ON 1
 uu_2                 4.434928e-02 1 1  ON 2
 uu_3                -1.908682e-02 1 1  ON 3
 uu_4                -6.924933e-02 1 1  ON 4
 uu_5                -1.051852e-01 1 1  ON 5
 uu_6                -1.321914e-01 1 1  ON 6
 uu_7                -1.450028e-01 1 1  ON 7
 uu_8                -1.360709e-01 1 1  ON 8
 uu_9                -1.083831e-01 1 1  ON 9
 ud_0                 4.399451e-01 1 1  ON 10
 ud_1                 1.817651e-01 1 1  ON 11
 ud_2                 6.668135e-02 1 1  ON 12
 ud_3                -3.009013e-03 1 1  ON 13
 ud_4                -5.909077e-02 1 1  ON 14
 ud_5                -1.020664e-01 1 1  ON 15
 ud_6                -1.319919e-01 1 1  ON 16
 ud_7                -1.528059e-01 1 1  ON 17
 ud_8                -1.566948e-01 1 1  ON 18
 ud_9                -1.476315e-01 1 1  ON 19
 eO_0                -7.589180e-01 1 1  ON 20
 eO_1                -4.419492e-01 1 1  ON 21
 eO_2                -2.529270e-02 1 1  ON 22
 eO_3                 3.018720e-01 1 1  ON 23
 eO_4                 5.324426e-01 1 1  ON 24
 eO_5                 4.964712e-01 1 1  ON 25
 eO_6                 2.682621e-01 1 1  ON 26
 eO_7                -3.935606e-02 1 1  ON 27
 eO_8                -2.341992e-01 1 1  ON 28
 eO_9                -9.694668e-02 1 1  ON 29
eH1_0                -2.598737e-01 1 1  ON 30
eH1_1                -1.547692e-01 1 1  ON 31
eH1_2                -1.088863e-01 1 1  ON 32
eH1_3                -5.659453e-02 1 1  ON 33
eH1_4                -5.245934e-03 1 1  ON 34
eH1_5                 3.112605e-02 1 1  ON 35
eH1_6                 9.693307e-02 1 1  ON 36
eH1_7                 1.601247e-01 1 1  ON 37
eH1_8                 1.970254e-01 1 1  ON 38
eH1_9                 9.523882e-02 1 1  ON 39
eH2_0                -2.535282e-01 1 1  ON 40
eH2_1                -1.483825e-01 1 1  ON 41
eH2_2                -1.022267e-01 1 1  ON 42
eH2_3                -5.010070e-02 1 1  ON 43
eH2_4                 1.220395e-03 1 1  ON 44
eH2_5                 3.606532e-02 1 1  ON 45
eH2_6                 9.997861e-02 1 1  ON 46
eH2_7                 1.601005e-01 1 1  ON 47
eH2_8                 1.966780e-01 1 1  ON 48
eH2_9                 7.558280e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6875e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8093
    reference variance = 0.337648
====================================================
  Execution time = 2.4783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337676863209
                                         uncertainty =       0.007332560637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337676863209
                                         uncertainty =       0.007332560637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410923544
  error estimate for blocks of size 2^( 2) =       0.000421991905
  error estimate for blocks of size 2^( 3) =       0.000433415699
  error estimate for blocks of size 2^( 4) =       0.000444514511
  error estimate for blocks of size 2^( 5) =       0.000454536719
  error estimate for blocks of size 2^( 6) =       0.000461700591
  error estimate for blocks of size 2^( 7) =       0.000464452850

      target function =                  N/A
              le_mean =     -16.910867787646
             les_mean =     286.315165480759
             stat err =       0.000456301168
             autocorr =       1.233051198732
              std dev =       0.581133649311
             le_variance =       0.337716318361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691086778765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910867787646       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910873536246       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910876021174       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910877324938       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910881198858       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910884573052       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910883241748       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910883052817       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910884471513       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910884370949       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910883356305       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910883103986       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910883929867       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910884169290       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.906013e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910867787646       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910871064673       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910871810570       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910873044669       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910875036866       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910875918820       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910875405437       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910875243486       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910875362702       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910875250086       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910875221077       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.362668e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910867787646       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910868992535       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910869149900       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910869639111       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910870260992       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910870476849       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910870425543       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910870375702       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910870354911       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.888055e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1135e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.080148e-01 1 1  ON 0
 uu_1                 1.425669e-01 1 1  ON 1
 uu_2                 4.452798e-02 1 1  ON 2
 uu_3                -1.896142e-02 1 1  ON 3
 uu_4                -6.888362e-02 1 1  ON 4
 uu_5                -1.049604e-01 1 1  ON 5
 uu_6                -1.318074e-01 1 1  ON 6
 uu_7                -1.453033e-01 1 1  ON 7
 uu_8                -1.365749e-01 1 1  ON 8
 uu_9                -1.089362e-01 1 1  ON 9
 ud_0                 4.404513e-01 1 1  ON 10
 ud_1                 1.821736e-01 1 1  ON 11
 ud_2                 6.707082e-02 1 1  ON 12
 ud_3                -2.709420e-03 1 1  ON 13
 ud_4                -5.899627e-02 1 1  ON 14
 ud_5                -1.019406e-01 1 1  ON 15
 ud_6                -1.321198e-01 1 1  ON 16
 ud_7                -1.527180e-01 1 1  ON 17
 ud_8                -1.570071e-01 1 1  ON 18
 ud_9                -1.483491e-01 1 1  ON 19
 eO_0                -7.584410e-01 1 1  ON 20
 eO_1                -4.414738e-01 1 1  ON 21
 eO_2                -2.540514e-02 1 1  ON 22
 eO_3                 3.016445e-01 1 1  ON 23
 eO_4                 5.326162e-01 1 1  ON 24
 eO_5                 4.966517e-01 1 1  ON 25
 eO_6                 2.684657e-01 1 1  ON 26
 eO_7                -3.923362e-02 1 1  ON 27
 eO_8                -2.347210e-01 1 1  ON 28
 eO_9                -9.760703e-02 1 1  ON 29
eH1_0                -2.602453e-01 1 1  ON 30
eH1_1                -1.547446e-01 1 1  ON 31
eH1_2                -1.088467e-01 1 1  ON 32
eH1_3                -5.680113e-02 1 1  ON 33
eH1_4                -5.191604e-03 1 1  ON 34
eH1_5                 3.084175e-02 1 1  ON 35
eH1_6                 9.676933e-02 1 1  ON 36
eH1_7                 1.601852e-01 1 1  ON 37
eH1_8                 1.972563e-01 1 1  ON 38
eH1_9                 9.582780e-02 1 1  ON 39
eH2_0                -2.538148e-01 1 1  ON 40
eH2_1                -1.483635e-01 1 1  ON 41
eH2_2                -1.022246e-01 1 1  ON 42
eH2_3                -5.031167e-02 1 1  ON 43
eH2_4                 1.042530e-03 1 1  ON 44
eH2_5                 3.610227e-02 1 1  ON 45
eH2_6                 9.949536e-02 1 1  ON 46
eH2_7                 1.599636e-01 1 1  ON 47
eH2_8                 1.971701e-01 1 1  ON 48
eH2_9                 7.631907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.004
    reference variance = 0.774327
====================================================
  Execution time = 2.3891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2838e-01
  Total weights = 2.0000e+06
  Execution time = 2.7871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328348619859
                                         uncertainty =       0.003180007619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328348619859
                                         uncertainty =       0.003180007619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405207616
  error estimate for blocks of size 2^( 2) =       0.000417024403
  error estimate for blocks of size 2^( 3) =       0.000429471899
  error estimate for blocks of size 2^( 4) =       0.000440795622
  error estimate for blocks of size 2^( 5) =       0.000450898031
  error estimate for blocks of size 2^( 6) =       0.000458123957
  error estimate for blocks of size 2^( 7) =       0.000462871363

      target function =                  N/A
              le_mean =     -16.911792811868
             les_mean =     286.337122371365
             stat err =       0.000453172243
             autocorr =       1.250752570648
              std dev =       0.573050106016
             le_variance =       0.328386424005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328317911037
                                         uncertainty =       0.003180298979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328317911037
                                         uncertainty =       0.003180298979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405188462
  error estimate for blocks of size 2^( 2) =       0.000416986233
  error estimate for blocks of size 2^( 3) =       0.000429412312
  error estimate for blocks of size 2^( 4) =       0.000440723349
  error estimate for blocks of size 2^( 5) =       0.000450843421
  error estimate for blocks of size 2^( 6) =       0.000458088238
  error estimate for blocks of size 2^( 7) =       0.000462864449

      target function =                  N/A
              le_mean =     -16.911796123197
             les_mean =     286.337203328511
             stat err =       0.000453129864
             autocorr =       1.250636879659
              std dev =       0.573023018827
             le_variance =       0.328355380106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328343566523
                                         uncertainty =       0.003179699127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328343566523
                                         uncertainty =       0.003179699127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405204212
  error estimate for blocks of size 2^( 2) =       0.000417006358
  error estimate for blocks of size 2^( 3) =       0.000429435716
  error estimate for blocks of size 2^( 4) =       0.000440750367
  error estimate for blocks of size 2^( 5) =       0.000450872571
  error estimate for blocks of size 2^( 6) =       0.000458111489
  error estimate for blocks of size 2^( 7) =       0.000462879567

      target function =                  N/A
              le_mean =     -16.911794391380
             les_mean =     286.337170279026
             stat err =       0.000453153498
             autocorr =       1.250670114112
              std dev =       0.573045292188
             le_variance =       0.328380906899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328349564724
                                         uncertainty =       0.003179902315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328349564724
                                         uncertainty =       0.003179902315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405208139
  error estimate for blocks of size 2^( 2) =       0.000417022334
  error estimate for blocks of size 2^( 3) =       0.000429466451
  error estimate for blocks of size 2^( 4) =       0.000440788367
  error estimate for blocks of size 2^( 5) =       0.000450894329
  error estimate for blocks of size 2^( 6) =       0.000458121559
  error estimate for blocks of size 2^( 7) =       0.000462871252

      target function =                  N/A
              le_mean =     -16.911792008307
             les_mean =     286.337096039717
             stat err =       0.000453168877
             autocorr =       1.250730758854
              std dev =       0.573050845642
             le_variance =       0.328387271691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911792811868        initial
     6.2500e-02     6.2500e-01             2.9060e-03       -16.911796123197  <--
     2.5000e-01     2.5000e+00             7.3627e-04       -16.911794391380
     1.0000e+00     1.0000e+01             1.8881e-04       -16.911792008307

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.7656e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.082079e-01 1 1  ON 0
 uu_1                 1.428372e-01 1 1  ON 1
 uu_2                 4.485594e-02 1 1  ON 2
 uu_3                -1.857445e-02 1 1  ON 3
 uu_4                -6.836838e-02 1 1  ON 4
 uu_5                -1.045483e-01 1 1  ON 5
 uu_6                -1.313776e-01 1 1  ON 6
 uu_7                -1.456250e-01 1 1  ON 7
 uu_8                -1.373873e-01 1 1  ON 8
 uu_9                -1.103587e-01 1 1  ON 9
 ud_0                 4.413018e-01 1 1  ON 10
 ud_1                 1.829499e-01 1 1  ON 11
 ud_2                 6.782838e-02 1 1  ON 12
 ud_3                -2.015078e-03 1 1  ON 13
 ud_4                -5.844942e-02 1 1  ON 14
 ud_5                -1.015552e-01 1 1  ON 15
 ud_6                -1.319335e-01 1 1  ON 16
 ud_7                -1.527141e-01 1 1  ON 17
 ud_8                -1.572782e-01 1 1  ON 18
 ud_9                -1.500377e-01 1 1  ON 19
 eO_0                -7.576098e-01 1 1  ON 20
 eO_1                -4.406618e-01 1 1  ON 21
 eO_2                -2.502021e-02 1 1  ON 22
 eO_3                 3.016178e-01 1 1  ON 23
 eO_4                 5.328886e-01 1 1  ON 24
 eO_5                 4.971098e-01 1 1  ON 25
 eO_6                 2.689399e-01 1 1  ON 26
 eO_7                -3.882012e-02 1 1  ON 27
 eO_8                -2.360922e-01 1 1  ON 28
 eO_9                -9.952490e-02 1 1  ON 29
eH1_0                -2.609333e-01 1 1  ON 30
eH1_1                -1.550587e-01 1 1  ON 31
eH1_2                -1.091091e-01 1 1  ON 32
eH1_3                -5.710827e-02 1 1  ON 33
eH1_4                -5.335587e-03 1 1  ON 34
eH1_5                 3.034921e-02 1 1  ON 35
eH1_6                 9.632614e-02 1 1  ON 36
eH1_7                 1.602989e-01 1 1  ON 37
eH1_8                 1.979446e-01 1 1  ON 38
eH1_9                 9.758960e-02 1 1  ON 39
eH2_0                -2.544381e-01 1 1  ON 40
eH2_1                -1.486903e-01 1 1  ON 41
eH2_2                -1.025570e-01 1 1  ON 42
eH2_3                -5.069789e-02 1 1  ON 43
eH2_4                 6.393117e-04 1 1  ON 44
eH2_5                 3.589200e-02 1 1  ON 45
eH2_6                 9.852039e-02 1 1  ON 46
eH2_7                 1.596334e-01 1 1  ON 47
eH2_8                 1.985512e-01 1 1  ON 48
eH2_9                 7.848882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9851
    reference variance = 0.664586
====================================================
  Execution time = 2.4440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333234460901
                                         uncertainty =       0.004309675093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333234460901
                                         uncertainty =       0.004309675093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408184177
  error estimate for blocks of size 2^( 2) =       0.000420040284
  error estimate for blocks of size 2^( 3) =       0.000432032357
  error estimate for blocks of size 2^( 4) =       0.000443203856
  error estimate for blocks of size 2^( 5) =       0.000453903874
  error estimate for blocks of size 2^( 6) =       0.000460800640
  error estimate for blocks of size 2^( 7) =       0.000464460836

      target function =                  N/A
              le_mean =     -16.911222947356
             les_mean =     286.322690053954
             stat err =       0.000455592301
             autocorr =       1.245777323565
              std dev =       0.577259599655
             le_variance =       0.333228645394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691122294736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911222947356       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911221899260       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911227782647       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911225701244       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911226398354       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911227377719       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911229900135       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911228355917       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911226009131       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911230246005       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911231990523       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911235183612       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911235312362       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911235653977       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911236287843       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911235865695       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911235899895       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.228642e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911222947356       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911222125166       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911226171221       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911224842688       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911225991769       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911226443358       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911227761734       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911226374192       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911225290586       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911226846613       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911227345038       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911227701401       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911227670094       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.111279e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911222947356       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911222505829       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911224402533       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911224646103       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911224037190       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911224894252       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911224903002       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911224159641       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911224490980       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911224649403       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.734110e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4487e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081966e-01 1 1  ON 0
 uu_1                 1.425830e-01 1 1  ON 1
 uu_2                 4.472046e-02 1 1  ON 2
 uu_3                -1.863279e-02 1 1  ON 3
 uu_4                -6.851512e-02 1 1  ON 4
 uu_5                -1.047581e-01 1 1  ON 5
 uu_6                -1.319991e-01 1 1  ON 6
 uu_7                -1.451691e-01 1 1  ON 7
 uu_8                -1.368681e-01 1 1  ON 8
 uu_9                -1.112068e-01 1 1  ON 9
 ud_0                 4.409985e-01 1 1  ON 10
 ud_1                 1.828527e-01 1 1  ON 11
 ud_2                 6.791989e-02 1 1  ON 12
 ud_3                -1.811444e-03 1 1  ON 13
 ud_4                -5.825773e-02 1 1  ON 14
 ud_5                -1.014393e-01 1 1  ON 15
 ud_6                -1.320581e-01 1 1  ON 16
 ud_7                -1.522826e-01 1 1  ON 17
 ud_8                -1.574362e-01 1 1  ON 18
 ud_9                -1.495197e-01 1 1  ON 19
 eO_0                -7.564862e-01 1 1  ON 20
 eO_1                -4.399832e-01 1 1  ON 21
 eO_2                -2.509782e-02 1 1  ON 22
 eO_3                 3.009034e-01 1 1  ON 23
 eO_4                 5.328038e-01 1 1  ON 24
 eO_5                 4.982393e-01 1 1  ON 25
 eO_6                 2.700174e-01 1 1  ON 26
 eO_7                -3.862907e-02 1 1  ON 27
 eO_8                -2.369563e-01 1 1  ON 28
 eO_9                -1.016252e-01 1 1  ON 29
eH1_0                -2.620554e-01 1 1  ON 30
eH1_1                -1.562585e-01 1 1  ON 31
eH1_2                -1.101398e-01 1 1  ON 32
eH1_3                -5.788364e-02 1 1  ON 33
eH1_4                -6.671661e-03 1 1  ON 34
eH1_5                 2.959228e-02 1 1  ON 35
eH1_6                 9.606624e-02 1 1  ON 36
eH1_7                 1.612237e-01 1 1  ON 37
eH1_8                 2.003135e-01 1 1  ON 38
eH1_9                 1.007009e-01 1 1  ON 39
eH2_0                -2.550783e-01 1 1  ON 40
eH2_1                -1.498332e-01 1 1  ON 41
eH2_2                -1.035022e-01 1 1  ON 42
eH2_3                -5.127578e-02 1 1  ON 43
eH2_4                -1.263831e-04 1 1  ON 44
eH2_5                 3.527866e-02 1 1  ON 45
eH2_6                 9.927262e-02 1 1  ON 46
eH2_7                 1.597089e-01 1 1  ON 47
eH2_8                 1.993870e-01 1 1  ON 48
eH2_9                 8.097257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9545
    reference variance = 0.433267
====================================================
  Execution time = 2.4255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2739e-01
  Total weights = 2.0000e+06
  Execution time = 2.7753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327589680710
                                         uncertainty =       0.003667800529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327589680710
                                         uncertainty =       0.003667800529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404758611
  error estimate for blocks of size 2^( 2) =       0.000416784036
  error estimate for blocks of size 2^( 3) =       0.000429151364
  error estimate for blocks of size 2^( 4) =       0.000440929447
  error estimate for blocks of size 2^( 5) =       0.000451320008
  error estimate for blocks of size 2^( 6) =       0.000457736985
  error estimate for blocks of size 2^( 7) =       0.000461758723

      target function =                  N/A
              le_mean =     -16.911263176846
             les_mean =     286.318481139152
             stat err =       0.000452936291
             autocorr =       1.252224060502
              std dev =       0.572415117216
             le_variance =       0.327659066418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327286440470
                                         uncertainty =       0.003663143564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327286440470
                                         uncertainty =       0.003663143564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404571149
  error estimate for blocks of size 2^( 2) =       0.000416606895
  error estimate for blocks of size 2^( 3) =       0.000428982945
  error estimate for blocks of size 2^( 4) =       0.000440754046
  error estimate for blocks of size 2^( 5) =       0.000451135871
  error estimate for blocks of size 2^( 6) =       0.000457532347
  error estimate for blocks of size 2^( 7) =       0.000461522613

      target function =                  N/A
              le_mean =     -16.911260191999
             les_mean =     286.318076747603
             stat err =       0.000452736219
             autocorr =       1.252277740411
              std dev =       0.572150006370
             le_variance =       0.327355629789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327067100875
                                         uncertainty =       0.003661450804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327067100875
                                         uncertainty =       0.003661450804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404435514
  error estimate for blocks of size 2^( 2) =       0.000416475110
  error estimate for blocks of size 2^( 3) =       0.000428857639
  error estimate for blocks of size 2^( 4) =       0.000440636478
  error estimate for blocks of size 2^( 5) =       0.000451032617
  error estimate for blocks of size 2^( 6) =       0.000457428976
  error estimate for blocks of size 2^( 7) =       0.000461407636

      target function =                  N/A
              le_mean =     -16.911258156347
             les_mean =     286.317788436285
             stat err =       0.000452626427
             autocorr =       1.252510126556
              std dev =       0.571958188378
             le_variance =       0.327136169252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327446374706
                                         uncertainty =       0.003666064383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327446374706
                                         uncertainty =       0.003666064383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404670038
  error estimate for blocks of size 2^( 2) =       0.000416698508
  error estimate for blocks of size 2^( 3) =       0.000429068691
  error estimate for blocks of size 2^( 4) =       0.000440846371
  error estimate for blocks of size 2^( 5) =       0.000451238928
  error estimate for blocks of size 2^( 6) =       0.000457651822
  error estimate for blocks of size 2^( 7) =       0.000461663239

      target function =                  N/A
              le_mean =     -16.911260585538
             les_mean =     286.318250106990
             stat err =       0.000452850090
             autocorr =       1.252295490956
              std dev =       0.572289855574
             le_variance =       0.327515678793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911263176846        initial  <--
     1.5625e-02     1.5625e-01             1.2286e-02       -16.911260191999
     6.2500e-02     6.2500e-01             3.1113e-03       -16.911258156347
     2.5000e-01     2.5000e+00             7.7341e-04       -16.911260585538

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.0069
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.082079e-01 1 1  ON 0
 uu_1                 1.428372e-01 1 1  ON 1
 uu_2                 4.485594e-02 1 1  ON 2
 uu_3                -1.857445e-02 1 1  ON 3
 uu_4                -6.836838e-02 1 1  ON 4
 uu_5                -1.045483e-01 1 1  ON 5
 uu_6                -1.313776e-01 1 1  ON 6
 uu_7                -1.456250e-01 1 1  ON 7
 uu_8                -1.373873e-01 1 1  ON 8
 uu_9                -1.103587e-01 1 1  ON 9
 ud_0                 4.413018e-01 1 1  ON 10
 ud_1                 1.829499e-01 1 1  ON 11
 ud_2                 6.782838e-02 1 1  ON 12
 ud_3                -2.015078e-03 1 1  ON 13
 ud_4                -5.844942e-02 1 1  ON 14
 ud_5                -1.015552e-01 1 1  ON 15
 ud_6                -1.319335e-01 1 1  ON 16
 ud_7                -1.527141e-01 1 1  ON 17
 ud_8                -1.572782e-01 1 1  ON 18
 ud_9                -1.500377e-01 1 1  ON 19
 eO_0                -7.576098e-01 1 1  ON 20
 eO_1                -4.406618e-01 1 1  ON 21
 eO_2                -2.502021e-02 1 1  ON 22
 eO_3                 3.016178e-01 1 1  ON 23
 eO_4                 5.328886e-01 1 1  ON 24
 eO_5                 4.971098e-01 1 1  ON 25
 eO_6                 2.689399e-01 1 1  ON 26
 eO_7                -3.882012e-02 1 1  ON 27
 eO_8                -2.360922e-01 1 1  ON 28
 eO_9                -9.952490e-02 1 1  ON 29
eH1_0                -2.609333e-01 1 1  ON 30
eH1_1                -1.550587e-01 1 1  ON 31
eH1_2                -1.091091e-01 1 1  ON 32
eH1_3                -5.710827e-02 1 1  ON 33
eH1_4                -5.335587e-03 1 1  ON 34
eH1_5                 3.034921e-02 1 1  ON 35
eH1_6                 9.632614e-02 1 1  ON 36
eH1_7                 1.602989e-01 1 1  ON 37
eH1_8                 1.979446e-01 1 1  ON 38
eH1_9                 9.758960e-02 1 1  ON 39
eH2_0                -2.544381e-01 1 1  ON 40
eH2_1                -1.486903e-01 1 1  ON 41
eH2_2                -1.025570e-01 1 1  ON 42
eH2_3                -5.069789e-02 1 1  ON 43
eH2_4                 6.393117e-04 1 1  ON 44
eH2_5                 3.589200e-02 1 1  ON 45
eH2_6                 9.852039e-02 1 1  ON 46
eH2_7                 1.596334e-01 1 1  ON 47
eH2_8                 1.985512e-01 1 1  ON 48
eH2_9                 7.848882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9801
    reference variance = 0.254876
====================================================
  Execution time = 2.4435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3063e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330587694657
                                         uncertainty =       0.003731252295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330587694657
                                         uncertainty =       0.003731252295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406587912
  error estimate for blocks of size 2^( 2) =       0.000418284738
  error estimate for blocks of size 2^( 3) =       0.000430272682
  error estimate for blocks of size 2^( 4) =       0.000442117560
  error estimate for blocks of size 2^( 5) =       0.000452425561
  error estimate for blocks of size 2^( 6) =       0.000460772234
  error estimate for blocks of size 2^( 7) =       0.000465383727

      target function =                  N/A
              le_mean =     -16.911324165035
             les_mean =     286.323512309691
             stat err =       0.000455174771
             autocorr =       1.253278065107
              std dev =       0.575002139209
             le_variance =       0.330627460095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132416504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911324165035       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911327006391       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911328527561       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911326598790       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911327056773       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911328876525       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911328213824       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911328436767       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911328491653       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911328497437       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911328474740       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.301367e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911324165035       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911325358826       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911326395027       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911325758225       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911325537324       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911325764005       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911325830225       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911325672872       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911325776522       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.212267e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911324165035       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911324524675       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911324917049       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911324746429       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911324644322       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911324651145       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911324679420       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911324644338       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.830748e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0857e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.083214e-01 1 1  ON 0
 uu_1                 1.429982e-01 1 1  ON 1
 uu_2                 4.485224e-02 1 1  ON 2
 uu_3                -1.850603e-02 1 1  ON 3
 uu_4                -6.828154e-02 1 1  ON 4
 uu_5                -1.045581e-01 1 1  ON 5
 uu_6                -1.316412e-01 1 1  ON 6
 uu_7                -1.456137e-01 1 1  ON 7
 uu_8                -1.374728e-01 1 1  ON 8
 uu_9                -1.104788e-01 1 1  ON 9
 ud_0                 4.411239e-01 1 1  ON 10
 ud_1                 1.829816e-01 1 1  ON 11
 ud_2                 6.791018e-02 1 1  ON 12
 ud_3                -1.924568e-03 1 1  ON 13
 ud_4                -5.846810e-02 1 1  ON 14
 ud_5                -1.015223e-01 1 1  ON 15
 ud_6                -1.318343e-01 1 1  ON 16
 ud_7                -1.527189e-01 1 1  ON 17
 ud_8                -1.573389e-01 1 1  ON 18
 ud_9                -1.500770e-01 1 1  ON 19
 eO_0                -7.574425e-01 1 1  ON 20
 eO_1                -4.405291e-01 1 1  ON 21
 eO_2                -2.504218e-02 1 1  ON 22
 eO_3                 3.015768e-01 1 1  ON 23
 eO_4                 5.329402e-01 1 1  ON 24
 eO_5                 4.971383e-01 1 1  ON 25
 eO_6                 2.690092e-01 1 1  ON 26
 eO_7                -3.876457e-02 1 1  ON 27
 eO_8                -2.362690e-01 1 1  ON 28
 eO_9                -9.975503e-02 1 1  ON 29
eH1_0                -2.609939e-01 1 1  ON 30
eH1_1                -1.552627e-01 1 1  ON 31
eH1_2                -1.092503e-01 1 1  ON 32
eH1_3                -5.694872e-02 1 1  ON 33
eH1_4                -5.414713e-03 1 1  ON 34
eH1_5                 3.048419e-02 1 1  ON 35
eH1_6                 9.617423e-02 1 1  ON 36
eH1_7                 1.601540e-01 1 1  ON 37
eH1_8                 1.980675e-01 1 1  ON 38
eH1_9                 9.787328e-02 1 1  ON 39
eH2_0                -2.547087e-01 1 1  ON 40
eH2_1                -1.489218e-01 1 1  ON 41
eH2_2                -1.027842e-01 1 1  ON 42
eH2_3                -5.062042e-02 1 1  ON 43
eH2_4                 5.080016e-04 1 1  ON 44
eH2_5                 3.575057e-02 1 1  ON 45
eH2_6                 9.864393e-02 1 1  ON 46
eH2_7                 1.598661e-01 1 1  ON 47
eH2_8                 1.987853e-01 1 1  ON 48
eH2_9                 7.881004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9546
    reference variance = 0.449813
====================================================
  Execution time = 2.3868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3244e-01
  Total weights = 2.0000e+06
  Execution time = 2.7747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332662450822
                                         uncertainty =       0.005319346263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332662450822
                                         uncertainty =       0.005319346263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407784827
  error estimate for blocks of size 2^( 2) =       0.000419392157
  error estimate for blocks of size 2^( 3) =       0.000432006129
  error estimate for blocks of size 2^( 4) =       0.000443449621
  error estimate for blocks of size 2^( 5) =       0.000454560210
  error estimate for blocks of size 2^( 6) =       0.000461222457
  error estimate for blocks of size 2^( 7) =       0.000466942283

      target function =                  N/A
              le_mean =     -16.910978330797
             les_mean =     286.313764868973
             stat err =       0.000456543643
             autocorr =       1.253436896884
              std dev =       0.576694833132
             le_variance =       0.332576930561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332392222701
                                         uncertainty =       0.005314922873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332392222701
                                         uncertainty =       0.005314922873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407619151
  error estimate for blocks of size 2^( 2) =       0.000419229990
  error estimate for blocks of size 2^( 3) =       0.000431845801
  error estimate for blocks of size 2^( 4) =       0.000443290369
  error estimate for blocks of size 2^( 5) =       0.000454403671
  error estimate for blocks of size 2^( 6) =       0.000461073710
  error estimate for blocks of size 2^( 7) =       0.000466799863

      target function =                  N/A
              le_mean =     -16.910981327161
             les_mean =     286.313596026050
             stat err =       0.000456391903
             autocorr =       1.253622279401
              std dev =       0.576460531705
             le_variance =       0.332306744614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332391498418
                                         uncertainty =       0.005315259192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332391498418
                                         uncertainty =       0.005315259192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407618693
  error estimate for blocks of size 2^( 2) =       0.000419230390
  error estimate for blocks of size 2^( 3) =       0.000431846992
  error estimate for blocks of size 2^( 4) =       0.000443292235
  error estimate for blocks of size 2^( 5) =       0.000454406681
  error estimate for blocks of size 2^( 6) =       0.000461075752
  error estimate for blocks of size 2^( 7) =       0.000466798813

      target function =                  N/A
              le_mean =     -16.910980374896
             les_mean =     286.313563072392
             stat err =       0.000456393370
             autocorr =       1.253633153369
              std dev =       0.576459884486
             le_variance =       0.332305998422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332607154781
                                         uncertainty =       0.005318676982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332607154781
                                         uncertainty =       0.005318676982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407750928
  error estimate for blocks of size 2^( 2) =       0.000419359254
  error estimate for blocks of size 2^( 3) =       0.000431973932
  error estimate for blocks of size 2^( 4) =       0.000443417938
  error estimate for blocks of size 2^( 5) =       0.000454529369
  error estimate for blocks of size 2^( 6) =       0.000461192860
  error estimate for blocks of size 2^( 7) =       0.000466913113

      target function =                  N/A
              le_mean =     -16.910978508343
             les_mean =     286.313715581948
             stat err =       0.000456513320
             autocorr =       1.253478795699
              std dev =       0.576646892443
             le_variance =       0.332521638564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910978330797        initial
     1.5625e-01     1.5625e+00             1.3014e-03       -16.910981327161  <--
     6.2500e-01     6.2500e+00             3.2123e-04       -16.910980374896
     2.5000e+00     2.5000e+01             7.8307e-05       -16.910978508343

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.7602e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.085819e-01 1 1  ON 0
 uu_1                 1.432466e-01 1 1  ON 1
 uu_2                 4.500431e-02 1 1  ON 2
 uu_3                -1.834646e-02 1 1  ON 3
 uu_4                -6.811026e-02 1 1  ON 4
 uu_5                -1.045653e-01 1 1  ON 5
 uu_6                -1.319974e-01 1 1  ON 6
 uu_7                -1.457310e-01 1 1  ON 7
 uu_8                -1.377558e-01 1 1  ON 8
 uu_9                -1.108265e-01 1 1  ON 9
 ud_0                 4.410066e-01 1 1  ON 10
 ud_1                 1.830188e-01 1 1  ON 11
 ud_2                 6.801899e-02 1 1  ON 12
 ud_3                -1.786192e-03 1 1  ON 13
 ud_4                -5.842261e-02 1 1  ON 14
 ud_5                -1.014687e-01 1 1  ON 15
 ud_6                -1.317319e-01 1 1  ON 16
 ud_7                -1.527215e-01 1 1  ON 17
 ud_8                -1.574791e-01 1 1  ON 18
 ud_9                -1.501927e-01 1 1  ON 19
 eO_0                -7.570233e-01 1 1  ON 20
 eO_1                -4.402468e-01 1 1  ON 21
 eO_2                -2.495008e-02 1 1  ON 22
 eO_3                 3.015526e-01 1 1  ON 23
 eO_4                 5.330464e-01 1 1  ON 24
 eO_5                 4.972419e-01 1 1  ON 25
 eO_6                 2.692107e-01 1 1  ON 26
 eO_7                -3.861486e-02 1 1  ON 27
 eO_8                -2.367965e-01 1 1  ON 28
 eO_9                -1.004509e-01 1 1  ON 29
eH1_0                -2.612689e-01 1 1  ON 30
eH1_1                -1.556345e-01 1 1  ON 31
eH1_2                -1.094901e-01 1 1  ON 32
eH1_3                -5.683722e-02 1 1  ON 33
eH1_4                -5.532436e-03 1 1  ON 34
eH1_5                 3.070010e-02 1 1  ON 35
eH1_6                 9.579957e-02 1 1  ON 36
eH1_7                 1.597586e-01 1 1  ON 37
eH1_8                 1.984193e-01 1 1  ON 38
eH1_9                 9.872362e-02 1 1  ON 39
eH2_0                -2.554539e-01 1 1  ON 40
eH2_1                -1.495002e-01 1 1  ON 41
eH2_2                -1.032954e-01 1 1  ON 42
eH2_3                -5.077944e-02 1 1  ON 43
eH2_4                 1.945165e-04 1 1  ON 44
eH2_5                 3.538974e-02 1 1  ON 45
eH2_6                 9.892401e-02 1 1  ON 46
eH2_7                 1.605249e-01 1 1  ON 47
eH2_8                 1.994931e-01 1 1  ON 48
eH2_9                 7.979018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.25739
====================================================
  Execution time = 2.4417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326884861506
                                         uncertainty =       0.003625076609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326884861506
                                         uncertainty =       0.003625076609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404649775
  error estimate for blocks of size 2^( 2) =       0.000416321260
  error estimate for blocks of size 2^( 3) =       0.000427969841
  error estimate for blocks of size 2^( 4) =       0.000439384731
  error estimate for blocks of size 2^( 5) =       0.000448029689
  error estimate for blocks of size 2^( 6) =       0.000454590595
  error estimate for blocks of size 2^( 7) =       0.000460638489

      target function =                  N/A
              le_mean =     -16.911067610825
             les_mean =     286.311690454221
             stat err =       0.000450660876
             autocorr =       1.240341022663
              std dev =       0.572261199153
             le_variance =       0.327482880056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691106761083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067610825       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911071114867       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911072711075       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911069744579       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911074462706       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911077729470       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911078476606       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911076456663       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911078041140       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911076885050       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911076242097       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911077363545       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911077833707       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911077597275       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.255304e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067610825       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911070037180       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911071351290       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911069697430       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911072119211       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911073393344       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911072924504       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911072326270       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911072764644       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911072168872       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.542845e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067610825       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911068698768       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911069532684       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911069336815       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911069075544       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911069590635       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911069949932       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911069656168       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911069740098       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.885236e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0857e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9654
    reference variance = 0.204238
====================================================
  Execution time = 2.3944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2488e-01
  Total weights = 2.0000e+06
  Execution time = 2.7680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324771882402
                                         uncertainty =       0.003780695279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324771882402
                                         uncertainty =       0.003780695279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402933308
  error estimate for blocks of size 2^( 2) =       0.000414717946
  error estimate for blocks of size 2^( 3) =       0.000426867507
  error estimate for blocks of size 2^( 4) =       0.000438620749
  error estimate for blocks of size 2^( 5) =       0.000449813120
  error estimate for blocks of size 2^( 6) =       0.000458534655
  error estimate for blocks of size 2^( 7) =       0.000466181790

      target function =                  N/A
              le_mean =     -16.910051888341
             les_mean =     286.274565204781
             stat err =       0.000453287579
             autocorr =       1.265555800660
              std dev =       0.569833748355
             le_variance =       0.324710500765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325081788896
                                         uncertainty =       0.003782224686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325081788896
                                         uncertainty =       0.003782224686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403125437
  error estimate for blocks of size 2^( 2) =       0.000414901913
  error estimate for blocks of size 2^( 3) =       0.000427040499
  error estimate for blocks of size 2^( 4) =       0.000438782343
  error estimate for blocks of size 2^( 5) =       0.000449965476
  error estimate for blocks of size 2^( 6) =       0.000458681097
  error estimate for blocks of size 2^( 7) =       0.000466341997

      target function =                  N/A
              le_mean =     -16.910054446454
             les_mean =     286.274961455523
             stat err =       0.000453442728
             autocorr =       1.265215424649
              std dev =       0.570105460403
             le_variance =       0.325020235981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325122122936
                                         uncertainty =       0.003782085967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325122122936
                                         uncertainty =       0.003782085967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403150373
  error estimate for blocks of size 2^( 2) =       0.000414924863
  error estimate for blocks of size 2^( 3) =       0.000427065118
  error estimate for blocks of size 2^( 4) =       0.000438811741
  error estimate for blocks of size 2^( 5) =       0.000449990719
  error estimate for blocks of size 2^( 6) =       0.000458705498
  error estimate for blocks of size 2^( 7) =       0.000466365395

      target function =                  N/A
              le_mean =     -16.910055847425
             les_mean =     286.275049047577
             stat err =       0.000453468338
             autocorr =       1.265201815381
              std dev =       0.570140725673
             le_variance =       0.325060447072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324878573564
                                         uncertainty =       0.003781249922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324878573564
                                         uncertainty =       0.003781249922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402999442
  error estimate for blocks of size 2^( 2) =       0.000414780483
  error estimate for blocks of size 2^( 3) =       0.000426927187
  error estimate for blocks of size 2^( 4) =       0.000438678814
  error estimate for blocks of size 2^( 5) =       0.000449867018
  error estimate for blocks of size 2^( 6) =       0.000458586644
  error estimate for blocks of size 2^( 7) =       0.000466235579

      target function =                  N/A
              le_mean =     -16.910052457063
             les_mean =     286.274691038656
             stat err =       0.000453342014
             autocorr =       1.265444345509
              std dev =       0.569927276452
             le_variance =       0.324817100444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910051888341        initial
     3.9062e-02     3.9062e-01             6.2553e-03       -16.910054446454
     1.5625e-01     1.5625e+00             1.5428e-03       -16.910055847425  <--
     6.2500e-01     6.2500e+00             3.8852e-04       -16.910052457063

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.7628e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6937e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.258557
====================================================
  Execution time = 2.4455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324525723995
                                         uncertainty =       0.002574397243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324525723995
                                         uncertainty =       0.002574397243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402928307
  error estimate for blocks of size 2^( 2) =       0.000414865581
  error estimate for blocks of size 2^( 3) =       0.000427311298
  error estimate for blocks of size 2^( 4) =       0.000439328050
  error estimate for blocks of size 2^( 5) =       0.000450361186
  error estimate for blocks of size 2^( 6) =       0.000459020883
  error estimate for blocks of size 2^( 7) =       0.000466434582

      target function =                  N/A
              le_mean =     -16.910931887822
             les_mean =     286.304319593537
             stat err =       0.000453786175
             autocorr =       1.268372925157
              std dev =       0.569826676581
             le_variance =       0.324702441343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691093188782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931887822       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910936139841       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910934807959       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933366350       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910936134366       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910934964576       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910936567318       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910936077473       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910938794616       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910938859710       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910938882927       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910938661431       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910938752394       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910938637805       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.103458e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931887822       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910935065150       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910934171245       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933029820       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910934138307       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910933763271       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910933773180       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910934677374       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910934504213       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910934719530       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.276221e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931887822       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910933467800       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910933084332       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910932460478       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910932382017       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910932881676       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910932605588       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910932745262       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910932819606       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.251157e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0903e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.090186e-01 1 1  ON 0
 uu_1                 1.433202e-01 1 1  ON 1
 uu_2                 4.538209e-02 1 1  ON 2
 uu_3                -1.805927e-02 1 1  ON 3
 uu_4                -6.815581e-02 1 1  ON 4
 uu_5                -1.042600e-01 1 1  ON 5
 uu_6                -1.321634e-01 1 1  ON 6
 uu_7                -1.461812e-01 1 1  ON 7
 uu_8                -1.384987e-01 1 1  ON 8
 uu_9                -1.117170e-01 1 1  ON 9
 ud_0                 4.411833e-01 1 1  ON 10
 ud_1                 1.830955e-01 1 1  ON 11
 ud_2                 6.810907e-02 1 1  ON 12
 ud_3                -1.680708e-03 1 1  ON 13
 ud_4                -5.817052e-02 1 1  ON 14
 ud_5                -1.016633e-01 1 1  ON 15
 ud_6                -1.320277e-01 1 1  ON 16
 ud_7                -1.525088e-01 1 1  ON 17
 ud_8                -1.570460e-01 1 1  ON 18
 ud_9                -1.500923e-01 1 1  ON 19
 eO_0                -7.564405e-01 1 1  ON 20
 eO_1                -4.400306e-01 1 1  ON 21
 eO_2                -2.458082e-02 1 1  ON 22
 eO_3                 3.016600e-01 1 1  ON 23
 eO_4                 5.330330e-01 1 1  ON 24
 eO_5                 4.978392e-01 1 1  ON 25
 eO_6                 2.702874e-01 1 1  ON 26
 eO_7                -3.834431e-02 1 1  ON 27
 eO_8                -2.379825e-01 1 1  ON 28
 eO_9                -1.020903e-01 1 1  ON 29
eH1_0                -2.617719e-01 1 1  ON 30
eH1_1                -1.562803e-01 1 1  ON 31
eH1_2                -1.100936e-01 1 1  ON 32
eH1_3                -5.745325e-02 1 1  ON 33
eH1_4                -5.709288e-03 1 1  ON 34
eH1_5                 3.018410e-02 1 1  ON 35
eH1_6                 9.539744e-02 1 1  ON 36
eH1_7                 1.599016e-01 1 1  ON 37
eH1_8                 1.994201e-01 1 1  ON 38
eH1_9                 1.007969e-01 1 1  ON 39
eH2_0                -2.566559e-01 1 1  ON 40
eH2_1                -1.502918e-01 1 1  ON 41
eH2_2                -1.040954e-01 1 1  ON 42
eH2_3                -5.165240e-02 1 1  ON 43
eH2_4                -4.971469e-04 1 1  ON 44
eH2_5                 3.480691e-02 1 1  ON 45
eH2_6                 9.967173e-02 1 1  ON 46
eH2_7                 1.614040e-01 1 1  ON 47
eH2_8                 2.003495e-01 1 1  ON 48
eH2_9                 8.211896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9012
    reference variance = 0.589568
====================================================
  Execution time = 2.3816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3185e-01
  Total weights = 2.0000e+06
  Execution time = 2.7126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332011022991
                                         uncertainty =       0.004174267201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332011022991
                                         uncertainty =       0.004174267201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407432303
  error estimate for blocks of size 2^( 2) =       0.000419068444
  error estimate for blocks of size 2^( 3) =       0.000430726725
  error estimate for blocks of size 2^( 4) =       0.000442473291
  error estimate for blocks of size 2^( 5) =       0.000451873025
  error estimate for blocks of size 2^( 6) =       0.000459509214
  error estimate for blocks of size 2^( 7) =       0.000464468380

      target function =                  N/A
              le_mean =     -16.910882137751
             les_mean =     286.309936673811
             stat err =       0.000454580978
             autocorr =       1.244834451955
              std dev =       0.576196288507
             le_variance =       0.332002162889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331825016235
                                         uncertainty =       0.004174050514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331825016235
                                         uncertainty =       0.004174050514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318239
  error estimate for blocks of size 2^( 2) =       0.000418957404
  error estimate for blocks of size 2^( 3) =       0.000430621615
  error estimate for blocks of size 2^( 4) =       0.000442372802
  error estimate for blocks of size 2^( 5) =       0.000451784720
  error estimate for blocks of size 2^( 6) =       0.000459421635
  error estimate for blocks of size 2^( 7) =       0.000464372163

      target function =                  N/A
              le_mean =     -16.910882012873
             les_mean =     286.309746583449
             stat err =       0.000454487830
             autocorr =       1.245021358592
              std dev =       0.576034978135
             le_variance =       0.331816296035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331723803949
                                         uncertainty =       0.004175454149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331723803949
                                         uncertainty =       0.004175454149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407256106
  error estimate for blocks of size 2^( 2) =       0.000418897219
  error estimate for blocks of size 2^( 3) =       0.000430564512
  error estimate for blocks of size 2^( 4) =       0.000442320332
  error estimate for blocks of size 2^( 5) =       0.000451739384
  error estimate for blocks of size 2^( 6) =       0.000459382072
  error estimate for blocks of size 2^( 7) =       0.000464332833

      target function =                  N/A
              le_mean =     -16.910881495377
             les_mean =     286.309627856840
             stat err =       0.000454443655
             autocorr =       1.245159194899
              std dev =       0.575947108696
             le_variance =       0.331715072015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331922914959
                                         uncertainty =       0.004174691118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331922914959
                                         uncertainty =       0.004174691118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407378267
  error estimate for blocks of size 2^( 2) =       0.000419015771
  error estimate for blocks of size 2^( 3) =       0.000430676241
  error estimate for blocks of size 2^( 4) =       0.000442425174
  error estimate for blocks of size 2^( 5) =       0.000451829779
  error estimate for blocks of size 2^( 6) =       0.000459467525
  error estimate for blocks of size 2^( 7) =       0.000464423841

      target function =                  N/A
              le_mean =     -16.910881244679
             les_mean =     286.309818409776
             stat err =       0.000454536580
             autocorr =       1.244921501985
              std dev =       0.576119869551
             le_variance =       0.331914104092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910882137751        initial  <--
     3.9062e-02     3.9062e-01             5.1035e-03       -16.910882012873
     1.5625e-01     1.5625e+00             1.2762e-03       -16.910881495377
     6.2500e-01     6.2500e+00             3.2512e-04       -16.910881244679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4579
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9199
    reference variance = 0.579684
====================================================
  Execution time = 2.4211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357222339393
                                         uncertainty =       0.028117096357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357222339393
                                         uncertainty =       0.028117096357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422529050
  error estimate for blocks of size 2^( 2) =       0.000434083840
  error estimate for blocks of size 2^( 3) =       0.000446605732
  error estimate for blocks of size 2^( 4) =       0.000458377460
  error estimate for blocks of size 2^( 5) =       0.000470767377
  error estimate for blocks of size 2^( 6) =       0.000478825416
  error estimate for blocks of size 2^( 7) =       0.000485523589

      target function =                  N/A
              le_mean =     -16.911318779650
             les_mean =     286.349764284113
             stat err =       0.000473373460
             autocorr =       1.255147210705
              std dev =       0.597546312603
             le_variance =       0.357061595706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691131877965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911318779650       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911318816173       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911318163341       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911318424122       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911318805917       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911318651479       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911318437299       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911318521952       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911318753911       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.750496e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911318779650       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911318791929       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911318527765       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911318531867       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911318606827       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911318569631       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911318558005       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911318569829       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.456701e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911318779650       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911318783009       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911318706292       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911318698347       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911318711811       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911318701197       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911318703479       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.458645e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0682e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088473e-01 1 1  ON 0
 uu_1                 1.431177e-01 1 1  ON 1
 uu_2                 4.518339e-02 1 1  ON 2
 uu_3                -1.825213e-02 1 1  ON 3
 uu_4                -6.797497e-02 1 1  ON 4
 uu_5                -1.045362e-01 1 1  ON 5
 uu_6                -1.322693e-01 1 1  ON 6
 uu_7                -1.457950e-01 1 1  ON 7
 uu_8                -1.380456e-01 1 1  ON 8
 uu_9                -1.113980e-01 1 1  ON 9
 ud_0                 4.413269e-01 1 1  ON 10
 ud_1                 1.831327e-01 1 1  ON 11
 ud_2                 6.815755e-02 1 1  ON 12
 ud_3                -1.722768e-03 1 1  ON 13
 ud_4                -5.821318e-02 1 1  ON 14
 ud_5                -1.016931e-01 1 1  ON 15
 ud_6                -1.320909e-01 1 1  ON 16
 ud_7                -1.526208e-01 1 1  ON 17
 ud_8                -1.575821e-01 1 1  ON 18
 ud_9                -1.500016e-01 1 1  ON 19
 eO_0                -7.566526e-01 1 1  ON 20
 eO_1                -4.401796e-01 1 1  ON 21
 eO_2                -2.477136e-02 1 1  ON 22
 eO_3                 3.014071e-01 1 1  ON 23
 eO_4                 5.332868e-01 1 1  ON 24
 eO_5                 4.977740e-01 1 1  ON 25
 eO_6                 2.697605e-01 1 1  ON 26
 eO_7                -3.857873e-02 1 1  ON 27
 eO_8                -2.375721e-01 1 1  ON 28
 eO_9                -1.013429e-01 1 1  ON 29
eH1_0                -2.617583e-01 1 1  ON 30
eH1_1                -1.560129e-01 1 1  ON 31
eH1_2                -1.095445e-01 1 1  ON 32
eH1_3                -5.714309e-02 1 1  ON 33
eH1_4                -5.512737e-03 1 1  ON 34
eH1_5                 3.080118e-02 1 1  ON 35
eH1_6                 9.544354e-02 1 1  ON 36
eH1_7                 1.596967e-01 1 1  ON 37
eH1_8                 1.990126e-01 1 1  ON 38
eH1_9                 9.966631e-02 1 1  ON 39
eH2_0                -2.561465e-01 1 1  ON 40
eH2_1                -1.502022e-01 1 1  ON 41
eH2_2                -1.038483e-01 1 1  ON 42
eH2_3                -5.151978e-02 1 1  ON 43
eH2_4                -3.562878e-04 1 1  ON 44
eH2_5                 3.533909e-02 1 1  ON 45
eH2_6                 9.913750e-02 1 1  ON 46
eH2_7                 1.608844e-01 1 1  ON 47
eH2_8                 2.003293e-01 1 1  ON 48
eH2_9                 8.145115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.337061
====================================================
  Execution time = 2.5203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3364e-01
  Total weights = 2.0000e+06
  Execution time = 2.9346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333778576881
                                         uncertainty =       0.004485228088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333778576881
                                         uncertainty =       0.004485228088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408489765
  error estimate for blocks of size 2^( 2) =       0.000420124044
  error estimate for blocks of size 2^( 3) =       0.000432492382
  error estimate for blocks of size 2^( 4) =       0.000444317123
  error estimate for blocks of size 2^( 5) =       0.000454685730
  error estimate for blocks of size 2^( 6) =       0.000462507923
  error estimate for blocks of size 2^( 7) =       0.000468657269

      target function =                  N/A
              le_mean =     -16.910135130112
             les_mean =     286.286397727380
             stat err =       0.000457542011
             autocorr =       1.254583569900
              std dev =       0.577691765202
             le_variance =       0.333727775582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333571657854
                                         uncertainty =       0.004484167968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333571657854
                                         uncertainty =       0.004484167968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408363067
  error estimate for blocks of size 2^( 2) =       0.000420006102
  error estimate for blocks of size 2^( 3) =       0.000432380814
  error estimate for blocks of size 2^( 4) =       0.000444210136
  error estimate for blocks of size 2^( 5) =       0.000454580120
  error estimate for blocks of size 2^( 6) =       0.000462402787
  error estimate for blocks of size 2^( 7) =       0.000468554094

      target function =                  N/A
              le_mean =     -16.910133267911
             les_mean =     286.286127760744
             stat err =       0.000457436784
             autocorr =       1.254784819758
              std dev =       0.577512587733
             le_variance =       0.333520788990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333602113643
                                         uncertainty =       0.004485455119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333602113643
                                         uncertainty =       0.004485455119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408381728
  error estimate for blocks of size 2^( 2) =       0.000420022533
  error estimate for blocks of size 2^( 3) =       0.000432395804
  error estimate for blocks of size 2^( 4) =       0.000444224558
  error estimate for blocks of size 2^( 5) =       0.000454594418
  error estimate for blocks of size 2^( 6) =       0.000462417928
  error estimate for blocks of size 2^( 7) =       0.000468569103

      target function =                  N/A
              le_mean =     -16.910133574627
             les_mean =     286.286168616884
             stat err =       0.000457451502
             autocorr =       1.254750883083
              std dev =       0.577538978726
             le_variance =       0.333551271948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333750833026
                                         uncertainty =       0.004485320609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333750833026
                                         uncertainty =       0.004485320609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408472782
  error estimate for blocks of size 2^( 2) =       0.000420108024
  error estimate for blocks of size 2^( 3) =       0.000432477098
  error estimate for blocks of size 2^( 4) =       0.000444302434
  error estimate for blocks of size 2^( 5) =       0.000454671213
  error estimate for blocks of size 2^( 6) =       0.000462493687
  error estimate for blocks of size 2^( 7) =       0.000468643326

      target function =                  N/A
              le_mean =     -16.910134882102
             les_mean =     286.286361590630
             stat err =       0.000457527665
             autocorr =       1.254609215292
              std dev =       0.577667747576
             le_variance =       0.333700026590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910135130112        initial  <--
     3.9062e-01     3.9062e+00             5.7505e-04       -16.910133267911
     1.5625e+00     1.5625e+01             1.4567e-04       -16.910133574627
     6.2500e+00     6.2500e+01             3.4586e-05       -16.910134882102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0522
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9458
    reference variance = 0.428272
====================================================
  Execution time = 2.4503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335180206410
                                         uncertainty =       0.005756329765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335180206410
                                         uncertainty =       0.005756329765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409334543
  error estimate for blocks of size 2^( 2) =       0.000421679553
  error estimate for blocks of size 2^( 3) =       0.000433976097
  error estimate for blocks of size 2^( 4) =       0.000445997982
  error estimate for blocks of size 2^( 5) =       0.000457733908
  error estimate for blocks of size 2^( 6) =       0.000464268140
  error estimate for blocks of size 2^( 7) =       0.000471088690

      target function =                  N/A
              le_mean =     -16.910480943992
             les_mean =     286.299475126058
             stat err =       0.000459772180
             autocorr =       1.261620065360
              std dev =       0.578886462536
             le_variance =       0.335109536508


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691048094399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480943992       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480997761       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910481123048       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910481204373       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910481296913       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910481315732       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910481274278       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910481247805       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.344371e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480943992       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480957951       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910480990330       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910481010820       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910481036399       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910481043233       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910481032095       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910481024962       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.341518e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480943992       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480947515       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910480955681       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910480960813       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910480967369       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910480969229       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910480966406       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910480964597       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.357247e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0845e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088651e-01 1 1  ON 0
 uu_1                 1.431627e-01 1 1  ON 1
 uu_2                 4.521493e-02 1 1  ON 2
 uu_3                -1.827359e-02 1 1  ON 3
 uu_4                -6.795818e-02 1 1  ON 4
 uu_5                -1.044786e-01 1 1  ON 5
 uu_6                -1.322408e-01 1 1  ON 6
 uu_7                -1.458363e-01 1 1  ON 7
 uu_8                -1.380503e-01 1 1  ON 8
 uu_9                -1.114456e-01 1 1  ON 9
 ud_0                 4.414451e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.814945e-02 1 1  ON 12
 ud_3                -1.754232e-03 1 1  ON 13
 ud_4                -5.819236e-02 1 1  ON 14
 ud_5                -1.016870e-01 1 1  ON 15
 ud_6                -1.321038e-01 1 1  ON 16
 ud_7                -1.525771e-01 1 1  ON 17
 ud_8                -1.576457e-01 1 1  ON 18
 ud_9                -1.500812e-01 1 1  ON 19
 eO_0                -7.566220e-01 1 1  ON 20
 eO_1                -4.402627e-01 1 1  ON 21
 eO_2                -2.469204e-02 1 1  ON 22
 eO_3                 3.013992e-01 1 1  ON 23
 eO_4                 5.332579e-01 1 1  ON 24
 eO_5                 4.977326e-01 1 1  ON 25
 eO_6                 2.697807e-01 1 1  ON 26
 eO_7                -3.858593e-02 1 1  ON 27
 eO_8                -2.375822e-01 1 1  ON 28
 eO_9                -1.013036e-01 1 1  ON 29
eH1_0                -2.616607e-01 1 1  ON 30
eH1_1                -1.559818e-01 1 1  ON 31
eH1_2                -1.095085e-01 1 1  ON 32
eH1_3                -5.707655e-02 1 1  ON 33
eH1_4                -5.516810e-03 1 1  ON 34
eH1_5                 3.078587e-02 1 1  ON 35
eH1_6                 9.542489e-02 1 1  ON 36
eH1_7                 1.597115e-01 1 1  ON 37
eH1_8                 1.989753e-01 1 1  ON 38
eH1_9                 9.953405e-02 1 1  ON 39
eH2_0                -2.561869e-01 1 1  ON 40
eH2_1                -1.501280e-01 1 1  ON 41
eH2_2                -1.037887e-01 1 1  ON 42
eH2_3                -5.144733e-02 1 1  ON 43
eH2_4                -3.225130e-04 1 1  ON 44
eH2_5                 3.535316e-02 1 1  ON 45
eH2_6                 9.915485e-02 1 1  ON 46
eH2_7                 1.608453e-01 1 1  ON 47
eH2_8                 2.002565e-01 1 1  ON 48
eH2_9                 8.134257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8836
    reference variance = 0.122122
====================================================
  Execution time = 2.3677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3472e-01
  Total weights = 2.0000e+06
  Execution time = 2.7138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334706064159
                                         uncertainty =       0.007246660484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334706064159
                                         uncertainty =       0.007246660484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409091979
  error estimate for blocks of size 2^( 2) =       0.000420520577
  error estimate for blocks of size 2^( 3) =       0.000432932848
  error estimate for blocks of size 2^( 4) =       0.000445291541
  error estimate for blocks of size 2^( 5) =       0.000454556500
  error estimate for blocks of size 2^( 6) =       0.000462143482
  error estimate for blocks of size 2^( 7) =       0.000467885503

      target function =                  N/A
              le_mean =     -16.910755827211
             les_mean =     286.308374974745
             stat err =       0.000457469257
             autocorr =       1.250494822563
              std dev =       0.578543424960
             le_variance =       0.334712494564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736267961
                                         uncertainty =       0.007246701861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736267961
                                         uncertainty =       0.007246701861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409110441
  error estimate for blocks of size 2^( 2) =       0.000420538070
  error estimate for blocks of size 2^( 3) =       0.000432949510
  error estimate for blocks of size 2^( 4) =       0.000445307735
  error estimate for blocks of size 2^( 5) =       0.000454572712
  error estimate for blocks of size 2^( 6) =       0.000462159944
  error estimate for blocks of size 2^( 7) =       0.000467901578

      target function =                  N/A
              le_mean =     -16.910755628704
             les_mean =     286.308398472821
             stat err =       0.000457485492
             autocorr =       1.250470712842
              std dev =       0.578569534682
             le_variance =       0.334742706463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334722608799
                                         uncertainty =       0.007246696943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334722608799
                                         uncertainty =       0.007246696943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409102092
  error estimate for blocks of size 2^( 2) =       0.000420530159
  error estimate for blocks of size 2^( 3) =       0.000432941983
  error estimate for blocks of size 2^( 4) =       0.000445300420
  error estimate for blocks of size 2^( 5) =       0.000454565386
  error estimate for blocks of size 2^( 6) =       0.000462152510
  error estimate for blocks of size 2^( 7) =       0.000467894313

      target function =                  N/A
              le_mean =     -16.910755717037
             les_mean =     286.308387797378
             stat err =       0.000457478157
             autocorr =       1.250481657615
              std dev =       0.578557726969
             le_variance =       0.334729043435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334708181184
                                         uncertainty =       0.007246665633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334708181184
                                         uncertainty =       0.007246665633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409093273
  error estimate for blocks of size 2^( 2) =       0.000420521803
  error estimate for blocks of size 2^( 3) =       0.000432934017
  error estimate for blocks of size 2^( 4) =       0.000445292677
  error estimate for blocks of size 2^( 5) =       0.000454557637
  error estimate for blocks of size 2^( 6) =       0.000462144637
  error estimate for blocks of size 2^( 7) =       0.000467886631

      target function =                  N/A
              le_mean =     -16.910755812902
             les_mean =     286.308376608365
             stat err =       0.000457470396
             autocorr =       1.250493138440
              std dev =       0.578545255036
             le_variance =       0.334714612124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910755827211        initial  <--
     3.9062e+00     3.9062e+01             5.3444e-05       -16.910755628704
     1.5625e+01     1.5625e+02             1.3415e-05       -16.910755717037
     6.2500e+01     6.2500e+02             3.3572e-06       -16.910755812902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.3282
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.38399
====================================================
  Execution time = 2.5055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3461e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334697239222
                                         uncertainty =       0.004252760162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334697239222
                                         uncertainty =       0.004252760162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409028394
  error estimate for blocks of size 2^( 2) =       0.000420956216
  error estimate for blocks of size 2^( 3) =       0.000433479990
  error estimate for blocks of size 2^( 4) =       0.000445797641
  error estimate for blocks of size 2^( 5) =       0.000458069087
  error estimate for blocks of size 2^( 6) =       0.000467675473
  error estimate for blocks of size 2^( 7) =       0.000475802968

      target function =                  N/A
              le_mean =     -16.911628758378
             les_mean =     286.337795548018
             stat err =       0.000461836292
             autocorr =       1.274879688249
              std dev =       0.578453502141
             le_variance =       0.334608454139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691162875838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911628758378       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911628764279       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911628762977       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911628761473       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911628767870       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911628775270       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911628774461       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911628773554       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.372522e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911628758378       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911628759856       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911628759525       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911628759144       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911628760747       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911628762602       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911628762405       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911628762168       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.351920e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911628758378       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911628758747       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911628758664       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911628758569       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911628758970       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911628759434       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911628759385       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911628759325       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.385350e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1404e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088616e-01 1 1  ON 0
 uu_1                 1.431619e-01 1 1  ON 1
 uu_2                 4.521481e-02 1 1  ON 2
 uu_3                -1.827759e-02 1 1  ON 3
 uu_4                -6.795222e-02 1 1  ON 4
 uu_5                -1.044790e-01 1 1  ON 5
 uu_6                -1.322382e-01 1 1  ON 6
 uu_7                -1.458345e-01 1 1  ON 7
 uu_8                -1.380521e-01 1 1  ON 8
 uu_9                -1.114429e-01 1 1  ON 9
 ud_0                 4.414352e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815052e-02 1 1  ON 12
 ud_3                -1.756425e-03 1 1  ON 13
 ud_4                -5.819229e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321024e-01 1 1  ON 16
 ud_7                -1.525782e-01 1 1  ON 17
 ud_8                -1.576471e-01 1 1  ON 18
 ud_9                -1.500795e-01 1 1  ON 19
 eO_0                -7.566323e-01 1 1  ON 20
 eO_1                -4.402620e-01 1 1  ON 21
 eO_2                -2.468893e-02 1 1  ON 22
 eO_3                 3.013985e-01 1 1  ON 23
 eO_4                 5.332529e-01 1 1  ON 24
 eO_5                 4.977288e-01 1 1  ON 25
 eO_6                 2.697834e-01 1 1  ON 26
 eO_7                -3.859048e-02 1 1  ON 27
 eO_8                -2.375776e-01 1 1  ON 28
 eO_9                -1.012933e-01 1 1  ON 29
eH1_0                -2.616555e-01 1 1  ON 30
eH1_1                -1.559837e-01 1 1  ON 31
eH1_2                -1.095054e-01 1 1  ON 32
eH1_3                -5.707629e-02 1 1  ON 33
eH1_4                -5.506005e-03 1 1  ON 34
eH1_5                 3.079300e-02 1 1  ON 35
eH1_6                 9.541876e-02 1 1  ON 36
eH1_7                 1.597139e-01 1 1  ON 37
eH1_8                 1.989693e-01 1 1  ON 38
eH1_9                 9.952158e-02 1 1  ON 39
eH2_0                -2.561900e-01 1 1  ON 40
eH2_1                -1.501175e-01 1 1  ON 41
eH2_2                -1.037831e-01 1 1  ON 42
eH2_3                -5.144658e-02 1 1  ON 43
eH2_4                -3.204325e-04 1 1  ON 44
eH2_5                 3.535128e-02 1 1  ON 45
eH2_6                 9.914795e-02 1 1  ON 46
eH2_7                 1.608462e-01 1 1  ON 47
eH2_8                 2.002564e-01 1 1  ON 48
eH2_9                 8.133426e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9924
    reference variance = 0.250612
====================================================
  Execution time = 2.4797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4111e-01
  Total weights = 2.0000e+06
  Execution time = 2.7311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341179153587
                                         uncertainty =       0.009281304002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341179153587
                                         uncertainty =       0.009281304002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412981482
  error estimate for blocks of size 2^( 2) =       0.000424493204
  error estimate for blocks of size 2^( 3) =       0.000436375922
  error estimate for blocks of size 2^( 4) =       0.000447614397
  error estimate for blocks of size 2^( 5) =       0.000457979517
  error estimate for blocks of size 2^( 6) =       0.000467918169
  error estimate for blocks of size 2^( 7) =       0.000472220377

      target function =                  N/A
              le_mean =     -16.911009727437
             les_mean =     286.323357239386
             stat err =       0.000461433115
             autocorr =       1.248407476724
              std dev =       0.584044012446
             le_variance =       0.341107408475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341176571535
                                         uncertainty =       0.009281107852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341176571535
                                         uncertainty =       0.009281107852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412979920
  error estimate for blocks of size 2^( 2) =       0.000424491742
  error estimate for blocks of size 2^( 3) =       0.000436374534
  error estimate for blocks of size 2^( 4) =       0.000447612991
  error estimate for blocks of size 2^( 5) =       0.000457978120
  error estimate for blocks of size 2^( 6) =       0.000467916768
  error estimate for blocks of size 2^( 7) =       0.000472218993

      target function =                  N/A
              le_mean =     -16.911009685665
             les_mean =     286.323353246348
             stat err =       0.000461431718
             autocorr =       1.248409362163
              std dev =       0.584041803499
             le_variance =       0.341104828234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341177847952
                                         uncertainty =       0.009281204848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341177847952
                                         uncertainty =       0.009281204848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412980692
  error estimate for blocks of size 2^( 2) =       0.000424492465
  error estimate for blocks of size 2^( 3) =       0.000436375220
  error estimate for blocks of size 2^( 4) =       0.000447613686
  error estimate for blocks of size 2^( 5) =       0.000457978811
  error estimate for blocks of size 2^( 6) =       0.000467917461
  error estimate for blocks of size 2^( 7) =       0.000472219678

      target function =                  N/A
              le_mean =     -16.911009706346
             les_mean =     286.323355221334
             stat err =       0.000461432409
             autocorr =       1.248408431755
              std dev =       0.584042895475
             le_variance =       0.341106103755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341178989901
                                         uncertainty =       0.009281291574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341178989901
                                         uncertainty =       0.009281291574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412981383
  error estimate for blocks of size 2^( 2) =       0.000424493111
  error estimate for blocks of size 2^( 3) =       0.000436375834
  error estimate for blocks of size 2^( 4) =       0.000447614308
  error estimate for blocks of size 2^( 5) =       0.000457979428
  error estimate for blocks of size 2^( 6) =       0.000467918080
  error estimate for blocks of size 2^( 7) =       0.000472220290

      target function =                  N/A
              le_mean =     -16.911009724792
             les_mean =     286.323356986355
             stat err =       0.000461433026
             autocorr =       1.248407596502
              std dev =       0.584043872413
             le_variance =       0.341107244904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911009727437        initial  <--
     3.9062e+01     3.9062e+02             5.3725e-06       -16.911009685665
     1.5625e+02     1.5625e+03             1.3519e-06       -16.911009706346
     6.2500e+02     6.2500e+03             3.3854e-07       -16.911009724792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5462
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8838
    reference variance = 0.220039
====================================================
  Execution time = 2.4226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336975017809
                                         uncertainty =       0.008783545467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336975017809
                                         uncertainty =       0.008783545467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410405300
  error estimate for blocks of size 2^( 2) =       0.000422473486
  error estimate for blocks of size 2^( 3) =       0.000435237346
  error estimate for blocks of size 2^( 4) =       0.000448632474
  error estimate for blocks of size 2^( 5) =       0.000462634167
  error estimate for blocks of size 2^( 6) =       0.000472330704
  error estimate for blocks of size 2^( 7) =       0.000480823396

      target function =                  N/A
              le_mean =     -16.909912608388
             les_mean =     286.282009275566
             stat err =       0.000466105185
             autocorr =       1.289858135355
              std dev =       0.580400741443
             le_variance =       0.336865020668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690991260839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909912608388       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909912610272       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909912610806       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909912610887       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909912611612       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909912610460       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909912611055       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909912611096       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 7.387694e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909912608388       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909912608859       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909912608993       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909912609014       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909912609195       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909912608907       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909912609054       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909912609062       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.847495e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909912608388       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909912608506       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909912608539       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909912608545       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909912608589       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909912608519       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909912608553       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909912608551       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.619096e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0662e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088620e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521525e-02 1 1  ON 2
 uu_3                -1.827805e-02 1 1  ON 3
 uu_4                -6.795180e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322385e-01 1 1  ON 6
 uu_7                -1.458339e-01 1 1  ON 7
 uu_8                -1.380518e-01 1 1  ON 8
 uu_9                -1.114430e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815039e-02 1 1  ON 12
 ud_3                -1.756027e-03 1 1  ON 13
 ud_4                -5.819194e-02 1 1  ON 14
 ud_5                -1.016866e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525784e-01 1 1  ON 17
 ud_8                -1.576480e-01 1 1  ON 18
 ud_9                -1.500805e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468827e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697829e-01 1 1  ON 26
 eO_7                -3.859086e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616544e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095051e-01 1 1  ON 32
eH1_3                -5.707543e-02 1 1  ON 33
eH1_4                -5.506499e-03 1 1  ON 34
eH1_5                 3.079269e-02 1 1  ON 35
eH1_6                 9.541865e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989688e-01 1 1  ON 38
eH1_9                 9.952077e-02 1 1  ON 39
eH2_0                -2.561898e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037820e-01 1 1  ON 42
eH2_3                -5.144621e-02 1 1  ON 43
eH2_4                -3.206781e-04 1 1  ON 44
eH2_5                 3.535156e-02 1 1  ON 45
eH2_6                 9.914830e-02 1 1  ON 46
eH2_7                 1.608458e-01 1 1  ON 47
eH2_8                 2.002557e-01 1 1  ON 48
eH2_9                 8.133319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.833
    reference variance = 0.394317
====================================================
  Execution time = 2.3839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2698e-01
  Total weights = 2.0000e+06
  Execution time = 2.7154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797934994
                                         uncertainty =       0.003604225687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797934994
                                         uncertainty =       0.003604225687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404339273
  error estimate for blocks of size 2^( 2) =       0.000416148794
  error estimate for blocks of size 2^( 3) =       0.000428359580
  error estimate for blocks of size 2^( 4) =       0.000439870801
  error estimate for blocks of size 2^( 5) =       0.000450486690
  error estimate for blocks of size 2^( 6) =       0.000458135161
  error estimate for blocks of size 2^( 7) =       0.000461214264

      target function =                  N/A
              le_mean =     -16.910195014479
             les_mean =     286.281675759006
             stat err =       0.000452426729
             autocorr =       1.252000951151
              std dev =       0.571822083168
             le_variance =       0.326980494799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326798394344
                                         uncertainty =       0.003604228789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326798394344
                                         uncertainty =       0.003604228789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404339557
  error estimate for blocks of size 2^( 2) =       0.000416149067
  error estimate for blocks of size 2^( 3) =       0.000428359839
  error estimate for blocks of size 2^( 4) =       0.000439871048
  error estimate for blocks of size 2^( 5) =       0.000450486928
  error estimate for blocks of size 2^( 6) =       0.000458135398
  error estimate for blocks of size 2^( 7) =       0.000461214486

      target function =                  N/A
              le_mean =     -16.910195012376
             les_mean =     286.281676147736
             stat err =       0.000452426965
             autocorr =       1.252000495534
              std dev =       0.571822485260
             le_variance =       0.326980954649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326798164809
                                         uncertainty =       0.003604227239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326798164809
                                         uncertainty =       0.003604227239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404339415
  error estimate for blocks of size 2^( 2) =       0.000416148930
  error estimate for blocks of size 2^( 3) =       0.000428359710
  error estimate for blocks of size 2^( 4) =       0.000439870925
  error estimate for blocks of size 2^( 5) =       0.000450486809
  error estimate for blocks of size 2^( 6) =       0.000458135280
  error estimate for blocks of size 2^( 7) =       0.000461214376

      target function =                  N/A
              le_mean =     -16.910195013425
             les_mean =     286.281675953427
             stat err =       0.000452426847
             autocorr =       1.252000723229
              std dev =       0.571822284336
             le_variance =       0.326980724863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797963725
                                         uncertainty =       0.003604225881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797963725
                                         uncertainty =       0.003604225881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404339290
  error estimate for blocks of size 2^( 2) =       0.000416148811
  error estimate for blocks of size 2^( 3) =       0.000428359596
  error estimate for blocks of size 2^( 4) =       0.000439870817
  error estimate for blocks of size 2^( 5) =       0.000450486705
  error estimate for blocks of size 2^( 6) =       0.000458135176
  error estimate for blocks of size 2^( 7) =       0.000461214278

      target function =                  N/A
              le_mean =     -16.910195014347
             les_mean =     286.281675783309
             stat err =       0.000452426744
             autocorr =       1.252000922671
              std dev =       0.571822108318
             le_variance =       0.326980523561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910195014479        initial  <--
     3.9062e+02     3.9062e+03             7.3877e-07       -16.910195012376
     1.5625e+03     1.5625e+04             1.8475e-07       -16.910195013425
     6.2500e+03     6.2500e+04             4.6191e-08       -16.910195014347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5057
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.204614
====================================================
  Execution time = 2.4291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3591e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336032050806
                                         uncertainty =       0.005819647433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336032050806
                                         uncertainty =       0.005819647433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409823649
  error estimate for blocks of size 2^( 2) =       0.000421418735
  error estimate for blocks of size 2^( 3) =       0.000432598015
  error estimate for blocks of size 2^( 4) =       0.000443815617
  error estimate for blocks of size 2^( 5) =       0.000453220442
  error estimate for blocks of size 2^( 6) =       0.000459994962
  error estimate for blocks of size 2^( 7) =       0.000465109461

      target function =                  N/A
              le_mean =     -16.911032321561
             les_mean =     286.318924858780
             stat err =       0.000455535120
             autocorr =       1.235519771254
              std dev =       0.579578161994
             le_variance =       0.335910845860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691103232156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911032321561       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911032321761       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032321919       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911032322115       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911032322139       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911032322156       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911032322187       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.393077e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911032321561       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911032321611       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032321650       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911032321694       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911032321712       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911032321727       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911032321724       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.348384e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911032321561       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911032321573       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032321583       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911032321623       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911032321603       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911032321644       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911032321577       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 3.371032e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0621e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827806e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755945e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332531e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506499e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952065e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144612e-02 1 1  ON 43
eH2_4                -3.207282e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.277552
====================================================
  Execution time = 2.3593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3486e-01
  Total weights = 2.0000e+06
  Execution time = 2.7419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938491855
                                         uncertainty =       0.005748688634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938491855
                                         uncertainty =       0.005748688634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182439
  error estimate for blocks of size 2^( 2) =       0.000421132665
  error estimate for blocks of size 2^( 3) =       0.000433318703
  error estimate for blocks of size 2^( 4) =       0.000445167818
  error estimate for blocks of size 2^( 5) =       0.000456758715
  error estimate for blocks of size 2^( 6) =       0.000465991101
  error estimate for blocks of size 2^( 7) =       0.000474974384

      target function =                  N/A
              le_mean =     -16.911328817139
             les_mean =     286.327902730644
             stat err =       0.000460723005
             autocorr =       1.267785622279
              std dev =       0.578671354642
             le_variance =       0.334860536683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938520725
                                         uncertainty =       0.005748689513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938520725
                                         uncertainty =       0.005748689513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182457
  error estimate for blocks of size 2^( 2) =       0.000421132681
  error estimate for blocks of size 2^( 3) =       0.000433318718
  error estimate for blocks of size 2^( 4) =       0.000445167832
  error estimate for blocks of size 2^( 5) =       0.000456758729
  error estimate for blocks of size 2^( 6) =       0.000465991116
  error estimate for blocks of size 2^( 7) =       0.000474974397

      target function =                  N/A
              le_mean =     -16.911328817053
             les_mean =     286.327902756579
             stat err =       0.000460723019
             autocorr =       1.267785589770
              std dev =       0.578671379565
             le_variance =       0.334860565528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938506292
                                         uncertainty =       0.005748689074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938506292
                                         uncertainty =       0.005748689074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182448
  error estimate for blocks of size 2^( 2) =       0.000421132673
  error estimate for blocks of size 2^( 3) =       0.000433318711
  error estimate for blocks of size 2^( 4) =       0.000445167825
  error estimate for blocks of size 2^( 5) =       0.000456758722
  error estimate for blocks of size 2^( 6) =       0.000465991109
  error estimate for blocks of size 2^( 7) =       0.000474974390

      target function =                  N/A
              le_mean =     -16.911328817096
             les_mean =     286.327902743613
             stat err =       0.000460723012
             autocorr =       1.267785606026
              std dev =       0.578671367105
             le_variance =       0.334860551107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938493659
                                         uncertainty =       0.005748688689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334938493659
                                         uncertainty =       0.005748688689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182440
  error estimate for blocks of size 2^( 2) =       0.000421132666
  error estimate for blocks of size 2^( 3) =       0.000433318704
  error estimate for blocks of size 2^( 4) =       0.000445167819
  error estimate for blocks of size 2^( 5) =       0.000456758716
  error estimate for blocks of size 2^( 6) =       0.000465991102
  error estimate for blocks of size 2^( 7) =       0.000474974384

      target function =                  N/A
              le_mean =     -16.911328817133
             les_mean =     286.327902732265
             stat err =       0.000460723005
             autocorr =       1.267785620241
              std dev =       0.578671356200
             le_variance =       0.334860538486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911328817139        initial  <--
     3.9062e+03     3.9062e+04             5.3931e-08       -16.911328817053
     1.5625e+04     1.5625e+05             1.3484e-08       -16.911328817096
     6.2500e+04     6.2500e+05             3.3710e-09       -16.911328817133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.3672
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.978
    reference variance = 0.293955
====================================================
  Execution time = 2.6367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333042525165
                                         uncertainty =       0.004194617853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333042525165
                                         uncertainty =       0.004194617853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408103734
  error estimate for blocks of size 2^( 2) =       0.000419945465
  error estimate for blocks of size 2^( 3) =       0.000433183062
  error estimate for blocks of size 2^( 4) =       0.000444743322
  error estimate for blocks of size 2^( 5) =       0.000456445361
  error estimate for blocks of size 2^( 6) =       0.000464755682
  error estimate for blocks of size 2^( 7) =       0.000466528362

      target function =                  N/A
              le_mean =     -16.911257967730
             les_mean =     286.323743200393
             stat err =       0.000458118182
             autocorr =       1.260125846634
              std dev =       0.577145835832
             le_variance =       0.333097315818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691125796773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911257967730       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911257967734       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911257967734       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911257967728       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911257967714       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911257967743       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911257967830       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911257967742       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.160650e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911257967730       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911257967731       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911257967731       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911257967637       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911257967772       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911257967739       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911257967767       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911257967775       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.290163e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911257967730       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911257967731       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911257967731       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911257967749       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911257968107       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911257967659       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911257966748       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911257968112       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.225408e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2699e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8733
    reference variance = 0.261222
====================================================
  Execution time = 2.3634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2474e-01
  Total weights = 2.0000e+06
  Execution time = 2.7354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753484022
                                         uncertainty =       0.003853769068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753484022
                                         uncertainty =       0.003853769068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402951887
  error estimate for blocks of size 2^( 2) =       0.000414558281
  error estimate for blocks of size 2^( 3) =       0.000426758432
  error estimate for blocks of size 2^( 4) =       0.000438832114
  error estimate for blocks of size 2^( 5) =       0.000450034938
  error estimate for blocks of size 2^( 6) =       0.000457404374
  error estimate for blocks of size 2^( 7) =       0.000460890657

      target function =                  N/A
              le_mean =     -16.911182285315
             les_mean =     286.312826571559
             stat err =       0.000451790521
             autocorr =       1.257094252221
              std dev =       0.569860023853
             le_variance =       0.324740446786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753482334
                                         uncertainty =       0.003853769073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753482334
                                         uncertainty =       0.003853769073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402951886
  error estimate for blocks of size 2^( 2) =       0.000414558280
  error estimate for blocks of size 2^( 3) =       0.000426758431
  error estimate for blocks of size 2^( 4) =       0.000438832113
  error estimate for blocks of size 2^( 5) =       0.000450034937
  error estimate for blocks of size 2^( 6) =       0.000457404373
  error estimate for blocks of size 2^( 7) =       0.000460890656

      target function =                  N/A
              le_mean =     -16.911182285311
             les_mean =     286.312826569757
             stat err =       0.000451790520
             autocorr =       1.257094253031
              std dev =       0.569860022373
             le_variance =       0.324740445099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753483178
                                         uncertainty =       0.003853769070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753483178
                                         uncertainty =       0.003853769070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402951887
  error estimate for blocks of size 2^( 2) =       0.000414558280
  error estimate for blocks of size 2^( 3) =       0.000426758431
  error estimate for blocks of size 2^( 4) =       0.000438832113
  error estimate for blocks of size 2^( 5) =       0.000450034938
  error estimate for blocks of size 2^( 6) =       0.000457404373
  error estimate for blocks of size 2^( 7) =       0.000460890657

      target function =                  N/A
              le_mean =     -16.911182285313
             les_mean =     286.312826570658
             stat err =       0.000451790520
             autocorr =       1.257094252622
              std dev =       0.569860023113
             le_variance =       0.324740445943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753483917
                                         uncertainty =       0.003853769068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324753483917
                                         uncertainty =       0.003853769068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402951887
  error estimate for blocks of size 2^( 2) =       0.000414558281
  error estimate for blocks of size 2^( 3) =       0.000426758432
  error estimate for blocks of size 2^( 4) =       0.000438832114
  error estimate for blocks of size 2^( 5) =       0.000450034938
  error estimate for blocks of size 2^( 6) =       0.000457404373
  error estimate for blocks of size 2^( 7) =       0.000460890657

      target function =                  N/A
              le_mean =     -16.911182285315
             les_mean =     286.312826571446
             stat err =       0.000451790521
             autocorr =       1.257094252265
              std dev =       0.569860023760
             le_variance =       0.324740446680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911182285315        initial  <--
     3.9062e+04     3.9062e+05             5.1607e-09       -16.911182285311
     1.5625e+05     1.5625e+06             1.2902e-09       -16.911182285313
     6.2500e+05     6.2500e+06             3.2254e-10       -16.911182285315

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.3874
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0094e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1515
    reference variance = 3.01764
====================================================
  Execution time = 2.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253019564
                                         uncertainty =       0.003870748624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253019564
                                         uncertainty =       0.003870748624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407702064
  error estimate for blocks of size 2^( 2) =       0.000419128809
  error estimate for blocks of size 2^( 3) =       0.000431716009
  error estimate for blocks of size 2^( 4) =       0.000443728802
  error estimate for blocks of size 2^( 5) =       0.000454089077
  error estimate for blocks of size 2^( 6) =       0.000462895831
  error estimate for blocks of size 2^( 7) =       0.000465949017

      target function =                  N/A
              le_mean =     -16.911320229916
             les_mean =     286.325193698242
             stat err =       0.000456665682
             autocorr =       1.254616318088
              std dev =       0.576577788074
             le_variance =       0.332441945700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132022992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320229916       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320229915       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320229916       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911320229908       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911320229917       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911320229891       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320229813       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911320230191       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.259639e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320229916       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320229916       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320229916       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911320229916       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911320229701       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911320229952       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320229124       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911320232311       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.314911e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320229916       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320229916       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320229916       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911320229916       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911320234242       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911320233218       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320234038       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911320230275       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 3.287276e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0782e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.285934
====================================================
  Execution time = 2.3815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3237e-01
  Total weights = 2.0000e+06
  Execution time = 2.7350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277648133
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277648133
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657440
  error estimate for blocks of size 2^( 2) =       0.000419590009
  error estimate for blocks of size 2^( 3) =       0.000432277409
  error estimate for blocks of size 2^( 4) =       0.000444402426
  error estimate for blocks of size 2^( 5) =       0.000454187678
  error estimate for blocks of size 2^( 6) =       0.000461426418
  error estimate for blocks of size 2^( 7) =       0.000465870986

      target function =                  N/A
              le_mean =     -16.911372711852
             les_mean =     286.326896009415
             stat err =       0.000456471877
             autocorr =       1.253826103163
              std dev =       0.576514680142
             le_variance =       0.332369176420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277647785
                                         uncertainty =       0.004073385073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277647785
                                         uncertainty =       0.004073385073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657440
  error estimate for blocks of size 2^( 2) =       0.000419590009
  error estimate for blocks of size 2^( 3) =       0.000432277409
  error estimate for blocks of size 2^( 4) =       0.000444402426
  error estimate for blocks of size 2^( 5) =       0.000454187678
  error estimate for blocks of size 2^( 6) =       0.000461426418
  error estimate for blocks of size 2^( 7) =       0.000465870986

      target function =                  N/A
              le_mean =     -16.911372711853
             les_mean =     286.326896009090
             stat err =       0.000456471877
             autocorr =       1.253826103420
              std dev =       0.576514679840
             le_variance =       0.332369176071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277647959
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277647959
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657440
  error estimate for blocks of size 2^( 2) =       0.000419590009
  error estimate for blocks of size 2^( 3) =       0.000432277409
  error estimate for blocks of size 2^( 4) =       0.000444402426
  error estimate for blocks of size 2^( 5) =       0.000454187678
  error estimate for blocks of size 2^( 6) =       0.000461426418
  error estimate for blocks of size 2^( 7) =       0.000465870986

      target function =                  N/A
              le_mean =     -16.911372711853
             les_mean =     286.326896009253
             stat err =       0.000456471877
             autocorr =       1.253826103292
              std dev =       0.576514679991
             le_variance =       0.332369176245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277648112
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332277648112
                                         uncertainty =       0.004073385074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657440
  error estimate for blocks of size 2^( 2) =       0.000419590009
  error estimate for blocks of size 2^( 3) =       0.000432277409
  error estimate for blocks of size 2^( 4) =       0.000444402426
  error estimate for blocks of size 2^( 5) =       0.000454187678
  error estimate for blocks of size 2^( 6) =       0.000461426418
  error estimate for blocks of size 2^( 7) =       0.000465870986

      target function =                  N/A
              le_mean =     -16.911372711852
             les_mean =     286.326896009395
             stat err =       0.000456471877
             autocorr =       1.253826103179
              std dev =       0.576514680124
             le_variance =       0.332369176398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911372711852        initial
     3.9062e+05     3.9062e+06             5.2596e-10       -16.911372711853  <--
     1.5625e+06     1.5625e+07             1.3149e-10       -16.911372711853
     6.2500e+06     6.2500e+07             3.2873e-11       -16.911372711852

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 3.7576e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8627
    reference variance = 0.609332
====================================================
  Execution time = 2.4356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326525123028
                                         uncertainty =       0.003126197407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326525123028
                                         uncertainty =       0.003126197407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404700088
  error estimate for blocks of size 2^( 2) =       0.000416462373
  error estimate for blocks of size 2^( 3) =       0.000429239768
  error estimate for blocks of size 2^( 4) =       0.000440709538
  error estimate for blocks of size 2^( 5) =       0.000450426814
  error estimate for blocks of size 2^( 6) =       0.000457546022
  error estimate for blocks of size 2^( 7) =       0.000462761328

      target function =                  N/A
              le_mean =     -16.910549825594
             les_mean =     286.294259562151
             stat err =       0.000452860925
             autocorr =       1.252169445950
              std dev =       0.572332352768
             le_variance =       0.327564322025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691054982559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910549825594       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910549825601       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910549825604       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910549825627       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910549825525       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910549825670       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910549825613       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.182583e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910549825594       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910549825596       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910549825597       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910549825599       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910549825599       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910549826037       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910549825493       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.456462e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910549825594       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910549825595       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910549825595       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910549825643       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910549825721       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910549825785       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910549824826       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.364116e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0764e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8404
    reference variance = 0.201631
====================================================
  Execution time = 2.4064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3516e-01
  Total weights = 2.0000e+06
  Execution time = 2.7274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625620
                                         uncertainty =       0.008667665904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625620
                                         uncertainty =       0.008667665904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409365348
  error estimate for blocks of size 2^( 2) =       0.000420915712
  error estimate for blocks of size 2^( 3) =       0.000432596731
  error estimate for blocks of size 2^( 4) =       0.000443554926
  error estimate for blocks of size 2^( 5) =       0.000452735129
  error estimate for blocks of size 2^( 6) =       0.000459217983
  error estimate for blocks of size 2^( 7) =       0.000464699118

      target function =                  N/A
              le_mean =     -16.910900396757
             les_mean =     286.313712037840
             stat err =       0.000455051789
             autocorr =       1.235661447077
              std dev =       0.578930027179
             le_variance =       0.335159976370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625517
                                         uncertainty =       0.008667665835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625517
                                         uncertainty =       0.008667665835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409365348
  error estimate for blocks of size 2^( 2) =       0.000420915712
  error estimate for blocks of size 2^( 3) =       0.000432596731
  error estimate for blocks of size 2^( 4) =       0.000443554926
  error estimate for blocks of size 2^( 5) =       0.000452735129
  error estimate for blocks of size 2^( 6) =       0.000459217983
  error estimate for blocks of size 2^( 7) =       0.000464699118

      target function =                  N/A
              le_mean =     -16.910900396745
             les_mean =     286.313712037309
             stat err =       0.000455051789
             autocorr =       1.235661446772
              std dev =       0.578930027089
             le_variance =       0.335159976265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625568
                                         uncertainty =       0.008667665869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625568
                                         uncertainty =       0.008667665869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409365348
  error estimate for blocks of size 2^( 2) =       0.000420915712
  error estimate for blocks of size 2^( 3) =       0.000432596731
  error estimate for blocks of size 2^( 4) =       0.000443554926
  error estimate for blocks of size 2^( 5) =       0.000452735129
  error estimate for blocks of size 2^( 6) =       0.000459217983
  error estimate for blocks of size 2^( 7) =       0.000464699118

      target function =                  N/A
              le_mean =     -16.910900396751
             les_mean =     286.313712037575
             stat err =       0.000455051789
             autocorr =       1.235661446923
              std dev =       0.578930027134
             le_variance =       0.335159976318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625613
                                         uncertainty =       0.008667665899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334921625613
                                         uncertainty =       0.008667665899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409365348
  error estimate for blocks of size 2^( 2) =       0.000420915712
  error estimate for blocks of size 2^( 3) =       0.000432596731
  error estimate for blocks of size 2^( 4) =       0.000443554926
  error estimate for blocks of size 2^( 5) =       0.000452735129
  error estimate for blocks of size 2^( 6) =       0.000459217983
  error estimate for blocks of size 2^( 7) =       0.000464699118

      target function =                  N/A
              le_mean =     -16.910900396757
             les_mean =     286.313712037807
             stat err =       0.000455051789
             autocorr =       1.235661447053
              std dev =       0.578930027174
             le_variance =       0.335159976363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910900396757        initial  <--
     9.7656e+04     9.7656e+05             2.1826e-09       -16.910900396745
     3.9062e+05     3.9062e+06             5.4565e-10       -16.910900396751
     1.5625e+06     1.5625e+07             1.3641e-10       -16.910900396757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.7531
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.234787
====================================================
  Execution time = 2.4298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327035522677
                                         uncertainty =       0.003310759974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327035522677
                                         uncertainty =       0.003310759974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404370802
  error estimate for blocks of size 2^( 2) =       0.000415926327
  error estimate for blocks of size 2^( 3) =       0.000428451869
  error estimate for blocks of size 2^( 4) =       0.000439696643
  error estimate for blocks of size 2^( 5) =       0.000450312131
  error estimate for blocks of size 2^( 6) =       0.000458427530
  error estimate for blocks of size 2^( 7) =       0.000466938647

      target function =                  N/A
              le_mean =     -16.910788844207
             les_mean =     286.301810661097
             stat err =       0.000453843738
             autocorr =       1.259659352656
              std dev =       0.571866672624
             le_variance =       0.327031491258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078884421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910788844207       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910788844207       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910788844207       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910788844104       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910788844346       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910788844199       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910788843135       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910788844992       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.667121e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910788844207       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910788844207       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910788844207       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910788844207       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910788839711       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910788846693       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910788845939       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910788843611       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.667807e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910788844207       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910788844207       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910788844207       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910788844207       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910788844068       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910788844558       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910788848540       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910788829424       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.666963e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0645e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207207e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.981
    reference variance = 0.264715
====================================================
  Execution time = 2.4013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2811e-01
  Total weights = 2.0000e+06
  Execution time = 2.7137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983155
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983155
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405034544
  error estimate for blocks of size 2^( 2) =       0.000416903358
  error estimate for blocks of size 2^( 3) =       0.000429361927
  error estimate for blocks of size 2^( 4) =       0.000441480023
  error estimate for blocks of size 2^( 5) =       0.000451354861
  error estimate for blocks of size 2^( 6) =       0.000459374747
  error estimate for blocks of size 2^( 7) =       0.000463286331

      target function =                  N/A
              le_mean =     -16.910532501174
             les_mean =     286.294215272198
             stat err =       0.000453873990
             autocorr =       1.255701647157
              std dev =       0.572805344751
             le_variance =       0.328105962975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983102
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983102
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405034544
  error estimate for blocks of size 2^( 2) =       0.000416903357
  error estimate for blocks of size 2^( 3) =       0.000429361927
  error estimate for blocks of size 2^( 4) =       0.000441480023
  error estimate for blocks of size 2^( 5) =       0.000451354861
  error estimate for blocks of size 2^( 6) =       0.000459374747
  error estimate for blocks of size 2^( 7) =       0.000463286331

      target function =                  N/A
              le_mean =     -16.910532501175
             les_mean =     286.294215272156
             stat err =       0.000453873990
             autocorr =       1.255701647181
              std dev =       0.572805344704
             le_variance =       0.328105962922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983129
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983129
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405034544
  error estimate for blocks of size 2^( 2) =       0.000416903358
  error estimate for blocks of size 2^( 3) =       0.000429361927
  error estimate for blocks of size 2^( 4) =       0.000441480023
  error estimate for blocks of size 2^( 5) =       0.000451354861
  error estimate for blocks of size 2^( 6) =       0.000459374747
  error estimate for blocks of size 2^( 7) =       0.000463286331

      target function =                  N/A
              le_mean =     -16.910532501175
             les_mean =     286.294215272177
             stat err =       0.000453873990
             autocorr =       1.255701647173
              std dev =       0.572805344727
             le_variance =       0.328105962948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983152
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328089983152
                                         uncertainty =       0.003284393767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405034544
  error estimate for blocks of size 2^( 2) =       0.000416903358
  error estimate for blocks of size 2^( 3) =       0.000429361927
  error estimate for blocks of size 2^( 4) =       0.000441480023
  error estimate for blocks of size 2^( 5) =       0.000451354861
  error estimate for blocks of size 2^( 6) =       0.000459374747
  error estimate for blocks of size 2^( 7) =       0.000463286331

      target function =                  N/A
              le_mean =     -16.910532501174
             les_mean =     286.294215272195
             stat err =       0.000453873990
             autocorr =       1.255701647157
              std dev =       0.572805344748
             le_variance =       0.328105962972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910532501174        initial
     9.7656e+05     9.7656e+06             2.6671e-10       -16.910532501175  <--
     3.9062e+06     3.9062e+07             6.6678e-11       -16.910532501175
     1.5625e+07     1.5625e+08             1.6670e-11       -16.910532501174

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 3.7663e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207206e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9757
    reference variance = 0.696058
====================================================
  Execution time = 2.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336977047077
                                         uncertainty =       0.005908746750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336977047077
                                         uncertainty =       0.005908746750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410497697
  error estimate for blocks of size 2^( 2) =       0.000422087805
  error estimate for blocks of size 2^( 3) =       0.000434132498
  error estimate for blocks of size 2^( 4) =       0.000445074672
  error estimate for blocks of size 2^( 5) =       0.000454686271
  error estimate for blocks of size 2^( 6) =       0.000460881648
  error estimate for blocks of size 2^( 7) =       0.000464275765

      target function =                  N/A
              le_mean =     -16.910812869559
             les_mean =     286.312608459630
             stat err =       0.000456229589
             autocorr =       1.235223218178
              std dev =       0.580531410787
             le_variance =       0.337016718910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691081286956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910812869559       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910812869559       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910812869560       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910812869556       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910812869564       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910812869563       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910812869519       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910812869473       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 8.251004e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910812869559       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910812869559       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910812869559       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910812869579       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910812869278       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910812869565       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910812869507       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910812869503       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.062751e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910812869559       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910812869559       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910812869559       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910812867403       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910812869559       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910812869559       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910812869210       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910812870785       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 5.156863e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0907e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207206e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.354277
====================================================
  Execution time = 2.6185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2866e-01
  Total weights = 2.0000e+06
  Execution time = 2.7224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286613
                                         uncertainty =       0.003906121886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286613
                                         uncertainty =       0.003906121886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405376479
  error estimate for blocks of size 2^( 2) =       0.000416987030
  error estimate for blocks of size 2^( 3) =       0.000429303440
  error estimate for blocks of size 2^( 4) =       0.000441513645
  error estimate for blocks of size 2^( 5) =       0.000451287938
  error estimate for blocks of size 2^( 6) =       0.000458423145
  error estimate for blocks of size 2^( 7) =       0.000462429279

      target function =                  N/A
              le_mean =     -16.910701887421
             les_mean =     286.300498340670
             stat err =       0.000453413502
             autocorr =       1.251041753303
              std dev =       0.573288914764
             le_variance =       0.328660179791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286848
                                         uncertainty =       0.003906121884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286848
                                         uncertainty =       0.003906121884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405376479
  error estimate for blocks of size 2^( 2) =       0.000416987030
  error estimate for blocks of size 2^( 3) =       0.000429303441
  error estimate for blocks of size 2^( 4) =       0.000441513646
  error estimate for blocks of size 2^( 5) =       0.000451287938
  error estimate for blocks of size 2^( 6) =       0.000458423145
  error estimate for blocks of size 2^( 7) =       0.000462429279

      target function =                  N/A
              le_mean =     -16.910701887424
             les_mean =     286.300498341030
             stat err =       0.000453413502
             autocorr =       1.251041753086
              std dev =       0.573288914969
             le_variance =       0.328660180027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286730
                                         uncertainty =       0.003906121885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286730
                                         uncertainty =       0.003906121885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405376479
  error estimate for blocks of size 2^( 2) =       0.000416987030
  error estimate for blocks of size 2^( 3) =       0.000429303440
  error estimate for blocks of size 2^( 4) =       0.000441513646
  error estimate for blocks of size 2^( 5) =       0.000451287938
  error estimate for blocks of size 2^( 6) =       0.000458423145
  error estimate for blocks of size 2^( 7) =       0.000462429279

      target function =                  N/A
              le_mean =     -16.910701887422
             les_mean =     286.300498340850
             stat err =       0.000453413502
             autocorr =       1.251041753202
              std dev =       0.573288914867
             le_variance =       0.328660179909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286628
                                         uncertainty =       0.003906121886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328728286628
                                         uncertainty =       0.003906121886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405376479
  error estimate for blocks of size 2^( 2) =       0.000416987030
  error estimate for blocks of size 2^( 3) =       0.000429303440
  error estimate for blocks of size 2^( 4) =       0.000441513645
  error estimate for blocks of size 2^( 5) =       0.000451287938
  error estimate for blocks of size 2^( 6) =       0.000458423145
  error estimate for blocks of size 2^( 7) =       0.000462429279

      target function =                  N/A
              le_mean =     -16.910701887421
             les_mean =     286.300498340692
             stat err =       0.000453413502
             autocorr =       1.251041753287
              std dev =       0.573288914777
             le_variance =       0.328660179806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910701887421        initial
     2.4414e+05     2.4414e+06             8.2510e-10       -16.910701887424  <--
     9.7656e+05     9.7656e+06             2.0628e-10       -16.910701887422
     3.9062e+06     3.9062e+07             5.1569e-11       -16.910701887421

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 3.9901e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755955e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506494e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207205e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.272964
====================================================
  Execution time = 2.4358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342905449826
                                         uncertainty =       0.015063820271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342905449826
                                         uncertainty =       0.015063820271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414041720
  error estimate for blocks of size 2^( 2) =       0.000425716445
  error estimate for blocks of size 2^( 3) =       0.000438054194
  error estimate for blocks of size 2^( 4) =       0.000449423793
  error estimate for blocks of size 2^( 5) =       0.000459622280
  error estimate for blocks of size 2^( 6) =       0.000468366161
  error estimate for blocks of size 2^( 7) =       0.000473440100

      target function =                  N/A
              le_mean =     -16.911322876347
             les_mean =     286.335702348776
             stat err =       0.000462713084
             autocorr =       1.248922100766
              std dev =       0.585543416097
             le_variance =       0.342861092135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132287635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911322876347       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911322876362       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911322876377       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911322876340       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911322876378       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911322876313       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911322876399       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911322876426       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.472957e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911322876347       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911322876351       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911322876355       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911322876355       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911322876413       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911322876433       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911322876354       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911322876283       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 8.682432e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911322876347       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911322876348       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911322876349       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911322876349       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911322876431       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911322876161       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911322875665       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911322875707       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.170605e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0714e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819183e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506495e-03 1 1  ON 34
eH1_5                 3.079281e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207206e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.351727
====================================================
  Execution time = 2.4122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.8441e-01
  Total weights = 2.0000e+06
  Execution time = 2.7145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597715088
                                         uncertainty =       0.046459818189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597715088
                                         uncertainty =       0.046459818189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438412786
  error estimate for blocks of size 2^( 2) =       0.000449853401
  error estimate for blocks of size 2^( 3) =       0.000461104285
  error estimate for blocks of size 2^( 4) =       0.000472623109
  error estimate for blocks of size 2^( 5) =       0.000482255479
  error estimate for blocks of size 2^( 6) =       0.000491304588
  error estimate for blocks of size 2^( 7) =       0.000494856131

      target function =                  N/A
              le_mean =     -16.911169166225
             les_mean =     286.372053918270
             stat err =       0.000485259827
             autocorr =       1.225130226151
              std dev =       0.620009307824
             le_variance =       0.384411541789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597717440
                                         uncertainty =       0.046459818358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597717440
                                         uncertainty =       0.046459818358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438412787
  error estimate for blocks of size 2^( 2) =       0.000449853402
  error estimate for blocks of size 2^( 3) =       0.000461104286
  error estimate for blocks of size 2^( 4) =       0.000472623110
  error estimate for blocks of size 2^( 5) =       0.000482255480
  error estimate for blocks of size 2^( 6) =       0.000491304589
  error estimate for blocks of size 2^( 7) =       0.000494856132

      target function =                  N/A
              le_mean =     -16.911169166230
             les_mean =     286.372053920766
             stat err =       0.000485259828
             autocorr =       1.225130224120
              std dev =       0.620009309720
             le_variance =       0.384411544139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597716264
                                         uncertainty =       0.046459818273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597716264
                                         uncertainty =       0.046459818273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438412787
  error estimate for blocks of size 2^( 2) =       0.000449853401
  error estimate for blocks of size 2^( 3) =       0.000461104285
  error estimate for blocks of size 2^( 4) =       0.000472623109
  error estimate for blocks of size 2^( 5) =       0.000482255480
  error estimate for blocks of size 2^( 6) =       0.000491304588
  error estimate for blocks of size 2^( 7) =       0.000494856132

      target function =                  N/A
              le_mean =     -16.911169166227
             les_mean =     286.372053919518
             stat err =       0.000485259827
             autocorr =       1.225130225135
              std dev =       0.620009308772
             le_variance =       0.384411542964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597715235
                                         uncertainty =       0.046459818200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384597715235
                                         uncertainty =       0.046459818200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438412786
  error estimate for blocks of size 2^( 2) =       0.000449853401
  error estimate for blocks of size 2^( 3) =       0.000461104285
  error estimate for blocks of size 2^( 4) =       0.000472623109
  error estimate for blocks of size 2^( 5) =       0.000482255479
  error estimate for blocks of size 2^( 6) =       0.000491304588
  error estimate for blocks of size 2^( 7) =       0.000494856131

      target function =                  N/A
              le_mean =     -16.911169166226
             les_mean =     286.372053918426
             stat err =       0.000485259827
             autocorr =       1.225130226028
              std dev =       0.620009307943
             le_variance =       0.384411541936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911169166225        initial
     6.1035e+04     6.1035e+05             3.4730e-09       -16.911169166230  <--
     2.4414e+05     2.4414e+06             8.6824e-10       -16.911169166227
     9.7656e+05     9.7656e+06             2.1706e-10       -16.911169166226

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 3.7804e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.3797
    reference variance = 17.6318
====================================================
  Execution time = 2.4243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3034e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329269364464
                                         uncertainty =       0.004310654467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329269364464
                                         uncertainty =       0.004310654467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406412049
  error estimate for blocks of size 2^( 2) =       0.000417251366
  error estimate for blocks of size 2^( 3) =       0.000429681472
  error estimate for blocks of size 2^( 4) =       0.000440942520
  error estimate for blocks of size 2^( 5) =       0.000450416251
  error estimate for blocks of size 2^( 6) =       0.000458035268
  error estimate for blocks of size 2^( 7) =       0.000459273972

      target function =                  N/A
              le_mean =     -16.912024326514
             les_mean =     286.346908162367
             stat err =       0.000452167003
             autocorr =       1.237840198788
              std dev =       0.574753431437
             le_variance =       0.330341506948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691202432651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912024326514       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912024326559       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912024326586       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912024326588       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912024326602       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912024326608       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912024326618       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912024326638       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.227225e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912024326514       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912024326525       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912024326532       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912024326568       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912024326579       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912024326552       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912024326537       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912024326536       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.068119e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912024326514       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912024326516       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912024326518       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912024326718       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912024326486       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912024326520       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912024326764       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912024326530       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 7.670339e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0707e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506497e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541860e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952065e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207223e-04 1 1  ON 44
eH2_5                 3.535164e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8608
    reference variance = 0.207998
====================================================
  Execution time = 2.4141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2965e-01
  Total weights = 2.0000e+06
  Execution time = 2.7408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676446884
                                         uncertainty =       0.003670198704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676446884
                                         uncertainty =       0.003670198704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405983873
  error estimate for blocks of size 2^( 2) =       0.000417939294
  error estimate for blocks of size 2^( 3) =       0.000429937428
  error estimate for blocks of size 2^( 4) =       0.000441846528
  error estimate for blocks of size 2^( 5) =       0.000453175618
  error estimate for blocks of size 2^( 6) =       0.000461615350
  error estimate for blocks of size 2^( 7) =       0.000466964068

      target function =                  N/A
              le_mean =     -16.910499207803
             les_mean =     286.294629101996
             stat err =       0.000455900391
             autocorr =       1.261021133704
              std dev =       0.574147898826
             le_variance =       0.329645809727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676448741
                                         uncertainty =       0.003670198673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676448741
                                         uncertainty =       0.003670198673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405983874
  error estimate for blocks of size 2^( 2) =       0.000417939295
  error estimate for blocks of size 2^( 3) =       0.000429937429
  error estimate for blocks of size 2^( 4) =       0.000441846529
  error estimate for blocks of size 2^( 5) =       0.000453175619
  error estimate for blocks of size 2^( 6) =       0.000461615350
  error estimate for blocks of size 2^( 7) =       0.000466964068

      target function =                  N/A
              le_mean =     -16.910499207792
             les_mean =     286.294629103501
             stat err =       0.000455900392
             autocorr =       1.261021131522
              std dev =       0.574147900448
             le_variance =       0.329645811589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676447813
                                         uncertainty =       0.003670198689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676447813
                                         uncertainty =       0.003670198689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405983873
  error estimate for blocks of size 2^( 2) =       0.000417939294
  error estimate for blocks of size 2^( 3) =       0.000429937428
  error estimate for blocks of size 2^( 4) =       0.000441846529
  error estimate for blocks of size 2^( 5) =       0.000453175618
  error estimate for blocks of size 2^( 6) =       0.000461615350
  error estimate for blocks of size 2^( 7) =       0.000466964068

      target function =                  N/A
              le_mean =     -16.910499207797
             les_mean =     286.294629102749
             stat err =       0.000455900391
             autocorr =       1.261021132609
              std dev =       0.574147899637
             le_variance =       0.329645810658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676447000
                                         uncertainty =       0.003670198703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329676447000
                                         uncertainty =       0.003670198703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405983873
  error estimate for blocks of size 2^( 2) =       0.000417939294
  error estimate for blocks of size 2^( 3) =       0.000429937428
  error estimate for blocks of size 2^( 4) =       0.000441846528
  error estimate for blocks of size 2^( 5) =       0.000453175618
  error estimate for blocks of size 2^( 6) =       0.000461615350
  error estimate for blocks of size 2^( 7) =       0.000466964068

      target function =                  N/A
              le_mean =     -16.910499207802
             les_mean =     286.294629102090
             stat err =       0.000455900391
             autocorr =       1.261021133566
              std dev =       0.574147898928
             le_variance =       0.329645809843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910499207803        initial  <--
     1.5259e+04     1.5259e+05             1.2272e-08       -16.910499207792
     6.1035e+04     6.1035e+05             3.0681e-09       -16.910499207797
     2.4414e+05     2.4414e+06             7.6703e-10       -16.910499207802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.9162
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6937e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9549
    reference variance = 0.292784
====================================================
  Execution time = 2.4240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344032106146
                                         uncertainty =       0.008591085265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344032106146
                                         uncertainty =       0.008591085265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414716760
  error estimate for blocks of size 2^( 2) =       0.000426225542
  error estimate for blocks of size 2^( 3) =       0.000437620754
  error estimate for blocks of size 2^( 4) =       0.000448680163
  error estimate for blocks of size 2^( 5) =       0.000459591200
  error estimate for blocks of size 2^( 6) =       0.000468195255
  error estimate for blocks of size 2^( 7) =       0.000471756494

      target function =                  N/A
              le_mean =     -16.910594097019
             les_mean =     286.312172524318
             stat err =       0.000462055778
             autocorr =       1.241325384037
              std dev =       0.586498066641
             le_variance =       0.343979982174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691059409702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910594097019       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910594097021       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910594097020       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910594097021       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910594097028       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910594096995       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910594097023       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.301114e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910594097019       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910594097020       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910594097019       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910594097020       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910594097130       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910594097103       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910594097334       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.252787e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910594097019       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910594097019       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910594097019       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910594097812       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910594096421       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910594096966       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910594098691       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 8.131964e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0594e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755953e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207213e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.420364
====================================================
  Execution time = 2.3995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2378e-01
  Total weights = 2.0000e+06
  Execution time = 2.7199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540378
                                         uncertainty =       0.003031836421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540378
                                         uncertainty =       0.003031836421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402357665
  error estimate for blocks of size 2^( 2) =       0.000414240937
  error estimate for blocks of size 2^( 3) =       0.000426241515
  error estimate for blocks of size 2^( 4) =       0.000438214762
  error estimate for blocks of size 2^( 5) =       0.000449928456
  error estimate for blocks of size 2^( 6) =       0.000458520676
  error estimate for blocks of size 2^( 7) =       0.000465760003

      target function =                  N/A
              le_mean =     -16.910477216325
             les_mean =     286.288022903433
             stat err =       0.000453105974
             autocorr =       1.268162824700
              std dev =       0.569019667035
             le_variance =       0.323783381473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540176
                                         uncertainty =       0.003031836419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540176
                                         uncertainty =       0.003031836419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402357665
  error estimate for blocks of size 2^( 2) =       0.000414240937
  error estimate for blocks of size 2^( 3) =       0.000426241515
  error estimate for blocks of size 2^( 4) =       0.000438214761
  error estimate for blocks of size 2^( 5) =       0.000449928455
  error estimate for blocks of size 2^( 6) =       0.000458520676
  error estimate for blocks of size 2^( 7) =       0.000465760003

      target function =                  N/A
              le_mean =     -16.910477216323
             les_mean =     286.288022903149
             stat err =       0.000453105974
             autocorr =       1.268162824920
              std dev =       0.569019666857
             le_variance =       0.323783381270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540277
                                         uncertainty =       0.003031836420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540277
                                         uncertainty =       0.003031836420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402357665
  error estimate for blocks of size 2^( 2) =       0.000414240937
  error estimate for blocks of size 2^( 3) =       0.000426241515
  error estimate for blocks of size 2^( 4) =       0.000438214762
  error estimate for blocks of size 2^( 5) =       0.000449928456
  error estimate for blocks of size 2^( 6) =       0.000458520676
  error estimate for blocks of size 2^( 7) =       0.000465760003

      target function =                  N/A
              le_mean =     -16.910477216324
             les_mean =     286.288022903291
             stat err =       0.000453105974
             autocorr =       1.268162824812
              std dev =       0.569019666946
             le_variance =       0.323783381371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540366
                                         uncertainty =       0.003031836421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323711540366
                                         uncertainty =       0.003031836421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402357665
  error estimate for blocks of size 2^( 2) =       0.000414240937
  error estimate for blocks of size 2^( 3) =       0.000426241515
  error estimate for blocks of size 2^( 4) =       0.000438214762
  error estimate for blocks of size 2^( 5) =       0.000449928456
  error estimate for blocks of size 2^( 6) =       0.000458520676
  error estimate for blocks of size 2^( 7) =       0.000465760003

      target function =                  N/A
              le_mean =     -16.910477216325
             les_mean =     286.288022903415
             stat err =       0.000453105974
             autocorr =       1.268162824718
              std dev =       0.569019667024
             le_variance =       0.323783381460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910477216325        initial  <--
     1.5259e+05     1.5259e+06             1.3011e-09       -16.910477216323
     6.1035e+05     6.1035e+06             3.2528e-10       -16.910477216324
     2.4414e+06     2.4414e+07             8.1320e-11       -16.910477216325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6763
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6936e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.87
    reference variance = 0.338119
====================================================
  Execution time = 2.4110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2897e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329083660302
                                         uncertainty =       0.005024834467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329083660302
                                         uncertainty =       0.005024834467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405568967
  error estimate for blocks of size 2^( 2) =       0.000417256265
  error estimate for blocks of size 2^( 3) =       0.000429536916
  error estimate for blocks of size 2^( 4) =       0.000440749146
  error estimate for blocks of size 2^( 5) =       0.000451058084
  error estimate for blocks of size 2^( 6) =       0.000460367591
  error estimate for blocks of size 2^( 7) =       0.000465208408

      target function =                  N/A
              le_mean =     -16.911013027800
             les_mean =     286.311333836177
             stat err =       0.000454345807
             autocorr =       1.254999681166
              std dev =       0.573561133844
             le_variance =       0.328972374256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691101302780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911013027800       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911013027800       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911013027800       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911013027109       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911013027800       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911013027879       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911013027842       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911013026805       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.445665e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911013027800       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911013027800       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911013027800       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911013025568       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911013027797       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911013027800       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911013032427       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911013024859       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.614180e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911013027800       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911013027800       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911013027800       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911013039999       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911013027800       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911013030169       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911013028900       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911013012128       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 9.035485e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0446e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9565
    reference variance = 0.206345
====================================================
  Execution time = 2.3919e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3183e-01
  Total weights = 2.0000e+06
  Execution time = 2.7302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749394
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749394
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325339
  error estimate for blocks of size 2^( 2) =       0.000419709015
  error estimate for blocks of size 2^( 3) =       0.000432139203
  error estimate for blocks of size 2^( 4) =       0.000443945694
  error estimate for blocks of size 2^( 5) =       0.000455910050
  error estimate for blocks of size 2^( 6) =       0.000465517741
  error estimate for blocks of size 2^( 7) =       0.000473068000

      target function =                  N/A
              le_mean =     -16.910520526312
             les_mean =     286.297532168741
             stat err =       0.000459610371
             autocorr =       1.273200453265
              std dev =       0.576045018942
             le_variance =       0.331827863848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749304
                                         uncertainty =       0.003675018335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749304
                                         uncertainty =       0.003675018335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325339
  error estimate for blocks of size 2^( 2) =       0.000419709015
  error estimate for blocks of size 2^( 3) =       0.000432139203
  error estimate for blocks of size 2^( 4) =       0.000443945694
  error estimate for blocks of size 2^( 5) =       0.000455910050
  error estimate for blocks of size 2^( 6) =       0.000465517741
  error estimate for blocks of size 2^( 7) =       0.000473068000

      target function =                  N/A
              le_mean =     -16.910520526312
             les_mean =     286.297532168675
             stat err =       0.000459610371
             autocorr =       1.273200453318
              std dev =       0.576045018863
             le_variance =       0.331827863757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749349
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749349
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325339
  error estimate for blocks of size 2^( 2) =       0.000419709015
  error estimate for blocks of size 2^( 3) =       0.000432139203
  error estimate for blocks of size 2^( 4) =       0.000443945694
  error estimate for blocks of size 2^( 5) =       0.000455910050
  error estimate for blocks of size 2^( 6) =       0.000465517741
  error estimate for blocks of size 2^( 7) =       0.000473068000

      target function =                  N/A
              le_mean =     -16.910520526312
             les_mean =     286.297532168708
             stat err =       0.000459610371
             autocorr =       1.273200453286
              std dev =       0.576045018903
             le_variance =       0.331827863802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749389
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331844749389
                                         uncertainty =       0.003675018336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325339
  error estimate for blocks of size 2^( 2) =       0.000419709015
  error estimate for blocks of size 2^( 3) =       0.000432139203
  error estimate for blocks of size 2^( 4) =       0.000443945694
  error estimate for blocks of size 2^( 5) =       0.000455910050
  error estimate for blocks of size 2^( 6) =       0.000465517741
  error estimate for blocks of size 2^( 7) =       0.000473068000

      target function =                  N/A
              le_mean =     -16.910520526312
             les_mean =     286.297532168737
             stat err =       0.000459610371
             autocorr =       1.273200453269
              std dev =       0.576045018937
             le_variance =       0.331827863842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910520526312        initial
     1.5259e+06     1.5259e+07             1.4457e-10       -16.910520526312  <--
     6.1035e+06     6.1035e+07             3.6142e-11       -16.910520526312
     2.4414e+07     2.4414e+08             9.0355e-12       -16.910520526312

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 3.9564e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6935e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8497
    reference variance = 0.180289
====================================================
  Execution time = 2.4152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3287e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333000955157
                                         uncertainty =       0.007409614901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333000955157
                                         uncertainty =       0.007409614901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407966483
  error estimate for blocks of size 2^( 2) =       0.000419751435
  error estimate for blocks of size 2^( 3) =       0.000431748578
  error estimate for blocks of size 2^( 4) =       0.000444260008
  error estimate for blocks of size 2^( 5) =       0.000454964185
  error estimate for blocks of size 2^( 6) =       0.000462654237
  error estimate for blocks of size 2^( 7) =       0.000467640588

      target function =                  N/A
              le_mean =     -16.910931524165
             les_mean =     286.312478150283
             stat err =       0.000457379755
             autocorr =       1.256912096911
              std dev =       0.576951732575
             le_variance =       0.332873301721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691093152417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931524165       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910931524167       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910931524168       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910931524204       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910931523801       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910931524291       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910931524292       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910931524162       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.851309e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931524165       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910931524166       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910931524166       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910931524166       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910931524166       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910931524284       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910931523802       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910931526047       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.462827e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910931524165       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910931524165       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910931524165       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910931524165       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910931524733       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910931521637       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910931522409       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910931524943       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.657065e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0563e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795168e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8511
    reference variance = 0.23924
====================================================
  Execution time = 2.3937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.0000e+06
  Execution time = 2.7229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365813
                                         uncertainty =       0.004581067781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365813
                                         uncertainty =       0.004581067781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085942
  error estimate for blocks of size 2^( 2) =       0.000421493013
  error estimate for blocks of size 2^( 3) =       0.000433450063
  error estimate for blocks of size 2^( 4) =       0.000444889752
  error estimate for blocks of size 2^( 5) =       0.000455377078
  error estimate for blocks of size 2^( 6) =       0.000461999835
  error estimate for blocks of size 2^( 7) =       0.000468318492

      target function =                  N/A
              le_mean =     -16.911095246437
             les_mean =     286.321483225630
             stat err =       0.000457646289
             autocorr =       1.245403629080
              std dev =       0.579949100987
             le_variance =       0.336340959735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331366013
                                         uncertainty =       0.004581067787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331366013
                                         uncertainty =       0.004581067787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085942
  error estimate for blocks of size 2^( 2) =       0.000421493013
  error estimate for blocks of size 2^( 3) =       0.000433450064
  error estimate for blocks of size 2^( 4) =       0.000444889752
  error estimate for blocks of size 2^( 5) =       0.000455377078
  error estimate for blocks of size 2^( 6) =       0.000461999835
  error estimate for blocks of size 2^( 7) =       0.000468318492

      target function =                  N/A
              le_mean =     -16.911095246438
             les_mean =     286.321483225848
             stat err =       0.000457646289
             autocorr =       1.245403628809
              std dev =       0.579949101159
             le_variance =       0.336340959935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365913
                                         uncertainty =       0.004581067784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365913
                                         uncertainty =       0.004581067784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085942
  error estimate for blocks of size 2^( 2) =       0.000421493013
  error estimate for blocks of size 2^( 3) =       0.000433450064
  error estimate for blocks of size 2^( 4) =       0.000444889752
  error estimate for blocks of size 2^( 5) =       0.000455377078
  error estimate for blocks of size 2^( 6) =       0.000461999835
  error estimate for blocks of size 2^( 7) =       0.000468318492

      target function =                  N/A
              le_mean =     -16.911095246437
             les_mean =     286.321483225739
             stat err =       0.000457646289
             autocorr =       1.245403628952
              std dev =       0.579949101073
             le_variance =       0.336340959835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365826
                                         uncertainty =       0.004581067782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336331365826
                                         uncertainty =       0.004581067782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085942
  error estimate for blocks of size 2^( 2) =       0.000421493013
  error estimate for blocks of size 2^( 3) =       0.000433450063
  error estimate for blocks of size 2^( 4) =       0.000444889752
  error estimate for blocks of size 2^( 5) =       0.000455377078
  error estimate for blocks of size 2^( 6) =       0.000461999835
  error estimate for blocks of size 2^( 7) =       0.000468318492

      target function =                  N/A
              le_mean =     -16.911095246437
             les_mean =     286.321483225644
             stat err =       0.000457646289
             autocorr =       1.245403629060
              std dev =       0.579949100998
             le_variance =       0.336340959748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911095246437        initial
     3.8147e+05     3.8147e+06             5.8513e-10       -16.911095246438  <--
     1.5259e+06     1.5259e+07             1.4628e-10       -16.911095246437
     6.1035e+06     6.1035e+07             3.6571e-11       -16.911095246437

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 3.7647e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207212e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9776
    reference variance = 0.300682
====================================================
  Execution time = 2.4203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3729e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344784626
                                         uncertainty =       0.007421209597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344784626
                                         uncertainty =       0.007421209597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410661239
  error estimate for blocks of size 2^( 2) =       0.000422235331
  error estimate for blocks of size 2^( 3) =       0.000434474958
  error estimate for blocks of size 2^( 4) =       0.000446653867
  error estimate for blocks of size 2^( 5) =       0.000457828680
  error estimate for blocks of size 2^( 6) =       0.000465217147
  error estimate for blocks of size 2^( 7) =       0.000473720734

      target function =                  N/A
              le_mean =     -16.911205817407
             les_mean =     286.326167336435
             stat err =       0.000460855107
             autocorr =       1.259393311946
              std dev =       0.580762693684
             le_variance =       0.337285306375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691120581741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911205817407       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911205817414       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911205817419       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911205817420       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911205817415       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911205817378       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911205817403       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 1.905528e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911205817407       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911205817409       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911205817410       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911205817410       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911205817347       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911205817249       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911205817367       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 4.763821e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911205817407       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911205817408       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911205817408       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911205817364       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911205817793       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911205817267       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911205816826       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.190956e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0567e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207210e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.186946
====================================================
  Execution time = 2.4112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2906e-01
  Total weights = 2.0000e+06
  Execution time = 2.7118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866777
                                         uncertainty =       0.004197845935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866777
                                         uncertainty =       0.004197845935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405624828
  error estimate for blocks of size 2^( 2) =       0.000417524600
  error estimate for blocks of size 2^( 3) =       0.000429653680
  error estimate for blocks of size 2^( 4) =       0.000440984650
  error estimate for blocks of size 2^( 5) =       0.000452794511
  error estimate for blocks of size 2^( 6) =       0.000460174792
  error estimate for blocks of size 2^( 7) =       0.000462438543

      target function =                  N/A
              le_mean =     -16.910457455878
             les_mean =     286.292634204696
             stat err =       0.000454098124
             autocorr =       1.253286483225
              std dev =       0.573640132992
             le_variance =       0.329063002179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866551
                                         uncertainty =       0.004197845926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866551
                                         uncertainty =       0.004197845926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405624828
  error estimate for blocks of size 2^( 2) =       0.000417524600
  error estimate for blocks of size 2^( 3) =       0.000429653680
  error estimate for blocks of size 2^( 4) =       0.000440984650
  error estimate for blocks of size 2^( 5) =       0.000452794511
  error estimate for blocks of size 2^( 6) =       0.000460174792
  error estimate for blocks of size 2^( 7) =       0.000462438543

      target function =                  N/A
              le_mean =     -16.910457455877
             les_mean =     286.292634204460
             stat err =       0.000454098124
             autocorr =       1.253286483464
              std dev =       0.573640132794
             le_variance =       0.329063001952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866664
                                         uncertainty =       0.004197845930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866664
                                         uncertainty =       0.004197845930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405624828
  error estimate for blocks of size 2^( 2) =       0.000417524600
  error estimate for blocks of size 2^( 3) =       0.000429653680
  error estimate for blocks of size 2^( 4) =       0.000440984650
  error estimate for blocks of size 2^( 5) =       0.000452794511
  error estimate for blocks of size 2^( 6) =       0.000460174792
  error estimate for blocks of size 2^( 7) =       0.000462438543

      target function =                  N/A
              le_mean =     -16.910457455878
             les_mean =     286.292634204578
             stat err =       0.000454098124
             autocorr =       1.253286483343
              std dev =       0.573640132893
             le_variance =       0.329063002065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866763
                                         uncertainty =       0.004197845935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329078866763
                                         uncertainty =       0.004197845935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405624828
  error estimate for blocks of size 2^( 2) =       0.000417524600
  error estimate for blocks of size 2^( 3) =       0.000429653680
  error estimate for blocks of size 2^( 4) =       0.000440984650
  error estimate for blocks of size 2^( 5) =       0.000452794511
  error estimate for blocks of size 2^( 6) =       0.000460174792
  error estimate for blocks of size 2^( 7) =       0.000462438543

      target function =                  N/A
              le_mean =     -16.910457455878
             les_mean =     286.292634204681
             stat err =       0.000454098124
             autocorr =       1.253286483239
              std dev =       0.573640132979
             le_variance =       0.329063002165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910457455878        initial  <--
     9.5367e+04     9.5367e+05             1.9055e-09       -16.910457455877
     3.8147e+05     3.8147e+06             4.7638e-10       -16.910457455878
     1.5259e+06     1.5259e+07             1.1910e-10       -16.910457455878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.7555
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207212e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8257
    reference variance = 0.194705
====================================================
  Execution time = 2.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.6831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368447179400
                                         uncertainty =       0.036230487456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368447179400
                                         uncertainty =       0.036230487456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429134462
  error estimate for blocks of size 2^( 2) =       0.000440278790
  error estimate for blocks of size 2^( 3) =       0.000451880085
  error estimate for blocks of size 2^( 4) =       0.000463307507
  error estimate for blocks of size 2^( 5) =       0.000473534651
  error estimate for blocks of size 2^( 6) =       0.000480691791
  error estimate for blocks of size 2^( 7) =       0.000485433297

      target function =                  N/A
              le_mean =     -16.911018351187
             les_mean =     286.350854262632
             stat err =       0.000475741812
             autocorr =       1.229011255316
              std dev =       0.606887775957
             le_variance =       0.368312772606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691101835119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018351187       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018351187       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018351187       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018351502       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018351424       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911018351156       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911018350977       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911018351171       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.174388e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018351187       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018351187       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018351187       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018351187       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018351440       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911018350688       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911018352624       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911018349885       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.435988e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018351187       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018351187       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018351187       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018351187       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018355367       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911018347547       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911018347132       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911018346332       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.358989e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0721e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207212e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9354
    reference variance = 0.372284
====================================================
  Execution time = 2.3803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3068e-01
  Total weights = 2.0000e+06
  Execution time = 2.7285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967920
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967920
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406619984
  error estimate for blocks of size 2^( 2) =       0.000418374856
  error estimate for blocks of size 2^( 3) =       0.000430254808
  error estimate for blocks of size 2^( 4) =       0.000442799997
  error estimate for blocks of size 2^( 5) =       0.000453556614
  error estimate for blocks of size 2^( 6) =       0.000465380412
  error estimate for blocks of size 2^( 7) =       0.000473851943

      target function =                  N/A
              le_mean =     -16.912032877404
             les_mean =     286.347535503739
             stat err =       0.000458897241
             autocorr =       1.273659843153
              std dev =       0.575047496028
             le_variance =       0.330679622688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967996
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967996
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406619984
  error estimate for blocks of size 2^( 2) =       0.000418374856
  error estimate for blocks of size 2^( 3) =       0.000430254808
  error estimate for blocks of size 2^( 4) =       0.000442799997
  error estimate for blocks of size 2^( 5) =       0.000453556614
  error estimate for blocks of size 2^( 6) =       0.000465380412
  error estimate for blocks of size 2^( 7) =       0.000473851943

      target function =                  N/A
              le_mean =     -16.912032877405
             les_mean =     286.347535503847
             stat err =       0.000458897241
             autocorr =       1.273659843048
              std dev =       0.575047496093
             le_variance =       0.330679622763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967958
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967958
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406619984
  error estimate for blocks of size 2^( 2) =       0.000418374856
  error estimate for blocks of size 2^( 3) =       0.000430254808
  error estimate for blocks of size 2^( 4) =       0.000442799997
  error estimate for blocks of size 2^( 5) =       0.000453556614
  error estimate for blocks of size 2^( 6) =       0.000465380412
  error estimate for blocks of size 2^( 7) =       0.000473851943

      target function =                  N/A
              le_mean =     -16.912032877404
             les_mean =     286.347535503793
             stat err =       0.000458897241
             autocorr =       1.273659843095
              std dev =       0.575047496060
             le_variance =       0.330679622725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967925
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330605967925
                                         uncertainty =       0.004070626080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406619984
  error estimate for blocks of size 2^( 2) =       0.000418374856
  error estimate for blocks of size 2^( 3) =       0.000430254808
  error estimate for blocks of size 2^( 4) =       0.000442799997
  error estimate for blocks of size 2^( 5) =       0.000453556614
  error estimate for blocks of size 2^( 6) =       0.000465380412
  error estimate for blocks of size 2^( 7) =       0.000473851943

      target function =                  N/A
              le_mean =     -16.912032877404
             les_mean =     286.347535503746
             stat err =       0.000458897241
             autocorr =       1.273659843143
              std dev =       0.575047496032
             le_variance =       0.330679622692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.912032877404        initial
     9.5367e+05     9.5367e+06             2.1744e-10       -16.912032877405  <--
     3.8147e+06     3.8147e+07             5.4360e-11       -16.912032877404
     1.5259e+07     1.5259e+08             1.3590e-11       -16.912032877404

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 3.7542e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9108
    reference variance = 0.245291
====================================================
  Execution time = 2.4369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2804e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328162574172
                                         uncertainty =       0.004380610337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328162574172
                                         uncertainty =       0.004380610337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404993006
  error estimate for blocks of size 2^( 2) =       0.000417076544
  error estimate for blocks of size 2^( 3) =       0.000430133959
  error estimate for blocks of size 2^( 4) =       0.000441955678
  error estimate for blocks of size 2^( 5) =       0.000453593321
  error estimate for blocks of size 2^( 6) =       0.000464013990
  error estimate for blocks of size 2^( 7) =       0.000469292879

      target function =                  N/A
              le_mean =     -16.910771785633
             les_mean =     286.302240891436
             stat err =       0.000457213967
             autocorr =       1.274512005852
              std dev =       0.572746601653
             le_variance =       0.328038669705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691077178563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910771785633       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910771785635       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910771785637       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910771785635       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910771785702       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910771785482       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910771785695       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.932679e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910771785633       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910771785633       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910771785634       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910771785677       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910771785634       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910771785485       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910771785821       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.483172e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910771785633       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910771785633       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910771785633       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910771785633       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910771785011       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910771785847       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910771785178       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.207922e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0811e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8888
    reference variance = 0.649618
====================================================
  Execution time = 2.3962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4865e-01
  Total weights = 2.0000e+06
  Execution time = 2.7170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651372
                                         uncertainty =       0.008740037584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651372
                                         uncertainty =       0.008740037584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417525527
  error estimate for blocks of size 2^( 2) =       0.000429099272
  error estimate for blocks of size 2^( 3) =       0.000441193116
  error estimate for blocks of size 2^( 4) =       0.000453950662
  error estimate for blocks of size 2^( 5) =       0.000465284613
  error estimate for blocks of size 2^( 6) =       0.000474071787
  error estimate for blocks of size 2^( 7) =       0.000482252539

      target function =                  N/A
              le_mean =     -16.910612581412
             les_mean =     286.317472836506
             stat err =       0.000468889900
             autocorr =       1.261175977939
              std dev =       0.590470263610
             le_variance =       0.348655132208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561650889
                                         uncertainty =       0.008740037586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561650889
                                         uncertainty =       0.008740037586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417525527
  error estimate for blocks of size 2^( 2) =       0.000429099271
  error estimate for blocks of size 2^( 3) =       0.000441193116
  error estimate for blocks of size 2^( 4) =       0.000453950662
  error estimate for blocks of size 2^( 5) =       0.000465284613
  error estimate for blocks of size 2^( 6) =       0.000474071787
  error estimate for blocks of size 2^( 7) =       0.000482252539

      target function =                  N/A
              le_mean =     -16.910612581412
             les_mean =     286.317472836010
             stat err =       0.000468889900
             autocorr =       1.261175978316
              std dev =       0.590470263202
             le_variance =       0.348655131726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651131
                                         uncertainty =       0.008740037585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651131
                                         uncertainty =       0.008740037585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417525527
  error estimate for blocks of size 2^( 2) =       0.000429099272
  error estimate for blocks of size 2^( 3) =       0.000441193116
  error estimate for blocks of size 2^( 4) =       0.000453950662
  error estimate for blocks of size 2^( 5) =       0.000465284613
  error estimate for blocks of size 2^( 6) =       0.000474071787
  error estimate for blocks of size 2^( 7) =       0.000482252539

      target function =                  N/A
              le_mean =     -16.910612581412
             les_mean =     286.317472836258
             stat err =       0.000468889900
             autocorr =       1.261175978116
              std dev =       0.590470263406
             le_variance =       0.348655131967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651342
                                         uncertainty =       0.008740037584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348561651342
                                         uncertainty =       0.008740037584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417525527
  error estimate for blocks of size 2^( 2) =       0.000429099272
  error estimate for blocks of size 2^( 3) =       0.000441193116
  error estimate for blocks of size 2^( 4) =       0.000453950662
  error estimate for blocks of size 2^( 5) =       0.000465284613
  error estimate for blocks of size 2^( 6) =       0.000474071787
  error estimate for blocks of size 2^( 7) =       0.000482252539

      target function =                  N/A
              le_mean =     -16.910612581412
             les_mean =     286.317472836475
             stat err =       0.000468889900
             autocorr =       1.261175977957
              std dev =       0.590470263585
             le_variance =       0.348655132178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910612581412        initial  <--
     2.3842e+05     2.3842e+06             9.9327e-10       -16.910612581412
     9.5367e+05     9.5367e+06             2.4832e-10       -16.910612581412
     3.8147e+06     3.8147e+07             6.2079e-11       -16.910612581412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6552
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0288
    reference variance = 0.586464
====================================================
  Execution time = 2.6637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2729e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327267098118
                                         uncertainty =       0.002787187265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327267098118
                                         uncertainty =       0.002787187265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404529548
  error estimate for blocks of size 2^( 2) =       0.000416166294
  error estimate for blocks of size 2^( 3) =       0.000428398172
  error estimate for blocks of size 2^( 4) =       0.000439728437
  error estimate for blocks of size 2^( 5) =       0.000450203973
  error estimate for blocks of size 2^( 6) =       0.000457282864
  error estimate for blocks of size 2^( 7) =       0.000463770590

      target function =                  N/A
              le_mean =     -16.910441538558
             les_mean =     286.290321175685
             stat err =       0.000452746466
             autocorr =       1.252592016832
              std dev =       0.572091173089
             le_variance =       0.327288310326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044153856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910441538558       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910441538558       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910441538558       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910441538517       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910441538833       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910441538952       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910441537318       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910441539553       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 9.020658e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910441538558       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910441538558       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910441538558       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910441538558       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910441539327       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910441543531       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910441539734       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910441536815       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.255188e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910441538558       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910441538558       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910441538558       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910441549149       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910441539308       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910441549174       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910441549447       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910441585335       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.637511e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3025e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8722
    reference variance = 0.143924
====================================================
  Execution time = 2.3860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3090e-01
  Total weights = 2.0000e+06
  Execution time = 2.7238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235022
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235022
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406755058
  error estimate for blocks of size 2^( 2) =       0.000418460474
  error estimate for blocks of size 2^( 3) =       0.000430795632
  error estimate for blocks of size 2^( 4) =       0.000442871553
  error estimate for blocks of size 2^( 5) =       0.000454977022
  error estimate for blocks of size 2^( 6) =       0.000465203019
  error estimate for blocks of size 2^( 7) =       0.000469936960

      target function =                  N/A
              le_mean =     -16.910311176764
             les_mean =     286.289523283183
             stat err =       0.000458247138
             autocorr =       1.269210334889
              std dev =       0.575238518921
             le_variance =       0.330899353651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235057
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235057
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406755058
  error estimate for blocks of size 2^( 2) =       0.000418460474
  error estimate for blocks of size 2^( 3) =       0.000430795632
  error estimate for blocks of size 2^( 4) =       0.000442871553
  error estimate for blocks of size 2^( 5) =       0.000454977022
  error estimate for blocks of size 2^( 6) =       0.000465203019
  error estimate for blocks of size 2^( 7) =       0.000469936960

      target function =                  N/A
              le_mean =     -16.910311176764
             les_mean =     286.289523283219
             stat err =       0.000458247138
             autocorr =       1.269210334847
              std dev =       0.575238518951
             le_variance =       0.330899353685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235039
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235039
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406755058
  error estimate for blocks of size 2^( 2) =       0.000418460474
  error estimate for blocks of size 2^( 3) =       0.000430795632
  error estimate for blocks of size 2^( 4) =       0.000442871553
  error estimate for blocks of size 2^( 5) =       0.000454977022
  error estimate for blocks of size 2^( 6) =       0.000465203019
  error estimate for blocks of size 2^( 7) =       0.000469936960

      target function =                  N/A
              le_mean =     -16.910311176764
             les_mean =     286.289523283201
             stat err =       0.000458247138
             autocorr =       1.269210334869
              std dev =       0.575238518936
             le_variance =       0.330899353668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235024
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330943235024
                                         uncertainty =       0.005376721257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406755058
  error estimate for blocks of size 2^( 2) =       0.000418460474
  error estimate for blocks of size 2^( 3) =       0.000430795632
  error estimate for blocks of size 2^( 4) =       0.000442871553
  error estimate for blocks of size 2^( 5) =       0.000454977022
  error estimate for blocks of size 2^( 6) =       0.000465203019
  error estimate for blocks of size 2^( 7) =       0.000469936960

      target function =                  N/A
              le_mean =     -16.910311176764
             les_mean =     286.289523283185
             stat err =       0.000458247138
             autocorr =       1.269210334889
              std dev =       0.575238518923
             le_variance =       0.330899353653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910311176764        initial
     2.3842e+06     2.3842e+07             9.0207e-11       -16.910311176764  <--
     9.5367e+06     9.5367e+07             2.2552e-11       -16.910311176764
     3.8147e+07     3.8147e+08             5.6375e-12       -16.910311176764

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 3.7546e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207212e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.190539
====================================================
  Execution time = 2.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5681e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356828478044
                                         uncertainty =       0.025927007276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356828478044
                                         uncertainty =       0.025927007276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422380615
  error estimate for blocks of size 2^( 2) =       0.000433912248
  error estimate for blocks of size 2^( 3) =       0.000446282803
  error estimate for blocks of size 2^( 4) =       0.000458231939
  error estimate for blocks of size 2^( 5) =       0.000469530919
  error estimate for blocks of size 2^( 6) =       0.000477765062
  error estimate for blocks of size 2^( 7) =       0.000485949357

      target function =                  N/A
              le_mean =     -16.910806182051
             les_mean =     286.332176315635
             stat err =       0.000472869319
             autocorr =       1.253355635295
              std dev =       0.597336393610
             le_variance =       0.356810767131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691080618205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910806182051       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910806182052       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910806182054       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910806182442       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910806182184       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910806182018       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910806182033       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910806181861       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 3.415225e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910806182051       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910806182052       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910806182052       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910806181884       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910806180953       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910806182019       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910806186337       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910806180357       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 8.538063e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910806182051       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910806182052       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910806182052       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910806177963       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910806182134       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910806182991       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910806185908       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910806180853       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.134514e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0709e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0145
    reference variance = 0.601671
====================================================
  Execution time = 2.3675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3433e-01
  Total weights = 2.0000e+06
  Execution time = 2.7285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252041
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252041
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408856236
  error estimate for blocks of size 2^( 2) =       0.000420434705
  error estimate for blocks of size 2^( 3) =       0.000431995748
  error estimate for blocks of size 2^( 4) =       0.000444224460
  error estimate for blocks of size 2^( 5) =       0.000454811181
  error estimate for blocks of size 2^( 6) =       0.000463600649
  error estimate for blocks of size 2^( 7) =       0.000468624772

      target function =                  N/A
              le_mean =     -16.910874157148
             les_mean =     286.311991434765
             stat err =       0.000457815265
             autocorr =       1.253831820706
              std dev =       0.578210033660
             le_variance =       0.334326843025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252230
                                         uncertainty =       0.006810169640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252230
                                         uncertainty =       0.006810169640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408856236
  error estimate for blocks of size 2^( 2) =       0.000420434705
  error estimate for blocks of size 2^( 3) =       0.000431995748
  error estimate for blocks of size 2^( 4) =       0.000444224460
  error estimate for blocks of size 2^( 5) =       0.000454811181
  error estimate for blocks of size 2^( 6) =       0.000463600649
  error estimate for blocks of size 2^( 7) =       0.000468624772

      target function =                  N/A
              le_mean =     -16.910874157148
             les_mean =     286.311991434962
             stat err =       0.000457815265
             autocorr =       1.253831820504
              std dev =       0.578210033823
             le_variance =       0.334326843214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252136
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252136
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408856236
  error estimate for blocks of size 2^( 2) =       0.000420434705
  error estimate for blocks of size 2^( 3) =       0.000431995748
  error estimate for blocks of size 2^( 4) =       0.000444224460
  error estimate for blocks of size 2^( 5) =       0.000454811181
  error estimate for blocks of size 2^( 6) =       0.000463600649
  error estimate for blocks of size 2^( 7) =       0.000468624772

      target function =                  N/A
              le_mean =     -16.910874157148
             les_mean =     286.311991434863
             stat err =       0.000457815265
             autocorr =       1.253831820610
              std dev =       0.578210033741
             le_variance =       0.334326843119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252053
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331252053
                                         uncertainty =       0.006810169639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408856236
  error estimate for blocks of size 2^( 2) =       0.000420434705
  error estimate for blocks of size 2^( 3) =       0.000431995748
  error estimate for blocks of size 2^( 4) =       0.000444224460
  error estimate for blocks of size 2^( 5) =       0.000454811181
  error estimate for blocks of size 2^( 6) =       0.000463600649
  error estimate for blocks of size 2^( 7) =       0.000468624772

      target function =                  N/A
              le_mean =     -16.910874157148
             les_mean =     286.311991434777
             stat err =       0.000457815265
             autocorr =       1.253831820689
              std dev =       0.578210033670
             le_variance =       0.334326843036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910874157148        initial
     5.9605e+05     5.9605e+06             3.4152e-10       -16.910874157148  <--
     2.3842e+06     2.3842e+07             8.5381e-11       -16.910874157148
     9.5367e+06     9.5367e+07             2.1345e-11       -16.910874157148

*****************************************************************************
Applying the update for shift_i =   5.9605e+05     and shift_s =   5.9605e+06
*****************************************************************************

  Execution time = 3.7400e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8436
    reference variance = 0.152601
====================================================
  Execution time = 2.4230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4101e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341000043150
                                         uncertainty =       0.007300844591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341000043150
                                         uncertainty =       0.007300844591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412920086
  error estimate for blocks of size 2^( 2) =       0.000424625623
  error estimate for blocks of size 2^( 3) =       0.000436847586
  error estimate for blocks of size 2^( 4) =       0.000448312343
  error estimate for blocks of size 2^( 5) =       0.000458213845
  error estimate for blocks of size 2^( 6) =       0.000464102306
  error estimate for blocks of size 2^( 7) =       0.000468800541

      target function =                  N/A
              le_mean =     -16.911105087329
             les_mean =     286.326481099047
             stat err =       0.000459857259
             autocorr =       1.240263815948
              std dev =       0.583957185823
             le_variance =       0.341005994874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691110508733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911105087329       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911105087331       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911105087339       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911105087395       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911105087244       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911105087252       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911105087333       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911105087274       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.672192e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911105087329       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911105087329       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911105087331       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911105087332       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911105087334       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911105086603       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911105087062       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911105087345       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.180478e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911105087329       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911105087329       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911105087329       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911105087330       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911105086082       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911105087330       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911105089078       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911105086719       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.045122e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0624e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952065e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207211e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.785
    reference variance = 0.207297
====================================================
  Execution time = 2.3925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2354e-01
  Total weights = 2.0000e+06
  Execution time = 2.7156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895670
                                         uncertainty =       0.002682229286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895670
                                         uncertainty =       0.002682229286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204771
  error estimate for blocks of size 2^( 2) =       0.000413894793
  error estimate for blocks of size 2^( 3) =       0.000426085369
  error estimate for blocks of size 2^( 4) =       0.000437970210
  error estimate for blocks of size 2^( 5) =       0.000448929808
  error estimate for blocks of size 2^( 6) =       0.000456629389
  error estimate for blocks of size 2^( 7) =       0.000462792246

      target function =                  N/A
              le_mean =     -16.910496099235
             les_mean =     286.288415515747
             stat err =       0.000451580413
             autocorr =       1.260595514927
              std dev =       0.568803441679
             le_variance =       0.323537355266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895801
                                         uncertainty =       0.002682229281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895801
                                         uncertainty =       0.002682229281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204771
  error estimate for blocks of size 2^( 2) =       0.000413894793
  error estimate for blocks of size 2^( 3) =       0.000426085369
  error estimate for blocks of size 2^( 4) =       0.000437970210
  error estimate for blocks of size 2^( 5) =       0.000448929808
  error estimate for blocks of size 2^( 6) =       0.000456629389
  error estimate for blocks of size 2^( 7) =       0.000462792246

      target function =                  N/A
              le_mean =     -16.910496099227
             les_mean =     286.288415515614
             stat err =       0.000451580413
             autocorr =       1.260595514830
              std dev =       0.568803441795
             le_variance =       0.323537355397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895735
                                         uncertainty =       0.002682229283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895735
                                         uncertainty =       0.002682229283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204771
  error estimate for blocks of size 2^( 2) =       0.000413894793
  error estimate for blocks of size 2^( 3) =       0.000426085369
  error estimate for blocks of size 2^( 4) =       0.000437970210
  error estimate for blocks of size 2^( 5) =       0.000448929808
  error estimate for blocks of size 2^( 6) =       0.000456629389
  error estimate for blocks of size 2^( 7) =       0.000462792246

      target function =                  N/A
              le_mean =     -16.910496099231
             les_mean =     286.288415515680
             stat err =       0.000451580413
             autocorr =       1.260595514876
              std dev =       0.568803441737
             le_variance =       0.323537355332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895678
                                         uncertainty =       0.002682229285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585895678
                                         uncertainty =       0.002682229285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402204771
  error estimate for blocks of size 2^( 2) =       0.000413894793
  error estimate for blocks of size 2^( 3) =       0.000426085369
  error estimate for blocks of size 2^( 4) =       0.000437970210
  error estimate for blocks of size 2^( 5) =       0.000448929808
  error estimate for blocks of size 2^( 6) =       0.000456629389
  error estimate for blocks of size 2^( 7) =       0.000462792246

      target function =                  N/A
              le_mean =     -16.910496099235
             les_mean =     286.288415515738
             stat err =       0.000451580413
             autocorr =       1.260595514924
              std dev =       0.568803441687
             le_variance =       0.323537355275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910496099235        initial  <--
     1.4901e+05     1.4901e+06             1.6722e-09       -16.910496099227
     5.9605e+05     5.9605e+06             4.1805e-10       -16.910496099231
     2.3842e+06     2.3842e+07             1.0451e-10       -16.910496099235

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5809
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.660962
====================================================
  Execution time = 2.4268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332334163157
                                         uncertainty =       0.003658312978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332334163157
                                         uncertainty =       0.003658312978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407614714
  error estimate for blocks of size 2^( 2) =       0.000419310350
  error estimate for blocks of size 2^( 3) =       0.000431946556
  error estimate for blocks of size 2^( 4) =       0.000443935048
  error estimate for blocks of size 2^( 5) =       0.000454374862
  error estimate for blocks of size 2^( 6) =       0.000461815916
  error estimate for blocks of size 2^( 7) =       0.000465921053

      target function =                  N/A
              le_mean =     -16.910445022875
             les_mean =     286.295450215881
             stat err =       0.000456511720
             autocorr =       1.254307898254
              std dev =       0.576454256935
             le_variance =       0.332299510338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044502288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910445022875       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910445022876       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910445022875       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910445022875       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910445022872       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910445023173       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910445023167       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910445022484       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.946353e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910445022875       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910445022875       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910445022875       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910445022875       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910445021007       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910445020529       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910445023481       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910445019352       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.865885e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910445022875       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910445022875       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910445022875       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910445022875       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910445023041       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910445027669       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910445007096       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910444978713       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.216336e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0607e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9173
    reference variance = 0.156807
====================================================
  Execution time = 2.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4289e-01
  Total weights = 2.0000e+06
  Execution time = 2.7191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172462
                                         uncertainty =       0.011796144645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172462
                                         uncertainty =       0.011796144645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414059818
  error estimate for blocks of size 2^( 2) =       0.000425510873
  error estimate for blocks of size 2^( 3) =       0.000438476253
  error estimate for blocks of size 2^( 4) =       0.000450937242
  error estimate for blocks of size 2^( 5) =       0.000461811285
  error estimate for blocks of size 2^( 6) =       0.000469753146
  error estimate for blocks of size 2^( 7) =       0.000473009992

      target function =                  N/A
              le_mean =     -16.911436918639
             les_mean =     286.339589546913
             stat err =       0.000463877916
             autocorr =       1.255108360219
              std dev =       0.585569009807
             le_variance =       0.342891065246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172514
                                         uncertainty =       0.011796144649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172514
                                         uncertainty =       0.011796144649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414059818
  error estimate for blocks of size 2^( 2) =       0.000425510874
  error estimate for blocks of size 2^( 3) =       0.000438476253
  error estimate for blocks of size 2^( 4) =       0.000450937242
  error estimate for blocks of size 2^( 5) =       0.000461811285
  error estimate for blocks of size 2^( 6) =       0.000469753146
  error estimate for blocks of size 2^( 7) =       0.000473009992

      target function =                  N/A
              le_mean =     -16.911436918639
             les_mean =     286.339589546959
             stat err =       0.000463877916
             autocorr =       1.255108360148
              std dev =       0.585569009852
             le_variance =       0.342891065299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172488
                                         uncertainty =       0.011796144647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172488
                                         uncertainty =       0.011796144647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414059818
  error estimate for blocks of size 2^( 2) =       0.000425510874
  error estimate for blocks of size 2^( 3) =       0.000438476253
  error estimate for blocks of size 2^( 4) =       0.000450937242
  error estimate for blocks of size 2^( 5) =       0.000461811285
  error estimate for blocks of size 2^( 6) =       0.000469753146
  error estimate for blocks of size 2^( 7) =       0.000473009992

      target function =                  N/A
              le_mean =     -16.911436918639
             les_mean =     286.339589546936
             stat err =       0.000463877916
             autocorr =       1.255108360189
              std dev =       0.585569009830
             le_variance =       0.342891065273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172465
                                         uncertainty =       0.011796144645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966172465
                                         uncertainty =       0.011796144645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414059818
  error estimate for blocks of size 2^( 2) =       0.000425510873
  error estimate for blocks of size 2^( 3) =       0.000438476253
  error estimate for blocks of size 2^( 4) =       0.000450937242
  error estimate for blocks of size 2^( 5) =       0.000461811285
  error estimate for blocks of size 2^( 6) =       0.000469753146
  error estimate for blocks of size 2^( 7) =       0.000473009992

      target function =                  N/A
              le_mean =     -16.911436918639
             les_mean =     286.339589546916
             stat err =       0.000463877916
             autocorr =       1.255108360214
              std dev =       0.585569009810
             le_variance =       0.342891065250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911436918639        initial  <--
     1.4901e+06     1.4901e+07             1.9464e-10       -16.911436918639
     5.9605e+06     5.9605e+07             4.8659e-11       -16.911436918639
     2.3842e+07     2.3842e+08             1.2163e-11       -16.911436918639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.3943
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.139175
====================================================
  Execution time = 2.4256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454204605
                                         uncertainty =       0.004607658088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331454204605
                                         uncertainty =       0.004607658088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407100199
  error estimate for blocks of size 2^( 2) =       0.000418426384
  error estimate for blocks of size 2^( 3) =       0.000430523949
  error estimate for blocks of size 2^( 4) =       0.000441981559
  error estimate for blocks of size 2^( 5) =       0.000453002802
  error estimate for blocks of size 2^( 6) =       0.000461962083
  error estimate for blocks of size 2^( 7) =       0.000468255006

      target function =                  N/A
              le_mean =     -16.911303380750
             les_mean =     286.323643014744
             stat err =       0.000456300363
             autocorr =       1.256316308967
              std dev =       0.575726623249
             le_variance =       0.331461144718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691130338075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911303380750       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911303380750       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911303380750       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911303380750       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911303381678       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911303375767       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911303375025       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.546351e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911303380750       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911303380750       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911303380750       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911303380750       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911303374563       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911303381400       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911303394401       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.865837e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911303380750       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911303380750       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911303380750       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911303380750       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911303202976       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911303347347       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911303335929       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 9.666165e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0680e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.0037
    reference variance = 0.281648
====================================================
  Execution time = 2.6047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4553e-01
  Total weights = 2.0000e+06
  Execution time = 2.7146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877681
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877681
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415648455
  error estimate for blocks of size 2^( 2) =       0.000426863268
  error estimate for blocks of size 2^( 3) =       0.000438648329
  error estimate for blocks of size 2^( 4) =       0.000449305381
  error estimate for blocks of size 2^( 5) =       0.000460192610
  error estimate for blocks of size 2^( 6) =       0.000466919434
  error estimate for blocks of size 2^( 7) =       0.000469466944

      target function =                  N/A
              le_mean =     -16.910666717504
             les_mean =     286.316175934530
             stat err =       0.000461471092
             autocorr =       1.232641143990
              std dev =       0.587815682662
             le_variance =       0.345527276783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877671
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877671
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415648455
  error estimate for blocks of size 2^( 2) =       0.000426863268
  error estimate for blocks of size 2^( 3) =       0.000438648329
  error estimate for blocks of size 2^( 4) =       0.000449305381
  error estimate for blocks of size 2^( 5) =       0.000460192610
  error estimate for blocks of size 2^( 6) =       0.000466919434
  error estimate for blocks of size 2^( 7) =       0.000469466944

      target function =                  N/A
              le_mean =     -16.910666717504
             les_mean =     286.316175934521
             stat err =       0.000461471092
             autocorr =       1.232641143996
              std dev =       0.587815682653
             le_variance =       0.345527276773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877676
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877676
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415648455
  error estimate for blocks of size 2^( 2) =       0.000426863268
  error estimate for blocks of size 2^( 3) =       0.000438648329
  error estimate for blocks of size 2^( 4) =       0.000449305381
  error estimate for blocks of size 2^( 5) =       0.000460192610
  error estimate for blocks of size 2^( 6) =       0.000466919434
  error estimate for blocks of size 2^( 7) =       0.000469466944

      target function =                  N/A
              le_mean =     -16.910666717504
             les_mean =     286.316175934526
             stat err =       0.000461471092
             autocorr =       1.232641143991
              std dev =       0.587815682657
             le_variance =       0.345527276778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877680
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345539877680
                                         uncertainty =       0.011801513341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415648455
  error estimate for blocks of size 2^( 2) =       0.000426863268
  error estimate for blocks of size 2^( 3) =       0.000438648329
  error estimate for blocks of size 2^( 4) =       0.000449305381
  error estimate for blocks of size 2^( 5) =       0.000460192610
  error estimate for blocks of size 2^( 6) =       0.000466919434
  error estimate for blocks of size 2^( 7) =       0.000469466944

      target function =                  N/A
              le_mean =     -16.910666717504
             les_mean =     286.316175934530
             stat err =       0.000461471092
             autocorr =       1.232641143990
              std dev =       0.587815682661
             le_variance =       0.345527276782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910666717504        initial
     1.4901e+07     1.4901e+08             1.5464e-11       -16.910666717504  <--
     5.9605e+07     5.9605e+08             3.8658e-12       -16.910666717504
     2.3842e+08     2.3842e+09             9.6662e-13       -16.910666717504

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 3.9716e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8426
    reference variance = 0.191078
====================================================
  Execution time = 2.4287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2925e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329173610067
                                         uncertainty =       0.003768037177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329173610067
                                         uncertainty =       0.003768037177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405742104
  error estimate for blocks of size 2^( 2) =       0.000417277228
  error estimate for blocks of size 2^( 3) =       0.000429334832
  error estimate for blocks of size 2^( 4) =       0.000440497617
  error estimate for blocks of size 2^( 5) =       0.000450009075
  error estimate for blocks of size 2^( 6) =       0.000457680570
  error estimate for blocks of size 2^( 7) =       0.000459436315

      target function =                  N/A
              le_mean =     -16.911372573781
             les_mean =     286.323775474588
             stat err =       0.000451905894
             autocorr =       1.240497397480
              std dev =       0.573805986370
             le_variance =       0.329253309994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691137257378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911372573781       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911372573781       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911372573780       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911372573988       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911372573124       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911372569978       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911372573223       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911372572242       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.842040e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911372573781       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911372573781       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911372573781       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911372573779       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911372581084       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911372567662       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911372575441       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911372587437       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.460527e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911372573781       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911372573781       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911372573781       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911372573753       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911372573781       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911372590404       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911372616167       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911372602052       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.651506e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0662e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9481
    reference variance = 0.20498
====================================================
  Execution time = 2.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3431e-01
  Total weights = 2.0000e+06
  Execution time = 2.7280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408848222
  error estimate for blocks of size 2^( 2) =       0.000420381837
  error estimate for blocks of size 2^( 3) =       0.000432443754
  error estimate for blocks of size 2^( 4) =       0.000443708630
  error estimate for blocks of size 2^( 5) =       0.000452545315
  error estimate for blocks of size 2^( 6) =       0.000459452961
  error estimate for blocks of size 2^( 7) =       0.000464194461

      target function =                  N/A
              le_mean =     -16.911120863791
             les_mean =     286.320322439693
             stat err =       0.000454975341
             autocorr =       1.238373051100
              std dev =       0.578198700349
             le_variance =       0.334313737086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968393
                                         uncertainty =       0.003765156903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968393
                                         uncertainty =       0.003765156903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408848222
  error estimate for blocks of size 2^( 2) =       0.000420381837
  error estimate for blocks of size 2^( 3) =       0.000432443754
  error estimate for blocks of size 2^( 4) =       0.000443708630
  error estimate for blocks of size 2^( 5) =       0.000452545315
  error estimate for blocks of size 2^( 6) =       0.000459452961
  error estimate for blocks of size 2^( 7) =       0.000464194461

      target function =                  N/A
              le_mean =     -16.911120863792
             les_mean =     286.320322439699
             stat err =       0.000454975341
             autocorr =       1.238373051109
              std dev =       0.578198700350
             le_variance =       0.334313737086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408848222
  error estimate for blocks of size 2^( 2) =       0.000420381837
  error estimate for blocks of size 2^( 3) =       0.000432443754
  error estimate for blocks of size 2^( 4) =       0.000443708630
  error estimate for blocks of size 2^( 5) =       0.000452545315
  error estimate for blocks of size 2^( 6) =       0.000459452961
  error estimate for blocks of size 2^( 7) =       0.000464194461

      target function =                  N/A
              le_mean =     -16.911120863792
             les_mean =     286.320322439696
             stat err =       0.000454975341
             autocorr =       1.238373051107
              std dev =       0.578198700350
             le_variance =       0.334313737086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334304968392
                                         uncertainty =       0.003765156902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408848222
  error estimate for blocks of size 2^( 2) =       0.000420381837
  error estimate for blocks of size 2^( 3) =       0.000432443754
  error estimate for blocks of size 2^( 4) =       0.000443708630
  error estimate for blocks of size 2^( 5) =       0.000452545315
  error estimate for blocks of size 2^( 6) =       0.000459452961
  error estimate for blocks of size 2^( 7) =       0.000464194461

      target function =                  N/A
              le_mean =     -16.911120863792
             les_mean =     286.320322439693
             stat err =       0.000454975341
             autocorr =       1.238373051105
              std dev =       0.578198700349
             le_variance =       0.334313737086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911120863791        initial
     3.7253e+06     3.7253e+07             5.8420e-11       -16.911120863792  <--
     1.4901e+07     1.4901e+08             1.4605e-11       -16.911120863792
     5.9605e+07     5.9605e+08             3.6515e-12       -16.911120863792

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 3.7461e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.479838
====================================================
  Execution time = 2.4202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332505016618
                                         uncertainty =       0.004320626542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332505016618
                                         uncertainty =       0.004320626542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407708730
  error estimate for blocks of size 2^( 2) =       0.000419491722
  error estimate for blocks of size 2^( 3) =       0.000431608748
  error estimate for blocks of size 2^( 4) =       0.000443808261
  error estimate for blocks of size 2^( 5) =       0.000455226096
  error estimate for blocks of size 2^( 6) =       0.000463444860
  error estimate for blocks of size 2^( 7) =       0.000469545949

      target function =                  N/A
              le_mean =     -16.911031286648
             les_mean =     286.315431828587
             stat err =       0.000458006292
             autocorr =       1.261952087468
              std dev =       0.576587215287
             le_variance =       0.332452816833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691103128665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031286648       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031286649       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911031286649       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911031286720       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911031286496       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911031287249       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911031286682       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 1.769865e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031286648       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031286648       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911031286648       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911031286648       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911031310998       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911031298304       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911031285707       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 4.424994e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031286648       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031286648       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911031286648       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911031286683       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911031289533       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911031286384       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911031287293       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.106172e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0563e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8982
    reference variance = 0.176516
====================================================
  Execution time = 2.3921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.0000e+06
  Execution time = 2.7287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452968
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452968
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408115862
  error estimate for blocks of size 2^( 2) =       0.000419836708
  error estimate for blocks of size 2^( 3) =       0.000431866211
  error estimate for blocks of size 2^( 4) =       0.000442587668
  error estimate for blocks of size 2^( 5) =       0.000452122411
  error estimate for blocks of size 2^( 6) =       0.000459595980
  error estimate for blocks of size 2^( 7) =       0.000466539369

      target function =                  N/A
              le_mean =     -16.911319705196
             les_mean =     286.325851118579
             stat err =       0.000455211357
             autocorr =       1.244111281141
              std dev =       0.577162987192
             le_variance =       0.333117113785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452948
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452948
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408115862
  error estimate for blocks of size 2^( 2) =       0.000419836708
  error estimate for blocks of size 2^( 3) =       0.000431866211
  error estimate for blocks of size 2^( 4) =       0.000442587668
  error estimate for blocks of size 2^( 5) =       0.000452122411
  error estimate for blocks of size 2^( 6) =       0.000459595980
  error estimate for blocks of size 2^( 7) =       0.000466539369

      target function =                  N/A
              le_mean =     -16.911319705195
             les_mean =     286.325851118509
             stat err =       0.000455211357
             autocorr =       1.244111281126
              std dev =       0.577162987175
             le_variance =       0.333117113765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452958
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452958
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408115862
  error estimate for blocks of size 2^( 2) =       0.000419836708
  error estimate for blocks of size 2^( 3) =       0.000431866211
  error estimate for blocks of size 2^( 4) =       0.000442587668
  error estimate for blocks of size 2^( 5) =       0.000452122411
  error estimate for blocks of size 2^( 6) =       0.000459595980
  error estimate for blocks of size 2^( 7) =       0.000466539369

      target function =                  N/A
              le_mean =     -16.911319705195
             les_mean =     286.325851118544
             stat err =       0.000455211357
             autocorr =       1.244111281124
              std dev =       0.577162987184
             le_variance =       0.333117113775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452967
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333020452967
                                         uncertainty =       0.004406084172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408115862
  error estimate for blocks of size 2^( 2) =       0.000419836708
  error estimate for blocks of size 2^( 3) =       0.000431866211
  error estimate for blocks of size 2^( 4) =       0.000442587668
  error estimate for blocks of size 2^( 5) =       0.000452122411
  error estimate for blocks of size 2^( 6) =       0.000459595980
  error estimate for blocks of size 2^( 7) =       0.000466539369

      target function =                  N/A
              le_mean =     -16.911319705196
             les_mean =     286.325851118574
             stat err =       0.000455211357
             autocorr =       1.244111281135
              std dev =       0.577162987191
             le_variance =       0.333117113784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911319705196        initial  <--
     9.3132e+05     9.3132e+06             1.7699e-10       -16.911319705195
     3.7253e+06     3.7253e+07             4.4250e-11       -16.911319705195
     1.4901e+07     1.4901e+08             1.1062e-11       -16.911319705196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.7058
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9785
    reference variance = 0.227222
====================================================
  Execution time = 2.4233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328578593803
                                         uncertainty =       0.003771660093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328578593803
                                         uncertainty =       0.003771660093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405360336
  error estimate for blocks of size 2^( 2) =       0.000417486703
  error estimate for blocks of size 2^( 3) =       0.000429052057
  error estimate for blocks of size 2^( 4) =       0.000441325649
  error estimate for blocks of size 2^( 5) =       0.000452490778
  error estimate for blocks of size 2^( 6) =       0.000463014932
  error estimate for blocks of size 2^( 7) =       0.000470949258

      target function =                  N/A
              le_mean =     -16.910970620265
             les_mean =     286.309561159547
             stat err =       0.000456945154
             autocorr =       1.270707662986
              std dev =       0.573266085167
             le_variance =       0.328634004403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691097062026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910970620265       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910970620265       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910970620265       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910970620265       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910970619644       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910970623252       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910970617342       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910970630094       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.425919e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910970620265       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910970620265       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910970620265       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910970620899       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910970620390       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910970627358       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910970644465       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910970653351       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.064888e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910970620265       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910970620265       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910970620265       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910970650626       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910970632785       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910970637487       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910970726897       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910970700903       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.516310e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0623e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.320107
====================================================
  Execution time = 2.3670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3337e-01
  Total weights = 2.0000e+06
  Execution time = 2.7245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377095
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377095
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408269741
  error estimate for blocks of size 2^( 2) =       0.000420377655
  error estimate for blocks of size 2^( 3) =       0.000432714708
  error estimate for blocks of size 2^( 4) =       0.000444645376
  error estimate for blocks of size 2^( 5) =       0.000456721896
  error estimate for blocks of size 2^( 6) =       0.000464950612
  error estimate for blocks of size 2^( 7) =       0.000470411527

      target function =                  N/A
              le_mean =     -16.911118706795
             les_mean =     286.319304111289
             stat err =       0.000459182353
             autocorr =       1.264957666224
              std dev =       0.577380604668
             le_variance =       0.333368362647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377097
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377097
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408269741
  error estimate for blocks of size 2^( 2) =       0.000420377655
  error estimate for blocks of size 2^( 3) =       0.000432714708
  error estimate for blocks of size 2^( 4) =       0.000444645376
  error estimate for blocks of size 2^( 5) =       0.000456721896
  error estimate for blocks of size 2^( 6) =       0.000464950612
  error estimate for blocks of size 2^( 7) =       0.000470411527

      target function =                  N/A
              le_mean =     -16.911118706796
             les_mean =     286.319304111298
             stat err =       0.000459182353
             autocorr =       1.264957666227
              std dev =       0.577380604670
             le_variance =       0.333368362649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377096
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377096
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408269741
  error estimate for blocks of size 2^( 2) =       0.000420377655
  error estimate for blocks of size 2^( 3) =       0.000432714708
  error estimate for blocks of size 2^( 4) =       0.000444645376
  error estimate for blocks of size 2^( 5) =       0.000456721896
  error estimate for blocks of size 2^( 6) =       0.000464950612
  error estimate for blocks of size 2^( 7) =       0.000470411527

      target function =                  N/A
              le_mean =     -16.911118706796
             les_mean =     286.319304111294
             stat err =       0.000459182353
             autocorr =       1.264957666224
              std dev =       0.577380604669
             le_variance =       0.333368362648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377096
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333486377096
                                         uncertainty =       0.005614163107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408269741
  error estimate for blocks of size 2^( 2) =       0.000420377655
  error estimate for blocks of size 2^( 3) =       0.000432714708
  error estimate for blocks of size 2^( 4) =       0.000444645376
  error estimate for blocks of size 2^( 5) =       0.000456721896
  error estimate for blocks of size 2^( 6) =       0.000464950612
  error estimate for blocks of size 2^( 7) =       0.000470411527

      target function =                  N/A
              le_mean =     -16.911118706795
             les_mean =     286.319304111290
             stat err =       0.000459182353
             autocorr =       1.264957666219
              std dev =       0.577380604668
             le_variance =       0.333368362647


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911118706795        initial
     9.3132e+06     9.3132e+07             2.4259e-11       -16.911118706796  <--
     3.7253e+07     3.7253e+08             6.0649e-12       -16.911118706796
     1.4901e+08     1.4901e+09             1.5163e-12       -16.911118706795

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 3.7374e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8631
    reference variance = 0.293617
====================================================
  Execution time = 2.4150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253187119
                                         uncertainty =       0.003844823209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253187119
                                         uncertainty =       0.003844823209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407530380
  error estimate for blocks of size 2^( 2) =       0.000419235117
  error estimate for blocks of size 2^( 3) =       0.000431465143
  error estimate for blocks of size 2^( 4) =       0.000442632921
  error estimate for blocks of size 2^( 5) =       0.000452145398
  error estimate for blocks of size 2^( 6) =       0.000460463515
  error estimate for blocks of size 2^( 7) =       0.000463523669

      target function =                  N/A
              le_mean =     -16.911550978191
             les_mean =     286.332718343018
             stat err =       0.000454691376
             autocorr =       1.244839770437
              std dev =       0.576334990379
             le_variance =       0.332162021136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691155097819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911550978191       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911550978192       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911550978191       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911550978154       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911550978191       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911550978601       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911550981452       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911550978309       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.055440e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911550978191       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911550978191       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911550978191       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911550978191       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911550978191       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911550983157       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911550983112       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911550966403       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.638607e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911550978191       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911550978191       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911550978191       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911550957006       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911551013974       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911550978192       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911550988762       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911550993120       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.596579e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0441e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8282
    reference variance = 0.386565
====================================================
  Execution time = 2.4045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3385e-01
  Total weights = 2.0000e+06
  Execution time = 2.7174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067917
                                         uncertainty =       0.004204214614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067917
                                         uncertainty =       0.004204214614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408562605
  error estimate for blocks of size 2^( 2) =       0.000419953205
  error estimate for blocks of size 2^( 3) =       0.000432572834
  error estimate for blocks of size 2^( 4) =       0.000444314078
  error estimate for blocks of size 2^( 5) =       0.000454817622
  error estimate for blocks of size 2^( 6) =       0.000463711840
  error estimate for blocks of size 2^( 7) =       0.000469502129

      target function =                  N/A
              le_mean =     -16.911421999586
             les_mean =     286.330040685803
             stat err =       0.000458086417
             autocorr =       1.257122505299
              std dev =       0.577794777269
             le_variance =       0.333846804639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067824
                                         uncertainty =       0.004204214612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067824
                                         uncertainty =       0.004204214612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408562605
  error estimate for blocks of size 2^( 2) =       0.000419953205
  error estimate for blocks of size 2^( 3) =       0.000432572834
  error estimate for blocks of size 2^( 4) =       0.000444314078
  error estimate for blocks of size 2^( 5) =       0.000454817622
  error estimate for blocks of size 2^( 6) =       0.000463711840
  error estimate for blocks of size 2^( 7) =       0.000469502129

      target function =                  N/A
              le_mean =     -16.911421999587
             les_mean =     286.330040685725
             stat err =       0.000458086417
             autocorr =       1.257122505366
              std dev =       0.577794777189
             le_variance =       0.333846804546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067871
                                         uncertainty =       0.004204214613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067871
                                         uncertainty =       0.004204214613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408562605
  error estimate for blocks of size 2^( 2) =       0.000419953205
  error estimate for blocks of size 2^( 3) =       0.000432572834
  error estimate for blocks of size 2^( 4) =       0.000444314078
  error estimate for blocks of size 2^( 5) =       0.000454817622
  error estimate for blocks of size 2^( 6) =       0.000463711840
  error estimate for blocks of size 2^( 7) =       0.000469502129

      target function =                  N/A
              le_mean =     -16.911421999586
             les_mean =     286.330040685764
             stat err =       0.000458086417
             autocorr =       1.257122505330
              std dev =       0.577794777229
             le_variance =       0.333846804593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067911
                                         uncertainty =       0.004204214614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333804067911
                                         uncertainty =       0.004204214614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408562605
  error estimate for blocks of size 2^( 2) =       0.000419953205
  error estimate for blocks of size 2^( 3) =       0.000432572834
  error estimate for blocks of size 2^( 4) =       0.000444314078
  error estimate for blocks of size 2^( 5) =       0.000454817622
  error estimate for blocks of size 2^( 6) =       0.000463711840
  error estimate for blocks of size 2^( 7) =       0.000469502129

      target function =                  N/A
              le_mean =     -16.911421999586
             les_mean =     286.330040685798
             stat err =       0.000458086417
             autocorr =       1.257122505300
              std dev =       0.577794777264
             le_variance =       0.333846804633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911421999586        initial
     2.3283e+06     2.3283e+07             1.0554e-10       -16.911421999587  <--
     9.3132e+06     9.3132e+07             2.6386e-11       -16.911421999586
     3.7253e+07     3.7253e+08             6.5966e-12       -16.911421999586

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.1133e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.196525
====================================================
  Execution time = 2.4014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.7151e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371615446105
                                         uncertainty =       0.024959827625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371615446105
                                         uncertainty =       0.024959827625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430992788
  error estimate for blocks of size 2^( 2) =       0.000441818426
  error estimate for blocks of size 2^( 3) =       0.000453493609
  error estimate for blocks of size 2^( 4) =       0.000465036382
  error estimate for blocks of size 2^( 5) =       0.000474481532
  error estimate for blocks of size 2^( 6) =       0.000482083086
  error estimate for blocks of size 2^( 7) =       0.000488550685

      target function =                  N/A
              le_mean =     -16.910973865795
             les_mean =     286.352546471235
             stat err =       0.000477537921
             autocorr =       1.227653261759
              std dev =       0.609515846705
             le_variance =       0.371509567385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691097386580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910973865795       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910973865796       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910973865797       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910973865797       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910973865943       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910973865783       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910973865865       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910973865251       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.857666e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910973865795       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910973865795       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910973865796       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910973865796       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910973866496       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910973865446       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910973865782       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910973867360       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.644160e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910973865795       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910973865795       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910973865795       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910973865794       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910973864730       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910973861437       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910973865742       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910973862613       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.410995e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0366e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207210e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.258679
====================================================
  Execution time = 2.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2526e-01
  Total weights = 2.0000e+06
  Execution time = 2.7284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402382
                                         uncertainty =       0.003523117725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402382
                                         uncertainty =       0.003523117725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403272259
  error estimate for blocks of size 2^( 2) =       0.000415409624
  error estimate for blocks of size 2^( 3) =       0.000427485670
  error estimate for blocks of size 2^( 4) =       0.000439325405
  error estimate for blocks of size 2^( 5) =       0.000450051731
  error estimate for blocks of size 2^( 6) =       0.000457827266
  error estimate for blocks of size 2^( 7) =       0.000463560755

      target function =                  N/A
              le_mean =     -16.910180673346
             les_mean =     286.279467271582
             stat err =       0.000452691289
             autocorr =       1.260107454307
              std dev =       0.570313097333
             le_variance =       0.325257028990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402577
                                         uncertainty =       0.003523117726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402577
                                         uncertainty =       0.003523117726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403272259
  error estimate for blocks of size 2^( 2) =       0.000415409624
  error estimate for blocks of size 2^( 3) =       0.000427485670
  error estimate for blocks of size 2^( 4) =       0.000439325405
  error estimate for blocks of size 2^( 5) =       0.000450051731
  error estimate for blocks of size 2^( 6) =       0.000457827267
  error estimate for blocks of size 2^( 7) =       0.000463560755

      target function =                  N/A
              le_mean =     -16.910180673343
             les_mean =     286.279467271665
             stat err =       0.000452691289
             autocorr =       1.260107454144
              std dev =       0.570313097504
             le_variance =       0.325257029185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402480
                                         uncertainty =       0.003523117726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402480
                                         uncertainty =       0.003523117726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403272259
  error estimate for blocks of size 2^( 2) =       0.000415409624
  error estimate for blocks of size 2^( 3) =       0.000427485670
  error estimate for blocks of size 2^( 4) =       0.000439325405
  error estimate for blocks of size 2^( 5) =       0.000450051731
  error estimate for blocks of size 2^( 6) =       0.000457827267
  error estimate for blocks of size 2^( 7) =       0.000463560755

      target function =                  N/A
              le_mean =     -16.910180673345
             les_mean =     286.279467271624
             stat err =       0.000452691289
             autocorr =       1.260107454229
              std dev =       0.570313097419
             le_variance =       0.325257029087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402394
                                         uncertainty =       0.003523117725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325136402394
                                         uncertainty =       0.003523117725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403272259
  error estimate for blocks of size 2^( 2) =       0.000415409624
  error estimate for blocks of size 2^( 3) =       0.000427485670
  error estimate for blocks of size 2^( 4) =       0.000439325405
  error estimate for blocks of size 2^( 5) =       0.000450051731
  error estimate for blocks of size 2^( 6) =       0.000457827266
  error estimate for blocks of size 2^( 7) =       0.000463560755

      target function =                  N/A
              le_mean =     -16.910180673346
             les_mean =     286.279467271587
             stat err =       0.000452691289
             autocorr =       1.260107454308
              std dev =       0.570313097344
             le_variance =       0.325257029002


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910180673346        initial  <--
     5.8208e+05     5.8208e+06             3.8577e-10       -16.910180673343
     2.3283e+06     2.3283e+07             9.6442e-11       -16.910180673345
     9.3132e+06     9.3132e+07             2.4110e-11       -16.910180673346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.2939
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.268989
====================================================
  Execution time = 2.4166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323007820351
                                         uncertainty =       0.003196459203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323007820351
                                         uncertainty =       0.003196459203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401877747
  error estimate for blocks of size 2^( 2) =       0.000413657239
  error estimate for blocks of size 2^( 3) =       0.000426108178
  error estimate for blocks of size 2^( 4) =       0.000437648412
  error estimate for blocks of size 2^( 5) =       0.000447173322
  error estimate for blocks of size 2^( 6) =       0.000453685457
  error estimate for blocks of size 2^( 7) =       0.000457331006

      target function =                  N/A
              le_mean =     -16.911400221839
             les_mean =     286.318468748093
             stat err =       0.000448959549
             autocorr =       1.248034266357
              std dev =       0.568340959632
             le_variance =       0.323011446396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691140022184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911400221839       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911400221839       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911400221839       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911400225885       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911400219766       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911400220354       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911400221809       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.292471e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911400221839       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911400221839       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911400221839       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911400199227       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911400215230       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911400219922       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911400215576       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 8.231452e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911400221839       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911400221839       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911400221839       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911400221839       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911400221870       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911400226319       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911400223373       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.057752e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0580e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9504
    reference variance = 0.294729
====================================================
  Execution time = 2.3843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2933e-01
  Total weights = 2.0000e+06
  Execution time = 2.7259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700589
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700589
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405791936
  error estimate for blocks of size 2^( 2) =       0.000417165371
  error estimate for blocks of size 2^( 3) =       0.000429168023
  error estimate for blocks of size 2^( 4) =       0.000440866859
  error estimate for blocks of size 2^( 5) =       0.000451608000
  error estimate for blocks of size 2^( 6) =       0.000459314842
  error estimate for blocks of size 2^( 7) =       0.000463626491

      target function =                  N/A
              le_mean =     -16.910923877267
             les_mean =     286.308680408386
             stat err =       0.000453854048
             autocorr =       1.250908669682
              std dev =       0.573876459125
             le_variance =       0.329334190338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700580
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700580
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405791936
  error estimate for blocks of size 2^( 2) =       0.000417165371
  error estimate for blocks of size 2^( 3) =       0.000429168023
  error estimate for blocks of size 2^( 4) =       0.000440866859
  error estimate for blocks of size 2^( 5) =       0.000451608000
  error estimate for blocks of size 2^( 6) =       0.000459314842
  error estimate for blocks of size 2^( 7) =       0.000463626491

      target function =                  N/A
              le_mean =     -16.910923877267
             les_mean =     286.308680408371
             stat err =       0.000453854048
             autocorr =       1.250908669675
              std dev =       0.573876459118
             le_variance =       0.329334190329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700584
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700584
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405791936
  error estimate for blocks of size 2^( 2) =       0.000417165371
  error estimate for blocks of size 2^( 3) =       0.000429168023
  error estimate for blocks of size 2^( 4) =       0.000440866859
  error estimate for blocks of size 2^( 5) =       0.000451608000
  error estimate for blocks of size 2^( 6) =       0.000459314842
  error estimate for blocks of size 2^( 7) =       0.000463626491

      target function =                  N/A
              le_mean =     -16.910923877267
             les_mean =     286.308680408379
             stat err =       0.000453854048
             autocorr =       1.250908669678
              std dev =       0.573876459121
             le_variance =       0.329334190334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700588
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329386700588
                                         uncertainty =       0.004449693650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405791936
  error estimate for blocks of size 2^( 2) =       0.000417165371
  error estimate for blocks of size 2^( 3) =       0.000429168023
  error estimate for blocks of size 2^( 4) =       0.000440866859
  error estimate for blocks of size 2^( 5) =       0.000451608000
  error estimate for blocks of size 2^( 6) =       0.000459314842
  error estimate for blocks of size 2^( 7) =       0.000463626491

      target function =                  N/A
              le_mean =     -16.910923877267
             les_mean =     286.308680408385
             stat err =       0.000453854048
             autocorr =       1.250908669674
              std dev =       0.573876459125
             le_variance =       0.329334190338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910923877267        initial  <--
     5.8208e+06     5.8208e+07             3.2925e-11       -16.910923877267
     2.3283e+07     2.3283e+08             8.2315e-12       -16.910923877267
     9.3132e+07     9.3132e+08             2.0578e-12       -16.910923877267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5524
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9297
    reference variance = 0.253028
====================================================
  Execution time = 2.4335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3154e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608807982
                                         uncertainty =       0.004854900235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608807982
                                         uncertainty =       0.004854900235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407146051
  error estimate for blocks of size 2^( 2) =       0.000418982588
  error estimate for blocks of size 2^( 3) =       0.000431582054
  error estimate for blocks of size 2^( 4) =       0.000443626783
  error estimate for blocks of size 2^( 5) =       0.000453897294
  error estimate for blocks of size 2^( 6) =       0.000462393992
  error estimate for blocks of size 2^( 7) =       0.000470454861

      target function =                  N/A
              le_mean =     -16.910602090002
             les_mean =     286.299998693743
             stat err =       0.000457593232
             autocorr =       1.263161070641
              std dev =       0.575791466704
             le_variance =       0.331535813129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691060209000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602090002       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602090002       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602090002       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602090002       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602090002       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602084535       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602069074       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910602175037       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.363986e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602090002       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602090002       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602090002       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602090002       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602090002       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602091667       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602181787       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910601882080       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.091196e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602090002       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602090002       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602090002       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602088175       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602090002       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602297436       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602130467       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910601741350       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.727499e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0719e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.572519
====================================================
  Execution time = 2.3759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3576e-01
  Total weights = 2.0000e+06
  Execution time = 2.7204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928659
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928659
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409728951
  error estimate for blocks of size 2^( 2) =       0.000421265328
  error estimate for blocks of size 2^( 3) =       0.000433897365
  error estimate for blocks of size 2^( 4) =       0.000446557277
  error estimate for blocks of size 2^( 5) =       0.000458115765
  error estimate for blocks of size 2^( 6) =       0.000466992530
  error estimate for blocks of size 2^( 7) =       0.000474463131

      target function =                  N/A
              le_mean =     -16.910902493459
             les_mean =     286.314378601715
             stat err =       0.000461532176
             autocorr =       1.268851107705
              std dev =       0.579444239169
             le_variance =       0.335755626306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928661
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928661
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409728951
  error estimate for blocks of size 2^( 2) =       0.000421265328
  error estimate for blocks of size 2^( 3) =       0.000433897365
  error estimate for blocks of size 2^( 4) =       0.000446557277
  error estimate for blocks of size 2^( 5) =       0.000458115765
  error estimate for blocks of size 2^( 6) =       0.000466992530
  error estimate for blocks of size 2^( 7) =       0.000474463131

      target function =                  N/A
              le_mean =     -16.910902493459
             les_mean =     286.314378601717
             stat err =       0.000461532176
             autocorr =       1.268851107709
              std dev =       0.579444239170
             le_variance =       0.335755626307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928660
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928660
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409728951
  error estimate for blocks of size 2^( 2) =       0.000421265328
  error estimate for blocks of size 2^( 3) =       0.000433897365
  error estimate for blocks of size 2^( 4) =       0.000446557277
  error estimate for blocks of size 2^( 5) =       0.000458115765
  error estimate for blocks of size 2^( 6) =       0.000466992530
  error estimate for blocks of size 2^( 7) =       0.000474463131

      target function =                  N/A
              le_mean =     -16.910902493459
             les_mean =     286.314378601716
             stat err =       0.000461532176
             autocorr =       1.268851107698
              std dev =       0.579444239169
             le_variance =       0.335755626307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928659
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335848928659
                                         uncertainty =       0.008029078927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409728951
  error estimate for blocks of size 2^( 2) =       0.000421265328
  error estimate for blocks of size 2^( 3) =       0.000433897365
  error estimate for blocks of size 2^( 4) =       0.000446557277
  error estimate for blocks of size 2^( 5) =       0.000458115765
  error estimate for blocks of size 2^( 6) =       0.000466992530
  error estimate for blocks of size 2^( 7) =       0.000474463131

      target function =                  N/A
              le_mean =     -16.910902493459
             les_mean =     286.314378601715
             stat err =       0.000461532176
             autocorr =       1.268851107703
              std dev =       0.579444239169
             le_variance =       0.335755626306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910902493459        initial
     5.8208e+07     5.8208e+08             4.3640e-12       -16.910902493459  <--
     2.3283e+08     2.3283e+09             1.0912e-12       -16.910902493459
     9.3132e+08     9.3132e+09             2.7275e-13       -16.910902493459

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 3.7451e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.232722
====================================================
  Execution time = 2.4467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336200284509
                                         uncertainty =       0.005612178752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336200284509
                                         uncertainty =       0.005612178752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410130288
  error estimate for blocks of size 2^( 2) =       0.000421990882
  error estimate for blocks of size 2^( 3) =       0.000433673068
  error estimate for blocks of size 2^( 4) =       0.000445951743
  error estimate for blocks of size 2^( 5) =       0.000457460612
  error estimate for blocks of size 2^( 6) =       0.000465853821
  error estimate for blocks of size 2^( 7) =       0.000472979282

      target function =                  N/A
              le_mean =     -16.910925144576
             les_mean =     286.315802784161
             stat err =       0.000460561365
             autocorr =       1.261047134090
              std dev =       0.580011816182
             le_variance =       0.336413706911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691092514458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925144576       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925144576       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925144576       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925144569       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925155423       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925143294       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925148513       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910925144328       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.814639e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925144576       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925144576       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925144576       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925144576       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925148107       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925138961       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925151417       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910925121694       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.536842e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925144576       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925144576       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925144576       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925144576       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925164054       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925144576       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925153111       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910925208016       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.134122e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0949e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.197423
====================================================
  Execution time = 2.4136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3084e-01
  Total weights = 2.0000e+06
  Execution time = 2.7213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975340
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975340
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406721657
  error estimate for blocks of size 2^( 2) =       0.000418518823
  error estimate for blocks of size 2^( 3) =       0.000430539302
  error estimate for blocks of size 2^( 4) =       0.000442387759
  error estimate for blocks of size 2^( 5) =       0.000451553431
  error estimate for blocks of size 2^( 6) =       0.000458579808
  error estimate for blocks of size 2^( 7) =       0.000459525949

      target function =                  N/A
              le_mean =     -16.910709837990
             les_mean =     286.302952071658
             stat err =       0.000453011737
             autocorr =       1.240578677108
              std dev =       0.575191283308
             le_variance =       0.330845012394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975327
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975327
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406721657
  error estimate for blocks of size 2^( 2) =       0.000418518823
  error estimate for blocks of size 2^( 3) =       0.000430539302
  error estimate for blocks of size 2^( 4) =       0.000442387759
  error estimate for blocks of size 2^( 5) =       0.000451553431
  error estimate for blocks of size 2^( 6) =       0.000458579808
  error estimate for blocks of size 2^( 7) =       0.000459525949

      target function =                  N/A
              le_mean =     -16.910709837990
             les_mean =     286.302952071642
             stat err =       0.000453011737
             autocorr =       1.240578677114
              std dev =       0.575191283297
             le_variance =       0.330845012381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975334
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975334
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406721657
  error estimate for blocks of size 2^( 2) =       0.000418518823
  error estimate for blocks of size 2^( 3) =       0.000430539302
  error estimate for blocks of size 2^( 4) =       0.000442387759
  error estimate for blocks of size 2^( 5) =       0.000451553431
  error estimate for blocks of size 2^( 6) =       0.000458579808
  error estimate for blocks of size 2^( 7) =       0.000459525949

      target function =                  N/A
              le_mean =     -16.910709837990
             les_mean =     286.302952071650
             stat err =       0.000453011737
             autocorr =       1.240578677100
              std dev =       0.575191283303
             le_variance =       0.330845012388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975339
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933975339
                                         uncertainty =       0.005904264606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406721657
  error estimate for blocks of size 2^( 2) =       0.000418518823
  error estimate for blocks of size 2^( 3) =       0.000430539302
  error estimate for blocks of size 2^( 4) =       0.000442387759
  error estimate for blocks of size 2^( 5) =       0.000451553431
  error estimate for blocks of size 2^( 6) =       0.000458579808
  error estimate for blocks of size 2^( 7) =       0.000459525949

      target function =                  N/A
              le_mean =     -16.910709837990
             les_mean =     286.302952071657
             stat err =       0.000453011737
             autocorr =       1.240578677108
              std dev =       0.575191283308
             le_variance =       0.330845012393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910709837990        initial  <--
     1.4552e+07     1.4552e+08             1.8146e-11       -16.910709837990
     5.8208e+07     5.8208e+08             4.5368e-12       -16.910709837990
     2.3283e+08     2.3283e+09             1.1341e-12       -16.910709837990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8200
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.949
    reference variance = 0.205995
====================================================
  Execution time = 2.6679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.7198e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372152865259
                                         uncertainty =       0.040334251840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372152865259
                                         uncertainty =       0.040334251840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431265909
  error estimate for blocks of size 2^( 2) =       0.000442464700
  error estimate for blocks of size 2^( 3) =       0.000453402019
  error estimate for blocks of size 2^( 4) =       0.000464808800
  error estimate for blocks of size 2^( 5) =       0.000474189734
  error estimate for blocks of size 2^( 6) =       0.000481408979
  error estimate for blocks of size 2^( 7) =       0.000487210295

      target function =                  N/A
              le_mean =     -16.910998576749
             les_mean =     286.353853245286
             stat err =       0.000476904452
             autocorr =       1.222848048060
              std dev =       0.609902097447
             le_variance =       0.371980568470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691099857675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910998576749       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910998576749       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910998576749       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910998576749       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910998606860       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910998574533       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910998620978       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910998596710       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.620445e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910998576749       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910998576749       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910998576749       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910998574323       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910998485054       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910998614940       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910998590638       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910998688273       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.051047e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910998576749       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910998576749       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910998576749       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910998576749       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910998352649       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910997425601       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911000271641       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911000888284       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.010633e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3078e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0044
    reference variance = 0.693766
====================================================
  Execution time = 2.4259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2981e-01
  Total weights = 2.0000e+06
  Execution time = 2.7189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406084486
  error estimate for blocks of size 2^( 2) =       0.000418097534
  error estimate for blocks of size 2^( 3) =       0.000430833336
  error estimate for blocks of size 2^( 4) =       0.000443616687
  error estimate for blocks of size 2^( 5) =       0.000455505383
  error estimate for blocks of size 2^( 6) =       0.000463571217
  error estimate for blocks of size 2^( 7) =       0.000472489282

      target function =                  N/A
              le_mean =     -16.909969629146
             les_mean =     286.276881913501
             stat err =       0.000458795642
             autocorr =       1.276455772207
              std dev =       0.574290187774
             le_variance =       0.329809219773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406084486
  error estimate for blocks of size 2^( 2) =       0.000418097534
  error estimate for blocks of size 2^( 3) =       0.000430833336
  error estimate for blocks of size 2^( 4) =       0.000443616687
  error estimate for blocks of size 2^( 5) =       0.000455505383
  error estimate for blocks of size 2^( 6) =       0.000463571217
  error estimate for blocks of size 2^( 7) =       0.000472489282

      target function =                  N/A
              le_mean =     -16.909969629146
             les_mean =     286.276881913501
             stat err =       0.000458795642
             autocorr =       1.276455772222
              std dev =       0.574290187774
             le_variance =       0.329809219773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406084486
  error estimate for blocks of size 2^( 2) =       0.000418097534
  error estimate for blocks of size 2^( 3) =       0.000430833336
  error estimate for blocks of size 2^( 4) =       0.000443616687
  error estimate for blocks of size 2^( 5) =       0.000455505383
  error estimate for blocks of size 2^( 6) =       0.000463571217
  error estimate for blocks of size 2^( 7) =       0.000472489282

      target function =                  N/A
              le_mean =     -16.909969629146
             les_mean =     286.276881913501
             stat err =       0.000458795642
             autocorr =       1.276455772219
              std dev =       0.574290187774
             le_variance =       0.329809219773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329877206046
                                         uncertainty =       0.006102215561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406084486
  error estimate for blocks of size 2^( 2) =       0.000418097534
  error estimate for blocks of size 2^( 3) =       0.000430833336
  error estimate for blocks of size 2^( 4) =       0.000443616687
  error estimate for blocks of size 2^( 5) =       0.000455505383
  error estimate for blocks of size 2^( 6) =       0.000463571217
  error estimate for blocks of size 2^( 7) =       0.000472489282

      target function =                  N/A
              le_mean =     -16.909969629146
             les_mean =     286.276881913501
             stat err =       0.000458795642
             autocorr =       1.276455772212
              std dev =       0.574290187774
             le_variance =       0.329809219773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909969629146        initial  <--
     1.4552e+08     1.4552e+09             1.6204e-12       -16.909969629146
     5.8208e+08     5.8208e+09             4.0510e-13       -16.909969629146
     2.3283e+09     2.3283e+10             1.0106e-13       -16.909969629146

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.9610
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.260492
====================================================
  Execution time = 2.4106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2681e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326863976174
                                         uncertainty =       0.003516532580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326863976174
                                         uncertainty =       0.003516532580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404230908
  error estimate for blocks of size 2^( 2) =       0.000416354591
  error estimate for blocks of size 2^( 3) =       0.000428603836
  error estimate for blocks of size 2^( 4) =       0.000440831350
  error estimate for blocks of size 2^( 5) =       0.000452177764
  error estimate for blocks of size 2^( 6) =       0.000458220900
  error estimate for blocks of size 2^( 7) =       0.000463176482

      target function =                  N/A
              le_mean =     -16.910136159302
             les_mean =     286.279510016096
             stat err =       0.000453601624
             autocorr =       1.259186816315
              std dev =       0.571668831889
             le_variance =       0.326805253353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691013615930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910136159302       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910136159302       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910136159302       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910137023646       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910136292902       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910136376545       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910135721216       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.614486e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910136159302       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910136159302       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910136159302       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910136159302       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910137917920       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910135680019       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910136390655       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.036937e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910136159302       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910136159302       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910136159302       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910113575458       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910139939437       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144190207       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910141400041       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910136797456       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.057286e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0487e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.298642
====================================================
  Execution time = 2.4002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3324e-01
  Total weights = 2.0000e+06
  Execution time = 2.7288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408190161
  error estimate for blocks of size 2^( 2) =       0.000420084334
  error estimate for blocks of size 2^( 3) =       0.000432489678
  error estimate for blocks of size 2^( 4) =       0.000444924060
  error estimate for blocks of size 2^( 5) =       0.000455815517
  error estimate for blocks of size 2^( 6) =       0.000463907576
  error estimate for blocks of size 2^( 7) =       0.000466467105

      target function =                  N/A
              le_mean =     -16.910430547507
             les_mean =     286.295899550262
             stat err =       0.000457778565
             autocorr =       1.257725429329
              std dev =       0.577268061485
             le_variance =       0.333238414811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408190161
  error estimate for blocks of size 2^( 2) =       0.000420084334
  error estimate for blocks of size 2^( 3) =       0.000432489678
  error estimate for blocks of size 2^( 4) =       0.000444924060
  error estimate for blocks of size 2^( 5) =       0.000455815517
  error estimate for blocks of size 2^( 6) =       0.000463907576
  error estimate for blocks of size 2^( 7) =       0.000466467105

      target function =                  N/A
              le_mean =     -16.910430547507
             les_mean =     286.295899550262
             stat err =       0.000457778565
             autocorr =       1.257725429334
              std dev =       0.577268061485
             le_variance =       0.333238414811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408190161
  error estimate for blocks of size 2^( 2) =       0.000420084334
  error estimate for blocks of size 2^( 3) =       0.000432489678
  error estimate for blocks of size 2^( 4) =       0.000444924060
  error estimate for blocks of size 2^( 5) =       0.000455815517
  error estimate for blocks of size 2^( 6) =       0.000463907576
  error estimate for blocks of size 2^( 7) =       0.000466467105

      target function =                  N/A
              le_mean =     -16.910430547507
             les_mean =     286.295899550262
             stat err =       0.000457778565
             autocorr =       1.257725429332
              std dev =       0.577268061485
             le_variance =       0.333238414811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333336256158
                                         uncertainty =       0.003635321807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408190161
  error estimate for blocks of size 2^( 2) =       0.000420084334
  error estimate for blocks of size 2^( 3) =       0.000432489678
  error estimate for blocks of size 2^( 4) =       0.000444924060
  error estimate for blocks of size 2^( 5) =       0.000455815517
  error estimate for blocks of size 2^( 6) =       0.000463907576
  error estimate for blocks of size 2^( 7) =       0.000466467105

      target function =                  N/A
              le_mean =     -16.910430547507
             les_mean =     286.295899550262
             stat err =       0.000457778565
             autocorr =       1.257725429331
              std dev =       0.577268061485
             le_variance =       0.333238414811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910430547507        initial
     1.4552e+09     1.4552e+10             1.6145e-13       -16.910430547507
     5.8208e+09     5.8208e+10             4.0369e-14       -16.910430547507
     2.3283e+10     2.3283e+11             1.0573e-14       -16.910430547507  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 3.7716e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9141
    reference variance = 0.318215
====================================================
  Execution time = 2.4087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334866077615
                                         uncertainty =       0.005990200026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334866077615
                                         uncertainty =       0.005990200026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409143937
  error estimate for blocks of size 2^( 2) =       0.000420644969
  error estimate for blocks of size 2^( 3) =       0.000432239716
  error estimate for blocks of size 2^( 4) =       0.000443168878
  error estimate for blocks of size 2^( 5) =       0.000452445268
  error estimate for blocks of size 2^( 6) =       0.000459296456
  error estimate for blocks of size 2^( 7) =       0.000462384709

      target function =                  N/A
              le_mean =     -16.911614239159
             les_mean =     286.337493528734
             stat err =       0.000454323828
             autocorr =       1.233044613681
              std dev =       0.578616904353
             le_variance =       0.334797522003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691161423916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911614239159       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911614239159       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911614239159       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911613937098       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911615083385       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911613615121       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911614962971       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.016940e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911614239159       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911614239159       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911614239159       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911611170720       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911610418364       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911620734655       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911607772397       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911619325947       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 9.837442e-15

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911614239159       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911614239159       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911614239159       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911611050244       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911683250602       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911621183828       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911593617502       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911667868872       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911658035604       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912196035219       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911483791768       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910151722224       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908545947576       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911146126891       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909356418451       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.916544011266       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.916759623694       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907208202334       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909345164858       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906872591096       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911221755873       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.920821533006       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919962420867       residual = 7.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914431335622       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909689112905       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.918869440034       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.921157175657       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.914514268957       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.914689975772       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908041157514       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916142258919       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.923360846846       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.911686704820       residual = 7.26e-05           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.948850559899       residual = 1.86e-01           smallest_sin_value = 9.97e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 2.460639e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0463e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8479
    reference variance = 0.177054
====================================================
  Execution time = 2.4053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2680e-01
  Total weights = 2.0000e+06
  Execution time = 2.7066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228525
  error estimate for blocks of size 2^( 2) =       0.000416049219
  error estimate for blocks of size 2^( 3) =       0.000428196363
  error estimate for blocks of size 2^( 4) =       0.000440750595
  error estimate for blocks of size 2^( 5) =       0.000450682577
  error estimate for blocks of size 2^( 6) =       0.000459810362
  error estimate for blocks of size 2^( 7) =       0.000463194907

      target function =                  N/A
              le_mean =     -16.910009040344
             les_mean =     286.275206982731
             stat err =       0.000453609610
             autocorr =       1.259245998057
              std dev =       0.571665463020
             le_variance =       0.326801401610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228525
  error estimate for blocks of size 2^( 2) =       0.000416049219
  error estimate for blocks of size 2^( 3) =       0.000428196363
  error estimate for blocks of size 2^( 4) =       0.000440750595
  error estimate for blocks of size 2^( 5) =       0.000450682577
  error estimate for blocks of size 2^( 6) =       0.000459810362
  error estimate for blocks of size 2^( 7) =       0.000463194907

      target function =                  N/A
              le_mean =     -16.910009040344
             les_mean =     286.275206982731
             stat err =       0.000453609610
             autocorr =       1.259245998063
              std dev =       0.571665463020
             le_variance =       0.326801401610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228525
  error estimate for blocks of size 2^( 2) =       0.000416049219
  error estimate for blocks of size 2^( 3) =       0.000428196363
  error estimate for blocks of size 2^( 4) =       0.000440750595
  error estimate for blocks of size 2^( 5) =       0.000450682577
  error estimate for blocks of size 2^( 6) =       0.000459810362
  error estimate for blocks of size 2^( 7) =       0.000463194907

      target function =                  N/A
              le_mean =     -16.910009040344
             les_mean =     286.275206982731
             stat err =       0.000453609610
             autocorr =       1.259245998063
              std dev =       0.571665463020
             le_variance =       0.326801401610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326885538028
                                         uncertainty =       0.002768942864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228525
  error estimate for blocks of size 2^( 2) =       0.000416049219
  error estimate for blocks of size 2^( 3) =       0.000428196363
  error estimate for blocks of size 2^( 4) =       0.000440750595
  error estimate for blocks of size 2^( 5) =       0.000450682577
  error estimate for blocks of size 2^( 6) =       0.000459810362
  error estimate for blocks of size 2^( 7) =       0.000463194907

      target function =                  N/A
              le_mean =     -16.910009040344
             les_mean =     286.275206982731
             stat err =       0.000453609610
             autocorr =       1.259245998063
              std dev =       0.571665463020
             le_variance =       0.326801401610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910009040344        initial  <--
     5.8208e+09     5.8208e+10             4.0169e-14       -16.910009040344
     2.3283e+10     2.3283e+11             9.8374e-15       -16.910009040344
     9.3132e+10     9.3132e+11             2.4606e-15       -16.910009040344

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6665
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088619e-01 1 1  ON 0
 uu_1                 1.431617e-01 1 1  ON 1
 uu_2                 4.521530e-02 1 1  ON 2
 uu_3                -1.827807e-02 1 1  ON 3
 uu_4                -6.795169e-02 1 1  ON 4
 uu_5                -1.044789e-01 1 1  ON 5
 uu_6                -1.322383e-01 1 1  ON 6
 uu_7                -1.458338e-01 1 1  ON 7
 uu_8                -1.380519e-01 1 1  ON 8
 uu_9                -1.114431e-01 1 1  ON 9
 ud_0                 4.414362e-01 1 1  ON 10
 ud_1                 1.831047e-01 1 1  ON 11
 ud_2                 6.815047e-02 1 1  ON 12
 ud_3                -1.755954e-03 1 1  ON 13
 ud_4                -5.819182e-02 1 1  ON 14
 ud_5                -1.016865e-01 1 1  ON 15
 ud_6                -1.321022e-01 1 1  ON 16
 ud_7                -1.525785e-01 1 1  ON 17
 ud_8                -1.576482e-01 1 1  ON 18
 ud_9                -1.500806e-01 1 1  ON 19
 eO_0                -7.566318e-01 1 1  ON 20
 eO_1                -4.402633e-01 1 1  ON 21
 eO_2                -2.468825e-02 1 1  ON 22
 eO_3                 3.013982e-01 1 1  ON 23
 eO_4                 5.332532e-01 1 1  ON 24
 eO_5                 4.977285e-01 1 1  ON 25
 eO_6                 2.697830e-01 1 1  ON 26
 eO_7                -3.859089e-02 1 1  ON 27
 eO_8                -2.375772e-01 1 1  ON 28
 eO_9                -1.012926e-01 1 1  ON 29
eH1_0                -2.616542e-01 1 1  ON 30
eH1_1                -1.559833e-01 1 1  ON 31
eH1_2                -1.095050e-01 1 1  ON 32
eH1_3                -5.707542e-02 1 1  ON 33
eH1_4                -5.506496e-03 1 1  ON 34
eH1_5                 3.079280e-02 1 1  ON 35
eH1_6                 9.541859e-02 1 1  ON 36
eH1_7                 1.597135e-01 1 1  ON 37
eH1_8                 1.989687e-01 1 1  ON 38
eH1_9                 9.952064e-02 1 1  ON 39
eH2_0                -2.561897e-01 1 1  ON 40
eH2_1                -1.501172e-01 1 1  ON 41
eH2_2                -1.037818e-01 1 1  ON 42
eH2_3                -5.144611e-02 1 1  ON 43
eH2_4                -3.207209e-04 1 1  ON 44
eH2_5                 3.535165e-02 1 1  ON 45
eH2_6                 9.914826e-02 1 1  ON 46
eH2_7                 1.608457e-01 1 1  ON 47
eH2_8                 2.002556e-01 1 1  ON 48
eH2_9                 8.133304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8136e+01 secs
  Total Execution time = 2.7569e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
