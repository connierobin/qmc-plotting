Rank =    0  Free Memory = 69795 MB
Rank =    1  Free Memory = 69790 MB
Rank =    2  Free Memory = 69789 MB
Rank =    3  Free Memory = 69789 MB
Rank =    4  Free Memory = 69789 MB
Rank =    5  Free Memory = 69789 MB
Rank =    6  Free Memory = 69789 MB
Rank =    7  Free Memory = 69789 MB
Rank =    8  Free Memory = 69789 MB
Rank =    9  Free Memory = 69789 MB
Rank =   10  Free Memory = 69789 MB
Rank =   11  Free Memory = 69789 MB
Rank =   12  Free Memory = 69789 MB
Rank =   13  Free Memory = 69789 MB
Rank =   14  Free Memory = 69788 MB
Rank =   15  Free Memory = 69781 MB
Rank =   16  Free Memory = 69781 MB
Rank =   17  Free Memory = 69781 MB
Rank =   18  Free Memory = 69781 MB
Rank =   19  Free Memory = 69781 MB
Rank =   20  Free Memory = 69781 MB
Rank =   21  Free Memory = 69780 MB
Rank =   22  Free Memory = 69780 MB
Rank =   23  Free Memory = 69780 MB
Rank =   24  Free Memory = 69780 MB
Rank =   25  Free Memory = 69780 MB
Rank =   26  Free Memory = 69780 MB
Rank =   27  Free Memory = 69780 MB
Rank =   28  Free Memory = 69780 MB
Rank =   29  Free Memory = 69780 MB
Rank =   30  Free Memory = 69780 MB
Rank =   31  Free Memory = 69780 MB
Rank =   32  Free Memory = 73078 MB
Rank =   33  Free Memory = 73078 MB
Rank =   34  Free Memory = 73078 MB
Rank =   35  Free Memory = 73078 MB
Rank =   36  Free Memory = 73078 MB
Rank =   37  Free Memory = 73078 MB
Rank =   38  Free Memory = 73078 MB
Rank =   39  Free Memory = 73078 MB
Rank =   40  Free Memory = 73078 MB
Rank =   41  Free Memory = 73078 MB
Rank =   42  Free Memory = 73078 MB
Rank =   43  Free Memory = 73078 MB
Rank =   44  Free Memory = 73078 MB
Rank =   45  Free Memory = 73078 MB
Rank =   46  Free Memory = 73078 MB
Rank =   47  Free Memory = 73078 MB
Rank =   48  Free Memory = 73078 MB
Rank =   49  Free Memory = 73077 MB
Rank =   50  Free Memory = 73077 MB
Rank =   51  Free Memory = 73077 MB
Rank =   52  Free Memory = 73077 MB
Rank =   53  Free Memory = 73077 MB
Rank =   54  Free Memory = 73077 MB
Rank =   55  Free Memory = 73077 MB
Rank =   56  Free Memory = 73077 MB
Rank =   57  Free Memory = 73077 MB
Rank =   58  Free Memory = 73077 MB
Rank =   59  Free Memory = 73077 MB
Rank =   60  Free Memory = 73077 MB
Rank =   61  Free Memory = 73077 MB
Rank =   62  Free Memory = 73077 MB
Rank =   63  Free Memory = 73077 MB
Rank =   64  Free Memory = 70275 MB
Rank =   65  Free Memory = 70275 MB
Rank =   66  Free Memory = 70275 MB
Rank =   67  Free Memory = 70275 MB
Rank =   68  Free Memory = 70275 MB
Rank =   69  Free Memory = 70275 MB
Rank =   70  Free Memory = 70275 MB
Rank =   71  Free Memory = 70275 MB
Rank =   72  Free Memory = 70275 MB
Rank =   73  Free Memory = 70275 MB
Rank =   74  Free Memory = 70275 MB
Rank =   75  Free Memory = 70275 MB
Rank =   76  Free Memory = 70275 MB
Rank =   77  Free Memory = 70275 MB
Rank =   78  Free Memory = 70275 MB
Rank =   79  Free Memory = 70275 MB
Rank =   80  Free Memory = 70275 MB
Rank =   81  Free Memory = 70275 MB
Rank =   82  Free Memory = 70275 MB
Rank =   83  Free Memory = 70275 MB
Rank =   84  Free Memory = 70275 MB
Rank =   85  Free Memory = 70275 MB
Rank =   86  Free Memory = 70275 MB
Rank =   87  Free Memory = 70275 MB
Rank =   88  Free Memory = 70275 MB
Rank =   89  Free Memory = 70275 MB
Rank =   90  Free Memory = 70275 MB
Rank =   91  Free Memory = 70275 MB
Rank =   92  Free Memory = 70275 MB
Rank =   93  Free Memory = 70275 MB
Rank =   94  Free Memory = 70275 MB
Rank =   95  Free Memory = 70275 MB
Rank =   96  Free Memory = 84011 MB
Rank =   97  Free Memory = 84011 MB
Rank =   98  Free Memory = 84011 MB
Rank =   99  Free Memory = 84011 MB
Rank =  100  Free Memory = 84011 MB
Rank =  101  Free Memory = 84011 MB
Rank =  102  Free Memory = 84011 MB
Rank =  103  Free Memory = 84011 MB
Rank =  104  Free Memory = 84011 MB
Rank =  105  Free Memory = 84011 MB
Rank =  106  Free Memory = 84011 MB
Rank =  107  Free Memory = 84011 MB
Rank =  108  Free Memory = 84011 MB
Rank =  109  Free Memory = 84011 MB
Rank =  110  Free Memory = 84011 MB
Rank =  111  Free Memory = 84011 MB
Rank =  112  Free Memory = 84011 MB
Rank =  113  Free Memory = 84011 MB
Rank =  114  Free Memory = 84011 MB
Rank =  115  Free Memory = 84011 MB
Rank =  116  Free Memory = 84011 MB
Rank =  117  Free Memory = 84011 MB
Rank =  118  Free Memory = 84011 MB
Rank =  119  Free Memory = 84011 MB
Rank =  120  Free Memory = 84011 MB
Rank =  121  Free Memory = 84011 MB
Rank =  122  Free Memory = 84011 MB
Rank =  123  Free Memory = 84011 MB
Rank =  124  Free Memory = 84011 MB
Rank =  125  Free Memory = 84011 MB
Rank =  126  Free Memory = 84011 MB
Rank =  127  Free Memory = 84011 MB
  Input file(s): opt_h2o_1b1_gvptt_193dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_193dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:47:43 PDT
  host    = n0011.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 447

  Range of prime numbers to use as seeds over processors and threads = 3169-4217


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 193 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.553658e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 57 unique up determinants.
Found 57 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0317e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8427
    reference variance = 0.132767
====================================================
  Execution time = 2.3677e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2508e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325172936310
                                         uncertainty =       0.004630110851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325172936310
                                         uncertainty =       0.004630110851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403163033
  error estimate for blocks of size 2^( 2) =       0.000416157723
  error estimate for blocks of size 2^( 3) =       0.000429272218
  error estimate for blocks of size 2^( 4) =       0.000441509076
  error estimate for blocks of size 2^( 5) =       0.000452395083
  error estimate for blocks of size 2^( 6) =       0.000460544478
  error estimate for blocks of size 2^( 7) =       0.000464435068

      target function =                  N/A
              le_mean =     -16.908021708977
             les_mean =     286.206278811652
             stat err =       0.000454720926
             autocorr =       1.272121150809
              std dev =       0.570158629629
             le_variance =       0.325080862940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690802170898e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908021708977       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908225614249       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908330610199       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908368700380       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908428109022       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908432379231       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908442328667       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908445672767       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908444402585       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908446191701       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908445079150       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908444884880       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908445081692       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.917626e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908021708977       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908106923161       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908154715688       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908167495820       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908188289898       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908189485518       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908190941175       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908192024652       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908191488573       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908191802049       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908191791411       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.419165e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908021708977       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908047311221       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908062538363       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908066220985       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908071354019       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908072066671       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908072575001       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908072621424       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908072576774       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908072639942       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.630509e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9827e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.024515e-01                 1 1 ON  0
uu_1  1.389213e-01                 1 1 ON  1
uu_2  4.144968e-02                 1 1 ON  2
uu_3  -1.904793e-02                1 1 ON  3
uu_4  -6.287202e-02                1 1 ON  4
uu_5  -9.586292e-02                1 1 ON  5
uu_6  -1.205645e-01                1 1 ON  6
uu_7  -1.310829e-01                1 1 ON  7
uu_8  -1.204584e-01                1 1 ON  8
uu_9  -9.278833e-02                1 1 ON  9
ud_0  4.130888e-01                 1 1 ON  10
ud_1  1.605391e-01                 1 1 ON  11
ud_2  5.964077e-02                 1 1 ON  12
ud_3  5.229855e-04                 1 1 ON  13
ud_4  -5.710447e-02                1 1 ON  14
ud_5  -1.013726e-01                1 1 ON  15
ud_6  -1.288272e-01                1 1 ON  16
ud_7  -1.438676e-01                1 1 ON  17
ud_8  -1.427291e-01                1 1 ON  18
ud_9  -1.343875e-01                1 1 ON  19
eO_0  -7.077292e-01                1 1 ON  20
eO_1  -4.141544e-01                1 1 ON  21
eO_2  -2.971685e-02                1 1 ON  22
eO_3  2.712899e-01                 1 1 ON  23
eO_4  4.918594e-01                 1 1 ON  24
eO_5  4.591851e-01                 1 1 ON  25
eO_6  2.360479e-01                 1 1 ON  26
eO_7  -5.585263e-02                1 1 ON  27
eO_8  -1.960877e-01                1 1 ON  28
eO_9  -5.776704e-02                1 1 ON  29
eH1_0 -2.116175e-01                1 1 ON  30
eH1_1 -1.273511e-01                1 1 ON  31
eH1_2 -8.776300e-02                1 1 ON  32
eH1_3 -3.715498e-02                1 1 ON  33
eH1_4 1.191614e-02                 1 1 ON  34
eH1_5 4.460002e-02                 1 1 ON  35
eH1_6 9.477084e-02                 1 1 ON  36
eH1_7 1.382827e-01                 1 1 ON  37
eH1_8 1.459150e-01                 1 1 ON  38
eH1_9 3.298975e-02                 1 1 ON  39
eH2_0 -2.106099e-01                1 1 ON  40
eH2_1 -1.263095e-01                1 1 ON  41
eH2_2 -8.675930e-02                1 1 ON  42
eH2_3 -3.615490e-02                1 1 ON  43
eH2_4 1.332272e-02                 1 1 ON  44
eH2_5 4.785844e-02                 1 1 ON  45
eH2_6 1.005255e-01                 1 1 ON  46
eH2_7 1.495110e-01                 1 1 ON  47
eH2_8 1.539423e-01                 1 1 ON  48
eH2_9 1.316796e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9399
    reference variance = 0.329786
====================================================
  Execution time = 2.2758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2517e-01
  Total weights = 2.0000e+06
  Execution time = 2.4712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705988127
                                         uncertainty =       0.003770227193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705988127
                                         uncertainty =       0.003770227193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403551426
  error estimate for blocks of size 2^( 2) =       0.000416791600
  error estimate for blocks of size 2^( 3) =       0.000430141055
  error estimate for blocks of size 2^( 4) =       0.000442538017
  error estimate for blocks of size 2^( 5) =       0.000452581458
  error estimate for blocks of size 2^( 6) =       0.000458355058
  error estimate for blocks of size 2^( 7) =       0.000461866434

      target function =                  N/A
              le_mean =     -16.909308535438
             les_mean =     286.250422491163
             stat err =       0.000453835242
             autocorr =       1.264732447871
              std dev =       0.570707900233
             le_variance =       0.325707507389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325930274761
                                         uncertainty =       0.003831800288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325930274761
                                         uncertainty =       0.003831800288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403688287
  error estimate for blocks of size 2^( 2) =       0.000416489468
  error estimate for blocks of size 2^( 3) =       0.000429485333
  error estimate for blocks of size 2^( 4) =       0.000441745976
  error estimate for blocks of size 2^( 5) =       0.000451759235
  error estimate for blocks of size 2^( 6) =       0.000457531273
  error estimate for blocks of size 2^( 7) =       0.000460922072

      target function =                  N/A
              le_mean =     -16.909321515456
             les_mean =     286.251082416963
             stat err =       0.000452989639
             autocorr =       1.259169626959
              std dev =       0.570901451089
             le_variance =       0.325928466856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325104836757
                                         uncertainty =       0.003808942235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325104836757
                                         uncertainty =       0.003808942235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403176887
  error estimate for blocks of size 2^( 2) =       0.000416068240
  error estimate for blocks of size 2^( 3) =       0.000429139113
  error estimate for blocks of size 2^( 4) =       0.000441441417
  error estimate for blocks of size 2^( 5) =       0.000451481149
  error estimate for blocks of size 2^( 6) =       0.000457277197
  error estimate for blocks of size 2^( 7) =       0.000460693066

      target function =                  N/A
              le_mean =     -16.909291414406
             les_mean =     286.249239179115
             stat err =       0.000452723207
             autocorr =       1.260881465549
              std dev =       0.570178221570
             le_variance =       0.325103204353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325423363867
                                         uncertainty =       0.003774971889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325423363867
                                         uncertainty =       0.003774971889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403375980
  error estimate for blocks of size 2^( 2) =       0.000416558200
  error estimate for blocks of size 2^( 3) =       0.000429862305
  error estimate for blocks of size 2^( 4) =       0.000442244704
  error estimate for blocks of size 2^( 5) =       0.000452288802
  error estimate for blocks of size 2^( 6) =       0.000458068072
  error estimate for blocks of size 2^( 7) =       0.000461564759

      target function =                  N/A
              le_mean =     -16.909287244788
             les_mean =     286.249419325803
             stat err =       0.000453541584
             autocorr =       1.264195265880
              std dev =       0.570459781025
             le_variance =       0.325424361767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909308535438        initial
     2.5000e-01     2.5000e+00             9.9176e-03       -16.909321515456  <--
     1.0000e+00     1.0000e+01             3.4192e-03       -16.909291414406
     4.0000e+00     4.0000e+01             9.6305e-04       -16.909287244788

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.5172e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.021340e-01 1 1  ON 0
 uu_1                 1.382471e-01 1 1  ON 1
 uu_2                 4.114710e-02 1 1  ON 2
 uu_3                -1.866572e-02 1 1  ON 3
 uu_4                -6.223204e-02 1 1  ON 4
 uu_5                -9.563659e-02 1 1  ON 5
 uu_6                -1.205699e-01 1 1  ON 6
 uu_7                -1.312949e-01 1 1  ON 7
 uu_8                -1.209536e-01 1 1  ON 8
 uu_9                -9.290497e-02 1 1  ON 9
 ud_0                 4.167714e-01 1 1  ON 10
 ud_1                 1.633416e-01 1 1  ON 11
 ud_2                 5.827699e-02 1 1  ON 12
 ud_3                -2.915183e-03 1 1  ON 13
 ud_4                -5.810444e-02 1 1  ON 14
 ud_5                -1.012446e-01 1 1  ON 15
 ud_6                -1.289713e-01 1 1  ON 16
 ud_7                -1.445573e-01 1 1  ON 17
 ud_8                -1.434949e-01 1 1  ON 18
 ud_9                -1.342127e-01 1 1  ON 19
 eO_0                -7.142276e-01 1 1  ON 20
 eO_1                -4.156325e-01 1 1  ON 21
 eO_2                -2.640285e-02 1 1  ON 22
 eO_3                 2.755001e-01 1 1  ON 23
 eO_4                 4.933447e-01 1 1  ON 24
 eO_5                 4.586779e-01 1 1  ON 25
 eO_6                 2.360731e-01 1 1  ON 26
 eO_7                -5.568374e-02 1 1  ON 27
 eO_8                -1.965791e-01 1 1  ON 28
 eO_9                -5.800330e-02 1 1  ON 29
eH1_0                -2.152960e-01 1 1  ON 30
eH1_1                -1.272371e-01 1 1  ON 31
eH1_2                -8.659212e-02 1 1  ON 32
eH1_3                -3.654744e-02 1 1  ON 33
eH1_4                 1.235782e-02 1 1  ON 34
eH1_5                 4.436091e-02 1 1  ON 35
eH1_6                 9.490524e-02 1 1  ON 36
eH1_7                 1.385924e-01 1 1  ON 37
eH1_8                 1.465673e-01 1 1  ON 38
eH1_9                 3.343989e-02 1 1  ON 39
eH2_0                -2.144904e-01 1 1  ON 40
eH2_1                -1.259969e-01 1 1  ON 41
eH2_2                -8.549375e-02 1 1  ON 42
eH2_3                -3.545699e-02 1 1  ON 43
eH2_4                 1.399792e-02 1 1  ON 44
eH2_5                 4.772538e-02 1 1  ON 45
eH2_6                 1.004078e-01 1 1  ON 46
eH2_7                 1.492617e-01 1 1  ON 47
eH2_8                 1.545093e-01 1 1  ON 48
eH2_9                 1.388912e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.353181
====================================================
  Execution time = 2.3246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057099888
                                         uncertainty =       0.004381501060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057099888
                                         uncertainty =       0.004381501060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407428566
  error estimate for blocks of size 2^( 2) =       0.000419555033
  error estimate for blocks of size 2^( 3) =       0.000431179792
  error estimate for blocks of size 2^( 4) =       0.000442857090
  error estimate for blocks of size 2^( 5) =       0.000452032776
  error estimate for blocks of size 2^( 6) =       0.000459006126
  error estimate for blocks of size 2^( 7) =       0.000463255970

      target function =                  N/A
              le_mean =     -16.908573122982
             les_mean =     286.231840962579
             stat err =       0.000454287991
             autocorr =       1.243253128713
              std dev =       0.576191004222
             le_variance =       0.331996073346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690857312298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908573122982       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908660695082       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908694078810       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908755836635       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908776268181       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908809933844       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908824294592       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908829984537       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908837085452       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908837612877       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908835000845       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908837232954       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908835231586       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908835984991       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908836864431       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908836939621       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908837320873       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.487133e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908573122982       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908628873612       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908651088733       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908672925275       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908693419177       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908701958448       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908708383188       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908711176492       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908710888703       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908710348973       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908710456819       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908710083311       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908710201815       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.693862e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908573122982       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908595845741       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908605694388       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908610615363       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908620212944       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908622485215       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908623323535       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908623339769       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908623168307       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908623319091       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908623208755       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.242759e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9381e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.020257e-01 1 1  ON 0
 uu_1                 1.380832e-01 1 1  ON 1
 uu_2                 4.093089e-02 1 1  ON 2
 uu_3                -1.832498e-02 1 1  ON 3
 uu_4                -6.166423e-02 1 1  ON 4
 uu_5                -9.520477e-02 1 1  ON 5
 uu_6                -1.203314e-01 1 1  ON 6
 uu_7                -1.316536e-01 1 1  ON 7
 uu_8                -1.218409e-01 1 1  ON 8
 uu_9                -9.342385e-02 1 1  ON 9
 ud_0                 4.208197e-01 1 1  ON 10
 ud_1                 1.662175e-01 1 1  ON 11
 ud_2                 5.781124e-02 1 1  ON 12
 ud_3                -5.557769e-03 1 1  ON 13
 ud_4                -5.918588e-02 1 1  ON 14
 ud_5                -1.010107e-01 1 1  ON 15
 ud_6                -1.286580e-01 1 1  ON 16
 ud_7                -1.450827e-01 1 1  ON 17
 ud_8                -1.450390e-01 1 1  ON 18
 ud_9                -1.350266e-01 1 1  ON 19
 eO_0                -7.209215e-01 1 1  ON 20
 eO_1                -4.174319e-01 1 1  ON 21
 eO_2                -2.294705e-02 1 1  ON 22
 eO_3                 2.800015e-01 1 1  ON 23
 eO_4                 4.954988e-01 1 1  ON 24
 eO_5                 4.583425e-01 1 1  ON 25
 eO_6                 2.360489e-01 1 1  ON 26
 eO_7                -5.523334e-02 1 1  ON 27
 eO_8                -1.975104e-01 1 1  ON 28
 eO_9                -5.870766e-02 1 1  ON 29
eH1_0                -2.195216e-01 1 1  ON 30
eH1_1                -1.271143e-01 1 1  ON 31
eH1_2                -8.539956e-02 1 1  ON 32
eH1_3                -3.594995e-02 1 1  ON 33
eH1_4                 1.276209e-02 1 1  ON 34
eH1_5                 4.442726e-02 1 1  ON 35
eH1_6                 9.542601e-02 1 1  ON 36
eH1_7                 1.388081e-01 1 1  ON 37
eH1_8                 1.472654e-01 1 1  ON 38
eH1_9                 3.395923e-02 1 1  ON 39
eH2_0                -2.185080e-01 1 1  ON 40
eH2_1                -1.260193e-01 1 1  ON 41
eH2_2                -8.411650e-02 1 1  ON 42
eH2_3                -3.475918e-02 1 1  ON 43
eH2_4                 1.464236e-02 1 1  ON 44
eH2_5                 4.782546e-02 1 1  ON 45
eH2_6                 1.005111e-01 1 1  ON 46
eH2_7                 1.490881e-01 1 1  ON 47
eH2_8                 1.550848e-01 1 1  ON 48
eH2_9                 1.461526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9655
    reference variance = 0.361555
====================================================
  Execution time = 2.2677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.0000e+06
  Execution time = 2.4602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336530462618
                                         uncertainty =       0.010596002216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336530462618
                                         uncertainty =       0.010596002216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410161667
  error estimate for blocks of size 2^( 2) =       0.000422094187
  error estimate for blocks of size 2^( 3) =       0.000434089299
  error estimate for blocks of size 2^( 4) =       0.000445581442
  error estimate for blocks of size 2^( 5) =       0.000456038462
  error estimate for blocks of size 2^( 6) =       0.000463418224
  error estimate for blocks of size 2^( 7) =       0.000468231863

      target function =                  N/A
              le_mean =     -16.908829725092
             les_mean =     286.244987689994
             stat err =       0.000458317498
             autocorr =       1.248598294679
              std dev =       0.580056192153
             le_variance =       0.336465186055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340043815255
                                         uncertainty =       0.010682496563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340043815255
                                         uncertainty =       0.010682496563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412296483
  error estimate for blocks of size 2^( 2) =       0.000423937639
  error estimate for blocks of size 2^( 3) =       0.000435677764
  error estimate for blocks of size 2^( 4) =       0.000446951039
  error estimate for blocks of size 2^( 5) =       0.000457204961
  error estimate for blocks of size 2^( 6) =       0.000464443349
  error estimate for blocks of size 2^( 7) =       0.000469290058

      target function =                  N/A
              le_mean =     -16.908777126064
             les_mean =     286.246720508231
             stat err =       0.000459472352
             autocorr =       1.241936830701
              std dev =       0.583075277573
             le_variance =       0.339976779317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963851385
                                         uncertainty =       0.010665958294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963851385
                                         uncertainty =       0.010665958294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412247942
  error estimate for blocks of size 2^( 2) =       0.000423888906
  error estimate for blocks of size 2^( 3) =       0.000435638340
  error estimate for blocks of size 2^( 4) =       0.000446918381
  error estimate for blocks of size 2^( 5) =       0.000457173128
  error estimate for blocks of size 2^( 6) =       0.000464387288
  error estimate for blocks of size 2^( 7) =       0.000469266189

      target function =                  N/A
              le_mean =     -16.908786912596
             les_mean =     286.246971417486
             stat err =       0.000459436247
             autocorr =       1.242034093964
              std dev =       0.583006631062
             le_variance =       0.339896731862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336902442373
                                         uncertainty =       0.010602561686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336902442373
                                         uncertainty =       0.010602561686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410388143
  error estimate for blocks of size 2^( 2) =       0.000422254461
  error estimate for blocks of size 2^( 3) =       0.000434195091
  error estimate for blocks of size 2^( 4) =       0.000445642934
  error estimate for blocks of size 2^( 5) =       0.000456060861
  error estimate for blocks of size 2^( 6) =       0.000463406337
  error estimate for blocks of size 2^( 7) =       0.000468236212

      target function =                  N/A
              le_mean =     -16.908789011617
             les_mean =     286.243982527589
             stat err =       0.000458336586
             autocorr =       1.247324466244
              std dev =       0.580376478358
             le_variance =       0.336836856631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908829725092        initial  <--
     6.2500e-02     6.2500e-01             1.4871e-02       -16.908777126064
     2.5000e-01     2.5000e+00             6.6939e-03       -16.908786912596
     1.0000e+00     1.0000e+01             2.2428e-03       -16.908789011617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.3717
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.021340e-01 1 1  ON 0
 uu_1                 1.382471e-01 1 1  ON 1
 uu_2                 4.114710e-02 1 1  ON 2
 uu_3                -1.866572e-02 1 1  ON 3
 uu_4                -6.223204e-02 1 1  ON 4
 uu_5                -9.563659e-02 1 1  ON 5
 uu_6                -1.205699e-01 1 1  ON 6
 uu_7                -1.312949e-01 1 1  ON 7
 uu_8                -1.209536e-01 1 1  ON 8
 uu_9                -9.290497e-02 1 1  ON 9
 ud_0                 4.167714e-01 1 1  ON 10
 ud_1                 1.633416e-01 1 1  ON 11
 ud_2                 5.827699e-02 1 1  ON 12
 ud_3                -2.915183e-03 1 1  ON 13
 ud_4                -5.810444e-02 1 1  ON 14
 ud_5                -1.012446e-01 1 1  ON 15
 ud_6                -1.289713e-01 1 1  ON 16
 ud_7                -1.445573e-01 1 1  ON 17
 ud_8                -1.434949e-01 1 1  ON 18
 ud_9                -1.342127e-01 1 1  ON 19
 eO_0                -7.142276e-01 1 1  ON 20
 eO_1                -4.156325e-01 1 1  ON 21
 eO_2                -2.640285e-02 1 1  ON 22
 eO_3                 2.755001e-01 1 1  ON 23
 eO_4                 4.933447e-01 1 1  ON 24
 eO_5                 4.586779e-01 1 1  ON 25
 eO_6                 2.360731e-01 1 1  ON 26
 eO_7                -5.568374e-02 1 1  ON 27
 eO_8                -1.965791e-01 1 1  ON 28
 eO_9                -5.800330e-02 1 1  ON 29
eH1_0                -2.152960e-01 1 1  ON 30
eH1_1                -1.272371e-01 1 1  ON 31
eH1_2                -8.659212e-02 1 1  ON 32
eH1_3                -3.654744e-02 1 1  ON 33
eH1_4                 1.235782e-02 1 1  ON 34
eH1_5                 4.436091e-02 1 1  ON 35
eH1_6                 9.490524e-02 1 1  ON 36
eH1_7                 1.385924e-01 1 1  ON 37
eH1_8                 1.465673e-01 1 1  ON 38
eH1_9                 3.343989e-02 1 1  ON 39
eH2_0                -2.144904e-01 1 1  ON 40
eH2_1                -1.259969e-01 1 1  ON 41
eH2_2                -8.549375e-02 1 1  ON 42
eH2_3                -3.545699e-02 1 1  ON 43
eH2_4                 1.399792e-02 1 1  ON 44
eH2_5                 4.772538e-02 1 1  ON 45
eH2_6                 1.004078e-01 1 1  ON 46
eH2_7                 1.492617e-01 1 1  ON 47
eH2_8                 1.545093e-01 1 1  ON 48
eH2_9                 1.388912e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.259919
====================================================
  Execution time = 2.3358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2848e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328566382854
                                         uncertainty =       0.005077663685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328566382854
                                         uncertainty =       0.005077663685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405268495
  error estimate for blocks of size 2^( 2) =       0.000417629264
  error estimate for blocks of size 2^( 3) =       0.000430562828
  error estimate for blocks of size 2^( 4) =       0.000443173104
  error estimate for blocks of size 2^( 5) =       0.000453831570
  error estimate for blocks of size 2^( 6) =       0.000463243994
  error estimate for blocks of size 2^( 7) =       0.000468710528

      target function =                  N/A
              le_mean =     -16.908552681510
             les_mean =     286.227638725217
             stat err =       0.000457239799
             autocorr =       1.272923671282
              std dev =       0.573136202019
             le_variance =       0.328485106064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690855268151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908552681510       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908578216067       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908586808569       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908596188265       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908607701935       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908610678483       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908611473202       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908611751878       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908612333008       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908612040683       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908612124033       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.326623e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908552681510       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908560930453       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908563876181       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908566298893       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908570231951       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908570684391       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908570813553       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908570946913       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908570886005       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.739095e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908552681510       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908554906263       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908555722047       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908556337074       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908557405552       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908557445796       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908557506712       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908557529884       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908557541951       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.554427e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9465e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.020811e-01 1 1  ON 0
 uu_1                 1.381546e-01 1 1  ON 1
 uu_2                 4.113258e-02 1 1  ON 2
 uu_3                -1.858439e-02 1 1  ON 3
 uu_4                -6.212774e-02 1 1  ON 4
 uu_5                -9.558742e-02 1 1  ON 5
 uu_6                -1.205337e-01 1 1  ON 6
 uu_7                -1.313383e-01 1 1  ON 7
 uu_8                -1.210486e-01 1 1  ON 8
 uu_9                -9.296263e-02 1 1  ON 9
 ud_0                 4.172941e-01 1 1  ON 10
 ud_1                 1.637580e-01 1 1  ON 11
 ud_2                 5.807004e-02 1 1  ON 12
 ud_3                -3.363807e-03 1 1  ON 13
 ud_4                -5.820947e-02 1 1  ON 14
 ud_5                -1.012086e-01 1 1  ON 15
 ud_6                -1.289601e-01 1 1  ON 16
 ud_7                -1.445809e-01 1 1  ON 17
 ud_8                -1.435838e-01 1 1  ON 18
 ud_9                -1.342507e-01 1 1  ON 19
 eO_0                -7.152015e-01 1 1  ON 20
 eO_1                -4.157508e-01 1 1  ON 21
 eO_2                -2.591776e-02 1 1  ON 22
 eO_3                 2.761059e-01 1 1  ON 23
 eO_4                 4.935272e-01 1 1  ON 24
 eO_5                 4.585905e-01 1 1  ON 25
 eO_6                 2.360567e-01 1 1  ON 26
 eO_7                -5.561736e-02 1 1  ON 27
 eO_8                -1.966506e-01 1 1  ON 28
 eO_9                -5.806631e-02 1 1  ON 29
eH1_0                -2.158608e-01 1 1  ON 30
eH1_1                -1.272369e-01 1 1  ON 31
eH1_2                -8.638075e-02 1 1  ON 32
eH1_3                -3.644789e-02 1 1  ON 33
eH1_4                 1.246242e-02 1 1  ON 34
eH1_5                 4.433379e-02 1 1  ON 35
eH1_6                 9.495223e-02 1 1  ON 36
eH1_7                 1.386178e-01 1 1  ON 37
eH1_8                 1.466363e-01 1 1  ON 38
eH1_9                 3.348616e-02 1 1  ON 39
eH2_0                -2.150127e-01 1 1  ON 40
eH2_1                -1.260143e-01 1 1  ON 41
eH2_2                -8.531578e-02 1 1  ON 42
eH2_3                -3.535414e-02 1 1  ON 43
eH2_4                 1.408490e-02 1 1  ON 44
eH2_5                 4.771210e-02 1 1  ON 45
eH2_6                 1.004247e-01 1 1  ON 46
eH2_7                 1.492732e-01 1 1  ON 47
eH2_8                 1.545889e-01 1 1  ON 48
eH2_9                 1.397270e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.375371
====================================================
  Execution time = 2.2624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2257e-01
  Total weights = 2.0000e+06
  Execution time = 2.4456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322468050153
                                         uncertainty =       0.002815682448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322468050153
                                         uncertainty =       0.002815682448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401518390
  error estimate for blocks of size 2^( 2) =       0.000413710960
  error estimate for blocks of size 2^( 3) =       0.000426929423
  error estimate for blocks of size 2^( 4) =       0.000438796201
  error estimate for blocks of size 2^( 5) =       0.000449725420
  error estimate for blocks of size 2^( 6) =       0.000456012689
  error estimate for blocks of size 2^( 7) =       0.000459265992

      target function =                  N/A
              le_mean =     -16.909283312580
             les_mean =     286.246296018433
             stat err =       0.000450950075
             autocorr =       1.261380306008
              std dev =       0.567832752264
             le_variance =       0.322434034544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035719444
                                         uncertainty =       0.002821229875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035719444
                                         uncertainty =       0.002821229875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401871899
  error estimate for blocks of size 2^( 2) =       0.000413975271
  error estimate for blocks of size 2^( 3) =       0.000427117256
  error estimate for blocks of size 2^( 4) =       0.000438935837
  error estimate for blocks of size 2^( 5) =       0.000449853931
  error estimate for blocks of size 2^( 6) =       0.000456112919
  error estimate for blocks of size 2^( 7) =       0.000459388918

      target function =                  N/A
              le_mean =     -16.909300634402
             les_mean =     286.247449828994
             stat err =       0.000451072901
             autocorr =       1.259848132573
              std dev =       0.568332689454
             le_variance =       0.323002045902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322750451585
                                         uncertainty =       0.002818247654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322750451585
                                         uncertainty =       0.002818247654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401694332
  error estimate for blocks of size 2^( 2) =       0.000413830849
  error estimate for blocks of size 2^( 3) =       0.000427002373
  error estimate for blocks of size 2^( 4) =       0.000438839203
  error estimate for blocks of size 2^( 5) =       0.000449765105
  error estimate for blocks of size 2^( 6) =       0.000456035076
  error estimate for blocks of size 2^( 7) =       0.000459305944

      target function =                  N/A
              le_mean =     -16.909290558851
             les_mean =     286.246823715102
             stat err =       0.000450986332
             autocorr =       1.260478238570
              std dev =       0.568081572324
             le_variance =       0.322716672814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322498968725
                                         uncertainty =       0.002815975661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322498968725
                                         uncertainty =       0.002815975661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401537661
  error estimate for blocks of size 2^( 2) =       0.000413722463
  error estimate for blocks of size 2^( 3) =       0.000426934513
  error estimate for blocks of size 2^( 4) =       0.000438797207
  error estimate for blocks of size 2^( 5) =       0.000449726210
  error estimate for blocks of size 2^( 6) =       0.000456011223
  error estimate for blocks of size 2^( 7) =       0.000459267067

      target function =                  N/A
              le_mean =     -16.909283583123
             les_mean =     286.246336119129
             stat err =       0.000450950427
             autocorr =       1.261261199269
              std dev =       0.567860005549
             le_variance =       0.322464985902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909283312580        initial
     6.2500e-01     6.2500e+00             3.3266e-03       -16.909300634402  <--
     2.5000e+00     2.5000e+01             9.7391e-04       -16.909290558851
     1.0000e+01     1.0000e+02             2.5544e-04       -16.909283583123

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.4952e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.020373e-01 1 1  ON 0
 uu_1                 1.380145e-01 1 1  ON 1
 uu_2                 4.109167e-02 1 1  ON 2
 uu_3                -1.845158e-02 1 1  ON 3
 uu_4                -6.192448e-02 1 1  ON 4
 uu_5                -9.545648e-02 1 1  ON 5
 uu_6                -1.204460e-01 1 1  ON 6
 uu_7                -1.314595e-01 1 1  ON 7
 uu_8                -1.213305e-01 1 1  ON 8
 uu_9                -9.314037e-02 1 1  ON 9
 ud_0                 4.186133e-01 1 1  ON 10
 ud_1                 1.646274e-01 1 1  ON 11
 ud_2                 5.772922e-02 1 1  ON 12
 ud_3                -4.353141e-03 1 1  ON 13
 ud_4                -5.859379e-02 1 1  ON 14
 ud_5                -1.011528e-01 1 1  ON 15
 ud_6                -1.288925e-01 1 1  ON 16
 ud_7                -1.446095e-01 1 1  ON 17
 ud_8                -1.438187e-01 1 1  ON 18
 ud_9                -1.343590e-01 1 1  ON 19
 eO_0                -7.175543e-01 1 1  ON 20
 eO_1                -4.162271e-01 1 1  ON 21
 eO_2                -2.483390e-02 1 1  ON 22
 eO_3                 2.776466e-01 1 1  ON 23
 eO_4                 4.941633e-01 1 1  ON 24
 eO_5                 4.584312e-01 1 1  ON 25
 eO_6                 2.360144e-01 1 1  ON 26
 eO_7                -5.541884e-02 1 1  ON 27
 eO_8                -1.968625e-01 1 1  ON 28
 eO_9                -5.825525e-02 1 1  ON 29
eH1_0                -2.173364e-01 1 1  ON 30
eH1_1                -1.272561e-01 1 1  ON 31
eH1_2                -8.586985e-02 1 1  ON 32
eH1_3                -3.617903e-02 1 1  ON 33
eH1_4                 1.269569e-02 1 1  ON 34
eH1_5                 4.427222e-02 1 1  ON 35
eH1_6                 9.510487e-02 1 1  ON 36
eH1_7                 1.386962e-01 1 1  ON 37
eH1_8                 1.468429e-01 1 1  ON 38
eH1_9                 3.362533e-02 1 1  ON 39
eH2_0                -2.163847e-01 1 1  ON 40
eH2_1                -1.260830e-01 1 1  ON 41
eH2_2                -8.488043e-02 1 1  ON 42
eH2_3                -3.508554e-02 1 1  ON 43
eH2_4                 1.427257e-02 1 1  ON 44
eH2_5                 4.768420e-02 1 1  ON 45
eH2_6                 1.004933e-01 1 1  ON 46
eH2_7                 1.493125e-01 1 1  ON 47
eH2_8                 1.548270e-01 1 1  ON 48
eH2_9                 1.422326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.217743
====================================================
  Execution time = 2.3141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2005e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320013380823
                                         uncertainty =       0.002464405080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320013380823
                                         uncertainty =       0.002464405080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400034082
  error estimate for blocks of size 2^( 2) =       0.000412903001
  error estimate for blocks of size 2^( 3) =       0.000426035623
  error estimate for blocks of size 2^( 4) =       0.000438626312
  error estimate for blocks of size 2^( 5) =       0.000450502507
  error estimate for blocks of size 2^( 6) =       0.000458477332
  error estimate for blocks of size 2^( 7) =       0.000461949182

      target function =                  N/A
              le_mean =     -16.908470677585
             les_mean =     286.216435027639
             stat err =       0.000452388833
             autocorr =       1.278879912687
              std dev =       0.565733623650
             le_variance =       0.320054532928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690847067758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908470677585       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908491512187       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908504627027       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908522294687       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908543100687       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908545338563       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908543896489       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908544067388       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908544845355       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908544978186       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908544811179       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908544853417       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908545238731       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908545340062       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.105673e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908470677585       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908480401600       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908486437721       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908490686670       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908501191064       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908501170087       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908500695421       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908500301658       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908500435586       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908500459671       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908500465773       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.827642e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908470677585       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908473781218       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908475754008       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908476746319       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908479904105       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908479751601       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908479685024       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908479605281       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908479627828       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908479621667       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.090532e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9201e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.019921e-01 1 1  ON 0
 uu_1                 1.379600e-01 1 1  ON 1
 uu_2                 4.099138e-02 1 1  ON 2
 uu_3                -1.842315e-02 1 1  ON 3
 uu_4                -6.179124e-02 1 1  ON 4
 uu_5                -9.526695e-02 1 1  ON 5
 uu_6                -1.204520e-01 1 1  ON 6
 uu_7                -1.315963e-01 1 1  ON 7
 uu_8                -1.216638e-01 1 1  ON 8
 uu_9                -9.324600e-02 1 1  ON 9
 ud_0                 4.200566e-01 1 1  ON 10
 ud_1                 1.655706e-01 1 1  ON 11
 ud_2                 5.739079e-02 1 1  ON 12
 ud_3                -5.554553e-03 1 1  ON 13
 ud_4                -5.914723e-02 1 1  ON 14
 ud_5                -1.012021e-01 1 1  ON 15
 ud_6                -1.288588e-01 1 1  ON 16
 ud_7                -1.446334e-01 1 1  ON 17
 ud_8                -1.439494e-01 1 1  ON 18
 ud_9                -1.344601e-01 1 1  ON 19
 eO_0                -7.203819e-01 1 1  ON 20
 eO_1                -4.170820e-01 1 1  ON 21
 eO_2                -2.362331e-02 1 1  ON 22
 eO_3                 2.795749e-01 1 1  ON 23
 eO_4                 4.952487e-01 1 1  ON 24
 eO_5                 4.582969e-01 1 1  ON 25
 eO_6                 2.359895e-01 1 1  ON 26
 eO_7                -5.528160e-02 1 1  ON 27
 eO_8                -1.971549e-01 1 1  ON 28
 eO_9                -5.846586e-02 1 1  ON 29
eH1_0                -2.190317e-01 1 1  ON 30
eH1_1                -1.272336e-01 1 1  ON 31
eH1_2                -8.544726e-02 1 1  ON 32
eH1_3                -3.594978e-02 1 1  ON 33
eH1_4                 1.290703e-02 1 1  ON 34
eH1_5                 4.410063e-02 1 1  ON 35
eH1_6                 9.513925e-02 1 1  ON 36
eH1_7                 1.388477e-01 1 1  ON 37
eH1_8                 1.472148e-01 1 1  ON 38
eH1_9                 3.397079e-02 1 1  ON 39
eH2_0                -2.179797e-01 1 1  ON 40
eH2_1                -1.260398e-01 1 1  ON 41
eH2_2                -8.434055e-02 1 1  ON 42
eH2_3                -3.489795e-02 1 1  ON 43
eH2_4                 1.451756e-02 1 1  ON 44
eH2_5                 4.760000e-02 1 1  ON 45
eH2_6                 1.005862e-01 1 1  ON 46
eH2_7                 1.492819e-01 1 1  ON 47
eH2_8                 1.550667e-01 1 1  ON 48
eH2_9                 1.456682e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.196867
====================================================
  Execution time = 2.2620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3110e-01
  Total weights = 2.0000e+06
  Execution time = 2.4605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330485248130
                                         uncertainty =       0.004276940627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330485248130
                                         uncertainty =       0.004276940627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406510245
  error estimate for blocks of size 2^( 2) =       0.000418844958
  error estimate for blocks of size 2^( 3) =       0.000431372046
  error estimate for blocks of size 2^( 4) =       0.000443146832
  error estimate for blocks of size 2^( 5) =       0.000453773240
  error estimate for blocks of size 2^( 6) =       0.000461337623
  error estimate for blocks of size 2^( 7) =       0.000464466207

      target function =                  N/A
              le_mean =     -16.908900168437
             les_mean =     286.241405899561
             stat err =       0.000455680975
             autocorr =       1.256547191814
              std dev =       0.574892301775
             le_variance =       0.330501158640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332282144817
                                         uncertainty =       0.004293824318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332282144817
                                         uncertainty =       0.004293824318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613708
  error estimate for blocks of size 2^( 2) =       0.000419801048
  error estimate for blocks of size 2^( 3) =       0.000432205822
  error estimate for blocks of size 2^( 4) =       0.000443878778
  error estimate for blocks of size 2^( 5) =       0.000454470625
  error estimate for blocks of size 2^( 6) =       0.000461989505
  error estimate for blocks of size 2^( 7) =       0.000465098588

      target function =                  N/A
              le_mean =     -16.908900875881
             les_mean =     286.243226534297
             stat err =       0.000456359374
             autocorr =       1.253477058957
              std dev =       0.576452834211
             le_variance =       0.332297870070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331772632256
                                         uncertainty =       0.004288463030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331772632256
                                         uncertainty =       0.004288463030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407301143
  error estimate for blocks of size 2^( 2) =       0.000419516259
  error estimate for blocks of size 2^( 3) =       0.000431948780
  error estimate for blocks of size 2^( 4) =       0.000443646520
  error estimate for blocks of size 2^( 5) =       0.000454250029
  error estimate for blocks of size 2^( 6) =       0.000461792475
  error estimate for blocks of size 2^( 7) =       0.000464912768

      target function =                  N/A
              le_mean =     -16.908896650496
             les_mean =     286.242574213099
             stat err =       0.000456150448
             autocorr =       1.254252437899
              std dev =       0.576010800117
             le_variance =       0.331788441851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330640602121
                                         uncertainty =       0.004278328473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330640602121
                                         uncertainty =       0.004278328473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406605762
  error estimate for blocks of size 2^( 2) =       0.000418920818
  error estimate for blocks of size 2^( 3) =       0.000431432761
  error estimate for blocks of size 2^( 4) =       0.000443195580
  error estimate for blocks of size 2^( 5) =       0.000453818498
  error estimate for blocks of size 2^( 6) =       0.000461380765
  error estimate for blocks of size 2^( 7) =       0.000464509123

      target function =                  N/A
              le_mean =     -16.908895724837
             les_mean =     286.241410960041
             stat err =       0.000455725991
             autocorr =       1.256205060647
              std dev =       0.575027383664
             le_variance =       0.330656491963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908900168437        initial
     1.5625e-01     1.5625e+00             8.1057e-03       -16.908900875881  <--
     6.2500e-01     6.2500e+00             2.8276e-03       -16.908896650496
     2.5000e+00     2.5000e+01             8.0905e-04       -16.908895724837

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.5018e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.023309e-01 1 1  ON 0
 uu_1                 1.382085e-01 1 1  ON 1
 uu_2                 4.092172e-02 1 1  ON 2
 uu_3                -1.856857e-02 1 1  ON 3
 uu_4                -6.188389e-02 1 1  ON 4
 uu_5                -9.511520e-02 1 1  ON 5
 uu_6                -1.204818e-01 1 1  ON 6
 uu_7                -1.319669e-01 1 1  ON 7
 uu_8                -1.225918e-01 1 1  ON 8
 uu_9                -9.361411e-02 1 1  ON 9
 ud_0                 4.224549e-01 1 1  ON 10
 ud_1                 1.669824e-01 1 1  ON 11
 ud_2                 5.723740e-02 1 1  ON 12
 ud_3                -7.105109e-03 1 1  ON 13
 ud_4                -6.045072e-02 1 1  ON 14
 ud_5                -1.015571e-01 1 1  ON 15
 ud_6                -1.288037e-01 1 1  ON 16
 ud_7                -1.445820e-01 1 1  ON 17
 ud_8                -1.441794e-01 1 1  ON 18
 ud_9                -1.347179e-01 1 1  ON 19
 eO_0                -7.256599e-01 1 1  ON 20
 eO_1                -4.193800e-01 1 1  ON 21
 eO_2                -2.221286e-02 1 1  ON 22
 eO_3                 2.831594e-01 1 1  ON 23
 eO_4                 4.983731e-01 1 1  ON 24
 eO_5                 4.588155e-01 1 1  ON 25
 eO_6                 2.361088e-01 1 1  ON 26
 eO_7                -5.491099e-02 1 1  ON 27
 eO_8                -1.980202e-01 1 1  ON 28
 eO_9                -5.910060e-02 1 1  ON 29
eH1_0                -2.223494e-01 1 1  ON 30
eH1_1                -1.274918e-01 1 1  ON 31
eH1_2                -8.500575e-02 1 1  ON 32
eH1_3                -3.558653e-02 1 1  ON 33
eH1_4                 1.304639e-02 1 1  ON 34
eH1_5                 4.367636e-02 1 1  ON 35
eH1_6                 9.530395e-02 1 1  ON 36
eH1_7                 1.393412e-01 1 1  ON 37
eH1_8                 1.483244e-01 1 1  ON 38
eH1_9                 3.501822e-02 1 1  ON 39
eH2_0                -2.210385e-01 1 1  ON 40
eH2_1                -1.261492e-01 1 1  ON 41
eH2_2                -8.368941e-02 1 1  ON 42
eH2_3                -3.451281e-02 1 1  ON 43
eH2_4                 1.473218e-02 1 1  ON 44
eH2_5                 4.736711e-02 1 1  ON 45
eH2_6                 1.009227e-01 1 1  ON 46
eH2_7                 1.492915e-01 1 1  ON 47
eH2_8                 1.557833e-01 1 1  ON 48
eH2_9                 1.559939e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9792
    reference variance = 0.445453
====================================================
  Execution time = 2.3219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325816514827
                                         uncertainty =       0.003502737712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325816514827
                                         uncertainty =       0.003502737712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403621283
  error estimate for blocks of size 2^( 2) =       0.000416161111
  error estimate for blocks of size 2^( 3) =       0.000429324995
  error estimate for blocks of size 2^( 4) =       0.000442405129
  error estimate for blocks of size 2^( 5) =       0.000453050688
  error estimate for blocks of size 2^( 6) =       0.000461545407
  error estimate for blocks of size 2^( 7) =       0.000469546385

      target function =                  N/A
              le_mean =     -16.908614044616
             les_mean =     286.227049026321
             stat err =       0.000456636902
             autocorr =       1.279952622102
              std dev =       0.570806691848
             le_variance =       0.325820279459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690861404462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614044616       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908621253643       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908629174163       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908653393380       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908665398279       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908669827806       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908663895269       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908669342468       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908670143314       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908670173108       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908673464273       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908676801446       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908676891966       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908679071596       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908678774253       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908678383395       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908678682063       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908678314322       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.255393e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614044616       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908618942603       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908623995778       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908640620481       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908646581259       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908644725660       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908642666048       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908642698712       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908643660198       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908643397001       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908643353708       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908644079367       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908644058623       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 5.219109e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614044616       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908616190686       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908618303386       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908622921777       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908625062329       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908625677077       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908624849397       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908624616830       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908624849585       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908624801103       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.709360e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9382e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.026188e-01 1 1  ON 0
 uu_1                 1.384341e-01 1 1  ON 1
 uu_2                 4.067377e-02 1 1  ON 2
 uu_3                -1.890709e-02 1 1  ON 3
 uu_4                -6.229850e-02 1 1  ON 4
 uu_5                -9.510160e-02 1 1  ON 5
 uu_6                -1.208485e-01 1 1  ON 6
 uu_7                -1.320765e-01 1 1  ON 7
 uu_8                -1.227228e-01 1 1  ON 8
 uu_9                -9.393955e-02 1 1  ON 9
 ud_0                 4.247492e-01 1 1  ON 10
 ud_1                 1.683626e-01 1 1  ON 11
 ud_2                 5.734559e-02 1 1  ON 12
 ud_3                -8.366433e-03 1 1  ON 13
 ud_4                -6.187909e-02 1 1  ON 14
 ud_5                -1.022934e-01 1 1  ON 15
 ud_6                -1.291290e-01 1 1  ON 16
 ud_7                -1.449225e-01 1 1  ON 17
 ud_8                -1.444634e-01 1 1  ON 18
 ud_9                -1.344338e-01 1 1  ON 19
 eO_0                -7.308790e-01 1 1  ON 20
 eO_1                -4.221186e-01 1 1  ON 21
 eO_2                -2.124458e-02 1 1  ON 22
 eO_3                 2.863533e-01 1 1  ON 23
 eO_4                 5.020177e-01 1 1  ON 24
 eO_5                 4.599771e-01 1 1  ON 25
 eO_6                 2.362026e-01 1 1  ON 26
 eO_7                -5.418912e-02 1 1  ON 27
 eO_8                -1.989171e-01 1 1  ON 28
 eO_9                -5.990132e-02 1 1  ON 29
eH1_0                -2.260189e-01 1 1  ON 30
eH1_1                -1.278840e-01 1 1  ON 31
eH1_2                -8.483446e-02 1 1  ON 32
eH1_3                -3.558272e-02 1 1  ON 33
eH1_4                 1.283009e-02 1 1  ON 34
eH1_5                 4.311675e-02 1 1  ON 35
eH1_6                 9.668024e-02 1 1  ON 36
eH1_7                 1.406815e-01 1 1  ON 37
eH1_8                 1.493690e-01 1 1  ON 38
eH1_9                 3.602265e-02 1 1  ON 39
eH2_0                -2.241635e-01 1 1  ON 40
eH2_1                -1.263665e-01 1 1  ON 41
eH2_2                -8.349058e-02 1 1  ON 42
eH2_3                -3.383783e-02 1 1  ON 43
eH2_4                 1.454639e-02 1 1  ON 44
eH2_5                 4.659309e-02 1 1  ON 45
eH2_6                 1.009906e-01 1 1  ON 46
eH2_7                 1.489267e-01 1 1  ON 47
eH2_8                 1.572187e-01 1 1  ON 48
eH2_9                 1.755452e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.879
    reference variance = 0.214675
====================================================
  Execution time = 2.2640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3090e-01
  Total weights = 2.0000e+06
  Execution time = 2.4595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329651954618
                                         uncertainty =       0.006057993000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329651954618
                                         uncertainty =       0.006057993000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405941292
  error estimate for blocks of size 2^( 2) =       0.000417201821
  error estimate for blocks of size 2^( 3) =       0.000429722932
  error estimate for blocks of size 2^( 4) =       0.000441888867
  error estimate for blocks of size 2^( 5) =       0.000451325118
  error estimate for blocks of size 2^( 6) =       0.000459162532
  error estimate for blocks of size 2^( 7) =       0.000465728797

      target function =                  N/A
              le_mean =     -16.909244003751
             les_mean =     286.252109278463
             stat err =       0.000454526329
             autocorr =       1.253694241046
              std dev =       0.574087680470
             le_variance =       0.329576664867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332462617130
                                         uncertainty =       0.006093567802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332462617130
                                         uncertainty =       0.006093567802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407667113
  error estimate for blocks of size 2^( 2) =       0.000418824940
  error estimate for blocks of size 2^( 3) =       0.000431237037
  error estimate for blocks of size 2^( 4) =       0.000443305021
  error estimate for blocks of size 2^( 5) =       0.000452630231
  error estimate for blocks of size 2^( 6) =       0.000460381884
  error estimate for blocks of size 2^( 7) =       0.000466880137

      target function =                  N/A
              le_mean =     -16.909239433272
             les_mean =     286.254762996011
             stat err =       0.000455799318
             autocorr =       1.250074760403
              std dev =       0.576528360507
             le_variance =       0.332384950468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420600349
                                         uncertainty =       0.006093496546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420600349
                                         uncertainty =       0.006093496546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407641197
  error estimate for blocks of size 2^( 2) =       0.000418793924
  error estimate for blocks of size 2^( 3) =       0.000431209740
  error estimate for blocks of size 2^( 4) =       0.000443296831
  error estimate for blocks of size 2^( 5) =       0.000452646753
  error estimate for blocks of size 2^( 6) =       0.000460410436
  error estimate for blocks of size 2^( 7) =       0.000466922872

      target function =                  N/A
              le_mean =     -16.909246986279
             les_mean =     286.254976167529
             stat err =       0.000455819223
             autocorr =       1.250342912924
              std dev =       0.576491709138
             le_variance =       0.332342690705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330110164412
                                         uncertainty =       0.006064368554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330110164412
                                         uncertainty =       0.006064368554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406223070
  error estimate for blocks of size 2^( 2) =       0.000417460110
  error estimate for blocks of size 2^( 3) =       0.000429959092
  error estimate for blocks of size 2^( 4) =       0.000442110256
  error estimate for blocks of size 2^( 5) =       0.000451532449
  error estimate for blocks of size 2^( 6) =       0.000459356627
  error estimate for blocks of size 2^( 7) =       0.000465915049

      target function =                  N/A
              le_mean =     -16.909237614903
             les_mean =     286.252350917499
             stat err =       0.000454728595
             autocorr =       1.253070085816
              std dev =       0.574486175006
             le_variance =       0.330034365273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909244003751        initial
     3.9062e-02     3.9062e-01             1.2554e-02       -16.909239433272
     1.5625e-01     1.5625e+00             5.2191e-03       -16.909246986279  <--
     6.2500e-01     6.2500e+00             1.7094e-03       -16.909237614903

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.5261e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.026188e-01 1 1  ON 0
 uu_1                 1.384341e-01 1 1  ON 1
 uu_2                 4.067377e-02 1 1  ON 2
 uu_3                -1.890709e-02 1 1  ON 3
 uu_4                -6.229850e-02 1 1  ON 4
 uu_5                -9.510160e-02 1 1  ON 5
 uu_6                -1.208485e-01 1 1  ON 6
 uu_7                -1.320765e-01 1 1  ON 7
 uu_8                -1.227228e-01 1 1  ON 8
 uu_9                -9.393955e-02 1 1  ON 9
 ud_0                 4.247492e-01 1 1  ON 10
 ud_1                 1.683626e-01 1 1  ON 11
 ud_2                 5.734559e-02 1 1  ON 12
 ud_3                -8.366433e-03 1 1  ON 13
 ud_4                -6.187909e-02 1 1  ON 14
 ud_5                -1.022934e-01 1 1  ON 15
 ud_6                -1.291290e-01 1 1  ON 16
 ud_7                -1.449225e-01 1 1  ON 17
 ud_8                -1.444634e-01 1 1  ON 18
 ud_9                -1.344338e-01 1 1  ON 19
 eO_0                -7.308790e-01 1 1  ON 20
 eO_1                -4.221186e-01 1 1  ON 21
 eO_2                -2.124458e-02 1 1  ON 22
 eO_3                 2.863533e-01 1 1  ON 23
 eO_4                 5.020177e-01 1 1  ON 24
 eO_5                 4.599771e-01 1 1  ON 25
 eO_6                 2.362026e-01 1 1  ON 26
 eO_7                -5.418912e-02 1 1  ON 27
 eO_8                -1.989171e-01 1 1  ON 28
 eO_9                -5.990132e-02 1 1  ON 29
eH1_0                -2.260189e-01 1 1  ON 30
eH1_1                -1.278840e-01 1 1  ON 31
eH1_2                -8.483446e-02 1 1  ON 32
eH1_3                -3.558272e-02 1 1  ON 33
eH1_4                 1.283009e-02 1 1  ON 34
eH1_5                 4.311675e-02 1 1  ON 35
eH1_6                 9.668024e-02 1 1  ON 36
eH1_7                 1.406815e-01 1 1  ON 37
eH1_8                 1.493690e-01 1 1  ON 38
eH1_9                 3.602265e-02 1 1  ON 39
eH2_0                -2.241635e-01 1 1  ON 40
eH2_1                -1.263665e-01 1 1  ON 41
eH2_2                -8.349058e-02 1 1  ON 42
eH2_3                -3.383783e-02 1 1  ON 43
eH2_4                 1.454639e-02 1 1  ON 44
eH2_5                 4.659309e-02 1 1  ON 45
eH2_6                 1.009906e-01 1 1  ON 46
eH2_7                 1.489267e-01 1 1  ON 47
eH2_8                 1.572187e-01 1 1  ON 48
eH2_9                 1.755452e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9247
    reference variance = 0.194662
====================================================
  Execution time = 2.2904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343371766622
                                         uncertainty =       0.009164590880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343371766622
                                         uncertainty =       0.009164590880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414307951
  error estimate for blocks of size 2^( 2) =       0.000426002530
  error estimate for blocks of size 2^( 3) =       0.000438311596
  error estimate for blocks of size 2^( 4) =       0.000450105758
  error estimate for blocks of size 2^( 5) =       0.000460647404
  error estimate for blocks of size 2^( 6) =       0.000468511761
  error estimate for blocks of size 2^( 7) =       0.000471996950

      target function =                  N/A
              le_mean =     -16.909423947773
             les_mean =     286.271920230676
             stat err =       0.000462815468
             autocorr =       1.247869569914
              std dev =       0.585919923558
             le_variance =       0.343302156822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690942394777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909423947773       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909434365461       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909436923933       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909452429205       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909451676243       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909458285218       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909463970024       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909468050317       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909469049225       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909471542377       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909470359256       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909470242614       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909470853915       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909471597211       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909471517952       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909470969950       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909471265135       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 8.731873e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909423947773       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909431253275       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909432344851       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909440774569       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909440402267       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909442299943       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909444039894       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909444629653       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909444498630       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909444799875       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909444394261       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909444568859       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.282042e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909423947773       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909427276074       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909427550910       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909430267816       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909430448692       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909430738871       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909430826293       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909430854035       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909430856043       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909430927267       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.018140e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9136e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.031465e-01 1 1  ON 0
 uu_1                 1.388058e-01 1 1  ON 1
 uu_2                 4.096709e-02 1 1  ON 2
 uu_3                -1.887011e-02 1 1  ON 3
 uu_4                -6.239366e-02 1 1  ON 4
 uu_5                -9.522025e-02 1 1  ON 5
 uu_6                -1.208901e-01 1 1  ON 6
 uu_7                -1.325331e-01 1 1  ON 7
 uu_8                -1.240908e-01 1 1  ON 8
 uu_9                -9.462232e-02 1 1  ON 9
 ud_0                 4.262678e-01 1 1  ON 10
 ud_1                 1.692441e-01 1 1  ON 11
 ud_2                 5.762466e-02 1 1  ON 12
 ud_3                -8.808934e-03 1 1  ON 13
 ud_4                -6.250143e-02 1 1  ON 14
 ud_5                -1.025113e-01 1 1  ON 15
 ud_6                -1.291613e-01 1 1  ON 16
 ud_7                -1.448474e-01 1 1  ON 17
 ud_8                -1.450454e-01 1 1  ON 18
 ud_9                -1.350539e-01 1 1  ON 19
 eO_0                -7.341611e-01 1 1  ON 20
 eO_1                -4.243501e-01 1 1  ON 21
 eO_2                -2.117779e-02 1 1  ON 22
 eO_3                 2.882233e-01 1 1  ON 23
 eO_4                 5.044543e-01 1 1  ON 24
 eO_5                 4.616575e-01 1 1  ON 25
 eO_6                 2.370308e-01 1 1  ON 26
 eO_7                -5.334428e-02 1 1  ON 27
 eO_8                -1.999965e-01 1 1  ON 28
 eO_9                -6.087546e-02 1 1  ON 29
eH1_0                -2.281451e-01 1 1  ON 30
eH1_1                -1.283032e-01 1 1  ON 31
eH1_2                -8.482843e-02 1 1  ON 32
eH1_3                -3.513126e-02 1 1  ON 33
eH1_4                 1.289307e-02 1 1  ON 34
eH1_5                 4.299569e-02 1 1  ON 35
eH1_6                 9.678737e-02 1 1  ON 36
eH1_7                 1.410536e-01 1 1  ON 37
eH1_8                 1.504545e-01 1 1  ON 38
eH1_9                 3.682914e-02 1 1  ON 39
eH2_0                -2.263192e-01 1 1  ON 40
eH2_1                -1.268380e-01 1 1  ON 41
eH2_2                -8.367685e-02 1 1  ON 42
eH2_3                -3.354117e-02 1 1  ON 43
eH2_4                 1.401092e-02 1 1  ON 44
eH2_5                 4.616621e-02 1 1  ON 45
eH2_6                 1.011721e-01 1 1  ON 46
eH2_7                 1.491677e-01 1 1  ON 47
eH2_8                 1.586364e-01 1 1  ON 48
eH2_9                 1.903547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9672
    reference variance = 0.396741
====================================================
  Execution time = 2.2742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3071e-01
  Total weights = 2.0000e+06
  Execution time = 2.4253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329977982025
                                         uncertainty =       0.003237992077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329977982025
                                         uncertainty =       0.003237992077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406155579
  error estimate for blocks of size 2^( 2) =       0.000418139005
  error estimate for blocks of size 2^( 3) =       0.000430497994
  error estimate for blocks of size 2^( 4) =       0.000442426805
  error estimate for blocks of size 2^( 5) =       0.000452974744
  error estimate for blocks of size 2^( 6) =       0.000460512680
  error estimate for blocks of size 2^( 7) =       0.000464916080

      target function =                  N/A
              le_mean =     -16.909244993496
             les_mean =     286.252490794152
             stat err =       0.000455207577
             autocorr =       1.256128642797
              std dev =       0.574390728546
             le_variance =       0.329924709040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331694344169
                                         uncertainty =       0.003264593223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331694344169
                                         uncertainty =       0.003264593223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407210651
  error estimate for blocks of size 2^( 2) =       0.000419137152
  error estimate for blocks of size 2^( 3) =       0.000431414824
  error estimate for blocks of size 2^( 4) =       0.000443262808
  error estimate for blocks of size 2^( 5) =       0.000453727806
  error estimate for blocks of size 2^( 6) =       0.000461227785
  error estimate for blocks of size 2^( 7) =       0.000465625778

      target function =                  N/A
              le_mean =     -16.909256542037
             les_mean =     286.254597666401
             stat err =       0.000455961045
             autocorr =       1.253768121508
              std dev =       0.575882824714
             le_variance =       0.331641027800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331591879708
                                         uncertainty =       0.003267033839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331591879708
                                         uncertainty =       0.003267033839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407147823
  error estimate for blocks of size 2^( 2) =       0.000419075064
  error estimate for blocks of size 2^( 3) =       0.000431362673
  error estimate for blocks of size 2^( 4) =       0.000443226916
  error estimate for blocks of size 2^( 5) =       0.000453711511
  error estimate for blocks of size 2^( 6) =       0.000461220113
  error estimate for blocks of size 2^( 7) =       0.000465619503

      target function =                  N/A
              le_mean =     -16.909255892908
             les_mean =     286.254473385663
             stat err =       0.000455944511
             autocorr =       1.254064139041
              std dev =       0.575793973211
             le_variance =       0.331538699586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330255749459
                                         uncertainty =       0.003243442567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330255749459
                                         uncertainty =       0.003243442567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406326539
  error estimate for blocks of size 2^( 2) =       0.000418298702
  error estimate for blocks of size 2^( 3) =       0.000430644493
  error estimate for blocks of size 2^( 4) =       0.000442562045
  error estimate for blocks of size 2^( 5) =       0.000453100246
  error estimate for blocks of size 2^( 6) =       0.000460632923
  error estimate for blocks of size 2^( 7) =       0.000465034672

      target function =                  N/A
              le_mean =     -16.909244613201
             les_mean =     286.252755736844
             stat err =       0.000455332471
             autocorr =       1.255760640558
              std dev =       0.574632502452
             le_variance =       0.330202512875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909244993496        initial
     3.9062e-02     3.9062e-01             8.7319e-03       -16.909256542037  <--
     1.5625e-01     1.5625e+00             3.2820e-03       -16.909255892908
     6.2500e-01     6.2500e+00             1.0181e-03       -16.909244613201

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.5011e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.044036e-01 1 1  ON 0
 uu_1                 1.398103e-01 1 1  ON 1
 uu_2                 4.162369e-02 1 1  ON 2
 uu_3                -1.871469e-02 1 1  ON 3
 uu_4                -6.271930e-02 1 1  ON 4
 uu_5                -9.586020e-02 1 1  ON 5
 uu_6                -1.217520e-01 1 1  ON 6
 uu_7                -1.338298e-01 1 1  ON 7
 uu_8                -1.266015e-01 1 1  ON 8
 uu_9                -9.653500e-02 1 1  ON 9
 ud_0                 4.282081e-01 1 1  ON 10
 ud_1                 1.707612e-01 1 1  ON 11
 ud_2                 5.857378e-02 1 1  ON 12
 ud_3                -8.622400e-03 1 1  ON 13
 ud_4                -6.286395e-02 1 1  ON 14
 ud_5                -1.029723e-01 1 1  ON 15
 ud_6                -1.296409e-01 1 1  ON 16
 ud_7                -1.451918e-01 1 1  ON 17
 ud_8                -1.458079e-01 1 1  ON 18
 ud_9                -1.364217e-01 1 1  ON 19
 eO_0                -7.396109e-01 1 1  ON 20
 eO_1                -4.284945e-01 1 1  ON 21
 eO_2                -2.263690e-02 1 1  ON 22
 eO_3                 2.900947e-01 1 1  ON 23
 eO_4                 5.087871e-01 1 1  ON 24
 eO_5                 4.667500e-01 1 1  ON 25
 eO_6                 2.406161e-01 1 1  ON 26
 eO_7                -5.071581e-02 1 1  ON 27
 eO_8                -2.029860e-01 1 1  ON 28
 eO_9                -6.383653e-02 1 1  ON 29
eH1_0                -2.310081e-01 1 1  ON 30
eH1_1                -1.294831e-01 1 1  ON 31
eH1_2                -8.566653e-02 1 1  ON 32
eH1_3                -3.550581e-02 1 1  ON 33
eH1_4                 1.229762e-02 1 1  ON 34
eH1_5                 4.230263e-02 1 1  ON 35
eH1_6                 9.682647e-02 1 1  ON 36
eH1_7                 1.423638e-01 1 1  ON 37
eH1_8                 1.537596e-01 1 1  ON 38
eH1_9                 3.938192e-02 1 1  ON 39
eH2_0                -2.295996e-01 1 1  ON 40
eH2_1                -1.285884e-01 1 1  ON 41
eH2_2                -8.512217e-02 1 1  ON 42
eH2_3                -3.448724e-02 1 1  ON 43
eH2_4                 1.251761e-02 1 1  ON 44
eH2_5                 4.471721e-02 1 1  ON 45
eH2_6                 1.011381e-01 1 1  ON 46
eH2_7                 1.501892e-01 1 1  ON 47
eH2_8                 1.629074e-01 1 1  ON 48
eH2_9                 2.361497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9693
    reference variance = 0.400001
====================================================
  Execution time = 2.3060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330087622697
                                         uncertainty =       0.003629416432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330087622697
                                         uncertainty =       0.003629416432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406202189
  error estimate for blocks of size 2^( 2) =       0.000417860922
  error estimate for blocks of size 2^( 3) =       0.000430434337
  error estimate for blocks of size 2^( 4) =       0.000441711461
  error estimate for blocks of size 2^( 5) =       0.000451597222
  error estimate for blocks of size 2^( 6) =       0.000457790562
  error estimate for blocks of size 2^( 7) =       0.000459933821

      target function =                  N/A
              le_mean =     -16.909825648665
             les_mean =     286.272203739890
             stat err =       0.000452758266
             autocorr =       1.242362281892
              std dev =       0.574456644715
             le_variance =       0.330000436658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690982564866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909825648665       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909830728350       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909834654268       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909847075447       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909846126981       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909855773090       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909866887602       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909862450197       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909867537788       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909876431144       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909880040109       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909880292309       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909872916588       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909876818545       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909879565108       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909881230023       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909881880886       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909882096335       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909882459149       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909882844598       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909882616223       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909883304360       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909883236205       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.106070e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909825648665       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909829352468       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909831425799       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909840555651       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909839503535       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909846441224       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909852107532       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909847438961       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909851216433       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909854014259       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909854344936       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909853548123       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909850870186       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909851651549       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909851976221       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909852152161       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909852309658       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.817564e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909825648665       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909827426397       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909827688063       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909831929132       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909834642603       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909835625678       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909834537683       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909835378466       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909835043542       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909835904066       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909835429671       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909835425732       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.940309e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9447e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.058436e-01 1 1  ON 0
 uu_1                 1.407861e-01 1 1  ON 1
 uu_2                 4.239410e-02 1 1  ON 2
 uu_3                -1.829897e-02 1 1  ON 3
 uu_4                -6.257759e-02 1 1  ON 4
 uu_5                -9.583777e-02 1 1  ON 5
 uu_6                -1.222348e-01 1 1  ON 6
 uu_7                -1.348914e-01 1 1  ON 7
 uu_8                -1.294165e-01 1 1  ON 8
 uu_9                -9.990776e-02 1 1  ON 9
 ud_0                 4.313929e-01 1 1  ON 10
 ud_1                 1.737662e-01 1 1  ON 11
 ud_2                 6.095745e-02 1 1  ON 12
 ud_3                -6.998512e-03 1 1  ON 13
 ud_4                -6.245638e-02 1 1  ON 14
 ud_5                -1.030210e-01 1 1  ON 15
 ud_6                -1.296287e-01 1 1  ON 16
 ud_7                -1.464674e-01 1 1  ON 17
 ud_8                -1.492456e-01 1 1  ON 18
 ud_9                -1.405027e-01 1 1  ON 19
 eO_0                -7.443154e-01 1 1  ON 20
 eO_1                -4.321344e-01 1 1  ON 21
 eO_2                -2.406180e-02 1 1  ON 22
 eO_3                 2.919268e-01 1 1  ON 23
 eO_4                 5.141656e-01 1 1  ON 24
 eO_5                 4.720079e-01 1 1  ON 25
 eO_6                 2.464337e-01 1 1  ON 26
 eO_7                -4.853525e-02 1 1  ON 27
 eO_8                -2.085967e-01 1 1  ON 28
 eO_9                -6.822797e-02 1 1  ON 29
eH1_0                -2.339916e-01 1 1  ON 30
eH1_1                -1.316023e-01 1 1  ON 31
eH1_2                -8.747540e-02 1 1  ON 32
eH1_3                -3.681865e-02 1 1  ON 33
eH1_4                 1.099364e-02 1 1  ON 34
eH1_5                 4.165783e-02 1 1  ON 35
eH1_6                 9.704557e-02 1 1  ON 36
eH1_7                 1.451448e-01 1 1  ON 37
eH1_8                 1.575063e-01 1 1  ON 38
eH1_9                 4.273721e-02 1 1  ON 39
eH2_0                -2.327956e-01 1 1  ON 40
eH2_1                -1.304377e-01 1 1  ON 41
eH2_2                -8.640756e-02 1 1  ON 42
eH2_3                -3.546706e-02 1 1  ON 43
eH2_4                 1.206359e-02 1 1  ON 44
eH2_5                 4.376545e-02 1 1  ON 45
eH2_6                 1.002209e-01 1 1  ON 46
eH2_7                 1.496681e-01 1 1  ON 47
eH2_8                 1.678187e-01 1 1  ON 48
eH2_9                 2.877233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9357
    reference variance = 0.809552
====================================================
  Execution time = 2.5611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3354e-01
  Total weights = 2.0000e+06
  Execution time = 2.4524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649570890
                                         uncertainty =       0.004929193658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649570890
                                         uncertainty =       0.004929193658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407898134
  error estimate for blocks of size 2^( 2) =       0.000420140938
  error estimate for blocks of size 2^( 3) =       0.000432533523
  error estimate for blocks of size 2^( 4) =       0.000445252498
  error estimate for blocks of size 2^( 5) =       0.000455911737
  error estimate for blocks of size 2^( 6) =       0.000465015263
  error estimate for blocks of size 2^( 7) =       0.000469613152

      target function =                  N/A
              le_mean =     -16.909938336160
             les_mean =     286.278776142331
             stat err =       0.000458948163
             autocorr =       1.265971221662
              std dev =       0.576855073643
             le_variance =       0.332761775987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334267660662
                                         uncertainty =       0.004945266835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334267660662
                                         uncertainty =       0.004945266835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408889538
  error estimate for blocks of size 2^( 2) =       0.000421073626
  error estimate for blocks of size 2^( 3) =       0.000433354975
  error estimate for blocks of size 2^( 4) =       0.000445933256
  error estimate for blocks of size 2^( 5) =       0.000456490614
  error estimate for blocks of size 2^( 6) =       0.000465549820
  error estimate for blocks of size 2^( 7) =       0.000470112002

      target function =                  N/A
              le_mean =     -16.909940439458
             les_mean =     286.280466807464
             stat err =       0.000459521423
             autocorr =       1.262988885572
              std dev =       0.578257130220
             le_variance =       0.334381308651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334255645864
                                         uncertainty =       0.004948647461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334255645864
                                         uncertainty =       0.004948647461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408882240
  error estimate for blocks of size 2^( 2) =       0.000421065319
  error estimate for blocks of size 2^( 3) =       0.000433358012
  error estimate for blocks of size 2^( 4) =       0.000445963271
  error estimate for blocks of size 2^( 5) =       0.000456544376
  error estimate for blocks of size 2^( 6) =       0.000465617474
  error estimate for blocks of size 2^( 7) =       0.000470220252

      target function =                  N/A
              le_mean =     -16.909937551573
             les_mean =     286.280357203612
             stat err =       0.000459586343
             autocorr =       1.263390873538
              std dev =       0.578246809493
             le_variance =       0.334369372689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332870534842
                                         uncertainty =       0.004932733388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332870534842
                                         uncertainty =       0.004932733388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408033705
  error estimate for blocks of size 2^( 2) =       0.000420264520
  error estimate for blocks of size 2^( 3) =       0.000432639477
  error estimate for blocks of size 2^( 4) =       0.000445340920
  error estimate for blocks of size 2^( 5) =       0.000455989514
  error estimate for blocks of size 2^( 6) =       0.000465090748
  error estimate for blocks of size 2^( 7) =       0.000469697396

      target function =                  N/A
              le_mean =     -16.909931136643
             les_mean =     286.278753888007
             stat err =       0.000459029644
             autocorr =       1.265579376935
              std dev =       0.577046799228
             le_variance =       0.332983008499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909938336160        initial
     9.7656e-03     9.7656e-02             2.1061e-02       -16.909940439458  <--
     3.9062e-02     3.9062e-01             5.8176e-03       -16.909937551573
     1.5625e-01     1.5625e+00             1.9403e-03       -16.909931136643

*****************************************************************************
Applying the update for shift_i =   9.7656e-03     and shift_s =   9.7656e-02
*****************************************************************************

  Execution time = 3.7921e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.073072e-01 1 1  ON 0
 uu_1                 1.420417e-01 1 1  ON 1
 uu_2                 4.333640e-02 1 1  ON 2
 uu_3                -1.790362e-02 1 1  ON 3
 uu_4                -6.293277e-02 1 1  ON 4
 uu_5                -9.696193e-02 1 1  ON 5
 uu_6                -1.243695e-01 1 1  ON 6
 uu_7                -1.377983e-01 1 1  ON 7
 uu_8                -1.333310e-01 1 1  ON 8
 uu_9                -1.047679e-01 1 1  ON 9
 ud_0                 4.352158e-01 1 1  ON 10
 ud_1                 1.774369e-01 1 1  ON 11
 ud_2                 6.420886e-02 1 1  ON 12
 ud_3                -4.432136e-03 1 1  ON 13
 ud_4                -6.086442e-02 1 1  ON 14
 ud_5                -1.024827e-01 1 1  ON 15
 ud_6                -1.301053e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.520261e-01 1 1  ON 18
 ud_9                -1.448451e-01 1 1  ON 19
 eO_0                -7.492183e-01 1 1  ON 20
 eO_1                -4.361426e-01 1 1  ON 21
 eO_2                -2.591528e-02 1 1  ON 22
 eO_3                 2.940243e-01 1 1  ON 23
 eO_4                 5.210451e-01 1 1  ON 24
 eO_5                 4.823126e-01 1 1  ON 25
 eO_6                 2.579405e-01 1 1  ON 26
 eO_7                -4.121433e-02 1 1  ON 27
 eO_8                -2.209447e-01 1 1  ON 28
 eO_9                -8.097385e-02 1 1  ON 29
eH1_0                -2.394806e-01 1 1  ON 30
eH1_1                -1.367866e-01 1 1  ON 31
eH1_2                -9.221953e-02 1 1  ON 32
eH1_3                -4.105850e-02 1 1  ON 33
eH1_4                 7.393247e-03 1 1  ON 34
eH1_5                 3.842750e-02 1 1  ON 35
eH1_6                 9.636578e-02 1 1  ON 36
eH1_7                 1.491404e-01 1 1  ON 37
eH1_8                 1.683371e-01 1 1  ON 38
eH1_9                 5.442426e-02 1 1  ON 39
eH2_0                -2.381682e-01 1 1  ON 40
eH2_1                -1.355384e-01 1 1  ON 41
eH2_2                -9.107551e-02 1 1  ON 42
eH2_3                -3.958548e-02 1 1  ON 43
eH2_4                 8.353485e-03 1 1  ON 44
eH2_5                 3.988485e-02 1 1  ON 45
eH2_6                 9.816669e-02 1 1  ON 46
eH2_7                 1.496952e-01 1 1  ON 47
eH2_8                 1.799563e-01 1 1  ON 48
eH2_9                 4.467567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.829
    reference variance = 0.771701
====================================================
  Execution time = 2.3155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335491719526
                                         uncertainty =       0.004457157988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335491719526
                                         uncertainty =       0.004457157988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409729180
  error estimate for blocks of size 2^( 2) =       0.000421967066
  error estimate for blocks of size 2^( 3) =       0.000434834732
  error estimate for blocks of size 2^( 4) =       0.000446335651
  error estimate for blocks of size 2^( 5) =       0.000457252619
  error estimate for blocks of size 2^( 6) =       0.000463826726
  error estimate for blocks of size 2^( 7) =       0.000467484104

      target function =                  N/A
              le_mean =     -16.908655985530
             les_mean =     286.238403071503
             stat err =       0.000458724775
             autocorr =       1.253460357744
              std dev =       0.579444563677
             le_variance =       0.335756002375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690865598553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908655985530       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908657369319       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908658835647       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908653198255       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908655573545       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908662337126       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908662682987       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908669387155       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908669097442       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908669903392       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908673977666       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908674540673       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908681974916       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908685467072       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908700043203       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908705243109       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908709378651       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908709812739       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908712759988       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908711500184       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908710663101       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908713545596       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.908711838896       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908714514509       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908715662061       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908716996226       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.908717011897       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908716630764       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908716746143       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908717352076       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 8.925124e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908655985530       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908657329418       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908658762879       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908653446055       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908655289432       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908661358339       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908661818284       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908667552401       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908666729598       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908667207850       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908669921362       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908668516070       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908671373880       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908672850451       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908678453693       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908679017205       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908679651939       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908679368408       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908679522962       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908679131356       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908678749871       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908679282454       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.253674e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908655985530       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908657190444       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908658513131       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908654154777       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908654732988       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908659180063       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908660106908       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908663423902       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908662084619       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908662338866       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908662959067       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908661940829       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908662366626       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908662844006       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.621528e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9319e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.070018e-01 1 1  ON 0
 uu_1                 1.413787e-01 1 1  ON 1
 uu_2                 4.243038e-02 1 1  ON 2
 uu_3                -1.914388e-02 1 1  ON 3
 uu_4                -6.534774e-02 1 1  ON 4
 uu_5                -9.962926e-02 1 1  ON 5
 uu_6                -1.274833e-01 1 1  ON 6
 uu_7                -1.412832e-01 1 1  ON 7
 uu_8                -1.334759e-01 1 1  ON 8
 uu_9                -1.053557e-01 1 1  ON 9
 ud_0                 4.360564e-01 1 1  ON 10
 ud_1                 1.777684e-01 1 1  ON 11
 ud_2                 6.406906e-02 1 1  ON 12
 ud_3                -4.764498e-03 1 1  ON 13
 ud_4                -6.132394e-02 1 1  ON 14
 ud_5                -1.036948e-01 1 1  ON 15
 ud_6                -1.325009e-01 1 1  ON 16
 ud_7                -1.510261e-01 1 1  ON 17
 ud_8                -1.512238e-01 1 1  ON 18
 ud_9                -1.398996e-01 1 1  ON 19
 eO_0                -7.528733e-01 1 1  ON 20
 eO_1                -4.387597e-01 1 1  ON 21
 eO_2                -2.762351e-02 1 1  ON 22
 eO_3                 2.955564e-01 1 1  ON 23
 eO_4                 5.252705e-01 1 1  ON 24
 eO_5                 4.902180e-01 1 1  ON 25
 eO_6                 2.667880e-01 1 1  ON 26
 eO_7                -3.499315e-02 1 1  ON 27
 eO_8                -2.264519e-01 1 1  ON 28
 eO_9                -9.324900e-02 1 1  ON 29
eH1_0                -2.466631e-01 1 1  ON 30
eH1_1                -1.442007e-01 1 1  ON 31
eH1_2                -9.943270e-02 1 1  ON 32
eH1_3                -4.802119e-02 1 1  ON 33
eH1_4                 4.758409e-04 1 1  ON 34
eH1_5                 3.145482e-02 1 1  ON 35
eH1_6                 9.265880e-02 1 1  ON 36
eH1_7                 1.510380e-01 1 1  ON 37
eH1_8                 1.870792e-01 1 1  ON 38
eH1_9                 7.696100e-02 1 1  ON 39
eH2_0                -2.444225e-01 1 1  ON 40
eH2_1                -1.410028e-01 1 1  ON 41
eH2_2                -9.641399e-02 1 1  ON 42
eH2_3                -4.479363e-02 1 1  ON 43
eH2_4                 3.013421e-03 1 1  ON 44
eH2_5                 3.405905e-02 1 1  ON 45
eH2_6                 9.769704e-02 1 1  ON 46
eH2_7                 1.506088e-01 1 1  ON 47
eH2_8                 1.894645e-01 1 1  ON 48
eH2_9                 6.549826e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.891
    reference variance = 0.318849
====================================================
  Execution time = 2.2675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5181e-01
  Total weights = 2.0000e+06
  Execution time = 2.4387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350376774678
                                         uncertainty =       0.021699657509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350376774678
                                         uncertainty =       0.021699657509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418674776
  error estimate for blocks of size 2^( 2) =       0.000430453710
  error estimate for blocks of size 2^( 3) =       0.000442681407
  error estimate for blocks of size 2^( 4) =       0.000453559398
  error estimate for blocks of size 2^( 5) =       0.000463988224
  error estimate for blocks of size 2^( 6) =       0.000471779524
  error estimate for blocks of size 2^( 7) =       0.000479180199

      target function =                  N/A
              le_mean =     -16.909202081892
             les_mean =     286.271692006893
             stat err =       0.000467126836
             autocorr =       1.244847190120
              std dev =       0.592095546268
             le_variance =       0.350577135910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352316813870
                                         uncertainty =       0.021753801720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352316813870
                                         uncertainty =       0.021753801720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419832653
  error estimate for blocks of size 2^( 2) =       0.000431619138
  error estimate for blocks of size 2^( 3) =       0.000443814919
  error estimate for blocks of size 2^( 4) =       0.000454619095
  error estimate for blocks of size 2^( 5) =       0.000464902382
  error estimate for blocks of size 2^( 6) =       0.000472488588
  error estimate for blocks of size 2^( 7) =       0.000479788151

      target function =                  N/A
              le_mean =     -16.909198882896
             les_mean =     286.273525598566
             stat err =       0.000467949554
             autocorr =       1.242354817126
              std dev =       0.593733032187
             le_variance =       0.352518913511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352908581133
                                         uncertainty =       0.021756144127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352908581133
                                         uncertainty =       0.021756144127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420185430
  error estimate for blocks of size 2^( 2) =       0.000431987293
  error estimate for blocks of size 2^( 3) =       0.000444195896
  error estimate for blocks of size 2^( 4) =       0.000455023934
  error estimate for blocks of size 2^( 5) =       0.000465322985
  error estimate for blocks of size 2^( 6) =       0.000472959683
  error estimate for blocks of size 2^( 7) =       0.000480287351

      target function =                  N/A
              le_mean =     -16.909189088545
             les_mean =     286.273787047206
             stat err =       0.000468398488
             autocorr =       1.242650476309
              std dev =       0.594231934169
             le_variance =       0.353111591587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351207462158
                                         uncertainty =       0.021719735560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351207462158
                                         uncertainty =       0.021719735560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419171198
  error estimate for blocks of size 2^( 2) =       0.000430947932
  error estimate for blocks of size 2^( 3) =       0.000443164878
  error estimate for blocks of size 2^( 4) =       0.000454029577
  error estimate for blocks of size 2^( 5) =       0.000464428787
  error estimate for blocks of size 2^( 6) =       0.000472193823
  error estimate for blocks of size 2^( 7) =       0.000479583068

      target function =                  N/A
              le_mean =     -16.909185606119
             les_mean =     286.271966672489
             stat err =       0.000467558814
             autocorr =       1.244198373906
              std dev =       0.592797592780
             le_variance =       0.351408986005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909202081892        initial  <--
     2.4414e-03     2.4414e-02             8.9251e-02       -16.909198882896
     9.7656e-03     9.7656e-02             2.2537e-02       -16.909189088545
     3.9062e-02     3.9062e-01             5.6215e-03       -16.909185606119

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9317
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.073072e-01 1 1  ON 0
 uu_1                 1.420417e-01 1 1  ON 1
 uu_2                 4.333640e-02 1 1  ON 2
 uu_3                -1.790362e-02 1 1  ON 3
 uu_4                -6.293277e-02 1 1  ON 4
 uu_5                -9.696193e-02 1 1  ON 5
 uu_6                -1.243695e-01 1 1  ON 6
 uu_7                -1.377983e-01 1 1  ON 7
 uu_8                -1.333310e-01 1 1  ON 8
 uu_9                -1.047679e-01 1 1  ON 9
 ud_0                 4.352158e-01 1 1  ON 10
 ud_1                 1.774369e-01 1 1  ON 11
 ud_2                 6.420886e-02 1 1  ON 12
 ud_3                -4.432136e-03 1 1  ON 13
 ud_4                -6.086442e-02 1 1  ON 14
 ud_5                -1.024827e-01 1 1  ON 15
 ud_6                -1.301053e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.520261e-01 1 1  ON 18
 ud_9                -1.448451e-01 1 1  ON 19
 eO_0                -7.492183e-01 1 1  ON 20
 eO_1                -4.361426e-01 1 1  ON 21
 eO_2                -2.591528e-02 1 1  ON 22
 eO_3                 2.940243e-01 1 1  ON 23
 eO_4                 5.210451e-01 1 1  ON 24
 eO_5                 4.823126e-01 1 1  ON 25
 eO_6                 2.579405e-01 1 1  ON 26
 eO_7                -4.121433e-02 1 1  ON 27
 eO_8                -2.209447e-01 1 1  ON 28
 eO_9                -8.097385e-02 1 1  ON 29
eH1_0                -2.394806e-01 1 1  ON 30
eH1_1                -1.367866e-01 1 1  ON 31
eH1_2                -9.221953e-02 1 1  ON 32
eH1_3                -4.105850e-02 1 1  ON 33
eH1_4                 7.393247e-03 1 1  ON 34
eH1_5                 3.842750e-02 1 1  ON 35
eH1_6                 9.636578e-02 1 1  ON 36
eH1_7                 1.491404e-01 1 1  ON 37
eH1_8                 1.683371e-01 1 1  ON 38
eH1_9                 5.442426e-02 1 1  ON 39
eH2_0                -2.381682e-01 1 1  ON 40
eH2_1                -1.355384e-01 1 1  ON 41
eH2_2                -9.107551e-02 1 1  ON 42
eH2_3                -3.958548e-02 1 1  ON 43
eH2_4                 8.353485e-03 1 1  ON 44
eH2_5                 3.988485e-02 1 1  ON 45
eH2_6                 9.816669e-02 1 1  ON 46
eH2_7                 1.496952e-01 1 1  ON 47
eH2_8                 1.799563e-01 1 1  ON 48
eH2_9                 4.467567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.166222
====================================================
  Execution time = 2.3104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336919848237
                                         uncertainty =       0.004769040712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336919848237
                                         uncertainty =       0.004769040712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384103
  error estimate for blocks of size 2^( 2) =       0.000422734309
  error estimate for blocks of size 2^( 3) =       0.000435168603
  error estimate for blocks of size 2^( 4) =       0.000447923057
  error estimate for blocks of size 2^( 5) =       0.000459008393
  error estimate for blocks of size 2^( 6) =       0.000465754272
  error estimate for blocks of size 2^( 7) =       0.000471008363

      target function =                  N/A
              le_mean =     -16.909869624943
             les_mean =     286.280520787564
             stat err =       0.000460923521
             autocorr =       1.261469297017
              std dev =       0.580370763750
             le_variance =       0.336830223416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690986962494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909869624943       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909875096209       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909880405555       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909882146249       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909879414572       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909885600385       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909889282499       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909890630131       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909893146269       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909894250805       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909891992255       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909894131676       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909893787224       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909894264694       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909894601339       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909894430943       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909894649080       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 7.895033e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909869624943       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909873495288       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909876079285       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909877408553       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909875241523       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909878391278       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909878945918       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909879427340       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909880342831       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909880579187       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909879628324       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909879925144       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909879743235       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.035935e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909869624943       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909871408165       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909872216147       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909872914475       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909872158551       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909872875262       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909872999414       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909872899791       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909873270019       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909873155594       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.140275e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9240e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.074052e-01 1 1  ON 0
 uu_1                 1.424151e-01 1 1  ON 1
 uu_2                 4.324320e-02 1 1  ON 2
 uu_3                -1.820550e-02 1 1  ON 3
 uu_4                -6.385207e-02 1 1  ON 4
 uu_5                -9.788839e-02 1 1  ON 5
 uu_6                -1.251101e-01 1 1  ON 6
 uu_7                -1.385481e-01 1 1  ON 7
 uu_8                -1.321987e-01 1 1  ON 8
 uu_9                -1.043062e-01 1 1  ON 9
 ud_0                 4.349387e-01 1 1  ON 10
 ud_1                 1.771891e-01 1 1  ON 11
 ud_2                 6.406003e-02 1 1  ON 12
 ud_3                -4.685598e-03 1 1  ON 13
 ud_4                -6.081332e-02 1 1  ON 14
 ud_5                -1.023952e-01 1 1  ON 15
 ud_6                -1.306007e-01 1 1  ON 16
 ud_7                -1.480626e-01 1 1  ON 17
 ud_8                -1.508179e-01 1 1  ON 18
 ud_9                -1.442811e-01 1 1  ON 19
 eO_0                -7.501640e-01 1 1  ON 20
 eO_1                -4.367957e-01 1 1  ON 21
 eO_2                -2.613182e-02 1 1  ON 22
 eO_3                 2.946904e-01 1 1  ON 23
 eO_4                 5.218953e-01 1 1  ON 24
 eO_5                 4.833948e-01 1 1  ON 25
 eO_6                 2.585807e-01 1 1  ON 26
 eO_7                -4.065818e-02 1 1  ON 27
 eO_8                -2.213903e-01 1 1  ON 28
 eO_9                -8.226776e-02 1 1  ON 29
eH1_0                -2.399667e-01 1 1  ON 30
eH1_1                -1.376204e-01 1 1  ON 31
eH1_2                -9.306021e-02 1 1  ON 32
eH1_3                -4.177475e-02 1 1  ON 33
eH1_4                 6.273911e-03 1 1  ON 34
eH1_5                 3.736779e-02 1 1  ON 35
eH1_6                 9.605406e-02 1 1  ON 36
eH1_7                 1.505476e-01 1 1  ON 37
eH1_8                 1.703730e-01 1 1  ON 38
eH1_9                 5.640600e-02 1 1  ON 39
eH2_0                -2.391521e-01 1 1  ON 40
eH2_1                -1.365699e-01 1 1  ON 41
eH2_2                -9.184516e-02 1 1  ON 42
eH2_3                -4.059359e-02 1 1  ON 43
eH2_4                 7.860684e-03 1 1  ON 44
eH2_5                 3.914928e-02 1 1  ON 45
eH2_6                 9.890079e-02 1 1  ON 46
eH2_7                 1.508223e-01 1 1  ON 47
eH2_8                 1.810963e-01 1 1  ON 48
eH2_9                 4.658235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8378
    reference variance = 0.241608
====================================================
  Execution time = 2.2731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.0000e+06
  Execution time = 2.4336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337318056748
                                         uncertainty =       0.007789761509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337318056748
                                         uncertainty =       0.007789761509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647366
  error estimate for blocks of size 2^( 2) =       0.000422680335
  error estimate for blocks of size 2^( 3) =       0.000435362428
  error estimate for blocks of size 2^( 4) =       0.000448023396
  error estimate for blocks of size 2^( 5) =       0.000458005427
  error estimate for blocks of size 2^( 6) =       0.000466741717
  error estimate for blocks of size 2^( 7) =       0.000471027615

      target function =                  N/A
              le_mean =     -16.908944607053
             les_mean =     286.249670074113
             stat err =       0.000460949539
             autocorr =       1.259994608043
              std dev =       0.580743074322
             le_variance =       0.337262518372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337797769920
                                         uncertainty =       0.007789672528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337797769920
                                         uncertainty =       0.007789672528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410939736
  error estimate for blocks of size 2^( 2) =       0.000422981441
  error estimate for blocks of size 2^( 3) =       0.000435662495
  error estimate for blocks of size 2^( 4) =       0.000448308321
  error estimate for blocks of size 2^( 5) =       0.000458247954
  error estimate for blocks of size 2^( 6) =       0.000466960773
  error estimate for blocks of size 2^( 7) =       0.000471197100

      target function =                  N/A
              le_mean =     -16.908943572994
             les_mean =     286.250115519054
             stat err =       0.000461178537
             autocorr =       1.259452808656
              std dev =       0.581156547958
             le_variance =       0.337742933235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337624721963
                                         uncertainty =       0.007786539270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337624721963
                                         uncertainty =       0.007786539270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410834642
  error estimate for blocks of size 2^( 2) =       0.000422876482
  error estimate for blocks of size 2^( 3) =       0.000435561173
  error estimate for blocks of size 2^( 4) =       0.000448217696
  error estimate for blocks of size 2^( 5) =       0.000458169035
  error estimate for blocks of size 2^( 6) =       0.000466900104
  error estimate for blocks of size 2^( 7) =       0.000471142261

      target function =                  N/A
              le_mean =     -16.908944198534
             les_mean =     286.249963946827
             stat err =       0.000461107274
             autocorr =       1.259707841379
              std dev =       0.581007922906
             le_variance =       0.337570206480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337353910812
                                         uncertainty =       0.007789000738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337353910812
                                         uncertainty =       0.007789000738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410669338
  error estimate for blocks of size 2^( 2) =       0.000422703333
  error estimate for blocks of size 2^( 3) =       0.000435385172
  error estimate for blocks of size 2^( 4) =       0.000448045521
  error estimate for blocks of size 2^( 5) =       0.000458022602
  error estimate for blocks of size 2^( 6) =       0.000466759879
  error estimate for blocks of size 2^( 7) =       0.000471040083

      target function =                  N/A
              le_mean =     -16.908943490657
             les_mean =     286.249668412131
             stat err =       0.000460967021
             autocorr =       1.259955351491
              std dev =       0.580774147618
             le_variance =       0.337298610541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908944607053        initial  <--
     2.4414e-02     2.4414e-01             7.8950e-03       -16.908943572994
     9.7656e-02     9.7656e-01             2.0359e-03       -16.908944198534
     3.9062e-01     3.9062e+00             5.1403e-04       -16.908943490657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9993
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.073072e-01 1 1  ON 0
 uu_1                 1.420417e-01 1 1  ON 1
 uu_2                 4.333640e-02 1 1  ON 2
 uu_3                -1.790362e-02 1 1  ON 3
 uu_4                -6.293277e-02 1 1  ON 4
 uu_5                -9.696193e-02 1 1  ON 5
 uu_6                -1.243695e-01 1 1  ON 6
 uu_7                -1.377983e-01 1 1  ON 7
 uu_8                -1.333310e-01 1 1  ON 8
 uu_9                -1.047679e-01 1 1  ON 9
 ud_0                 4.352158e-01 1 1  ON 10
 ud_1                 1.774369e-01 1 1  ON 11
 ud_2                 6.420886e-02 1 1  ON 12
 ud_3                -4.432136e-03 1 1  ON 13
 ud_4                -6.086442e-02 1 1  ON 14
 ud_5                -1.024827e-01 1 1  ON 15
 ud_6                -1.301053e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.520261e-01 1 1  ON 18
 ud_9                -1.448451e-01 1 1  ON 19
 eO_0                -7.492183e-01 1 1  ON 20
 eO_1                -4.361426e-01 1 1  ON 21
 eO_2                -2.591528e-02 1 1  ON 22
 eO_3                 2.940243e-01 1 1  ON 23
 eO_4                 5.210451e-01 1 1  ON 24
 eO_5                 4.823126e-01 1 1  ON 25
 eO_6                 2.579405e-01 1 1  ON 26
 eO_7                -4.121433e-02 1 1  ON 27
 eO_8                -2.209447e-01 1 1  ON 28
 eO_9                -8.097385e-02 1 1  ON 29
eH1_0                -2.394806e-01 1 1  ON 30
eH1_1                -1.367866e-01 1 1  ON 31
eH1_2                -9.221953e-02 1 1  ON 32
eH1_3                -4.105850e-02 1 1  ON 33
eH1_4                 7.393247e-03 1 1  ON 34
eH1_5                 3.842750e-02 1 1  ON 35
eH1_6                 9.636578e-02 1 1  ON 36
eH1_7                 1.491404e-01 1 1  ON 37
eH1_8                 1.683371e-01 1 1  ON 38
eH1_9                 5.442426e-02 1 1  ON 39
eH2_0                -2.381682e-01 1 1  ON 40
eH2_1                -1.355384e-01 1 1  ON 41
eH2_2                -9.107551e-02 1 1  ON 42
eH2_3                -3.958548e-02 1 1  ON 43
eH2_4                 8.353485e-03 1 1  ON 44
eH2_5                 3.988485e-02 1 1  ON 45
eH2_6                 9.816669e-02 1 1  ON 46
eH2_7                 1.496952e-01 1 1  ON 47
eH2_8                 1.799563e-01 1 1  ON 48
eH2_9                 4.467567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.283337
====================================================
  Execution time = 2.3165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2448e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324510941608
                                         uncertainty =       0.003155713192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324510941608
                                         uncertainty =       0.003155713192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402787275
  error estimate for blocks of size 2^( 2) =       0.000414912950
  error estimate for blocks of size 2^( 3) =       0.000427623610
  error estimate for blocks of size 2^( 4) =       0.000439133841
  error estimate for blocks of size 2^( 5) =       0.000449693103
  error estimate for blocks of size 2^( 6) =       0.000456853563
  error estimate for blocks of size 2^( 7) =       0.000463957517

      target function =                  N/A
              le_mean =     -16.909366018383
             les_mean =     286.251134158603
             stat err =       0.000452409506
             autocorr =       1.261571766474
              std dev =       0.569627226510
             le_variance =       0.324475177181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690936601838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909366018383       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909366120094       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909365575441       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909366282449       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909366248316       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909366514380       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909366553271       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909367448061       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909367375693       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909367524424       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.636057e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909366018383       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909366058542       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909365968651       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909365770023       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909365759012       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909365879169       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909365933678       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909366125659       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909366144142       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.445591e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909366018383       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909366030124       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909366016242       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909365958983       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909365902406       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909365925460       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909365954842       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909365991285       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.988361e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9386e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073681e-01 1 1  ON 0
 uu_1                 1.420691e-01 1 1  ON 1
 uu_2                 4.329261e-02 1 1  ON 2
 uu_3                -1.788367e-02 1 1  ON 3
 uu_4                -6.301452e-02 1 1  ON 4
 uu_5                -9.710348e-02 1 1  ON 5
 uu_6                -1.244141e-01 1 1  ON 6
 uu_7                -1.379314e-01 1 1  ON 7
 uu_8                -1.331370e-01 1 1  ON 8
 uu_9                -1.047845e-01 1 1  ON 9
 ud_0                 4.352741e-01 1 1  ON 10
 ud_1                 1.773752e-01 1 1  ON 11
 ud_2                 6.418926e-02 1 1  ON 12
 ud_3                -4.478440e-03 1 1  ON 13
 ud_4                -6.084076e-02 1 1  ON 14
 ud_5                -1.025610e-01 1 1  ON 15
 ud_6                -1.301321e-01 1 1  ON 16
 ud_7                -1.481620e-01 1 1  ON 17
 ud_8                -1.518196e-01 1 1  ON 18
 ud_9                -1.447762e-01 1 1  ON 19
 eO_0                -7.492613e-01 1 1  ON 20
 eO_1                -4.361849e-01 1 1  ON 21
 eO_2                -2.601641e-02 1 1  ON 22
 eO_3                 2.941099e-01 1 1  ON 23
 eO_4                 5.210953e-01 1 1  ON 24
 eO_5                 4.824643e-01 1 1  ON 25
 eO_6                 2.579994e-01 1 1  ON 26
 eO_7                -4.117372e-02 1 1  ON 27
 eO_8                -2.209809e-01 1 1  ON 28
 eO_9                -8.111043e-02 1 1  ON 29
eH1_0                -2.394998e-01 1 1  ON 30
eH1_1                -1.369294e-01 1 1  ON 31
eH1_2                -9.236221e-02 1 1  ON 32
eH1_3                -4.114229e-02 1 1  ON 33
eH1_4                 7.281705e-03 1 1  ON 34
eH1_5                 3.841392e-02 1 1  ON 35
eH1_6                 9.643901e-02 1 1  ON 36
eH1_7                 1.491443e-01 1 1  ON 37
eH1_8                 1.685003e-01 1 1  ON 38
eH1_9                 5.466882e-02 1 1  ON 39
eH2_0                -2.382037e-01 1 1  ON 40
eH2_1                -1.356484e-01 1 1  ON 41
eH2_2                -9.109083e-02 1 1  ON 42
eH2_3                -3.974464e-02 1 1  ON 43
eH2_4                 8.366118e-03 1 1  ON 44
eH2_5                 3.974443e-02 1 1  ON 45
eH2_6                 9.816275e-02 1 1  ON 46
eH2_7                 1.497984e-01 1 1  ON 47
eH2_8                 1.800881e-01 1 1  ON 48
eH2_9                 4.489386e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.276286
====================================================
  Execution time = 2.2703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2531e-01
  Total weights = 2.0000e+06
  Execution time = 2.4302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325098708226
                                         uncertainty =       0.002679338811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325098708226
                                         uncertainty =       0.002679338811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403243537
  error estimate for blocks of size 2^( 2) =       0.000415200162
  error estimate for blocks of size 2^( 3) =       0.000427483634
  error estimate for blocks of size 2^( 4) =       0.000438932570
  error estimate for blocks of size 2^( 5) =       0.000449419126
  error estimate for blocks of size 2^( 6) =       0.000456534397
  error estimate for blocks of size 2^( 7) =       0.000460216281

      target function =                  N/A
              le_mean =     -16.910192248453
             les_mean =     286.279812418009
             stat err =       0.000451275593
             autocorr =       1.252416728662
              std dev =       0.570272479589
             le_variance =       0.325210700976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325338521513
                                         uncertainty =       0.002681354135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325338521513
                                         uncertainty =       0.002681354135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403392176
  error estimate for blocks of size 2^( 2) =       0.000415346497
  error estimate for blocks of size 2^( 3) =       0.000427628849
  error estimate for blocks of size 2^( 4) =       0.000439075732
  error estimate for blocks of size 2^( 5) =       0.000449554829
  error estimate for blocks of size 2^( 6) =       0.000456663248
  error estimate for blocks of size 2^( 7) =       0.000460333755

      target function =                  N/A
              le_mean =     -16.910189586717
             les_mean =     286.279962192017
             stat err =       0.000451406891
             autocorr =       1.252222281747
              std dev =       0.570482686868
             le_variance =       0.325450496016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303823242
                                         uncertainty =       0.002681008098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303823242
                                         uncertainty =       0.002681008098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370703
  error estimate for blocks of size 2^( 2) =       0.000415324556
  error estimate for blocks of size 2^( 3) =       0.000427607175
  error estimate for blocks of size 2^( 4) =       0.000439054204
  error estimate for blocks of size 2^( 5) =       0.000449535387
  error estimate for blocks of size 2^( 6) =       0.000456647515
  error estimate for blocks of size 2^( 7) =       0.000460320359

      target function =                  N/A
              le_mean =     -16.910190582610
             les_mean =     286.279961225510
             stat err =       0.000451389366
             autocorr =       1.252258372326
              std dev =       0.570452318810
             le_variance =       0.325415848036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325134995911
                                         uncertainty =       0.002679628395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325134995911
                                         uncertainty =       0.002679628395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403266040
  error estimate for blocks of size 2^( 2) =       0.000415222022
  error estimate for blocks of size 2^( 3) =       0.000427505234
  error estimate for blocks of size 2^( 4) =       0.000438953749
  error estimate for blocks of size 2^( 5) =       0.000449439402
  error estimate for blocks of size 2^( 6) =       0.000456554209
  error estimate for blocks of size 2^( 7) =       0.000460234672

      target function =                  N/A
              le_mean =     -16.910191985327
             les_mean =     286.279839816131
             stat err =       0.000451295508
             autocorr =       1.252387489971
              std dev =       0.570304303100
             le_variance =       0.325246998134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910192248453        initial  <--
     2.4414e-01     2.4414e+00             9.6361e-04       -16.910189586717
     9.7656e-01     9.7656e+00             2.4456e-04       -16.910190582610
     3.9062e+00     3.9062e+01             5.9884e-05       -16.910191985327

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9430
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073072e-01 1 1  ON 0
 uu_1                 1.420417e-01 1 1  ON 1
 uu_2                 4.333640e-02 1 1  ON 2
 uu_3                -1.790362e-02 1 1  ON 3
 uu_4                -6.293277e-02 1 1  ON 4
 uu_5                -9.696193e-02 1 1  ON 5
 uu_6                -1.243695e-01 1 1  ON 6
 uu_7                -1.377983e-01 1 1  ON 7
 uu_8                -1.333310e-01 1 1  ON 8
 uu_9                -1.047679e-01 1 1  ON 9
 ud_0                 4.352158e-01 1 1  ON 10
 ud_1                 1.774369e-01 1 1  ON 11
 ud_2                 6.420886e-02 1 1  ON 12
 ud_3                -4.432136e-03 1 1  ON 13
 ud_4                -6.086442e-02 1 1  ON 14
 ud_5                -1.024827e-01 1 1  ON 15
 ud_6                -1.301053e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.520261e-01 1 1  ON 18
 ud_9                -1.448451e-01 1 1  ON 19
 eO_0                -7.492183e-01 1 1  ON 20
 eO_1                -4.361426e-01 1 1  ON 21
 eO_2                -2.591528e-02 1 1  ON 22
 eO_3                 2.940243e-01 1 1  ON 23
 eO_4                 5.210451e-01 1 1  ON 24
 eO_5                 4.823126e-01 1 1  ON 25
 eO_6                 2.579405e-01 1 1  ON 26
 eO_7                -4.121433e-02 1 1  ON 27
 eO_8                -2.209447e-01 1 1  ON 28
 eO_9                -8.097385e-02 1 1  ON 29
eH1_0                -2.394806e-01 1 1  ON 30
eH1_1                -1.367866e-01 1 1  ON 31
eH1_2                -9.221953e-02 1 1  ON 32
eH1_3                -4.105850e-02 1 1  ON 33
eH1_4                 7.393247e-03 1 1  ON 34
eH1_5                 3.842750e-02 1 1  ON 35
eH1_6                 9.636578e-02 1 1  ON 36
eH1_7                 1.491404e-01 1 1  ON 37
eH1_8                 1.683371e-01 1 1  ON 38
eH1_9                 5.442426e-02 1 1  ON 39
eH2_0                -2.381682e-01 1 1  ON 40
eH2_1                -1.355384e-01 1 1  ON 41
eH2_2                -9.107551e-02 1 1  ON 42
eH2_3                -3.958548e-02 1 1  ON 43
eH2_4                 8.353485e-03 1 1  ON 44
eH2_5                 3.988485e-02 1 1  ON 45
eH2_6                 9.816669e-02 1 1  ON 46
eH2_7                 1.496952e-01 1 1  ON 47
eH2_8                 1.799563e-01 1 1  ON 48
eH2_9                 4.467567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.277408
====================================================
  Execution time = 2.3016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337615176743
                                         uncertainty =       0.004873663270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337615176743
                                         uncertainty =       0.004873663270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410901340
  error estimate for blocks of size 2^( 2) =       0.000423004970
  error estimate for blocks of size 2^( 3) =       0.000435496643
  error estimate for blocks of size 2^( 4) =       0.000447576114
  error estimate for blocks of size 2^( 5) =       0.000457993131
  error estimate for blocks of size 2^( 6) =       0.000466338393
  error estimate for blocks of size 2^( 7) =       0.000471810130

      target function =                  N/A
              le_mean =     -16.909489108834
             les_mean =     286.268501575666
             stat err =       0.000460929442
             autocorr =       1.258327776260
              std dev =       0.581102248097
             le_variance =       0.337679822743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690948910883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909489108834       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909489406398       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909490098748       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909490107268       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909489854780       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909489998522       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909490028571       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909489996152       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909490009633       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.758974e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909489108834       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909489188217       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909489376690       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909489384121       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909489317159       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909489352259       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909489362048       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909489353605       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909489355074       residual = 7.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.594288e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909489108834       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909489129018       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909489177236       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909489179473       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909489162569       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909489171312       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909489173898       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909489171783       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.821847e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9184e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073212e-01 1 1  ON 0
 uu_1                 1.420452e-01 1 1  ON 1
 uu_2                 4.332587e-02 1 1  ON 2
 uu_3                -1.791017e-02 1 1  ON 3
 uu_4                -6.295462e-02 1 1  ON 4
 uu_5                -9.697574e-02 1 1  ON 5
 uu_6                -1.243754e-01 1 1  ON 6
 uu_7                -1.377991e-01 1 1  ON 7
 uu_8                -1.333176e-01 1 1  ON 8
 uu_9                -1.047645e-01 1 1  ON 9
 ud_0                 4.352196e-01 1 1  ON 10
 ud_1                 1.774397e-01 1 1  ON 11
 ud_2                 6.420183e-02 1 1  ON 12
 ud_3                -4.434017e-03 1 1  ON 13
 ud_4                -6.086786e-02 1 1  ON 14
 ud_5                -1.024822e-01 1 1  ON 15
 ud_6                -1.301312e-01 1 1  ON 16
 ud_7                -1.481120e-01 1 1  ON 17
 ud_8                -1.520108e-01 1 1  ON 18
 ud_9                -1.448321e-01 1 1  ON 19
 eO_0                -7.492293e-01 1 1  ON 20
 eO_1                -4.361617e-01 1 1  ON 21
 eO_2                -2.591153e-02 1 1  ON 22
 eO_3                 2.940310e-01 1 1  ON 23
 eO_4                 5.210583e-01 1 1  ON 24
 eO_5                 4.823298e-01 1 1  ON 25
 eO_6                 2.579409e-01 1 1  ON 26
 eO_7                -4.120619e-02 1 1  ON 27
 eO_8                -2.209493e-01 1 1  ON 28
 eO_9                -8.098706e-02 1 1  ON 29
eH1_0                -2.394797e-01 1 1  ON 30
eH1_1                -1.367936e-01 1 1  ON 31
eH1_2                -9.223396e-02 1 1  ON 32
eH1_3                -4.106871e-02 1 1  ON 33
eH1_4                 7.377685e-03 1 1  ON 34
eH1_5                 3.842287e-02 1 1  ON 35
eH1_6                 9.635831e-02 1 1  ON 36
eH1_7                 1.491471e-01 1 1  ON 37
eH1_8                 1.683589e-01 1 1  ON 38
eH1_9                 5.444772e-02 1 1  ON 39
eH2_0                -2.381812e-01 1 1  ON 40
eH2_1                -1.355437e-01 1 1  ON 41
eH2_2                -9.108172e-02 1 1  ON 42
eH2_3                -3.960534e-02 1 1  ON 43
eH2_4                 8.350630e-03 1 1  ON 44
eH2_5                 3.988994e-02 1 1  ON 45
eH2_6                 9.817297e-02 1 1  ON 46
eH2_7                 1.496954e-01 1 1  ON 47
eH2_8                 1.799697e-01 1 1  ON 48
eH2_9                 4.469811e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8498
    reference variance = 0.285539
====================================================
  Execution time = 2.2527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4536e-01
  Total weights = 2.0000e+06
  Execution time = 2.4347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345448306283
                                         uncertainty =       0.014309230909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345448306283
                                         uncertainty =       0.014309230909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415536187
  error estimate for blocks of size 2^( 2) =       0.000427560297
  error estimate for blocks of size 2^( 3) =       0.000440154985
  error estimate for blocks of size 2^( 4) =       0.000451451103
  error estimate for blocks of size 2^( 5) =       0.000461323913
  error estimate for blocks of size 2^( 6) =       0.000468867579
  error estimate for blocks of size 2^( 7) =       0.000475092138

      target function =                  N/A
              le_mean =     -16.910029752190
             les_mean =     286.294446692921
             stat err =       0.000464183683
             autocorr =       1.247849012417
              std dev =       0.587656911497
             le_variance =       0.345340645630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345508299030
                                         uncertainty =       0.014314662764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345508299030
                                         uncertainty =       0.014314662764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415572240
  error estimate for blocks of size 2^( 2) =       0.000427595422
  error estimate for blocks of size 2^( 3) =       0.000440188754
  error estimate for blocks of size 2^( 4) =       0.000451482892
  error estimate for blocks of size 2^( 5) =       0.000461353817
  error estimate for blocks of size 2^( 6) =       0.000468895225
  error estimate for blocks of size 2^( 7) =       0.000475119663

      target function =                  N/A
              le_mean =     -16.910030029401
             les_mean =     286.294515996083
             stat err =       0.000464212899
             autocorr =       1.247789565018
              std dev =       0.587707898154
             le_variance =       0.345400573553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345480840289
                                         uncertainty =       0.014312087806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345480840289
                                         uncertainty =       0.014312087806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415555739
  error estimate for blocks of size 2^( 2) =       0.000427579317
  error estimate for blocks of size 2^( 3) =       0.000440173251
  error estimate for blocks of size 2^( 4) =       0.000451468297
  error estimate for blocks of size 2^( 5) =       0.000461340109
  error estimate for blocks of size 2^( 6) =       0.000468882636
  error estimate for blocks of size 2^( 7) =       0.000475107157

      target function =                  N/A
              le_mean =     -16.910029896239
             les_mean =     286.294484062770
             stat err =       0.000464199549
             autocorr =       1.247816893877
              std dev =       0.587684561453
             le_variance =       0.345373143771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345452607529
                                         uncertainty =       0.014309589570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345452607529
                                         uncertainty =       0.014309589570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415538772
  error estimate for blocks of size 2^( 2) =       0.000427562807
  error estimate for blocks of size 2^( 3) =       0.000440157392
  error estimate for blocks of size 2^( 4) =       0.000451453368
  error estimate for blocks of size 2^( 5) =       0.000461326047
  error estimate for blocks of size 2^( 6) =       0.000468869583
  error estimate for blocks of size 2^( 7) =       0.000475094148

      target function =                  N/A
              le_mean =     -16.910029770327
             les_mean =     286.294451602787
             stat err =       0.000464185787
             autocorr =       1.247844796747
              std dev =       0.587660567091
             le_variance =       0.345344942114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910029752190        initial
     2.4414e+00     2.4414e+01             9.7590e-05       -16.910030029401  <--
     9.7656e+00     9.7656e+01             2.5943e-05       -16.910029896239
     3.9062e+01     3.9062e+02             6.8218e-06       -16.910029770327

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.4766e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073593e-01 1 1  ON 0
 uu_1                 1.420523e-01 1 1  ON 1
 uu_2                 4.329865e-02 1 1  ON 2
 uu_3                -1.793197e-02 1 1  ON 3
 uu_4                -6.301517e-02 1 1  ON 4
 uu_5                -9.701688e-02 1 1  ON 5
 uu_6                -1.243927e-01 1 1  ON 6
 uu_7                -1.378017e-01 1 1  ON 7
 uu_8                -1.332776e-01 1 1  ON 8
 uu_9                -1.047540e-01 1 1  ON 9
 ud_0                 4.352293e-01 1 1  ON 10
 ud_1                 1.774455e-01 1 1  ON 11
 ud_2                 6.418448e-02 1 1  ON 12
 ud_3                -4.440639e-03 1 1  ON 13
 ud_4                -6.087763e-02 1 1  ON 14
 ud_5                -1.024833e-01 1 1  ON 15
 ud_6                -1.302028e-01 1 1  ON 16
 ud_7                -1.481144e-01 1 1  ON 17
 ud_8                -1.519661e-01 1 1  ON 18
 ud_9                -1.447927e-01 1 1  ON 19
 eO_0                -7.492651e-01 1 1  ON 20
 eO_1                -4.362142e-01 1 1  ON 21
 eO_2                -2.590365e-02 1 1  ON 22
 eO_3                 2.940522e-01 1 1  ON 23
 eO_4                 5.210976e-01 1 1  ON 24
 eO_5                 4.823810e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.118221e-02 1 1  ON 27
 eO_8                -2.209630e-01 1 1  ON 28
 eO_9                -8.102632e-02 1 1  ON 29
eH1_0                -2.394778e-01 1 1  ON 30
eH1_1                -1.368159e-01 1 1  ON 31
eH1_2                -9.227583e-02 1 1  ON 32
eH1_3                -4.109917e-02 1 1  ON 33
eH1_4                 7.332221e-03 1 1  ON 34
eH1_5                 3.840889e-02 1 1  ON 35
eH1_6                 9.633607e-02 1 1  ON 36
eH1_7                 1.491673e-01 1 1  ON 37
eH1_8                 1.684243e-01 1 1  ON 38
eH1_9                 5.451785e-02 1 1  ON 39
eH2_0                -2.382201e-01 1 1  ON 40
eH2_1                -1.355606e-01 1 1  ON 41
eH2_2                -9.110161e-02 1 1  ON 42
eH2_3                -3.966129e-02 1 1  ON 43
eH2_4                 8.340288e-03 1 1  ON 44
eH2_5                 3.990519e-02 1 1  ON 45
eH2_6                 9.819202e-02 1 1  ON 46
eH2_7                 1.496961e-01 1 1  ON 47
eH2_8                 1.800094e-01 1 1  ON 48
eH2_9                 4.476510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8362
    reference variance = 0.255927
====================================================
  Execution time = 2.5092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331195340790
                                         uncertainty =       0.003892363714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331195340790
                                         uncertainty =       0.003892363714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406919023
  error estimate for blocks of size 2^( 2) =       0.000418731507
  error estimate for blocks of size 2^( 3) =       0.000430758064
  error estimate for blocks of size 2^( 4) =       0.000442212977
  error estimate for blocks of size 2^( 5) =       0.000451861579
  error estimate for blocks of size 2^( 6) =       0.000459131029
  error estimate for blocks of size 2^( 7) =       0.000462946204

      target function =                  N/A
              le_mean =     -16.909570475460
             les_mean =     286.264739682256
             stat err =       0.000454037947
             autocorr =       1.244997031733
              std dev =       0.575470401752
             le_variance =       0.331166183292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690957047546e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570475460       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570780272       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909571753242       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909571645291       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909572085102       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909571913918       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909572042857       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909571954040       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909571966938       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.501734e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570475460       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570565632       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909570871913       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909570862905       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909571028476       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909570976775       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909570986555       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909570958323       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.408285e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570475460       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570499086       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909570581392       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909570581268       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909570628013       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909570616701       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909570616551       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909570609395       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.386294e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1220e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.074099e-01 1 1  ON 0
 uu_1                 1.420815e-01 1 1  ON 1
 uu_2                 4.330522e-02 1 1  ON 2
 uu_3                -1.790841e-02 1 1  ON 3
 uu_4                -6.305351e-02 1 1  ON 4
 uu_5                -9.704189e-02 1 1  ON 5
 uu_6                -1.244206e-01 1 1  ON 6
 uu_7                -1.378358e-01 1 1  ON 7
 uu_8                -1.332683e-01 1 1  ON 8
 uu_9                -1.047975e-01 1 1  ON 9
 ud_0                 4.352436e-01 1 1  ON 10
 ud_1                 1.774489e-01 1 1  ON 11
 ud_2                 6.421221e-02 1 1  ON 12
 ud_3                -4.444903e-03 1 1  ON 13
 ud_4                -6.088006e-02 1 1  ON 14
 ud_5                -1.024477e-01 1 1  ON 15
 ud_6                -1.302304e-01 1 1  ON 16
 ud_7                -1.481455e-01 1 1  ON 17
 ud_8                -1.519514e-01 1 1  ON 18
 ud_9                -1.447818e-01 1 1  ON 19
 eO_0                -7.492968e-01 1 1  ON 20
 eO_1                -4.362123e-01 1 1  ON 21
 eO_2                -2.592539e-02 1 1  ON 22
 eO_3                 2.941010e-01 1 1  ON 23
 eO_4                 5.210928e-01 1 1  ON 24
 eO_5                 4.824440e-01 1 1  ON 25
 eO_6                 2.579946e-01 1 1  ON 26
 eO_7                -4.118327e-02 1 1  ON 27
 eO_8                -2.210119e-01 1 1  ON 28
 eO_9                -8.107626e-02 1 1  ON 29
eH1_0                -2.395719e-01 1 1  ON 30
eH1_1                -1.368582e-01 1 1  ON 31
eH1_2                -9.226572e-02 1 1  ON 32
eH1_3                -4.111392e-02 1 1  ON 33
eH1_4                 7.321335e-03 1 1  ON 34
eH1_5                 3.843407e-02 1 1  ON 35
eH1_6                 9.634797e-02 1 1  ON 36
eH1_7                 1.491683e-01 1 1  ON 37
eH1_8                 1.684694e-01 1 1  ON 38
eH1_9                 5.457949e-02 1 1  ON 39
eH2_0                -2.382257e-01 1 1  ON 40
eH2_1                -1.355806e-01 1 1  ON 41
eH2_2                -9.113142e-02 1 1  ON 42
eH2_3                -3.970906e-02 1 1  ON 43
eH2_4                 8.355689e-03 1 1  ON 44
eH2_5                 3.988149e-02 1 1  ON 45
eH2_6                 9.819737e-02 1 1  ON 46
eH2_7                 1.497224e-01 1 1  ON 47
eH2_8                 1.800280e-01 1 1  ON 48
eH2_9                 4.482768e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9712
    reference variance = 0.237481
====================================================
  Execution time = 2.2508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3183e-01
  Total weights = 2.0000e+06
  Execution time = 2.4349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331981406416
                                         uncertainty =       0.004071378805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331981406416
                                         uncertainty =       0.004071378805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325267
  error estimate for blocks of size 2^( 2) =       0.000419345225
  error estimate for blocks of size 2^( 3) =       0.000431287059
  error estimate for blocks of size 2^( 4) =       0.000443165234
  error estimate for blocks of size 2^( 5) =       0.000454894375
  error estimate for blocks of size 2^( 6) =       0.000461504988
  error estimate for blocks of size 2^( 7) =       0.000466465914

      target function =                  N/A
              le_mean =     -16.909442183114
             les_mean =     286.261062524831
             stat err =       0.000456507628
             autocorr =       1.256068646474
              std dev =       0.576044917234
             le_variance =       0.331827746671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332004591741
                                         uncertainty =       0.004071961330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332004591741
                                         uncertainty =       0.004071961330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407339508
  error estimate for blocks of size 2^( 2) =       0.000419359598
  error estimate for blocks of size 2^( 3) =       0.000431301254
  error estimate for blocks of size 2^( 4) =       0.000443179478
  error estimate for blocks of size 2^( 5) =       0.000454909060
  error estimate for blocks of size 2^( 6) =       0.000461517261
  error estimate for blocks of size 2^( 7) =       0.000466476736

      target function =                  N/A
              le_mean =     -16.909442073137
             les_mean =     286.261082008327
             stat err =       0.000456520634
             autocorr =       1.256052390618
              std dev =       0.576065056622
             le_variance =       0.331850949461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331990920306
                                         uncertainty =       0.004071687259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331990920306
                                         uncertainty =       0.004071687259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407331116
  error estimate for blocks of size 2^( 2) =       0.000419351431
  error estimate for blocks of size 2^( 3) =       0.000431293519
  error estimate for blocks of size 2^( 4) =       0.000443171894
  error estimate for blocks of size 2^( 5) =       0.000454901401
  error estimate for blocks of size 2^( 6) =       0.000461510160
  error estimate for blocks of size 2^( 7) =       0.000466469846

      target function =                  N/A
              le_mean =     -16.909442119110
             les_mean =     286.261069890413
             stat err =       0.000456513325
             autocorr =       1.256063923703
              std dev =       0.576053189225
             le_variance =       0.331837276816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331982595464
                                         uncertainty =       0.004071422422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331982595464
                                         uncertainty =       0.004071422422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407325998
  error estimate for blocks of size 2^( 2) =       0.000419346014
  error estimate for blocks of size 2^( 3) =       0.000431287903
  error estimate for blocks of size 2^( 4) =       0.000443166116
  error estimate for blocks of size 2^( 5) =       0.000454895314
  error estimate for blocks of size 2^( 6) =       0.000461505666
  error estimate for blocks of size 2^( 7) =       0.000466466387

      target function =                  N/A
              le_mean =     -16.909442168820
             les_mean =     286.261063232592
             stat err =       0.000456508371
             autocorr =       1.256068224594
              std dev =       0.576045951154
             le_variance =       0.331828937841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909442183114        initial  <--
     6.1035e-01     6.1035e+00             3.5017e-04       -16.909442073137
     2.4414e+00     2.4414e+01             9.4083e-05       -16.909442119110
     9.7656e+00     9.7656e+01             2.3863e-05       -16.909442168820

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.7845
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.073593e-01 1 1  ON 0
 uu_1                 1.420523e-01 1 1  ON 1
 uu_2                 4.329865e-02 1 1  ON 2
 uu_3                -1.793197e-02 1 1  ON 3
 uu_4                -6.301517e-02 1 1  ON 4
 uu_5                -9.701688e-02 1 1  ON 5
 uu_6                -1.243927e-01 1 1  ON 6
 uu_7                -1.378017e-01 1 1  ON 7
 uu_8                -1.332776e-01 1 1  ON 8
 uu_9                -1.047540e-01 1 1  ON 9
 ud_0                 4.352293e-01 1 1  ON 10
 ud_1                 1.774455e-01 1 1  ON 11
 ud_2                 6.418448e-02 1 1  ON 12
 ud_3                -4.440639e-03 1 1  ON 13
 ud_4                -6.087763e-02 1 1  ON 14
 ud_5                -1.024833e-01 1 1  ON 15
 ud_6                -1.302028e-01 1 1  ON 16
 ud_7                -1.481144e-01 1 1  ON 17
 ud_8                -1.519661e-01 1 1  ON 18
 ud_9                -1.447927e-01 1 1  ON 19
 eO_0                -7.492651e-01 1 1  ON 20
 eO_1                -4.362142e-01 1 1  ON 21
 eO_2                -2.590365e-02 1 1  ON 22
 eO_3                 2.940522e-01 1 1  ON 23
 eO_4                 5.210976e-01 1 1  ON 24
 eO_5                 4.823810e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.118221e-02 1 1  ON 27
 eO_8                -2.209630e-01 1 1  ON 28
 eO_9                -8.102632e-02 1 1  ON 29
eH1_0                -2.394778e-01 1 1  ON 30
eH1_1                -1.368159e-01 1 1  ON 31
eH1_2                -9.227583e-02 1 1  ON 32
eH1_3                -4.109917e-02 1 1  ON 33
eH1_4                 7.332221e-03 1 1  ON 34
eH1_5                 3.840889e-02 1 1  ON 35
eH1_6                 9.633607e-02 1 1  ON 36
eH1_7                 1.491673e-01 1 1  ON 37
eH1_8                 1.684243e-01 1 1  ON 38
eH1_9                 5.451785e-02 1 1  ON 39
eH2_0                -2.382201e-01 1 1  ON 40
eH2_1                -1.355606e-01 1 1  ON 41
eH2_2                -9.110161e-02 1 1  ON 42
eH2_3                -3.966129e-02 1 1  ON 43
eH2_4                 8.340288e-03 1 1  ON 44
eH2_5                 3.990519e-02 1 1  ON 45
eH2_6                 9.819202e-02 1 1  ON 46
eH2_7                 1.496961e-01 1 1  ON 47
eH2_8                 1.800094e-01 1 1  ON 48
eH2_9                 4.476510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.237259
====================================================
  Execution time = 2.3174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4265e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342560285701
                                         uncertainty =       0.009837435077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342560285701
                                         uncertainty =       0.009837435077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413916338
  error estimate for blocks of size 2^( 2) =       0.000425327766
  error estimate for blocks of size 2^( 3) =       0.000438209085
  error estimate for blocks of size 2^( 4) =       0.000451115206
  error estimate for blocks of size 2^( 5) =       0.000461620545
  error estimate for blocks of size 2^( 6) =       0.000469380501
  error estimate for blocks of size 2^( 7) =       0.000472944970

      target function =                  N/A
              le_mean =     -16.909856611054
             les_mean =     286.285903905361
             stat err =       0.000463765305
             autocorr =       1.255368920192
              std dev =       0.585366099361
             le_variance =       0.342653470281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690985661105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909856611054       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909856672466       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909856857689       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909856898880       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909856960953       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909856939927       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909856917749       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909856917173       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.896379e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909856611054       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909856626756       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909856673953       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909856685784       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909856701463       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909856696304       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909856690765       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909856689974       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.799285e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909856611054       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909856615002       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909856626858       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909856629922       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909856633850       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909856632568       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909856631189       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909856630950       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.453446e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9328e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.073615e-01 1 1  ON 0
 uu_1                 1.420574e-01 1 1  ON 1
 uu_2                 4.329779e-02 1 1  ON 2
 uu_3                -1.793050e-02 1 1  ON 3
 uu_4                -6.302258e-02 1 1  ON 4
 uu_5                -9.701953e-02 1 1  ON 5
 uu_6                -1.243956e-01 1 1  ON 6
 uu_7                -1.378021e-01 1 1  ON 7
 uu_8                -1.332740e-01 1 1  ON 8
 uu_9                -1.047568e-01 1 1  ON 9
 ud_0                 4.352282e-01 1 1  ON 10
 ud_1                 1.774462e-01 1 1  ON 11
 ud_2                 6.418432e-02 1 1  ON 12
 ud_3                -4.442130e-03 1 1  ON 13
 ud_4                -6.087452e-02 1 1  ON 14
 ud_5                -1.024847e-01 1 1  ON 15
 ud_6                -1.302065e-01 1 1  ON 16
 ud_7                -1.481152e-01 1 1  ON 17
 ud_8                -1.519622e-01 1 1  ON 18
 ud_9                -1.447913e-01 1 1  ON 19
 eO_0                -7.492686e-01 1 1  ON 20
 eO_1                -4.362168e-01 1 1  ON 21
 eO_2                -2.590445e-02 1 1  ON 22
 eO_3                 2.940586e-01 1 1  ON 23
 eO_4                 5.210990e-01 1 1  ON 24
 eO_5                 4.823860e-01 1 1  ON 25
 eO_6                 2.579437e-01 1 1  ON 26
 eO_7                -4.117772e-02 1 1  ON 27
 eO_8                -2.209677e-01 1 1  ON 28
 eO_9                -8.103257e-02 1 1  ON 29
eH1_0                -2.394796e-01 1 1  ON 30
eH1_1                -1.368242e-01 1 1  ON 31
eH1_2                -9.228261e-02 1 1  ON 32
eH1_3                -4.109722e-02 1 1  ON 33
eH1_4                 7.326367e-03 1 1  ON 34
eH1_5                 3.840818e-02 1 1  ON 35
eH1_6                 9.633853e-02 1 1  ON 36
eH1_7                 1.491686e-01 1 1  ON 37
eH1_8                 1.684321e-01 1 1  ON 38
eH1_9                 5.452669e-02 1 1  ON 39
eH2_0                -2.382299e-01 1 1  ON 40
eH2_1                -1.355657e-01 1 1  ON 41
eH2_2                -9.110083e-02 1 1  ON 42
eH2_3                -3.966722e-02 1 1  ON 43
eH2_4                 8.341548e-03 1 1  ON 44
eH2_5                 3.989970e-02 1 1  ON 45
eH2_6                 9.819526e-02 1 1  ON 46
eH2_7                 1.497021e-01 1 1  ON 47
eH2_8                 1.800157e-01 1 1  ON 48
eH2_9                 4.477357e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0196
    reference variance = 0.813635
====================================================
  Execution time = 2.2633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.0000e+06
  Execution time = 2.4391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565539908
                                         uncertainty =       0.010037062199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565539908
                                         uncertainty =       0.010037062199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410899020
  error estimate for blocks of size 2^( 2) =       0.000422871215
  error estimate for blocks of size 2^( 3) =       0.000435193412
  error estimate for blocks of size 2^( 4) =       0.000447233105
  error estimate for blocks of size 2^( 5) =       0.000456920656
  error estimate for blocks of size 2^( 6) =       0.000463604778
  error estimate for blocks of size 2^( 7) =       0.000467314898

      target function =                  N/A
              le_mean =     -16.909002282332
             les_mean =     286.252034024508
             stat err =       0.000458768359
             autocorr =       1.246570093894
              std dev =       0.581098967002
             le_variance =       0.337676009450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565470227
                                         uncertainty =       0.010037334135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565470227
                                         uncertainty =       0.010037334135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410899022
  error estimate for blocks of size 2^( 2) =       0.000422871197
  error estimate for blocks of size 2^( 3) =       0.000435193386
  error estimate for blocks of size 2^( 4) =       0.000447232990
  error estimate for blocks of size 2^( 5) =       0.000456920612
  error estimate for blocks of size 2^( 6) =       0.000463604969
  error estimate for blocks of size 2^( 7) =       0.000467314962

      target function =                  N/A
              le_mean =     -16.909002167756
             les_mean =     286.252030152352
             stat err =       0.000458768383
             autocorr =       1.246570215763
              std dev =       0.581098969199
             le_variance =       0.337676012004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565469732
                                         uncertainty =       0.010037198006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565469732
                                         uncertainty =       0.010037198006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410899000
  error estimate for blocks of size 2^( 2) =       0.000422871185
  error estimate for blocks of size 2^( 3) =       0.000435193376
  error estimate for blocks of size 2^( 4) =       0.000447233026
  error estimate for blocks of size 2^( 5) =       0.000456920621
  error estimate for blocks of size 2^( 6) =       0.000463604869
  error estimate for blocks of size 2^( 7) =       0.000467314928

      target function =                  N/A
              le_mean =     -16.909002223649
             les_mean =     286.252032007142
             stat err =       0.000458768361
             autocorr =       1.246570225040
              std dev =       0.581098938737
             le_variance =       0.337675976601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565529374
                                         uncertainty =       0.010037079159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565529374
                                         uncertainty =       0.010037079159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410899017
  error estimate for blocks of size 2^( 2) =       0.000422871210
  error estimate for blocks of size 2^( 3) =       0.000435193407
  error estimate for blocks of size 2^( 4) =       0.000447233094
  error estimate for blocks of size 2^( 5) =       0.000456920651
  error estimate for blocks of size 2^( 6) =       0.000463604789
  error estimate for blocks of size 2^( 7) =       0.000467314901

      target function =                  N/A
              le_mean =     -16.909002274877
             les_mean =     286.252033766579
             stat err =       0.000458768359
             autocorr =       1.246570112692
              std dev =       0.581098961988
             le_variance =       0.337676003623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909002282332        initial  <--
     6.1035e+00     6.1035e+01             3.8964e-05       -16.909002167756
     2.4414e+01     2.4414e+02             9.7993e-06       -16.909002223649
     9.7656e+01     9.7656e+02             2.4534e-06       -16.909002274877

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9809
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.073593e-01 1 1  ON 0
 uu_1                 1.420523e-01 1 1  ON 1
 uu_2                 4.329865e-02 1 1  ON 2
 uu_3                -1.793197e-02 1 1  ON 3
 uu_4                -6.301517e-02 1 1  ON 4
 uu_5                -9.701688e-02 1 1  ON 5
 uu_6                -1.243927e-01 1 1  ON 6
 uu_7                -1.378017e-01 1 1  ON 7
 uu_8                -1.332776e-01 1 1  ON 8
 uu_9                -1.047540e-01 1 1  ON 9
 ud_0                 4.352293e-01 1 1  ON 10
 ud_1                 1.774455e-01 1 1  ON 11
 ud_2                 6.418448e-02 1 1  ON 12
 ud_3                -4.440639e-03 1 1  ON 13
 ud_4                -6.087763e-02 1 1  ON 14
 ud_5                -1.024833e-01 1 1  ON 15
 ud_6                -1.302028e-01 1 1  ON 16
 ud_7                -1.481144e-01 1 1  ON 17
 ud_8                -1.519661e-01 1 1  ON 18
 ud_9                -1.447927e-01 1 1  ON 19
 eO_0                -7.492651e-01 1 1  ON 20
 eO_1                -4.362142e-01 1 1  ON 21
 eO_2                -2.590365e-02 1 1  ON 22
 eO_3                 2.940522e-01 1 1  ON 23
 eO_4                 5.210976e-01 1 1  ON 24
 eO_5                 4.823810e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.118221e-02 1 1  ON 27
 eO_8                -2.209630e-01 1 1  ON 28
 eO_9                -8.102632e-02 1 1  ON 29
eH1_0                -2.394778e-01 1 1  ON 30
eH1_1                -1.368159e-01 1 1  ON 31
eH1_2                -9.227583e-02 1 1  ON 32
eH1_3                -4.109917e-02 1 1  ON 33
eH1_4                 7.332221e-03 1 1  ON 34
eH1_5                 3.840889e-02 1 1  ON 35
eH1_6                 9.633607e-02 1 1  ON 36
eH1_7                 1.491673e-01 1 1  ON 37
eH1_8                 1.684243e-01 1 1  ON 38
eH1_9                 5.451785e-02 1 1  ON 39
eH2_0                -2.382201e-01 1 1  ON 40
eH2_1                -1.355606e-01 1 1  ON 41
eH2_2                -9.110161e-02 1 1  ON 42
eH2_3                -3.966129e-02 1 1  ON 43
eH2_4                 8.340288e-03 1 1  ON 44
eH2_5                 3.990519e-02 1 1  ON 45
eH2_6                 9.819202e-02 1 1  ON 46
eH2_7                 1.496961e-01 1 1  ON 47
eH2_8                 1.800094e-01 1 1  ON 48
eH2_9                 4.476510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4323e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8898
    reference variance = 0.270132
====================================================
  Execution time = 2.3167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337462423598
                                         uncertainty =       0.006603962538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337462423598
                                         uncertainty =       0.006603962538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410744872
  error estimate for blocks of size 2^( 2) =       0.000422408202
  error estimate for blocks of size 2^( 3) =       0.000434957720
  error estimate for blocks of size 2^( 4) =       0.000447376269
  error estimate for blocks of size 2^( 5) =       0.000458766693
  error estimate for blocks of size 2^( 6) =       0.000468553460
  error estimate for blocks of size 2^( 7) =       0.000475847769

      target function =                  N/A
              le_mean =     -16.909861932296
             les_mean =     286.280853099683
             stat err =       0.000462636048
             autocorr =       1.268629011339
              std dev =       0.580880968093
             le_variance =       0.337422699092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690986193230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909861932296       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909861935533       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909861937688       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909861942104       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909861945948       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909861950276       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909861950665       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909861951129       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.015230e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909861932296       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909861933107       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909861933646       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909861934751       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909861935713       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909861936793       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909861936883       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909861937006       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.255024e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909861932296       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909861932499       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909861932633       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909861932910       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909861933150       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909861933420       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909861933442       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909861933473       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.138321e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9251e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.073595e-01 1 1  ON 0
 uu_1                 1.420526e-01 1 1  ON 1
 uu_2                 4.329898e-02 1 1  ON 2
 uu_3                -1.793197e-02 1 1  ON 3
 uu_4                -6.301568e-02 1 1  ON 4
 uu_5                -9.701724e-02 1 1  ON 5
 uu_6                -1.243932e-01 1 1  ON 6
 uu_7                -1.378028e-01 1 1  ON 7
 uu_8                -1.332771e-01 1 1  ON 8
 uu_9                -1.047538e-01 1 1  ON 9
 ud_0                 4.352288e-01 1 1  ON 10
 ud_1                 1.774452e-01 1 1  ON 11
 ud_2                 6.418410e-02 1 1  ON 12
 ud_3                -4.440942e-03 1 1  ON 13
 ud_4                -6.087780e-02 1 1  ON 14
 ud_5                -1.024831e-01 1 1  ON 15
 ud_6                -1.302033e-01 1 1  ON 16
 ud_7                -1.481140e-01 1 1  ON 17
 ud_8                -1.519649e-01 1 1  ON 18
 ud_9                -1.447923e-01 1 1  ON 19
 eO_0                -7.492655e-01 1 1  ON 20
 eO_1                -4.362142e-01 1 1  ON 21
 eO_2                -2.590377e-02 1 1  ON 22
 eO_3                 2.940523e-01 1 1  ON 23
 eO_4                 5.210978e-01 1 1  ON 24
 eO_5                 4.823816e-01 1 1  ON 25
 eO_6                 2.579424e-01 1 1  ON 26
 eO_7                -4.118183e-02 1 1  ON 27
 eO_8                -2.209630e-01 1 1  ON 28
 eO_9                -8.102680e-02 1 1  ON 29
eH1_0                -2.394783e-01 1 1  ON 30
eH1_1                -1.368163e-01 1 1  ON 31
eH1_2                -9.227610e-02 1 1  ON 32
eH1_3                -4.109958e-02 1 1  ON 33
eH1_4                 7.331886e-03 1 1  ON 34
eH1_5                 3.840868e-02 1 1  ON 35
eH1_6                 9.633605e-02 1 1  ON 36
eH1_7                 1.491674e-01 1 1  ON 37
eH1_8                 1.684251e-01 1 1  ON 38
eH1_9                 5.451891e-02 1 1  ON 39
eH2_0                -2.382206e-01 1 1  ON 40
eH2_1                -1.355609e-01 1 1  ON 41
eH2_2                -9.110200e-02 1 1  ON 42
eH2_3                -3.966174e-02 1 1  ON 43
eH2_4                 8.339996e-03 1 1  ON 44
eH2_5                 3.990508e-02 1 1  ON 45
eH2_6                 9.819211e-02 1 1  ON 46
eH2_7                 1.496960e-01 1 1  ON 47
eH2_8                 1.800099e-01 1 1  ON 48
eH2_9                 4.476625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.856
    reference variance = 0.2458
====================================================
  Execution time = 2.3117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3959e-01
  Total weights = 2.0000e+06
  Execution time = 2.4297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682621186
                                         uncertainty =       0.005024617711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682621186
                                         uncertainty =       0.005024617711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412062028
  error estimate for blocks of size 2^( 2) =       0.000423959239
  error estimate for blocks of size 2^( 3) =       0.000436636721
  error estimate for blocks of size 2^( 4) =       0.000449185991
  error estimate for blocks of size 2^( 5) =       0.000460075730
  error estimate for blocks of size 2^( 6) =       0.000469250745
  error estimate for blocks of size 2^( 7) =       0.000478085714

      target function =                  N/A
              le_mean =     -16.909549199393
             les_mean =     286.272444186526
             stat err =       0.000464149545
             autocorr =       1.268792688499
              std dev =       0.582743708362
             le_variance =       0.339590229636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682313098
                                         uncertainty =       0.005024611260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682313098
                                         uncertainty =       0.005024611260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412061841
  error estimate for blocks of size 2^( 2) =       0.000423959049
  error estimate for blocks of size 2^( 3) =       0.000436636542
  error estimate for blocks of size 2^( 4) =       0.000449185795
  error estimate for blocks of size 2^( 5) =       0.000460075533
  error estimate for blocks of size 2^( 6) =       0.000469250519
  error estimate for blocks of size 2^( 7) =       0.000478085458

      target function =                  N/A
              le_mean =     -16.909549201741
             les_mean =     286.272443958266
             stat err =       0.000464149326
             autocorr =       1.268792640631
              std dev =       0.582743444366
             le_variance =       0.339589921951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682466306
                                         uncertainty =       0.005024614463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682466306
                                         uncertainty =       0.005024614463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412061934
  error estimate for blocks of size 2^( 2) =       0.000423959143
  error estimate for blocks of size 2^( 3) =       0.000436636631
  error estimate for blocks of size 2^( 4) =       0.000449185892
  error estimate for blocks of size 2^( 5) =       0.000460075631
  error estimate for blocks of size 2^( 6) =       0.000469250632
  error estimate for blocks of size 2^( 7) =       0.000478085586

      target function =                  N/A
              le_mean =     -16.909549200577
             les_mean =     286.272444071886
             stat err =       0.000464149435
             autocorr =       1.268792664768
              std dev =       0.582743575648
             le_variance =       0.339590074958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682601797
                                         uncertainty =       0.005024617305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682601797
                                         uncertainty =       0.005024617305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412062016
  error estimate for blocks of size 2^( 2) =       0.000423959227
  error estimate for blocks of size 2^( 3) =       0.000436636710
  error estimate for blocks of size 2^( 4) =       0.000449185979
  error estimate for blocks of size 2^( 5) =       0.000460075717
  error estimate for blocks of size 2^( 6) =       0.000469250731
  error estimate for blocks of size 2^( 7) =       0.000478085698

      target function =                  N/A
              le_mean =     -16.909549199541
             les_mean =     286.272444172161
             stat err =       0.000464149531
             autocorr =       1.268792685540
              std dev =       0.582743691748
             le_variance =       0.339590210273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909549199393        initial
     6.1035e+01     6.1035e+02             5.0152e-06       -16.909549201741  <--
     2.4414e+02     2.4414e+03             1.2550e-06       -16.909549200577
     9.7656e+02     9.7656e+03             3.1383e-07       -16.909549199541

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 3.5377e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.073602e-01 1 1  ON 0
 uu_1                 1.420536e-01 1 1  ON 1
 uu_2                 4.329995e-02 1 1  ON 2
 uu_3                -1.793196e-02 1 1  ON 3
 uu_4                -6.301718e-02 1 1  ON 4
 uu_5                -9.701833e-02 1 1  ON 5
 uu_6                -1.243947e-01 1 1  ON 6
 uu_7                -1.378062e-01 1 1  ON 7
 uu_8                -1.332757e-01 1 1  ON 8
 uu_9                -1.047531e-01 1 1  ON 9
 ud_0                 4.352272e-01 1 1  ON 10
 ud_1                 1.774443e-01 1 1  ON 11
 ud_2                 6.418298e-02 1 1  ON 12
 ud_3                -4.441850e-03 1 1  ON 13
 ud_4                -6.087829e-02 1 1  ON 14
 ud_5                -1.024824e-01 1 1  ON 15
 ud_6                -1.302046e-01 1 1  ON 16
 ud_7                -1.481130e-01 1 1  ON 17
 ud_8                -1.519611e-01 1 1  ON 18
 ud_9                -1.447908e-01 1 1  ON 19
 eO_0                -7.492670e-01 1 1  ON 20
 eO_1                -4.362143e-01 1 1  ON 21
 eO_2                -2.590413e-02 1 1  ON 22
 eO_3                 2.940523e-01 1 1  ON 23
 eO_4                 5.210982e-01 1 1  ON 24
 eO_5                 4.823835e-01 1 1  ON 25
 eO_6                 2.579427e-01 1 1  ON 26
 eO_7                -4.118069e-02 1 1  ON 27
 eO_8                -2.209631e-01 1 1  ON 28
 eO_9                -8.102825e-02 1 1  ON 29
eH1_0                -2.394798e-01 1 1  ON 30
eH1_1                -1.368174e-01 1 1  ON 31
eH1_2                -9.227689e-02 1 1  ON 32
eH1_3                -4.110080e-02 1 1  ON 33
eH1_4                 7.330880e-03 1 1  ON 34
eH1_5                 3.840802e-02 1 1  ON 35
eH1_6                 9.633598e-02 1 1  ON 36
eH1_7                 1.491678e-01 1 1  ON 37
eH1_8                 1.684274e-01 1 1  ON 38
eH1_9                 5.452208e-02 1 1  ON 39
eH2_0                -2.382220e-01 1 1  ON 40
eH2_1                -1.355615e-01 1 1  ON 41
eH2_2                -9.110318e-02 1 1  ON 42
eH2_3                -3.966310e-02 1 1  ON 43
eH2_4                 8.339121e-03 1 1  ON 44
eH2_5                 3.990476e-02 1 1  ON 45
eH2_6                 9.819238e-02 1 1  ON 46
eH2_7                 1.496960e-01 1 1  ON 47
eH2_8                 1.800113e-01 1 1  ON 48
eH2_9                 4.476971e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.249669
====================================================
  Execution time = 2.3183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2793e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707646707
                                         uncertainty =       0.002389054429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707646707
                                         uncertainty =       0.002389054429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404927149
  error estimate for blocks of size 2^( 2) =       0.000417344255
  error estimate for blocks of size 2^( 3) =       0.000430090223
  error estimate for blocks of size 2^( 4) =       0.000442951583
  error estimate for blocks of size 2^( 5) =       0.000454541895
  error estimate for blocks of size 2^( 6) =       0.000465629515
  error estimate for blocks of size 2^( 7) =       0.000470649333

      target function =                  N/A
              le_mean =     -16.909896688790
             les_mean =     286.272537853297
             stat err =       0.000458443082
             autocorr =       1.281790520063
              std dev =       0.572653465633
             le_variance =       0.327931991702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690989668879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909896688790       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909896785491       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909896801164       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909896818313       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909896841593       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909896829444       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909896811558       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909896820887       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.466495e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909896688790       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909896713081       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909896717106       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909896721481       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909896727442       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909896724526       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909896720088       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909896722263       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 6.182932e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909896688790       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909896694870       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909896695883       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909896696983       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909896698482       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909896697761       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909896696654       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909896697188       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.546786e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9365e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.073601e-01 1 1  ON 0
 uu_1                 1.420548e-01 1 1  ON 1
 uu_2                 4.330003e-02 1 1  ON 2
 uu_3                -1.793103e-02 1 1  ON 3
 uu_4                -6.301811e-02 1 1  ON 4
 uu_5                -9.702221e-02 1 1  ON 5
 uu_6                -1.243966e-01 1 1  ON 6
 uu_7                -1.378098e-01 1 1  ON 7
 uu_8                -1.332733e-01 1 1  ON 8
 uu_9                -1.047515e-01 1 1  ON 9
 ud_0                 4.352266e-01 1 1  ON 10
 ud_1                 1.774408e-01 1 1  ON 11
 ud_2                 6.418158e-02 1 1  ON 12
 ud_3                -4.443752e-03 1 1  ON 13
 ud_4                -6.087817e-02 1 1  ON 14
 ud_5                -1.024832e-01 1 1  ON 15
 ud_6                -1.302060e-01 1 1  ON 16
 ud_7                -1.481127e-01 1 1  ON 17
 ud_8                -1.519549e-01 1 1  ON 18
 ud_9                -1.447876e-01 1 1  ON 19
 eO_0                -7.492696e-01 1 1  ON 20
 eO_1                -4.362134e-01 1 1  ON 21
 eO_2                -2.590534e-02 1 1  ON 22
 eO_3                 2.940520e-01 1 1  ON 23
 eO_4                 5.210991e-01 1 1  ON 24
 eO_5                 4.823862e-01 1 1  ON 25
 eO_6                 2.579431e-01 1 1  ON 26
 eO_7                -4.117967e-02 1 1  ON 27
 eO_8                -2.209630e-01 1 1  ON 28
 eO_9                -8.103004e-02 1 1  ON 29
eH1_0                -2.394814e-01 1 1  ON 30
eH1_1                -1.368200e-01 1 1  ON 31
eH1_2                -9.227733e-02 1 1  ON 32
eH1_3                -4.110039e-02 1 1  ON 33
eH1_4                 7.328367e-03 1 1  ON 34
eH1_5                 3.840755e-02 1 1  ON 35
eH1_6                 9.633666e-02 1 1  ON 36
eH1_7                 1.491667e-01 1 1  ON 37
eH1_8                 1.684300e-01 1 1  ON 38
eH1_9                 5.452625e-02 1 1  ON 39
eH2_0                -2.382249e-01 1 1  ON 40
eH2_1                -1.355639e-01 1 1  ON 41
eH2_2                -9.110337e-02 1 1  ON 42
eH2_3                -3.966494e-02 1 1  ON 43
eH2_4                 8.337548e-03 1 1  ON 44
eH2_5                 3.990321e-02 1 1  ON 45
eH2_6                 9.819386e-02 1 1  ON 46
eH2_7                 1.496980e-01 1 1  ON 47
eH2_8                 1.800133e-01 1 1  ON 48
eH2_9                 4.477398e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9749
    reference variance = 0.371783
====================================================
  Execution time = 2.2748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3280e-01
  Total weights = 2.0000e+06
  Execution time = 2.4412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332866775601
                                         uncertainty =       0.003763703944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332866775601
                                         uncertainty =       0.003763703944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407922862
  error estimate for blocks of size 2^( 2) =       0.000420478088
  error estimate for blocks of size 2^( 3) =       0.000434071912
  error estimate for blocks of size 2^( 4) =       0.000447890916
  error estimate for blocks of size 2^( 5) =       0.000460742146
  error estimate for blocks of size 2^( 6) =       0.000474010516
  error estimate for blocks of size 2^( 7) =       0.000484441334

      target function =                  N/A
              le_mean =     -16.908375488402
             les_mean =     286.225963613778
             stat err =       0.000466771228
             autocorr =       1.309338876944
              std dev =       0.576890044443
             le_variance =       0.332802123378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332870600667
                                         uncertainty =       0.003763713688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332870600667
                                         uncertainty =       0.003763713688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407925208
  error estimate for blocks of size 2^( 2) =       0.000420480416
  error estimate for blocks of size 2^( 3) =       0.000434074308
  error estimate for blocks of size 2^( 4) =       0.000447893345
  error estimate for blocks of size 2^( 5) =       0.000460744586
  error estimate for blocks of size 2^( 6) =       0.000474012695
  error estimate for blocks of size 2^( 7) =       0.000484443190

      target function =                  N/A
              le_mean =     -16.908375536826
             les_mean =     286.225969078018
             stat err =       0.000466773454
             autocorr =       1.309336309811
              std dev =       0.576893361110
             le_variance =       0.332805950093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332868768901
                                         uncertainty =       0.003763709346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332868768901
                                         uncertainty =       0.003763709346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407924085
  error estimate for blocks of size 2^( 2) =       0.000420479299
  error estimate for blocks of size 2^( 3) =       0.000434073156
  error estimate for blocks of size 2^( 4) =       0.000447892177
  error estimate for blocks of size 2^( 5) =       0.000460743412
  error estimate for blocks of size 2^( 6) =       0.000474011649
  error estimate for blocks of size 2^( 7) =       0.000484442304

      target function =                  N/A
              le_mean =     -16.908375512867
             les_mean =     286.225966435210
             stat err =       0.000466772385
             autocorr =       1.309337525522
              std dev =       0.576891772771
             le_variance =       0.332804117491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332867027260
                                         uncertainty =       0.003763704636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332867027260
                                         uncertainty =       0.003763704636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407923017
  error estimate for blocks of size 2^( 2) =       0.000420478241
  error estimate for blocks of size 2^( 3) =       0.000434072069
  error estimate for blocks of size 2^( 4) =       0.000447891075
  error estimate for blocks of size 2^( 5) =       0.000460742306
  error estimate for blocks of size 2^( 6) =       0.000474010659
  error estimate for blocks of size 2^( 7) =       0.000484441456

      target function =                  N/A
              le_mean =     -16.908375491455
             les_mean =     286.225963968765
             stat err =       0.000466771374
             autocorr =       1.309338705855
              std dev =       0.576890262648
             le_variance =       0.332802375138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908375488402        initial
     1.5259e+01     1.5259e+02             2.4665e-05       -16.908375536826  <--
     6.1035e+01     6.1035e+02             6.1829e-06       -16.908375512867
     2.4414e+02     2.4414e+03             1.5468e-06       -16.908375491455

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.5037e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8021
    reference variance = 0.453967
====================================================
  Execution time = 2.3218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3482e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862102237
                                         uncertainty =       0.003927684964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862102237
                                         uncertainty =       0.003927684964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409159761
  error estimate for blocks of size 2^( 2) =       0.000420818044
  error estimate for blocks of size 2^( 3) =       0.000433331997
  error estimate for blocks of size 2^( 4) =       0.000445322256
  error estimate for blocks of size 2^( 5) =       0.000457637686
  error estimate for blocks of size 2^( 6) =       0.000467141635
  error estimate for blocks of size 2^( 7) =       0.000475092381

      target function =                  N/A
              le_mean =     -16.908705237679
             les_mean =     286.239136067536
             stat err =       0.000461298490
             autocorr =       1.271095649588
              std dev =       0.578639283355
             le_variance =       0.334823420241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690870523768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705237679       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705247914       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705358139       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705500760       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908705508111       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908705503654       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908705484334       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908705485355       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.841184e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705237679       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705240370       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705268269       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705305270       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908705308127       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908705308531       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908705303407       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908705302645       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.715154e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705237679       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705238360       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705245357       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705254691       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908705255476       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908705255683       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908705254396       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908705254140       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.291340e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9360e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.073665e-01 1 1  ON 0
 uu_1                 1.420637e-01 1 1  ON 1
 uu_2                 4.330238e-02 1 1  ON 2
 uu_3                -1.792687e-02 1 1  ON 3
 uu_4                -6.302971e-02 1 1  ON 4
 uu_5                -9.703998e-02 1 1  ON 5
 uu_6                -1.244068e-01 1 1  ON 6
 uu_7                -1.378350e-01 1 1  ON 7
 uu_8                -1.332669e-01 1 1  ON 8
 uu_9                -1.047459e-01 1 1  ON 9
 ud_0                 4.352252e-01 1 1  ON 10
 ud_1                 1.774259e-01 1 1  ON 11
 ud_2                 6.417466e-02 1 1  ON 12
 ud_3                -4.452000e-03 1 1  ON 13
 ud_4                -6.087408e-02 1 1  ON 14
 ud_5                -1.024904e-01 1 1  ON 15
 ud_6                -1.302066e-01 1 1  ON 16
 ud_7                -1.481130e-01 1 1  ON 17
 ud_8                -1.519261e-01 1 1  ON 18
 ud_9                -1.447741e-01 1 1  ON 19
 eO_0                -7.492798e-01 1 1  ON 20
 eO_1                -4.362169e-01 1 1  ON 21
 eO_2                -2.591452e-02 1 1  ON 22
 eO_3                 2.940595e-01 1 1  ON 23
 eO_4                 5.211095e-01 1 1  ON 24
 eO_5                 4.823970e-01 1 1  ON 25
 eO_6                 2.579487e-01 1 1  ON 26
 eO_7                -4.116937e-02 1 1  ON 27
 eO_8                -2.209691e-01 1 1  ON 28
 eO_9                -8.104364e-02 1 1  ON 29
eH1_0                -2.394905e-01 1 1  ON 30
eH1_1                -1.368285e-01 1 1  ON 31
eH1_2                -9.228491e-02 1 1  ON 32
eH1_3                -4.110330e-02 1 1  ON 33
eH1_4                 7.316886e-03 1 1  ON 34
eH1_5                 3.840856e-02 1 1  ON 35
eH1_6                 9.633978e-02 1 1  ON 36
eH1_7                 1.491615e-01 1 1  ON 37
eH1_8                 1.684445e-01 1 1  ON 38
eH1_9                 5.454896e-02 1 1  ON 39
eH2_0                -2.382425e-01 1 1  ON 40
eH2_1                -1.355787e-01 1 1  ON 41
eH2_2                -9.110385e-02 1 1  ON 42
eH2_3                -3.967816e-02 1 1  ON 43
eH2_4                 8.326258e-03 1 1  ON 44
eH2_5                 3.988852e-02 1 1  ON 45
eH2_6                 9.819811e-02 1 1  ON 46
eH2_7                 1.497119e-01 1 1  ON 47
eH2_8                 1.800324e-01 1 1  ON 48
eH2_9                 4.480392e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.229792
====================================================
  Execution time = 2.2748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.7727e-01
  Total weights = 2.0000e+06
  Execution time = 2.7509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377248232985
                                         uncertainty =       0.041401094689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377248232985
                                         uncertainty =       0.041401094689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434319036
  error estimate for blocks of size 2^( 2) =       0.000446572340
  error estimate for blocks of size 2^( 3) =       0.000457932303
  error estimate for blocks of size 2^( 4) =       0.000471065264
  error estimate for blocks of size 2^( 5) =       0.000483254378
  error estimate for blocks of size 2^( 6) =       0.000493429588
  error estimate for blocks of size 2^( 7) =       0.000498028763

      target function =                  N/A
              le_mean =     -16.909242465543
             les_mean =     286.299746619873
             stat err =       0.000486444498
             autocorr =       1.254437019586
              std dev =       0.614219871044
             le_variance =       0.377266049985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377273996940
                                         uncertainty =       0.041409842485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377273996940
                                         uncertainty =       0.041409842485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434333852
  error estimate for blocks of size 2^( 2) =       0.000446586790
  error estimate for blocks of size 2^( 3) =       0.000457946504
  error estimate for blocks of size 2^( 4) =       0.000471079210
  error estimate for blocks of size 2^( 5) =       0.000483268196
  error estimate for blocks of size 2^( 6) =       0.000493443389
  error estimate for blocks of size 2^( 7) =       0.000498042656

      target function =                  N/A
              le_mean =     -16.909242459086
             les_mean =     286.299772140679
             stat err =       0.000486458363
             autocorr =       1.254422945346
              std dev =       0.614240823433
             le_variance =       0.377291789172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377262096728
                                         uncertainty =       0.041405713117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377262096728
                                         uncertainty =       0.041405713117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434327009
  error estimate for blocks of size 2^( 2) =       0.000446580107
  error estimate for blocks of size 2^( 3) =       0.000457939933
  error estimate for blocks of size 2^( 4) =       0.000471072751
  error estimate for blocks of size 2^( 5) =       0.000483261784
  error estimate for blocks of size 2^( 6) =       0.000493436980
  error estimate for blocks of size 2^( 7) =       0.000498036216

      target function =                  N/A
              le_mean =     -16.909242458460
             les_mean =     286.299760231371
             stat err =       0.000486451933
             autocorr =       1.254429310193
              std dev =       0.614231146260
             le_variance =       0.377279901036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377249998441
                                         uncertainty =       0.041401680166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377249998441
                                         uncertainty =       0.041401680166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434320051
  error estimate for blocks of size 2^( 2) =       0.000446573329
  error estimate for blocks of size 2^( 3) =       0.000457933274
  error estimate for blocks of size 2^( 4) =       0.000471066217
  error estimate for blocks of size 2^( 5) =       0.000483255320
  error estimate for blocks of size 2^( 6) =       0.000493430528
  error estimate for blocks of size 2^( 7) =       0.000498029711

      target function =                  N/A
              le_mean =     -16.909242464371
             les_mean =     286.299748344087
             stat err =       0.000486445444
             autocorr =       1.254436032537
              std dev =       0.614221306896
             le_variance =       0.377267813845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909242465543        initial  <--
     3.8147e+00     3.8147e+01             6.8412e-05       -16.909242459086
     1.5259e+01     1.5259e+02             1.7152e-05       -16.909242458460
     6.1035e+01     6.1035e+02             4.2913e-06       -16.909242464371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4753
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6846e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8517
    reference variance = 0.320376
====================================================
  Execution time = 2.3111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341152327831
                                         uncertainty =       0.007260940689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341152327831
                                         uncertainty =       0.007260940689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412958044
  error estimate for blocks of size 2^( 2) =       0.000425225408
  error estimate for blocks of size 2^( 3) =       0.000437675660
  error estimate for blocks of size 2^( 4) =       0.000449480041
  error estimate for blocks of size 2^( 5) =       0.000461840593
  error estimate for blocks of size 2^( 6) =       0.000470690421
  error estimate for blocks of size 2^( 7) =       0.000477564532

      target function =                  N/A
              le_mean =     -16.909157738751
             les_mean =     286.260683956089
             stat err =       0.000464893897
             autocorr =       1.267347837875
              std dev =       0.584010866895
             le_variance =       0.341068692652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690915773875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909157738751       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909157772116       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909157777197       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909157778998       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909157768211       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909157767071       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909157765521       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909157769104       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 7.368368e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909157738751       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909157747131       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909157748417       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909157748859       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909157746107       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909157745820       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909157745434       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909157746322       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.843965e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909157738751       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909157740849       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909157741171       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909157741281       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909157740590       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909157740518       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909157740421       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909157740642       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.611088e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146659 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9237e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.073603e-01 1 1  ON 0
 uu_1                 1.420579e-01 1 1  ON 1
 uu_2                 4.329992e-02 1 1  ON 2
 uu_3                -1.792776e-02 1 1  ON 3
 uu_4                -6.302188e-02 1 1  ON 4
 uu_5                -9.703503e-02 1 1  ON 5
 uu_6                -1.244026e-01 1 1  ON 6
 uu_7                -1.378215e-01 1 1  ON 7
 uu_8                -1.332647e-01 1 1  ON 8
 uu_9                -1.047463e-01 1 1  ON 9
 ud_0                 4.352254e-01 1 1  ON 10
 ud_1                 1.774300e-01 1 1  ON 11
 ud_2                 6.417659e-02 1 1  ON 12
 ud_3                -4.449764e-03 1 1  ON 13
 ud_4                -6.087823e-02 1 1  ON 14
 ud_5                -1.024858e-01 1 1  ON 15
 ud_6                -1.302112e-01 1 1  ON 16
 ud_7                -1.481120e-01 1 1  ON 17
 ud_8                -1.519346e-01 1 1  ON 18
 ud_9                -1.447768e-01 1 1  ON 19
 eO_0                -7.492774e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.591007e-02 1 1  ON 22
 eO_3                 2.940514e-01 1 1  ON 23
 eO_4                 5.211022e-01 1 1  ON 24
 eO_5                 4.823958e-01 1 1  ON 25
 eO_6                 2.579440e-01 1 1  ON 26
 eO_7                -4.117604e-02 1 1  ON 27
 eO_8                -2.209625e-01 1 1  ON 28
 eO_9                -8.103620e-02 1 1  ON 29
eH1_0                -2.394879e-01 1 1  ON 30
eH1_1                -1.368282e-01 1 1  ON 31
eH1_2                -9.227943e-02 1 1  ON 32
eH1_3                -4.109971e-02 1 1  ON 33
eH1_4                 7.319922e-03 1 1  ON 34
eH1_5                 3.840549e-02 1 1  ON 35
eH1_6                 9.633967e-02 1 1  ON 36
eH1_7                 1.491643e-01 1 1  ON 37
eH1_8                 1.684388e-01 1 1  ON 38
eH1_9                 5.454041e-02 1 1  ON 39
eH2_0                -2.382345e-01 1 1  ON 40
eH2_1                -1.355715e-01 1 1  ON 41
eH2_2                -9.110442e-02 1 1  ON 42
eH2_3                -3.967187e-02 1 1  ON 43
eH2_4                 8.332686e-03 1 1  ON 44
eH2_5                 3.989830e-02 1 1  ON 45
eH2_6                 9.819873e-02 1 1  ON 46
eH2_7                 1.497040e-01 1 1  ON 47
eH2_8                 1.800198e-01 1 1  ON 48
eH2_9                 4.478862e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9661
    reference variance = 0.143195
====================================================
  Execution time = 2.2810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4122e-01
  Total weights = 2.0000e+06
  Execution time = 2.4386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341288558153
                                         uncertainty =       0.010702965382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341288558153
                                         uncertainty =       0.010702965382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413049201
  error estimate for blocks of size 2^( 2) =       0.000425463694
  error estimate for blocks of size 2^( 3) =       0.000437705628
  error estimate for blocks of size 2^( 4) =       0.000450002610
  error estimate for blocks of size 2^( 5) =       0.000461249309
  error estimate for blocks of size 2^( 6) =       0.000472968247
  error estimate for blocks of size 2^( 7) =       0.000481580311

      target function =                  N/A
              le_mean =     -16.909948911194
             les_mean =     286.287591292680
             stat err =       0.000466450120
             autocorr =       1.275283808107
              std dev =       0.584139781314
             le_variance =       0.341219284114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341293610049
                                         uncertainty =       0.010703085386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341293610049
                                         uncertainty =       0.010703085386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413052259
  error estimate for blocks of size 2^( 2) =       0.000425466664
  error estimate for blocks of size 2^( 3) =       0.000437708535
  error estimate for blocks of size 2^( 4) =       0.000450005396
  error estimate for blocks of size 2^( 5) =       0.000461252025
  error estimate for blocks of size 2^( 6) =       0.000472970966
  error estimate for blocks of size 2^( 7) =       0.000481582871

      target function =                  N/A
              le_mean =     -16.909948896706
             les_mean =     286.287595855778
             stat err =       0.000466452815
             autocorr =       1.275279659326
              std dev =       0.584144106517
             le_variance =       0.341224337179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341291107337
                                         uncertainty =       0.010703025922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341291107337
                                         uncertainty =       0.010703025922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413050744
  error estimate for blocks of size 2^( 2) =       0.000425465192
  error estimate for blocks of size 2^( 3) =       0.000437707094
  error estimate for blocks of size 2^( 4) =       0.000450004016
  error estimate for blocks of size 2^( 5) =       0.000461250680
  error estimate for blocks of size 2^( 6) =       0.000472969619
  error estimate for blocks of size 2^( 7) =       0.000481581603

      target function =                  N/A
              le_mean =     -16.909948903818
             les_mean =     286.287593593022
             stat err =       0.000466451479
             autocorr =       1.275281713868
              std dev =       0.584141963814
             le_variance =       0.341221833888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341288877513
                                         uncertainty =       0.010702972966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341288877513
                                         uncertainty =       0.010702972966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413049394
  error estimate for blocks of size 2^( 2) =       0.000425463882
  error estimate for blocks of size 2^( 3) =       0.000437705812
  error estimate for blocks of size 2^( 4) =       0.000450002786
  error estimate for blocks of size 2^( 5) =       0.000461249481
  error estimate for blocks of size 2^( 6) =       0.000472968419
  error estimate for blocks of size 2^( 7) =       0.000481580473

      target function =                  N/A
              le_mean =     -16.909948910264
             les_mean =     286.287591580679
             stat err =       0.000466450290
             autocorr =       1.275283545694
              std dev =       0.584140054736
             le_variance =       0.341219603547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909948911194        initial  <--
     3.8147e+01     3.8147e+02             7.3684e-06       -16.909948896706
     1.5259e+02     1.5259e+03             1.8440e-06       -16.909948903818
     6.1035e+02     6.1035e+03             4.6111e-07       -16.909948910264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1105
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9083
    reference variance = 0.217662
====================================================
  Execution time = 2.3043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3852e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338621505758
                                         uncertainty =       0.006496994429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338621505758
                                         uncertainty =       0.006496994429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411410600
  error estimate for blocks of size 2^( 2) =       0.000423861755
  error estimate for blocks of size 2^( 3) =       0.000436499299
  error estimate for blocks of size 2^( 4) =       0.000448289353
  error estimate for blocks of size 2^( 5) =       0.000459924026
  error estimate for blocks of size 2^( 6) =       0.000468025687
  error estimate for blocks of size 2^( 7) =       0.000473773461

      target function =                  N/A
              le_mean =     -16.908471501553
             les_mean =     286.234925712892
             stat err =       0.000462503132
             autocorr =       1.263800147750
              std dev =       0.581822450001
             le_variance =       0.338517363325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690847150155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908471501553       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908471502481       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908471503742       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908471504515       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908471506537       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908471507333       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908471507280       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908471507104       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.686798e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908471501553       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908471501785       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908471502100       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908471502294       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908471502799       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908471502998       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908471502987       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908471502941       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.671913e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908471501553       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908471501611       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908471501690       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908471501738       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908471501864       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908471501914       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908471501919       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908471501901       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.179917e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9118e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.073600e-01 1 1  ON 0
 uu_1                 1.420583e-01 1 1  ON 1
 uu_2                 4.330030e-02 1 1  ON 2
 uu_3                -1.792835e-02 1 1  ON 3
 uu_4                -6.302099e-02 1 1  ON 4
 uu_5                -9.703378e-02 1 1  ON 5
 uu_6                -1.244023e-01 1 1  ON 6
 uu_7                -1.378207e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047466e-01 1 1  ON 9
 ud_0                 4.352247e-01 1 1  ON 10
 ud_1                 1.774306e-01 1 1  ON 11
 ud_2                 6.417724e-02 1 1  ON 12
 ud_3                -4.449433e-03 1 1  ON 13
 ud_4                -6.087789e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481118e-01 1 1  ON 17
 ud_8                -1.519363e-01 1 1  ON 18
 ud_9                -1.447779e-01 1 1  ON 19
 eO_0                -7.492773e-01 1 1  ON 20
 eO_1                -4.362110e-01 1 1  ON 21
 eO_2                -2.590884e-02 1 1  ON 22
 eO_3                 2.940512e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823946e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117661e-02 1 1  ON 27
 eO_8                -2.209627e-01 1 1  ON 28
 eO_9                -8.103548e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368278e-01 1 1  ON 31
eH1_2                -9.227868e-02 1 1  ON 32
eH1_3                -4.109923e-02 1 1  ON 33
eH1_4                 7.320888e-03 1 1  ON 34
eH1_5                 3.840608e-02 1 1  ON 35
eH1_6                 9.633865e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684377e-01 1 1  ON 38
eH1_9                 5.453888e-02 1 1  ON 39
eH2_0                -2.382336e-01 1 1  ON 40
eH2_1                -1.355713e-01 1 1  ON 41
eH2_2                -9.110409e-02 1 1  ON 42
eH2_3                -3.967055e-02 1 1  ON 43
eH2_4                 8.332790e-03 1 1  ON 44
eH2_5                 3.989860e-02 1 1  ON 45
eH2_6                 9.819834e-02 1 1  ON 46
eH2_7                 1.497040e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8886
    reference variance = 0.185392
====================================================
  Execution time = 2.2927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3259e-01
  Total weights = 2.0000e+06
  Execution time = 2.4332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584236167
                                         uncertainty =       0.004031859609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584236167
                                         uncertainty =       0.004031859609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407793641
  error estimate for blocks of size 2^( 2) =       0.000419606278
  error estimate for blocks of size 2^( 3) =       0.000432550392
  error estimate for blocks of size 2^( 4) =       0.000444461700
  error estimate for blocks of size 2^( 5) =       0.000456863777
  error estimate for blocks of size 2^( 6) =       0.000464784980
  error estimate for blocks of size 2^( 7) =       0.000470942894

      target function =                  N/A
              le_mean =     -16.908972001246
             les_mean =     286.245925279629
             stat err =       0.000459263338
             autocorr =       1.268360351167
              std dev =       0.576707297521
             le_variance =       0.332591307014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584919053
                                         uncertainty =       0.004031867417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584919053
                                         uncertainty =       0.004031867417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407794059
  error estimate for blocks of size 2^( 2) =       0.000419606672
  error estimate for blocks of size 2^( 3) =       0.000432550765
  error estimate for blocks of size 2^( 4) =       0.000444462053
  error estimate for blocks of size 2^( 5) =       0.000456864132
  error estimate for blocks of size 2^( 6) =       0.000464785314
  error estimate for blocks of size 2^( 7) =       0.000470943222

      target function =                  N/A
              le_mean =     -16.908971999283
             les_mean =     286.245925896132
             stat err =       0.000459263680
             autocorr =       1.268359637609
              std dev =       0.576707889567
             le_variance =       0.332591989889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584577870
                                         uncertainty =       0.004031863516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584577870
                                         uncertainty =       0.004031863516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407793850
  error estimate for blocks of size 2^( 2) =       0.000419606475
  error estimate for blocks of size 2^( 3) =       0.000432550579
  error estimate for blocks of size 2^( 4) =       0.000444461876
  error estimate for blocks of size 2^( 5) =       0.000456863955
  error estimate for blocks of size 2^( 6) =       0.000464785147
  error estimate for blocks of size 2^( 7) =       0.000470943058

      target function =                  N/A
              le_mean =     -16.908972000263
             les_mean =     286.245925588093
             stat err =       0.000459263509
             autocorr =       1.268359994127
              std dev =       0.576707593770
             le_variance =       0.332591648712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584278888
                                         uncertainty =       0.004031860098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584278888
                                         uncertainty =       0.004031860098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407793667
  error estimate for blocks of size 2^( 2) =       0.000419606303
  error estimate for blocks of size 2^( 3) =       0.000432550416
  error estimate for blocks of size 2^( 4) =       0.000444461722
  error estimate for blocks of size 2^( 5) =       0.000456863800
  error estimate for blocks of size 2^( 6) =       0.000464785001
  error estimate for blocks of size 2^( 7) =       0.000470942915

      target function =                  N/A
              le_mean =     -16.908972001123
             les_mean =     286.245925318192
             stat err =       0.000459263359
             autocorr =       1.268360306529
              std dev =       0.576707334559
             le_variance =       0.332591349734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908972001246        initial  <--
     3.8147e+02     3.8147e+03             6.6868e-07       -16.908971999283
     1.5259e+03     1.5259e+04             1.6719e-07       -16.908972000263
     6.1035e+03     6.1035e+04             4.1799e-08       -16.908972001123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1965
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9453
    reference variance = 0.359259
====================================================
  Execution time = 2.3629e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334941519970
                                         uncertainty =       0.003897343941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334941519970
                                         uncertainty =       0.003897343941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409219083
  error estimate for blocks of size 2^( 2) =       0.000421066783
  error estimate for blocks of size 2^( 3) =       0.000433335828
  error estimate for blocks of size 2^( 4) =       0.000445400215
  error estimate for blocks of size 2^( 5) =       0.000456489517
  error estimate for blocks of size 2^( 6) =       0.000465560090
  error estimate for blocks of size 2^( 7) =       0.000472196457

      target function =                  N/A
              le_mean =     -16.908890217191
             les_mean =     286.245488724993
             stat err =       0.000459911570
             autocorr =       1.263097614403
              std dev =       0.578723176865
             le_variance =       0.334920515440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690889021719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890217191       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890217365       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890217592       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890217746       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890217747       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908890217742       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908890217735       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908890217745       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 9.071005e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890217191       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890217234       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890217291       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890217329       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890217326       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908890217313       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908890217324       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908890217310       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.267779e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890217191       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890217202       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890217216       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890217226       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890217186       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908890217177       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908890217223       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908890217216       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.669465e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9753e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.073600e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302088e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449365e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590891e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320904e-03 1 1  ON 34
eH1_5                 3.840611e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453876e-02 1 1  ON 39
eH2_0                -2.382336e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332836e-03 1 1  ON 44
eH2_5                 3.989857e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478679e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.301691
====================================================
  Execution time = 2.2985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5093e-01
  Total weights = 2.0000e+06
  Execution time = 2.4584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009236605
                                         uncertainty =       0.010127329991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009236605
                                         uncertainty =       0.010127329991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418884984
  error estimate for blocks of size 2^( 2) =       0.000431111472
  error estimate for blocks of size 2^( 3) =       0.000443921650
  error estimate for blocks of size 2^( 4) =       0.000455945294
  error estimate for blocks of size 2^( 5) =       0.000466896622
  error estimate for blocks of size 2^( 6) =       0.000474981820
  error estimate for blocks of size 2^( 7) =       0.000482324597

      target function =                  N/A
              le_mean =     -16.909332152648
             les_mean =     286.276442932570
             stat err =       0.000470037084
             autocorr =       1.259141858332
              std dev =       0.592392825296
             le_variance =       0.350929259462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009286588
                                         uncertainty =       0.010127331412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009286588
                                         uncertainty =       0.010127331412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418885014
  error estimate for blocks of size 2^( 2) =       0.000431111501
  error estimate for blocks of size 2^( 3) =       0.000443921678
  error estimate for blocks of size 2^( 4) =       0.000455945320
  error estimate for blocks of size 2^( 5) =       0.000466896647
  error estimate for blocks of size 2^( 6) =       0.000474981844
  error estimate for blocks of size 2^( 7) =       0.000482324620

      target function =                  N/A
              le_mean =     -16.909332152519
             les_mean =     286.276442978189
             stat err =       0.000470037108
             autocorr =       1.259141809179
              std dev =       0.592392867470
             le_variance =       0.350929309429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009261599
                                         uncertainty =       0.010127330702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009261599
                                         uncertainty =       0.010127330702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418884999
  error estimate for blocks of size 2^( 2) =       0.000431111486
  error estimate for blocks of size 2^( 3) =       0.000443921664
  error estimate for blocks of size 2^( 4) =       0.000455945307
  error estimate for blocks of size 2^( 5) =       0.000466896635
  error estimate for blocks of size 2^( 6) =       0.000474981832
  error estimate for blocks of size 2^( 7) =       0.000482324609

      target function =                  N/A
              le_mean =     -16.909332152584
             les_mean =     286.276442955381
             stat err =       0.000470037096
             autocorr =       1.259141833750
              std dev =       0.592392846385
             le_variance =       0.350929284448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009239730
                                         uncertainty =       0.010127330080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351009239730
                                         uncertainty =       0.010127330080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418884986
  error estimate for blocks of size 2^( 2) =       0.000431111474
  error estimate for blocks of size 2^( 3) =       0.000443921652
  error estimate for blocks of size 2^( 4) =       0.000455945296
  error estimate for blocks of size 2^( 5) =       0.000466896624
  error estimate for blocks of size 2^( 6) =       0.000474981822
  error estimate for blocks of size 2^( 7) =       0.000482324599

      target function =                  N/A
              le_mean =     -16.909332152640
             les_mean =     286.276442935421
             stat err =       0.000470037085
             autocorr =       1.259141855262
              std dev =       0.592392827932
             le_variance =       0.350929262585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909332152648        initial  <--
     3.8147e+03     3.8147e+04             9.0710e-08       -16.909332152519
     1.5259e+04     1.5259e+05             2.2678e-08       -16.909332152584
     6.1035e+04     6.1035e+05             5.6695e-09       -16.909332152640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.3027
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.190977
====================================================
  Execution time = 2.3039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3685e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336813192560
                                         uncertainty =       0.004434169194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336813192560
                                         uncertainty =       0.004434169194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398063
  error estimate for blocks of size 2^( 2) =       0.000422635260
  error estimate for blocks of size 2^( 3) =       0.000435900474
  error estimate for blocks of size 2^( 4) =       0.000448414556
  error estimate for blocks of size 2^( 5) =       0.000460313511
  error estimate for blocks of size 2^( 6) =       0.000470156585
  error estimate for blocks of size 2^( 7) =       0.000473653203

      target function =                  N/A
              le_mean =     -16.908569455420
             les_mean =     286.236574001010
             stat err =       0.000463134464
             autocorr =       1.273513622227
              std dev =       0.580390507048
             le_variance =       0.336853140671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690856945542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908569455420       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908569455441       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908569455467       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908569455503       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908569455494       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908569455518       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908569455495       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908569455563       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.225613e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908569455420       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908569455425       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908569455432       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908569455502       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908569455499       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908569455546       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908569455413       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908569455328       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.806409e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908569455420       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908569455421       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908569455423       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908569455464       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908569455425       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908569455113       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908569455208       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908569455993       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.516029e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9162e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449363e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8819
    reference variance = 0.142653
====================================================
  Execution time = 2.3265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3343e-01
  Total weights = 2.0000e+06
  Execution time = 2.4410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521809533
                                         uncertainty =       0.004159860680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521809533
                                         uncertainty =       0.004159860680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309225
  error estimate for blocks of size 2^( 2) =       0.000420597285
  error estimate for blocks of size 2^( 3) =       0.000433344479
  error estimate for blocks of size 2^( 4) =       0.000445173716
  error estimate for blocks of size 2^( 5) =       0.000456978171
  error estimate for blocks of size 2^( 6) =       0.000464896982
  error estimate for blocks of size 2^( 7) =       0.000472341305

      target function =                  N/A
              le_mean =     -16.909291614776
             les_mean =     286.257575593899
             stat err =       0.000459847544
             autocorr =       1.268379916013
              std dev =       0.577436444181
             le_variance =       0.333432847068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521812640
                                         uncertainty =       0.004159860692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521812640
                                         uncertainty =       0.004159860692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309227
  error estimate for blocks of size 2^( 2) =       0.000420597287
  error estimate for blocks of size 2^( 3) =       0.000433344481
  error estimate for blocks of size 2^( 4) =       0.000445173718
  error estimate for blocks of size 2^( 5) =       0.000456978172
  error estimate for blocks of size 2^( 6) =       0.000464896984
  error estimate for blocks of size 2^( 7) =       0.000472341307

      target function =                  N/A
              le_mean =     -16.909291614761
             les_mean =     286.257575596476
             stat err =       0.000459847545
             autocorr =       1.268379913640
              std dev =       0.577436446870
             le_variance =       0.333432850173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521811087
                                         uncertainty =       0.004159860686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521811087
                                         uncertainty =       0.004159860686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309226
  error estimate for blocks of size 2^( 2) =       0.000420597286
  error estimate for blocks of size 2^( 3) =       0.000433344480
  error estimate for blocks of size 2^( 4) =       0.000445173717
  error estimate for blocks of size 2^( 5) =       0.000456978171
  error estimate for blocks of size 2^( 6) =       0.000464896983
  error estimate for blocks of size 2^( 7) =       0.000472341306

      target function =                  N/A
              le_mean =     -16.909291614769
             les_mean =     286.257575595187
             stat err =       0.000459847544
             autocorr =       1.268379914828
              std dev =       0.577436445525
             le_variance =       0.333432848621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521809727
                                         uncertainty =       0.004159860680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333521809727
                                         uncertainty =       0.004159860680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309226
  error estimate for blocks of size 2^( 2) =       0.000420597285
  error estimate for blocks of size 2^( 3) =       0.000433344479
  error estimate for blocks of size 2^( 4) =       0.000445173716
  error estimate for blocks of size 2^( 5) =       0.000456978171
  error estimate for blocks of size 2^( 6) =       0.000464896982
  error estimate for blocks of size 2^( 7) =       0.000472341305

      target function =                  N/A
              le_mean =     -16.909291614775
             les_mean =     286.257575594060
             stat err =       0.000459847544
             autocorr =       1.268379915865
              std dev =       0.577436444349
             le_variance =       0.333432847262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909291614776        initial  <--
     3.8147e+04     3.8147e+05             7.2256e-09       -16.909291614761
     1.5259e+05     1.5259e+06             1.8064e-09       -16.909291614769
     6.1035e+05     6.1035e+06             4.5160e-10       -16.909291614775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.5812
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9907
    reference variance = 0.273001
====================================================
  Execution time = 2.3479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332583700792
                                         uncertainty =       0.005283034612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332583700792
                                         uncertainty =       0.005283034612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407766279
  error estimate for blocks of size 2^( 2) =       0.000419487773
  error estimate for blocks of size 2^( 3) =       0.000431487895
  error estimate for blocks of size 2^( 4) =       0.000443301538
  error estimate for blocks of size 2^( 5) =       0.000452931580
  error estimate for blocks of size 2^( 6) =       0.000460430705
  error estimate for blocks of size 2^( 7) =       0.000464373723

      target function =                  N/A
              le_mean =     -16.909456456162
             les_mean =     286.262264153021
             stat err =       0.000455259386
             autocorr =       1.246508376625
              std dev =       0.576668601941
             le_variance =       0.332546676465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690945645616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909456456162       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909456456164       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909456456165       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909456456222       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909456456282       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909456456315       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909456456164       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909456456148       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.404258e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909456456162       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909456456162       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909456456163       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909456456162       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909456456671       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909456456121       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909456456687       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909456456443       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.851065e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909456456162       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909456456162       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909456456162       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909456456091       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909456460427       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909456456451       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909456453744       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909456491059       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.627678e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3181e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.216994
====================================================
  Execution time = 2.3411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3665e-01
  Total weights = 2.0000e+06
  Execution time = 2.4326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244106
                                         uncertainty =       0.006774377394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244106
                                         uncertainty =       0.006774377394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410276689
  error estimate for blocks of size 2^( 2) =       0.000421860332
  error estimate for blocks of size 2^( 3) =       0.000434308829
  error estimate for blocks of size 2^( 4) =       0.000447037128
  error estimate for blocks of size 2^( 5) =       0.000457292925
  error estimate for blocks of size 2^( 6) =       0.000465569943
  error estimate for blocks of size 2^( 7) =       0.000472810827

      target function =                  N/A
              le_mean =     -16.909306685670
             les_mean =     286.261306345554
             stat err =       0.000460677706
             autocorr =       1.260784049158
              std dev =       0.580218858574
             le_variance =       0.336653923845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244522
                                         uncertainty =       0.006774377405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244522
                                         uncertainty =       0.006774377405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410276690
  error estimate for blocks of size 2^( 2) =       0.000421860332
  error estimate for blocks of size 2^( 3) =       0.000434308829
  error estimate for blocks of size 2^( 4) =       0.000447037129
  error estimate for blocks of size 2^( 5) =       0.000457292925
  error estimate for blocks of size 2^( 6) =       0.000465569943
  error estimate for blocks of size 2^( 7) =       0.000472810827

      target function =                  N/A
              le_mean =     -16.909306685670
             les_mean =     286.261306345967
             stat err =       0.000460677706
             autocorr =       1.260784048824
              std dev =       0.580218858933
             le_variance =       0.336653924261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244314
                                         uncertainty =       0.006774377399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244314
                                         uncertainty =       0.006774377399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410276690
  error estimate for blocks of size 2^( 2) =       0.000421860332
  error estimate for blocks of size 2^( 3) =       0.000434308829
  error estimate for blocks of size 2^( 4) =       0.000447037129
  error estimate for blocks of size 2^( 5) =       0.000457292925
  error estimate for blocks of size 2^( 6) =       0.000465569943
  error estimate for blocks of size 2^( 7) =       0.000472810827

      target function =                  N/A
              le_mean =     -16.909306685670
             les_mean =     286.261306345760
             stat err =       0.000460677706
             autocorr =       1.260784048988
              std dev =       0.580218858753
             le_variance =       0.336653924053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244132
                                         uncertainty =       0.006774377394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336721244132
                                         uncertainty =       0.006774377394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410276689
  error estimate for blocks of size 2^( 2) =       0.000421860332
  error estimate for blocks of size 2^( 3) =       0.000434308829
  error estimate for blocks of size 2^( 4) =       0.000447037128
  error estimate for blocks of size 2^( 5) =       0.000457292925
  error estimate for blocks of size 2^( 6) =       0.000465569943
  error estimate for blocks of size 2^( 7) =       0.000472810827

      target function =                  N/A
              le_mean =     -16.909306685670
             les_mean =     286.261306345579
             stat err =       0.000460677706
             autocorr =       1.260784049142
              std dev =       0.580218858597
             le_variance =       0.336653923871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909306685670        initial  <--
     3.8147e+05     3.8147e+06             7.4043e-10       -16.909306685670
     1.5259e+06     1.5259e+07             1.8511e-10       -16.909306685670
     6.1035e+06     6.1035e+07             4.6277e-11       -16.909306685670

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.6788
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.294737
====================================================
  Execution time = 2.3396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331618840945
                                         uncertainty =       0.003662385028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331618840945
                                         uncertainty =       0.003662385028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407154905
  error estimate for blocks of size 2^( 2) =       0.000419307803
  error estimate for blocks of size 2^( 3) =       0.000431684862
  error estimate for blocks of size 2^( 4) =       0.000443560973
  error estimate for blocks of size 2^( 5) =       0.000454701852
  error estimate for blocks of size 2^( 6) =       0.000463861325
  error estimate for blocks of size 2^( 7) =       0.000471165396

      target function =                  N/A
              le_mean =     -16.908265619384
             les_mean =     286.220996322484
             stat err =       0.000458322387
             autocorr =       1.267134747022
              std dev =       0.575803988012
             le_variance =       0.331550232610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690826561938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908265619384       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908265619384       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908265619385       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908265620430       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908265619303       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908265619304       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908265618279       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908265623383       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.417499e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908265619384       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908265619384       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908265619384       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908265617457       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908265621672       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908265614877       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908265609838       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908265612577       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.604352e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908265619384       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908265619384       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908265619384       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908265619384       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908265633409       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908265624081       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908265665018       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908265632261       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 4.011237e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9519e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8487
    reference variance = 0.220221
====================================================
  Execution time = 2.2706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3527e-01
  Total weights = 2.0000e+06
  Execution time = 2.4415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341630997
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341630997
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409434492
  error estimate for blocks of size 2^( 2) =       0.000421592640
  error estimate for blocks of size 2^( 3) =       0.000434355889
  error estimate for blocks of size 2^( 4) =       0.000446516149
  error estimate for blocks of size 2^( 5) =       0.000457644034
  error estimate for blocks of size 2^( 6) =       0.000467640177
  error estimate for blocks of size 2^( 7) =       0.000474589626

      target function =                  N/A
              le_mean =     -16.909256056642
             les_mean =     286.258213428407
             stat err =       0.000461597497
             autocorr =       1.271036543534
              std dev =       0.579027811919
             le_variance =       0.335273206976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631055
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631055
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409434492
  error estimate for blocks of size 2^( 2) =       0.000421592640
  error estimate for blocks of size 2^( 3) =       0.000434355889
  error estimate for blocks of size 2^( 4) =       0.000446516149
  error estimate for blocks of size 2^( 5) =       0.000457644034
  error estimate for blocks of size 2^( 6) =       0.000467640177
  error estimate for blocks of size 2^( 7) =       0.000474589626

      target function =                  N/A
              le_mean =     -16.909256056642
             les_mean =     286.258213428466
             stat err =       0.000461597497
             autocorr =       1.271036543471
              std dev =       0.579027811969
             le_variance =       0.335273207033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631026
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631026
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409434492
  error estimate for blocks of size 2^( 2) =       0.000421592640
  error estimate for blocks of size 2^( 3) =       0.000434355889
  error estimate for blocks of size 2^( 4) =       0.000446516149
  error estimate for blocks of size 2^( 5) =       0.000457644034
  error estimate for blocks of size 2^( 6) =       0.000467640177
  error estimate for blocks of size 2^( 7) =       0.000474589626

      target function =                  N/A
              le_mean =     -16.909256056642
             les_mean =     286.258213428436
             stat err =       0.000461597497
             autocorr =       1.271036543505
              std dev =       0.579027811944
             le_variance =       0.335273207005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631001
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335341631001
                                         uncertainty =       0.003967826685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409434492
  error estimate for blocks of size 2^( 2) =       0.000421592640
  error estimate for blocks of size 2^( 3) =       0.000434355889
  error estimate for blocks of size 2^( 4) =       0.000446516149
  error estimate for blocks of size 2^( 5) =       0.000457644034
  error estimate for blocks of size 2^( 6) =       0.000467640177
  error estimate for blocks of size 2^( 7) =       0.000474589626

      target function =                  N/A
              le_mean =     -16.909256056642
             les_mean =     286.258213428410
             stat err =       0.000461597497
             autocorr =       1.271036543518
              std dev =       0.579027811922
             le_variance =       0.335273206980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909256056642        initial
     3.8147e+06     3.8147e+07             6.4175e-11       -16.909256056642  <--
     1.5259e+07     1.5259e+08             1.6044e-11       -16.909256056642
     6.1035e+07     6.1035e+08             4.0112e-12       -16.909256056642

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 3.5038e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.324069
====================================================
  Execution time = 2.3029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339475178201
                                         uncertainty =       0.005935155535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339475178201
                                         uncertainty =       0.005935155535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411977524
  error estimate for blocks of size 2^( 2) =       0.000423828328
  error estimate for blocks of size 2^( 3) =       0.000435539382
  error estimate for blocks of size 2^( 4) =       0.000446428480
  error estimate for blocks of size 2^( 5) =       0.000456551535
  error estimate for blocks of size 2^( 6) =       0.000463534816
  error estimate for blocks of size 2^( 7) =       0.000468212672

      target function =                  N/A
              le_mean =     -16.909381260570
             les_mean =     286.266625405429
             stat err =       0.000458681876
             autocorr =       1.239584435514
              std dev =       0.582624201204
             le_variance =       0.339450959829


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690938126057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909381260570       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909381260571       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909381260571       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909381260728       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909381260990       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909381260954       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909381260616       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909381260263       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.969364e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909381260570       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909381260570       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909381260571       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909381260570       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909381263807       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909381260985       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909381257688       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909381260810       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 4.923387e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909381260570       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909381260570       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909381260570       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909381260570       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909381260637       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909381271098       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909381257873       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909381252852       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.230845e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9142e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8793
    reference variance = 0.25307
====================================================
  Execution time = 2.3068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2857e-01
  Total weights = 2.0000e+06
  Execution time = 2.4394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616148987
                                         uncertainty =       0.003590453358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616148987
                                         uncertainty =       0.003590453358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405318333
  error estimate for blocks of size 2^( 2) =       0.000417495824
  error estimate for blocks of size 2^( 3) =       0.000430425384
  error estimate for blocks of size 2^( 4) =       0.000443045914
  error estimate for blocks of size 2^( 5) =       0.000454377271
  error estimate for blocks of size 2^( 6) =       0.000462676167
  error estimate for blocks of size 2^( 7) =       0.000468317405

      target function =                  N/A
              le_mean =     -16.908721531459
             les_mean =     286.233429567037
             stat err =       0.000457104189
             autocorr =       1.271855892077
              std dev =       0.573206684266
             le_variance =       0.328565902887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616149143
                                         uncertainty =       0.003590453360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616149143
                                         uncertainty =       0.003590453360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405318334
  error estimate for blocks of size 2^( 2) =       0.000417495824
  error estimate for blocks of size 2^( 3) =       0.000430425384
  error estimate for blocks of size 2^( 4) =       0.000443045914
  error estimate for blocks of size 2^( 5) =       0.000454377271
  error estimate for blocks of size 2^( 6) =       0.000462676167
  error estimate for blocks of size 2^( 7) =       0.000468317405

      target function =                  N/A
              le_mean =     -16.908721531458
             les_mean =     286.233429567159
             stat err =       0.000457104189
             autocorr =       1.271855891911
              std dev =       0.573206684402
             le_variance =       0.328565903043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616149065
                                         uncertainty =       0.003590453359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616149065
                                         uncertainty =       0.003590453359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405318334
  error estimate for blocks of size 2^( 2) =       0.000417495824
  error estimate for blocks of size 2^( 3) =       0.000430425384
  error estimate for blocks of size 2^( 4) =       0.000443045914
  error estimate for blocks of size 2^( 5) =       0.000454377271
  error estimate for blocks of size 2^( 6) =       0.000462676167
  error estimate for blocks of size 2^( 7) =       0.000468317405

      target function =                  N/A
              le_mean =     -16.908721531459
             les_mean =     286.233429567098
             stat err =       0.000457104189
             autocorr =       1.271855891992
              std dev =       0.573206684334
             le_variance =       0.328565902965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616148996
                                         uncertainty =       0.003590453358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328616148996
                                         uncertainty =       0.003590453358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405318333
  error estimate for blocks of size 2^( 2) =       0.000417495824
  error estimate for blocks of size 2^( 3) =       0.000430425384
  error estimate for blocks of size 2^( 4) =       0.000443045914
  error estimate for blocks of size 2^( 5) =       0.000454377271
  error estimate for blocks of size 2^( 6) =       0.000462676167
  error estimate for blocks of size 2^( 7) =       0.000468317405

      target function =                  N/A
              le_mean =     -16.908721531459
             les_mean =     286.233429567044
             stat err =       0.000457104189
             autocorr =       1.271855892071
              std dev =       0.573206684274
             le_variance =       0.328565902896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908721531459        initial  <--
     9.5367e+05     9.5367e+06             1.9694e-10       -16.908721531458
     3.8147e+06     3.8147e+07             4.9234e-11       -16.908721531459
     1.5259e+07     1.5259e+08             1.2308e-11       -16.908721531459

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.3363
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4484e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9746
    reference variance = 0.343259
====================================================
  Execution time = 2.3032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332325860372
                                         uncertainty =       0.004676488849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332325860372
                                         uncertainty =       0.004676488849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407584585
  error estimate for blocks of size 2^( 2) =       0.000419217652
  error estimate for blocks of size 2^( 3) =       0.000432020752
  error estimate for blocks of size 2^( 4) =       0.000444037408
  error estimate for blocks of size 2^( 5) =       0.000454339023
  error estimate for blocks of size 2^( 6) =       0.000462403242
  error estimate for blocks of size 2^( 7) =       0.000468801768

      target function =                  N/A
              le_mean =     -16.909616989460
             les_mean =     286.267396951294
             stat err =       0.000457395360
             autocorr =       1.259354532840
              std dev =       0.576411647349
             le_variance =       0.332250387199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690961698946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909616989460       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909616989460       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909616989460       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909616988065       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909616990091       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909616993831       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909616989586       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909616985763       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.005496e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909616989460       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909616989460       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909616989460       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909617013097       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909617011359       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909616994829       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909616975401       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909617010752       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 7.513726e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909616989460       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909616989460       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909616989460       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909616989460       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909617033289       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909617030300       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909616945179       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909617013434       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.878447e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9147e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.246921
====================================================
  Execution time = 2.2731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4323e-01
  Total weights = 2.0000e+06
  Execution time = 2.4400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028137
                                         uncertainty =       0.008048503839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028137
                                         uncertainty =       0.008048503839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414262420
  error estimate for blocks of size 2^( 2) =       0.000425906194
  error estimate for blocks of size 2^( 3) =       0.000437970684
  error estimate for blocks of size 2^( 4) =       0.000450118111
  error estimate for blocks of size 2^( 5) =       0.000463087837
  error estimate for blocks of size 2^( 6) =       0.000472282612
  error estimate for blocks of size 2^( 7) =       0.000479992036

      target function =                  N/A
              le_mean =     -16.909545222385
             les_mean =     286.275946161055
             stat err =       0.000466370149
             autocorr =       1.267390402956
              std dev =       0.585855532341
             le_variance =       0.343226704775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028150
                                         uncertainty =       0.008048503840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028150
                                         uncertainty =       0.008048503840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414262420
  error estimate for blocks of size 2^( 2) =       0.000425906194
  error estimate for blocks of size 2^( 3) =       0.000437970684
  error estimate for blocks of size 2^( 4) =       0.000450118111
  error estimate for blocks of size 2^( 5) =       0.000463087837
  error estimate for blocks of size 2^( 6) =       0.000472282612
  error estimate for blocks of size 2^( 7) =       0.000479992036

      target function =                  N/A
              le_mean =     -16.909545222385
             les_mean =     286.275946161065
             stat err =       0.000466370149
             autocorr =       1.267390402948
              std dev =       0.585855532352
             le_variance =       0.343226704788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028144
                                         uncertainty =       0.008048503840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028144
                                         uncertainty =       0.008048503840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414262420
  error estimate for blocks of size 2^( 2) =       0.000425906194
  error estimate for blocks of size 2^( 3) =       0.000437970684
  error estimate for blocks of size 2^( 4) =       0.000450118111
  error estimate for blocks of size 2^( 5) =       0.000463087837
  error estimate for blocks of size 2^( 6) =       0.000472282612
  error estimate for blocks of size 2^( 7) =       0.000479992036

      target function =                  N/A
              le_mean =     -16.909545222385
             les_mean =     286.275946161060
             stat err =       0.000466370149
             autocorr =       1.267390402953
              std dev =       0.585855532347
             le_variance =       0.343226704781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028138
                                         uncertainty =       0.008048503839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273028138
                                         uncertainty =       0.008048503839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414262420
  error estimate for blocks of size 2^( 2) =       0.000425906194
  error estimate for blocks of size 2^( 3) =       0.000437970684
  error estimate for blocks of size 2^( 4) =       0.000450118111
  error estimate for blocks of size 2^( 5) =       0.000463087837
  error estimate for blocks of size 2^( 6) =       0.000472282612
  error estimate for blocks of size 2^( 7) =       0.000479992036

      target function =                  N/A
              le_mean =     -16.909545222385
             les_mean =     286.275946161055
             stat err =       0.000466370149
             autocorr =       1.267390402955
              std dev =       0.585855532342
             le_variance =       0.343226704775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909545222385        initial  <--
     9.5367e+06     9.5367e+07             3.0055e-11       -16.909545222385
     3.8147e+07     3.8147e+08             7.5137e-12       -16.909545222385
     1.5259e+08     1.5259e+09             1.8784e-12       -16.909545222385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0287
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.203301
====================================================
  Execution time = 2.2998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3214e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218892268
                                         uncertainty =       0.005218644310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218892268
                                         uncertainty =       0.005218644310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407519998
  error estimate for blocks of size 2^( 2) =       0.000419544000
  error estimate for blocks of size 2^( 3) =       0.000431601307
  error estimate for blocks of size 2^( 4) =       0.000443224838
  error estimate for blocks of size 2^( 5) =       0.000453629969
  error estimate for blocks of size 2^( 6) =       0.000459056290
  error estimate for blocks of size 2^( 7) =       0.000463251612

      target function =                  N/A
              le_mean =     -16.909388214974
             les_mean =     286.259554736907
             stat err =       0.000454790677
             autocorr =       1.245447012192
              std dev =       0.576320308741
             le_variance =       0.332145098267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690938821497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909388214974       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909388214974       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909388214974       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909388214974       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909388215914       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909388215269       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909388242842       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909388269157       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.041658e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909388214974       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909388214974       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909388214974       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909388214429       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909388257109       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909388531861       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909388132882       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909388182144       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 7.604100e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909388214974       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909388214974       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909388214974       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909388482006       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909388335949       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909388248349       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909388688448       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909386774263       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.902275e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9113e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9132
    reference variance = 0.152117
====================================================
  Execution time = 2.2751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3761e-01
  Total weights = 2.0000e+06
  Execution time = 2.4423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833203
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833203
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410858014
  error estimate for blocks of size 2^( 2) =       0.000423073864
  error estimate for blocks of size 2^( 3) =       0.000436057551
  error estimate for blocks of size 2^( 4) =       0.000448114432
  error estimate for blocks of size 2^( 5) =       0.000460582596
  error estimate for blocks of size 2^( 6) =       0.000471106961
  error estimate for blocks of size 2^( 7) =       0.000474720235

      target function =                  N/A
              le_mean =     -16.908993582358
             les_mean =     286.251672415247
             stat err =       0.000463631056
             autocorr =       1.273390227979
              std dev =       0.581040976031
             le_variance =       0.337608615827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833204
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833204
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410858014
  error estimate for blocks of size 2^( 2) =       0.000423073864
  error estimate for blocks of size 2^( 3) =       0.000436057551
  error estimate for blocks of size 2^( 4) =       0.000448114432
  error estimate for blocks of size 2^( 5) =       0.000460582596
  error estimate for blocks of size 2^( 6) =       0.000471106961
  error estimate for blocks of size 2^( 7) =       0.000474720235

      target function =                  N/A
              le_mean =     -16.908993582358
             les_mean =     286.251672415248
             stat err =       0.000463631056
             autocorr =       1.273390227981
              std dev =       0.581040976031
             le_variance =       0.337608615827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833204
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833204
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410858014
  error estimate for blocks of size 2^( 2) =       0.000423073864
  error estimate for blocks of size 2^( 3) =       0.000436057551
  error estimate for blocks of size 2^( 4) =       0.000448114432
  error estimate for blocks of size 2^( 5) =       0.000460582596
  error estimate for blocks of size 2^( 6) =       0.000471106961
  error estimate for blocks of size 2^( 7) =       0.000474720235

      target function =                  N/A
              le_mean =     -16.908993582358
             les_mean =     286.251672415247
             stat err =       0.000463631056
             autocorr =       1.273390227982
              std dev =       0.581040976031
             le_variance =       0.337608615827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833203
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621833203
                                         uncertainty =       0.005524615355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410858014
  error estimate for blocks of size 2^( 2) =       0.000423073864
  error estimate for blocks of size 2^( 3) =       0.000436057551
  error estimate for blocks of size 2^( 4) =       0.000448114432
  error estimate for blocks of size 2^( 5) =       0.000460582596
  error estimate for blocks of size 2^( 6) =       0.000471106961
  error estimate for blocks of size 2^( 7) =       0.000474720235

      target function =                  N/A
              le_mean =     -16.908993582358
             les_mean =     286.251672415247
             stat err =       0.000463631056
             autocorr =       1.273390227977
              std dev =       0.581040976031
             le_variance =       0.337608615827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908993582358        initial
     9.5367e+07     9.5367e+08             3.0417e-12       -16.908993582358  <--
     3.8147e+08     3.8147e+09             7.6041e-13       -16.908993582358
     1.5259e+09     1.5259e+10             1.9023e-13       -16.908993582358

*****************************************************************************
Applying the update for shift_i =   9.5367e+07     and shift_s =   9.5367e+08
*****************************************************************************

  Execution time = 3.5030e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9162
    reference variance = 0.199638
====================================================
  Execution time = 2.5672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3733e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337331738671
                                         uncertainty =       0.003639755068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337331738671
                                         uncertainty =       0.003639755068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410687777
  error estimate for blocks of size 2^( 2) =       0.000422718608
  error estimate for blocks of size 2^( 3) =       0.000435005121
  error estimate for blocks of size 2^( 4) =       0.000445990679
  error estimate for blocks of size 2^( 5) =       0.000455586358
  error estimate for blocks of size 2^( 6) =       0.000463457094
  error estimate for blocks of size 2^( 7) =       0.000466726737

      target function =                  N/A
              le_mean =     -16.909841290924
             les_mean =     286.280061216577
             stat err =       0.000457940217
             autocorr =       1.243351765333
              std dev =       0.580800224690
             le_variance =       0.337328901000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690984129092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909841290924       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909841290924       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909841290924       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909841290924       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909841280595       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909841288509       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909841286444       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909841294790       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.502884e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909841290924       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909841290924       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909841290924       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909841290924       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909841271328       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909841248484       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909841277739       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909841274334       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.375607e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909841290924       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909841290924       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909841290924       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909840953547       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909841499125       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909841037298       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909841454052       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909841430990       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.937341e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1856e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0207
    reference variance = 0.172558
====================================================
  Execution time = 2.2434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4069e-01
  Total weights = 2.0000e+06
  Execution time = 2.4445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769080
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769080
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412727353
  error estimate for blocks of size 2^( 2) =       0.000424965444
  error estimate for blocks of size 2^( 3) =       0.000437685446
  error estimate for blocks of size 2^( 4) =       0.000449978322
  error estimate for blocks of size 2^( 5) =       0.000460150044
  error estimate for blocks of size 2^( 6) =       0.000467088739
  error estimate for blocks of size 2^( 7) =       0.000472337243

      target function =                  N/A
              le_mean =     -16.908697811192
             les_mean =     286.244749236115
             stat err =       0.000462388587
             autocorr =       1.255127102838
              std dev =       0.583684620550
             le_variance =       0.340687736266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769088
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769088
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412727353
  error estimate for blocks of size 2^( 2) =       0.000424965444
  error estimate for blocks of size 2^( 3) =       0.000437685446
  error estimate for blocks of size 2^( 4) =       0.000449978322
  error estimate for blocks of size 2^( 5) =       0.000460150044
  error estimate for blocks of size 2^( 6) =       0.000467088739
  error estimate for blocks of size 2^( 7) =       0.000472337243

      target function =                  N/A
              le_mean =     -16.908697811192
             les_mean =     286.244749236124
             stat err =       0.000462388587
             autocorr =       1.255127102853
              std dev =       0.583684620556
             le_variance =       0.340687736273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769084
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769084
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412727353
  error estimate for blocks of size 2^( 2) =       0.000424965444
  error estimate for blocks of size 2^( 3) =       0.000437685446
  error estimate for blocks of size 2^( 4) =       0.000449978322
  error estimate for blocks of size 2^( 5) =       0.000460150044
  error estimate for blocks of size 2^( 6) =       0.000467088739
  error estimate for blocks of size 2^( 7) =       0.000472337243

      target function =                  N/A
              le_mean =     -16.908697811192
             les_mean =     286.244749236119
             stat err =       0.000462388587
             autocorr =       1.255127102846
              std dev =       0.583684620553
             le_variance =       0.340687736270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769081
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340785769081
                                         uncertainty =       0.005626023159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412727353
  error estimate for blocks of size 2^( 2) =       0.000424965444
  error estimate for blocks of size 2^( 3) =       0.000437685446
  error estimate for blocks of size 2^( 4) =       0.000449978322
  error estimate for blocks of size 2^( 5) =       0.000460150044
  error estimate for blocks of size 2^( 6) =       0.000467088739
  error estimate for blocks of size 2^( 7) =       0.000472337243

      target function =                  N/A
              le_mean =     -16.908697811192
             les_mean =     286.244749236116
             stat err =       0.000462388587
             autocorr =       1.255127102846
              std dev =       0.583684620550
             le_variance =       0.340687736267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908697811192        initial
     2.3842e+07     2.3842e+08             9.5029e-12       -16.908697811192  <--
     9.5367e+07     9.5367e+08             2.3756e-12       -16.908697811192
     3.8147e+08     3.8147e+09             5.9373e-13       -16.908697811192

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 3.4778e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.201164
====================================================
  Execution time = 2.3212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3775e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337812727718
                                         uncertainty =       0.003985209317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337812727718
                                         uncertainty =       0.003985209317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410941138
  error estimate for blocks of size 2^( 2) =       0.000423323711
  error estimate for blocks of size 2^( 3) =       0.000435829153
  error estimate for blocks of size 2^( 4) =       0.000448760223
  error estimate for blocks of size 2^( 5) =       0.000460864097
  error estimate for blocks of size 2^( 6) =       0.000470438749
  error estimate for blocks of size 2^( 7) =       0.000477618656

      target function =                  N/A
              le_mean =     -16.910064562798
             les_mean =     286.288028586777
             stat err =       0.000464420431
             autocorr =       1.277213194884
              std dev =       0.581158530579
             le_variance =       0.337745237665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691006456280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910064562798       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910064562798       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910064562798       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910064562798       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910064565115       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910064568513       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910064563550       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910064569132       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910064545213       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 6.226332e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910064562798       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910064562798       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910064562798       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910064562798       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910064556018       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910064577254       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910064542511       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910064568391       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910064486071       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.556540e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910064562798       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910064562798       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910064562798       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910064562798       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910064568050       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910064562963       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910064518082       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910064562798       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910064524313       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.891041e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9280e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.1601
====================================================
  Execution time = 2.2784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3084e-01
  Total weights = 2.0000e+06
  Execution time = 2.4379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348085
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348085
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406716967
  error estimate for blocks of size 2^( 2) =       0.000419147264
  error estimate for blocks of size 2^( 3) =       0.000431929123
  error estimate for blocks of size 2^( 4) =       0.000445252212
  error estimate for blocks of size 2^( 5) =       0.000457001833
  error estimate for blocks of size 2^( 6) =       0.000466537040
  error estimate for blocks of size 2^( 7) =       0.000471127767

      target function =                  N/A
              le_mean =     -16.909308349553
             les_mean =     286.255546077133
             stat err =       0.000459979713
             autocorr =       1.279065471833
              std dev =       0.575184650614
             le_variance =       0.330837382302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348095
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348095
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406716967
  error estimate for blocks of size 2^( 2) =       0.000419147264
  error estimate for blocks of size 2^( 3) =       0.000431929123
  error estimate for blocks of size 2^( 4) =       0.000445252212
  error estimate for blocks of size 2^( 5) =       0.000457001833
  error estimate for blocks of size 2^( 6) =       0.000466537040
  error estimate for blocks of size 2^( 7) =       0.000471127767

      target function =                  N/A
              le_mean =     -16.909308349553
             les_mean =     286.255546077146
             stat err =       0.000459979713
             autocorr =       1.279065471820
              std dev =       0.575184650622
             le_variance =       0.330837382311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348090
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348090
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406716967
  error estimate for blocks of size 2^( 2) =       0.000419147264
  error estimate for blocks of size 2^( 3) =       0.000431929123
  error estimate for blocks of size 2^( 4) =       0.000445252212
  error estimate for blocks of size 2^( 5) =       0.000457001833
  error estimate for blocks of size 2^( 6) =       0.000466537040
  error estimate for blocks of size 2^( 7) =       0.000471127767

      target function =                  N/A
              le_mean =     -16.909308349553
             les_mean =     286.255546077140
             stat err =       0.000459979713
             autocorr =       1.279065471819
              std dev =       0.575184650618
             le_variance =       0.330837382307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348086
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839348086
                                         uncertainty =       0.003242974833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406716967
  error estimate for blocks of size 2^( 2) =       0.000419147264
  error estimate for blocks of size 2^( 3) =       0.000431929123
  error estimate for blocks of size 2^( 4) =       0.000445252212
  error estimate for blocks of size 2^( 5) =       0.000457001833
  error estimate for blocks of size 2^( 6) =       0.000466537040
  error estimate for blocks of size 2^( 7) =       0.000471127767

      target function =                  N/A
              le_mean =     -16.909308349553
             les_mean =     286.255546077134
             stat err =       0.000459979713
             autocorr =       1.279065471828
              std dev =       0.575184650614
             le_variance =       0.330837382302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909308349553        initial
     5.9605e+06     5.9605e+07             6.2263e-11       -16.909308349553  <--
     2.3842e+07     2.3842e+08             1.5565e-11       -16.909308349553
     9.5367e+07     9.5367e+08             3.8910e-12       -16.909308349553

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 3.5046e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9182
    reference variance = 0.215093
====================================================
  Execution time = 2.3320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2835e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328444950580
                                         uncertainty =       0.003681796825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328444950580
                                         uncertainty =       0.003681796825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405187913
  error estimate for blocks of size 2^( 2) =       0.000417271913
  error estimate for blocks of size 2^( 3) =       0.000429812755
  error estimate for blocks of size 2^( 4) =       0.000441946864
  error estimate for blocks of size 2^( 5) =       0.000452626187
  error estimate for blocks of size 2^( 6) =       0.000460539628
  error estimate for blocks of size 2^( 7) =       0.000462495811

      target function =                  N/A
              le_mean =     -16.909558011174
             les_mean =     286.261506459407
             stat err =       0.000454402123
             autocorr =       1.257673002929
              std dev =       0.573022242433
             le_variance =       0.328354490323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690955801117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909558011174       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909558011175       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909558011174       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909558011130       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909558010388       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909558009323       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909558011389       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909558011384       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.445239e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909558011174       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909558011174       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909558011174       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909558011174       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909558006936       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909558011179       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909558011174       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909558009895       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.613095e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909558011174       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909558011174       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909558011174       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909558011174       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909558011174       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909558005508       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909558019308       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909558048346       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.032513e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9433e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8537
    reference variance = 0.215059
====================================================
  Execution time = 2.3173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3775e-01
  Total weights = 2.0000e+06
  Execution time = 2.4341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821713
                                         uncertainty =       0.007949924563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821713
                                         uncertainty =       0.007949924563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410942339
  error estimate for blocks of size 2^( 2) =       0.000423733138
  error estimate for blocks of size 2^( 3) =       0.000436576320
  error estimate for blocks of size 2^( 4) =       0.000449694129
  error estimate for blocks of size 2^( 5) =       0.000460959274
  error estimate for blocks of size 2^( 6) =       0.000470967914
  error estimate for blocks of size 2^( 7) =       0.000477492201

      target function =                  N/A
              le_mean =     -16.909550279066
             les_mean =     286.270637683373
             stat err =       0.000464778379
             autocorr =       1.279175278963
              std dev =       0.581160229174
             le_variance =       0.337747211974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821916
                                         uncertainty =       0.007949924572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821916
                                         uncertainty =       0.007949924572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410942339
  error estimate for blocks of size 2^( 2) =       0.000423733138
  error estimate for blocks of size 2^( 3) =       0.000436576320
  error estimate for blocks of size 2^( 4) =       0.000449694129
  error estimate for blocks of size 2^( 5) =       0.000460959274
  error estimate for blocks of size 2^( 6) =       0.000470967914
  error estimate for blocks of size 2^( 7) =       0.000477492201

      target function =                  N/A
              le_mean =     -16.909550279067
             les_mean =     286.270637683600
             stat err =       0.000464778380
             autocorr =       1.279175278762
              std dev =       0.581160229348
             le_variance =       0.337747212176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821815
                                         uncertainty =       0.007949924567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821815
                                         uncertainty =       0.007949924567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410942339
  error estimate for blocks of size 2^( 2) =       0.000423733138
  error estimate for blocks of size 2^( 3) =       0.000436576320
  error estimate for blocks of size 2^( 4) =       0.000449694129
  error estimate for blocks of size 2^( 5) =       0.000460959274
  error estimate for blocks of size 2^( 6) =       0.000470967914
  error estimate for blocks of size 2^( 7) =       0.000477492201

      target function =                  N/A
              le_mean =     -16.909550279067
             les_mean =     286.270637683487
             stat err =       0.000464778380
             autocorr =       1.279175278864
              std dev =       0.581160229261
             le_variance =       0.337747212075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821726
                                         uncertainty =       0.007949924563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852821726
                                         uncertainty =       0.007949924563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410942339
  error estimate for blocks of size 2^( 2) =       0.000423733138
  error estimate for blocks of size 2^( 3) =       0.000436576320
  error estimate for blocks of size 2^( 4) =       0.000449694129
  error estimate for blocks of size 2^( 5) =       0.000460959274
  error estimate for blocks of size 2^( 6) =       0.000470967914
  error estimate for blocks of size 2^( 7) =       0.000477492201

      target function =                  N/A
              le_mean =     -16.909550279066
             les_mean =     286.270637683387
             stat err =       0.000464778380
             autocorr =       1.279175278953
              std dev =       0.581160229185
             le_variance =       0.337747211986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909550279066        initial
     1.4901e+06     1.4901e+07             1.4452e-10       -16.909550279067  <--
     5.9605e+06     5.9605e+07             3.6131e-11       -16.909550279067
     2.3842e+07     2.3842e+08             9.0325e-12       -16.909550279066

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 3.5476e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.340258
====================================================
  Execution time = 2.3088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966792563
                                         uncertainty =       0.012258785872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342966792563
                                         uncertainty =       0.012258785872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414129422
  error estimate for blocks of size 2^( 2) =       0.000425918158
  error estimate for blocks of size 2^( 3) =       0.000438664121
  error estimate for blocks of size 2^( 4) =       0.000449807903
  error estimate for blocks of size 2^( 5) =       0.000460894382
  error estimate for blocks of size 2^( 6) =       0.000469846623
  error estimate for blocks of size 2^( 7) =       0.000473949964

      target function =                  N/A
              le_mean =     -16.908779851345
             les_mean =     286.249842245730
             stat err =       0.000463624718
             autocorr =       1.253317177574
              std dev =       0.585667444880
             le_variance =       0.343006355993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690877985134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779851345       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908779851344       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908779851343       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908779851343       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908779851321       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908779851223       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908779851731       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908779851647       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.625274e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779851345       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908779851345       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908779851344       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908779850886       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908779851453       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908779851653       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908779851736       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908779851006       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.656324e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779851345       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908779851345       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908779851345       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908779851635       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908779848646       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908779850887       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908779852723       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908779855819       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.140794e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9167e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.254631
====================================================
  Execution time = 2.2700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3105e-01
  Total weights = 2.0000e+06
  Execution time = 2.4326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990181
                                         uncertainty =       0.003270682603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990181
                                         uncertainty =       0.003270682603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406849246
  error estimate for blocks of size 2^( 2) =       0.000419151632
  error estimate for blocks of size 2^( 3) =       0.000432307040
  error estimate for blocks of size 2^( 4) =       0.000445239709
  error estimate for blocks of size 2^( 5) =       0.000455293697
  error estimate for blocks of size 2^( 6) =       0.000461930241
  error estimate for blocks of size 2^( 7) =       0.000468590555

      target function =                  N/A
              le_mean =     -16.909207448163
             les_mean =     286.252348978232
             stat err =       0.000457763550
             autocorr =       1.265946596258
              std dev =       0.575371722232
             le_variance =       0.331052618744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990750
                                         uncertainty =       0.003270682609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990750
                                         uncertainty =       0.003270682609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406849247
  error estimate for blocks of size 2^( 2) =       0.000419151632
  error estimate for blocks of size 2^( 3) =       0.000432307040
  error estimate for blocks of size 2^( 4) =       0.000445239709
  error estimate for blocks of size 2^( 5) =       0.000455293697
  error estimate for blocks of size 2^( 6) =       0.000461930241
  error estimate for blocks of size 2^( 7) =       0.000468590555

      target function =                  N/A
              le_mean =     -16.909207448156
             les_mean =     286.252348978574
             stat err =       0.000457763551
             autocorr =       1.265946595665
              std dev =       0.575371722726
             le_variance =       0.331052619312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990465
                                         uncertainty =       0.003270682606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990465
                                         uncertainty =       0.003270682606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406849247
  error estimate for blocks of size 2^( 2) =       0.000419151632
  error estimate for blocks of size 2^( 3) =       0.000432307040
  error estimate for blocks of size 2^( 4) =       0.000445239709
  error estimate for blocks of size 2^( 5) =       0.000455293697
  error estimate for blocks of size 2^( 6) =       0.000461930241
  error estimate for blocks of size 2^( 7) =       0.000468590555

      target function =                  N/A
              le_mean =     -16.909207448160
             les_mean =     286.252348978403
             stat err =       0.000457763550
             autocorr =       1.265946595963
              std dev =       0.575371722479
             le_variance =       0.331052619028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990217
                                         uncertainty =       0.003270682603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331109990217
                                         uncertainty =       0.003270682603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406849247
  error estimate for blocks of size 2^( 2) =       0.000419151632
  error estimate for blocks of size 2^( 3) =       0.000432307040
  error estimate for blocks of size 2^( 4) =       0.000445239709
  error estimate for blocks of size 2^( 5) =       0.000455293697
  error estimate for blocks of size 2^( 6) =       0.000461930241
  error estimate for blocks of size 2^( 7) =       0.000468590555

      target function =                  N/A
              le_mean =     -16.909207448163
             les_mean =     286.252348978253
             stat err =       0.000457763550
             autocorr =       1.265946596223
              std dev =       0.575371722262
             le_variance =       0.331052618779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909207448163        initial  <--
     3.7253e+05     3.7253e+06             6.6253e-10       -16.909207448156
     1.4901e+06     1.4901e+07             1.6563e-10       -16.909207448160
     5.9605e+06     5.9605e+07             4.1408e-11       -16.909207448163

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9817
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320914e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9699
    reference variance = 0.170625
====================================================
  Execution time = 2.3272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3562e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335557837451
                                         uncertainty =       0.004240985189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335557837451
                                         uncertainty =       0.004240985189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409648785
  error estimate for blocks of size 2^( 2) =       0.000421640089
  error estimate for blocks of size 2^( 3) =       0.000434853524
  error estimate for blocks of size 2^( 4) =       0.000446593585
  error estimate for blocks of size 2^( 5) =       0.000457685287
  error estimate for blocks of size 2^( 6) =       0.000465318747
  error estimate for blocks of size 2^( 7) =       0.000471727975

      target function =                  N/A
              le_mean =     -16.909425341997
             les_mean =     286.264289482244
             stat err =       0.000460331399
             autocorr =       1.262751391930
              std dev =       0.579330867032
             le_variance =       0.335624253496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690942534200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909425341997       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909425341997       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909425341997       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909425341997       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909425341976       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909425339958       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909425339568       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909425342297       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.046319e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909425341997       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909425341997       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909425341997       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909425341997       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909425331441       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909425341124       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909425331807       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909425357659       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.761567e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909425341997       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909425341997       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909425341997       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909425341997       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909425341729       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909425344690       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909425352998       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909425335639       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 4.404011e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9424e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8523
    reference variance = 0.308294
====================================================
  Execution time = 2.4779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3293e-01
  Total weights = 2.0000e+06
  Execution time = 2.4335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920489
                                         uncertainty =       0.004874608785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920489
                                         uncertainty =       0.004874608785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408000189
  error estimate for blocks of size 2^( 2) =       0.000420087254
  error estimate for blocks of size 2^( 3) =       0.000432666883
  error estimate for blocks of size 2^( 4) =       0.000444577398
  error estimate for blocks of size 2^( 5) =       0.000455166698
  error estimate for blocks of size 2^( 6) =       0.000464247481
  error estimate for blocks of size 2^( 7) =       0.000471553078

      target function =                  N/A
              le_mean =     -16.908728999725
             les_mean =     286.238044528731
             stat err =       0.000458886164
             autocorr =       1.264996130275
              std dev =       0.576999401247
             le_variance =       0.332928309039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920502
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920502
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408000189
  error estimate for blocks of size 2^( 2) =       0.000420087254
  error estimate for blocks of size 2^( 3) =       0.000432666883
  error estimate for blocks of size 2^( 4) =       0.000444577398
  error estimate for blocks of size 2^( 5) =       0.000455166698
  error estimate for blocks of size 2^( 6) =       0.000464247481
  error estimate for blocks of size 2^( 7) =       0.000471553078

      target function =                  N/A
              le_mean =     -16.908728999726
             les_mean =     286.238044528749
             stat err =       0.000458886164
             autocorr =       1.264996130259
              std dev =       0.576999401258
             le_variance =       0.332928309052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920496
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920496
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408000189
  error estimate for blocks of size 2^( 2) =       0.000420087254
  error estimate for blocks of size 2^( 3) =       0.000432666883
  error estimate for blocks of size 2^( 4) =       0.000444577398
  error estimate for blocks of size 2^( 5) =       0.000455166698
  error estimate for blocks of size 2^( 6) =       0.000464247481
  error estimate for blocks of size 2^( 7) =       0.000471553078

      target function =                  N/A
              le_mean =     -16.908728999726
             les_mean =     286.238044528740
             stat err =       0.000458886164
             autocorr =       1.264996130269
              std dev =       0.576999401252
             le_variance =       0.332928309046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920490
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333028920490
                                         uncertainty =       0.004874608786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408000189
  error estimate for blocks of size 2^( 2) =       0.000420087254
  error estimate for blocks of size 2^( 3) =       0.000432666883
  error estimate for blocks of size 2^( 4) =       0.000444577398
  error estimate for blocks of size 2^( 5) =       0.000455166698
  error estimate for blocks of size 2^( 6) =       0.000464247481
  error estimate for blocks of size 2^( 7) =       0.000471553078

      target function =                  N/A
              le_mean =     -16.908728999725
             les_mean =     286.238044528732
             stat err =       0.000458886164
             autocorr =       1.264996130275
              std dev =       0.576999401247
             le_variance =       0.332928309040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908728999725        initial
     3.7253e+06     3.7253e+07             7.0463e-11       -16.908728999726  <--
     1.4901e+07     1.4901e+08             1.7616e-11       -16.908728999726
     5.9605e+07     5.9605e+08             4.4040e-12       -16.908728999725

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 3.7060e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8674
    reference variance = 0.294003
====================================================
  Execution time = 2.3110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331550941283
                                         uncertainty =       0.003617625193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331550941283
                                         uncertainty =       0.003617625193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407176458
  error estimate for blocks of size 2^( 2) =       0.000419465602
  error estimate for blocks of size 2^( 3) =       0.000432029552
  error estimate for blocks of size 2^( 4) =       0.000444916472
  error estimate for blocks of size 2^( 5) =       0.000456860479
  error estimate for blocks of size 2^( 6) =       0.000467244320
  error estimate for blocks of size 2^( 7) =       0.000472199703

      target function =                  N/A
              le_mean =     -16.909491205950
             les_mean =     286.262478013828
             stat err =       0.000460305244
             autocorr =       1.277987260869
              std dev =       0.575834468842
             le_variance =       0.331585335506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690949120595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909491205950       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909491205951       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909491205951       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909491206126       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909491206039       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909491204817       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909491206060       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909491214234       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.274171e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909491205950       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909491205951       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909491205951       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909491205950       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909491206183       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909491205792       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909491207345       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909491205713       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.685426e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909491205950       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909491205950       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909491205950       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909491205950       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909491203776       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909491215623       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909491201715       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909491197486       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.421354e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9265e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9263
    reference variance = 0.255056
====================================================
  Execution time = 2.2636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.0000e+06
  Execution time = 2.4459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354540901
                                         uncertainty =       0.005246199544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354540901
                                         uncertainty =       0.005246199544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411875113
  error estimate for blocks of size 2^( 2) =       0.000424165286
  error estimate for blocks of size 2^( 3) =       0.000436210208
  error estimate for blocks of size 2^( 4) =       0.000448409186
  error estimate for blocks of size 2^( 5) =       0.000459915943
  error estimate for blocks of size 2^( 6) =       0.000469534611
  error estimate for blocks of size 2^( 7) =       0.000474509299

      target function =                  N/A
              le_mean =     -16.909483699679
             les_mean =     286.269921037934
             stat err =       0.000463092260
             autocorr =       1.264165521765
              std dev =       0.582479371203
             le_variance =       0.339282217877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354541130
                                         uncertainty =       0.005246199549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354541130
                                         uncertainty =       0.005246199549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411875113
  error estimate for blocks of size 2^( 2) =       0.000424165286
  error estimate for blocks of size 2^( 3) =       0.000436210209
  error estimate for blocks of size 2^( 4) =       0.000448409186
  error estimate for blocks of size 2^( 5) =       0.000459915943
  error estimate for blocks of size 2^( 6) =       0.000469534611
  error estimate for blocks of size 2^( 7) =       0.000474509299

      target function =                  N/A
              le_mean =     -16.909483699679
             les_mean =     286.269921038166
             stat err =       0.000463092260
             autocorr =       1.264165521544
              std dev =       0.582479371400
             le_variance =       0.339282218106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354541016
                                         uncertainty =       0.005246199546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354541016
                                         uncertainty =       0.005246199546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411875113
  error estimate for blocks of size 2^( 2) =       0.000424165286
  error estimate for blocks of size 2^( 3) =       0.000436210209
  error estimate for blocks of size 2^( 4) =       0.000448409186
  error estimate for blocks of size 2^( 5) =       0.000459915943
  error estimate for blocks of size 2^( 6) =       0.000469534611
  error estimate for blocks of size 2^( 7) =       0.000474509299

      target function =                  N/A
              le_mean =     -16.909483699679
             les_mean =     286.269921038050
             stat err =       0.000463092260
             autocorr =       1.264165521653
              std dev =       0.582479371301
             le_variance =       0.339282217992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354540916
                                         uncertainty =       0.005246199544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339354540916
                                         uncertainty =       0.005246199544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411875113
  error estimate for blocks of size 2^( 2) =       0.000424165286
  error estimate for blocks of size 2^( 3) =       0.000436210208
  error estimate for blocks of size 2^( 4) =       0.000448409186
  error estimate for blocks of size 2^( 5) =       0.000459915943
  error estimate for blocks of size 2^( 6) =       0.000469534611
  error estimate for blocks of size 2^( 7) =       0.000474509299

      target function =                  N/A
              le_mean =     -16.909483699679
             les_mean =     286.269921037949
             stat err =       0.000463092260
             autocorr =       1.264165521742
              std dev =       0.582479371216
             le_variance =       0.339282217892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909483699679        initial
     9.3132e+05     9.3132e+06             2.2742e-10       -16.909483699679  <--
     3.7253e+06     3.7253e+07             5.6854e-11       -16.909483699679
     1.4901e+07     1.4901e+08             1.4214e-11       -16.909483699679

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 3.5158e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.448233
====================================================
  Execution time = 2.3068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3910e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068381433
                                         uncertainty =       0.007485263076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068381433
                                         uncertainty =       0.007485263076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411762333
  error estimate for blocks of size 2^( 2) =       0.000423897524
  error estimate for blocks of size 2^( 3) =       0.000436389251
  error estimate for blocks of size 2^( 4) =       0.000447944667
  error estimate for blocks of size 2^( 5) =       0.000458034811
  error estimate for blocks of size 2^( 6) =       0.000463993381
  error estimate for blocks of size 2^( 7) =       0.000468633902

      target function =                  N/A
              le_mean =     -16.909646123036
             les_mean =     286.275228274204
             stat err =       0.000459651690
             autocorr =       1.246133269559
              std dev =       0.582319875536
             le_variance =       0.339096437444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690964612304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646123036       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909646123038       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909646123035       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909646123153       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909646123137       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909646123048       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909646122960       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909646123068       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.455394e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646123036       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909646123037       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909646123036       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909646122781       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909646122818       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909646123193       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909646123238       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909646123979       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.363850e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646123036       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909646123036       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909646123036       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909646123036       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909646123036       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909646122899       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909646123036       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909646122730       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.909620e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9180e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.397172
====================================================
  Execution time = 2.2810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4045e-01
  Total weights = 2.0000e+06
  Execution time = 2.4381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493840729
                                         uncertainty =       0.004719549766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493840729
                                         uncertainty =       0.004719549766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412583770
  error estimate for blocks of size 2^( 2) =       0.000424980830
  error estimate for blocks of size 2^( 3) =       0.000438404228
  error estimate for blocks of size 2^( 4) =       0.000452195113
  error estimate for blocks of size 2^( 5) =       0.000463678314
  error estimate for blocks of size 2^( 6) =       0.000472511163
  error estimate for blocks of size 2^( 7) =       0.000476728337

      target function =                  N/A
              le_mean =     -16.909348099066
             les_mean =     286.266503699138
             stat err =       0.000466278232
             autocorr =       1.277220858497
              std dev =       0.583481562669
             le_variance =       0.340450733975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493841334
                                         uncertainty =       0.004719549769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493841334
                                         uncertainty =       0.004719549769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412583770
  error estimate for blocks of size 2^( 2) =       0.000424980830
  error estimate for blocks of size 2^( 3) =       0.000438404228
  error estimate for blocks of size 2^( 4) =       0.000452195113
  error estimate for blocks of size 2^( 5) =       0.000463678315
  error estimate for blocks of size 2^( 6) =       0.000472511163
  error estimate for blocks of size 2^( 7) =       0.000476728337

      target function =                  N/A
              le_mean =     -16.909348099065
             les_mean =     286.266503699691
             stat err =       0.000466278232
             autocorr =       1.277220858022
              std dev =       0.583481563188
             le_variance =       0.340450734580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493841031
                                         uncertainty =       0.004719549767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493841031
                                         uncertainty =       0.004719549767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412583770
  error estimate for blocks of size 2^( 2) =       0.000424980830
  error estimate for blocks of size 2^( 3) =       0.000438404228
  error estimate for blocks of size 2^( 4) =       0.000452195113
  error estimate for blocks of size 2^( 5) =       0.000463678315
  error estimate for blocks of size 2^( 6) =       0.000472511163
  error estimate for blocks of size 2^( 7) =       0.000476728337

      target function =                  N/A
              le_mean =     -16.909348099065
             les_mean =     286.266503699414
             stat err =       0.000466278232
             autocorr =       1.277220858254
              std dev =       0.583481562929
             le_variance =       0.340450734278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493840767
                                         uncertainty =       0.004719549766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340493840767
                                         uncertainty =       0.004719549766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412583770
  error estimate for blocks of size 2^( 2) =       0.000424980830
  error estimate for blocks of size 2^( 3) =       0.000438404228
  error estimate for blocks of size 2^( 4) =       0.000452195113
  error estimate for blocks of size 2^( 5) =       0.000463678314
  error estimate for blocks of size 2^( 6) =       0.000472511163
  error estimate for blocks of size 2^( 7) =       0.000476728337

      target function =                  N/A
              le_mean =     -16.909348099066
             les_mean =     286.266503699172
             stat err =       0.000466278232
             autocorr =       1.277220858476
              std dev =       0.583481562702
             le_variance =       0.340450734013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909348099066        initial  <--
     2.3283e+05     2.3283e+06             9.4554e-10       -16.909348099065
     9.3132e+05     9.3132e+06             2.3638e-10       -16.909348099065
     3.7253e+06     3.7253e+07             5.9096e-11       -16.909348099066

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0862
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800190e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 0.6566
====================================================
  Execution time = 2.3364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3499e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335053762720
                                         uncertainty =       0.003381872157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335053762720
                                         uncertainty =       0.003381872157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409260435
  error estimate for blocks of size 2^( 2) =       0.000421922275
  error estimate for blocks of size 2^( 3) =       0.000434575785
  error estimate for blocks of size 2^( 4) =       0.000447078052
  error estimate for blocks of size 2^( 5) =       0.000457260904
  error estimate for blocks of size 2^( 6) =       0.000465227904
  error estimate for blocks of size 2^( 7) =       0.000471435230

      target function =                  N/A
              le_mean =     -16.908934041639
             les_mean =     286.247038463556
             stat err =       0.000460250522
             autocorr =       1.264704483390
              std dev =       0.578781657048
             le_variance =       0.334988206536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690893404164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908934041639       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908934041639       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908934041639       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908934042089       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908934040195       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908934042594       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908934042552       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908934042713       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.188790e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908934041639       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908934041639       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908934041639       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908934041634       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908934040570       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908934020005       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908934041734       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908934043611       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.971878e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908934041639       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908934041639       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908934041639       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908934045102       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908934040371       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908934051838       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908934113141       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908933890973       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 7.431673e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9563e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109924e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.173113
====================================================
  Execution time = 2.2827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4252e-01
  Total weights = 2.0000e+06
  Execution time = 2.4299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225692
                                         uncertainty =       0.009703553956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225692
                                         uncertainty =       0.009703553956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413835634
  error estimate for blocks of size 2^( 2) =       0.000426005974
  error estimate for blocks of size 2^( 3) =       0.000439367282
  error estimate for blocks of size 2^( 4) =       0.000451648382
  error estimate for blocks of size 2^( 5) =       0.000463444577
  error estimate for blocks of size 2^( 6) =       0.000469308033
  error estimate for blocks of size 2^( 7) =       0.000477138867

      target function =                  N/A
              le_mean =     -16.908840091384
             les_mean =     286.251392928551
             stat err =       0.000465384965
             autocorr =       1.264645868838
              std dev =       0.585251966079
             le_variance =       0.342519863800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225714
                                         uncertainty =       0.009703553958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225714
                                         uncertainty =       0.009703553958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413835634
  error estimate for blocks of size 2^( 2) =       0.000426005974
  error estimate for blocks of size 2^( 3) =       0.000439367282
  error estimate for blocks of size 2^( 4) =       0.000451648382
  error estimate for blocks of size 2^( 5) =       0.000463444577
  error estimate for blocks of size 2^( 6) =       0.000469308033
  error estimate for blocks of size 2^( 7) =       0.000477138867

      target function =                  N/A
              le_mean =     -16.908840091385
             les_mean =     286.251392928579
             stat err =       0.000465384965
             autocorr =       1.264645868807
              std dev =       0.585251966098
             le_variance =       0.342519863822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225703
                                         uncertainty =       0.009703553957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225703
                                         uncertainty =       0.009703553957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413835634
  error estimate for blocks of size 2^( 2) =       0.000426005974
  error estimate for blocks of size 2^( 3) =       0.000439367282
  error estimate for blocks of size 2^( 4) =       0.000451648382
  error estimate for blocks of size 2^( 5) =       0.000463444577
  error estimate for blocks of size 2^( 6) =       0.000469308033
  error estimate for blocks of size 2^( 7) =       0.000477138867

      target function =                  N/A
              le_mean =     -16.908840091385
             les_mean =     286.251392928565
             stat err =       0.000465384965
             autocorr =       1.264645868826
              std dev =       0.585251966089
             le_variance =       0.342519863811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225694
                                         uncertainty =       0.009703553956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640225694
                                         uncertainty =       0.009703553956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413835634
  error estimate for blocks of size 2^( 2) =       0.000426005974
  error estimate for blocks of size 2^( 3) =       0.000439367282
  error estimate for blocks of size 2^( 4) =       0.000451648382
  error estimate for blocks of size 2^( 5) =       0.000463444577
  error estimate for blocks of size 2^( 6) =       0.000469308033
  error estimate for blocks of size 2^( 7) =       0.000477138867

      target function =                  N/A
              le_mean =     -16.908840091384
             les_mean =     286.251392928553
             stat err =       0.000465384965
             autocorr =       1.264645868842
              std dev =       0.585251966081
             le_variance =       0.342519863801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908840091384        initial
     2.3283e+06     2.3283e+07             1.1888e-10       -16.908840091385  <--
     9.3132e+06     9.3132e+07             2.9719e-11       -16.908840091385
     3.7253e+07     3.7253e+08             7.4317e-12       -16.908840091384

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 3.5061e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.384451
====================================================
  Execution time = 2.2987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2944e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329447307733
                                         uncertainty =       0.003158581320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329447307733
                                         uncertainty =       0.003158581320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405859199
  error estimate for blocks of size 2^( 2) =       0.000417956758
  error estimate for blocks of size 2^( 3) =       0.000431064325
  error estimate for blocks of size 2^( 4) =       0.000442372275
  error estimate for blocks of size 2^( 5) =       0.000452941577
  error estimate for blocks of size 2^( 6) =       0.000461254774
  error estimate for blocks of size 2^( 7) =       0.000465688782

      target function =                  N/A
              le_mean =     -16.909682578153
             les_mean =     286.266808107768
             stat err =       0.000455564352
             autocorr =       1.259936560972
              std dev =       0.573971583438
             le_variance =       0.329443378594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690968257815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909682578153       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909682578153       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909682578152       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909682578151       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909682577914       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909682578254       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909682578097       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909682578310       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.528131e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909682578153       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909682578153       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909682578153       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909682578153       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909682578153       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909682578153       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909682578284       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909682579859       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.132033e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909682578153       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909682578153       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909682578153       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909682578160       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909682581982       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909682578631       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909682597708       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909682538364       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.830159e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9149e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.205545
====================================================
  Execution time = 2.2747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4696e-01
  Total weights = 2.0000e+06
  Execution time = 2.4422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985642989
                                         uncertainty =       0.009168012268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985642989
                                         uncertainty =       0.009168012268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510218
  error estimate for blocks of size 2^( 2) =       0.000428393884
  error estimate for blocks of size 2^( 3) =       0.000440453127
  error estimate for blocks of size 2^( 4) =       0.000452134887
  error estimate for blocks of size 2^( 5) =       0.000462899725
  error estimate for blocks of size 2^( 6) =       0.000473087828
  error estimate for blocks of size 2^( 7) =       0.000478545151

      target function =                  N/A
              le_mean =     -16.909272063158
             les_mean =     286.270443056212
             stat err =       0.000466666897
             autocorr =       1.255343767441
              std dev =       0.589034399498
             le_variance =       0.346961523792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643174
                                         uncertainty =       0.009168012273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643174
                                         uncertainty =       0.009168012273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510218
  error estimate for blocks of size 2^( 2) =       0.000428393884
  error estimate for blocks of size 2^( 3) =       0.000440453127
  error estimate for blocks of size 2^( 4) =       0.000452134887
  error estimate for blocks of size 2^( 5) =       0.000462899725
  error estimate for blocks of size 2^( 6) =       0.000473087828
  error estimate for blocks of size 2^( 7) =       0.000478545151

      target function =                  N/A
              le_mean =     -16.909272063158
             les_mean =     286.270443056397
             stat err =       0.000466666898
             autocorr =       1.255343767244
              std dev =       0.589034399654
             le_variance =       0.346961523976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643082
                                         uncertainty =       0.009168012271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643082
                                         uncertainty =       0.009168012271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510218
  error estimate for blocks of size 2^( 2) =       0.000428393884
  error estimate for blocks of size 2^( 3) =       0.000440453127
  error estimate for blocks of size 2^( 4) =       0.000452134887
  error estimate for blocks of size 2^( 5) =       0.000462899725
  error estimate for blocks of size 2^( 6) =       0.000473087828
  error estimate for blocks of size 2^( 7) =       0.000478545151

      target function =                  N/A
              le_mean =     -16.909272063158
             les_mean =     286.270443056305
             stat err =       0.000466666898
             autocorr =       1.255343767343
              std dev =       0.589034399576
             le_variance =       0.346961523884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643001
                                         uncertainty =       0.009168012269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346985643001
                                         uncertainty =       0.009168012269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510218
  error estimate for blocks of size 2^( 2) =       0.000428393884
  error estimate for blocks of size 2^( 3) =       0.000440453127
  error estimate for blocks of size 2^( 4) =       0.000452134887
  error estimate for blocks of size 2^( 5) =       0.000462899725
  error estimate for blocks of size 2^( 6) =       0.000473087828
  error estimate for blocks of size 2^( 7) =       0.000478545151

      target function =                  N/A
              le_mean =     -16.909272063158
             les_mean =     286.270443056223
             stat err =       0.000466666897
             autocorr =       1.255343767426
              std dev =       0.589034399507
             le_variance =       0.346961523803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909272063158        initial
     5.8208e+05     5.8208e+06             4.5281e-10       -16.909272063158  <--
     2.3283e+06     2.3283e+07             1.1320e-10       -16.909272063158
     9.3132e+06     9.3132e+07             2.8302e-11       -16.909272063158

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 3.5064e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9703
    reference variance = 0.402231
====================================================
  Execution time = 2.5010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3559e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335639961097
                                         uncertainty =       0.003500704603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335639961097
                                         uncertainty =       0.003500704603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409630172
  error estimate for blocks of size 2^( 2) =       0.000421716597
  error estimate for blocks of size 2^( 3) =       0.000434927606
  error estimate for blocks of size 2^( 4) =       0.000446216647
  error estimate for blocks of size 2^( 5) =       0.000457319075
  error estimate for blocks of size 2^( 6) =       0.000465817107
  error estimate for blocks of size 2^( 7) =       0.000471001164

      target function =                  N/A
              le_mean =     -16.909416187170
             les_mean =     286.263949379041
             stat err =       0.000460088498
             autocorr =       1.261533759045
              std dev =       0.579304545048
             le_variance =       0.335593755913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690941618717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909416187170       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909416187173       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909416187181       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909416187183       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909416187207       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909416187108       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909416187024       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909416187177       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.837953e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909416187170       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909416187171       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909416187173       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909416187186       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909416186904       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909416187185       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909416187465       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909416187138       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.594886e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909416187170       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909416187170       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909416187171       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909416189486       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909416188692       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909416187145       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909416187108       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909416188832       residual = 8.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.148721e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1078e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9556
    reference variance = 0.223787
====================================================
  Execution time = 2.2711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2944e-01
  Total weights = 2.0000e+06
  Execution time = 2.4507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465405
                                         uncertainty =       0.002795586477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465405
                                         uncertainty =       0.002795586477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405857078
  error estimate for blocks of size 2^( 2) =       0.000418364196
  error estimate for blocks of size 2^( 3) =       0.000431191070
  error estimate for blocks of size 2^( 4) =       0.000443080619
  error estimate for blocks of size 2^( 5) =       0.000453895951
  error estimate for blocks of size 2^( 6) =       0.000460794935
  error estimate for blocks of size 2^( 7) =       0.000462897552

      target function =                  N/A
              le_mean =     -16.909355489523
             les_mean =     286.255742841143
             stat err =       0.000455167264
             autocorr =       1.257754245621
              std dev =       0.573968583470
             le_variance =       0.329439934810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505466448
                                         uncertainty =       0.002795586487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505466448
                                         uncertainty =       0.002795586487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405857078
  error estimate for blocks of size 2^( 2) =       0.000418364197
  error estimate for blocks of size 2^( 3) =       0.000431191071
  error estimate for blocks of size 2^( 4) =       0.000443080620
  error estimate for blocks of size 2^( 5) =       0.000453895951
  error estimate for blocks of size 2^( 6) =       0.000460794935
  error estimate for blocks of size 2^( 7) =       0.000462897553

      target function =                  N/A
              le_mean =     -16.909355489522
             les_mean =     286.255742842161
             stat err =       0.000455167265
             autocorr =       1.257754244650
              std dev =       0.573968584378
             le_variance =       0.329439935853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465927
                                         uncertainty =       0.002795586482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465927
                                         uncertainty =       0.002795586482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405857078
  error estimate for blocks of size 2^( 2) =       0.000418364196
  error estimate for blocks of size 2^( 3) =       0.000431191071
  error estimate for blocks of size 2^( 4) =       0.000443080619
  error estimate for blocks of size 2^( 5) =       0.000453895951
  error estimate for blocks of size 2^( 6) =       0.000460794935
  error estimate for blocks of size 2^( 7) =       0.000462897552

      target function =                  N/A
              le_mean =     -16.909355489522
             les_mean =     286.255742841652
             stat err =       0.000455167264
             autocorr =       1.257754245138
              std dev =       0.573968583924
             le_variance =       0.329439935332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465470
                                         uncertainty =       0.002795586477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505465470
                                         uncertainty =       0.002795586477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405857078
  error estimate for blocks of size 2^( 2) =       0.000418364196
  error estimate for blocks of size 2^( 3) =       0.000431191070
  error estimate for blocks of size 2^( 4) =       0.000443080619
  error estimate for blocks of size 2^( 5) =       0.000453895951
  error estimate for blocks of size 2^( 6) =       0.000460794935
  error estimate for blocks of size 2^( 7) =       0.000462897552

      target function =                  N/A
              le_mean =     -16.909355489523
             les_mean =     286.255742841207
             stat err =       0.000455167264
             autocorr =       1.257754245566
              std dev =       0.573968583527
             le_variance =       0.329439934875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909355489523        initial  <--
     1.4552e+05     1.4552e+06             1.8380e-09       -16.909355489522
     5.8208e+05     5.8208e+06             4.5949e-10       -16.909355489522
     2.3283e+06     2.3283e+07             1.1487e-10       -16.909355489523

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0153
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6099e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9941
    reference variance = 0.547982
====================================================
  Execution time = 2.2993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335222718968
                                         uncertainty =       0.004897296219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335222718968
                                         uncertainty =       0.004897296219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409397127
  error estimate for blocks of size 2^( 2) =       0.000421416984
  error estimate for blocks of size 2^( 3) =       0.000433933414
  error estimate for blocks of size 2^( 4) =       0.000445924277
  error estimate for blocks of size 2^( 5) =       0.000456884874
  error estimate for blocks of size 2^( 6) =       0.000464962621
  error estimate for blocks of size 2^( 7) =       0.000473392840

      target function =                  N/A
              le_mean =     -16.908908474244
             les_mean =     286.246397638609
             stat err =       0.000460291153
             autocorr =       1.264083238996
              std dev =       0.578974969983
             le_variance =       0.335212015866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690890847424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908908474244       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908908474244       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908908474245       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908908474516       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908908474014       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908908474231       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908908473761       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908908475483       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.812861e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908908474244       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908908474244       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908908474244       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908908473950       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908908478673       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908908480319       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908908477312       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908908472863       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.532166e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908908474244       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908908474244       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908908474244       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908908474244       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908908474024       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908908473016       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908908448300       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908908498752       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.132986e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9123e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9537
    reference variance = 0.378461
====================================================
  Execution time = 2.2504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2966e-01
  Total weights = 2.0000e+06
  Execution time = 2.4471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134917
                                         uncertainty =       0.003725551942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134917
                                         uncertainty =       0.003725551942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405994787
  error estimate for blocks of size 2^( 2) =       0.000418352608
  error estimate for blocks of size 2^( 3) =       0.000430653057
  error estimate for blocks of size 2^( 4) =       0.000442610266
  error estimate for blocks of size 2^( 5) =       0.000453551115
  error estimate for blocks of size 2^( 6) =       0.000462936576
  error estimate for blocks of size 2^( 7) =       0.000469400109

      target function =                  N/A
              le_mean =     -16.909282442854
             les_mean =     286.253496101012
             stat err =       0.000457124517
             autocorr =       1.267733931606
              std dev =       0.574163333588
             le_variance =       0.329663533637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593135032
                                         uncertainty =       0.003725551944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593135032
                                         uncertainty =       0.003725551944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405994787
  error estimate for blocks of size 2^( 2) =       0.000418352608
  error estimate for blocks of size 2^( 3) =       0.000430653057
  error estimate for blocks of size 2^( 4) =       0.000442610266
  error estimate for blocks of size 2^( 5) =       0.000453551115
  error estimate for blocks of size 2^( 6) =       0.000462936577
  error estimate for blocks of size 2^( 7) =       0.000469400109

      target function =                  N/A
              le_mean =     -16.909282442854
             les_mean =     286.253496101138
             stat err =       0.000457124517
             autocorr =       1.267733931500
              std dev =       0.574163333688
             le_variance =       0.329663533752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134974
                                         uncertainty =       0.003725551943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134974
                                         uncertainty =       0.003725551943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405994787
  error estimate for blocks of size 2^( 2) =       0.000418352608
  error estimate for blocks of size 2^( 3) =       0.000430653057
  error estimate for blocks of size 2^( 4) =       0.000442610266
  error estimate for blocks of size 2^( 5) =       0.000453551115
  error estimate for blocks of size 2^( 6) =       0.000462936577
  error estimate for blocks of size 2^( 7) =       0.000469400109

      target function =                  N/A
              le_mean =     -16.909282442854
             les_mean =     286.253496101075
             stat err =       0.000457124517
             autocorr =       1.267733931552
              std dev =       0.574163333638
             le_variance =       0.329663533694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134924
                                         uncertainty =       0.003725551942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329593134924
                                         uncertainty =       0.003725551942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405994787
  error estimate for blocks of size 2^( 2) =       0.000418352608
  error estimate for blocks of size 2^( 3) =       0.000430653057
  error estimate for blocks of size 2^( 4) =       0.000442610266
  error estimate for blocks of size 2^( 5) =       0.000453551115
  error estimate for blocks of size 2^( 6) =       0.000462936577
  error estimate for blocks of size 2^( 7) =       0.000469400109

      target function =                  N/A
              le_mean =     -16.909282442854
             les_mean =     286.253496101019
             stat err =       0.000457124517
             autocorr =       1.267733931605
              std dev =       0.574163333594
             le_variance =       0.329663533644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909282442854        initial
     1.4552e+06     1.4552e+07             1.8129e-10       -16.909282442854  <--
     5.8208e+06     5.8208e+07             4.5322e-11       -16.909282442854
     2.3283e+07     2.3283e+08             1.1330e-11       -16.909282442854

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 3.4850e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8528
    reference variance = 0.167661
====================================================
  Execution time = 2.2962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3041e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330325724085
                                         uncertainty =       0.005315477736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330325724085
                                         uncertainty =       0.005315477736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406455139
  error estimate for blocks of size 2^( 2) =       0.000418837645
  error estimate for blocks of size 2^( 3) =       0.000431054224
  error estimate for blocks of size 2^( 4) =       0.000443110826
  error estimate for blocks of size 2^( 5) =       0.000453236346
  error estimate for blocks of size 2^( 6) =       0.000459501420
  error estimate for blocks of size 2^( 7) =       0.000464107830

      target function =                  N/A
              le_mean =     -16.909731777654
             les_mean =     286.269440187763
             stat err =       0.000454989106
             autocorr =       1.253074109480
              std dev =       0.574814370706
             le_variance =       0.330411560770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690973177765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909731777654       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909731777656       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909731777656       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909731777657       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909731777667       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909731777802       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909731777816       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909731777662       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.769362e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909731777654       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909731777654       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909731777654       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909731777586       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909731776907       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909731778157       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909731777411       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909731777454       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.942339e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909731777654       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909731777654       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909731777654       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909731777654       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909731780899       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909731778687       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909731772364       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909731777974       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.855831e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9112e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227865e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684375e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9166
    reference variance = 0.299555
====================================================
  Execution time = 2.2427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3626e-01
  Total weights = 2.0000e+06
  Execution time = 2.4336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286501
                                         uncertainty =       0.005036171859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286501
                                         uncertainty =       0.005036171859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410034516
  error estimate for blocks of size 2^( 2) =       0.000421577283
  error estimate for blocks of size 2^( 3) =       0.000433547936
  error estimate for blocks of size 2^( 4) =       0.000445246489
  error estimate for blocks of size 2^( 5) =       0.000455156585
  error estimate for blocks of size 2^( 6) =       0.000462497352
  error estimate for blocks of size 2^( 7) =       0.000468166688

      target function =                  N/A
              le_mean =     -16.909449535455
             les_mean =     286.265740033007
             stat err =       0.000457766778
             autocorr =       1.246372072776
              std dev =       0.579876373910
             le_variance =       0.336256609019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079287113
                                         uncertainty =       0.005036171871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079287113
                                         uncertainty =       0.005036171871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410034517
  error estimate for blocks of size 2^( 2) =       0.000421577284
  error estimate for blocks of size 2^( 3) =       0.000433547937
  error estimate for blocks of size 2^( 4) =       0.000445246490
  error estimate for blocks of size 2^( 5) =       0.000455156585
  error estimate for blocks of size 2^( 6) =       0.000462497352
  error estimate for blocks of size 2^( 7) =       0.000468166688

      target function =                  N/A
              le_mean =     -16.909449535463
             les_mean =     286.265740033875
             stat err =       0.000457766779
             autocorr =       1.246372072270
              std dev =       0.579876374438
             le_variance =       0.336256609631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286807
                                         uncertainty =       0.005036171865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286807
                                         uncertainty =       0.005036171865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410034516
  error estimate for blocks of size 2^( 2) =       0.000421577283
  error estimate for blocks of size 2^( 3) =       0.000433547937
  error estimate for blocks of size 2^( 4) =       0.000445246490
  error estimate for blocks of size 2^( 5) =       0.000455156585
  error estimate for blocks of size 2^( 6) =       0.000462497352
  error estimate for blocks of size 2^( 7) =       0.000468166688

      target function =                  N/A
              le_mean =     -16.909449535459
             les_mean =     286.265740033441
             stat err =       0.000457766779
             autocorr =       1.246372072516
              std dev =       0.579876374174
             le_variance =       0.336256609325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286539
                                         uncertainty =       0.005036171860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336079286539
                                         uncertainty =       0.005036171860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410034516
  error estimate for blocks of size 2^( 2) =       0.000421577283
  error estimate for blocks of size 2^( 3) =       0.000433547936
  error estimate for blocks of size 2^( 4) =       0.000445246489
  error estimate for blocks of size 2^( 5) =       0.000455156585
  error estimate for blocks of size 2^( 6) =       0.000462497352
  error estimate for blocks of size 2^( 7) =       0.000468166688

      target function =                  N/A
              le_mean =     -16.909449535456
             les_mean =     286.265740033061
             stat err =       0.000457766778
             autocorr =       1.246372072737
              std dev =       0.579876373943
             le_variance =       0.336256609057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909449535455        initial
     3.6380e+05     3.6380e+06             7.7694e-10       -16.909449535463  <--
     1.4552e+06     1.4552e+07             1.9423e-10       -16.909449535459
     5.8208e+06     5.8208e+07             4.8558e-11       -16.909449535456

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 3.4697e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449362e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332840e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9288
    reference variance = 0.29271
====================================================
  Execution time = 2.2912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4078e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340736453663
                                         uncertainty =       0.006583179367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340736453663
                                         uncertainty =       0.006583179367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412781981
  error estimate for blocks of size 2^( 2) =       0.000424628970
  error estimate for blocks of size 2^( 3) =       0.000437637205
  error estimate for blocks of size 2^( 4) =       0.000450759828
  error estimate for blocks of size 2^( 5) =       0.000460935057
  error estimate for blocks of size 2^( 6) =       0.000469376567
  error estimate for blocks of size 2^( 7) =       0.000475863085

      target function =                  N/A
              le_mean =     -16.909342368403
             les_mean =     286.266637088971
             stat err =       0.000464233634
             autocorr =       1.264828792569
              std dev =       0.583761875678
             le_variance =       0.340777927495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690934236840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909342368403       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909342368408       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909342368413       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909342368427       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909342368438       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909342368426       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909342368363       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909342368383       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.464110e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909342368403       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909342368404       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909342368406       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909342368408       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909342368339       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909342368361       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909342368246       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909342368127       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.160275e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909342368403       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909342368403       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909342368404       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909342367984       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909342368640       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909342368141       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909342368343       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909342369087       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.540069e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9059e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449363e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302100e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320913e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332839e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8348
    reference variance = 0.28518
====================================================
  Execution time = 2.2712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.0000e+06
  Execution time = 2.4348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433564800
                                         uncertainty =       0.003438848650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433564800
                                         uncertainty =       0.003438848650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475123
  error estimate for blocks of size 2^( 2) =       0.000421452811
  error estimate for blocks of size 2^( 3) =       0.000434386950
  error estimate for blocks of size 2^( 4) =       0.000445780208
  error estimate for blocks of size 2^( 5) =       0.000455912960
  error estimate for blocks of size 2^( 6) =       0.000465231298
  error estimate for blocks of size 2^( 7) =       0.000470596694

      target function =                  N/A
              le_mean =     -16.910201320502
             les_mean =     286.290248284906
             stat err =       0.000459380290
             autocorr =       1.258605631921
              std dev =       0.579085272362
             le_variance =       0.335339752666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433566527
                                         uncertainty =       0.003438848675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433566527
                                         uncertainty =       0.003438848675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475124
  error estimate for blocks of size 2^( 2) =       0.000421452812
  error estimate for blocks of size 2^( 3) =       0.000434386951
  error estimate for blocks of size 2^( 4) =       0.000445780209
  error estimate for blocks of size 2^( 5) =       0.000455912961
  error estimate for blocks of size 2^( 6) =       0.000465231298
  error estimate for blocks of size 2^( 7) =       0.000470596694

      target function =                  N/A
              le_mean =     -16.910201320502
             les_mean =     286.290248286645
             stat err =       0.000459380291
             autocorr =       1.258605630133
              std dev =       0.579085273852
             le_variance =       0.335339754392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433565664
                                         uncertainty =       0.003438848663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433565664
                                         uncertainty =       0.003438848663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475123
  error estimate for blocks of size 2^( 2) =       0.000421452811
  error estimate for blocks of size 2^( 3) =       0.000434386951
  error estimate for blocks of size 2^( 4) =       0.000445780209
  error estimate for blocks of size 2^( 5) =       0.000455912960
  error estimate for blocks of size 2^( 6) =       0.000465231298
  error estimate for blocks of size 2^( 7) =       0.000470596694

      target function =                  N/A
              le_mean =     -16.910201320502
             les_mean =     286.290248285775
             stat err =       0.000459380290
             autocorr =       1.258605631027
              std dev =       0.579085273107
             le_variance =       0.335339753529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433564908
                                         uncertainty =       0.003438848652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335433564908
                                         uncertainty =       0.003438848652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475123
  error estimate for blocks of size 2^( 2) =       0.000421452811
  error estimate for blocks of size 2^( 3) =       0.000434386950
  error estimate for blocks of size 2^( 4) =       0.000445780208
  error estimate for blocks of size 2^( 5) =       0.000455912960
  error estimate for blocks of size 2^( 6) =       0.000465231298
  error estimate for blocks of size 2^( 7) =       0.000470596694

      target function =                  N/A
              le_mean =     -16.910201320502
             les_mean =     286.290248285014
             stat err =       0.000459380290
             autocorr =       1.258605631810
              std dev =       0.579085272455
             le_variance =       0.335339752774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910201320502        initial
     9.0949e+04     9.0949e+05             2.4641e-09       -16.910201320502  <--
     3.6380e+05     3.6380e+06             6.1603e-10       -16.910201320502
     1.4552e+06     1.4552e+07             1.5401e-10       -16.910201320502

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 3.4997e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332839e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9746
    reference variance = 0.860154
====================================================
  Execution time = 2.2960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2882e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328535469217
                                         uncertainty =       0.002869963580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328535469217
                                         uncertainty =       0.002869963580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405476885
  error estimate for blocks of size 2^( 2) =       0.000417801432
  error estimate for blocks of size 2^( 3) =       0.000430479284
  error estimate for blocks of size 2^( 4) =       0.000442466171
  error estimate for blocks of size 2^( 5) =       0.000454292185
  error estimate for blocks of size 2^( 6) =       0.000462235970
  error estimate for blocks of size 2^( 7) =       0.000468761025

      target function =                  N/A
              le_mean =     -16.908505070473
             les_mean =     286.226366562300
             stat err =       0.000456938838
             autocorr =       1.269942163135
              std dev =       0.573430909968
             le_variance =       0.328823008506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690850507047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908505070473       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908505070501       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908505070457       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908505070498       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908505070537       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908505070530       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908505070509       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908505070518       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.113547e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908505070473       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908505070480       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908505070469       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908505070481       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908505070494       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908505070435       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908505070543       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908505070494       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.783869e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908505070473       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908505070475       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908505070472       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908505070473       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908505070692       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908505070128       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908505070358       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908505070112       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.959670e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9086e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302088e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590891e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382336e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332838e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.280798
====================================================
  Execution time = 2.2449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3571e-01
  Total weights = 2.0000e+06
  Execution time = 2.4266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700326522
                                         uncertainty =       0.004663199477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700326522
                                         uncertainty =       0.004663199477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409702378
  error estimate for blocks of size 2^( 2) =       0.000421825709
  error estimate for blocks of size 2^( 3) =       0.000434140122
  error estimate for blocks of size 2^( 4) =       0.000445939642
  error estimate for blocks of size 2^( 5) =       0.000455800100
  error estimate for blocks of size 2^( 6) =       0.000463641213
  error estimate for blocks of size 2^( 7) =       0.000467535162

      target function =                  N/A
              le_mean =     -16.908861089070
             les_mean =     286.245295238120
             stat err =       0.000458229029
             autocorr =       1.250916233915
              std dev =       0.579406659014
             le_variance =       0.335712076510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700330405
                                         uncertainty =       0.004663199460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700330405
                                         uncertainty =       0.004663199460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409702380
  error estimate for blocks of size 2^( 2) =       0.000421825712
  error estimate for blocks of size 2^( 3) =       0.000434140124
  error estimate for blocks of size 2^( 4) =       0.000445939644
  error estimate for blocks of size 2^( 5) =       0.000455800102
  error estimate for blocks of size 2^( 6) =       0.000463641215
  error estimate for blocks of size 2^( 7) =       0.000467535163

      target function =                  N/A
              le_mean =     -16.908861089047
             les_mean =     286.245295241243
             stat err =       0.000458229031
             autocorr =       1.250916230161
              std dev =       0.579406662366
             le_variance =       0.335712080394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700328464
                                         uncertainty =       0.004663199469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700328464
                                         uncertainty =       0.004663199469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409702379
  error estimate for blocks of size 2^( 2) =       0.000421825711
  error estimate for blocks of size 2^( 3) =       0.000434140123
  error estimate for blocks of size 2^( 4) =       0.000445939643
  error estimate for blocks of size 2^( 5) =       0.000455800101
  error estimate for blocks of size 2^( 6) =       0.000463641214
  error estimate for blocks of size 2^( 7) =       0.000467535162

      target function =                  N/A
              le_mean =     -16.908861089059
             les_mean =     286.245295239681
             stat err =       0.000458229030
             autocorr =       1.250916232035
              std dev =       0.579406660690
             le_variance =       0.335712078452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700326765
                                         uncertainty =       0.004663199476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335700326765
                                         uncertainty =       0.004663199476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409702378
  error estimate for blocks of size 2^( 2) =       0.000421825710
  error estimate for blocks of size 2^( 3) =       0.000434140122
  error estimate for blocks of size 2^( 4) =       0.000445939642
  error estimate for blocks of size 2^( 5) =       0.000455800101
  error estimate for blocks of size 2^( 6) =       0.000463641213
  error estimate for blocks of size 2^( 7) =       0.000467535162

      target function =                  N/A
              le_mean =     -16.908861089069
             les_mean =     286.245295238315
             stat err =       0.000458229029
             autocorr =       1.250916233687
              std dev =       0.579406659224
             le_variance =       0.335712076753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908861089070        initial  <--
     2.2737e+04     2.2737e+05             1.1135e-08       -16.908861089047
     9.0949e+04     9.0949e+05             2.7839e-09       -16.908861089059
     3.6380e+05     3.6380e+06             6.9597e-10       -16.908861089069

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6656
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703375e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332839e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.527624
====================================================
  Execution time = 2.2881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3559e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335719007241
                                         uncertainty =       0.005175392359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335719007241
                                         uncertainty =       0.005175392359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409629840
  error estimate for blocks of size 2^( 2) =       0.000421471632
  error estimate for blocks of size 2^( 3) =       0.000434368266
  error estimate for blocks of size 2^( 4) =       0.000446651285
  error estimate for blocks of size 2^( 5) =       0.000457034059
  error estimate for blocks of size 2^( 6) =       0.000466088527
  error estimate for blocks of size 2^( 7) =       0.000472256905

      target function =                  N/A
              le_mean =     -16.909399796999
             les_mean =     286.263394538313
             stat err =       0.000460507694
             autocorr =       1.263835673676
              std dev =       0.579304075028
             le_variance =       0.335593211344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690939979700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399796999       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399797002       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399797005       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399797014       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399797008       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399797007       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399797215       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399797228       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.374199e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399796999       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399797000       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399797001       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399796600       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399796972       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399796436       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399796823       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399797377       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 3.435491e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399796999       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399797000       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399797000       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399797000       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399794285       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399797463       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399795075       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399796448       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 8.588703e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9080e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302087e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332839e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9851
    reference variance = 0.440008
====================================================
  Execution time = 2.2642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3618e-01
  Total weights = 2.0000e+06
  Execution time = 2.4319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183799990
                                         uncertainty =       0.005143919876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183799990
                                         uncertainty =       0.005143919876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989216
  error estimate for blocks of size 2^( 2) =       0.000421854646
  error estimate for blocks of size 2^( 3) =       0.000434086637
  error estimate for blocks of size 2^( 4) =       0.000445455740
  error estimate for blocks of size 2^( 5) =       0.000456091918
  error estimate for blocks of size 2^( 6) =       0.000465004454
  error estimate for blocks of size 2^( 7) =       0.000470393847

      target function =                  N/A
              le_mean =     -16.908065266221
             les_mean =     286.218853192842
             stat err =       0.000459236490
             autocorr =       1.254665369777
              std dev =       0.579812309414
             le_variance =       0.336182314148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800177
                                         uncertainty =       0.005143919882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800177
                                         uncertainty =       0.005143919882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989216
  error estimate for blocks of size 2^( 2) =       0.000421854647
  error estimate for blocks of size 2^( 3) =       0.000434086637
  error estimate for blocks of size 2^( 4) =       0.000445455740
  error estimate for blocks of size 2^( 5) =       0.000456091918
  error estimate for blocks of size 2^( 6) =       0.000465004454
  error estimate for blocks of size 2^( 7) =       0.000470393848

      target function =                  N/A
              le_mean =     -16.908065266224
             les_mean =     286.218853193132
             stat err =       0.000459236490
             autocorr =       1.254665369648
              std dev =       0.579812309576
             le_variance =       0.336182314335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800084
                                         uncertainty =       0.005143919879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800084
                                         uncertainty =       0.005143919879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989216
  error estimate for blocks of size 2^( 2) =       0.000421854646
  error estimate for blocks of size 2^( 3) =       0.000434086637
  error estimate for blocks of size 2^( 4) =       0.000445455740
  error estimate for blocks of size 2^( 5) =       0.000456091918
  error estimate for blocks of size 2^( 6) =       0.000465004454
  error estimate for blocks of size 2^( 7) =       0.000470393847

      target function =                  N/A
              le_mean =     -16.908065266222
             les_mean =     286.218853192987
             stat err =       0.000459236490
             autocorr =       1.254665369718
              std dev =       0.579812309495
             le_variance =       0.336182314242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800002
                                         uncertainty =       0.005143919877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336183800002
                                         uncertainty =       0.005143919877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989216
  error estimate for blocks of size 2^( 2) =       0.000421854646
  error estimate for blocks of size 2^( 3) =       0.000434086637
  error estimate for blocks of size 2^( 4) =       0.000445455740
  error estimate for blocks of size 2^( 5) =       0.000456091918
  error estimate for blocks of size 2^( 6) =       0.000465004454
  error estimate for blocks of size 2^( 7) =       0.000470393847

      target function =                  N/A
              le_mean =     -16.908065266221
             les_mean =     286.218853192860
             stat err =       0.000459236490
             autocorr =       1.254665369761
              std dev =       0.579812309424
             le_variance =       0.336182314160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908065266221        initial
     2.2737e+05     2.2737e+06             1.3742e-09       -16.908065266224  <--
     9.0949e+05     9.0949e+06             3.4355e-10       -16.908065266222
     3.6380e+06     3.6380e+07             8.5887e-11       -16.908065266221

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 3.4913e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302088e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332838e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3999e+01 secs
  Total Execution time = 2.5996e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
