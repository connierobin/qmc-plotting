Rank =    0  Free Memory = 75392 MB
Rank =    1  Free Memory = 75389 MB
Rank =    2  Free Memory = 75389 MB
Rank =    3  Free Memory = 75389 MB
Rank =    4  Free Memory = 75389 MB
Rank =    5  Free Memory = 75389 MB
Rank =    6  Free Memory = 75389 MB
Rank =    7  Free Memory = 75389 MB
Rank =    8  Free Memory = 75389 MB
Rank =    9  Free Memory = 75389 MB
Rank =   10  Free Memory = 75389 MB
Rank =   11  Free Memory = 75389 MB
Rank =   12  Free Memory = 75389 MB
Rank =   13  Free Memory = 75389 MB
Rank =   14  Free Memory = 75389 MB
Rank =   15  Free Memory = 75380 MB
Rank =   16  Free Memory = 75380 MB
Rank =   17  Free Memory = 75380 MB
Rank =   18  Free Memory = 75380 MB
Rank =   19  Free Memory = 75380 MB
Rank =   20  Free Memory = 75380 MB
Rank =   21  Free Memory = 75380 MB
Rank =   22  Free Memory = 75380 MB
Rank =   23  Free Memory = 75380 MB
Rank =   24  Free Memory = 75380 MB
Rank =   25  Free Memory = 75380 MB
Rank =   26  Free Memory = 75380 MB
Rank =   27  Free Memory = 75380 MB
Rank =   28  Free Memory = 75380 MB
Rank =   29  Free Memory = 75380 MB
Rank =   30  Free Memory = 75380 MB
Rank =   31  Free Memory = 75380 MB
Rank =   32  Free Memory = 83081 MB
Rank =   33  Free Memory = 83080 MB
Rank =   34  Free Memory = 83080 MB
Rank =   35  Free Memory = 83080 MB
Rank =   36  Free Memory = 83080 MB
Rank =   37  Free Memory = 83080 MB
Rank =   38  Free Memory = 83080 MB
Rank =   39  Free Memory = 83080 MB
Rank =   40  Free Memory = 83080 MB
Rank =   41  Free Memory = 83080 MB
Rank =   42  Free Memory = 83080 MB
Rank =   43  Free Memory = 83080 MB
Rank =   44  Free Memory = 83080 MB
Rank =   45  Free Memory = 83080 MB
Rank =   46  Free Memory = 83080 MB
Rank =   47  Free Memory = 83080 MB
Rank =   48  Free Memory = 83080 MB
Rank =   49  Free Memory = 83080 MB
Rank =   50  Free Memory = 83080 MB
Rank =   51  Free Memory = 83080 MB
Rank =   52  Free Memory = 83080 MB
Rank =   53  Free Memory = 83080 MB
Rank =   54  Free Memory = 83080 MB
Rank =   55  Free Memory = 83080 MB
Rank =   56  Free Memory = 83080 MB
Rank =   57  Free Memory = 83080 MB
Rank =   58  Free Memory = 83080 MB
Rank =   59  Free Memory = 83080 MB
Rank =   60  Free Memory = 83080 MB
Rank =   61  Free Memory = 83080 MB
Rank =   62  Free Memory = 83080 MB
Rank =   63  Free Memory = 83080 MB
Rank =   64  Free Memory = 76906 MB
Rank =   65  Free Memory = 76906 MB
Rank =   66  Free Memory = 76906 MB
Rank =   67  Free Memory = 76906 MB
Rank =   68  Free Memory = 76906 MB
Rank =   69  Free Memory = 76906 MB
Rank =   70  Free Memory = 76906 MB
Rank =   71  Free Memory = 76906 MB
Rank =   72  Free Memory = 76906 MB
Rank =   73  Free Memory = 76906 MB
Rank =   74  Free Memory = 76906 MB
Rank =   75  Free Memory = 76906 MB
Rank =   76  Free Memory = 76906 MB
Rank =   77  Free Memory = 76906 MB
Rank =   78  Free Memory = 76906 MB
Rank =   79  Free Memory = 76906 MB
Rank =   80  Free Memory = 76906 MB
Rank =   81  Free Memory = 76906 MB
Rank =   82  Free Memory = 76906 MB
Rank =   83  Free Memory = 76906 MB
Rank =   84  Free Memory = 76906 MB
Rank =   85  Free Memory = 76906 MB
Rank =   86  Free Memory = 76906 MB
Rank =   87  Free Memory = 76906 MB
Rank =   88  Free Memory = 76906 MB
Rank =   89  Free Memory = 76906 MB
Rank =   90  Free Memory = 76906 MB
Rank =   91  Free Memory = 76906 MB
Rank =   92  Free Memory = 76906 MB
Rank =   93  Free Memory = 76906 MB
Rank =   94  Free Memory = 76906 MB
Rank =   95  Free Memory = 76906 MB
Rank =   96  Free Memory = 69755 MB
Rank =   97  Free Memory = 69755 MB
Rank =   98  Free Memory = 69755 MB
Rank =   99  Free Memory = 69755 MB
Rank =  100  Free Memory = 69755 MB
Rank =  101  Free Memory = 69755 MB
Rank =  102  Free Memory = 69755 MB
Rank =  103  Free Memory = 69755 MB
Rank =  104  Free Memory = 69755 MB
Rank =  105  Free Memory = 69755 MB
Rank =  106  Free Memory = 69755 MB
Rank =  107  Free Memory = 69755 MB
Rank =  108  Free Memory = 69755 MB
Rank =  109  Free Memory = 69755 MB
Rank =  110  Free Memory = 69755 MB
Rank =  111  Free Memory = 69755 MB
Rank =  112  Free Memory = 69755 MB
Rank =  113  Free Memory = 69755 MB
Rank =  114  Free Memory = 69755 MB
Rank =  115  Free Memory = 69755 MB
Rank =  116  Free Memory = 69755 MB
Rank =  117  Free Memory = 69754 MB
Rank =  118  Free Memory = 69754 MB
Rank =  119  Free Memory = 69754 MB
Rank =  120  Free Memory = 69754 MB
Rank =  121  Free Memory = 69754 MB
Rank =  122  Free Memory = 69754 MB
Rank =  123  Free Memory = 69754 MB
Rank =  124  Free Memory = 69754 MB
Rank =  125  Free Memory = 69754 MB
Rank =  126  Free Memory = 69754 MB
Rank =  127  Free Memory = 69754 MB
  Input file(s): opt_h2o_1b1_gvptt_277dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_277dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:33:39 PDT
  host    = n0014.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 627

  Range of prime numbers to use as seeds over processors and threads = 4651-5749


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 277 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.804590e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 70 unique up determinants.
Found 70 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8772e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.217272
====================================================
  Execution time = 2.5159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337338519266
                                         uncertainty =       0.011869167422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337338519266
                                         uncertainty =       0.011869167422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667506
  error estimate for blocks of size 2^( 2) =       0.000423359351
  error estimate for blocks of size 2^( 3) =       0.000435940060
  error estimate for blocks of size 2^( 4) =       0.000449077668
  error estimate for blocks of size 2^( 5) =       0.000460149866
  error estimate for blocks of size 2^( 6) =       0.000467588977
  error estimate for blocks of size 2^( 7) =       0.000472155392

      target function =                  N/A
              le_mean =     -16.909059965752
             les_mean =     286.253604358415
             stat err =       0.000462242976
             autocorr =       1.266951407950
              std dev =       0.580771557210
             le_variance =       0.337295601665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690905996575e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909059965752       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909273132485       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909322088611       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909340503599       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399755972       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909409380898       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909417929419       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909421101680       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909423168998       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909422606956       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909422935478       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909423155211       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909423126078       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.065160e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909059965752       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909144743510       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909173129324       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909178310424       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909198677892       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909200009964       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909202914157       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909203605335       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909203926115       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909203837033       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909203772768       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.692793e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909059965752       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909084833040       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909094795224       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909096202550       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909101570492       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909102025966       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909102541669       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909102659771       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909102763415       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909102762848       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909102753649       residual = 7.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.044245e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1638e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.026125e-01                 1 1 ON  0
uu_1  1.390906e-01                 1 1 ON  1
uu_2  4.169297e-02                 1 1 ON  2
uu_3  -1.912459e-02                1 1 ON  3
uu_4  -6.330430e-02                1 1 ON  4
uu_5  -9.592594e-02                1 1 ON  5
uu_6  -1.206200e-01                1 1 ON  6
uu_7  -1.309699e-01                1 1 ON  7
uu_8  -1.204288e-01                1 1 ON  8
uu_9  -9.279624e-02                1 1 ON  9
ud_0  4.124762e-01                 1 1 ON  10
ud_1  1.601759e-01                 1 1 ON  11
ud_2  5.981921e-02                 1 1 ON  12
ud_3  8.938003e-04                 1 1 ON  13
ud_4  -5.667786e-02                1 1 ON  14
ud_5  -1.011250e-01                1 1 ON  15
ud_6  -1.287747e-01                1 1 ON  16
ud_7  -1.439191e-01                1 1 ON  17
ud_8  -1.427152e-01                1 1 ON  18
ud_9  -1.344452e-01                1 1 ON  19
eO_0  -7.080028e-01                1 1 ON  20
eO_1  -4.143135e-01                1 1 ON  21
eO_2  -2.933453e-02                1 1 ON  22
eO_3  2.713488e-01                 1 1 ON  23
eO_4  4.918723e-01                 1 1 ON  24
eO_5  4.592189e-01                 1 1 ON  25
eO_6  2.360678e-01                 1 1 ON  26
eO_7  -5.586148e-02                1 1 ON  27
eO_8  -1.961057e-01                1 1 ON  28
eO_9  -5.780397e-02                1 1 ON  29
eH1_0 -2.117268e-01                1 1 ON  30
eH1_1 -1.272835e-01                1 1 ON  31
eH1_2 -8.802778e-02                1 1 ON  32
eH1_3 -3.733041e-02                1 1 ON  33
eH1_4 1.209995e-02                 1 1 ON  34
eH1_5 4.476774e-02                 1 1 ON  35
eH1_6 9.488406e-02                 1 1 ON  36
eH1_7 1.383123e-01                 1 1 ON  37
eH1_8 1.458560e-01                 1 1 ON  38
eH1_9 3.300726e-02                 1 1 ON  39
eH2_0 -2.105912e-01                1 1 ON  40
eH2_1 -1.264255e-01                1 1 ON  41
eH2_2 -8.698426e-02                1 1 ON  42
eH2_3 -3.625391e-02                1 1 ON  43
eH2_4 1.355895e-02                 1 1 ON  44
eH2_5 4.795260e-02                 1 1 ON  45
eH2_6 1.006068e-01                 1 1 ON  46
eH2_7 1.495259e-01                 1 1 ON  47
eH2_8 1.539523e-01                 1 1 ON  48
eH2_9 1.317424e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.205488
====================================================
  Execution time = 2.4040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2769e-01
  Total weights = 2.0000e+06
  Execution time = 2.7330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328543203831
                                         uncertainty =       0.003848006054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328543203831
                                         uncertainty =       0.003848006054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405310571
  error estimate for blocks of size 2^( 2) =       0.000418053523
  error estimate for blocks of size 2^( 3) =       0.000430879463
  error estimate for blocks of size 2^( 4) =       0.000443054504
  error estimate for blocks of size 2^( 5) =       0.000454301066
  error estimate for blocks of size 2^( 6) =       0.000462396703
  error estimate for blocks of size 2^( 7) =       0.000469928469

      target function =                  N/A
              le_mean =     -16.910278103115
             les_mean =     286.286058678165
             stat err =       0.000457420185
             autocorr =       1.273663753743
              std dev =       0.573195706324
             le_variance =       0.328553317748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327937864509
                                         uncertainty =       0.003879698436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327937864509
                                         uncertainty =       0.003879698436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404937969
  error estimate for blocks of size 2^( 2) =       0.000417348148
  error estimate for blocks of size 2^( 3) =       0.000429936854
  error estimate for blocks of size 2^( 4) =       0.000441979425
  error estimate for blocks of size 2^( 5) =       0.000453069639
  error estimate for blocks of size 2^( 6) =       0.000461134269
  error estimate for blocks of size 2^( 7) =       0.000468584955

      target function =                  N/A
              le_mean =     -16.910300579178
             les_mean =     286.286215031520
             stat err =       0.000456192072
             autocorr =       1.269166110142
              std dev =       0.572668767556
             le_variance =       0.327949517335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327207866754
                                         uncertainty =       0.003867594211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327207866754
                                         uncertainty =       0.003867594211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404487109
  error estimate for blocks of size 2^( 2) =       0.000416975091
  error estimate for blocks of size 2^( 3) =       0.000429628865
  error estimate for blocks of size 2^( 4) =       0.000441712324
  error estimate for blocks of size 2^( 5) =       0.000452837718
  error estimate for blocks of size 2^( 6) =       0.000460922197
  error estimate for blocks of size 2^( 7) =       0.000468422407

      target function =                  N/A
              le_mean =     -16.910273663977
             les_mean =     286.284574868949
             stat err =       0.000455973662
             autocorr =       1.270779337993
              std dev =       0.572031154724
             le_variance =       0.327219641975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166371294
                                         uncertainty =       0.003850353864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328166371294
                                         uncertainty =       0.003850353864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405078245
  error estimate for blocks of size 2^( 2) =       0.000417779240
  error estimate for blocks of size 2^( 3) =       0.000430577346
  error estimate for blocks of size 2^( 4) =       0.000442738194
  error estimate for blocks of size 2^( 5) =       0.000453966961
  error estimate for blocks of size 2^( 6) =       0.000462061933
  error estimate for blocks of size 2^( 7) =       0.000469592583

      target function =                  N/A
              le_mean =     -16.910262033279
             les_mean =     286.285138639040
             stat err =       0.000457089918
             autocorr =       1.273284479222
              std dev =       0.572867147756
             le_variance =       0.328176768978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910278103115        initial
     2.5000e-01     2.5000e+00             1.0652e-02       -16.910300579178  <--
     1.0000e+00     1.0000e+01             3.6928e-03       -16.910273663977
     4.0000e+00     4.0000e+01             1.0442e-03       -16.910262033279

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.7792e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.027626e-01 1 1  ON 0
 uu_1                 1.388674e-01 1 1  ON 1
 uu_2                 4.173723e-02 1 1  ON 2
 uu_3                -1.887264e-02 1 1  ON 3
 uu_4                -6.333076e-02 1 1  ON 4
 uu_5                -9.601412e-02 1 1  ON 5
 uu_6                -1.208116e-01 1 1  ON 6
 uu_7                -1.309656e-01 1 1  ON 7
 uu_8                -1.208392e-01 1 1  ON 8
 uu_9                -9.292955e-02 1 1  ON 9
 ud_0                 4.152858e-01 1 1  ON 10
 ud_1                 1.625725e-01 1 1  ON 11
 ud_2                 5.864693e-02 1 1  ON 12
 ud_3                -1.878732e-03 1 1  ON 13
 ud_4                -5.687846e-02 1 1  ON 14
 ud_5                -1.004640e-01 1 1  ON 15
 ud_6                -1.287788e-01 1 1  ON 16
 ud_7                -1.447747e-01 1 1  ON 17
 ud_8                -1.435365e-01 1 1  ON 18
 ud_9                -1.344781e-01 1 1  ON 19
 eO_0                -7.149616e-01 1 1  ON 20
 eO_1                -4.162115e-01 1 1  ON 21
 eO_2                -2.538257e-02 1 1  ON 22
 eO_3                 2.759800e-01 1 1  ON 23
 eO_4                 4.934132e-01 1 1  ON 24
 eO_5                 4.587368e-01 1 1  ON 25
 eO_6                 2.360957e-01 1 1  ON 26
 eO_7                -5.575290e-02 1 1  ON 27
 eO_8                -1.966568e-01 1 1  ON 28
 eO_9                -5.814826e-02 1 1  ON 29
eH1_0                -2.155740e-01 1 1  ON 30
eH1_1                -1.272049e-01 1 1  ON 31
eH1_2                -8.736739e-02 1 1  ON 32
eH1_3                -3.711445e-02 1 1  ON 33
eH1_4                 1.280837e-02 1 1  ON 34
eH1_5                 4.503299e-02 1 1  ON 35
eH1_6                 9.534881e-02 1 1  ON 36
eH1_7                 1.386995e-01 1 1  ON 37
eH1_8                 1.463149e-01 1 1  ON 38
eH1_9                 3.349408e-02 1 1  ON 39
eH2_0                -2.144005e-01 1 1  ON 40
eH2_1                -1.263825e-01 1 1  ON 41
eH2_2                -8.616454e-02 1 1  ON 42
eH2_3                -3.584107e-02 1 1  ON 43
eH2_4                 1.463478e-02 1 1  ON 44
eH2_5                 4.816059e-02 1 1  ON 45
eH2_6                 1.007204e-01 1 1  ON 46
eH2_7                 1.492964e-01 1 1  ON 47
eH2_8                 1.545264e-01 1 1  ON 48
eH2_9                 1.389313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9462
    reference variance = 0.341211
====================================================
  Execution time = 2.6584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2818e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328139636044
                                         uncertainty =       0.004855102291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328139636044
                                         uncertainty =       0.004855102291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405079059
  error estimate for blocks of size 2^( 2) =       0.000417187456
  error estimate for blocks of size 2^( 3) =       0.000430126486
  error estimate for blocks of size 2^( 4) =       0.000442996366
  error estimate for blocks of size 2^( 5) =       0.000454598319
  error estimate for blocks of size 2^( 6) =       0.000462042454
  error estimate for blocks of size 2^( 7) =       0.000467830056

      target function =                  N/A
              le_mean =     -16.908735475128
             les_mean =     286.233513291057
             stat err =       0.000456866798
             autocorr =       1.272036614287
              std dev =       0.572868298380
             le_variance =       0.328178087289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690873547513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908735475128       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908776915924       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908794342483       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908842982926       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890454117       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908893636028       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908893076009       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908895684492       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908899939691       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908904961646       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908907308081       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908909275331       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908907372130       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908908482904       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908908900627       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908909179412       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908909258049       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.709103e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908735475128       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908759945123       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908772035166       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908795275462       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908823109475       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908821248732       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908819212123       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908819129853       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908820187199       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908820791689       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908821511953       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908821292942       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908821365327       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.321961e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908735475128       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908744750785       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908750420372       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908757456736       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908767681962       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908766875452       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908765825686       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908765661817       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908765866788       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908766030324       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908766029101       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.416098e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2973e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.030807e-01 1 1  ON 0
 uu_1                 1.390283e-01 1 1  ON 1
 uu_2                 4.175381e-02 1 1  ON 2
 uu_3                -1.871870e-02 1 1  ON 3
 uu_4                -6.358950e-02 1 1  ON 4
 uu_5                -9.656409e-02 1 1  ON 5
 uu_6                -1.207066e-01 1 1  ON 6
 uu_7                -1.310524e-01 1 1  ON 7
 uu_8                -1.212973e-01 1 1  ON 8
 uu_9                -9.319407e-02 1 1  ON 9
 ud_0                 4.181101e-01 1 1  ON 10
 ud_1                 1.645953e-01 1 1  ON 11
 ud_2                 5.793933e-02 1 1  ON 12
 ud_3                -4.174663e-03 1 1  ON 13
 ud_4                -5.740128e-02 1 1  ON 14
 ud_5                -1.000461e-01 1 1  ON 15
 ud_6                -1.287085e-01 1 1  ON 16
 ud_7                -1.454374e-01 1 1  ON 17
 ud_8                -1.445304e-01 1 1  ON 18
 ud_9                -1.346950e-01 1 1  ON 19
 eO_0                -7.222836e-01 1 1  ON 20
 eO_1                -4.185641e-01 1 1  ON 21
 eO_2                -2.209604e-02 1 1  ON 22
 eO_3                 2.809487e-01 1 1  ON 23
 eO_4                 4.958011e-01 1 1  ON 24
 eO_5                 4.586825e-01 1 1  ON 25
 eO_6                 2.359813e-01 1 1  ON 26
 eO_7                -5.531312e-02 1 1  ON 27
 eO_8                -1.972211e-01 1 1  ON 28
 eO_9                -5.873442e-02 1 1  ON 29
eH1_0                -2.198488e-01 1 1  ON 30
eH1_1                -1.275574e-01 1 1  ON 31
eH1_2                -8.663948e-02 1 1  ON 32
eH1_3                -3.684482e-02 1 1  ON 33
eH1_4                 1.356241e-02 1 1  ON 34
eH1_5                 4.524457e-02 1 1  ON 35
eH1_6                 9.614335e-02 1 1  ON 36
eH1_7                 1.391915e-01 1 1  ON 37
eH1_8                 1.470099e-01 1 1  ON 38
eH1_9                 3.414353e-02 1 1  ON 39
eH2_0                -2.183996e-01 1 1  ON 40
eH2_1                -1.265721e-01 1 1  ON 41
eH2_2                -8.554758e-02 1 1  ON 42
eH2_3                -3.567855e-02 1 1  ON 43
eH2_4                 1.520235e-02 1 1  ON 44
eH2_5                 4.848707e-02 1 1  ON 45
eH2_6                 1.015089e-01 1 1  ON 46
eH2_7                 1.495613e-01 1 1  ON 47
eH2_8                 1.553030e-01 1 1  ON 48
eH2_9                 1.466529e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.27564
====================================================
  Execution time = 2.3748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2607e-01
  Total weights = 2.0000e+06
  Execution time = 2.7247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325283213101
                                         uncertainty =       0.005042402244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325283213101
                                         uncertainty =       0.005042402244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403235178
  error estimate for blocks of size 2^( 2) =       0.000415175087
  error estimate for blocks of size 2^( 3) =       0.000428007111
  error estimate for blocks of size 2^( 4) =       0.000439428674
  error estimate for blocks of size 2^( 5) =       0.000448679170
  error estimate for blocks of size 2^( 6) =       0.000454577885
  error estimate for blocks of size 2^( 7) =       0.000457139386

      target function =                  N/A
              le_mean =     -16.910809088431
             les_mean =     286.300661079792
             stat err =       0.000449956279
             autocorr =       1.245156121857
              std dev =       0.570260657085
             le_variance =       0.325197217019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327968182934
                                         uncertainty =       0.005028998868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327968182934
                                         uncertainty =       0.005028998868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404896479
  error estimate for blocks of size 2^( 2) =       0.000416596363
  error estimate for blocks of size 2^( 3) =       0.000429204686
  error estimate for blocks of size 2^( 4) =       0.000440501134
  error estimate for blocks of size 2^( 5) =       0.000449652915
  error estimate for blocks of size 2^( 6) =       0.000455469037
  error estimate for blocks of size 2^( 7) =       0.000457800830

      target function =                  N/A
              le_mean =     -16.910788419203
             les_mean =     286.302647111905
             stat err =       0.000450855979
             autocorr =       1.239902876301
              std dev =       0.572610091427
             le_variance =       0.327882316804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327469218586
                                         uncertainty =       0.005023389216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327469218586
                                         uncertainty =       0.005023389216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404588212
  error estimate for blocks of size 2^( 2) =       0.000416299249
  error estimate for blocks of size 2^( 3) =       0.000428916115
  error estimate for blocks of size 2^( 4) =       0.000440235384
  error estimate for blocks of size 2^( 5) =       0.000449429702
  error estimate for blocks of size 2^( 6) =       0.000455256085
  error estimate for blocks of size 2^( 7) =       0.000457566734

      target function =                  N/A
              le_mean =     -16.910804503755
             les_mean =     286.302692042691
             stat err =       0.000450621976
             autocorr =       1.240504335223
              std dev =       0.572174136209
             le_variance =       0.327383242146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325447264453
                                         uncertainty =       0.005037976509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325447264453
                                         uncertainty =       0.005037976509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403336880
  error estimate for blocks of size 2^( 2) =       0.000415225545
  error estimate for blocks of size 2^( 3) =       0.000428009785
  error estimate for blocks of size 2^( 4) =       0.000439410151
  error estimate for blocks of size 2^( 5) =       0.000448652856
  error estimate for blocks of size 2^( 6) =       0.000454537159
  error estimate for blocks of size 2^( 7) =       0.000457046400

      target function =                  N/A
              le_mean =     -16.910784801613
             les_mean =     286.300003721331
             stat err =       0.000449911642
             autocorr =       1.244281352394
              std dev =       0.570404485919
             le_variance =       0.325361277556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910809088431        initial  <--
     6.2500e-02     6.2500e-01             1.7091e-02       -16.910788419203
     2.5000e-01     2.5000e+00             7.3220e-03       -16.910804503755
     1.0000e+00     1.0000e+01             2.4161e-03       -16.910784801613

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4647
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.027626e-01 1 1  ON 0
 uu_1                 1.388674e-01 1 1  ON 1
 uu_2                 4.173723e-02 1 1  ON 2
 uu_3                -1.887264e-02 1 1  ON 3
 uu_4                -6.333076e-02 1 1  ON 4
 uu_5                -9.601412e-02 1 1  ON 5
 uu_6                -1.208116e-01 1 1  ON 6
 uu_7                -1.309656e-01 1 1  ON 7
 uu_8                -1.208392e-01 1 1  ON 8
 uu_9                -9.292955e-02 1 1  ON 9
 ud_0                 4.152858e-01 1 1  ON 10
 ud_1                 1.625725e-01 1 1  ON 11
 ud_2                 5.864693e-02 1 1  ON 12
 ud_3                -1.878732e-03 1 1  ON 13
 ud_4                -5.687846e-02 1 1  ON 14
 ud_5                -1.004640e-01 1 1  ON 15
 ud_6                -1.287788e-01 1 1  ON 16
 ud_7                -1.447747e-01 1 1  ON 17
 ud_8                -1.435365e-01 1 1  ON 18
 ud_9                -1.344781e-01 1 1  ON 19
 eO_0                -7.149616e-01 1 1  ON 20
 eO_1                -4.162115e-01 1 1  ON 21
 eO_2                -2.538257e-02 1 1  ON 22
 eO_3                 2.759800e-01 1 1  ON 23
 eO_4                 4.934132e-01 1 1  ON 24
 eO_5                 4.587368e-01 1 1  ON 25
 eO_6                 2.360957e-01 1 1  ON 26
 eO_7                -5.575290e-02 1 1  ON 27
 eO_8                -1.966568e-01 1 1  ON 28
 eO_9                -5.814826e-02 1 1  ON 29
eH1_0                -2.155740e-01 1 1  ON 30
eH1_1                -1.272049e-01 1 1  ON 31
eH1_2                -8.736739e-02 1 1  ON 32
eH1_3                -3.711445e-02 1 1  ON 33
eH1_4                 1.280837e-02 1 1  ON 34
eH1_5                 4.503299e-02 1 1  ON 35
eH1_6                 9.534881e-02 1 1  ON 36
eH1_7                 1.386995e-01 1 1  ON 37
eH1_8                 1.463149e-01 1 1  ON 38
eH1_9                 3.349408e-02 1 1  ON 39
eH2_0                -2.144005e-01 1 1  ON 40
eH2_1                -1.263825e-01 1 1  ON 41
eH2_2                -8.616454e-02 1 1  ON 42
eH2_3                -3.584107e-02 1 1  ON 43
eH2_4                 1.463478e-02 1 1  ON 44
eH2_5                 4.816059e-02 1 1  ON 45
eH2_6                 1.007204e-01 1 1  ON 46
eH2_7                 1.492964e-01 1 1  ON 47
eH2_8                 1.545264e-01 1 1  ON 48
eH2_9                 1.389313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9599
    reference variance = 0.283743
====================================================
  Execution time = 2.4307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3397e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333972079944
                                         uncertainty =       0.005961427656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333972079944
                                         uncertainty =       0.005961427656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408639939
  error estimate for blocks of size 2^( 2) =       0.000420758769
  error estimate for blocks of size 2^( 3) =       0.000433337445
  error estimate for blocks of size 2^( 4) =       0.000445111265
  error estimate for blocks of size 2^( 5) =       0.000456496557
  error estimate for blocks of size 2^( 6) =       0.000464939905
  error estimate for blocks of size 2^( 7) =       0.000469484937

      target function =                  N/A
              le_mean =     -16.909212158715
             les_mean =     286.255428860383
             stat err =       0.000459008166
             autocorr =       1.261709005236
              std dev =       0.577904143390
             le_variance =       0.333973198947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690921215871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909212158715       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909226251415       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909239547937       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909248010339       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909260295459       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909261918187       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909263347289       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909264081198       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909263924486       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909263965373       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909264024233       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.604503e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909212158715       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909216477615       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909221238693       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909223244513       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909226807891       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909227200803       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909227676252       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909227772736       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909227712763       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909227699427       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.045994e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909212158715       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909213303053       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909214633906       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909215124060       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909216036272       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909216135659       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909216263967       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909216276049       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909216269049       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.739377e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0645e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.027670e-01 1 1  ON 0
 uu_1                 1.388056e-01 1 1  ON 1
 uu_2                 4.171960e-02 1 1  ON 2
 uu_3                -1.884392e-02 1 1  ON 3
 uu_4                -6.333214e-02 1 1  ON 4
 uu_5                -9.601554e-02 1 1  ON 5
 uu_6                -1.207658e-01 1 1  ON 6
 uu_7                -1.309437e-01 1 1  ON 7
 uu_8                -1.209041e-01 1 1  ON 8
 uu_9                -9.296440e-02 1 1  ON 9
 ud_0                 4.156662e-01 1 1  ON 10
 ud_1                 1.629282e-01 1 1  ON 11
 ud_2                 5.847044e-02 1 1  ON 12
 ud_3                -2.294012e-03 1 1  ON 13
 ud_4                -5.686212e-02 1 1  ON 14
 ud_5                -1.004203e-01 1 1  ON 15
 ud_6                -1.287792e-01 1 1  ON 16
 ud_7                -1.448648e-01 1 1  ON 17
 ud_8                -1.436577e-01 1 1  ON 18
 ud_9                -1.345067e-01 1 1  ON 19
 eO_0                -7.160076e-01 1 1  ON 20
 eO_1                -4.164400e-01 1 1  ON 21
 eO_2                -2.479222e-02 1 1  ON 22
 eO_3                 2.765901e-01 1 1  ON 23
 eO_4                 4.936225e-01 1 1  ON 24
 eO_5                 4.586644e-01 1 1  ON 25
 eO_6                 2.361235e-01 1 1  ON 26
 eO_7                -5.570309e-02 1 1  ON 27
 eO_8                -1.967424e-01 1 1  ON 28
 eO_9                -5.819778e-02 1 1  ON 29
eH1_0                -2.161295e-01 1 1  ON 30
eH1_1                -1.272055e-01 1 1  ON 31
eH1_2                -8.720736e-02 1 1  ON 32
eH1_3                -3.705884e-02 1 1  ON 33
eH1_4                 1.297903e-02 1 1  ON 34
eH1_5                 4.499767e-02 1 1  ON 35
eH1_6                 9.537170e-02 1 1  ON 36
eH1_7                 1.387655e-01 1 1  ON 37
eH1_8                 1.463977e-01 1 1  ON 38
eH1_9                 3.353059e-02 1 1  ON 39
eH2_0                -2.149619e-01 1 1  ON 40
eH2_1                -1.263858e-01 1 1  ON 41
eH2_2                -8.602093e-02 1 1  ON 42
eH2_3                -3.578048e-02 1 1  ON 43
eH2_4                 1.477736e-02 1 1  ON 44
eH2_5                 4.818876e-02 1 1  ON 45
eH2_6                 1.007190e-01 1 1  ON 46
eH2_7                 1.492716e-01 1 1  ON 47
eH2_8                 1.546175e-01 1 1  ON 48
eH2_9                 1.399807e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.7999
    reference variance = 0.302193
====================================================
  Execution time = 2.3954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3290e-01
  Total weights = 2.0000e+06
  Execution time = 2.7286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332910486445
                                         uncertainty =       0.005445088901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332910486445
                                         uncertainty =       0.005445088901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407941933
  error estimate for blocks of size 2^( 2) =       0.000419997734
  error estimate for blocks of size 2^( 3) =       0.000432574294
  error estimate for blocks of size 2^( 4) =       0.000443583511
  error estimate for blocks of size 2^( 5) =       0.000453233444
  error estimate for blocks of size 2^( 6) =       0.000459359268
  error estimate for blocks of size 2^( 7) =       0.000463288535

      target function =                  N/A
              le_mean =     -16.909914266813
             les_mean =     286.278033586160
             stat err =       0.000454866190
             autocorr =       1.243284771610
              std dev =       0.576917014505
             le_variance =       0.332833241625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333304838963
                                         uncertainty =       0.005462753063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333304838963
                                         uncertainty =       0.005462753063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408183239
  error estimate for blocks of size 2^( 2) =       0.000420167924
  error estimate for blocks of size 2^( 3) =       0.000432678985
  error estimate for blocks of size 2^( 4) =       0.000443644528
  error estimate for blocks of size 2^( 5) =       0.000453278367
  error estimate for blocks of size 2^( 6) =       0.000459409365
  error estimate for blocks of size 2^( 7) =       0.000463293976

      target function =                  N/A
              le_mean =     -16.909927893284
             les_mean =     286.278888303374
             stat err =       0.000454906559
             autocorr =       1.242035648337
              std dev =       0.577258273138
             le_variance =       0.333227113907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333060570181
                                         uncertainty =       0.005454695219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333060570181
                                         uncertainty =       0.005454695219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408033703
  error estimate for blocks of size 2^( 2) =       0.000420046627
  error estimate for blocks of size 2^( 3) =       0.000432583836
  error estimate for blocks of size 2^( 4) =       0.000443567476
  error estimate for blocks of size 2^( 5) =       0.000453208175
  error estimate for blocks of size 2^( 6) =       0.000459341249
  error estimate for blocks of size 2^( 7) =       0.000463245631

      target function =                  N/A
              le_mean =     -16.909919894256
             les_mean =     286.278373669547
             stat err =       0.000454840633
             autocorr =       1.242585944856
              std dev =       0.577046796972
             le_variance =       0.332983005895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332922780775
                                         uncertainty =       0.005446299614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332922780775
                                         uncertainty =       0.005446299614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407949441
  error estimate for blocks of size 2^( 2) =       0.000419999379
  error estimate for blocks of size 2^( 3) =       0.000432570610
  error estimate for blocks of size 2^( 4) =       0.000443576413
  error estimate for blocks of size 2^( 5) =       0.000453225149
  error estimate for blocks of size 2^( 6) =       0.000459352159
  error estimate for blocks of size 2^( 7) =       0.000463278247

      target function =                  N/A
              le_mean =     -16.909914431148
             les_mean =     286.278051394580
             stat err =       0.000454857992
             autocorr =       1.243194201954
              std dev =       0.576927631728
             le_variance =       0.332845492251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909914266813        initial
     6.2500e-01     6.2500e+00             3.6045e-03       -16.909927893284  <--
     2.5000e+00     2.5000e+01             1.0460e-03       -16.909919894256
     1.0000e+01     1.0000e+02             2.7394e-04       -16.909914431148

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.7807e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.028529e-01 1 1  ON 0
 uu_1                 1.387482e-01 1 1  ON 1
 uu_2                 4.166183e-02 1 1  ON 2
 uu_3                -1.884737e-02 1 1  ON 3
 uu_4                -6.337042e-02 1 1  ON 4
 uu_5                -9.601974e-02 1 1  ON 5
 uu_6                -1.206679e-01 1 1  ON 6
 uu_7                -1.309005e-01 1 1  ON 7
 uu_8                -1.210979e-01 1 1  ON 8
 uu_9                -9.307360e-02 1 1  ON 9
 ud_0                 4.166913e-01 1 1  ON 10
 ud_1                 1.636773e-01 1 1  ON 11
 ud_2                 5.816266e-02 1 1  ON 12
 ud_3                -3.192056e-03 1 1  ON 13
 ud_4                -5.699642e-02 1 1  ON 14
 ud_5                -1.003096e-01 1 1  ON 15
 ud_6                -1.287623e-01 1 1  ON 16
 ud_7                -1.450958e-01 1 1  ON 17
 ud_8                -1.440032e-01 1 1  ON 18
 ud_9                -1.345956e-01 1 1  ON 19
 eO_0                -7.185661e-01 1 1  ON 20
 eO_1                -4.171733e-01 1 1  ON 21
 eO_2                -2.348869e-02 1 1  ON 22
 eO_3                 2.781868e-01 1 1  ON 23
 eO_4                 4.943389e-01 1 1  ON 24
 eO_5                 4.585404e-01 1 1  ON 25
 eO_6                 2.361971e-01 1 1  ON 26
 eO_7                -5.556053e-02 1 1  ON 27
 eO_8                -1.969960e-01 1 1  ON 28
 eO_9                -5.834513e-02 1 1  ON 29
eH1_0                -2.175709e-01 1 1  ON 30
eH1_1                -1.272331e-01 1 1  ON 31
eH1_2                -8.682728e-02 1 1  ON 32
eH1_3                -3.689379e-02 1 1  ON 33
eH1_4                 1.335697e-02 1 1  ON 34
eH1_5                 4.493084e-02 1 1  ON 35
eH1_6                 9.545415e-02 1 1  ON 36
eH1_7                 1.389554e-01 1 1  ON 37
eH1_8                 1.466398e-01 1 1  ON 38
eH1_9                 3.363841e-02 1 1  ON 39
eH2_0                -2.164201e-01 1 1  ON 40
eH2_1                -1.264244e-01 1 1  ON 41
eH2_2                -8.568502e-02 1 1  ON 42
eH2_3                -3.561292e-02 1 1  ON 43
eH2_4                 1.509237e-02 1 1  ON 44
eH2_5                 4.828758e-02 1 1  ON 45
eH2_6                 1.007358e-01 1 1  ON 46
eH2_7                 1.492000e-01 1 1  ON 47
eH2_8                 1.548838e-01 1 1  ON 48
eH2_9                 1.430767e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.215201
====================================================
  Execution time = 2.4441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332517561
                                         uncertainty =       0.017812206349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332517561
                                         uncertainty =       0.017812206349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697082
  error estimate for blocks of size 2^( 2) =       0.000422629576
  error estimate for blocks of size 2^( 3) =       0.000434747539
  error estimate for blocks of size 2^( 4) =       0.000446160703
  error estimate for blocks of size 2^( 5) =       0.000455554165
  error estimate for blocks of size 2^( 6) =       0.000463730195
  error estimate for blocks of size 2^( 7) =       0.000469929225

      target function =                  N/A
              le_mean =     -16.909913505211
             les_mean =     286.282518770701
             stat err =       0.000458843572
             autocorr =       1.248205438037
              std dev =       0.580813382808
             le_variance =       0.337344185649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690991350521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909913505211       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909944128434       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909955822559       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909996921138       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910000860681       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910011666867       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910013617665       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910012589617       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910013137214       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910013601550       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910014003837       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910014184871       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910014383067       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.440780e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909913505211       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909927487130       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909934205250       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909948012627       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909949600147       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909952070163       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909952214272       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909951710882       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909951723845       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909951721907       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909951837175       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.994210e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909913505211       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909917910782       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909920346867       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909923944587       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909924408173       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909924983454       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909924842573       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909924782661       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909924798286       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.661616e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0813e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.028431e-01 1 1  ON 0
 uu_1                 1.387915e-01 1 1  ON 1
 uu_2                 4.168741e-02 1 1  ON 2
 uu_3                -1.874281e-02 1 1  ON 3
 uu_4                -6.355376e-02 1 1  ON 4
 uu_5                -9.612815e-02 1 1  ON 5
 uu_6                -1.206475e-01 1 1  ON 6
 uu_7                -1.309972e-01 1 1  ON 7
 uu_8                -1.212166e-01 1 1  ON 8
 uu_9                -9.313140e-02 1 1  ON 9
 ud_0                 4.179105e-01 1 1  ON 10
 ud_1                 1.646172e-01 1 1  ON 11
 ud_2                 5.788682e-02 1 1  ON 12
 ud_3                -4.060351e-03 1 1  ON 13
 ud_4                -5.733976e-02 1 1  ON 14
 ud_5                -1.000840e-01 1 1  ON 15
 ud_6                -1.286454e-01 1 1  ON 16
 ud_7                -1.453696e-01 1 1  ON 17
 ud_8                -1.445136e-01 1 1  ON 18
 ud_9                -1.348001e-01 1 1  ON 19
 eO_0                -7.215603e-01 1 1  ON 20
 eO_1                -4.180263e-01 1 1  ON 21
 eO_2                -2.217305e-02 1 1  ON 22
 eO_3                 2.802110e-01 1 1  ON 23
 eO_4                 4.953296e-01 1 1  ON 24
 eO_5                 4.584469e-01 1 1  ON 25
 eO_6                 2.361994e-01 1 1  ON 26
 eO_7                -5.538652e-02 1 1  ON 27
 eO_8                -1.973126e-01 1 1  ON 28
 eO_9                -5.857580e-02 1 1  ON 29
eH1_0                -2.193419e-01 1 1  ON 30
eH1_1                -1.273301e-01 1 1  ON 31
eH1_2                -8.656212e-02 1 1  ON 32
eH1_3                -3.669453e-02 1 1  ON 33
eH1_4                 1.373251e-02 1 1  ON 34
eH1_5                 4.511501e-02 1 1  ON 35
eH1_6                 9.563526e-02 1 1  ON 36
eH1_7                 1.391251e-01 1 1  ON 37
eH1_8                 1.469403e-01 1 1  ON 38
eH1_9                 3.384450e-02 1 1  ON 39
eH2_0                -2.182235e-01 1 1  ON 40
eH2_1                -1.264448e-01 1 1  ON 41
eH2_2                -8.532030e-02 1 1  ON 42
eH2_3                -3.544274e-02 1 1  ON 43
eH2_4                 1.543176e-02 1 1  ON 44
eH2_5                 4.843382e-02 1 1  ON 45
eH2_6                 1.009180e-01 1 1  ON 46
eH2_7                 1.491768e-01 1 1  ON 47
eH2_8                 1.552272e-01 1 1  ON 48
eH2_9                 1.462925e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.17513
====================================================
  Execution time = 2.4427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2688e-01
  Total weights = 2.0000e+06
  Execution time = 2.7245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326451724643
                                         uncertainty =       0.003480932470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326451724643
                                         uncertainty =       0.003480932470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404040730
  error estimate for blocks of size 2^( 2) =       0.000416912534
  error estimate for blocks of size 2^( 3) =       0.000429818640
  error estimate for blocks of size 2^( 4) =       0.000442516483
  error estimate for blocks of size 2^( 5) =       0.000455295375
  error estimate for blocks of size 2^( 6) =       0.000466108458
  error estimate for blocks of size 2^( 7) =       0.000472355878

      target function =                  N/A
              le_mean =     -16.909618187474
             les_mean =     286.261684905557
             stat err =       0.000459069049
             autocorr =       1.290939031439
              std dev =       0.571399879817
             le_variance =       0.326497822655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327824332466
                                         uncertainty =       0.003503313454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327824332466
                                         uncertainty =       0.003503313454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404888407
  error estimate for blocks of size 2^( 2) =       0.000417615808
  error estimate for blocks of size 2^( 3) =       0.000430416968
  error estimate for blocks of size 2^( 4) =       0.000443046008
  error estimate for blocks of size 2^( 5) =       0.000455777790
  error estimate for blocks of size 2^( 6) =       0.000466613128
  error estimate for blocks of size 2^( 7) =       0.000472832363

      target function =                  N/A
              le_mean =     -16.909624494890
             les_mean =     286.263269638375
             stat err =       0.000459567322
             autocorr =       1.288331415755
              std dev =       0.572598676323
             le_variance =       0.327869244127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327299801523
                                         uncertainty =       0.003495857850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327299801523
                                         uncertainty =       0.003495857850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404564586
  error estimate for blocks of size 2^( 2) =       0.000417322516
  error estimate for blocks of size 2^( 3) =       0.000430152393
  error estimate for blocks of size 2^( 4) =       0.000442802613
  error estimate for blocks of size 2^( 5) =       0.000455554347
  error estimate for blocks of size 2^( 6) =       0.000466397471
  error estimate for blocks of size 2^( 7) =       0.000472627620

      target function =                  N/A
              le_mean =     -16.909616722487
             les_mean =     286.262482545998
             stat err =       0.000459345513
             autocorr =       1.289149337496
              std dev =       0.572140724181
             le_variance =       0.327345008266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326536486405
                                         uncertainty =       0.003482838859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326536486405
                                         uncertainty =       0.003482838859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404093097
  error estimate for blocks of size 2^( 2) =       0.000416946434
  error estimate for blocks of size 2^( 3) =       0.000429840414
  error estimate for blocks of size 2^( 4) =       0.000442530825
  error estimate for blocks of size 2^( 5) =       0.000455306164
  error estimate for blocks of size 2^( 6) =       0.000466124780
  error estimate for blocks of size 2^( 7) =       0.000472370082

      target function =                  N/A
              le_mean =     -16.909614207761
             les_mean =     286.261634953894
             stat err =       0.000459082963
             autocorr =       1.290682698055
              std dev =       0.571473938058
             le_variance =       0.326582461879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909618187474        initial
     1.5625e-01     1.5625e+00             8.4408e-03       -16.909624494890  <--
     6.2500e-01     6.2500e+00             2.9942e-03       -16.909616722487
     2.5000e+00     2.5000e+01             8.6616e-04       -16.909614207761

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.8158e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.033368e-01 1 1  ON 0
 uu_1                 1.392050e-01 1 1  ON 1
 uu_2                 4.175419e-02 1 1  ON 2
 uu_3                -1.888404e-02 1 1  ON 3
 uu_4                -6.407997e-02 1 1  ON 4
 uu_5                -9.647593e-02 1 1  ON 5
 uu_6                -1.207927e-01 1 1  ON 6
 uu_7                -1.313182e-01 1 1  ON 7
 uu_8                -1.215969e-01 1 1  ON 8
 uu_9                -9.334447e-02 1 1  ON 9
 ud_0                 4.202421e-01 1 1  ON 10
 ud_1                 1.661846e-01 1 1  ON 11
 ud_2                 5.799093e-02 1 1  ON 12
 ud_3                -5.097450e-03 1 1  ON 13
 ud_4                -5.817371e-02 1 1  ON 14
 ud_5                -1.000321e-01 1 1  ON 15
 ud_6                -1.284498e-01 1 1  ON 16
 ud_7                -1.457973e-01 1 1  ON 17
 ud_8                -1.457333e-01 1 1  ON 18
 ud_9                -1.354246e-01 1 1  ON 19
 eO_0                -7.270069e-01 1 1  ON 20
 eO_1                -4.204334e-01 1 1  ON 21
 eO_2                -2.060929e-02 1 1  ON 22
 eO_3                 2.840791e-01 1 1  ON 23
 eO_4                 4.982739e-01 1 1  ON 24
 eO_5                 4.589712e-01 1 1  ON 25
 eO_6                 2.363502e-01 1 1  ON 26
 eO_7                -5.491440e-02 1 1  ON 27
 eO_8                -1.982383e-01 1 1  ON 28
 eO_9                -5.926229e-02 1 1  ON 29
eH1_0                -2.228156e-01 1 1  ON 30
eH1_1                -1.278252e-01 1 1  ON 31
eH1_2                -8.639298e-02 1 1  ON 32
eH1_3                -3.641582e-02 1 1  ON 33
eH1_4                 1.416239e-02 1 1  ON 34
eH1_5                 4.555767e-02 1 1  ON 35
eH1_6                 9.627846e-02 1 1  ON 36
eH1_7                 1.396925e-01 1 1  ON 37
eH1_8                 1.478126e-01 1 1  ON 38
eH1_9                 3.445114e-02 1 1  ON 39
eH2_0                -2.217030e-01 1 1  ON 40
eH2_1                -1.267868e-01 1 1  ON 41
eH2_2                -8.500061e-02 1 1  ON 42
eH2_3                -3.517108e-02 1 1  ON 43
eH2_4                 1.578631e-02 1 1  ON 44
eH2_5                 4.876456e-02 1 1  ON 45
eH2_6                 1.015517e-01 1 1  ON 46
eH2_7                 1.492152e-01 1 1  ON 47
eH2_8                 1.562183e-01 1 1  ON 48
eH2_9                 1.557239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.245002
====================================================
  Execution time = 2.4276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3671e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336708259850
                                         uncertainty =       0.007207046598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336708259850
                                         uncertainty =       0.007207046598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410310164
  error estimate for blocks of size 2^( 2) =       0.000422197094
  error estimate for blocks of size 2^( 3) =       0.000434768812
  error estimate for blocks of size 2^( 4) =       0.000446989032
  error estimate for blocks of size 2^( 5) =       0.000457600085
  error estimate for blocks of size 2^( 6) =       0.000465184036
  error estimate for blocks of size 2^( 7) =       0.000471997465

      target function =                  N/A
              le_mean =     -16.910153251313
             les_mean =     286.289991675152
             stat err =       0.000460442654
             autocorr =       1.259292300659
              std dev =       0.580266198052
             le_variance =       0.336708860602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691015325131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910153251313       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910159032561       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910169574326       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910197473246       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910211042525       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910227482949       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910239952689       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910242261323       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910244321773       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910245252900       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910243531488       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910242775921       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910244629246       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910244173443       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910245477512       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910244853223       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910245579195       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910245461866       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.297852e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910153251313       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910157002247       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910164294727       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910179895471       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910186829195       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910191269336       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910194048912       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910194653010       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910195156602       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910195641993       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910195125251       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910194558525       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910194712755       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 5.255328e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910153251313       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910154811109       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910158123328       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910164736487       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910166391244       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910166973463       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910167133948       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910166985541       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910167089435       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910167224548       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910167167510       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.666367e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0667e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.047510e-01 1 1  ON 0
 uu_1                 1.397723e-01 1 1  ON 1
 uu_2                 4.202063e-02 1 1  ON 2
 uu_3                -1.919504e-02 1 1  ON 3
 uu_4                -6.454530e-02 1 1  ON 4
 uu_5                -9.687429e-02 1 1  ON 5
 uu_6                -1.216104e-01 1 1  ON 6
 uu_7                -1.318772e-01 1 1  ON 7
 uu_8                -1.224252e-01 1 1  ON 8
 uu_9                -9.401577e-02 1 1  ON 9
 ud_0                 4.223385e-01 1 1  ON 10
 ud_1                 1.675091e-01 1 1  ON 11
 ud_2                 5.829045e-02 1 1  ON 12
 ud_3                -5.922660e-03 1 1  ON 13
 ud_4                -5.877263e-02 1 1  ON 14
 ud_5                -9.996416e-02 1 1  ON 15
 ud_6                -1.281746e-01 1 1  ON 16
 ud_7                -1.461643e-01 1 1  ON 17
 ud_8                -1.476144e-01 1 1  ON 18
 ud_9                -1.358420e-01 1 1  ON 19
 eO_0                -7.322622e-01 1 1  ON 20
 eO_1                -4.235878e-01 1 1  ON 21
 eO_2                -1.950377e-02 1 1  ON 22
 eO_3                 2.876196e-01 1 1  ON 23
 eO_4                 5.016754e-01 1 1  ON 24
 eO_5                 4.603976e-01 1 1  ON 25
 eO_6                 2.370969e-01 1 1  ON 26
 eO_7                -5.455171e-02 1 1  ON 27
 eO_8                -1.995371e-01 1 1  ON 28
 eO_9                -6.007557e-02 1 1  ON 29
eH1_0                -2.262117e-01 1 1  ON 30
eH1_1                -1.283113e-01 1 1  ON 31
eH1_2                -8.627749e-02 1 1  ON 32
eH1_3                -3.658805e-02 1 1  ON 33
eH1_4                 1.414716e-02 1 1  ON 34
eH1_5                 4.576797e-02 1 1  ON 35
eH1_6                 9.673814e-02 1 1  ON 36
eH1_7                 1.400337e-01 1 1  ON 37
eH1_8                 1.491359e-01 1 1  ON 38
eH1_9                 3.583691e-02 1 1  ON 39
eH2_0                -2.244293e-01 1 1  ON 40
eH2_1                -1.272415e-01 1 1  ON 41
eH2_2                -8.502135e-02 1 1  ON 42
eH2_3                -3.490926e-02 1 1  ON 43
eH2_4                 1.575849e-02 1 1  ON 44
eH2_5                 4.854069e-02 1 1  ON 45
eH2_6                 1.020633e-01 1 1  ON 46
eH2_7                 1.495123e-01 1 1  ON 47
eH2_8                 1.574976e-01 1 1  ON 48
eH2_9                 1.674033e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.259377
====================================================
  Execution time = 2.4402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3130e-01
  Total weights = 2.0000e+06
  Execution time = 2.7205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330135435384
                                         uncertainty =       0.002928825569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330135435384
                                         uncertainty =       0.002928825569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406268804
  error estimate for blocks of size 2^( 2) =       0.000418555801
  error estimate for blocks of size 2^( 3) =       0.000430821188
  error estimate for blocks of size 2^( 4) =       0.000443047956
  error estimate for blocks of size 2^( 5) =       0.000453877608
  error estimate for blocks of size 2^( 6) =       0.000463499873
  error estimate for blocks of size 2^( 7) =       0.000471320543

      target function =                  N/A
              le_mean =     -16.910261533428
             les_mean =     286.287053646663
             stat err =       0.000457936495
             autocorr =       1.270526007635
              std dev =       0.574550853087
             le_variance =       0.330108682782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776113850
                                         uncertainty =       0.002957633072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776113850
                                         uncertainty =       0.002957633072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407889558
  error estimate for blocks of size 2^( 2) =       0.000420092719
  error estimate for blocks of size 2^( 3) =       0.000432233041
  error estimate for blocks of size 2^( 4) =       0.000444320789
  error estimate for blocks of size 2^( 5) =       0.000455072087
  error estimate for blocks of size 2^( 6) =       0.000464617673
  error estimate for blocks of size 2^( 7) =       0.000472547707

      target function =                  N/A
              le_mean =     -16.910276572639
             les_mean =     286.290201380278
             stat err =       0.000459139564
             autocorr =       1.267080650621
              std dev =       0.576842945268
             le_variance =       0.332747783505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332619755093
                                         uncertainty =       0.002959149084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332619755093
                                         uncertainty =       0.002959149084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407793908
  error estimate for blocks of size 2^( 2) =       0.000419999822
  error estimate for blocks of size 2^( 3) =       0.000432157103
  error estimate for blocks of size 2^( 4) =       0.000444271084
  error estimate for blocks of size 2^( 5) =       0.000455050187
  error estimate for blocks of size 2^( 6) =       0.000464603168
  error estimate for blocks of size 2^( 7) =       0.000472558125

      target function =                  N/A
              le_mean =     -16.910275095310
             les_mean =     286.289995376167
             stat err =       0.000459120641
             autocorr =       1.267570629030
              std dev =       0.576707675873
             le_variance =       0.332591743411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538394674
                                         uncertainty =       0.002934208146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538394674
                                         uncertainty =       0.002934208146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406516578
  error estimate for blocks of size 2^( 2) =       0.000418786052
  error estimate for blocks of size 2^( 3) =       0.000431030654
  error estimate for blocks of size 2^( 4) =       0.000443237751
  error estimate for blocks of size 2^( 5) =       0.000454059362
  error estimate for blocks of size 2^( 6) =       0.000463669427
  error estimate for blocks of size 2^( 7) =       0.000471517055

      target function =                  N/A
              le_mean =     -16.910257586451
             les_mean =     286.287322930548
             stat err =       0.000458120899
             autocorr =       1.269999900420
              std dev =       0.574901257338
             le_variance =       0.330511455688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910261533428        initial
     3.9062e-02     3.9062e-01             1.2979e-02       -16.910276572639  <--
     1.5625e-01     1.5625e+00             5.2553e-03       -16.910275095310
     6.2500e-01     6.2500e+00             1.6664e-03       -16.910257586451

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.8107e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.068133e-01 1 1  ON 0
 uu_1                 1.411240e-01 1 1  ON 1
 uu_2                 4.271439e-02 1 1  ON 2
 uu_3                -1.940273e-02 1 1  ON 3
 uu_4                -6.551142e-02 1 1  ON 4
 uu_5                -9.813242e-02 1 1  ON 5
 uu_6                -1.232513e-01 1 1  ON 6
 uu_7                -1.334752e-01 1 1  ON 7
 uu_8                -1.243130e-01 1 1  ON 8
 uu_9                -9.594349e-02 1 1  ON 9
 ud_0                 4.250798e-01 1 1  ON 10
 ud_1                 1.697059e-01 1 1  ON 11
 ud_2                 5.953849e-02 1 1  ON 12
 ud_3                -5.785631e-03 1 1  ON 13
 ud_4                -5.926574e-02 1 1  ON 14
 ud_5                -1.003414e-01 1 1  ON 15
 ud_6                -1.286140e-01 1 1  ON 16
 ud_7                -1.469566e-01 1 1  ON 17
 ud_8                -1.503275e-01 1 1  ON 18
 ud_9                -1.371094e-01 1 1  ON 19
 eO_0                -7.399854e-01 1 1  ON 20
 eO_1                -4.290205e-01 1 1  ON 21
 eO_2                -2.044422e-02 1 1  ON 22
 eO_3                 2.914745e-01 1 1  ON 23
 eO_4                 5.080038e-01 1 1  ON 24
 eO_5                 4.658203e-01 1 1  ON 25
 eO_6                 2.407367e-01 1 1  ON 26
 eO_7                -5.318847e-02 1 1  ON 27
 eO_8                -2.032872e-01 1 1  ON 28
 eO_9                -6.262330e-02 1 1  ON 29
eH1_0                -2.309158e-01 1 1  ON 30
eH1_1                -1.304292e-01 1 1  ON 31
eH1_2                -8.794593e-02 1 1  ON 32
eH1_3                -3.786318e-02 1 1  ON 33
eH1_4                 1.282648e-02 1 1  ON 34
eH1_5                 4.528746e-02 1 1  ON 35
eH1_6                 9.754110e-02 1 1  ON 36
eH1_7                 1.416094e-01 1 1  ON 37
eH1_8                 1.532618e-01 1 1  ON 38
eH1_9                 4.015640e-02 1 1  ON 39
eH2_0                -2.282682e-01 1 1  ON 40
eH2_1                -1.290407e-01 1 1  ON 41
eH2_2                -8.636328e-02 1 1  ON 42
eH2_3                -3.568608e-02 1 1  ON 43
eH2_4                 1.471379e-02 1 1  ON 44
eH2_5                 4.766741e-02 1 1  ON 45
eH2_6                 1.028608e-01 1 1  ON 46
eH2_7                 1.509027e-01 1 1  ON 47
eH2_8                 1.614989e-01 1 1  ON 48
eH2_9                 2.041336e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9218
    reference variance = 0.26512
====================================================
  Execution time = 2.4540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328497626173
                                         uncertainty =       0.003912208527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328497626173
                                         uncertainty =       0.003912208527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405317765
  error estimate for blocks of size 2^( 2) =       0.000417825299
  error estimate for blocks of size 2^( 3) =       0.000430609497
  error estimate for blocks of size 2^( 4) =       0.000443792233
  error estimate for blocks of size 2^( 5) =       0.000454976051
  error estimate for blocks of size 2^( 6) =       0.000462408887
  error estimate for blocks of size 2^( 7) =       0.000466559772

      target function =                  N/A
              le_mean =     -16.910043251748
             les_mean =     286.278127593361
             stat err =       0.000456934236
             autocorr =       1.270913867559
              std dev =       0.573205880695
             le_variance =       0.328564981664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691004325175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043251748       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910045121042       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910056477758       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910066375985       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910078017157       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910081094293       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910086676258       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910094587931       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910103769506       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910105211770       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910106793524       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910106555015       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910104254474       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910110713033       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910114978621       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910116814836       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910118114425       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910117093594       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910115995754       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910114917615       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910114299830       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910115169791       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910115660685       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.831561e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043251748       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910044879952       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910053475914       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910061075691       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910069449690       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910069425079       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910070377829       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910074160601       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910076523122       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910076239075       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910076291627       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910074677979       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910075422309       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910075852444       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910076570090       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910076702963       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.530742e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043251748       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910044325835       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910048694207       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910052343866       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910056261059       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910055167673       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910055277325       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910055872488       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910055781538       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910055822945       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910055771810       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910055750189       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.381304e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1565e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.075767e-01 1 1  ON 0
 uu_1                 1.418699e-01 1 1  ON 1
 uu_2                 4.276699e-02 1 1  ON 2
 uu_3                -1.989435e-02 1 1  ON 3
 uu_4                -6.680072e-02 1 1  ON 4
 uu_5                -9.969873e-02 1 1  ON 5
 uu_6                -1.243640e-01 1 1  ON 6
 uu_7                -1.351576e-01 1 1  ON 7
 uu_8                -1.248386e-01 1 1  ON 8
 uu_9                -9.567622e-02 1 1  ON 9
 ud_0                 4.280730e-01 1 1  ON 10
 ud_1                 1.724583e-01 1 1  ON 11
 ud_2                 6.161022e-02 1 1  ON 12
 ud_3                -4.794195e-03 1 1  ON 13
 ud_4                -5.941181e-02 1 1  ON 14
 ud_5                -1.013550e-01 1 1  ON 15
 ud_6                -1.297333e-01 1 1  ON 16
 ud_7                -1.485768e-01 1 1  ON 17
 ud_8                -1.509903e-01 1 1  ON 18
 ud_9                -1.388247e-01 1 1  ON 19
 eO_0                -7.465161e-01 1 1  ON 20
 eO_1                -4.336254e-01 1 1  ON 21
 eO_2                -2.275400e-02 1 1  ON 22
 eO_3                 2.943417e-01 1 1  ON 23
 eO_4                 5.140618e-01 1 1  ON 24
 eO_5                 4.718555e-01 1 1  ON 25
 eO_6                 2.448460e-01 1 1  ON 26
 eO_7                -5.158017e-02 1 1  ON 27
 eO_8                -2.067666e-01 1 1  ON 28
 eO_9                -6.586466e-02 1 1  ON 29
eH1_0                -2.347763e-01 1 1  ON 30
eH1_1                -1.342611e-01 1 1  ON 31
eH1_2                -9.112580e-02 1 1  ON 32
eH1_3                -4.012434e-02 1 1  ON 33
eH1_4                 1.156945e-02 1 1  ON 34
eH1_5                 4.515924e-02 1 1  ON 35
eH1_6                 1.007606e-01 1 1  ON 36
eH1_7                 1.451164e-01 1 1  ON 37
eH1_8                 1.573241e-01 1 1  ON 38
eH1_9                 4.392615e-02 1 1  ON 39
eH2_0                -2.330332e-01 1 1  ON 40
eH2_1                -1.317544e-01 1 1  ON 41
eH2_2                -8.857484e-02 1 1  ON 42
eH2_3                -3.751326e-02 1 1  ON 43
eH2_4                 1.381794e-02 1 1  ON 44
eH2_5                 4.755471e-02 1 1  ON 45
eH2_6                 1.042721e-01 1 1  ON 46
eH2_7                 1.534419e-01 1 1  ON 47
eH2_8                 1.660247e-01 1 1  ON 48
eH2_9                 2.476605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.936
    reference variance = 0.293218
====================================================
  Execution time = 2.4216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.0000e+06
  Execution time = 2.7289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092484498
                                         uncertainty =       0.008981884726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092484498
                                         uncertainty =       0.008981884726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410033281
  error estimate for blocks of size 2^( 2) =       0.000422108988
  error estimate for blocks of size 2^( 3) =       0.000435167871
  error estimate for blocks of size 2^( 4) =       0.000447652307
  error estimate for blocks of size 2^( 5) =       0.000458427488
  error estimate for blocks of size 2^( 6) =       0.000465055384
  error estimate for blocks of size 2^( 7) =       0.000469585834

      target function =                  N/A
              le_mean =     -16.909890953853
             les_mean =     286.280666486366
             stat err =       0.000460180253
             autocorr =       1.259556751528
              std dev =       0.579874627223
             le_variance =       0.336254583297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338549924747
                                         uncertainty =       0.009071212772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338549924747
                                         uncertainty =       0.009071212772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529740
  error estimate for blocks of size 2^( 2) =       0.000423569214
  error estimate for blocks of size 2^( 3) =       0.000436547016
  error estimate for blocks of size 2^( 4) =       0.000448902381
  error estimate for blocks of size 2^( 5) =       0.000459563477
  error estimate for blocks of size 2^( 6) =       0.000466090442
  error estimate for blocks of size 2^( 7) =       0.000470557731

      target function =                  N/A
              le_mean =     -16.909878727163
             les_mean =     286.282711851076
             stat err =       0.000461278508
             autocorr =       1.256388607850
              std dev =       0.581990938989
             le_variance =       0.338713453065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608570595
                                         uncertainty =       0.009081488190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608570595
                                         uncertainty =       0.009081488190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411565352
  error estimate for blocks of size 2^( 2) =       0.000423608596
  error estimate for blocks of size 2^( 3) =       0.000436601139
  error estimate for blocks of size 2^( 4) =       0.000448974289
  error estimate for blocks of size 2^( 5) =       0.000459654901
  error estimate for blocks of size 2^( 6) =       0.000466197009
  error estimate for blocks of size 2^( 7) =       0.000470660509

      target function =                  N/A
              le_mean =     -16.909877650457
             les_mean =     286.282734062422
             stat err =       0.000461371677
             autocorr =       1.256678680377
              std dev =       0.582041302996
             le_variance =       0.338772078393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336487344949
                                         uncertainty =       0.009000521991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336487344949
                                         uncertainty =       0.009000521991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410274132
  error estimate for blocks of size 2^( 2) =       0.000422342866
  error estimate for blocks of size 2^( 3) =       0.000435391148
  error estimate for blocks of size 2^( 4) =       0.000447855517
  error estimate for blocks of size 2^( 5) =       0.000458615267
  error estimate for blocks of size 2^( 6) =       0.000465228627
  error estimate for blocks of size 2^( 7) =       0.000469746672

      target function =                  N/A
              le_mean =     -16.909882582186
             les_mean =     286.280778502232
             stat err =       0.000460361521
             autocorr =       1.259069666559
              std dev =       0.580215242164
             le_variance =       0.336649727239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909890953853        initial  <--
     9.7656e-03     9.7656e-02             1.8316e-02       -16.909878727163
     3.9062e-02     3.9062e-01             6.5307e-03       -16.909877650457
     1.5625e-01     1.5625e+00             2.3813e-03       -16.909882582186

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.9507
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.068133e-01 1 1  ON 0
 uu_1                 1.411240e-01 1 1  ON 1
 uu_2                 4.271439e-02 1 1  ON 2
 uu_3                -1.940273e-02 1 1  ON 3
 uu_4                -6.551142e-02 1 1  ON 4
 uu_5                -9.813242e-02 1 1  ON 5
 uu_6                -1.232513e-01 1 1  ON 6
 uu_7                -1.334752e-01 1 1  ON 7
 uu_8                -1.243130e-01 1 1  ON 8
 uu_9                -9.594349e-02 1 1  ON 9
 ud_0                 4.250798e-01 1 1  ON 10
 ud_1                 1.697059e-01 1 1  ON 11
 ud_2                 5.953849e-02 1 1  ON 12
 ud_3                -5.785631e-03 1 1  ON 13
 ud_4                -5.926574e-02 1 1  ON 14
 ud_5                -1.003414e-01 1 1  ON 15
 ud_6                -1.286140e-01 1 1  ON 16
 ud_7                -1.469566e-01 1 1  ON 17
 ud_8                -1.503275e-01 1 1  ON 18
 ud_9                -1.371094e-01 1 1  ON 19
 eO_0                -7.399854e-01 1 1  ON 20
 eO_1                -4.290205e-01 1 1  ON 21
 eO_2                -2.044422e-02 1 1  ON 22
 eO_3                 2.914745e-01 1 1  ON 23
 eO_4                 5.080038e-01 1 1  ON 24
 eO_5                 4.658203e-01 1 1  ON 25
 eO_6                 2.407367e-01 1 1  ON 26
 eO_7                -5.318847e-02 1 1  ON 27
 eO_8                -2.032872e-01 1 1  ON 28
 eO_9                -6.262330e-02 1 1  ON 29
eH1_0                -2.309158e-01 1 1  ON 30
eH1_1                -1.304292e-01 1 1  ON 31
eH1_2                -8.794593e-02 1 1  ON 32
eH1_3                -3.786318e-02 1 1  ON 33
eH1_4                 1.282648e-02 1 1  ON 34
eH1_5                 4.528746e-02 1 1  ON 35
eH1_6                 9.754110e-02 1 1  ON 36
eH1_7                 1.416094e-01 1 1  ON 37
eH1_8                 1.532618e-01 1 1  ON 38
eH1_9                 4.015640e-02 1 1  ON 39
eH2_0                -2.282682e-01 1 1  ON 40
eH2_1                -1.290407e-01 1 1  ON 41
eH2_2                -8.636328e-02 1 1  ON 42
eH2_3                -3.568608e-02 1 1  ON 43
eH2_4                 1.471379e-02 1 1  ON 44
eH2_5                 4.766741e-02 1 1  ON 45
eH2_6                 1.028608e-01 1 1  ON 46
eH2_7                 1.509027e-01 1 1  ON 47
eH2_8                 1.614989e-01 1 1  ON 48
eH2_9                 2.041336e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8718
    reference variance = 0.117636
====================================================
  Execution time = 2.4478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335927663888
                                         uncertainty =       0.006845940028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335927663888
                                         uncertainty =       0.006845940028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409754513
  error estimate for blocks of size 2^( 2) =       0.000421658655
  error estimate for blocks of size 2^( 3) =       0.000433764384
  error estimate for blocks of size 2^( 4) =       0.000445267432
  error estimate for blocks of size 2^( 5) =       0.000455173090
  error estimate for blocks of size 2^( 6) =       0.000460877896
  error estimate for blocks of size 2^( 7) =       0.000466538434

      target function =                  N/A
              le_mean =     -16.909418986710
             les_mean =     286.264247821576
             stat err =       0.000456964213
             autocorr =       1.243703592538
              std dev =       0.579480389104
             le_variance =       0.335797521356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690941898671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909418986710       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909421818071       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909423625540       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909432204453       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909431441130       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909431973862       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909431727698       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909433131649       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909434543215       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909434073071       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909434497724       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909434198788       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909434097866       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.165257e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909418986710       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909420314628       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909420711014       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909423528459       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909424248145       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909424021576       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909423734878       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909423753311       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909424061067       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909423954751       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.029057e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909418986710       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909419411782       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909419477752       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909420153104       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909420436693       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909420512392       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909420365616       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909420377448       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909420381417       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.813308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0949e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.070415e-01 1 1  ON 0
 uu_1                 1.413302e-01 1 1  ON 1
 uu_2                 4.272137e-02 1 1  ON 2
 uu_3                -1.945924e-02 1 1  ON 3
 uu_4                -6.569588e-02 1 1  ON 4
 uu_5                -9.843495e-02 1 1  ON 5
 uu_6                -1.233435e-01 1 1  ON 6
 uu_7                -1.333871e-01 1 1  ON 7
 uu_8                -1.244588e-01 1 1  ON 8
 uu_9                -9.609015e-02 1 1  ON 9
 ud_0                 4.257137e-01 1 1  ON 10
 ud_1                 1.700658e-01 1 1  ON 11
 ud_2                 5.974653e-02 1 1  ON 12
 ud_3                -5.850953e-03 1 1  ON 13
 ud_4                -5.936022e-02 1 1  ON 14
 ud_5                -1.005199e-01 1 1  ON 15
 ud_6                -1.287233e-01 1 1  ON 16
 ud_7                -1.470570e-01 1 1  ON 17
 ud_8                -1.505003e-01 1 1  ON 18
 ud_9                -1.374170e-01 1 1  ON 19
 eO_0                -7.410145e-01 1 1  ON 20
 eO_1                -4.296788e-01 1 1  ON 21
 eO_2                -2.048525e-02 1 1  ON 22
 eO_3                 2.923701e-01 1 1  ON 23
 eO_4                 5.088491e-01 1 1  ON 24
 eO_5                 4.661858e-01 1 1  ON 25
 eO_6                 2.409862e-01 1 1  ON 26
 eO_7                -5.290969e-02 1 1  ON 27
 eO_8                -2.037906e-01 1 1  ON 28
 eO_9                -6.296515e-02 1 1  ON 29
eH1_0                -2.318056e-01 1 1  ON 30
eH1_1                -1.308871e-01 1 1  ON 31
eH1_2                -8.810253e-02 1 1  ON 32
eH1_3                -3.785671e-02 1 1  ON 33
eH1_4                 1.273089e-02 1 1  ON 34
eH1_5                 4.548963e-02 1 1  ON 35
eH1_6                 9.795649e-02 1 1  ON 36
eH1_7                 1.419300e-01 1 1  ON 37
eH1_8                 1.535905e-01 1 1  ON 38
eH1_9                 4.051903e-02 1 1  ON 39
eH2_0                -2.289919e-01 1 1  ON 40
eH2_1                -1.293904e-01 1 1  ON 41
eH2_2                -8.663629e-02 1 1  ON 42
eH2_3                -3.568118e-02 1 1  ON 43
eH2_4                 1.451835e-02 1 1  ON 44
eH2_5                 4.780716e-02 1 1  ON 45
eH2_6                 1.030112e-01 1 1  ON 46
eH2_7                 1.508909e-01 1 1  ON 47
eH2_8                 1.621465e-01 1 1  ON 48
eH2_9                 2.102503e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9662
    reference variance = 0.494205
====================================================
  Execution time = 2.4076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2863e-01
  Total weights = 2.0000e+06
  Execution time = 2.7219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328350034131
                                         uncertainty =       0.002805487542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328350034131
                                         uncertainty =       0.002805487542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405134793
  error estimate for blocks of size 2^( 2) =       0.000417438092
  error estimate for blocks of size 2^( 3) =       0.000429505588
  error estimate for blocks of size 2^( 4) =       0.000442006620
  error estimate for blocks of size 2^( 5) =       0.000452514325
  error estimate for blocks of size 2^( 6) =       0.000459743888
  error estimate for blocks of size 2^( 7) =       0.000465633507

      target function =                  N/A
              le_mean =     -16.910289568556
             les_mean =     286.286161528836
             stat err =       0.000454974585
             autocorr =       1.261174531688
              std dev =       0.572947118461
             le_variance =       0.328268400553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329234131172
                                         uncertainty =       0.002811205997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329234131172
                                         uncertainty =       0.002811205997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405679784
  error estimate for blocks of size 2^( 2) =       0.000417963737
  error estimate for blocks of size 2^( 3) =       0.000430005640
  error estimate for blocks of size 2^( 4) =       0.000442478975
  error estimate for blocks of size 2^( 5) =       0.000452962558
  error estimate for blocks of size 2^( 6) =       0.000460176689
  error estimate for blocks of size 2^( 7) =       0.000466055469

      target function =                  N/A
              le_mean =     -16.910289259014
             les_mean =     286.287034833325
             stat err =       0.000455418423
             autocorr =       1.260243474372
              std dev =       0.573717852578
             le_variance =       0.329152174366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329072478921
                                         uncertainty =       0.002810348400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329072478921
                                         uncertainty =       0.002810348400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405580183
  error estimate for blocks of size 2^( 2) =       0.000417866420
  error estimate for blocks of size 2^( 3) =       0.000429914762
  error estimate for blocks of size 2^( 4) =       0.000442397533
  error estimate for blocks of size 2^( 5) =       0.000452889497
  error estimate for blocks of size 2^( 6) =       0.000460107798
  error estimate for blocks of size 2^( 7) =       0.000465981704

      target function =                  N/A
              le_mean =     -16.910288810168
             les_mean =     286.286858048571
             stat err =       0.000455344133
             autocorr =       1.260451201553
              std dev =       0.573576995518
             le_variance =       0.328990569787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328468360140
                                         uncertainty =       0.002806341026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328468360140
                                         uncertainty =       0.002806341026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405207774
  error estimate for blocks of size 2^( 2) =       0.000417508011
  error estimate for blocks of size 2^( 3) =       0.000429572208
  error estimate for blocks of size 2^( 4) =       0.000442070313
  error estimate for blocks of size 2^( 5) =       0.000452575718
  error estimate for blocks of size 2^( 6) =       0.000459803462
  error estimate for blocks of size 2^( 7) =       0.000465689740

      target function =                  N/A
              le_mean =     -16.910289281895
             les_mean =     286.286270113163
             stat err =       0.000455034808
             autocorr =       1.261054052979
              std dev =       0.573050329369
             le_variance =       0.328386679990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910289568556        initial  <--
     9.7656e-02     9.7656e-01             3.1653e-03       -16.910289259014
     3.9062e-01     3.9062e+00             1.0291e-03       -16.910288810168
     1.5625e+00     1.5625e+01             2.8133e-04       -16.910289281895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8184
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.068133e-01 1 1  ON 0
 uu_1                 1.411240e-01 1 1  ON 1
 uu_2                 4.271439e-02 1 1  ON 2
 uu_3                -1.940273e-02 1 1  ON 3
 uu_4                -6.551142e-02 1 1  ON 4
 uu_5                -9.813242e-02 1 1  ON 5
 uu_6                -1.232513e-01 1 1  ON 6
 uu_7                -1.334752e-01 1 1  ON 7
 uu_8                -1.243130e-01 1 1  ON 8
 uu_9                -9.594349e-02 1 1  ON 9
 ud_0                 4.250798e-01 1 1  ON 10
 ud_1                 1.697059e-01 1 1  ON 11
 ud_2                 5.953849e-02 1 1  ON 12
 ud_3                -5.785631e-03 1 1  ON 13
 ud_4                -5.926574e-02 1 1  ON 14
 ud_5                -1.003414e-01 1 1  ON 15
 ud_6                -1.286140e-01 1 1  ON 16
 ud_7                -1.469566e-01 1 1  ON 17
 ud_8                -1.503275e-01 1 1  ON 18
 ud_9                -1.371094e-01 1 1  ON 19
 eO_0                -7.399854e-01 1 1  ON 20
 eO_1                -4.290205e-01 1 1  ON 21
 eO_2                -2.044422e-02 1 1  ON 22
 eO_3                 2.914745e-01 1 1  ON 23
 eO_4                 5.080038e-01 1 1  ON 24
 eO_5                 4.658203e-01 1 1  ON 25
 eO_6                 2.407367e-01 1 1  ON 26
 eO_7                -5.318847e-02 1 1  ON 27
 eO_8                -2.032872e-01 1 1  ON 28
 eO_9                -6.262330e-02 1 1  ON 29
eH1_0                -2.309158e-01 1 1  ON 30
eH1_1                -1.304292e-01 1 1  ON 31
eH1_2                -8.794593e-02 1 1  ON 32
eH1_3                -3.786318e-02 1 1  ON 33
eH1_4                 1.282648e-02 1 1  ON 34
eH1_5                 4.528746e-02 1 1  ON 35
eH1_6                 9.754110e-02 1 1  ON 36
eH1_7                 1.416094e-01 1 1  ON 37
eH1_8                 1.532618e-01 1 1  ON 38
eH1_9                 4.015640e-02 1 1  ON 39
eH2_0                -2.282682e-01 1 1  ON 40
eH2_1                -1.290407e-01 1 1  ON 41
eH2_2                -8.636328e-02 1 1  ON 42
eH2_3                -3.568608e-02 1 1  ON 43
eH2_4                 1.471379e-02 1 1  ON 44
eH2_5                 4.766741e-02 1 1  ON 45
eH2_6                 1.028608e-01 1 1  ON 46
eH2_7                 1.509027e-01 1 1  ON 47
eH2_8                 1.614989e-01 1 1  ON 48
eH2_9                 2.041336e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9519
    reference variance = 0.209474
====================================================
  Execution time = 2.4626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4112e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341210781667
                                         uncertainty =       0.009652933317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341210781667
                                         uncertainty =       0.009652933317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412991141
  error estimate for blocks of size 2^( 2) =       0.000424646911
  error estimate for blocks of size 2^( 3) =       0.000436729352
  error estimate for blocks of size 2^( 4) =       0.000448345811
  error estimate for blocks of size 2^( 5) =       0.000458585619
  error estimate for blocks of size 2^( 6) =       0.000464135035
  error estimate for blocks of size 2^( 7) =       0.000469836981

      target function =                  N/A
              le_mean =     -16.910231005129
             les_mean =     286.297035842066
             stat err =       0.000460225862
             autocorr =       1.241825479690
              std dev =       0.584057673362
             le_variance =       0.341123365813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691023100513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910231005129       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910232127001       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910232359882       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910232958901       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910233590031       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910233527606       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910233105747       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910233177506       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910233203926       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 5.195354e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910231005129       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910231320614       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910231394219       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910231541531       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910231730504       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910231707831       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910231600018       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910231612200       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.391443e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910231005129       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910231086541       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910231106359       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910231143322       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910231192763       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910231186672       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910231159904       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910231162570       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.543727e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1079e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.068330e-01 1 1  ON 0
 uu_1                 1.411588e-01 1 1  ON 1
 uu_2                 4.271172e-02 1 1  ON 2
 uu_3                -1.937463e-02 1 1  ON 3
 uu_4                -6.552627e-02 1 1  ON 4
 uu_5                -9.817450e-02 1 1  ON 5
 uu_6                -1.232634e-01 1 1  ON 6
 uu_7                -1.335028e-01 1 1  ON 7
 uu_8                -1.243303e-01 1 1  ON 8
 uu_9                -9.596212e-02 1 1  ON 9
 ud_0                 4.251454e-01 1 1  ON 10
 ud_1                 1.697453e-01 1 1  ON 11
 ud_2                 5.954973e-02 1 1  ON 12
 ud_3                -5.789984e-03 1 1  ON 13
 ud_4                -5.927861e-02 1 1  ON 14
 ud_5                -1.003465e-01 1 1  ON 15
 ud_6                -1.286281e-01 1 1  ON 16
 ud_7                -1.469451e-01 1 1  ON 17
 ud_8                -1.503427e-01 1 1  ON 18
 ud_9                -1.371551e-01 1 1  ON 19
 eO_0                -7.401246e-01 1 1  ON 20
 eO_1                -4.290752e-01 1 1  ON 21
 eO_2                -2.045050e-02 1 1  ON 22
 eO_3                 2.915408e-01 1 1  ON 23
 eO_4                 5.081097e-01 1 1  ON 24
 eO_5                 4.658746e-01 1 1  ON 25
 eO_6                 2.407671e-01 1 1  ON 26
 eO_7                -5.315312e-02 1 1  ON 27
 eO_8                -2.033311e-01 1 1  ON 28
 eO_9                -6.266649e-02 1 1  ON 29
eH1_0                -2.309762e-01 1 1  ON 30
eH1_1                -1.304807e-01 1 1  ON 31
eH1_2                -8.797618e-02 1 1  ON 32
eH1_3                -3.786325e-02 1 1  ON 33
eH1_4                 1.279726e-02 1 1  ON 34
eH1_5                 4.530234e-02 1 1  ON 35
eH1_6                 9.757059e-02 1 1  ON 36
eH1_7                 1.416423e-01 1 1  ON 37
eH1_8                 1.533178e-01 1 1  ON 38
eH1_9                 4.019698e-02 1 1  ON 39
eH2_0                -2.283629e-01 1 1  ON 40
eH2_1                -1.290694e-01 1 1  ON 41
eH2_2                -8.637156e-02 1 1  ON 42
eH2_3                -3.570835e-02 1 1  ON 43
eH2_4                 1.471446e-02 1 1  ON 44
eH2_5                 4.770433e-02 1 1  ON 45
eH2_6                 1.028668e-01 1 1  ON 46
eH2_7                 1.509152e-01 1 1  ON 47
eH2_8                 1.615474e-01 1 1  ON 48
eH2_9                 2.046528e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.305103
====================================================
  Execution time = 2.4000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3430e-01
  Total weights = 2.0000e+06
  Execution time = 2.7135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334117173381
                                         uncertainty =       0.009778206341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334117173381
                                         uncertainty =       0.009778206341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408810810
  error estimate for blocks of size 2^( 2) =       0.000420892432
  error estimate for blocks of size 2^( 3) =       0.000433319563
  error estimate for blocks of size 2^( 4) =       0.000446022182
  error estimate for blocks of size 2^( 5) =       0.000456274207
  error estimate for blocks of size 2^( 6) =       0.000465063959
  error estimate for blocks of size 2^( 7) =       0.000470905506

      target function =                  N/A
              le_mean =     -16.909906911414
             les_mean =     286.279204142862
             stat err =       0.000459566464
             autocorr =       1.263723072841
              std dev =       0.578145792427
             le_variance =       0.334252557301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334265138656
                                         uncertainty =       0.009782775886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334265138656
                                         uncertainty =       0.009782775886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408901245
  error estimate for blocks of size 2^( 2) =       0.000420977865
  error estimate for blocks of size 2^( 3) =       0.000433400461
  error estimate for blocks of size 2^( 4) =       0.000446097819
  error estimate for blocks of size 2^( 5) =       0.000456346402
  error estimate for blocks of size 2^( 6) =       0.000465136119
  error estimate for blocks of size 2^( 7) =       0.000470977946

      target function =                  N/A
              le_mean =     -16.909907559084
             les_mean =     286.279373945268
             stat err =       0.000459639572
             autocorr =       1.263566076486
              std dev =       0.578273685821
             le_variance =       0.334400455713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334203257500
                                         uncertainty =       0.009780907233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334203257500
                                         uncertainty =       0.009780907233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408863419
  error estimate for blocks of size 2^( 2) =       0.000420942027
  error estimate for blocks of size 2^( 3) =       0.000433366652
  error estimate for blocks of size 2^( 4) =       0.000446066398
  error estimate for blocks of size 2^( 5) =       0.000456316762
  error estimate for blocks of size 2^( 6) =       0.000465106592
  error estimate for blocks of size 2^( 7) =       0.000470948069

      target function =                  N/A
              le_mean =     -16.909907302157
             les_mean =     286.279303390913
             stat err =       0.000459609455
             autocorr =       1.263634276204
              std dev =       0.578220192091
             le_variance =       0.334338590542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334128381735
                                         uncertainty =       0.009778563294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334128381735
                                         uncertainty =       0.009778563294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408817660
  error estimate for blocks of size 2^( 2) =       0.000420898883
  error estimate for blocks of size 2^( 3) =       0.000433325690
  error estimate for blocks of size 2^( 4) =       0.000446027940
  error estimate for blocks of size 2^( 5) =       0.000456279756
  error estimate for blocks of size 2^( 6) =       0.000465069521
  error estimate for blocks of size 2^( 7) =       0.000470911056

      target function =                  N/A
              le_mean =     -16.909906957941
             les_mean =     286.279216917777
             stat err =       0.000459572068
             autocorr =       1.263711547864
              std dev =       0.578155479692
             le_variance =       0.334263758698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909906911414        initial
     9.7656e-01     9.7656e+00             5.1954e-04       -16.909907559084  <--
     3.9062e+00     3.9062e+01             1.3914e-04       -16.909907302157
     1.5625e+01     1.5625e+02             3.5437e-05       -16.909906957941

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.7675e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.069057e-01 1 1  ON 0
 uu_1                 1.412442e-01 1 1  ON 1
 uu_2                 4.272941e-02 1 1  ON 2
 uu_3                -1.931931e-02 1 1  ON 3
 uu_4                -6.557116e-02 1 1  ON 4
 uu_5                -9.828710e-02 1 1  ON 5
 uu_6                -1.233089e-01 1 1  ON 6
 uu_7                -1.335849e-01 1 1  ON 7
 uu_8                -1.243813e-01 1 1  ON 8
 uu_9                -9.601791e-02 1 1  ON 9
 ud_0                 4.253209e-01 1 1  ON 10
 ud_1                 1.698583e-01 1 1  ON 11
 ud_2                 5.959257e-02 1 1  ON 12
 ud_3                -5.794819e-03 1 1  ON 13
 ud_4                -5.930699e-02 1 1  ON 14
 ud_5                -1.003625e-01 1 1  ON 15
 ud_6                -1.286641e-01 1 1  ON 16
 ud_7                -1.469206e-01 1 1  ON 17
 ud_8                -1.503858e-01 1 1  ON 18
 ud_9                -1.372902e-01 1 1  ON 19
 eO_0                -7.405049e-01 1 1  ON 20
 eO_1                -4.292599e-01 1 1  ON 21
 eO_2                -2.047931e-02 1 1  ON 22
 eO_3                 2.917263e-01 1 1  ON 23
 eO_4                 5.084213e-01 1 1  ON 24
 eO_5                 4.660488e-01 1 1  ON 25
 eO_6                 2.408618e-01 1 1  ON 26
 eO_7                -5.304612e-02 1 1  ON 27
 eO_8                -2.034631e-01 1 1  ON 28
 eO_9                -6.279785e-02 1 1  ON 29
eH1_0                -2.311560e-01 1 1  ON 30
eH1_1                -1.306326e-01 1 1  ON 31
eH1_2                -8.805932e-02 1 1  ON 32
eH1_3                -3.787043e-02 1 1  ON 33
eH1_4                 1.271708e-02 1 1  ON 34
eH1_5                 4.533172e-02 1 1  ON 35
eH1_6                 9.765569e-02 1 1  ON 36
eH1_7                 1.417421e-01 1 1  ON 37
eH1_8                 1.534882e-01 1 1  ON 38
eH1_9                 4.032153e-02 1 1  ON 39
eH2_0                -2.286283e-01 1 1  ON 40
eH2_1                -1.291571e-01 1 1  ON 41
eH2_2                -8.641108e-02 1 1  ON 42
eH2_3                -3.576646e-02 1 1  ON 43
eH2_4                 1.470373e-02 1 1  ON 44
eH2_5                 4.780180e-02 1 1  ON 45
eH2_6                 1.028899e-01 1 1  ON 46
eH2_7                 1.509569e-01 1 1  ON 47
eH2_8                 1.616951e-01 1 1  ON 48
eH2_9                 2.062412e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8761e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.140651
====================================================
  Execution time = 2.4395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326387171108
                                         uncertainty =       0.003535300720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326387171108
                                         uncertainty =       0.003535300720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403929182
  error estimate for blocks of size 2^( 2) =       0.000415893837
  error estimate for blocks of size 2^( 3) =       0.000429394417
  error estimate for blocks of size 2^( 4) =       0.000441356065
  error estimate for blocks of size 2^( 5) =       0.000453489012
  error estimate for blocks of size 2^( 6) =       0.000462416223
  error estimate for blocks of size 2^( 7) =       0.000469379740

      target function =                  N/A
              le_mean =     -16.908926252723
             les_mean =     286.238104425613
             stat err =       0.000456660260
             autocorr =       1.278132793571
              std dev =       0.571242127958
             le_variance =       0.326317568754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690892625272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908926252723       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908927002906       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908929038670       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908930053297       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908931690592       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908931879796       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908931650516       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908931821202       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908931903168       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908932110459       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908932071682       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.501944e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908926252723       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908926523399       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908927174628       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908927507385       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908927822341       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908927852473       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908927841786       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908927893406       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908927862694       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.104133e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908926252723       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908926328825       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908926504183       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908926592148       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908926655851       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908926669615       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908926681470       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908926685829       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.040780e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0883e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.069575e-01 1 1  ON 0
 uu_1                 1.412954e-01 1 1  ON 1
 uu_2                 4.271951e-02 1 1  ON 2
 uu_3                -1.937766e-02 1 1  ON 3
 uu_4                -6.564987e-02 1 1  ON 4
 uu_5                -9.839309e-02 1 1  ON 5
 uu_6                -1.233373e-01 1 1  ON 6
 uu_7                -1.336047e-01 1 1  ON 7
 uu_8                -1.244435e-01 1 1  ON 8
 uu_9                -9.600643e-02 1 1  ON 9
 ud_0                 4.255854e-01 1 1  ON 10
 ud_1                 1.699344e-01 1 1  ON 11
 ud_2                 5.967797e-02 1 1  ON 12
 ud_3                -5.838989e-03 1 1  ON 13
 ud_4                -5.940675e-02 1 1  ON 14
 ud_5                -1.004616e-01 1 1  ON 15
 ud_6                -1.288732e-01 1 1  ON 16
 ud_7                -1.469388e-01 1 1  ON 17
 ud_8                -1.503446e-01 1 1  ON 18
 ud_9                -1.373068e-01 1 1  ON 19
 eO_0                -7.408719e-01 1 1  ON 20
 eO_1                -4.295709e-01 1 1  ON 21
 eO_2                -2.060472e-02 1 1  ON 22
 eO_3                 2.919532e-01 1 1  ON 23
 eO_4                 5.088317e-01 1 1  ON 24
 eO_5                 4.663048e-01 1 1  ON 25
 eO_6                 2.409557e-01 1 1  ON 26
 eO_7                -5.295636e-02 1 1  ON 27
 eO_8                -2.036108e-01 1 1  ON 28
 eO_9                -6.290723e-02 1 1  ON 29
eH1_0                -2.312758e-01 1 1  ON 30
eH1_1                -1.307223e-01 1 1  ON 31
eH1_2                -8.833091e-02 1 1  ON 32
eH1_3                -3.790782e-02 1 1  ON 33
eH1_4                 1.260761e-02 1 1  ON 34
eH1_5                 4.526289e-02 1 1  ON 35
eH1_6                 9.772488e-02 1 1  ON 36
eH1_7                 1.419102e-01 1 1  ON 37
eH1_8                 1.537288e-01 1 1  ON 38
eH1_9                 4.053021e-02 1 1  ON 39
eH2_0                -2.289326e-01 1 1  ON 40
eH2_1                -1.293044e-01 1 1  ON 41
eH2_2                -8.651294e-02 1 1  ON 42
eH2_3                -3.584101e-02 1 1  ON 43
eH2_4                 1.478521e-02 1 1  ON 44
eH2_5                 4.787322e-02 1 1  ON 45
eH2_6                 1.030475e-01 1 1  ON 46
eH2_7                 1.509518e-01 1 1  ON 47
eH2_8                 1.617861e-01 1 1  ON 48
eH2_9                 2.083219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8434
    reference variance = 0.206116
====================================================
  Execution time = 2.3966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3201e-01
  Total weights = 2.0000e+06
  Execution time = 2.7011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331869618567
                                         uncertainty =       0.008505654308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331869618567
                                         uncertainty =       0.008505654308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318996
  error estimate for blocks of size 2^( 2) =       0.000419556767
  error estimate for blocks of size 2^( 3) =       0.000432105076
  error estimate for blocks of size 2^( 4) =       0.000443791855
  error estimate for blocks of size 2^( 5) =       0.000455145396
  error estimate for blocks of size 2^( 6) =       0.000462538263
  error estimate for blocks of size 2^( 7) =       0.000468133658

      target function =                  N/A
              le_mean =     -16.911069392729
             les_mean =     286.316085368116
             stat err =       0.000457402293
             autocorr =       1.261035597937
              std dev =       0.576036047761
             le_variance =       0.331817528321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332427774593
                                         uncertainty =       0.008512254150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332427774593
                                         uncertainty =       0.008512254150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407661394
  error estimate for blocks of size 2^( 2) =       0.000419888367
  error estimate for blocks of size 2^( 3) =       0.000432420123
  error estimate for blocks of size 2^( 4) =       0.000444089282
  error estimate for blocks of size 2^( 5) =       0.000455424477
  error estimate for blocks of size 2^( 6) =       0.000462802693
  error estimate for blocks of size 2^( 7) =       0.000468405386

      target function =                  N/A
              le_mean =     -16.911071300812
             les_mean =     286.316707998981
             stat err =       0.000457680460
             autocorr =       1.260449853154
              std dev =       0.576520271993
             le_variance =       0.332375624019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332264790950
                                         uncertainty =       0.008509548702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332264790950
                                         uncertainty =       0.008509548702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407561436
  error estimate for blocks of size 2^( 2) =       0.000419791217
  error estimate for blocks of size 2^( 3) =       0.000432328725
  error estimate for blocks of size 2^( 4) =       0.000444004359
  error estimate for blocks of size 2^( 5) =       0.000455345215
  error estimate for blocks of size 2^( 6) =       0.000462729572
  error estimate for blocks of size 2^( 7) =       0.000468330053

      target function =                  N/A
              le_mean =     -16.911070770239
             les_mean =     286.316527078293
             stat err =       0.000457602300
             autocorr =       1.260637521490
              std dev =       0.576378910402
             le_variance =       0.332212648356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331929694924
                                         uncertainty =       0.008506104491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331929694924
                                         uncertainty =       0.008506104491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407355861
  error estimate for blocks of size 2^( 2) =       0.000419592357
  error estimate for blocks of size 2^( 3) =       0.000432139097
  error estimate for blocks of size 2^( 4) =       0.000443824257
  error estimate for blocks of size 2^( 5) =       0.000455175932
  error estimate for blocks of size 2^( 6) =       0.000462567642
  error estimate for blocks of size 2^( 7) =       0.000468163711

      target function =                  N/A
              le_mean =     -16.911069575294
             les_mean =     286.316151608776
             stat err =       0.000457432886
             autocorr =       1.260976025812
              std dev =       0.576088182741
             le_variance =       0.331877594294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911069392729        initial
     2.4414e-01     2.4414e+00             1.5019e-03       -16.911071300812  <--
     9.7656e-01     9.7656e+00             4.1041e-04       -16.911070770239
     3.9062e+00     3.9062e+01             1.0408e-04       -16.911069575294

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.7596e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.071272e-01 1 1  ON 0
 uu_1                 1.414055e-01 1 1  ON 1
 uu_2                 4.272670e-02 1 1  ON 2
 uu_3                -1.949679e-02 1 1  ON 3
 uu_4                -6.588096e-02 1 1  ON 4
 uu_5                -9.867788e-02 1 1  ON 5
 uu_6                -1.235008e-01 1 1  ON 6
 uu_7                -1.336975e-01 1 1  ON 7
 uu_8                -1.246246e-01 1 1  ON 8
 uu_9                -9.597755e-02 1 1  ON 9
 ud_0                 4.261001e-01 1 1  ON 10
 ud_1                 1.702042e-01 1 1  ON 11
 ud_2                 5.987730e-02 1 1  ON 12
 ud_3                -5.873570e-03 1 1  ON 13
 ud_4                -5.963082e-02 1 1  ON 14
 ud_5                -1.007358e-01 1 1  ON 15
 ud_6                -1.292745e-01 1 1  ON 16
 ud_7                -1.470668e-01 1 1  ON 17
 ud_8                -1.502834e-01 1 1  ON 18
 ud_9                -1.373529e-01 1 1  ON 19
 eO_0                -7.418781e-01 1 1  ON 20
 eO_1                -4.303988e-01 1 1  ON 21
 eO_2                -2.095005e-02 1 1  ON 22
 eO_3                 2.924570e-01 1 1  ON 23
 eO_4                 5.099232e-01 1 1  ON 24
 eO_5                 4.671161e-01 1 1  ON 25
 eO_6                 2.412947e-01 1 1  ON 26
 eO_7                -5.269513e-02 1 1  ON 27
 eO_8                -2.040576e-01 1 1  ON 28
 eO_9                -6.323766e-02 1 1  ON 29
eH1_0                -2.316587e-01 1 1  ON 30
eH1_1                -1.310818e-01 1 1  ON 31
eH1_2                -8.891650e-02 1 1  ON 32
eH1_3                -3.813640e-02 1 1  ON 33
eH1_4                 1.229981e-02 1 1  ON 34
eH1_5                 4.504122e-02 1 1  ON 35
eH1_6                 9.790999e-02 1 1  ON 36
eH1_7                 1.424144e-01 1 1  ON 37
eH1_8                 1.544560e-01 1 1  ON 38
eH1_9                 4.116630e-02 1 1  ON 39
eH2_0                -2.296891e-01 1 1  ON 40
eH2_1                -1.297119e-01 1 1  ON 41
eH2_2                -8.683111e-02 1 1  ON 42
eH2_3                -3.605653e-02 1 1  ON 43
eH2_4                 1.489765e-02 1 1  ON 44
eH2_5                 4.802292e-02 1 1  ON 45
eH2_6                 1.034796e-01 1 1  ON 46
eH2_7                 1.509723e-01 1 1  ON 47
eH2_8                 1.620669e-01 1 1  ON 48
eH2_9                 2.146164e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.322875
====================================================
  Execution time = 2.4700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3508e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335207293509
                                         uncertainty =       0.004949543727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335207293509
                                         uncertainty =       0.004949543727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409313880
  error estimate for blocks of size 2^( 2) =       0.000421251292
  error estimate for blocks of size 2^( 3) =       0.000433804583
  error estimate for blocks of size 2^( 4) =       0.000445736555
  error estimate for blocks of size 2^( 5) =       0.000456762411
  error estimate for blocks of size 2^( 6) =       0.000464747184
  error estimate for blocks of size 2^( 7) =       0.000470718628

      target function =                  N/A
              le_mean =     -16.909484862066
             les_mean =     286.265753837760
             stat err =       0.000459491195
             autocorr =       1.260205707862
              std dev =       0.578857240479
             le_variance =       0.335075704855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690948486207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909484862066       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909486798660       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909485876014       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909489959392       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909491098618       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909493019869       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909497725975       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909499865283       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909499500188       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909500779999       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909501710619       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909501217180       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909500463747       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909500049064       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.433879e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909484862066       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909485881650       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909485043109       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909486597605       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909487736886       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909488816421       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909489499521       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909489163154       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909489111894       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909489578581       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.353735e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909484862066       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909485214367       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909484954962       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909485474590       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909485830762       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909486218002       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909486221139       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909486043751       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.121373e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1061e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073079e-01 1 1  ON 0
 uu_1                 1.415916e-01 1 1  ON 1
 uu_2                 4.279326e-02 1 1  ON 2
 uu_3                -1.956247e-02 1 1  ON 3
 uu_4                -6.620882e-02 1 1  ON 4
 uu_5                -9.905007e-02 1 1  ON 5
 uu_6                -1.236762e-01 1 1  ON 6
 uu_7                -1.339362e-01 1 1  ON 7
 uu_8                -1.248269e-01 1 1  ON 8
 uu_9                -9.604610e-02 1 1  ON 9
 ud_0                 4.265219e-01 1 1  ON 10
 ud_1                 1.706745e-01 1 1  ON 11
 ud_2                 6.011250e-02 1 1  ON 12
 ud_3                -5.814035e-03 1 1  ON 13
 ud_4                -5.971939e-02 1 1  ON 14
 ud_5                -1.010926e-01 1 1  ON 15
 ud_6                -1.295144e-01 1 1  ON 16
 ud_7                -1.474886e-01 1 1  ON 17
 ud_8                -1.504511e-01 1 1  ON 18
 ud_9                -1.375216e-01 1 1  ON 19
 eO_0                -7.432319e-01 1 1  ON 20
 eO_1                -4.310999e-01 1 1  ON 21
 eO_2                -2.100947e-02 1 1  ON 22
 eO_3                 2.929442e-01 1 1  ON 23
 eO_4                 5.108127e-01 1 1  ON 24
 eO_5                 4.681100e-01 1 1  ON 25
 eO_6                 2.418112e-01 1 1  ON 26
 eO_7                -5.227407e-02 1 1  ON 27
 eO_8                -2.046807e-01 1 1  ON 28
 eO_9                -6.376441e-02 1 1  ON 29
eH1_0                -2.328447e-01 1 1  ON 30
eH1_1                -1.319150e-01 1 1  ON 31
eH1_2                -8.947591e-02 1 1  ON 32
eH1_3                -3.853841e-02 1 1  ON 33
eH1_4                 1.214977e-02 1 1  ON 34
eH1_5                 4.476362e-02 1 1  ON 35
eH1_6                 9.878140e-02 1 1  ON 36
eH1_7                 1.435919e-01 1 1  ON 37
eH1_8                 1.552083e-01 1 1  ON 38
eH1_9                 4.177037e-02 1 1  ON 39
eH2_0                -2.308409e-01 1 1  ON 40
eH2_1                -1.300669e-01 1 1  ON 41
eH2_2                -8.703437e-02 1 1  ON 42
eH2_3                -3.611195e-02 1 1  ON 43
eH2_4                 1.476586e-02 1 1  ON 44
eH2_5                 4.824171e-02 1 1  ON 45
eH2_6                 1.035287e-01 1 1  ON 46
eH2_7                 1.507692e-01 1 1  ON 47
eH2_8                 1.628213e-01 1 1  ON 48
eH2_9                 2.243443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8328
    reference variance = 0.293273
====================================================
  Execution time = 2.6192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4860e-01
  Total weights = 2.0000e+06
  Execution time = 2.7071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348477402655
                                         uncertainty =       0.018703284024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348477402655
                                         uncertainty =       0.018703284024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417405367
  error estimate for blocks of size 2^( 2) =       0.000428704842
  error estimate for blocks of size 2^( 3) =       0.000440760039
  error estimate for blocks of size 2^( 4) =       0.000451361908
  error estimate for blocks of size 2^( 5) =       0.000460692223
  error estimate for blocks of size 2^( 6) =       0.000466623862
  error estimate for blocks of size 2^( 7) =       0.000470231872

      target function =                  N/A
              le_mean =     -16.910633897129
             les_mean =     286.317993108594
             stat err =       0.000462227466
             autocorr =       1.226296362105
              std dev =       0.590300330428
             le_variance =       0.348454480103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349103825852
                                         uncertainty =       0.018720761346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349103825852
                                         uncertainty =       0.018720761346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417780198
  error estimate for blocks of size 2^( 2) =       0.000429066516
  error estimate for blocks of size 2^( 3) =       0.000441096812
  error estimate for blocks of size 2^( 4) =       0.000451670181
  error estimate for blocks of size 2^( 5) =       0.000460988083
  error estimate for blocks of size 2^( 6) =       0.000466889702
  error estimate for blocks of size 2^( 7) =       0.000470483480

      target function =                  N/A
              le_mean =     -16.910638834256
             les_mean =     286.318786196229
             stat err =       0.000462507861
             autocorr =       1.225582454187
              std dev =       0.590830422472
             le_variance =       0.349080588118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348784862037
                                         uncertainty =       0.018711571010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348784862037
                                         uncertainty =       0.018711571010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417589295
  error estimate for blocks of size 2^( 2) =       0.000428880832
  error estimate for blocks of size 2^( 3) =       0.000440919841
  error estimate for blocks of size 2^( 4) =       0.000451508577
  error estimate for blocks of size 2^( 5) =       0.000460836467
  error estimate for blocks of size 2^( 6) =       0.000466748376
  error estimate for blocks of size 2^( 7) =       0.000470346821

      target function =                  N/A
              le_mean =     -16.910638980442
             les_mean =     286.318472191546
             stat err =       0.000462360060
             autocorr =       1.225919374156
              std dev =       0.590560444905
             le_variance =       0.348761639086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348503738395
                                         uncertainty =       0.018703020907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348503738395
                                         uncertainty =       0.018703020907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417421108
  error estimate for blocks of size 2^( 2) =       0.000428719375
  error estimate for blocks of size 2^( 3) =       0.000440771920
  error estimate for blocks of size 2^( 4) =       0.000451372448
  error estimate for blocks of size 2^( 5) =       0.000460703107
  error estimate for blocks of size 2^( 6) =       0.000466632150
  error estimate for blocks of size 2^( 7) =       0.000470238722

      target function =                  N/A
              le_mean =     -16.910634666910
             les_mean =     286.318045426169
             stat err =       0.000462236607
             autocorr =       1.226252371189
              std dev =       0.590322592064
             le_variance =       0.348480762702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910633897129        initial
     6.1035e-02     6.1035e-01             4.4339e-03       -16.910638834256
     2.4414e-01     2.4414e+00             1.3537e-03       -16.910638980442  <--
     9.7656e-01     9.7656e+00             4.1214e-04       -16.910634666910

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.9932e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073079e-01 1 1  ON 0
 uu_1                 1.415916e-01 1 1  ON 1
 uu_2                 4.279326e-02 1 1  ON 2
 uu_3                -1.956247e-02 1 1  ON 3
 uu_4                -6.620882e-02 1 1  ON 4
 uu_5                -9.905007e-02 1 1  ON 5
 uu_6                -1.236762e-01 1 1  ON 6
 uu_7                -1.339362e-01 1 1  ON 7
 uu_8                -1.248269e-01 1 1  ON 8
 uu_9                -9.604610e-02 1 1  ON 9
 ud_0                 4.265219e-01 1 1  ON 10
 ud_1                 1.706745e-01 1 1  ON 11
 ud_2                 6.011250e-02 1 1  ON 12
 ud_3                -5.814035e-03 1 1  ON 13
 ud_4                -5.971939e-02 1 1  ON 14
 ud_5                -1.010926e-01 1 1  ON 15
 ud_6                -1.295144e-01 1 1  ON 16
 ud_7                -1.474886e-01 1 1  ON 17
 ud_8                -1.504511e-01 1 1  ON 18
 ud_9                -1.375216e-01 1 1  ON 19
 eO_0                -7.432319e-01 1 1  ON 20
 eO_1                -4.310999e-01 1 1  ON 21
 eO_2                -2.100947e-02 1 1  ON 22
 eO_3                 2.929442e-01 1 1  ON 23
 eO_4                 5.108127e-01 1 1  ON 24
 eO_5                 4.681100e-01 1 1  ON 25
 eO_6                 2.418112e-01 1 1  ON 26
 eO_7                -5.227407e-02 1 1  ON 27
 eO_8                -2.046807e-01 1 1  ON 28
 eO_9                -6.376441e-02 1 1  ON 29
eH1_0                -2.328447e-01 1 1  ON 30
eH1_1                -1.319150e-01 1 1  ON 31
eH1_2                -8.947591e-02 1 1  ON 32
eH1_3                -3.853841e-02 1 1  ON 33
eH1_4                 1.214977e-02 1 1  ON 34
eH1_5                 4.476362e-02 1 1  ON 35
eH1_6                 9.878140e-02 1 1  ON 36
eH1_7                 1.435919e-01 1 1  ON 37
eH1_8                 1.552083e-01 1 1  ON 38
eH1_9                 4.177037e-02 1 1  ON 39
eH2_0                -2.308409e-01 1 1  ON 40
eH2_1                -1.300669e-01 1 1  ON 41
eH2_2                -8.703437e-02 1 1  ON 42
eH2_3                -3.611195e-02 1 1  ON 43
eH2_4                 1.476586e-02 1 1  ON 44
eH2_5                 4.824171e-02 1 1  ON 45
eH2_6                 1.035287e-01 1 1  ON 46
eH2_7                 1.507692e-01 1 1  ON 47
eH2_8                 1.628213e-01 1 1  ON 48
eH2_9                 2.243443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0999e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.262409
====================================================
  Execution time = 2.4405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333527124532
                                         uncertainty =       0.005067423134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333527124532
                                         uncertainty =       0.005067423134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408319477
  error estimate for blocks of size 2^( 2) =       0.000420328205
  error estimate for blocks of size 2^( 3) =       0.000433236927
  error estimate for blocks of size 2^( 4) =       0.000445996283
  error estimate for blocks of size 2^( 5) =       0.000456873081
  error estimate for blocks of size 2^( 6) =       0.000463697229
  error estimate for blocks of size 2^( 7) =       0.000470151834

      target function =                  N/A
              le_mean =     -16.909885463432
             les_mean =     286.277675809838
             stat err =       0.000459179607
             autocorr =       1.264634401044
              std dev =       0.577450941789
             le_variance =       0.333449590173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690988546343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909885463432       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909886514348       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909888828400       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909885404687       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909888500816       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909894826602       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909894066391       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909894724901       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909897785273       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909897194026       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909898363294       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909899325303       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909899082877       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909898916868       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.015276e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909885463432       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909886060319       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909887636161       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909885818689       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909887243835       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909888751045       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909888809499       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909888689223       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909889366316       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909889258637       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909889258774       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.213518e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909885463432       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909885682222       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909886375626       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909886182894       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909885881086       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909886266209       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909886514039       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909886521642       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909886606770       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.266381e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0753e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.072080e-01 1 1  ON 0
 uu_1                 1.414917e-01 1 1  ON 1
 uu_2                 4.263616e-02 1 1  ON 2
 uu_3                -1.967559e-02 1 1  ON 3
 uu_4                -6.626569e-02 1 1  ON 4
 uu_5                -9.925867e-02 1 1  ON 5
 uu_6                -1.238665e-01 1 1  ON 6
 uu_7                -1.339387e-01 1 1  ON 7
 uu_8                -1.248990e-01 1 1  ON 8
 uu_9                -9.617000e-02 1 1  ON 9
 ud_0                 4.270495e-01 1 1  ON 10
 ud_1                 1.711681e-01 1 1  ON 11
 ud_2                 6.054022e-02 1 1  ON 12
 ud_3                -5.660703e-03 1 1  ON 13
 ud_4                -5.985080e-02 1 1  ON 14
 ud_5                -1.013171e-01 1 1  ON 15
 ud_6                -1.298286e-01 1 1  ON 16
 ud_7                -1.476321e-01 1 1  ON 17
 ud_8                -1.507668e-01 1 1  ON 18
 ud_9                -1.379801e-01 1 1  ON 19
 eO_0                -7.443778e-01 1 1  ON 20
 eO_1                -4.319863e-01 1 1  ON 21
 eO_2                -2.142298e-02 1 1  ON 22
 eO_3                 2.935215e-01 1 1  ON 23
 eO_4                 5.120262e-01 1 1  ON 24
 eO_5                 4.689817e-01 1 1  ON 25
 eO_6                 2.421200e-01 1 1  ON 26
 eO_7                -5.172889e-02 1 1  ON 27
 eO_8                -2.051642e-01 1 1  ON 28
 eO_9                -6.430609e-02 1 1  ON 29
eH1_0                -2.335351e-01 1 1  ON 30
eH1_1                -1.325862e-01 1 1  ON 31
eH1_2                -8.978504e-02 1 1  ON 32
eH1_3                -3.910324e-02 1 1  ON 33
eH1_4                 1.159020e-02 1 1  ON 34
eH1_5                 4.453483e-02 1 1  ON 35
eH1_6                 9.914787e-02 1 1  ON 36
eH1_7                 1.443334e-01 1 1  ON 37
eH1_8                 1.562081e-01 1 1  ON 38
eH1_9                 4.261577e-02 1 1  ON 39
eH2_0                -2.317189e-01 1 1  ON 40
eH2_1                -1.302817e-01 1 1  ON 41
eH2_2                -8.730967e-02 1 1  ON 42
eH2_3                -3.634780e-02 1 1  ON 43
eH2_4                 1.461902e-02 1 1  ON 44
eH2_5                 4.814565e-02 1 1  ON 45
eH2_6                 1.038275e-01 1 1  ON 46
eH2_7                 1.508314e-01 1 1  ON 47
eH2_8                 1.633026e-01 1 1  ON 48
eH2_9                 2.340860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8938
    reference variance = 0.220751
====================================================
  Execution time = 2.4178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4288e-01
  Total weights = 2.0000e+06
  Execution time = 2.7223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342770653672
                                         uncertainty =       0.012106743904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342770653672
                                         uncertainty =       0.012106743904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413979056
  error estimate for blocks of size 2^( 2) =       0.000426158344
  error estimate for blocks of size 2^( 3) =       0.000438588255
  error estimate for blocks of size 2^( 4) =       0.000451016137
  error estimate for blocks of size 2^( 5) =       0.000461546844
  error estimate for blocks of size 2^( 6) =       0.000469319440
  error estimate for blocks of size 2^( 7) =       0.000476049932

      target function =                  N/A
              le_mean =     -16.909593012172
             les_mean =     286.277092983626
             stat err =       0.000464483088
             autocorr =       1.258876342817
              std dev =       0.585454795602
             le_variance =       0.342757317694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304920131
                                         uncertainty =       0.012179173981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304920131
                                         uncertainty =       0.012179173981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414301420
  error estimate for blocks of size 2^( 2) =       0.000426481188
  error estimate for blocks of size 2^( 3) =       0.000438892075
  error estimate for blocks of size 2^( 4) =       0.000451298016
  error estimate for blocks of size 2^( 5) =       0.000461798005
  error estimate for blocks of size 2^( 6) =       0.000469569641
  error estimate for blocks of size 2^( 7) =       0.000476269801

      target function =                  N/A
              le_mean =     -16.909600296912
             les_mean =     286.277873363055
             stat err =       0.000464733866
             autocorr =       1.258275669464
              std dev =       0.585910687213
             le_variance =       0.343291333391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343022305379
                                         uncertainty =       0.012157893480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343022305379
                                         uncertainty =       0.012157893480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414130891
  error estimate for blocks of size 2^( 2) =       0.000426315811
  error estimate for blocks of size 2^( 3) =       0.000438739175
  error estimate for blocks of size 2^( 4) =       0.000451158770
  error estimate for blocks of size 2^( 5) =       0.000461668442
  error estimate for blocks of size 2^( 6) =       0.000469446171
  error estimate for blocks of size 2^( 7) =       0.000476151931

      target function =                  N/A
              le_mean =     -16.909599153542
             les_mean =     286.277552151146
             stat err =       0.000464606328
             autocorr =       1.258621045348
              std dev =       0.585669522149
             le_variance =       0.343008789174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342790567334
                                         uncertainty =       0.012113244305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342790567334
                                         uncertainty =       0.012113244305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991068
  error estimate for blocks of size 2^( 2) =       0.000426171571
  error estimate for blocks of size 2^( 3) =       0.000438601110
  error estimate for blocks of size 2^( 4) =       0.000451028355
  error estimate for blocks of size 2^( 5) =       0.000461555949
  error estimate for blocks of size 2^( 6) =       0.000469329878
  error estimate for blocks of size 2^( 7) =       0.000476055969

      target function =                  N/A
              le_mean =     -16.909593795706
             les_mean =     286.277139373265
             stat err =       0.000464492538
             autocorr =       1.258854509153
              std dev =       0.585471783149
             le_variance =       0.342777208863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909593012172        initial
     6.1035e-02     6.1035e-01             4.0153e-03       -16.909600296912  <--
     2.4414e-01     2.4414e+00             1.2135e-03       -16.909599153542
     9.7656e-01     9.7656e+00             3.2664e-04       -16.909593795706

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 3.7889e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.071758e-01 1 1  ON 0
 uu_1                 1.414891e-01 1 1  ON 1
 uu_2                 4.250355e-02 1 1  ON 2
 uu_3                -1.992643e-02 1 1  ON 3
 uu_4                -6.670977e-02 1 1  ON 4
 uu_5                -9.988673e-02 1 1  ON 5
 uu_6                -1.244857e-01 1 1  ON 6
 uu_7                -1.344699e-01 1 1  ON 7
 uu_8                -1.252945e-01 1 1  ON 8
 uu_9                -9.653252e-02 1 1  ON 9
 ud_0                 4.282451e-01 1 1  ON 10
 ud_1                 1.722466e-01 1 1  ON 11
 ud_2                 6.141496e-02 1 1  ON 12
 ud_3                -5.167510e-03 1 1  ON 13
 ud_4                -5.985699e-02 1 1  ON 14
 ud_5                -1.016296e-01 1 1  ON 15
 ud_6                -1.304360e-01 1 1  ON 16
 ud_7                -1.481447e-01 1 1  ON 17
 ud_8                -1.515983e-01 1 1  ON 18
 ud_9                -1.392602e-01 1 1  ON 19
 eO_0                -7.468566e-01 1 1  ON 20
 eO_1                -4.339841e-01 1 1  ON 21
 eO_2                -2.239376e-02 1 1  ON 22
 eO_3                 2.943955e-01 1 1  ON 23
 eO_4                 5.144550e-01 1 1  ON 24
 eO_5                 4.715048e-01 1 1  ON 25
 eO_6                 2.434435e-01 1 1  ON 26
 eO_7                -5.023437e-02 1 1  ON 27
 eO_8                -2.065928e-01 1 1  ON 28
 eO_9                -6.593297e-02 1 1  ON 29
eH1_0                -2.353564e-01 1 1  ON 30
eH1_1                -1.343408e-01 1 1  ON 31
eH1_2                -9.120834e-02 1 1  ON 32
eH1_3                -4.054811e-02 1 1  ON 33
eH1_4                 1.016808e-02 1 1  ON 34
eH1_5                 4.374607e-02 1 1  ON 35
eH1_6                 9.981576e-02 1 1  ON 36
eH1_7                 1.464738e-01 1 1  ON 37
eH1_8                 1.592235e-01 1 1  ON 38
eH1_9                 4.521147e-02 1 1  ON 39
eH2_0                -2.332888e-01 1 1  ON 40
eH2_1                -1.312997e-01 1 1  ON 41
eH2_2                -8.821364e-02 1 1  ON 42
eH2_3                -3.711375e-02 1 1  ON 43
eH2_4                 1.399685e-02 1 1  ON 44
eH2_5                 4.761824e-02 1 1  ON 45
eH2_6                 1.043558e-01 1 1  ON 46
eH2_7                 1.512410e-01 1 1  ON 47
eH2_8                 1.647532e-01 1 1  ON 48
eH2_9                 2.632461e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.17547
====================================================
  Execution time = 2.4473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335797042615
                                         uncertainty =       0.008372135829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335797042615
                                         uncertainty =       0.008372135829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409803456
  error estimate for blocks of size 2^( 2) =       0.000421696877
  error estimate for blocks of size 2^( 3) =       0.000433632256
  error estimate for blocks of size 2^( 4) =       0.000445330364
  error estimate for blocks of size 2^( 5) =       0.000455972798
  error estimate for blocks of size 2^( 6) =       0.000463050961
  error estimate for blocks of size 2^( 7) =       0.000464671642

      target function =                  N/A
              le_mean =     -16.910212315819
             les_mean =     286.291158142777
             stat err =       0.000457256441
             autocorr =       1.244997362113
              std dev =       0.579549604987
             le_variance =       0.335877744641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021231582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212315819       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910210698726       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910211005916       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910210968941       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910215259487       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910231478907       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910239488396       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910238685220       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910238839238       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910239391428       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910238184368       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910242241452       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910245271868       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910245587875       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910247607989       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910247470675       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910246651837       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910246289386       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910246511995       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.753696e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212315819       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910211097812       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910211395875       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212085326       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910214896317       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910220047445       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910225973788       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910223943887       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910222128243       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910222095715       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910222134660       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910222363224       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910222927464       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.530030e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212315819       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910211702883       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910211887392       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212363054       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212297631       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910213965151       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910215780804       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910215561265       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910215131360       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910214995248       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.168176e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0838e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.075342e-01 1 1  ON 0
 uu_1                 1.416596e-01 1 1  ON 1
 uu_2                 4.265312e-02 1 1  ON 2
 uu_3                -2.002114e-02 1 1  ON 3
 uu_4                -6.723287e-02 1 1  ON 4
 uu_5                -1.007141e-01 1 1  ON 5
 uu_6                -1.253868e-01 1 1  ON 6
 uu_7                -1.352391e-01 1 1  ON 7
 uu_8                -1.258274e-01 1 1  ON 8
 uu_9                -9.719451e-02 1 1  ON 9
 ud_0                 4.293525e-01 1 1  ON 10
 ud_1                 1.733230e-01 1 1  ON 11
 ud_2                 6.246135e-02 1 1  ON 12
 ud_3                -4.305354e-03 1 1  ON 13
 ud_4                -5.936293e-02 1 1  ON 14
 ud_5                -1.012763e-01 1 1  ON 15
 ud_6                -1.306843e-01 1 1  ON 16
 ud_7                -1.499367e-01 1 1  ON 17
 ud_8                -1.532105e-01 1 1  ON 18
 ud_9                -1.409600e-01 1 1  ON 19
 eO_0                -7.491592e-01 1 1  ON 20
 eO_1                -4.357838e-01 1 1  ON 21
 eO_2                -2.339398e-02 1 1  ON 22
 eO_3                 2.947944e-01 1 1  ON 23
 eO_4                 5.170296e-01 1 1  ON 24
 eO_5                 4.746084e-01 1 1  ON 25
 eO_6                 2.463409e-01 1 1  ON 26
 eO_7                -4.920900e-02 1 1  ON 27
 eO_8                -2.092658e-01 1 1  ON 28
 eO_9                -6.796618e-02 1 1  ON 29
eH1_0                -2.382603e-01 1 1  ON 30
eH1_1                -1.360227e-01 1 1  ON 31
eH1_2                -9.295425e-02 1 1  ON 32
eH1_3                -4.225558e-02 1 1  ON 33
eH1_4                 8.767098e-03 1 1  ON 34
eH1_5                 4.271055e-02 1 1  ON 35
eH1_6                 9.899482e-02 1 1  ON 36
eH1_7                 1.483390e-01 1 1  ON 37
eH1_8                 1.637536e-01 1 1  ON 38
eH1_9                 4.940068e-02 1 1  ON 39
eH2_0                -2.346018e-01 1 1  ON 40
eH2_1                -1.322329e-01 1 1  ON 41
eH2_2                -8.890021e-02 1 1  ON 42
eH2_3                -3.818888e-02 1 1  ON 43
eH2_4                 1.328844e-02 1 1  ON 44
eH2_5                 4.729802e-02 1 1  ON 45
eH2_6                 1.038179e-01 1 1  ON 46
eH2_7                 1.523117e-01 1 1  ON 47
eH2_8                 1.669662e-01 1 1  ON 48
eH2_9                 2.874250e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8189
    reference variance = 0.226508
====================================================
  Execution time = 2.4019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3084e-01
  Total weights = 2.0000e+06
  Execution time = 2.7030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330613713510
                                         uncertainty =       0.003439054376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330613713510
                                         uncertainty =       0.003439054376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406597677
  error estimate for blocks of size 2^( 2) =       0.000418875680
  error estimate for blocks of size 2^( 3) =       0.000432201768
  error estimate for blocks of size 2^( 4) =       0.000444954595
  error estimate for blocks of size 2^( 5) =       0.000455816220
  error estimate for blocks of size 2^( 6) =       0.000463198092
  error estimate for blocks of size 2^( 7) =       0.000469535659

      target function =                  N/A
              le_mean =     -16.909039217633
             les_mean =     286.246250440126
             stat err =       0.000458376142
             autocorr =       1.270908320186
              std dev =       0.575015949337
             le_variance =       0.330643341992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331383159611
                                         uncertainty =       0.003455314394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331383159611
                                         uncertainty =       0.003455314394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407070744
  error estimate for blocks of size 2^( 2) =       0.000419334795
  error estimate for blocks of size 2^( 3) =       0.000432617942
  error estimate for blocks of size 2^( 4) =       0.000445303574
  error estimate for blocks of size 2^( 5) =       0.000456090472
  error estimate for blocks of size 2^( 6) =       0.000463431936
  error estimate for blocks of size 2^( 7) =       0.000469799507

      target function =                  N/A
              le_mean =     -16.909044196440
             les_mean =     286.247188652163
             stat err =       0.000458656372
             autocorr =       1.269506948545
              std dev =       0.575684966548
             le_variance =       0.331413180709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331023699411
                                         uncertainty =       0.003449313935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331023699411
                                         uncertainty =       0.003449313935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406849735
  error estimate for blocks of size 2^( 2) =       0.000419127627
  error estimate for blocks of size 2^( 3) =       0.000432436619
  error estimate for blocks of size 2^( 4) =       0.000445153688
  error estimate for blocks of size 2^( 5) =       0.000455967097
  error estimate for blocks of size 2^( 6) =       0.000463325970
  error estimate for blocks of size 2^( 7) =       0.000469688947

      target function =                  N/A
              le_mean =     -16.909042045699
             les_mean =     286.246756152134
             stat err =       0.000458533925
             autocorr =       1.270208078260
              std dev =       0.575372413687
             le_variance =       0.331053414432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330633229667
                                         uncertainty =       0.003440326989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330633229667
                                         uncertainty =       0.003440326989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406609652
  error estimate for blocks of size 2^( 2) =       0.000418889789
  error estimate for blocks of size 2^( 3) =       0.000432216211
  error estimate for blocks of size 2^( 4) =       0.000444966609
  error estimate for blocks of size 2^( 5) =       0.000455820981
  error estimate for blocks of size 2^( 6) =       0.000463199346
  error estimate for blocks of size 2^( 7) =       0.000469540167

      target function =                  N/A
              le_mean =     -16.909038656804
             les_mean =     286.246250950653
             stat err =       0.000458381776
             autocorr =       1.270864704302
              std dev =       0.575032884872
             le_variance =       0.330662818685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909039217633        initial
     1.5259e-02     1.5259e-01             1.7537e-02       -16.909044196440  <--
     6.1035e-02     6.1035e-01             4.5300e-03       -16.909042045699
     2.4414e-01     2.4414e+00             1.1682e-03       -16.909038656804

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 3.7685e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.079943e-01 1 1  ON 0
 uu_1                 1.419014e-01 1 1  ON 1
 uu_2                 4.270981e-02 1 1  ON 2
 uu_3                -2.032538e-02 1 1  ON 3
 uu_4                -6.810147e-02 1 1  ON 4
 uu_5                -1.021914e-01 1 1  ON 5
 uu_6                -1.274794e-01 1 1  ON 6
 uu_7                -1.377523e-01 1 1  ON 7
 uu_8                -1.285244e-01 1 1  ON 8
 uu_9                -9.909162e-02 1 1  ON 9
 ud_0                 4.314568e-01 1 1  ON 10
 ud_1                 1.753198e-01 1 1  ON 11
 ud_2                 6.426698e-02 1 1  ON 12
 ud_3                -2.852622e-03 1 1  ON 13
 ud_4                -5.847558e-02 1 1  ON 14
 ud_5                -1.011031e-01 1 1  ON 15
 ud_6                -1.314729e-01 1 1  ON 16
 ud_7                -1.521248e-01 1 1  ON 17
 ud_8                -1.554058e-01 1 1  ON 18
 ud_9                -1.446564e-01 1 1  ON 19
 eO_0                -7.523970e-01 1 1  ON 20
 eO_1                -4.385598e-01 1 1  ON 21
 eO_2                -2.482553e-02 1 1  ON 22
 eO_3                 2.955675e-01 1 1  ON 23
 eO_4                 5.211584e-01 1 1  ON 24
 eO_5                 4.808848e-01 1 1  ON 25
 eO_6                 2.535171e-01 1 1  ON 26
 eO_7                -4.577254e-02 1 1  ON 27
 eO_8                -2.165658e-01 1 1  ON 28
 eO_9                -7.434939e-02 1 1  ON 29
eH1_0                -2.442936e-01 1 1  ON 30
eH1_1                -1.413878e-01 1 1  ON 31
eH1_2                -9.815770e-02 1 1  ON 32
eH1_3                -4.701870e-02 1 1  ON 33
eH1_4                 4.370828e-03 1 1  ON 34
eH1_5                 3.918399e-02 1 1  ON 35
eH1_6                 9.694490e-02 1 1  ON 36
eH1_7                 1.515072e-01 1 1  ON 37
eH1_8                 1.761054e-01 1 1  ON 38
eH1_9                 6.274843e-02 1 1  ON 39
eH2_0                -2.377981e-01 1 1  ON 40
eH2_1                -1.351716e-01 1 1  ON 41
eH2_2                -9.173945e-02 1 1  ON 42
eH2_3                -4.067291e-02 1 1  ON 43
eH2_4                 1.100765e-02 1 1  ON 44
eH2_5                 4.544126e-02 1 1  ON 45
eH2_6                 1.026811e-01 1 1  ON 46
eH2_7                 1.547437e-01 1 1  ON 47
eH2_8                 1.737137e-01 1 1  ON 48
eH2_9                 3.665296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8743
    reference variance = 0.20329
====================================================
  Execution time = 2.4616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5171e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351796551445
                                         uncertainty =       0.021795143114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351796551445
                                         uncertainty =       0.021795143114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419348933
  error estimate for blocks of size 2^( 2) =       0.000430979570
  error estimate for blocks of size 2^( 3) =       0.000443156125
  error estimate for blocks of size 2^( 4) =       0.000454559900
  error estimate for blocks of size 2^( 5) =       0.000464820493
  error estimate for blocks of size 2^( 6) =       0.000472706059
  error estimate for blocks of size 2^( 7) =       0.000475642810

      target function =                  N/A
              le_mean =     -16.909646209501
             les_mean =     286.287841809590
             stat err =       0.000466932316
             autocorr =       1.239814693621
              std dev =       0.593048948203
             le_variance =       0.351707054965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690964620950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646209501       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648175878       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909641840513       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909642298705       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909645036149       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909649128694       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909649345391       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909650500429       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909656403254       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909662609133       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909671310605       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909678543288       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909684226692       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909701192579       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909703665068       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909705973511       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909708846280       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909709037531       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909708791172       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909708751581       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909705247404       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909705197981       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909706619149       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.909706151406       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909705657246       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909705785902       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.909704598522       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 7.680130e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646209501       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648054257       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909642199676       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909642769228       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909645189618       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909648144670       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909648006054       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909649145535       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909653126261       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909656366841       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909660960536       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909661973326       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909661991085       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909666843511       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909667297445       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909667313833       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909667476182       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909666930725       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909666908257       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.852070e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909646209501       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909647688380       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909643161246       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909643773434       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909645648523       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909645588505       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909646326751       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909647210831       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909648370532       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909649629626       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909650365850       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909650078033       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909649655310       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909650247455       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.608205e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1088e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.076850e-01 1 1  ON 0
 uu_1                 1.414694e-01 1 1  ON 1
 uu_2                 4.175496e-02 1 1  ON 2
 uu_3                -2.209377e-02 1 1  ON 3
 uu_4                -7.038542e-02 1 1  ON 4
 uu_5                -1.047713e-01 1 1  ON 5
 uu_6                -1.311447e-01 1 1  ON 6
 uu_7                -1.427589e-01 1 1  ON 7
 uu_8                -1.320572e-01 1 1  ON 8
 uu_9                -9.703576e-02 1 1  ON 9
 ud_0                 4.322046e-01 1 1  ON 10
 ud_1                 1.757598e-01 1 1  ON 11
 ud_2                 6.451035e-02 1 1  ON 12
 ud_3                -2.966953e-03 1 1  ON 13
 ud_4                -5.891771e-02 1 1  ON 14
 ud_5                -1.021380e-01 1 1  ON 15
 ud_6                -1.323749e-01 1 1  ON 16
 ud_7                -1.513749e-01 1 1  ON 17
 ud_8                -1.561174e-01 1 1  ON 18
 ud_9                -1.441153e-01 1 1  ON 19
 eO_0                -7.547268e-01 1 1  ON 20
 eO_1                -4.409443e-01 1 1  ON 21
 eO_2                -2.607317e-02 1 1  ON 22
 eO_3                 2.970760e-01 1 1  ON 23
 eO_4                 5.241138e-01 1 1  ON 24
 eO_5                 4.867277e-01 1 1  ON 25
 eO_6                 2.583653e-01 1 1  ON 26
 eO_7                -4.166616e-02 1 1  ON 27
 eO_8                -2.219749e-01 1 1  ON 28
 eO_9                -8.082936e-02 1 1  ON 29
eH1_0                -2.487677e-01 1 1  ON 30
eH1_1                -1.471335e-01 1 1  ON 31
eH1_2                -1.032870e-01 1 1  ON 32
eH1_3                -5.106638e-02 1 1  ON 33
eH1_4                -2.763969e-05 1 1  ON 34
eH1_5                 3.423164e-02 1 1  ON 35
eH1_6                 9.571835e-02 1 1  ON 36
eH1_7                 1.555647e-01 1 1  ON 37
eH1_8                 1.861457e-01 1 1  ON 38
eH1_9                 7.584441e-02 1 1  ON 39
eH2_0                -2.439543e-01 1 1  ON 40
eH2_1                -1.415457e-01 1 1  ON 41
eH2_2                -9.803384e-02 1 1  ON 42
eH2_3                -4.518281e-02 1 1  ON 43
eH2_4                 6.040050e-03 1 1  ON 44
eH2_5                 4.025675e-02 1 1  ON 45
eH2_6                 1.007758e-01 1 1  ON 46
eH2_7                 1.571141e-01 1 1  ON 47
eH2_8                 1.861287e-01 1 1  ON 48
eH2_9                 5.517367e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.18935
====================================================
  Execution time = 2.4001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3609e-01
  Total weights = 2.0000e+06
  Execution time = 2.7140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074310956
                                         uncertainty =       0.005136779694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074310956
                                         uncertainty =       0.005136779694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409341428
  error estimate for blocks of size 2^( 2) =       0.000421244438
  error estimate for blocks of size 2^( 3) =       0.000433499231
  error estimate for blocks of size 2^( 4) =       0.000445411579
  error estimate for blocks of size 2^( 5) =       0.000456253213
  error estimate for blocks of size 2^( 6) =       0.000464830810
  error estimate for blocks of size 2^( 7) =       0.000470541997

      target function =                  N/A
              le_mean =     -16.910523775228
             les_mean =     286.300934995029
             stat err =       0.000459259400
             autocorr =       1.258765139514
              std dev =       0.578896199706
             le_variance =       0.335120810034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336871120886
                                         uncertainty =       0.005142377351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336871120886
                                         uncertainty =       0.005142377351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437211
  error estimate for blocks of size 2^( 2) =       0.000422330751
  error estimate for blocks of size 2^( 3) =       0.000434530747
  error estimate for blocks of size 2^( 4) =       0.000446360549
  error estimate for blocks of size 2^( 5) =       0.000457078003
  error estimate for blocks of size 2^( 6) =       0.000465544294
  error estimate for blocks of size 2^( 7) =       0.000471170466

      target function =                  N/A
              le_mean =     -16.910519456075
             les_mean =     286.302585514355
             stat err =       0.000460038328
             autocorr =       1.256303519452
              std dev =       0.580445870449
             le_variance =       0.336917408521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337078485240
                                         uncertainty =       0.005145542586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337078485240
                                         uncertainty =       0.005145542586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410563328
  error estimate for blocks of size 2^( 2) =       0.000422456748
  error estimate for blocks of size 2^( 3) =       0.000434662691
  error estimate for blocks of size 2^( 4) =       0.000446521875
  error estimate for blocks of size 2^( 5) =       0.000457278694
  error estimate for blocks of size 2^( 6) =       0.000465756675
  error estimate for blocks of size 2^( 7) =       0.000471411225

      target function =                  N/A
              le_mean =     -16.910510168275
             les_mean =     286.302478475672
             stat err =       0.000460242117
             autocorr =       1.256644420933
              std dev =       0.580624226921
             le_variance =       0.337124492888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335689326198
                                         uncertainty =       0.005141349682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335689326198
                                         uncertainty =       0.005141349682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716815
  error estimate for blocks of size 2^( 2) =       0.000421606347
  error estimate for blocks of size 2^( 3) =       0.000433840833
  error estimate for blocks of size 2^( 4) =       0.000445739014
  error estimate for blocks of size 2^( 5) =       0.000456563044
  error estimate for blocks of size 2^( 6) =       0.000465119961
  error estimate for blocks of size 2^( 7) =       0.000470828087

      target function =                  N/A
              le_mean =     -16.910512126144
             les_mean =     286.301155938319
             stat err =       0.000459562526
             autocorr =       1.258118763955
              std dev =       0.579427077131
             le_variance =       0.335735737712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910523775228        initial  <--
     3.8147e-03     3.8147e-02             7.6801e-02       -16.910519456075
     1.5259e-02     1.5259e-01             1.8521e-02       -16.910510168275
     6.1035e-02     6.1035e-01             4.6082e-03       -16.910512126144

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6875
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.079943e-01 1 1  ON 0
 uu_1                 1.419014e-01 1 1  ON 1
 uu_2                 4.270981e-02 1 1  ON 2
 uu_3                -2.032538e-02 1 1  ON 3
 uu_4                -6.810147e-02 1 1  ON 4
 uu_5                -1.021914e-01 1 1  ON 5
 uu_6                -1.274794e-01 1 1  ON 6
 uu_7                -1.377523e-01 1 1  ON 7
 uu_8                -1.285244e-01 1 1  ON 8
 uu_9                -9.909162e-02 1 1  ON 9
 ud_0                 4.314568e-01 1 1  ON 10
 ud_1                 1.753198e-01 1 1  ON 11
 ud_2                 6.426698e-02 1 1  ON 12
 ud_3                -2.852622e-03 1 1  ON 13
 ud_4                -5.847558e-02 1 1  ON 14
 ud_5                -1.011031e-01 1 1  ON 15
 ud_6                -1.314729e-01 1 1  ON 16
 ud_7                -1.521248e-01 1 1  ON 17
 ud_8                -1.554058e-01 1 1  ON 18
 ud_9                -1.446564e-01 1 1  ON 19
 eO_0                -7.523970e-01 1 1  ON 20
 eO_1                -4.385598e-01 1 1  ON 21
 eO_2                -2.482553e-02 1 1  ON 22
 eO_3                 2.955675e-01 1 1  ON 23
 eO_4                 5.211584e-01 1 1  ON 24
 eO_5                 4.808848e-01 1 1  ON 25
 eO_6                 2.535171e-01 1 1  ON 26
 eO_7                -4.577254e-02 1 1  ON 27
 eO_8                -2.165658e-01 1 1  ON 28
 eO_9                -7.434939e-02 1 1  ON 29
eH1_0                -2.442936e-01 1 1  ON 30
eH1_1                -1.413878e-01 1 1  ON 31
eH1_2                -9.815770e-02 1 1  ON 32
eH1_3                -4.701870e-02 1 1  ON 33
eH1_4                 4.370828e-03 1 1  ON 34
eH1_5                 3.918399e-02 1 1  ON 35
eH1_6                 9.694490e-02 1 1  ON 36
eH1_7                 1.515072e-01 1 1  ON 37
eH1_8                 1.761054e-01 1 1  ON 38
eH1_9                 6.274843e-02 1 1  ON 39
eH2_0                -2.377981e-01 1 1  ON 40
eH2_1                -1.351716e-01 1 1  ON 41
eH2_2                -9.173945e-02 1 1  ON 42
eH2_3                -4.067291e-02 1 1  ON 43
eH2_4                 1.100765e-02 1 1  ON 44
eH2_5                 4.544126e-02 1 1  ON 45
eH2_6                 1.026811e-01 1 1  ON 46
eH2_7                 1.547437e-01 1 1  ON 47
eH2_8                 1.737137e-01 1 1  ON 48
eH2_9                 3.665296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8389
    reference variance = 0.203652
====================================================
  Execution time = 2.4391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334779030757
                                         uncertainty =       0.004563248034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334779030757
                                         uncertainty =       0.004563248034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409152913
  error estimate for blocks of size 2^( 2) =       0.000421441800
  error estimate for blocks of size 2^( 3) =       0.000434077200
  error estimate for blocks of size 2^( 4) =       0.000445735678
  error estimate for blocks of size 2^( 5) =       0.000457569243
  error estimate for blocks of size 2^( 6) =       0.000465195273
  error estimate for blocks of size 2^( 7) =       0.000468498255

      target function =                  N/A
              le_mean =     -16.909665898015
             les_mean =     286.271612827559
             stat err =       0.000459249612
             autocorr =       1.259871643467
              std dev =       0.578629598683
             le_variance =       0.334812212472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690966589802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909665898015       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909671643560       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909672189938       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909671422883       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909677127558       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909679855582       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909680992149       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909680625008       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909682530357       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909681641717       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909681238550       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909681131892       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909681266718       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909681892630       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.648090e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909665898015       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669011756       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669297882       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909668824478       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669964461       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909672178521       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909672107106       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909671743024       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909671863394       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909671976345       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909671663168       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.662176e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909665898015       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909666997406       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909667211103       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909667164255       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909667539460       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909667913283       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909667979465       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909667845008       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909667929693       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.181648e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0868e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.078956e-01 1 1  ON 0
 uu_1                 1.420253e-01 1 1  ON 1
 uu_2                 4.262728e-02 1 1  ON 2
 uu_3                -2.065095e-02 1 1  ON 3
 uu_4                -6.841871e-02 1 1  ON 4
 uu_5                -1.022953e-01 1 1  ON 5
 uu_6                -1.276373e-01 1 1  ON 6
 uu_7                -1.381994e-01 1 1  ON 7
 uu_8                -1.285402e-01 1 1  ON 8
 uu_9                -9.923557e-02 1 1  ON 9
 ud_0                 4.316503e-01 1 1  ON 10
 ud_1                 1.755098e-01 1 1  ON 11
 ud_2                 6.440694e-02 1 1  ON 12
 ud_3                -2.774658e-03 1 1  ON 13
 ud_4                -5.853779e-02 1 1  ON 14
 ud_5                -1.013910e-01 1 1  ON 15
 ud_6                -1.315872e-01 1 1  ON 16
 ud_7                -1.518585e-01 1 1  ON 17
 ud_8                -1.551087e-01 1 1  ON 18
 ud_9                -1.447341e-01 1 1  ON 19
 eO_0                -7.531511e-01 1 1  ON 20
 eO_1                -4.391947e-01 1 1  ON 21
 eO_2                -2.509328e-02 1 1  ON 22
 eO_3                 2.959214e-01 1 1  ON 23
 eO_4                 5.217152e-01 1 1  ON 24
 eO_5                 4.820467e-01 1 1  ON 25
 eO_6                 2.540785e-01 1 1  ON 26
 eO_7                -4.522576e-02 1 1  ON 27
 eO_8                -2.172024e-01 1 1  ON 28
 eO_9                -7.516206e-02 1 1  ON 29
eH1_0                -2.442830e-01 1 1  ON 30
eH1_1                -1.420884e-01 1 1  ON 31
eH1_2                -9.892010e-02 1 1  ON 32
eH1_3                -4.747907e-02 1 1  ON 33
eH1_4                 3.984668e-03 1 1  ON 34
eH1_5                 3.857915e-02 1 1  ON 35
eH1_6                 9.734222e-02 1 1  ON 36
eH1_7                 1.517474e-01 1 1  ON 37
eH1_8                 1.769744e-01 1 1  ON 38
eH1_9                 6.403439e-02 1 1  ON 39
eH2_0                -2.381300e-01 1 1  ON 40
eH2_1                -1.359479e-01 1 1  ON 41
eH2_2                -9.250248e-02 1 1  ON 42
eH2_3                -4.118254e-02 1 1  ON 43
eH2_4                 1.044670e-02 1 1  ON 44
eH2_5                 4.459250e-02 1 1  ON 45
eH2_6                 1.030515e-01 1 1  ON 46
eH2_7                 1.550724e-01 1 1  ON 47
eH2_8                 1.749619e-01 1 1  ON 48
eH2_9                 3.831514e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8915
    reference variance = 0.296322
====================================================
  Execution time = 2.3959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.0000e+06
  Execution time = 2.7071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841315238
                                         uncertainty =       0.009472439028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841315238
                                         uncertainty =       0.009472439028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411020536
  error estimate for blocks of size 2^( 2) =       0.000423055796
  error estimate for blocks of size 2^( 3) =       0.000435919983
  error estimate for blocks of size 2^( 4) =       0.000448144793
  error estimate for blocks of size 2^( 5) =       0.000460339711
  error estimate for blocks of size 2^( 6) =       0.000469261634
  error estimate for blocks of size 2^( 7) =       0.000473835479

      target function =                  N/A
              le_mean =     -16.910024165860
             les_mean =     286.286792882963
             stat err =       0.000462895404
             autocorr =       1.268348780990
              std dev =       0.581270816347
             le_variance =       0.337875761937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338363709642
                                         uncertainty =       0.009477077561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338363709642
                                         uncertainty =       0.009477077561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411338242
  error estimate for blocks of size 2^( 2) =       0.000423364619
  error estimate for blocks of size 2^( 3) =       0.000436205028
  error estimate for blocks of size 2^( 4) =       0.000448399041
  error estimate for blocks of size 2^( 5) =       0.000460552990
  error estimate for blocks of size 2^( 6) =       0.000469451906
  error estimate for blocks of size 2^( 7) =       0.000474037407

      target function =                  N/A
              le_mean =     -16.910024891709
             les_mean =     286.287339968167
             stat err =       0.000463110336
             autocorr =       1.267566556575
              std dev =       0.581720120971
             le_variance =       0.338398299143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338280824665
                                         uncertainty =       0.009489836376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338280824665
                                         uncertainty =       0.009489836376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411287864
  error estimate for blocks of size 2^( 2) =       0.000423311250
  error estimate for blocks of size 2^( 3) =       0.000436152437
  error estimate for blocks of size 2^( 4) =       0.000448351924
  error estimate for blocks of size 2^( 5) =       0.000460515827
  error estimate for blocks of size 2^( 6) =       0.000469425818
  error estimate for blocks of size 2^( 7) =       0.000474022858

      target function =                  N/A
              le_mean =     -16.910024890030
             les_mean =     286.287257026810
             stat err =       0.000463079107
             autocorr =       1.267706109399
              std dev =       0.581648875634
             le_variance =       0.338315414526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337917007489
                                         uncertainty =       0.009478412373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337917007489
                                         uncertainty =       0.009478412373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411066603
  error estimate for blocks of size 2^( 2) =       0.000423098855
  error estimate for blocks of size 2^( 3) =       0.000435957973
  error estimate for blocks of size 2^( 4) =       0.000448177713
  error estimate for blocks of size 2^( 5) =       0.000460367581
  error estimate for blocks of size 2^( 6) =       0.000469288454
  error estimate for blocks of size 2^( 7) =       0.000473868299

      target function =                  N/A
              le_mean =     -16.910023677449
             les_mean =     286.286852106878
             stat err =       0.000462925512
             autocorr =       1.268229475957
              std dev =       0.581335964800
             le_variance =       0.337951503970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910024165860        initial
     3.8147e-02     3.8147e-01             6.6481e-03       -16.910024891709  <--
     1.5259e-01     1.5259e+00             1.6622e-03       -16.910024890030
     6.1035e-01     6.1035e+00             4.1816e-04       -16.910023677449

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 3.7659e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.079152e-01 1 1  ON 0
 uu_1                 1.420004e-01 1 1  ON 1
 uu_2                 4.243771e-02 1 1  ON 2
 uu_3                -2.106232e-02 1 1  ON 3
 uu_4                -6.900473e-02 1 1  ON 4
 uu_5                -1.029347e-01 1 1  ON 5
 uu_6                -1.284337e-01 1 1  ON 6
 uu_7                -1.391012e-01 1 1  ON 7
 uu_8                -1.291908e-01 1 1  ON 8
 uu_9                -9.980196e-02 1 1  ON 9
 ud_0                 4.322763e-01 1 1  ON 10
 ud_1                 1.761376e-01 1 1  ON 11
 ud_2                 6.491423e-02 1 1  ON 12
 ud_3                -2.422316e-03 1 1  ON 13
 ud_4                -5.847319e-02 1 1  ON 14
 ud_5                -1.015081e-01 1 1  ON 15
 ud_6                -1.318449e-01 1 1  ON 16
 ud_7                -1.517530e-01 1 1  ON 17
 ud_8                -1.549764e-01 1 1  ON 18
 ud_9                -1.449289e-01 1 1  ON 19
 eO_0                -7.547686e-01 1 1  ON 20
 eO_1                -4.404573e-01 1 1  ON 21
 eO_2                -2.579964e-02 1 1  ON 22
 eO_3                 2.963627e-01 1 1  ON 23
 eO_4                 5.232241e-01 1 1  ON 24
 eO_5                 4.846559e-01 1 1  ON 25
 eO_6                 2.562162e-01 1 1  ON 26
 eO_7                -4.369269e-02 1 1  ON 27
 eO_8                -2.191904e-01 1 1  ON 28
 eO_9                -7.759272e-02 1 1  ON 29
eH1_0                -2.454578e-01 1 1  ON 30
eH1_1                -1.436345e-01 1 1  ON 31
eH1_2                -1.004385e-01 1 1  ON 32
eH1_3                -4.885137e-02 1 1  ON 33
eH1_4                 2.872043e-03 1 1  ON 34
eH1_5                 3.731499e-02 1 1  ON 35
eH1_6                 9.768046e-02 1 1  ON 36
eH1_7                 1.525337e-01 1 1  ON 37
eH1_8                 1.796305e-01 1 1  ON 38
eH1_9                 6.788597e-02 1 1  ON 39
eH2_0                -2.398058e-01 1 1  ON 40
eH2_1                -1.378839e-01 1 1  ON 41
eH2_2                -9.435930e-02 1 1  ON 42
eH2_3                -4.286194e-02 1 1  ON 43
eH2_4                 8.872786e-03 1 1  ON 44
eH2_5                 4.289377e-02 1 1  ON 45
eH2_6                 1.032228e-01 1 1  ON 46
eH2_7                 1.560286e-01 1 1  ON 47
eH2_8                 1.786882e-01 1 1  ON 48
eH2_9                 4.330105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.227772
====================================================
  Execution time = 2.6760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333942690026
                                         uncertainty =       0.004763004527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333942690026
                                         uncertainty =       0.004763004527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408554960
  error estimate for blocks of size 2^( 2) =       0.000420541160
  error estimate for blocks of size 2^( 3) =       0.000433116873
  error estimate for blocks of size 2^( 4) =       0.000445255398
  error estimate for blocks of size 2^( 5) =       0.000455589394
  error estimate for blocks of size 2^( 6) =       0.000462571915
  error estimate for blocks of size 2^( 7) =       0.000467216692

      target function =                  N/A
              le_mean =     -16.909969751300
             les_mean =     286.280911134394
             stat err =       0.000457658350
             autocorr =       1.254821076315
              std dev =       0.577783966063
             le_variance =       0.333834311440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690996975130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909969751300       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909963763674       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909962222358       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909971789232       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909974175573       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909977778550       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909980277246       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909984553055       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909984847446       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909985782494       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909992686161       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909989172520       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909992466841       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909995210291       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909995617485       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909996139236       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909998806703       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909997476207       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909998157857       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909998314978       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909999890450       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909999534925       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909998683026       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.000364e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909969751300       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909964483315       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909963138007       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909971290070       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909972267562       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909974256733       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909975905144       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909978107009       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909977201887       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909976790899       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909978928308       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909976934344       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909977638409       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909978139411       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909978147557       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.792593e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909969751300       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909966193658       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909965027569       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909969805221       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909969193680       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909970508665       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909971010611       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909971328221       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909970730096       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909970618160       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909970879314       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.201639e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3150e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.097193e-01 1 1  ON 0
 uu_1                 1.430311e-01 1 1  ON 1
 uu_2                 4.337747e-02 1 1  ON 2
 uu_3                -2.031754e-02 1 1  ON 3
 uu_4                -6.859082e-02 1 1  ON 4
 uu_5                -1.029413e-01 1 1  ON 5
 uu_6                -1.291497e-01 1 1  ON 6
 uu_7                -1.410966e-01 1 1  ON 7
 uu_8                -1.321799e-01 1 1  ON 8
 uu_9                -1.027572e-01 1 1  ON 9
 ud_0                 4.336656e-01 1 1  ON 10
 ud_1                 1.772578e-01 1 1  ON 11
 ud_2                 6.593850e-02 1 1  ON 12
 ud_3                -1.374087e-03 1 1  ON 13
 ud_4                -5.751560e-02 1 1  ON 14
 ud_5                -1.009640e-01 1 1  ON 15
 ud_6                -1.309425e-01 1 1  ON 16
 ud_7                -1.516736e-01 1 1  ON 17
 ud_8                -1.556008e-01 1 1  ON 18
 ud_9                -1.478901e-01 1 1  ON 19
 eO_0                -7.544580e-01 1 1  ON 20
 eO_1                -4.403112e-01 1 1  ON 21
 eO_2                -2.556949e-02 1 1  ON 22
 eO_3                 2.974204e-01 1 1  ON 23
 eO_4                 5.239092e-01 1 1  ON 24
 eO_5                 4.864956e-01 1 1  ON 25
 eO_6                 2.582969e-01 1 1  ON 26
 eO_7                -4.155843e-02 1 1  ON 27
 eO_8                -2.232304e-01 1 1  ON 28
 eO_9                -8.163946e-02 1 1  ON 29
eH1_0                -2.475893e-01 1 1  ON 30
eH1_1                -1.450922e-01 1 1  ON 31
eH1_2                -1.017232e-01 1 1  ON 32
eH1_3                -4.985650e-02 1 1  ON 33
eH1_4                 2.244927e-03 1 1  ON 34
eH1_5                 3.674556e-02 1 1  ON 35
eH1_6                 9.686300e-02 1 1  ON 36
eH1_7                 1.519417e-01 1 1  ON 37
eH1_8                 1.826692e-01 1 1  ON 38
eH1_9                 7.267856e-02 1 1  ON 39
eH2_0                -2.417456e-01 1 1  ON 40
eH2_1                -1.402258e-01 1 1  ON 41
eH2_2                -9.635561e-02 1 1  ON 42
eH2_3                -4.449453e-02 1 1  ON 43
eH2_4                 7.159825e-03 1 1  ON 44
eH2_5                 4.230627e-02 1 1  ON 45
eH2_6                 1.028649e-01 1 1  ON 46
eH2_7                 1.585428e-01 1 1  ON 47
eH2_8                 1.822292e-01 1 1  ON 48
eH2_9                 4.805372e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8781
    reference variance = 0.146058
====================================================
  Execution time = 2.3936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5620e-01
  Total weights = 2.0000e+06
  Execution time = 2.7139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355813577428
                                         uncertainty =       0.009915640779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355813577428
                                         uncertainty =       0.009915640779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421737586
  error estimate for blocks of size 2^( 2) =       0.000434006336
  error estimate for blocks of size 2^( 3) =       0.000446797657
  error estimate for blocks of size 2^( 4) =       0.000458895067
  error estimate for blocks of size 2^( 5) =       0.000469024818
  error estimate for blocks of size 2^( 6) =       0.000478868585
  error estimate for blocks of size 2^( 7) =       0.000486139483

      target function =                  N/A
              le_mean =     -16.909369329168
             les_mean =     286.282496115983
             stat err =       0.000473231988
             autocorr =       1.259109699831
              std dev =       0.596427014499
             le_variance =       0.355725183625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356539362728
                                         uncertainty =       0.009932375475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356539362728
                                         uncertainty =       0.009932375475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422167619
  error estimate for blocks of size 2^( 2) =       0.000434404148
  error estimate for blocks of size 2^( 3) =       0.000447147019
  error estimate for blocks of size 2^( 4) =       0.000459197072
  error estimate for blocks of size 2^( 5) =       0.000469299988
  error estimate for blocks of size 2^( 6) =       0.000479122863
  error estimate for blocks of size 2^( 7) =       0.000486410944

      target function =                  N/A
              le_mean =     -16.909365803862
             les_mean =     286.283102706947
             stat err =       0.000473507717
             autocorr =       1.258010555495
              std dev =       0.597035171796
             le_variance =       0.356450996362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356789697866
                                         uncertainty =       0.009942693036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356789697866
                                         uncertainty =       0.009942693036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422315788
  error estimate for blocks of size 2^( 2) =       0.000434546564
  error estimate for blocks of size 2^( 3) =       0.000447290499
  error estimate for blocks of size 2^( 4) =       0.000459351676
  error estimate for blocks of size 2^( 5) =       0.000469464515
  error estimate for blocks of size 2^( 6) =       0.000479311169
  error estimate for blocks of size 2^( 7) =       0.000486601549

      target function =                  N/A
              le_mean =     -16.909369135669
             les_mean =     286.283465638197
             stat err =       0.000473682227
             autocorr =       1.258054757447
              std dev =       0.597244715545
             le_variance =       0.356701250246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356106448203
                                         uncertainty =       0.009924099723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356106448203
                                         uncertainty =       0.009924099723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421911145
  error estimate for blocks of size 2^( 2) =       0.000434169162
  error estimate for blocks of size 2^( 3) =       0.000446948764
  error estimate for blocks of size 2^( 4) =       0.000459038898
  error estimate for blocks of size 2^( 5) =       0.000469162308
  error estimate for blocks of size 2^( 6) =       0.000479006341
  error estimate for blocks of size 2^( 7) =       0.000486279381

      target function =                  N/A
              le_mean =     -16.909367533581
             les_mean =     286.282728236512
             stat err =       0.000473371732
             autocorr =       1.258817129893
              std dev =       0.596672463578
             le_variance =       0.356018028792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909369329168        initial  <--
     9.5367e-03     9.5367e-02             2.0004e-02       -16.909365803862
     3.8147e-02     3.8147e-01             4.7926e-03       -16.909369135669
     1.5259e-01     1.5259e+00             1.2016e-03       -16.909367533581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6147
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.079152e-01 1 1  ON 0
 uu_1                 1.420004e-01 1 1  ON 1
 uu_2                 4.243771e-02 1 1  ON 2
 uu_3                -2.106232e-02 1 1  ON 3
 uu_4                -6.900473e-02 1 1  ON 4
 uu_5                -1.029347e-01 1 1  ON 5
 uu_6                -1.284337e-01 1 1  ON 6
 uu_7                -1.391012e-01 1 1  ON 7
 uu_8                -1.291908e-01 1 1  ON 8
 uu_9                -9.980196e-02 1 1  ON 9
 ud_0                 4.322763e-01 1 1  ON 10
 ud_1                 1.761376e-01 1 1  ON 11
 ud_2                 6.491423e-02 1 1  ON 12
 ud_3                -2.422316e-03 1 1  ON 13
 ud_4                -5.847319e-02 1 1  ON 14
 ud_5                -1.015081e-01 1 1  ON 15
 ud_6                -1.318449e-01 1 1  ON 16
 ud_7                -1.517530e-01 1 1  ON 17
 ud_8                -1.549764e-01 1 1  ON 18
 ud_9                -1.449289e-01 1 1  ON 19
 eO_0                -7.547686e-01 1 1  ON 20
 eO_1                -4.404573e-01 1 1  ON 21
 eO_2                -2.579964e-02 1 1  ON 22
 eO_3                 2.963627e-01 1 1  ON 23
 eO_4                 5.232241e-01 1 1  ON 24
 eO_5                 4.846559e-01 1 1  ON 25
 eO_6                 2.562162e-01 1 1  ON 26
 eO_7                -4.369269e-02 1 1  ON 27
 eO_8                -2.191904e-01 1 1  ON 28
 eO_9                -7.759272e-02 1 1  ON 29
eH1_0                -2.454578e-01 1 1  ON 30
eH1_1                -1.436345e-01 1 1  ON 31
eH1_2                -1.004385e-01 1 1  ON 32
eH1_3                -4.885137e-02 1 1  ON 33
eH1_4                 2.872043e-03 1 1  ON 34
eH1_5                 3.731499e-02 1 1  ON 35
eH1_6                 9.768046e-02 1 1  ON 36
eH1_7                 1.525337e-01 1 1  ON 37
eH1_8                 1.796305e-01 1 1  ON 38
eH1_9                 6.788597e-02 1 1  ON 39
eH2_0                -2.398058e-01 1 1  ON 40
eH2_1                -1.378839e-01 1 1  ON 41
eH2_2                -9.435930e-02 1 1  ON 42
eH2_3                -4.286194e-02 1 1  ON 43
eH2_4                 8.872786e-03 1 1  ON 44
eH2_5                 4.289377e-02 1 1  ON 45
eH2_6                 1.032228e-01 1 1  ON 46
eH2_7                 1.560286e-01 1 1  ON 47
eH2_8                 1.786882e-01 1 1  ON 48
eH2_9                 4.330105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8699
    reference variance = 0.190743
====================================================
  Execution time = 2.4414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360027979710
                                         uncertainty =       0.026973408238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360027979710
                                         uncertainty =       0.026973408238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424174476
  error estimate for blocks of size 2^( 2) =       0.000435890925
  error estimate for blocks of size 2^( 3) =       0.000447696247
  error estimate for blocks of size 2^( 4) =       0.000458209473
  error estimate for blocks of size 2^( 5) =       0.000468336512
  error estimate for blocks of size 2^( 6) =       0.000476568287
  error estimate for blocks of size 2^( 7) =       0.000479651355

      target function =                  N/A
              le_mean =     -16.909601565550
             les_mean =     286.294472897450
             stat err =       0.000470691407
             autocorr =       1.231355559052
              std dev =       0.599873296396
             le_variance =       0.359847971729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690960156555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909601565550       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909602094183       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909604674959       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909604789431       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909607099952       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909610951363       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909610448001       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909608940565       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909609288998       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909608982292       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909609273362       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909609274325       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 3.183633e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909601565550       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909601855693       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909603267043       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909603214855       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909603659643       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909605010372       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909604500768       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909604175159       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909604183214       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.920261e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909601565550       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909601669003       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909602184714       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909602139836       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909602088047       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909602423101       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909602414490       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909602337570       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.970729e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0737e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081757e-01 1 1  ON 0
 uu_1                 1.420563e-01 1 1  ON 1
 uu_2                 4.245258e-02 1 1  ON 2
 uu_3                -2.096323e-02 1 1  ON 3
 uu_4                -6.916741e-02 1 1  ON 4
 uu_5                -1.032467e-01 1 1  ON 5
 uu_6                -1.285075e-01 1 1  ON 6
 uu_7                -1.391670e-01 1 1  ON 7
 uu_8                -1.294756e-01 1 1  ON 8
 uu_9                -9.988265e-02 1 1  ON 9
 ud_0                 4.324273e-01 1 1  ON 10
 ud_1                 1.760784e-01 1 1  ON 11
 ud_2                 6.489361e-02 1 1  ON 12
 ud_3                -2.532768e-03 1 1  ON 13
 ud_4                -5.839759e-02 1 1  ON 14
 ud_5                -1.015803e-01 1 1  ON 15
 ud_6                -1.319123e-01 1 1  ON 16
 ud_7                -1.520124e-01 1 1  ON 17
 ud_8                -1.551371e-01 1 1  ON 18
 ud_9                -1.446919e-01 1 1  ON 19
 eO_0                -7.549451e-01 1 1  ON 20
 eO_1                -4.405464e-01 1 1  ON 21
 eO_2                -2.590138e-02 1 1  ON 22
 eO_3                 2.963791e-01 1 1  ON 23
 eO_4                 5.233629e-01 1 1  ON 24
 eO_5                 4.849408e-01 1 1  ON 25
 eO_6                 2.564315e-01 1 1  ON 26
 eO_7                -4.347763e-02 1 1  ON 27
 eO_8                -2.193513e-01 1 1  ON 28
 eO_9                -7.789031e-02 1 1  ON 29
eH1_0                -2.457904e-01 1 1  ON 30
eH1_1                -1.440076e-01 1 1  ON 31
eH1_2                -1.007803e-01 1 1  ON 32
eH1_3                -4.902474e-02 1 1  ON 33
eH1_4                 2.580305e-03 1 1  ON 34
eH1_5                 3.709439e-02 1 1  ON 35
eH1_6                 9.789362e-02 1 1  ON 36
eH1_7                 1.526026e-01 1 1  ON 37
eH1_8                 1.801347e-01 1 1  ON 38
eH1_9                 6.867799e-02 1 1  ON 39
eH2_0                -2.401071e-01 1 1  ON 40
eH2_1                -1.383576e-01 1 1  ON 41
eH2_2                -9.452591e-02 1 1  ON 42
eH2_3                -4.306287e-02 1 1  ON 43
eH2_4                 8.725369e-03 1 1  ON 44
eH2_5                 4.297023e-02 1 1  ON 45
eH2_6                 1.032545e-01 1 1  ON 46
eH2_7                 1.563209e-01 1 1  ON 47
eH2_8                 1.791593e-01 1 1  ON 48
eH2_9                 4.377006e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9533
    reference variance = 0.326834
====================================================
  Execution time = 2.3983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3979e-01
  Total weights = 2.0000e+06
  Execution time = 2.7022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339763209456
                                         uncertainty =       0.004984910131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339763209456
                                         uncertainty =       0.004984910131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412062821
  error estimate for blocks of size 2^( 2) =       0.000424041069
  error estimate for blocks of size 2^( 3) =       0.000436832575
  error estimate for blocks of size 2^( 4) =       0.000449397469
  error estimate for blocks of size 2^( 5) =       0.000459529129
  error estimate for blocks of size 2^( 6) =       0.000468925666
  error estimate for blocks of size 2^( 7) =       0.000477861592

      target function =                  N/A
              le_mean =     -16.909998580931
             les_mean =     286.287643374930
             stat err =       0.000463928464
             autocorr =       1.267579405560
              std dev =       0.582744830628
             le_variance =       0.339591537624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132233977
                                         uncertainty =       0.004988279322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132233977
                                         uncertainty =       0.004988279322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412286472
  error estimate for blocks of size 2^( 2) =       0.000424259845
  error estimate for blocks of size 2^( 3) =       0.000437044422
  error estimate for blocks of size 2^( 4) =       0.000449600625
  error estimate for blocks of size 2^( 5) =       0.000459719763
  error estimate for blocks of size 2^( 6) =       0.000469103426
  error estimate for blocks of size 2^( 7) =       0.000478025900

      target function =                  N/A
              le_mean =     -16.910000142619
             les_mean =     286.288064923874
             stat err =       0.000464112428
             autocorr =       1.267208934852
              std dev =       0.583061120703
             le_variance =       0.339960270476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340157851646
                                         uncertainty =       0.004987674683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340157851646
                                         uncertainty =       0.004987674683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412302004
  error estimate for blocks of size 2^( 2) =       0.000424273214
  error estimate for blocks of size 2^( 3) =       0.000437058938
  error estimate for blocks of size 2^( 4) =       0.000449617093
  error estimate for blocks of size 2^( 5) =       0.000459741373
  error estimate for blocks of size 2^( 6) =       0.000469129985
  error estimate for blocks of size 2^( 7) =       0.000478057278

      target function =                  N/A
              le_mean =     -16.910001069784
             les_mean =     286.288121895737
             stat err =       0.000464136432
             autocorr =       1.267244534112
              std dev =       0.583083086377
             le_variance =       0.339985885619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843667450
                                         uncertainty =       0.004985423261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843667450
                                         uncertainty =       0.004985423261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412111593
  error estimate for blocks of size 2^( 2) =       0.000424088229
  error estimate for blocks of size 2^( 3) =       0.000436878701
  error estimate for blocks of size 2^( 4) =       0.000449442171
  error estimate for blocks of size 2^( 5) =       0.000459572794
  error estimate for blocks of size 2^( 6) =       0.000468968157
  error estimate for blocks of size 2^( 7) =       0.000477903021

      target function =                  N/A
              le_mean =     -16.909998971740
             les_mean =     286.287736983873
             stat err =       0.000463971536
             autocorr =       1.267514723944
              std dev =       0.582813803422
             le_variance =       0.339671929459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909998580931        initial
     9.5367e-02     9.5367e-01             3.1836e-03       -16.910000142619
     3.8147e-01     3.8147e+00             7.9203e-04       -16.910001069784  <--
     1.5259e+00     1.5259e+01             1.9707e-04       -16.909998971740

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.7651e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081757e-01 1 1  ON 0
 uu_1                 1.420563e-01 1 1  ON 1
 uu_2                 4.245258e-02 1 1  ON 2
 uu_3                -2.096323e-02 1 1  ON 3
 uu_4                -6.916741e-02 1 1  ON 4
 uu_5                -1.032467e-01 1 1  ON 5
 uu_6                -1.285075e-01 1 1  ON 6
 uu_7                -1.391670e-01 1 1  ON 7
 uu_8                -1.294756e-01 1 1  ON 8
 uu_9                -9.988265e-02 1 1  ON 9
 ud_0                 4.324273e-01 1 1  ON 10
 ud_1                 1.760784e-01 1 1  ON 11
 ud_2                 6.489361e-02 1 1  ON 12
 ud_3                -2.532768e-03 1 1  ON 13
 ud_4                -5.839759e-02 1 1  ON 14
 ud_5                -1.015803e-01 1 1  ON 15
 ud_6                -1.319123e-01 1 1  ON 16
 ud_7                -1.520124e-01 1 1  ON 17
 ud_8                -1.551371e-01 1 1  ON 18
 ud_9                -1.446919e-01 1 1  ON 19
 eO_0                -7.549451e-01 1 1  ON 20
 eO_1                -4.405464e-01 1 1  ON 21
 eO_2                -2.590138e-02 1 1  ON 22
 eO_3                 2.963791e-01 1 1  ON 23
 eO_4                 5.233629e-01 1 1  ON 24
 eO_5                 4.849408e-01 1 1  ON 25
 eO_6                 2.564315e-01 1 1  ON 26
 eO_7                -4.347763e-02 1 1  ON 27
 eO_8                -2.193513e-01 1 1  ON 28
 eO_9                -7.789031e-02 1 1  ON 29
eH1_0                -2.457904e-01 1 1  ON 30
eH1_1                -1.440076e-01 1 1  ON 31
eH1_2                -1.007803e-01 1 1  ON 32
eH1_3                -4.902474e-02 1 1  ON 33
eH1_4                 2.580305e-03 1 1  ON 34
eH1_5                 3.709439e-02 1 1  ON 35
eH1_6                 9.789362e-02 1 1  ON 36
eH1_7                 1.526026e-01 1 1  ON 37
eH1_8                 1.801347e-01 1 1  ON 38
eH1_9                 6.867799e-02 1 1  ON 39
eH2_0                -2.401071e-01 1 1  ON 40
eH2_1                -1.383576e-01 1 1  ON 41
eH2_2                -9.452591e-02 1 1  ON 42
eH2_3                -4.306287e-02 1 1  ON 43
eH2_4                 8.725369e-03 1 1  ON 44
eH2_5                 4.297023e-02 1 1  ON 45
eH2_6                 1.032545e-01 1 1  ON 46
eH2_7                 1.563209e-01 1 1  ON 47
eH2_8                 1.791593e-01 1 1  ON 48
eH2_9                 4.377006e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9826
    reference variance = 0.502951
====================================================
  Execution time = 2.4739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331631832228
                                         uncertainty =       0.003254129250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331631832228
                                         uncertainty =       0.003254129250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407177034
  error estimate for blocks of size 2^( 2) =       0.000418954960
  error estimate for blocks of size 2^( 3) =       0.000431739238
  error estimate for blocks of size 2^( 4) =       0.000443920918
  error estimate for blocks of size 2^( 5) =       0.000455578474
  error estimate for blocks of size 2^( 6) =       0.000465624478
  error estimate for blocks of size 2^( 7) =       0.000471261578

      target function =                  N/A
              le_mean =     -16.910456985317
             les_mean =     286.295141560387
             stat err =       0.000459096362
             autocorr =       1.271279823500
              std dev =       0.575835283663
             le_variance =       0.331586273912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691045698532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910456985317       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910459061725       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910457486937       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910459682580       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910459194613       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910460847681       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910460812465       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910460967020       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910461219408       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910461717121       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910461748998       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910461537472       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.439833e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910456985317       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910457978040       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910457324516       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910457929138       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910458383205       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910458006017       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910458469033       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910458328022       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910458438361       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910458524437       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.123434e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910456985317       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910457306835       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910457125822       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910457150712       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910457458059       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910457352462       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910457403089       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910457387186       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.488288e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1169e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083201e-01 1 1  ON 0
 uu_1                 1.420973e-01 1 1  ON 1
 uu_2                 4.252210e-02 1 1  ON 2
 uu_3                -2.086645e-02 1 1  ON 3
 uu_4                -6.911803e-02 1 1  ON 4
 uu_5                -1.033831e-01 1 1  ON 5
 uu_6                -1.288074e-01 1 1  ON 6
 uu_7                -1.394150e-01 1 1  ON 7
 uu_8                -1.296794e-01 1 1  ON 8
 uu_9                -9.995360e-02 1 1  ON 9
 ud_0                 4.323054e-01 1 1  ON 10
 ud_1                 1.760445e-01 1 1  ON 11
 ud_2                 6.474396e-02 1 1  ON 12
 ud_3                -2.622018e-03 1 1  ON 13
 ud_4                -5.858996e-02 1 1  ON 14
 ud_5                -1.016501e-01 1 1  ON 15
 ud_6                -1.318390e-01 1 1  ON 16
 ud_7                -1.518013e-01 1 1  ON 17
 ud_8                -1.550595e-01 1 1  ON 18
 ud_9                -1.445714e-01 1 1  ON 19
 eO_0                -7.550227e-01 1 1  ON 20
 eO_1                -4.405009e-01 1 1  ON 21
 eO_2                -2.603167e-02 1 1  ON 22
 eO_3                 2.963718e-01 1 1  ON 23
 eO_4                 5.234155e-01 1 1  ON 24
 eO_5                 4.850828e-01 1 1  ON 25
 eO_6                 2.567596e-01 1 1  ON 26
 eO_7                -4.334824e-02 1 1  ON 27
 eO_8                -2.195595e-01 1 1  ON 28
 eO_9                -7.813531e-02 1 1  ON 29
eH1_0                -2.461587e-01 1 1  ON 30
eH1_1                -1.444476e-01 1 1  ON 31
eH1_2                -1.009388e-01 1 1  ON 32
eH1_3                -4.904341e-02 1 1  ON 33
eH1_4                 2.465594e-03 1 1  ON 34
eH1_5                 3.713219e-02 1 1  ON 35
eH1_6                 9.774613e-02 1 1  ON 36
eH1_7                 1.528346e-01 1 1  ON 37
eH1_8                 1.806128e-01 1 1  ON 38
eH1_9                 6.917315e-02 1 1  ON 39
eH2_0                -2.402861e-01 1 1  ON 40
eH2_1                -1.384314e-01 1 1  ON 41
eH2_2                -9.469308e-02 1 1  ON 42
eH2_3                -4.309791e-02 1 1  ON 43
eH2_4                 8.474694e-03 1 1  ON 44
eH2_5                 4.264546e-02 1 1  ON 45
eH2_6                 1.031135e-01 1 1  ON 46
eH2_7                 1.563839e-01 1 1  ON 47
eH2_8                 1.794421e-01 1 1  ON 48
eH2_9                 4.438240e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9885
    reference variance = 0.491676
====================================================
  Execution time = 2.3892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3104e-01
  Total weights = 2.0000e+06
  Execution time = 2.7163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330913423180
                                         uncertainty =       0.004425393745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330913423180
                                         uncertainty =       0.004425393745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406844082
  error estimate for blocks of size 2^( 2) =       0.000418918661
  error estimate for blocks of size 2^( 3) =       0.000431497772
  error estimate for blocks of size 2^( 4) =       0.000443320566
  error estimate for blocks of size 2^( 5) =       0.000454727716
  error estimate for blocks of size 2^( 6) =       0.000462665167
  error estimate for blocks of size 2^( 7) =       0.000468442565

      target function =                  N/A
              le_mean =     -16.910080917854
             les_mean =     286.281880697213
             stat err =       0.000457289004
             autocorr =       1.263355308431
              std dev =       0.575364418757
             le_variance =       0.331044214371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330927907257
                                         uncertainty =       0.004426639171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330927907257
                                         uncertainty =       0.004426639171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406853094
  error estimate for blocks of size 2^( 2) =       0.000418926951
  error estimate for blocks of size 2^( 3) =       0.000431505310
  error estimate for blocks of size 2^( 4) =       0.000443324615
  error estimate for blocks of size 2^( 5) =       0.000454731089
  error estimate for blocks of size 2^( 6) =       0.000462670329
  error estimate for blocks of size 2^( 7) =       0.000468445012

      target function =                  N/A
              le_mean =     -16.910081907604
             les_mean =     286.281928837121
             stat err =       0.000457292761
             autocorr =       1.263320101685
              std dev =       0.575377163932
             le_variance =       0.331058880775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330914369765
                                         uncertainty =       0.004426240404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330914369765
                                         uncertainty =       0.004426240404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406844767
  error estimate for blocks of size 2^( 2) =       0.000418917665
  error estimate for blocks of size 2^( 3) =       0.000431496060
  error estimate for blocks of size 2^( 4) =       0.000443315191
  error estimate for blocks of size 2^( 5) =       0.000454723305
  error estimate for blocks of size 2^( 6) =       0.000462664847
  error estimate for blocks of size 2^( 7) =       0.000468442048

      target function =                  N/A
              le_mean =     -16.910081342247
             les_mean =     286.281896164868
             stat err =       0.000457286347
             autocorr =       1.263336378663
              std dev =       0.575365387374
             le_variance =       0.331045328988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906152033
                                         uncertainty =       0.004425464654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906152033
                                         uncertainty =       0.004425464654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406839634
  error estimate for blocks of size 2^( 2) =       0.000418913967
  error estimate for blocks of size 2^( 3) =       0.000431493133
  error estimate for blocks of size 2^( 4) =       0.000443315318
  error estimate for blocks of size 2^( 5) =       0.000454722621
  error estimate for blocks of size 2^( 6) =       0.000462660903
  error estimate for blocks of size 2^( 7) =       0.000468438399

      target function =                  N/A
              le_mean =     -16.910080811442
             les_mean =     286.281869860144
             stat err =       0.000457284310
             autocorr =       1.263356999048
              std dev =       0.575358128611
             le_variance =       0.331036976159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910080917854        initial
     9.5367e-02     9.5367e-01             2.4398e-03       -16.910081907604  <--
     3.8147e-01     3.8147e+00             6.1234e-04       -16.910081342247
     1.5259e+00     1.5259e+01             1.4883e-04       -16.910080811442

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 3.7598e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.085662e-01 1 1  ON 0
 uu_1                 1.422364e-01 1 1  ON 1
 uu_2                 4.267900e-02 1 1  ON 2
 uu_3                -2.073399e-02 1 1  ON 3
 uu_4                -6.909947e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293017e-01 1 1  ON 6
 uu_7                -1.401034e-01 1 1  ON 7
 uu_8                -1.303562e-01 1 1  ON 8
 uu_9                -1.002044e-01 1 1  ON 9
 ud_0                 4.320741e-01 1 1  ON 10
 ud_1                 1.758404e-01 1 1  ON 11
 ud_2                 6.449678e-02 1 1  ON 12
 ud_3                -2.861596e-03 1 1  ON 13
 ud_4                -5.886404e-02 1 1  ON 14
 ud_5                -1.018274e-01 1 1  ON 15
 ud_6                -1.318426e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.548347e-01 1 1  ON 18
 ud_9                -1.441901e-01 1 1  ON 19
 eO_0                -7.551728e-01 1 1  ON 20
 eO_1                -4.405917e-01 1 1  ON 21
 eO_2                -2.620187e-02 1 1  ON 22
 eO_3                 2.963157e-01 1 1  ON 23
 eO_4                 5.235600e-01 1 1  ON 24
 eO_5                 4.855267e-01 1 1  ON 25
 eO_6                 2.576806e-01 1 1  ON 26
 eO_7                -4.296701e-02 1 1  ON 27
 eO_8                -2.201679e-01 1 1  ON 28
 eO_9                -7.886328e-02 1 1  ON 29
eH1_0                -2.471256e-01 1 1  ON 30
eH1_1                -1.452837e-01 1 1  ON 31
eH1_2                -1.014621e-01 1 1  ON 32
eH1_3                -4.942439e-02 1 1  ON 33
eH1_4                 2.116263e-03 1 1  ON 34
eH1_5                 3.703062e-02 1 1  ON 35
eH1_6                 9.736700e-02 1 1  ON 36
eH1_7                 1.534777e-01 1 1  ON 37
eH1_8                 1.820126e-01 1 1  ON 38
eH1_9                 7.065035e-02 1 1  ON 39
eH2_0                -2.407467e-01 1 1  ON 40
eH2_1                -1.387940e-01 1 1  ON 41
eH2_2                -9.513729e-02 1 1  ON 42
eH2_3                -4.344122e-02 1 1  ON 43
eH2_4                 7.858596e-03 1 1  ON 44
eH2_5                 4.186137e-02 1 1  ON 45
eH2_6                 1.026762e-01 1 1  ON 46
eH2_7                 1.565272e-01 1 1  ON 47
eH2_8                 1.802806e-01 1 1  ON 48
eH2_9                 4.620989e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8546
    reference variance = 0.770984
====================================================
  Execution time = 2.4434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3325e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333186060002
                                         uncertainty =       0.003983266942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333186060002
                                         uncertainty =       0.003983266942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408195973
  error estimate for blocks of size 2^( 2) =       0.000420164704
  error estimate for blocks of size 2^( 3) =       0.000432442510
  error estimate for blocks of size 2^( 4) =       0.000445409340
  error estimate for blocks of size 2^( 5) =       0.000456400477
  error estimate for blocks of size 2^( 6) =       0.000465535976
  error estimate for blocks of size 2^( 7) =       0.000474844543

      target function =                  N/A
              le_mean =     -16.909514558940
             les_mean =     286.264930357297
             stat err =       0.000460547584
             autocorr =       1.272950700473
              std dev =       0.577276281278
             le_variance =       0.333247904926


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690951455894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514558940       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515944087       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909517505949       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909521712021       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909522885970       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909521858243       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909528530612       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909524884599       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909529120019       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909533260489       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909533415464       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909533405895       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909531152059       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909531301016       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909531089135       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909531455523       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 1.040687e-02

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514558940       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515637417       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909516337628       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909518767837       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909520216731       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909518297586       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909521283199       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909519838722       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909521413463       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909521354147       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909521598787       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909521606475       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.600110e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514558940       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515130896       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515168547       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515963266       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909517157284       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515885711       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909516256100       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909516572159       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909516469690       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909516658412       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.528963e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0809e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.092041e-01 1 1  ON 0
 uu_1                 1.428688e-01 1 1  ON 1
 uu_2                 4.304136e-02 1 1  ON 2
 uu_3                -2.075773e-02 1 1  ON 3
 uu_4                -6.950629e-02 1 1  ON 4
 uu_5                -1.040163e-01 1 1  ON 5
 uu_6                -1.302567e-01 1 1  ON 6
 uu_7                -1.411140e-01 1 1  ON 7
 uu_8                -1.307778e-01 1 1  ON 8
 uu_9                -1.007506e-01 1 1  ON 9
 ud_0                 4.322184e-01 1 1  ON 10
 ud_1                 1.757150e-01 1 1  ON 11
 ud_2                 6.435029e-02 1 1  ON 12
 ud_3                -3.044954e-03 1 1  ON 13
 ud_4                -5.866649e-02 1 1  ON 14
 ud_5                -1.017421e-01 1 1  ON 15
 ud_6                -1.317012e-01 1 1  ON 16
 ud_7                -1.516624e-01 1 1  ON 17
 ud_8                -1.548155e-01 1 1  ON 18
 ud_9                -1.444090e-01 1 1  ON 19
 eO_0                -7.554945e-01 1 1  ON 20
 eO_1                -4.412281e-01 1 1  ON 21
 eO_2                -2.615743e-02 1 1  ON 22
 eO_3                 2.965428e-01 1 1  ON 23
 eO_4                 5.239409e-01 1 1  ON 24
 eO_5                 4.865456e-01 1 1  ON 25
 eO_6                 2.587639e-01 1 1  ON 26
 eO_7                -4.227987e-02 1 1  ON 27
 eO_8                -2.211897e-01 1 1  ON 28
 eO_9                -8.016768e-02 1 1  ON 29
eH1_0                -2.481462e-01 1 1  ON 30
eH1_1                -1.458115e-01 1 1  ON 31
eH1_2                -1.020302e-01 1 1  ON 32
eH1_3                -5.006319e-02 1 1  ON 33
eH1_4                 1.501360e-03 1 1  ON 34
eH1_5                 3.646213e-02 1 1  ON 35
eH1_6                 9.757673e-02 1 1  ON 36
eH1_7                 1.540876e-01 1 1  ON 37
eH1_8                 1.833958e-01 1 1  ON 38
eH1_9                 7.234678e-02 1 1  ON 39
eH2_0                -2.409704e-01 1 1  ON 40
eH2_1                -1.394703e-01 1 1  ON 41
eH2_2                -9.653033e-02 1 1  ON 42
eH2_3                -4.470146e-02 1 1  ON 43
eH2_4                 7.008245e-03 1 1  ON 44
eH2_5                 4.132709e-02 1 1  ON 45
eH2_6                 1.019617e-01 1 1  ON 46
eH2_7                 1.572503e-01 1 1  ON 47
eH2_8                 1.824846e-01 1 1  ON 48
eH2_9                 4.881000e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9367
    reference variance = 0.43559
====================================================
  Execution time = 2.3965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3071e-01
  Total weights = 2.0000e+06
  Execution time = 2.7077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330322694563
                                         uncertainty =       0.003127445602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330322694563
                                         uncertainty =       0.003127445602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406356272
  error estimate for blocks of size 2^( 2) =       0.000418286780
  error estimate for blocks of size 2^( 3) =       0.000430495622
  error estimate for blocks of size 2^( 4) =       0.000441879222
  error estimate for blocks of size 2^( 5) =       0.000452503098
  error estimate for blocks of size 2^( 6) =       0.000461124254
  error estimate for blocks of size 2^( 7) =       0.000465994902

      target function =                  N/A
              le_mean =     -16.909905512031
             les_mean =     286.275155100205
             stat err =       0.000455375369
             autocorr =       1.255813473730
              std dev =       0.574674550950
             le_variance =       0.330250839510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331096443209
                                         uncertainty =       0.003135219952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331096443209
                                         uncertainty =       0.003135219952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406832046
  error estimate for blocks of size 2^( 2) =       0.000418743363
  error estimate for blocks of size 2^( 3) =       0.000430910969
  error estimate for blocks of size 2^( 4) =       0.000442259154
  error estimate for blocks of size 2^( 5) =       0.000452857322
  error estimate for blocks of size 2^( 6) =       0.000461446618
  error estimate for blocks of size 2^( 7) =       0.000466315201

      target function =                  N/A
              le_mean =     -16.909895239007
             les_mean =     286.275581455420
             stat err =       0.000455719574
             autocorr =       1.254772685051
              std dev =       0.575347396560
             le_variance =       0.331024626728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331267035279
                                         uncertainty =       0.003137417331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331267035279
                                         uncertainty =       0.003137417331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406936883
  error estimate for blocks of size 2^( 2) =       0.000418840767
  error estimate for blocks of size 2^( 3) =       0.000431000705
  error estimate for blocks of size 2^( 4) =       0.000442355816
  error estimate for blocks of size 2^( 5) =       0.000452958892
  error estimate for blocks of size 2^( 6) =       0.000461561059
  error estimate for blocks of size 2^( 7) =       0.000466422278

      target function =                  N/A
              le_mean =     -16.909894638556
             les_mean =     286.275731775481
             stat err =       0.000455824511
             autocorr =       1.254703880003
              std dev =       0.575495659429
             le_variance =       0.331195254022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330546271806
                                         uncertainty =       0.003129873291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330546271806
                                         uncertainty =       0.003129873291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406493815
  error estimate for blocks of size 2^( 2) =       0.000418416786
  error estimate for blocks of size 2^( 3) =       0.000430612798
  error estimate for blocks of size 2^( 4) =       0.000441990541
  error estimate for blocks of size 2^( 5) =       0.000452610422
  error estimate for blocks of size 2^( 6) =       0.000461227223
  error estimate for blocks of size 2^( 7) =       0.000466093330

      target function =                  N/A
              le_mean =     -16.909901289477
             les_mean =     286.275235898371
             stat err =       0.000455480379
             autocorr =       1.255542626396
              std dev =       0.574869066609
             le_variance =       0.330474443744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909905512031        initial  <--
     2.3842e-02     2.3842e-01             1.0407e-02       -16.909895239007
     9.5367e-02     9.5367e-01             2.6001e-03       -16.909894638556
     3.8147e-01     3.8147e+00             6.5290e-04       -16.909901289477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6417
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.085662e-01 1 1  ON 0
 uu_1                 1.422364e-01 1 1  ON 1
 uu_2                 4.267900e-02 1 1  ON 2
 uu_3                -2.073399e-02 1 1  ON 3
 uu_4                -6.909947e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293017e-01 1 1  ON 6
 uu_7                -1.401034e-01 1 1  ON 7
 uu_8                -1.303562e-01 1 1  ON 8
 uu_9                -1.002044e-01 1 1  ON 9
 ud_0                 4.320741e-01 1 1  ON 10
 ud_1                 1.758404e-01 1 1  ON 11
 ud_2                 6.449678e-02 1 1  ON 12
 ud_3                -2.861596e-03 1 1  ON 13
 ud_4                -5.886404e-02 1 1  ON 14
 ud_5                -1.018274e-01 1 1  ON 15
 ud_6                -1.318426e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.548347e-01 1 1  ON 18
 ud_9                -1.441901e-01 1 1  ON 19
 eO_0                -7.551728e-01 1 1  ON 20
 eO_1                -4.405917e-01 1 1  ON 21
 eO_2                -2.620187e-02 1 1  ON 22
 eO_3                 2.963157e-01 1 1  ON 23
 eO_4                 5.235600e-01 1 1  ON 24
 eO_5                 4.855267e-01 1 1  ON 25
 eO_6                 2.576806e-01 1 1  ON 26
 eO_7                -4.296701e-02 1 1  ON 27
 eO_8                -2.201679e-01 1 1  ON 28
 eO_9                -7.886328e-02 1 1  ON 29
eH1_0                -2.471256e-01 1 1  ON 30
eH1_1                -1.452837e-01 1 1  ON 31
eH1_2                -1.014621e-01 1 1  ON 32
eH1_3                -4.942439e-02 1 1  ON 33
eH1_4                 2.116263e-03 1 1  ON 34
eH1_5                 3.703062e-02 1 1  ON 35
eH1_6                 9.736700e-02 1 1  ON 36
eH1_7                 1.534777e-01 1 1  ON 37
eH1_8                 1.820126e-01 1 1  ON 38
eH1_9                 7.065035e-02 1 1  ON 39
eH2_0                -2.407467e-01 1 1  ON 40
eH2_1                -1.387940e-01 1 1  ON 41
eH2_2                -9.513729e-02 1 1  ON 42
eH2_3                -4.344122e-02 1 1  ON 43
eH2_4                 7.858596e-03 1 1  ON 44
eH2_5                 4.186137e-02 1 1  ON 45
eH2_6                 1.026762e-01 1 1  ON 46
eH2_7                 1.565272e-01 1 1  ON 47
eH2_8                 1.802806e-01 1 1  ON 48
eH2_9                 4.620989e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.175822
====================================================
  Execution time = 2.4220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3317e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333063284264
                                         uncertainty =       0.004732749454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333063284264
                                         uncertainty =       0.004732749454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148352
  error estimate for blocks of size 2^( 2) =       0.000420102508
  error estimate for blocks of size 2^( 3) =       0.000432579510
  error estimate for blocks of size 2^( 4) =       0.000444630811
  error estimate for blocks of size 2^( 5) =       0.000455004585
  error estimate for blocks of size 2^( 6) =       0.000460511425
  error estimate for blocks of size 2^( 7) =       0.000465525276

      target function =                  N/A
              le_mean =     -16.909786391391
             les_mean =     286.274045790175
             stat err =       0.000456418024
             autocorr =       1.250516651737
              std dev =       0.577208934698
             le_variance =       0.333170154295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690978639139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909786391391       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909787819227       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909788568458       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909788620811       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909788255899       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909788224951       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909788374387       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909788430921       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909789011823       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 7.721208e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909786391391       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909786940933       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909787183773       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909787248075       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909787197873       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909787083319       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909787133830       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909787173772       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.962906e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909786391391       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909786550195       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909786619395       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909786646331       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909786642408       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909786597011       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909786611670       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909786625549       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.953167e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2741e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.086183e-01 1 1  ON 0
 uu_1                 1.423341e-01 1 1  ON 1
 uu_2                 4.270959e-02 1 1  ON 2
 uu_3                -2.073899e-02 1 1  ON 3
 uu_4                -6.906491e-02 1 1  ON 4
 uu_5                -1.036133e-01 1 1  ON 5
 uu_6                -1.293315e-01 1 1  ON 6
 uu_7                -1.402302e-01 1 1  ON 7
 uu_8                -1.304541e-01 1 1  ON 8
 uu_9                -1.003135e-01 1 1  ON 9
 ud_0                 4.321388e-01 1 1  ON 10
 ud_1                 1.758578e-01 1 1  ON 11
 ud_2                 6.452777e-02 1 1  ON 12
 ud_3                -2.824203e-03 1 1  ON 13
 ud_4                -5.877931e-02 1 1  ON 14
 ud_5                -1.018592e-01 1 1  ON 15
 ud_6                -1.317712e-01 1 1  ON 16
 ud_7                -1.515979e-01 1 1  ON 17
 ud_8                -1.548862e-01 1 1  ON 18
 ud_9                -1.442800e-01 1 1  ON 19
 eO_0                -7.552025e-01 1 1  ON 20
 eO_1                -4.405537e-01 1 1  ON 21
 eO_2                -2.621148e-02 1 1  ON 22
 eO_3                 2.963864e-01 1 1  ON 23
 eO_4                 5.235727e-01 1 1  ON 24
 eO_5                 4.855973e-01 1 1  ON 25
 eO_6                 2.578358e-01 1 1  ON 26
 eO_7                -4.295217e-02 1 1  ON 27
 eO_8                -2.203279e-01 1 1  ON 28
 eO_9                -7.900226e-02 1 1  ON 29
eH1_0                -2.472091e-01 1 1  ON 30
eH1_1                -1.453244e-01 1 1  ON 31
eH1_2                -1.015062e-01 1 1  ON 32
eH1_3                -4.945841e-02 1 1  ON 33
eH1_4                 2.055651e-03 1 1  ON 34
eH1_5                 3.699006e-02 1 1  ON 35
eH1_6                 9.736913e-02 1 1  ON 36
eH1_7                 1.534888e-01 1 1  ON 37
eH1_8                 1.820942e-01 1 1  ON 38
eH1_9                 7.082471e-02 1 1  ON 39
eH2_0                -2.408173e-01 1 1  ON 40
eH2_1                -1.388566e-01 1 1  ON 41
eH2_2                -9.519542e-02 1 1  ON 42
eH2_3                -4.355790e-02 1 1  ON 43
eH2_4                 7.781626e-03 1 1  ON 44
eH2_5                 4.173129e-02 1 1  ON 45
eH2_6                 1.027550e-01 1 1  ON 46
eH2_7                 1.566451e-01 1 1  ON 47
eH2_8                 1.804098e-01 1 1  ON 48
eH2_9                 4.640618e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.28083
====================================================
  Execution time = 2.3982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3520e-01
  Total weights = 2.0000e+06
  Execution time = 2.7045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233124953
                                         uncertainty =       0.003905609513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233124953
                                         uncertainty =       0.003905609513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409359969
  error estimate for blocks of size 2^( 2) =       0.000421783237
  error estimate for blocks of size 2^( 3) =       0.000434434842
  error estimate for blocks of size 2^( 4) =       0.000447544679
  error estimate for blocks of size 2^( 5) =       0.000459487475
  error estimate for blocks of size 2^( 6) =       0.000469049133
  error estimate for blocks of size 2^( 7) =       0.000475690039

      target function =                  N/A
              le_mean =     -16.909863867083
             les_mean =     286.278647003824
             stat err =       0.000462942832
             autocorr =       1.278921786079
              std dev =       0.578922419775
             le_variance =       0.335151168118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335353124140
                                         uncertainty =       0.003907683962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335353124140
                                         uncertainty =       0.003907683962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409433263
  error estimate for blocks of size 2^( 2) =       0.000421852572
  error estimate for blocks of size 2^( 3) =       0.000434498218
  error estimate for blocks of size 2^( 4) =       0.000447603205
  error estimate for blocks of size 2^( 5) =       0.000459545669
  error estimate for blocks of size 2^( 6) =       0.000469106569
  error estimate for blocks of size 2^( 7) =       0.000475749994

      target function =                  N/A
              le_mean =     -16.909863354503
             les_mean =     286.278749694190
             stat err =       0.000463001359
             autocorr =       1.278787219282
              std dev =       0.579026073557
             le_variance =       0.335271193859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335339018407
                                         uncertainty =       0.003907558849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335339018407
                                         uncertainty =       0.003907558849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409424647
  error estimate for blocks of size 2^( 2) =       0.000421844828
  error estimate for blocks of size 2^( 3) =       0.000434491756
  error estimate for blocks of size 2^( 4) =       0.000447598082
  error estimate for blocks of size 2^( 5) =       0.000459540166
  error estimate for blocks of size 2^( 6) =       0.000469099539
  error estimate for blocks of size 2^( 7) =       0.000475742136

      target function =                  N/A
              le_mean =     -16.909863431093
             les_mean =     286.278738173343
             stat err =       0.000462994981
             autocorr =       1.278805808414
              std dev =       0.579013888227
             le_variance =       0.335257082759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335250050692
                                         uncertainty =       0.003905922852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335250050692
                                         uncertainty =       0.003905922852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409370307
  error estimate for blocks of size 2^( 2) =       0.000421793098
  error estimate for blocks of size 2^( 3) =       0.000434443988
  error estimate for blocks of size 2^( 4) =       0.000447553294
  error estimate for blocks of size 2^( 5) =       0.000459495946
  error estimate for blocks of size 2^( 6) =       0.000469057144
  error estimate for blocks of size 2^( 7) =       0.000475698228

      target function =                  N/A
              le_mean =     -16.909863785788
             les_mean =     286.278661183110
             stat err =       0.000462951153
             autocorr =       1.278903165488
              std dev =       0.578937040445
             le_variance =       0.335168096799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909863867083        initial  <--
     2.3842e-01     2.3842e+00             7.7212e-04       -16.909863354503
     9.5367e-01     9.5367e+00             1.9629e-04       -16.909863431093
     3.8147e+00     3.8147e+01             4.9532e-05       -16.909863785788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6627
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.085662e-01 1 1  ON 0
 uu_1                 1.422364e-01 1 1  ON 1
 uu_2                 4.267900e-02 1 1  ON 2
 uu_3                -2.073399e-02 1 1  ON 3
 uu_4                -6.909947e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293017e-01 1 1  ON 6
 uu_7                -1.401034e-01 1 1  ON 7
 uu_8                -1.303562e-01 1 1  ON 8
 uu_9                -1.002044e-01 1 1  ON 9
 ud_0                 4.320741e-01 1 1  ON 10
 ud_1                 1.758404e-01 1 1  ON 11
 ud_2                 6.449678e-02 1 1  ON 12
 ud_3                -2.861596e-03 1 1  ON 13
 ud_4                -5.886404e-02 1 1  ON 14
 ud_5                -1.018274e-01 1 1  ON 15
 ud_6                -1.318426e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.548347e-01 1 1  ON 18
 ud_9                -1.441901e-01 1 1  ON 19
 eO_0                -7.551728e-01 1 1  ON 20
 eO_1                -4.405917e-01 1 1  ON 21
 eO_2                -2.620187e-02 1 1  ON 22
 eO_3                 2.963157e-01 1 1  ON 23
 eO_4                 5.235600e-01 1 1  ON 24
 eO_5                 4.855267e-01 1 1  ON 25
 eO_6                 2.576806e-01 1 1  ON 26
 eO_7                -4.296701e-02 1 1  ON 27
 eO_8                -2.201679e-01 1 1  ON 28
 eO_9                -7.886328e-02 1 1  ON 29
eH1_0                -2.471256e-01 1 1  ON 30
eH1_1                -1.452837e-01 1 1  ON 31
eH1_2                -1.014621e-01 1 1  ON 32
eH1_3                -4.942439e-02 1 1  ON 33
eH1_4                 2.116263e-03 1 1  ON 34
eH1_5                 3.703062e-02 1 1  ON 35
eH1_6                 9.736700e-02 1 1  ON 36
eH1_7                 1.534777e-01 1 1  ON 37
eH1_8                 1.820126e-01 1 1  ON 38
eH1_9                 7.065035e-02 1 1  ON 39
eH2_0                -2.407467e-01 1 1  ON 40
eH2_1                -1.387940e-01 1 1  ON 41
eH2_2                -9.513729e-02 1 1  ON 42
eH2_3                -4.344122e-02 1 1  ON 43
eH2_4                 7.858596e-03 1 1  ON 44
eH2_5                 4.186137e-02 1 1  ON 45
eH2_6                 1.026762e-01 1 1  ON 46
eH2_7                 1.565272e-01 1 1  ON 47
eH2_8                 1.802806e-01 1 1  ON 48
eH2_9                 4.620989e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.13257
====================================================
  Execution time = 2.4072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341735709601
                                         uncertainty =       0.006700947577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341735709601
                                         uncertainty =       0.006700947577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413378334
  error estimate for blocks of size 2^( 2) =       0.000425331986
  error estimate for blocks of size 2^( 3) =       0.000436900886
  error estimate for blocks of size 2^( 4) =       0.000447513668
  error estimate for blocks of size 2^( 5) =       0.000458241694
  error estimate for blocks of size 2^( 6) =       0.000465449142
  error estimate for blocks of size 2^( 7) =       0.000468396801

      target function =                  N/A
              le_mean =     -16.910212486511
             les_mean =     286.297049461974
             stat err =       0.000459900326
             autocorr =       1.237747375943
              std dev =       0.584605246208
             le_variance =       0.341763293894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021248651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212486511       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212446229       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212537641       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212660075       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212509817       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212645478       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212582305       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212614694       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.358573e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212486511       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212475994       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212502090       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212532057       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212490062       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212523704       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212508619       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212517599       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.103932e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212486511       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212483852       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212490606       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212498051       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212487232       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212495584       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212491874       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212494164       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.268787e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0500e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.085621e-01 1 1  ON 0
 uu_1                 1.422479e-01 1 1  ON 1
 uu_2                 4.268208e-02 1 1  ON 2
 uu_3                -2.073877e-02 1 1  ON 3
 uu_4                -6.909215e-02 1 1  ON 4
 uu_5                -1.036216e-01 1 1  ON 5
 uu_6                -1.293051e-01 1 1  ON 6
 uu_7                -1.401106e-01 1 1  ON 7
 uu_8                -1.303640e-01 1 1  ON 8
 uu_9                -1.002118e-01 1 1  ON 9
 ud_0                 4.320688e-01 1 1  ON 10
 ud_1                 1.758451e-01 1 1  ON 11
 ud_2                 6.450608e-02 1 1  ON 12
 ud_3                -2.857033e-03 1 1  ON 13
 ud_4                -5.885570e-02 1 1  ON 14
 ud_5                -1.018316e-01 1 1  ON 15
 ud_6                -1.318390e-01 1 1  ON 16
 ud_7                -1.515513e-01 1 1  ON 17
 ud_8                -1.548398e-01 1 1  ON 18
 ud_9                -1.442044e-01 1 1  ON 19
 eO_0                -7.551775e-01 1 1  ON 20
 eO_1                -4.405865e-01 1 1  ON 21
 eO_2                -2.620625e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235716e-01 1 1  ON 24
 eO_5                 4.855289e-01 1 1  ON 25
 eO_6                 2.576887e-01 1 1  ON 26
 eO_7                -4.296097e-02 1 1  ON 27
 eO_8                -2.201781e-01 1 1  ON 28
 eO_9                -7.887742e-02 1 1  ON 29
eH1_0                -2.471331e-01 1 1  ON 30
eH1_1                -1.452895e-01 1 1  ON 31
eH1_2                -1.014572e-01 1 1  ON 32
eH1_3                -4.943739e-02 1 1  ON 33
eH1_4                 2.114775e-03 1 1  ON 34
eH1_5                 3.702943e-02 1 1  ON 35
eH1_6                 9.736568e-02 1 1  ON 36
eH1_7                 1.534793e-01 1 1  ON 37
eH1_8                 1.820240e-01 1 1  ON 38
eH1_9                 7.066546e-02 1 1  ON 39
eH2_0                -2.407553e-01 1 1  ON 40
eH2_1                -1.387992e-01 1 1  ON 41
eH2_2                -9.514999e-02 1 1  ON 42
eH2_3                -4.343442e-02 1 1  ON 43
eH2_4                 7.860965e-03 1 1  ON 44
eH2_5                 4.185127e-02 1 1  ON 45
eH2_6                 1.026639e-01 1 1  ON 46
eH2_7                 1.565311e-01 1 1  ON 47
eH2_8                 1.802923e-01 1 1  ON 48
eH2_9                 4.623093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9567
    reference variance = 0.264031
====================================================
  Execution time = 2.4039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4330e-01
  Total weights = 2.0000e+06
  Execution time = 2.6980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268509765
                                         uncertainty =       0.008330750691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268509765
                                         uncertainty =       0.008330750691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414310601
  error estimate for blocks of size 2^( 2) =       0.000425818964
  error estimate for blocks of size 2^( 3) =       0.000437300853
  error estimate for blocks of size 2^( 4) =       0.000447806872
  error estimate for blocks of size 2^( 5) =       0.000456904734
  error estimate for blocks of size 2^( 6) =       0.000462048445
  error estimate for blocks of size 2^( 7) =       0.000465303830

      target function =                  N/A
              le_mean =     -16.910620849759
             les_mean =     286.312403900762
             stat err =       0.000458015971
             autocorr =       1.222106775523
              std dev =       0.585923670885
             le_variance =       0.343306548103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343238789271
                                         uncertainty =       0.008330834326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343238789271
                                         uncertainty =       0.008330834326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414292668
  error estimate for blocks of size 2^( 2) =       0.000425801584
  error estimate for blocks of size 2^( 3) =       0.000437283459
  error estimate for blocks of size 2^( 4) =       0.000447789838
  error estimate for blocks of size 2^( 5) =       0.000456887640
  error estimate for blocks of size 2^( 6) =       0.000462030767
  error estimate for blocks of size 2^( 7) =       0.000465286514

      target function =                  N/A
              le_mean =     -16.910620626165
             les_mean =     286.312366619598
             stat err =       0.000457998690
             autocorr =       1.222120352438
              std dev =       0.585898309565
             le_variance =       0.343276829151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343251472174
                                         uncertainty =       0.008330782171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343251472174
                                         uncertainty =       0.008330782171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414300320
  error estimate for blocks of size 2^( 2) =       0.000425809023
  error estimate for blocks of size 2^( 3) =       0.000437290933
  error estimate for blocks of size 2^( 4) =       0.000447797170
  error estimate for blocks of size 2^( 5) =       0.000456895014
  error estimate for blocks of size 2^( 6) =       0.000462038418
  error estimate for blocks of size 2^( 7) =       0.000465294003

      target function =                  N/A
              le_mean =     -16.910620719056
             les_mean =     286.312382443101
             stat err =       0.000458006151
             autocorr =       1.222115023843
              std dev =       0.585909132027
             le_variance =       0.343289510993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266296282
                                         uncertainty =       0.008330754158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266296282
                                         uncertainty =       0.008330754158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414309265
  error estimate for blocks of size 2^( 2) =       0.000425817673
  error estimate for blocks of size 2^( 3) =       0.000437299566
  error estimate for blocks of size 2^( 4) =       0.000447805614
  error estimate for blocks of size 2^( 5) =       0.000456903474
  error estimate for blocks of size 2^( 6) =       0.000462047146
  error estimate for blocks of size 2^( 7) =       0.000465302556

      target function =                  N/A
              le_mean =     -16.910620832322
             les_mean =     286.312401097592
             stat err =       0.000458014697
             autocorr =       1.222107859994
              std dev =       0.585921782041
             le_variance =       0.343304334670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910620849759        initial  <--
     2.3842e+00     2.3842e+01             8.3586e-05       -16.910620626165
     9.5367e+00     9.5367e+01             2.1039e-05       -16.910620719056
     3.8147e+01     3.8147e+02             5.2688e-06       -16.910620832322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8536
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.085662e-01 1 1  ON 0
 uu_1                 1.422364e-01 1 1  ON 1
 uu_2                 4.267900e-02 1 1  ON 2
 uu_3                -2.073399e-02 1 1  ON 3
 uu_4                -6.909947e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293017e-01 1 1  ON 6
 uu_7                -1.401034e-01 1 1  ON 7
 uu_8                -1.303562e-01 1 1  ON 8
 uu_9                -1.002044e-01 1 1  ON 9
 ud_0                 4.320741e-01 1 1  ON 10
 ud_1                 1.758404e-01 1 1  ON 11
 ud_2                 6.449678e-02 1 1  ON 12
 ud_3                -2.861596e-03 1 1  ON 13
 ud_4                -5.886404e-02 1 1  ON 14
 ud_5                -1.018274e-01 1 1  ON 15
 ud_6                -1.318426e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.548347e-01 1 1  ON 18
 ud_9                -1.441901e-01 1 1  ON 19
 eO_0                -7.551728e-01 1 1  ON 20
 eO_1                -4.405917e-01 1 1  ON 21
 eO_2                -2.620187e-02 1 1  ON 22
 eO_3                 2.963157e-01 1 1  ON 23
 eO_4                 5.235600e-01 1 1  ON 24
 eO_5                 4.855267e-01 1 1  ON 25
 eO_6                 2.576806e-01 1 1  ON 26
 eO_7                -4.296701e-02 1 1  ON 27
 eO_8                -2.201679e-01 1 1  ON 28
 eO_9                -7.886328e-02 1 1  ON 29
eH1_0                -2.471256e-01 1 1  ON 30
eH1_1                -1.452837e-01 1 1  ON 31
eH1_2                -1.014621e-01 1 1  ON 32
eH1_3                -4.942439e-02 1 1  ON 33
eH1_4                 2.116263e-03 1 1  ON 34
eH1_5                 3.703062e-02 1 1  ON 35
eH1_6                 9.736700e-02 1 1  ON 36
eH1_7                 1.534777e-01 1 1  ON 37
eH1_8                 1.820126e-01 1 1  ON 38
eH1_9                 7.065035e-02 1 1  ON 39
eH2_0                -2.407467e-01 1 1  ON 40
eH2_1                -1.387940e-01 1 1  ON 41
eH2_2                -9.513729e-02 1 1  ON 42
eH2_3                -4.344122e-02 1 1  ON 43
eH2_4                 7.858596e-03 1 1  ON 44
eH2_5                 4.186137e-02 1 1  ON 45
eH2_6                 1.026762e-01 1 1  ON 46
eH2_7                 1.565272e-01 1 1  ON 47
eH2_8                 1.802806e-01 1 1  ON 48
eH2_9                 4.620989e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8689
    reference variance = 0.317316
====================================================
  Execution time = 2.4216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3412e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162611667
                                         uncertainty =       0.003750770858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162611667
                                         uncertainty =       0.003750770858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408729093
  error estimate for blocks of size 2^( 2) =       0.000420408605
  error estimate for blocks of size 2^( 3) =       0.000432501445
  error estimate for blocks of size 2^( 4) =       0.000443980484
  error estimate for blocks of size 2^( 5) =       0.000453595295
  error estimate for blocks of size 2^( 6) =       0.000461838377
  error estimate for blocks of size 2^( 7) =       0.000466144539

      target function =                  N/A
              le_mean =     -16.910039606213
             les_mean =     286.283558259623
             stat err =       0.000456389673
             autocorr =       1.246810684750
              std dev =       0.578030226716
             le_variance =       0.334118942997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691003960621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910039606213       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910039607462       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910039608917       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910039620655       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910039621980       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910039624189       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910039630955       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910039628916       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.400804e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910039606213       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910039606527       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910039606885       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910039609843       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910039610206       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910039610749       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910039612430       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910039611921       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.851271e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910039606213       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910039606292       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910039606381       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910039607122       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910039607214       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910039607350       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910039607769       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910039607642       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.628856e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0641e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.085677e-01 1 1  ON 0
 uu_1                 1.422368e-01 1 1  ON 1
 uu_2                 4.267902e-02 1 1  ON 2
 uu_3                -2.073461e-02 1 1  ON 3
 uu_4                -6.910012e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293018e-01 1 1  ON 6
 uu_7                -1.401036e-01 1 1  ON 7
 uu_8                -1.303566e-01 1 1  ON 8
 uu_9                -1.002055e-01 1 1  ON 9
 ud_0                 4.320751e-01 1 1  ON 10
 ud_1                 1.758403e-01 1 1  ON 11
 ud_2                 6.449730e-02 1 1  ON 12
 ud_3                -2.861637e-03 1 1  ON 13
 ud_4                -5.886273e-02 1 1  ON 14
 ud_5                -1.018280e-01 1 1  ON 15
 ud_6                -1.318416e-01 1 1  ON 16
 ud_7                -1.515599e-01 1 1  ON 17
 ud_8                -1.548352e-01 1 1  ON 18
 ud_9                -1.441913e-01 1 1  ON 19
 eO_0                -7.551719e-01 1 1  ON 20
 eO_1                -4.405929e-01 1 1  ON 21
 eO_2                -2.620160e-02 1 1  ON 22
 eO_3                 2.963163e-01 1 1  ON 23
 eO_4                 5.235598e-01 1 1  ON 24
 eO_5                 4.855273e-01 1 1  ON 25
 eO_6                 2.576815e-01 1 1  ON 26
 eO_7                -4.296592e-02 1 1  ON 27
 eO_8                -2.201692e-01 1 1  ON 28
 eO_9                -7.886483e-02 1 1  ON 29
eH1_0                -2.471270e-01 1 1  ON 30
eH1_1                -1.452834e-01 1 1  ON 31
eH1_2                -1.014616e-01 1 1  ON 32
eH1_3                -4.942526e-02 1 1  ON 33
eH1_4                 2.116123e-03 1 1  ON 34
eH1_5                 3.703042e-02 1 1  ON 35
eH1_6                 9.736589e-02 1 1  ON 36
eH1_7                 1.534774e-01 1 1  ON 37
eH1_8                 1.820138e-01 1 1  ON 38
eH1_9                 7.065220e-02 1 1  ON 39
eH2_0                -2.407466e-01 1 1  ON 40
eH2_1                -1.387942e-01 1 1  ON 41
eH2_2                -9.513842e-02 1 1  ON 42
eH2_3                -4.344143e-02 1 1  ON 43
eH2_4                 7.858012e-03 1 1  ON 44
eH2_5                 4.186009e-02 1 1  ON 45
eH2_6                 1.026760e-01 1 1  ON 46
eH2_7                 1.565281e-01 1 1  ON 47
eH2_8                 1.802818e-01 1 1  ON 48
eH2_9                 4.621148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.222642
====================================================
  Execution time = 2.3577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3913e-01
  Total weights = 2.0000e+06
  Execution time = 2.7070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240019532
                                         uncertainty =       0.004356547990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240019532
                                         uncertainty =       0.004356547990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411781105
  error estimate for blocks of size 2^( 2) =       0.000423549880
  error estimate for blocks of size 2^( 3) =       0.000435517215
  error estimate for blocks of size 2^( 4) =       0.000447149232
  error estimate for blocks of size 2^( 5) =       0.000457189202
  error estimate for blocks of size 2^( 6) =       0.000464879339
  error estimate for blocks of size 2^( 7) =       0.000472025187

      target function =                  N/A
              le_mean =     -16.909548709216
             les_mean =     286.271964736024
             stat err =       0.000460310740
             autocorr =       1.249595313150
              std dev =       0.582346422870
             le_variance =       0.339127356229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339243453242
                                         uncertainty =       0.004356629231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339243453242
                                         uncertainty =       0.004356629231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411783189
  error estimate for blocks of size 2^( 2) =       0.000423551901
  error estimate for blocks of size 2^( 3) =       0.000435519171
  error estimate for blocks of size 2^( 4) =       0.000447151144
  error estimate for blocks of size 2^( 5) =       0.000457191236
  error estimate for blocks of size 2^( 6) =       0.000464881395
  error estimate for blocks of size 2^( 7) =       0.000472027264

      target function =                  N/A
              le_mean =     -16.909548725374
             les_mean =     286.271968715440
             stat err =       0.000460312760
             autocorr =       1.249593629052
              std dev =       0.582349370399
             le_variance =       0.339130789205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241756234
                                         uncertainty =       0.004356589128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241756234
                                         uncertainty =       0.004356589128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411782159
  error estimate for blocks of size 2^( 2) =       0.000423550903
  error estimate for blocks of size 2^( 3) =       0.000435518205
  error estimate for blocks of size 2^( 4) =       0.000447150199
  error estimate for blocks of size 2^( 5) =       0.000457190231
  error estimate for blocks of size 2^( 6) =       0.000464880380
  error estimate for blocks of size 2^( 7) =       0.000472026239

      target function =                  N/A
              le_mean =     -16.909548717391
             les_mean =     286.271966748835
             stat err =       0.000460311762
             autocorr =       1.249594464614
              std dev =       0.582347913683
             le_variance =       0.339129092571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240237214
                                         uncertainty =       0.004356553149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240237214
                                         uncertainty =       0.004356553149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411781237
  error estimate for blocks of size 2^( 2) =       0.000423550008
  error estimate for blocks of size 2^( 3) =       0.000435517339
  error estimate for blocks of size 2^( 4) =       0.000447149353
  error estimate for blocks of size 2^( 5) =       0.000457189331
  error estimate for blocks of size 2^( 6) =       0.000464879469
  error estimate for blocks of size 2^( 7) =       0.000472025319

      target function =                  N/A
              le_mean =     -16.909548710237
             les_mean =     286.271964988192
             stat err =       0.000460310868
             autocorr =       1.249595206884
              std dev =       0.582346609733
             le_variance =       0.339127573867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909548709216        initial
     2.3842e+01     2.3842e+02             7.4008e-06       -16.909548725374  <--
     9.5367e+01     9.5367e+02             1.8513e-06       -16.909548717391
     3.8147e+02     3.8147e+03             4.6289e-07       -16.909548710237

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 3.7267e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.085719e-01 1 1  ON 0
 uu_1                 1.422381e-01 1 1  ON 1
 uu_2                 4.267909e-02 1 1  ON 2
 uu_3                -2.073648e-02 1 1  ON 3
 uu_4                -6.910202e-02 1 1  ON 4
 uu_5                -1.036191e-01 1 1  ON 5
 uu_6                -1.293019e-01 1 1  ON 6
 uu_7                -1.401041e-01 1 1  ON 7
 uu_8                -1.303577e-01 1 1  ON 8
 uu_9                -1.002087e-01 1 1  ON 9
 ud_0                 4.320780e-01 1 1  ON 10
 ud_1                 1.758400e-01 1 1  ON 11
 ud_2                 6.449884e-02 1 1  ON 12
 ud_3                -2.861720e-03 1 1  ON 13
 ud_4                -5.885885e-02 1 1  ON 14
 ud_5                -1.018300e-01 1 1  ON 15
 ud_6                -1.318384e-01 1 1  ON 16
 ud_7                -1.515608e-01 1 1  ON 17
 ud_8                -1.548368e-01 1 1  ON 18
 ud_9                -1.441949e-01 1 1  ON 19
 eO_0                -7.551694e-01 1 1  ON 20
 eO_1                -4.405962e-01 1 1  ON 21
 eO_2                -2.620080e-02 1 1  ON 22
 eO_3                 2.963180e-01 1 1  ON 23
 eO_4                 5.235595e-01 1 1  ON 24
 eO_5                 4.855292e-01 1 1  ON 25
 eO_6                 2.576842e-01 1 1  ON 26
 eO_7                -4.296263e-02 1 1  ON 27
 eO_8                -2.201729e-01 1 1  ON 28
 eO_9                -7.886948e-02 1 1  ON 29
eH1_0                -2.471313e-01 1 1  ON 30
eH1_1                -1.452825e-01 1 1  ON 31
eH1_2                -1.014600e-01 1 1  ON 32
eH1_3                -4.942786e-02 1 1  ON 33
eH1_4                 2.115685e-03 1 1  ON 34
eH1_5                 3.702980e-02 1 1  ON 35
eH1_6                 9.736254e-02 1 1  ON 36
eH1_7                 1.534767e-01 1 1  ON 37
eH1_8                 1.820172e-01 1 1  ON 38
eH1_9                 7.065775e-02 1 1  ON 39
eH2_0                -2.407462e-01 1 1  ON 40
eH2_1                -1.387949e-01 1 1  ON 41
eH2_2                -9.514179e-02 1 1  ON 42
eH2_3                -4.344206e-02 1 1  ON 43
eH2_4                 7.856260e-03 1 1  ON 44
eH2_5                 4.185628e-02 1 1  ON 45
eH2_6                 1.026752e-01 1 1  ON 46
eH2_7                 1.565306e-01 1 1  ON 47
eH2_8                 1.802856e-01 1 1  ON 48
eH2_9                 4.621626e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9217
    reference variance = 0.331076
====================================================
  Execution time = 2.4227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344770503324
                                         uncertainty =       0.009484804517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344770503324
                                         uncertainty =       0.009484804517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415148166
  error estimate for blocks of size 2^( 2) =       0.000428484317
  error estimate for blocks of size 2^( 3) =       0.000443639510
  error estimate for blocks of size 2^( 4) =       0.000460122309
  error estimate for blocks of size 2^( 5) =       0.000474887169
  error estimate for blocks of size 2^( 6) =       0.000481603270
  error estimate for blocks of size 2^( 7) =       0.000486070524

      target function =                  N/A
              le_mean =     -16.909069525817
             les_mean =     286.261328055671
             stat err =       0.000475670818
             autocorr =       1.312824794534
              std dev =       0.587108166452
             le_variance =       0.344695999115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690906952582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909069525817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909069618089       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909069741147       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909069739254       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909069796366       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909069814489       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909069856147       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909069835129       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.207608e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909069525817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909069549730       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909069581673       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909069581076       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909069596036       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909069601256       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909069611584       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909069606628       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.106948e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909069525817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909069531850       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909069539914       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909069539757       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909069543541       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909069544895       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909069547473       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909069546254       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.803726e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0629e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.085744e-01 1 1  ON 0
 uu_1                 1.422400e-01 1 1  ON 1
 uu_2                 4.267748e-02 1 1  ON 2
 uu_3                -2.074101e-02 1 1  ON 3
 uu_4                -6.909729e-02 1 1  ON 4
 uu_5                -1.036236e-01 1 1  ON 5
 uu_6                -1.293021e-01 1 1  ON 6
 uu_7                -1.401079e-01 1 1  ON 7
 uu_8                -1.303573e-01 1 1  ON 8
 uu_9                -1.002111e-01 1 1  ON 9
 ud_0                 4.320890e-01 1 1  ON 10
 ud_1                 1.758370e-01 1 1  ON 11
 ud_2                 6.449663e-02 1 1  ON 12
 ud_3                -2.863604e-03 1 1  ON 13
 ud_4                -5.885584e-02 1 1  ON 14
 ud_5                -1.018359e-01 1 1  ON 15
 ud_6                -1.318401e-01 1 1  ON 16
 ud_7                -1.515590e-01 1 1  ON 17
 ud_8                -1.548361e-01 1 1  ON 18
 ud_9                -1.441952e-01 1 1  ON 19
 eO_0                -7.551660e-01 1 1  ON 20
 eO_1                -4.405996e-01 1 1  ON 21
 eO_2                -2.620291e-02 1 1  ON 22
 eO_3                 2.963179e-01 1 1  ON 23
 eO_4                 5.235602e-01 1 1  ON 24
 eO_5                 4.855326e-01 1 1  ON 25
 eO_6                 2.576888e-01 1 1  ON 26
 eO_7                -4.295887e-02 1 1  ON 27
 eO_8                -2.201757e-01 1 1  ON 28
 eO_9                -7.887555e-02 1 1  ON 29
eH1_0                -2.471328e-01 1 1  ON 30
eH1_1                -1.452813e-01 1 1  ON 31
eH1_2                -1.014640e-01 1 1  ON 32
eH1_3                -4.943278e-02 1 1  ON 33
eH1_4                 2.109857e-03 1 1  ON 34
eH1_5                 3.702121e-02 1 1  ON 35
eH1_6                 9.736464e-02 1 1  ON 36
eH1_7                 1.534785e-01 1 1  ON 37
eH1_8                 1.820251e-01 1 1  ON 38
eH1_9                 7.066787e-02 1 1  ON 39
eH2_0                -2.407497e-01 1 1  ON 40
eH2_1                -1.387956e-01 1 1  ON 41
eH2_2                -9.514533e-02 1 1  ON 42
eH2_3                -4.344424e-02 1 1  ON 43
eH2_4                 7.856217e-03 1 1  ON 44
eH2_5                 4.185605e-02 1 1  ON 45
eH2_6                 1.026703e-01 1 1  ON 46
eH2_7                 1.565303e-01 1 1  ON 47
eH2_8                 1.802915e-01 1 1  ON 48
eH2_9                 4.622506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.7942
    reference variance = 0.384823
====================================================
  Execution time = 2.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3743e-01
  Total weights = 2.0000e+06
  Execution time = 2.7011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337351387458
                                         uncertainty =       0.006358265315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337351387458
                                         uncertainty =       0.006358265315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410741794
  error estimate for blocks of size 2^( 2) =       0.000422582882
  error estimate for blocks of size 2^( 3) =       0.000435092520
  error estimate for blocks of size 2^( 4) =       0.000446668139
  error estimate for blocks of size 2^( 5) =       0.000455484087
  error estimate for blocks of size 2^( 6) =       0.000462821558
  error estimate for blocks of size 2^( 7) =       0.000467556608

      target function =                  N/A
              le_mean =     -16.910446176702
             les_mean =     286.300607369269
             stat err =       0.000458132598
             autocorr =       1.244069371058
              std dev =       0.580876615862
             le_variance =       0.337417642856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337399268478
                                         uncertainty =       0.006359554047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337399268478
                                         uncertainty =       0.006359554047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410770936
  error estimate for blocks of size 2^( 2) =       0.000422610475
  error estimate for blocks of size 2^( 3) =       0.000435119259
  error estimate for blocks of size 2^( 4) =       0.000446694042
  error estimate for blocks of size 2^( 5) =       0.000455508333
  error estimate for blocks of size 2^( 6) =       0.000462845696
  error estimate for blocks of size 2^( 7) =       0.000467578917

      target function =                  N/A
              le_mean =     -16.910446195091
             les_mean =     286.300655871281
             stat err =       0.000458156747
             autocorr =       1.244024000696
              std dev =       0.580917828063
             le_variance =       0.337465522962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337376509594
                                         uncertainty =       0.006358943609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337376509594
                                         uncertainty =       0.006358943609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410757084
  error estimate for blocks of size 2^( 2) =       0.000422597354
  error estimate for blocks of size 2^( 3) =       0.000435106545
  error estimate for blocks of size 2^( 4) =       0.000446681728
  error estimate for blocks of size 2^( 5) =       0.000455496813
  error estimate for blocks of size 2^( 6) =       0.000462834231
  error estimate for blocks of size 2^( 7) =       0.000467568311

      target function =                  N/A
              le_mean =     -16.910446185021
             les_mean =     286.300632772188
             stat err =       0.000458145271
             autocorr =       1.244045575205
              std dev =       0.580898239289
             le_variance =       0.337442764409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354565361
                                         uncertainty =       0.006358351217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354565361
                                         uncertainty =       0.006358351217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410743728
  error estimate for blocks of size 2^( 2) =       0.000422584712
  error estimate for blocks of size 2^( 3) =       0.000435094294
  error estimate for blocks of size 2^( 4) =       0.000446669858
  error estimate for blocks of size 2^( 5) =       0.000455485697
  error estimate for blocks of size 2^( 6) =       0.000462823161
  error estimate for blocks of size 2^( 7) =       0.000467558088

      target function =                  N/A
              le_mean =     -16.910446177539
             les_mean =     286.300610575420
             stat err =       0.000458134201
             autocorr =       1.244066359644
              std dev =       0.580879351226
             le_variance =       0.337420820681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910446176702        initial
     5.9605e+00     5.9605e+01             4.2076e-05       -16.910446195091  <--
     2.3842e+01     2.3842e+02             1.1069e-05       -16.910446185021
     9.5367e+01     9.5367e+02             2.8037e-06       -16.910446177539

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 3.7393e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.085816e-01 1 1  ON 0
 uu_1                 1.422452e-01 1 1  ON 1
 uu_2                 4.267285e-02 1 1  ON 2
 uu_3                -2.075369e-02 1 1  ON 3
 uu_4                -6.908436e-02 1 1  ON 4
 uu_5                -1.036362e-01 1 1  ON 5
 uu_6                -1.293026e-01 1 1  ON 6
 uu_7                -1.401191e-01 1 1  ON 7
 uu_8                -1.303560e-01 1 1  ON 8
 uu_9                -1.002180e-01 1 1  ON 9
 ud_0                 4.321201e-01 1 1  ON 10
 ud_1                 1.758288e-01 1 1  ON 11
 ud_2                 6.449046e-02 1 1  ON 12
 ud_3                -2.868738e-03 1 1  ON 13
 ud_4                -5.884742e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318452e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548339e-01 1 1  ON 18
 ud_9                -1.441961e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406090e-01 1 1  ON 21
 eO_2                -2.620954e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235627e-01 1 1  ON 24
 eO_5                 4.855427e-01 1 1  ON 25
 eO_6                 2.577027e-01 1 1  ON 26
 eO_7                -4.294758e-02 1 1  ON 27
 eO_8                -2.201843e-01 1 1  ON 28
 eO_9                -7.889370e-02 1 1  ON 29
eH1_0                -2.471373e-01 1 1  ON 30
eH1_1                -1.452781e-01 1 1  ON 31
eH1_2                -1.014759e-01 1 1  ON 32
eH1_3                -4.944730e-02 1 1  ON 33
eH1_4                 2.092422e-03 1 1  ON 34
eH1_5                 3.699565e-02 1 1  ON 35
eH1_6                 9.737091e-02 1 1  ON 36
eH1_7                 1.534837e-01 1 1  ON 37
eH1_8                 1.820488e-01 1 1  ON 38
eH1_9                 7.069818e-02 1 1  ON 39
eH2_0                -2.407599e-01 1 1  ON 40
eH2_1                -1.387978e-01 1 1  ON 41
eH2_2                -9.515588e-02 1 1  ON 42
eH2_3                -4.345063e-02 1 1  ON 43
eH2_4                 7.855930e-03 1 1  ON 44
eH2_5                 4.185548e-02 1 1  ON 45
eH2_6                 1.026557e-01 1 1  ON 46
eH2_7                 1.565295e-01 1 1  ON 47
eH2_8                 1.803091e-01 1 1  ON 48
eH2_9                 4.625139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.53539
====================================================
  Execution time = 2.4261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331500908304
                                         uncertainty =       0.003604608376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331500908304
                                         uncertainty =       0.003604608376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407108964
  error estimate for blocks of size 2^( 2) =       0.000419066078
  error estimate for blocks of size 2^( 3) =       0.000431132172
  error estimate for blocks of size 2^( 4) =       0.000443438178
  error estimate for blocks of size 2^( 5) =       0.000453467878
  error estimate for blocks of size 2^( 6) =       0.000460171359
  error estimate for blocks of size 2^( 7) =       0.000466162972

      target function =                  N/A
              le_mean =     -16.909479937724
             les_mean =     286.261987015656
             stat err =       0.000455810097
             autocorr =       1.253564118476
              std dev =       0.575739018216
             le_variance =       0.331475417097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690947993772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909479937724       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909480213629       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909480360853       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909480565667       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909480759559       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909480791448       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909480657207       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909480712011       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.517006e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909479937724       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909480013209       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909480054584       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909480119794       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909480167475       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909480181003       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909480141559       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909480153098       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.837408e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909479937724       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909479957051       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909479967760       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909479985230       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909479996942       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909480000785       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909479990581       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909479993316       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.624029e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0591e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.085561e-01 1 1  ON 0
 uu_1                 1.422514e-01 1 1  ON 1
 uu_2                 4.267952e-02 1 1  ON 2
 uu_3                -2.075413e-02 1 1  ON 3
 uu_4                -6.907659e-02 1 1  ON 4
 uu_5                -1.036195e-01 1 1  ON 5
 uu_6                -1.293040e-01 1 1  ON 6
 uu_7                -1.401508e-01 1 1  ON 7
 uu_8                -1.303628e-01 1 1  ON 8
 uu_9                -1.002245e-01 1 1  ON 9
 ud_0                 4.321352e-01 1 1  ON 10
 ud_1                 1.758326e-01 1 1  ON 11
 ud_2                 6.448387e-02 1 1  ON 12
 ud_3                -2.870789e-03 1 1  ON 13
 ud_4                -5.884768e-02 1 1  ON 14
 ud_5                -1.018581e-01 1 1  ON 15
 ud_6                -1.318532e-01 1 1  ON 16
 ud_7                -1.515727e-01 1 1  ON 17
 ud_8                -1.548345e-01 1 1  ON 18
 ud_9                -1.441813e-01 1 1  ON 19
 eO_0                -7.551628e-01 1 1  ON 20
 eO_1                -4.406067e-01 1 1  ON 21
 eO_2                -2.621578e-02 1 1  ON 22
 eO_3                 2.963378e-01 1 1  ON 23
 eO_4                 5.235708e-01 1 1  ON 24
 eO_5                 4.855438e-01 1 1  ON 25
 eO_6                 2.577053e-01 1 1  ON 26
 eO_7                -4.294259e-02 1 1  ON 27
 eO_8                -2.201939e-01 1 1  ON 28
 eO_9                -7.890902e-02 1 1  ON 29
eH1_0                -2.471612e-01 1 1  ON 30
eH1_1                -1.453000e-01 1 1  ON 31
eH1_2                -1.014722e-01 1 1  ON 32
eH1_3                -4.946714e-02 1 1  ON 33
eH1_4                 2.102781e-03 1 1  ON 34
eH1_5                 3.699431e-02 1 1  ON 35
eH1_6                 9.736714e-02 1 1  ON 36
eH1_7                 1.534889e-01 1 1  ON 37
eH1_8                 1.820684e-01 1 1  ON 38
eH1_9                 7.072792e-02 1 1  ON 39
eH2_0                -2.407684e-01 1 1  ON 40
eH2_1                -1.388058e-01 1 1  ON 41
eH2_2                -9.517767e-02 1 1  ON 42
eH2_3                -4.347702e-02 1 1  ON 43
eH2_4                 7.847521e-03 1 1  ON 44
eH2_5                 4.184055e-02 1 1  ON 45
eH2_6                 1.026493e-01 1 1  ON 46
eH2_7                 1.565521e-01 1 1  ON 47
eH2_8                 1.803400e-01 1 1  ON 48
eH2_9                 4.628977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8838
    reference variance = 0.19291
====================================================
  Execution time = 2.4857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2932e-01
  Total weights = 2.0000e+06
  Execution time = 3.2223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329328932373
                                         uncertainty =       0.002998802512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329328932373
                                         uncertainty =       0.002998802512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405776928
  error estimate for blocks of size 2^( 2) =       0.000417614003
  error estimate for blocks of size 2^( 3) =       0.000429922505
  error estimate for blocks of size 2^( 4) =       0.000441515176
  error estimate for blocks of size 2^( 5) =       0.000450936063
  error estimate for blocks of size 2^( 6) =       0.000459600718
  error estimate for blocks of size 2^( 7) =       0.000463738932

      target function =                  N/A
              le_mean =     -16.910582838390
             les_mean =     286.297121600160
             stat err =       0.000453947722
             autocorr =       1.251517661573
              std dev =       0.573855235027
             le_variance =       0.329309830768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329353828170
                                         uncertainty =       0.002999139386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329353828170
                                         uncertainty =       0.002999139386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405792246
  error estimate for blocks of size 2^( 2) =       0.000417628495
  error estimate for blocks of size 2^( 3) =       0.000429936515
  error estimate for blocks of size 2^( 4) =       0.000441528145
  error estimate for blocks of size 2^( 5) =       0.000450946524
  error estimate for blocks of size 2^( 6) =       0.000459608642
  error estimate for blocks of size 2^( 7) =       0.000463745811

      target function =                  N/A
              le_mean =     -16.910582350650
             les_mean =     286.297129967422
             stat err =       0.000453957280
             autocorr =       1.251475876041
              std dev =       0.573876897916
             le_variance =       0.329334693962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329343522166
                                         uncertainty =       0.002998994099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329343522166
                                         uncertainty =       0.002998994099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405785904
  error estimate for blocks of size 2^( 2) =       0.000417622435
  error estimate for blocks of size 2^( 3) =       0.000429930617
  error estimate for blocks of size 2^( 4) =       0.000441522709
  error estimate for blocks of size 2^( 5) =       0.000450942169
  error estimate for blocks of size 2^( 6) =       0.000459605463
  error estimate for blocks of size 2^( 7) =       0.000463743138

      target function =                  N/A
              le_mean =     -16.910582532714
             les_mean =     286.297125831235
             stat err =       0.000453953370
             autocorr =       1.251493432208
              std dev =       0.573867929209
             le_variance =       0.329324400175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329330822031
                                         uncertainty =       0.002998827269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329330822031
                                         uncertainty =       0.002998827269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405778091
  error estimate for blocks of size 2^( 2) =       0.000417615092
  error estimate for blocks of size 2^( 3) =       0.000429923551
  error estimate for blocks of size 2^( 4) =       0.000441516148
  error estimate for blocks of size 2^( 5) =       0.000450936849
  error estimate for blocks of size 2^( 6) =       0.000459601331
  error estimate for blocks of size 2^( 7) =       0.000463739477

      target function =                  N/A
              le_mean =     -16.910582796681
             les_mean =     286.297122076448
             stat err =       0.000453948451
             autocorr =       1.251514508828
              std dev =       0.573856879119
             le_variance =       0.329311717712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910582838390        initial  <--
     1.4901e+00     1.4901e+01             1.5170e-04       -16.910582350650
     5.9605e+00     5.9605e+01             3.8374e-05       -16.910582532714
     2.3842e+01     2.3842e+02             9.6240e-06       -16.910582796681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0623
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.085816e-01 1 1  ON 0
 uu_1                 1.422452e-01 1 1  ON 1
 uu_2                 4.267285e-02 1 1  ON 2
 uu_3                -2.075369e-02 1 1  ON 3
 uu_4                -6.908436e-02 1 1  ON 4
 uu_5                -1.036362e-01 1 1  ON 5
 uu_6                -1.293026e-01 1 1  ON 6
 uu_7                -1.401191e-01 1 1  ON 7
 uu_8                -1.303560e-01 1 1  ON 8
 uu_9                -1.002180e-01 1 1  ON 9
 ud_0                 4.321201e-01 1 1  ON 10
 ud_1                 1.758288e-01 1 1  ON 11
 ud_2                 6.449046e-02 1 1  ON 12
 ud_3                -2.868738e-03 1 1  ON 13
 ud_4                -5.884742e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318452e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548339e-01 1 1  ON 18
 ud_9                -1.441961e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406090e-01 1 1  ON 21
 eO_2                -2.620954e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235627e-01 1 1  ON 24
 eO_5                 4.855427e-01 1 1  ON 25
 eO_6                 2.577027e-01 1 1  ON 26
 eO_7                -4.294758e-02 1 1  ON 27
 eO_8                -2.201843e-01 1 1  ON 28
 eO_9                -7.889370e-02 1 1  ON 29
eH1_0                -2.471373e-01 1 1  ON 30
eH1_1                -1.452781e-01 1 1  ON 31
eH1_2                -1.014759e-01 1 1  ON 32
eH1_3                -4.944730e-02 1 1  ON 33
eH1_4                 2.092422e-03 1 1  ON 34
eH1_5                 3.699565e-02 1 1  ON 35
eH1_6                 9.737091e-02 1 1  ON 36
eH1_7                 1.534837e-01 1 1  ON 37
eH1_8                 1.820488e-01 1 1  ON 38
eH1_9                 7.069818e-02 1 1  ON 39
eH2_0                -2.407599e-01 1 1  ON 40
eH2_1                -1.387978e-01 1 1  ON 41
eH2_2                -9.515588e-02 1 1  ON 42
eH2_3                -4.345063e-02 1 1  ON 43
eH2_4                 7.855930e-03 1 1  ON 44
eH2_5                 4.185548e-02 1 1  ON 45
eH2_6                 1.026557e-01 1 1  ON 46
eH2_7                 1.565295e-01 1 1  ON 47
eH2_8                 1.803091e-01 1 1  ON 48
eH2_9                 4.625139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.256949
====================================================
  Execution time = 2.4295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2889e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328913869148
                                         uncertainty =       0.004224582986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328913869148
                                         uncertainty =       0.004224582986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405517174
  error estimate for blocks of size 2^( 2) =       0.000417365333
  error estimate for blocks of size 2^( 3) =       0.000429661988
  error estimate for blocks of size 2^( 4) =       0.000441478237
  error estimate for blocks of size 2^( 5) =       0.000451936608
  error estimate for blocks of size 2^( 6) =       0.000459716942
  error estimate for blocks of size 2^( 7) =       0.000465531255

      target function =                  N/A
              le_mean =     -16.910054096416
             les_mean =     286.278817736664
             stat err =       0.000454665760
             autocorr =       1.257088911434
              std dev =       0.573487887749
             le_variance =       0.328888357395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691005409642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910054096416       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910054109283       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910054061790       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910054060324       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910054063751       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910054057457       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910054070625       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910054071208       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.273907e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910054096416       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910054099662       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910054087634       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910054087214       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910054088076       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910054086389       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910054089517       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910054089629       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.186426e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910054096416       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910054097229       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910054094212       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910054094104       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910054094320       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910054093891       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910054094662       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910054094687       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.967183e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0781e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.085805e-01 1 1  ON 0
 uu_1                 1.422464e-01 1 1  ON 1
 uu_2                 4.267376e-02 1 1  ON 2
 uu_3                -2.075407e-02 1 1  ON 3
 uu_4                -6.908366e-02 1 1  ON 4
 uu_5                -1.036356e-01 1 1  ON 5
 uu_6                -1.293018e-01 1 1  ON 6
 uu_7                -1.401216e-01 1 1  ON 7
 uu_8                -1.303576e-01 1 1  ON 8
 uu_9                -1.002193e-01 1 1  ON 9
 ud_0                 4.321201e-01 1 1  ON 10
 ud_1                 1.758305e-01 1 1  ON 11
 ud_2                 6.449005e-02 1 1  ON 12
 ud_3                -2.867456e-03 1 1  ON 13
 ud_4                -5.884608e-02 1 1  ON 14
 ud_5                -1.018535e-01 1 1  ON 15
 ud_6                -1.318451e-01 1 1  ON 16
 ud_7                -1.515519e-01 1 1  ON 17
 ud_8                -1.548364e-01 1 1  ON 18
 ud_9                -1.441981e-01 1 1  ON 19
 eO_0                -7.551584e-01 1 1  ON 20
 eO_1                -4.406094e-01 1 1  ON 21
 eO_2                -2.620820e-02 1 1  ON 22
 eO_3                 2.963196e-01 1 1  ON 23
 eO_4                 5.235628e-01 1 1  ON 24
 eO_5                 4.855440e-01 1 1  ON 25
 eO_6                 2.577044e-01 1 1  ON 26
 eO_7                -4.294693e-02 1 1  ON 27
 eO_8                -2.201868e-01 1 1  ON 28
 eO_9                -7.889592e-02 1 1  ON 29
eH1_0                -2.471367e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014756e-01 1 1  ON 32
eH1_3                -4.944979e-02 1 1  ON 33
eH1_4                 2.091328e-03 1 1  ON 34
eH1_5                 3.699475e-02 1 1  ON 35
eH1_6                 9.736967e-02 1 1  ON 36
eH1_7                 1.534839e-01 1 1  ON 37
eH1_8                 1.820507e-01 1 1  ON 38
eH1_9                 7.070137e-02 1 1  ON 39
eH2_0                -2.407614e-01 1 1  ON 40
eH2_1                -1.388003e-01 1 1  ON 41
eH2_2                -9.515829e-02 1 1  ON 42
eH2_3                -4.345269e-02 1 1  ON 43
eH2_4                 7.854237e-03 1 1  ON 44
eH2_5                 4.185648e-02 1 1  ON 45
eH2_6                 1.026574e-01 1 1  ON 46
eH2_7                 1.565314e-01 1 1  ON 47
eH2_8                 1.803113e-01 1 1  ON 48
eH2_9                 4.625442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.159453
====================================================
  Execution time = 2.3962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4177e-01
  Total weights = 2.0000e+06
  Execution time = 2.7023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341917403713
                                         uncertainty =       0.005895026191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341917403713
                                         uncertainty =       0.005895026191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413381915
  error estimate for blocks of size 2^( 2) =       0.000425319079
  error estimate for blocks of size 2^( 3) =       0.000437554259
  error estimate for blocks of size 2^( 4) =       0.000449207887
  error estimate for blocks of size 2^( 5) =       0.000460165270
  error estimate for blocks of size 2^( 6) =       0.000468207271
  error estimate for blocks of size 2^( 7) =       0.000474500792

      target function =                  N/A
              le_mean =     -16.909645083947
             les_mean =     286.277865909670
             stat err =       0.000463020305
             autocorr =       1.254576438893
              std dev =       0.584610310812
             le_variance =       0.341769215507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916249694
                                         uncertainty =       0.005895174734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916249694
                                         uncertainty =       0.005895174734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413381220
  error estimate for blocks of size 2^( 2) =       0.000425318340
  error estimate for blocks of size 2^( 3) =       0.000437553482
  error estimate for blocks of size 2^( 4) =       0.000449207185
  error estimate for blocks of size 2^( 5) =       0.000460164487
  error estimate for blocks of size 2^( 6) =       0.000468206535
  error estimate for blocks of size 2^( 7) =       0.000474500071

      target function =                  N/A
              le_mean =     -16.909645082403
             les_mean =     286.277864707443
             stat err =       0.000463019570
             autocorr =       1.254576675964
              std dev =       0.584609327247
             le_variance =       0.341768065504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916785490
                                         uncertainty =       0.005895101746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916785490
                                         uncertainty =       0.005895101746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413381542
  error estimate for blocks of size 2^( 2) =       0.000425318685
  error estimate for blocks of size 2^( 3) =       0.000437553846
  error estimate for blocks of size 2^( 4) =       0.000449207513
  error estimate for blocks of size 2^( 5) =       0.000460164855
  error estimate for blocks of size 2^( 6) =       0.000468206880
  error estimate for blocks of size 2^( 7) =       0.000474500409

      target function =                  N/A
              le_mean =     -16.909645083501
             les_mean =     286.277865278432
             stat err =       0.000463019914
             autocorr =       1.254576584174
              std dev =       0.584609783832
             le_variance =       0.341768599352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341917325034
                                         uncertainty =       0.005895035676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341917325034
                                         uncertainty =       0.005895035676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413381868
  error estimate for blocks of size 2^( 2) =       0.000425319029
  error estimate for blocks of size 2^( 3) =       0.000437554206
  error estimate for blocks of size 2^( 4) =       0.000449207839
  error estimate for blocks of size 2^( 5) =       0.000460165217
  error estimate for blocks of size 2^( 6) =       0.000468207221
  error estimate for blocks of size 2^( 7) =       0.000474500743

      target function =                  N/A
              le_mean =     -16.909645083893
             les_mean =     286.277865829442
             stat err =       0.000463020255
             autocorr =       1.254576457925
              std dev =       0.584610243742
             le_variance =       0.341769137088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909645083947        initial  <--
     1.4901e+01     1.4901e+02             1.2739e-05       -16.909645082403
     5.9605e+01     5.9605e+02             3.1864e-06       -16.909645083501
     2.3842e+02     2.3842e+03             7.9672e-07       -16.909645083893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6369
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.085816e-01 1 1  ON 0
 uu_1                 1.422452e-01 1 1  ON 1
 uu_2                 4.267285e-02 1 1  ON 2
 uu_3                -2.075369e-02 1 1  ON 3
 uu_4                -6.908436e-02 1 1  ON 4
 uu_5                -1.036362e-01 1 1  ON 5
 uu_6                -1.293026e-01 1 1  ON 6
 uu_7                -1.401191e-01 1 1  ON 7
 uu_8                -1.303560e-01 1 1  ON 8
 uu_9                -1.002180e-01 1 1  ON 9
 ud_0                 4.321201e-01 1 1  ON 10
 ud_1                 1.758288e-01 1 1  ON 11
 ud_2                 6.449046e-02 1 1  ON 12
 ud_3                -2.868738e-03 1 1  ON 13
 ud_4                -5.884742e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318452e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548339e-01 1 1  ON 18
 ud_9                -1.441961e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406090e-01 1 1  ON 21
 eO_2                -2.620954e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235627e-01 1 1  ON 24
 eO_5                 4.855427e-01 1 1  ON 25
 eO_6                 2.577027e-01 1 1  ON 26
 eO_7                -4.294758e-02 1 1  ON 27
 eO_8                -2.201843e-01 1 1  ON 28
 eO_9                -7.889370e-02 1 1  ON 29
eH1_0                -2.471373e-01 1 1  ON 30
eH1_1                -1.452781e-01 1 1  ON 31
eH1_2                -1.014759e-01 1 1  ON 32
eH1_3                -4.944730e-02 1 1  ON 33
eH1_4                 2.092422e-03 1 1  ON 34
eH1_5                 3.699565e-02 1 1  ON 35
eH1_6                 9.737091e-02 1 1  ON 36
eH1_7                 1.534837e-01 1 1  ON 37
eH1_8                 1.820488e-01 1 1  ON 38
eH1_9                 7.069818e-02 1 1  ON 39
eH2_0                -2.407599e-01 1 1  ON 40
eH2_1                -1.387978e-01 1 1  ON 41
eH2_2                -9.515588e-02 1 1  ON 42
eH2_3                -4.345063e-02 1 1  ON 43
eH2_4                 7.855930e-03 1 1  ON 44
eH2_5                 4.185548e-02 1 1  ON 45
eH2_6                 1.026557e-01 1 1  ON 46
eH2_7                 1.565295e-01 1 1  ON 47
eH2_8                 1.803091e-01 1 1  ON 48
eH2_9                 4.625139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9574
    reference variance = 0.302875
====================================================
  Execution time = 2.4336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3261e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332264759648
                                         uncertainty =       0.003978487024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332264759648
                                         uncertainty =       0.003978487024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407803087
  error estimate for blocks of size 2^( 2) =       0.000420113499
  error estimate for blocks of size 2^( 3) =       0.000432544905
  error estimate for blocks of size 2^( 4) =       0.000444233950
  error estimate for blocks of size 2^( 5) =       0.000454860331
  error estimate for blocks of size 2^( 6) =       0.000464426392
  error estimate for blocks of size 2^( 7) =       0.000469943784

      target function =                  N/A
              le_mean =     -16.910372949789
             les_mean =     286.293319850810
             stat err =       0.000458366114
             autocorr =       1.263350884563
              std dev =       0.576720656948
             le_variance =       0.332606716150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691037294979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910372949789       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910372955538       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910372962475       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910372965670       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910372961213       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910372955683       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910372956994       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910372957337       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.730041e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910372949789       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910372951227       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910372952967       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910372953769       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910372952656       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910372951272       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910372951598       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910372951682       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.326646e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910372949789       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910372950149       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910372950584       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910372950785       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910372950506       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910372950160       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910372950242       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910372950260       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.081758e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0775e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.085815e-01 1 1  ON 0
 uu_1                 1.422452e-01 1 1  ON 1
 uu_2                 4.267293e-02 1 1  ON 2
 uu_3                -2.075380e-02 1 1  ON 3
 uu_4                -6.908423e-02 1 1  ON 4
 uu_5                -1.036362e-01 1 1  ON 5
 uu_6                -1.293029e-01 1 1  ON 6
 uu_7                -1.401192e-01 1 1  ON 7
 uu_8                -1.303561e-01 1 1  ON 8
 uu_9                -1.002181e-01 1 1  ON 9
 ud_0                 4.321197e-01 1 1  ON 10
 ud_1                 1.758289e-01 1 1  ON 11
 ud_2                 6.449054e-02 1 1  ON 12
 ud_3                -2.868863e-03 1 1  ON 13
 ud_4                -5.884723e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318451e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548339e-01 1 1  ON 18
 ud_9                -1.441962e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406092e-01 1 1  ON 21
 eO_2                -2.620932e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235628e-01 1 1  ON 24
 eO_5                 4.855429e-01 1 1  ON 25
 eO_6                 2.577028e-01 1 1  ON 26
 eO_7                -4.294745e-02 1 1  ON 27
 eO_8                -2.201844e-01 1 1  ON 28
 eO_9                -7.889392e-02 1 1  ON 29
eH1_0                -2.471375e-01 1 1  ON 30
eH1_1                -1.452781e-01 1 1  ON 31
eH1_2                -1.014760e-01 1 1  ON 32
eH1_3                -4.944751e-02 1 1  ON 33
eH1_4                 2.092237e-03 1 1  ON 34
eH1_5                 3.699544e-02 1 1  ON 35
eH1_6                 9.737108e-02 1 1  ON 36
eH1_7                 1.534839e-01 1 1  ON 37
eH1_8                 1.820491e-01 1 1  ON 38
eH1_9                 7.069844e-02 1 1  ON 39
eH2_0                -2.407604e-01 1 1  ON 40
eH2_1                -1.387978e-01 1 1  ON 41
eH2_2                -9.515581e-02 1 1  ON 42
eH2_3                -4.345083e-02 1 1  ON 43
eH2_4                 7.855828e-03 1 1  ON 44
eH2_5                 4.185548e-02 1 1  ON 45
eH2_6                 1.026557e-01 1 1  ON 46
eH2_7                 1.565294e-01 1 1  ON 47
eH2_8                 1.803093e-01 1 1  ON 48
eH2_9                 4.625181e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8867
    reference variance = 0.257243
====================================================
  Execution time = 2.3817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2986e-01
  Total weights = 2.0000e+06
  Execution time = 2.7058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329940056398
                                         uncertainty =       0.005438540782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329940056398
                                         uncertainty =       0.005438540782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406115450
  error estimate for blocks of size 2^( 2) =       0.000418061677
  error estimate for blocks of size 2^( 3) =       0.000431239250
  error estimate for blocks of size 2^( 4) =       0.000443472119
  error estimate for blocks of size 2^( 5) =       0.000454984576
  error estimate for blocks of size 2^( 6) =       0.000464874891
  error estimate for blocks of size 2^( 7) =       0.000469505914

      target function =                  N/A
              le_mean =     -16.909809149986
             les_mean =     286.271504841621
             stat err =       0.000458209375
             autocorr =       1.273001507285
              std dev =       0.574333977398
             le_variance =       0.329859517594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329938684702
                                         uncertainty =       0.005438539211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329938684702
                                         uncertainty =       0.005438539211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406114606
  error estimate for blocks of size 2^( 2) =       0.000418060879
  error estimate for blocks of size 2^( 3) =       0.000431238488
  error estimate for blocks of size 2^( 4) =       0.000443471381
  error estimate for blocks of size 2^( 5) =       0.000454983880
  error estimate for blocks of size 2^( 6) =       0.000464874212
  error estimate for blocks of size 2^( 7) =       0.000469505283

      target function =                  N/A
              le_mean =     -16.909809163483
             les_mean =     286.271503926424
             stat err =       0.000458208689
             autocorr =       1.273002988195
              std dev =       0.574332783257
             le_variance =       0.329858145924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939368699
                                         uncertainty =       0.005438539999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939368699
                                         uncertainty =       0.005438539999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406115027
  error estimate for blocks of size 2^( 2) =       0.000418061277
  error estimate for blocks of size 2^( 3) =       0.000431238868
  error estimate for blocks of size 2^( 4) =       0.000443471749
  error estimate for blocks of size 2^( 5) =       0.000454984227
  error estimate for blocks of size 2^( 6) =       0.000464874551
  error estimate for blocks of size 2^( 7) =       0.000469505598

      target function =                  N/A
              le_mean =     -16.909809156746
             les_mean =     286.271504382565
             stat err =       0.000458209031
             autocorr =       1.273002249761
              std dev =       0.574333378716
             le_variance =       0.329858829908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939970376
                                         uncertainty =       0.005438540684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939970376
                                         uncertainty =       0.005438540684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406115397
  error estimate for blocks of size 2^( 2) =       0.000418061627
  error estimate for blocks of size 2^( 3) =       0.000431239203
  error estimate for blocks of size 2^( 4) =       0.000443472073
  error estimate for blocks of size 2^( 5) =       0.000454984533
  error estimate for blocks of size 2^( 6) =       0.000464874849
  error estimate for blocks of size 2^( 7) =       0.000469505875

      target function =                  N/A
              le_mean =     -16.909809150831
             les_mean =     286.271504784187
             stat err =       0.000458209332
             autocorr =       1.273001600155
              std dev =       0.574333902511
             le_variance =       0.329859431574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909809149986        initial
     1.4901e+02     1.4901e+03             1.7300e-06       -16.909809163483  <--
     5.9605e+02     5.9605e+03             4.3266e-07       -16.909809156746
     2.3842e+03     2.3842e+04             1.0818e-07       -16.909809150831

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 3.7591e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.085814e-01 1 1  ON 0
 uu_1                 1.422453e-01 1 1  ON 1
 uu_2                 4.267318e-02 1 1  ON 2
 uu_3                -2.075414e-02 1 1  ON 3
 uu_4                -6.908386e-02 1 1  ON 4
 uu_5                -1.036360e-01 1 1  ON 5
 uu_6                -1.293035e-01 1 1  ON 6
 uu_7                -1.401193e-01 1 1  ON 7
 uu_8                -1.303564e-01 1 1  ON 8
 uu_9                -1.002182e-01 1 1  ON 9
 ud_0                 4.321187e-01 1 1  ON 10
 ud_1                 1.758291e-01 1 1  ON 11
 ud_2                 6.449078e-02 1 1  ON 12
 ud_3                -2.869236e-03 1 1  ON 13
 ud_4                -5.884667e-02 1 1  ON 14
 ud_5                -1.018530e-01 1 1  ON 15
 ud_6                -1.318445e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548336e-01 1 1  ON 18
 ud_9                -1.441963e-01 1 1  ON 19
 eO_0                -7.551572e-01 1 1  ON 20
 eO_1                -4.406097e-01 1 1  ON 21
 eO_2                -2.620867e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235629e-01 1 1  ON 24
 eO_5                 4.855435e-01 1 1  ON 25
 eO_6                 2.577033e-01 1 1  ON 26
 eO_7                -4.294708e-02 1 1  ON 27
 eO_8                -2.201849e-01 1 1  ON 28
 eO_9                -7.889459e-02 1 1  ON 29
eH1_0                -2.471379e-01 1 1  ON 30
eH1_1                -1.452782e-01 1 1  ON 31
eH1_2                -1.014764e-01 1 1  ON 32
eH1_3                -4.944815e-02 1 1  ON 33
eH1_4                 2.091680e-03 1 1  ON 34
eH1_5                 3.699480e-02 1 1  ON 35
eH1_6                 9.737158e-02 1 1  ON 36
eH1_7                 1.534845e-01 1 1  ON 37
eH1_8                 1.820498e-01 1 1  ON 38
eH1_9                 7.069921e-02 1 1  ON 39
eH2_0                -2.407617e-01 1 1  ON 40
eH2_1                -1.387979e-01 1 1  ON 41
eH2_2                -9.515560e-02 1 1  ON 42
eH2_3                -4.345144e-02 1 1  ON 43
eH2_4                 7.855521e-03 1 1  ON 44
eH2_5                 4.185546e-02 1 1  ON 45
eH2_6                 1.026556e-01 1 1  ON 46
eH2_7                 1.565294e-01 1 1  ON 47
eH2_8                 1.803101e-01 1 1  ON 48
eH2_9                 4.625306e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9702
    reference variance = 0.217369
====================================================
  Execution time = 2.4321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453884084
                                         uncertainty =       0.004184619853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453884084
                                         uncertainty =       0.004184619853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408971754
  error estimate for blocks of size 2^( 2) =       0.000420773034
  error estimate for blocks of size 2^( 3) =       0.000432896737
  error estimate for blocks of size 2^( 4) =       0.000444209627
  error estimate for blocks of size 2^( 5) =       0.000454637912
  error estimate for blocks of size 2^( 6) =       0.000460970803
  error estimate for blocks of size 2^( 7) =       0.000469538479

      target function =                  N/A
              le_mean =     -16.910391988503
             les_mean =     286.295872829534
             stat err =       0.000457339205
             autocorr =       1.250518832496
              std dev =       0.578373401841
             le_variance =       0.334515791957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691039198850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910391988503       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910392000634       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910391994945       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910391979922       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910391997008       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910391998982       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910392003583       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910392003500       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.772638e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910391988503       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910391991544       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910391990108       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910391986345       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910391990614       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910391991101       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910391992256       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910391992236       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.444623e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910391988503       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910391989264       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910391988904       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910391987963       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910391989030       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910391989151       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910391989441       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910391989437       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.612474e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0691e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.085818e-01 1 1  ON 0
 uu_1                 1.422459e-01 1 1  ON 1
 uu_2                 4.267322e-02 1 1  ON 2
 uu_3                -2.075443e-02 1 1  ON 3
 uu_4                -6.908390e-02 1 1  ON 4
 uu_5                -1.036362e-01 1 1  ON 5
 uu_6                -1.293036e-01 1 1  ON 6
 uu_7                -1.401204e-01 1 1  ON 7
 uu_8                -1.303566e-01 1 1  ON 8
 uu_9                -1.002183e-01 1 1  ON 9
 ud_0                 4.321189e-01 1 1  ON 10
 ud_1                 1.758291e-01 1 1  ON 11
 ud_2                 6.449115e-02 1 1  ON 12
 ud_3                -2.868976e-03 1 1  ON 13
 ud_4                -5.884638e-02 1 1  ON 14
 ud_5                -1.018533e-01 1 1  ON 15
 ud_6                -1.318445e-01 1 1  ON 16
 ud_7                -1.515536e-01 1 1  ON 17
 ud_8                -1.548343e-01 1 1  ON 18
 ud_9                -1.441964e-01 1 1  ON 19
 eO_0                -7.551569e-01 1 1  ON 20
 eO_1                -4.406094e-01 1 1  ON 21
 eO_2                -2.620820e-02 1 1  ON 22
 eO_3                 2.963177e-01 1 1  ON 23
 eO_4                 5.235620e-01 1 1  ON 24
 eO_5                 4.855438e-01 1 1  ON 25
 eO_6                 2.577041e-01 1 1  ON 26
 eO_7                -4.294698e-02 1 1  ON 27
 eO_8                -2.201855e-01 1 1  ON 28
 eO_9                -7.889543e-02 1 1  ON 29
eH1_0                -2.471393e-01 1 1  ON 30
eH1_1                -1.452788e-01 1 1  ON 31
eH1_2                -1.014766e-01 1 1  ON 32
eH1_3                -4.944860e-02 1 1  ON 33
eH1_4                 2.092177e-03 1 1  ON 34
eH1_5                 3.699441e-02 1 1  ON 35
eH1_6                 9.737178e-02 1 1  ON 36
eH1_7                 1.534849e-01 1 1  ON 37
eH1_8                 1.820505e-01 1 1  ON 38
eH1_9                 7.070033e-02 1 1  ON 39
eH2_0                -2.407619e-01 1 1  ON 40
eH2_1                -1.387990e-01 1 1  ON 41
eH2_2                -9.515638e-02 1 1  ON 42
eH2_3                -4.345143e-02 1 1  ON 43
eH2_4                 7.855185e-03 1 1  ON 44
eH2_5                 4.185590e-02 1 1  ON 45
eH2_6                 1.026547e-01 1 1  ON 46
eH2_7                 1.565296e-01 1 1  ON 47
eH2_8                 1.803115e-01 1 1  ON 48
eH2_9                 4.625445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.631779
====================================================
  Execution time = 2.3971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3066e-01
  Total weights = 2.0000e+06
  Execution time = 2.7065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664019812
                                         uncertainty =       0.003342879517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664019812
                                         uncertainty =       0.003342879517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406606830
  error estimate for blocks of size 2^( 2) =       0.000418377661
  error estimate for blocks of size 2^( 3) =       0.000430718861
  error estimate for blocks of size 2^( 4) =       0.000441373405
  error estimate for blocks of size 2^( 5) =       0.000451565666
  error estimate for blocks of size 2^( 6) =       0.000458357140
  error estimate for blocks of size 2^( 7) =       0.000461656809

      target function =                  N/A
              le_mean =     -16.909642060585
             les_mean =     286.266652679986
             stat err =       0.000453238255
             autocorr =       1.242521118673
              std dev =       0.575028893358
             le_variance =       0.330658228197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664673133
                                         uncertainty =       0.003342903970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664673133
                                         uncertainty =       0.003342903970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406607231
  error estimate for blocks of size 2^( 2) =       0.000418378031
  error estimate for blocks of size 2^( 3) =       0.000430719207
  error estimate for blocks of size 2^( 4) =       0.000441373751
  error estimate for blocks of size 2^( 5) =       0.000451566035
  error estimate for blocks of size 2^( 6) =       0.000458357481
  error estimate for blocks of size 2^( 7) =       0.000461657163

      target function =                  N/A
              le_mean =     -16.909642040824
             les_mean =     286.266652663799
             stat err =       0.000453238608
             autocorr =       1.242520601349
              std dev =       0.575029460407
             le_variance =       0.330658880336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664347846
                                         uncertainty =       0.003342891786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664347846
                                         uncertainty =       0.003342891786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406607031
  error estimate for blocks of size 2^( 2) =       0.000418377847
  error estimate for blocks of size 2^( 3) =       0.000430719035
  error estimate for blocks of size 2^( 4) =       0.000441373579
  error estimate for blocks of size 2^( 5) =       0.000451565851
  error estimate for blocks of size 2^( 6) =       0.000458357312
  error estimate for blocks of size 2^( 7) =       0.000461656987

      target function =                  N/A
              le_mean =     -16.909642050645
             les_mean =     286.266652671252
             stat err =       0.000453238432
             autocorr =       1.242520859703
              std dev =       0.575029178075
             le_variance =       0.330658555637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664060855
                                         uncertainty =       0.003342881052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330664060855
                                         uncertainty =       0.003342881052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406606855
  error estimate for blocks of size 2^( 2) =       0.000418377684
  error estimate for blocks of size 2^( 3) =       0.000430718883
  error estimate for blocks of size 2^( 4) =       0.000441373427
  error estimate for blocks of size 2^( 5) =       0.000451565689
  error estimate for blocks of size 2^( 6) =       0.000458357162
  error estimate for blocks of size 2^( 7) =       0.000461656831

      target function =                  N/A
              le_mean =     -16.909642059340
             les_mean =     286.266652678841
             stat err =       0.000453238277
             autocorr =       1.242521086289
              std dev =       0.575028928982
             le_variance =       0.330658269166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909642060585        initial  <--
     3.7253e+01     3.7253e+02             5.7726e-06       -16.909642040824
     1.4901e+02     1.4901e+03             1.4446e-06       -16.909642050645
     5.9605e+02     5.9605e+03             3.6125e-07       -16.909642059340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6347
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.085814e-01 1 1  ON 0
 uu_1                 1.422453e-01 1 1  ON 1
 uu_2                 4.267318e-02 1 1  ON 2
 uu_3                -2.075414e-02 1 1  ON 3
 uu_4                -6.908386e-02 1 1  ON 4
 uu_5                -1.036360e-01 1 1  ON 5
 uu_6                -1.293035e-01 1 1  ON 6
 uu_7                -1.401193e-01 1 1  ON 7
 uu_8                -1.303564e-01 1 1  ON 8
 uu_9                -1.002182e-01 1 1  ON 9
 ud_0                 4.321187e-01 1 1  ON 10
 ud_1                 1.758291e-01 1 1  ON 11
 ud_2                 6.449078e-02 1 1  ON 12
 ud_3                -2.869236e-03 1 1  ON 13
 ud_4                -5.884667e-02 1 1  ON 14
 ud_5                -1.018530e-01 1 1  ON 15
 ud_6                -1.318445e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548336e-01 1 1  ON 18
 ud_9                -1.441963e-01 1 1  ON 19
 eO_0                -7.551572e-01 1 1  ON 20
 eO_1                -4.406097e-01 1 1  ON 21
 eO_2                -2.620867e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235629e-01 1 1  ON 24
 eO_5                 4.855435e-01 1 1  ON 25
 eO_6                 2.577033e-01 1 1  ON 26
 eO_7                -4.294708e-02 1 1  ON 27
 eO_8                -2.201849e-01 1 1  ON 28
 eO_9                -7.889459e-02 1 1  ON 29
eH1_0                -2.471379e-01 1 1  ON 30
eH1_1                -1.452782e-01 1 1  ON 31
eH1_2                -1.014764e-01 1 1  ON 32
eH1_3                -4.944815e-02 1 1  ON 33
eH1_4                 2.091680e-03 1 1  ON 34
eH1_5                 3.699480e-02 1 1  ON 35
eH1_6                 9.737158e-02 1 1  ON 36
eH1_7                 1.534845e-01 1 1  ON 37
eH1_8                 1.820498e-01 1 1  ON 38
eH1_9                 7.069921e-02 1 1  ON 39
eH2_0                -2.407617e-01 1 1  ON 40
eH2_1                -1.387979e-01 1 1  ON 41
eH2_2                -9.515560e-02 1 1  ON 42
eH2_3                -4.345144e-02 1 1  ON 43
eH2_4                 7.855521e-03 1 1  ON 44
eH2_5                 4.185546e-02 1 1  ON 45
eH2_6                 1.026556e-01 1 1  ON 46
eH2_7                 1.565294e-01 1 1  ON 47
eH2_8                 1.803101e-01 1 1  ON 48
eH2_9                 4.625306e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.164091
====================================================
  Execution time = 2.4217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2821e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328080208848
                                         uncertainty =       0.002970276812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328080208848
                                         uncertainty =       0.002970276812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405097811
  error estimate for blocks of size 2^( 2) =       0.000417037740
  error estimate for blocks of size 2^( 3) =       0.000430168637
  error estimate for blocks of size 2^( 4) =       0.000442725176
  error estimate for blocks of size 2^( 5) =       0.000454250480
  error estimate for blocks of size 2^( 6) =       0.000462948314
  error estimate for blocks of size 2^( 7) =       0.000470066923

      target function =                  N/A
              le_mean =     -16.910343324256
             les_mean =     286.287919652646
             stat err =       0.000457497723
             autocorr =       1.275434269963
              std dev =       0.572894818050
             le_variance =       0.328208472549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691034332426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910343324256       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910343323745       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910343323738       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910343324464       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910343323018       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910343323997       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910343324213       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910343324130       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.115450e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910343324256       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910343324128       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910343324126       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910343324307       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910343323946       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910343324191       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910343324244       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910343324223       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.278919e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910343324256       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910343324224       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910343324223       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910343324269       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910343324178       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910343324241       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910343324253       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910343324247       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.197333e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0607e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.085814e-01 1 1  ON 0
 uu_1                 1.422454e-01 1 1  ON 1
 uu_2                 4.267320e-02 1 1  ON 2
 uu_3                -2.075414e-02 1 1  ON 3
 uu_4                -6.908385e-02 1 1  ON 4
 uu_5                -1.036361e-01 1 1  ON 5
 uu_6                -1.293035e-01 1 1  ON 6
 uu_7                -1.401194e-01 1 1  ON 7
 uu_8                -1.303565e-01 1 1  ON 8
 uu_9                -1.002182e-01 1 1  ON 9
 ud_0                 4.321187e-01 1 1  ON 10
 ud_1                 1.758292e-01 1 1  ON 11
 ud_2                 6.449077e-02 1 1  ON 12
 ud_3                -2.869166e-03 1 1  ON 13
 ud_4                -5.884661e-02 1 1  ON 14
 ud_5                -1.018530e-01 1 1  ON 15
 ud_6                -1.318445e-01 1 1  ON 16
 ud_7                -1.515538e-01 1 1  ON 17
 ud_8                -1.548337e-01 1 1  ON 18
 ud_9                -1.441964e-01 1 1  ON 19
 eO_0                -7.551573e-01 1 1  ON 20
 eO_1                -4.406097e-01 1 1  ON 21
 eO_2                -2.620859e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235629e-01 1 1  ON 24
 eO_5                 4.855436e-01 1 1  ON 25
 eO_6                 2.577033e-01 1 1  ON 26
 eO_7                -4.294704e-02 1 1  ON 27
 eO_8                -2.201849e-01 1 1  ON 28
 eO_9                -7.889468e-02 1 1  ON 29
eH1_0                -2.471380e-01 1 1  ON 30
eH1_1                -1.452783e-01 1 1  ON 31
eH1_2                -1.014764e-01 1 1  ON 32
eH1_3                -4.944817e-02 1 1  ON 33
eH1_4                 2.091710e-03 1 1  ON 34
eH1_5                 3.699469e-02 1 1  ON 35
eH1_6                 9.737152e-02 1 1  ON 36
eH1_7                 1.534846e-01 1 1  ON 37
eH1_8                 1.820499e-01 1 1  ON 38
eH1_9                 7.069932e-02 1 1  ON 39
eH2_0                -2.407618e-01 1 1  ON 40
eH2_1                -1.387980e-01 1 1  ON 41
eH2_2                -9.515571e-02 1 1  ON 42
eH2_3                -4.345145e-02 1 1  ON 43
eH2_4                 7.855513e-03 1 1  ON 44
eH2_5                 4.185548e-02 1 1  ON 45
eH2_6                 1.026556e-01 1 1  ON 46
eH2_7                 1.565294e-01 1 1  ON 47
eH2_8                 1.803102e-01 1 1  ON 48
eH2_9                 4.625319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.205801
====================================================
  Execution time = 2.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.7170e-01
  Total weights = 2.0000e+06
  Execution time = 2.6996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714212135
                                         uncertainty =       0.031137147569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714212135
                                         uncertainty =       0.031137147569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431103480
  error estimate for blocks of size 2^( 2) =       0.000442195573
  error estimate for blocks of size 2^( 3) =       0.000454131668
  error estimate for blocks of size 2^( 4) =       0.000465907167
  error estimate for blocks of size 2^( 5) =       0.000475409493
  error estimate for blocks of size 2^( 6) =       0.000483265312
  error estimate for blocks of size 2^( 7) =       0.000488201405

      target function =                  N/A
              le_mean =     -16.909808185137
             les_mean =     286.313313092973
             stat err =       0.000478195844
             autocorr =       1.230406276780
              std dev =       0.609672388008
             le_variance =       0.371700420700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714053497
                                         uncertainty =       0.031137142372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714053497
                                         uncertainty =       0.031137142372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431103388
  error estimate for blocks of size 2^( 2) =       0.000442195480
  error estimate for blocks of size 2^( 3) =       0.000454131572
  error estimate for blocks of size 2^( 4) =       0.000465907070
  error estimate for blocks of size 2^( 5) =       0.000475409399
  error estimate for blocks of size 2^( 6) =       0.000483265223
  error estimate for blocks of size 2^( 7) =       0.000488201326

      target function =                  N/A
              le_mean =     -16.909808186237
             les_mean =     286.313312971539
             stat err =       0.000478195755
             autocorr =       1.230406340886
              std dev =       0.609672257913
             le_variance =       0.371700262069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714132711
                                         uncertainty =       0.031137144974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714132711
                                         uncertainty =       0.031137144974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431103434
  error estimate for blocks of size 2^( 2) =       0.000442195526
  error estimate for blocks of size 2^( 3) =       0.000454131620
  error estimate for blocks of size 2^( 4) =       0.000465907118
  error estimate for blocks of size 2^( 5) =       0.000475409446
  error estimate for blocks of size 2^( 6) =       0.000483265268
  error estimate for blocks of size 2^( 7) =       0.000488201365

      target function =                  N/A
              le_mean =     -16.909808185688
             les_mean =     286.313313032182
             stat err =       0.000478195799
             autocorr =       1.230406308894
              std dev =       0.609672322875
             le_variance =       0.371700341279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714202203
                                         uncertainty =       0.031137147245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371714202203
                                         uncertainty =       0.031137147245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431103474
  error estimate for blocks of size 2^( 2) =       0.000442195567
  error estimate for blocks of size 2^( 3) =       0.000454131662
  error estimate for blocks of size 2^( 4) =       0.000465907161
  error estimate for blocks of size 2^( 5) =       0.000475409487
  error estimate for blocks of size 2^( 6) =       0.000483265307
  error estimate for blocks of size 2^( 7) =       0.000488201400

      target function =                  N/A
              le_mean =     -16.909808185206
             les_mean =     286.313313085371
             stat err =       0.000478195839
             autocorr =       1.230406280799
              std dev =       0.609672379864
             le_variance =       0.371700410769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909808185137        initial
     3.7253e+02     3.7253e+03             5.1155e-07       -16.909808186237  <--
     1.4901e+03     1.4901e+04             1.2789e-07       -16.909808185688
     5.9605e+03     5.9605e+04             3.1973e-08       -16.909808185206

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 3.7775e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.085814e-01 1 1  ON 0
 uu_1                 1.422454e-01 1 1  ON 1
 uu_2                 4.267326e-02 1 1  ON 2
 uu_3                -2.075416e-02 1 1  ON 3
 uu_4                -6.908380e-02 1 1  ON 4
 uu_5                -1.036361e-01 1 1  ON 5
 uu_6                -1.293036e-01 1 1  ON 6
 uu_7                -1.401196e-01 1 1  ON 7
 uu_8                -1.303566e-01 1 1  ON 8
 uu_9                -1.002182e-01 1 1  ON 9
 ud_0                 4.321186e-01 1 1  ON 10
 ud_1                 1.758295e-01 1 1  ON 11
 ud_2                 6.449073e-02 1 1  ON 12
 ud_3                -2.868956e-03 1 1  ON 13
 ud_4                -5.884642e-02 1 1  ON 14
 ud_5                -1.018529e-01 1 1  ON 15
 ud_6                -1.318445e-01 1 1  ON 16
 ud_7                -1.515540e-01 1 1  ON 17
 ud_8                -1.548341e-01 1 1  ON 18
 ud_9                -1.441966e-01 1 1  ON 19
 eO_0                -7.551574e-01 1 1  ON 20
 eO_1                -4.406096e-01 1 1  ON 21
 eO_2                -2.620834e-02 1 1  ON 22
 eO_3                 2.963175e-01 1 1  ON 23
 eO_4                 5.235627e-01 1 1  ON 24
 eO_5                 4.855438e-01 1 1  ON 25
 eO_6                 2.577035e-01 1 1  ON 26
 eO_7                -4.294693e-02 1 1  ON 27
 eO_8                -2.201852e-01 1 1  ON 28
 eO_9                -7.889494e-02 1 1  ON 29
eH1_0                -2.471382e-01 1 1  ON 30
eH1_1                -1.452783e-01 1 1  ON 31
eH1_2                -1.014764e-01 1 1  ON 32
eH1_3                -4.944824e-02 1 1  ON 33
eH1_4                 2.091799e-03 1 1  ON 34
eH1_5                 3.699436e-02 1 1  ON 35
eH1_6                 9.737132e-02 1 1  ON 36
eH1_7                 1.534846e-01 1 1  ON 37
eH1_8                 1.820502e-01 1 1  ON 38
eH1_9                 7.069967e-02 1 1  ON 39
eH2_0                -2.407622e-01 1 1  ON 40
eH2_1                -1.387983e-01 1 1  ON 41
eH2_2                -9.515604e-02 1 1  ON 42
eH2_3                -4.345145e-02 1 1  ON 43
eH2_4                 7.855490e-03 1 1  ON 44
eH2_5                 4.185554e-02 1 1  ON 45
eH2_6                 1.026558e-01 1 1  ON 46
eH2_7                 1.565296e-01 1 1  ON 47
eH2_8                 1.803105e-01 1 1  ON 48
eH2_9                 4.625358e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.36935
====================================================
  Execution time = 2.6351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5316e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352749296284
                                         uncertainty =       0.013485540255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352749296284
                                         uncertainty =       0.013485540255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420212521
  error estimate for blocks of size 2^( 2) =       0.000431736091
  error estimate for blocks of size 2^( 3) =       0.000444377979
  error estimate for blocks of size 2^( 4) =       0.000455919847
  error estimate for blocks of size 2^( 5) =       0.000465733738
  error estimate for blocks of size 2^( 6) =       0.000473811547
  error estimate for blocks of size 2^( 7) =       0.000480793103

      target function =                  N/A
              le_mean =     -16.909436219432
             les_mean =     286.282190207434
             stat err =       0.000469064559
             autocorr =       1.246026455009
              std dev =       0.594270245748
             le_variance =       0.353157124982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690943621943e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909436219432       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909436225739       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909436234892       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909436237858       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909436240441       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909436241604       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909436242072       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909436241433       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.578487e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909436219432       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909436221011       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909436223305       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909436224049       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909436224699       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909436224993       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909436225111       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909436224950       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.448595e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909436219432       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909436219827       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909436220401       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909436220587       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909436220751       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909436220822       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909436220853       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909436220812       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.612297e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2810e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.085817e-01 1 1  ON 0
 uu_1                 1.422459e-01 1 1  ON 1
 uu_2                 4.267333e-02 1 1  ON 2
 uu_3                -2.075387e-02 1 1  ON 3
 uu_4                -6.908359e-02 1 1  ON 4
 uu_5                -1.036363e-01 1 1  ON 5
 uu_6                -1.293035e-01 1 1  ON 6
 uu_7                -1.401202e-01 1 1  ON 7
 uu_8                -1.303573e-01 1 1  ON 8
 uu_9                -1.002185e-01 1 1  ON 9
 ud_0                 4.321190e-01 1 1  ON 10
 ud_1                 1.758297e-01 1 1  ON 11
 ud_2                 6.449081e-02 1 1  ON 12
 ud_3                -2.868809e-03 1 1  ON 13
 ud_4                -5.884648e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318441e-01 1 1  ON 16
 ud_7                -1.515540e-01 1 1  ON 17
 ud_8                -1.548345e-01 1 1  ON 18
 ud_9                -1.441970e-01 1 1  ON 19
 eO_0                -7.551571e-01 1 1  ON 20
 eO_1                -4.406099e-01 1 1  ON 21
 eO_2                -2.620815e-02 1 1  ON 22
 eO_3                 2.963177e-01 1 1  ON 23
 eO_4                 5.235626e-01 1 1  ON 24
 eO_5                 4.855441e-01 1 1  ON 25
 eO_6                 2.577037e-01 1 1  ON 26
 eO_7                -4.294683e-02 1 1  ON 27
 eO_8                -2.201856e-01 1 1  ON 28
 eO_9                -7.889532e-02 1 1  ON 29
eH1_0                -2.471386e-01 1 1  ON 30
eH1_1                -1.452783e-01 1 1  ON 31
eH1_2                -1.014763e-01 1 1  ON 32
eH1_3                -4.944873e-02 1 1  ON 33
eH1_4                 2.091499e-03 1 1  ON 34
eH1_5                 3.699443e-02 1 1  ON 35
eH1_6                 9.737166e-02 1 1  ON 36
eH1_7                 1.534848e-01 1 1  ON 37
eH1_8                 1.820503e-01 1 1  ON 38
eH1_9                 7.070001e-02 1 1  ON 39
eH2_0                -2.407622e-01 1 1  ON 40
eH2_1                -1.387986e-01 1 1  ON 41
eH2_2                -9.515611e-02 1 1  ON 42
eH2_3                -4.345169e-02 1 1  ON 43
eH2_4                 7.855381e-03 1 1  ON 44
eH2_5                 4.185547e-02 1 1  ON 45
eH2_6                 1.026556e-01 1 1  ON 46
eH2_7                 1.565296e-01 1 1  ON 47
eH2_8                 1.803109e-01 1 1  ON 48
eH2_9                 4.625409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.87
    reference variance = 0.227119
====================================================
  Execution time = 2.3909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3192e-01
  Total weights = 2.0000e+06
  Execution time = 2.6986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949102962
                                         uncertainty =       0.003716425735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949102962
                                         uncertainty =       0.003716425735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407380189
  error estimate for blocks of size 2^( 2) =       0.000419749459
  error estimate for blocks of size 2^( 3) =       0.000432612960
  error estimate for blocks of size 2^( 4) =       0.000445078668
  error estimate for blocks of size 2^( 5) =       0.000456436733
  error estimate for blocks of size 2^( 6) =       0.000465135247
  error estimate for blocks of size 2^( 7) =       0.000471564285

      target function =                  N/A
              le_mean =     -16.909214886282
             les_mean =     286.253465141212
             stat err =       0.000459553733
             autocorr =       1.272543937552
              std dev =       0.576122588254
             le_variance =       0.331917236696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949923760
                                         uncertainty =       0.003716443507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949923760
                                         uncertainty =       0.003716443507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407380693
  error estimate for blocks of size 2^( 2) =       0.000419749920
  error estimate for blocks of size 2^( 3) =       0.000432613383
  error estimate for blocks of size 2^( 4) =       0.000445079053
  error estimate for blocks of size 2^( 5) =       0.000456437087
  error estimate for blocks of size 2^( 6) =       0.000465135630
  error estimate for blocks of size 2^( 7) =       0.000471564617

      target function =                  N/A
              le_mean =     -16.909214889215
             les_mean =     286.253466061446
             stat err =       0.000459554097
             autocorr =       1.272542803266
              std dev =       0.576123300813
             le_variance =       0.331918057740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949514826
                                         uncertainty =       0.003716434651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949514826
                                         uncertainty =       0.003716434651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407380442
  error estimate for blocks of size 2^( 2) =       0.000419749690
  error estimate for blocks of size 2^( 3) =       0.000432613173
  error estimate for blocks of size 2^( 4) =       0.000445078861
  error estimate for blocks of size 2^( 5) =       0.000456436911
  error estimate for blocks of size 2^( 6) =       0.000465135439
  error estimate for blocks of size 2^( 7) =       0.000471564452

      target function =                  N/A
              le_mean =     -16.909214887753
             les_mean =     286.253465602931
             stat err =       0.000459553916
             autocorr =       1.272543368490
              std dev =       0.576122945804
             le_variance =       0.331917648682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949154487
                                         uncertainty =       0.003716426851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331949154487
                                         uncertainty =       0.003716426851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407380221
  error estimate for blocks of size 2^( 2) =       0.000419749487
  error estimate for blocks of size 2^( 3) =       0.000432612987
  error estimate for blocks of size 2^( 4) =       0.000445078692
  error estimate for blocks of size 2^( 5) =       0.000456436755
  error estimate for blocks of size 2^( 6) =       0.000465135271
  error estimate for blocks of size 2^( 7) =       0.000471564306

      target function =                  N/A
              le_mean =     -16.909214886466
             les_mean =     286.253465198954
             stat err =       0.000459553756
             autocorr =       1.272543866366
              std dev =       0.576122632984
             le_variance =       0.331917288237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909214886282        initial
     9.3132e+01     9.3132e+02             2.5785e-06       -16.909214889215  <--
     3.7253e+02     3.7253e+03             6.4486e-07       -16.909214887753
     1.4901e+03     1.4901e+04             1.6123e-07       -16.909214886466

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 3.7592e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.085825e-01 1 1  ON 0
 uu_1                 1.422473e-01 1 1  ON 1
 uu_2                 4.267354e-02 1 1  ON 2
 uu_3                -2.075302e-02 1 1  ON 3
 uu_4                -6.908295e-02 1 1  ON 4
 uu_5                -1.036369e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401217e-01 1 1  ON 7
 uu_8                -1.303592e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321202e-01 1 1  ON 10
 ud_1                 1.758304e-01 1 1  ON 11
 ud_2                 6.449103e-02 1 1  ON 12
 ud_3                -2.868372e-03 1 1  ON 13
 ud_4                -5.884665e-02 1 1  ON 14
 ud_5                -1.018525e-01 1 1  ON 15
 ud_6                -1.318432e-01 1 1  ON 16
 ud_7                -1.515540e-01 1 1  ON 17
 ud_8                -1.548357e-01 1 1  ON 18
 ud_9                -1.441982e-01 1 1  ON 19
 eO_0                -7.551564e-01 1 1  ON 20
 eO_1                -4.406107e-01 1 1  ON 21
 eO_2                -2.620757e-02 1 1  ON 22
 eO_3                 2.963184e-01 1 1  ON 23
 eO_4                 5.235621e-01 1 1  ON 24
 eO_5                 4.855452e-01 1 1  ON 25
 eO_6                 2.577042e-01 1 1  ON 26
 eO_7                -4.294654e-02 1 1  ON 27
 eO_8                -2.201870e-01 1 1  ON 28
 eO_9                -7.889644e-02 1 1  ON 29
eH1_0                -2.471400e-01 1 1  ON 30
eH1_1                -1.452782e-01 1 1  ON 31
eH1_2                -1.014760e-01 1 1  ON 32
eH1_3                -4.945019e-02 1 1  ON 33
eH1_4                 2.090599e-03 1 1  ON 34
eH1_5                 3.699463e-02 1 1  ON 35
eH1_6                 9.737266e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820507e-01 1 1  ON 38
eH1_9                 7.070105e-02 1 1  ON 39
eH2_0                -2.407622e-01 1 1  ON 40
eH2_1                -1.387994e-01 1 1  ON 41
eH2_2                -9.515634e-02 1 1  ON 42
eH2_3                -4.345239e-02 1 1  ON 43
eH2_4                 7.855053e-03 1 1  ON 44
eH2_5                 4.185528e-02 1 1  ON 45
eH2_6                 1.026550e-01 1 1  ON 46
eH2_7                 1.565297e-01 1 1  ON 47
eH2_8                 1.803121e-01 1 1  ON 48
eH2_9                 4.625565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.31775
====================================================
  Execution time = 2.4110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337983201227
                                         uncertainty =       0.010991979242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337983201227
                                         uncertainty =       0.010991979242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412135181
  error estimate for blocks of size 2^( 2) =       0.000423850703
  error estimate for blocks of size 2^( 3) =       0.000436915972
  error estimate for blocks of size 2^( 4) =       0.000449255219
  error estimate for blocks of size 2^( 5) =       0.000462954086
  error estimate for blocks of size 2^( 6) =       0.000475393918
  error estimate for blocks of size 2^( 7) =       0.000482826019

      target function =                  N/A
              le_mean =     -16.909214882703
             les_mean =     286.261258594737
             stat err =       0.000467607311
             autocorr =       1.287310189175
              std dev =       0.582847162796
             le_variance =       0.339710815179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690921488270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909214882703       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909214908039       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909214890290       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909214889468       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909214904313       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909214894304       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909214896994       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909214903743       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.322561e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909214882703       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909214889079       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909214884608       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909214884383       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909214888152       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909214885641       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909214886260       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909214887951       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 3.309473e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909214882703       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909214884300       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909214883180       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909214883122       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909214884068       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909214883440       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909214883591       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909214884015       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 8.275668e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0462e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.085827e-01 1 1  ON 0
 uu_1                 1.422486e-01 1 1  ON 1
 uu_2                 4.267341e-02 1 1  ON 2
 uu_3                -2.075369e-02 1 1  ON 3
 uu_4                -6.908516e-02 1 1  ON 4
 uu_5                -1.036371e-01 1 1  ON 5
 uu_6                -1.293046e-01 1 1  ON 6
 uu_7                -1.401236e-01 1 1  ON 7
 uu_8                -1.303587e-01 1 1  ON 8
 uu_9                -1.002182e-01 1 1  ON 9
 ud_0                 4.321189e-01 1 1  ON 10
 ud_1                 1.758303e-01 1 1  ON 11
 ud_2                 6.448967e-02 1 1  ON 12
 ud_3                -2.869124e-03 1 1  ON 13
 ud_4                -5.884673e-02 1 1  ON 14
 ud_5                -1.018525e-01 1 1  ON 15
 ud_6                -1.318446e-01 1 1  ON 16
 ud_7                -1.515539e-01 1 1  ON 17
 ud_8                -1.548337e-01 1 1  ON 18
 ud_9                -1.441965e-01 1 1  ON 19
 eO_0                -7.551569e-01 1 1  ON 20
 eO_1                -4.406122e-01 1 1  ON 21
 eO_2                -2.620668e-02 1 1  ON 22
 eO_3                 2.963197e-01 1 1  ON 23
 eO_4                 5.235616e-01 1 1  ON 24
 eO_5                 4.855454e-01 1 1  ON 25
 eO_6                 2.577047e-01 1 1  ON 26
 eO_7                -4.294614e-02 1 1  ON 27
 eO_8                -2.201869e-01 1 1  ON 28
 eO_9                -7.889708e-02 1 1  ON 29
eH1_0                -2.471417e-01 1 1  ON 30
eH1_1                -1.452794e-01 1 1  ON 31
eH1_2                -1.014766e-01 1 1  ON 32
eH1_3                -4.945173e-02 1 1  ON 33
eH1_4                 2.089976e-03 1 1  ON 34
eH1_5                 3.699359e-02 1 1  ON 35
eH1_6                 9.737316e-02 1 1  ON 36
eH1_7                 1.534865e-01 1 1  ON 37
eH1_8                 1.820526e-01 1 1  ON 38
eH1_9                 7.070343e-02 1 1  ON 39
eH2_0                -2.407634e-01 1 1  ON 40
eH2_1                -1.387999e-01 1 1  ON 41
eH2_2                -9.515692e-02 1 1  ON 42
eH2_3                -4.345374e-02 1 1  ON 43
eH2_4                 7.855449e-03 1 1  ON 44
eH2_5                 4.185521e-02 1 1  ON 45
eH2_6                 1.026532e-01 1 1  ON 46
eH2_7                 1.565291e-01 1 1  ON 47
eH2_8                 1.803141e-01 1 1  ON 48
eH2_9                 4.625896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8873
    reference variance = 0.235863
====================================================
  Execution time = 2.3451e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.0000e+06
  Execution time = 2.7197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364390031
                                         uncertainty =       0.004863448916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364390031
                                         uncertainty =       0.004863448916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045740
  error estimate for blocks of size 2^( 2) =       0.000422126795
  error estimate for blocks of size 2^( 3) =       0.000434561246
  error estimate for blocks of size 2^( 4) =       0.000446918691
  error estimate for blocks of size 2^( 5) =       0.000458411441
  error estimate for blocks of size 2^( 6) =       0.000468192871
  error estimate for blocks of size 2^( 7) =       0.000474414081

      target function =                  N/A
              le_mean =     -16.909116445473
             les_mean =     286.254493816900
             stat err =       0.000461984271
             autocorr =       1.269374499538
              std dev =       0.579892247309
             le_variance =       0.336275018489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364790080
                                         uncertainty =       0.004863447817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364790080
                                         uncertainty =       0.004863447817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045985
  error estimate for blocks of size 2^( 2) =       0.000422127037
  error estimate for blocks of size 2^( 3) =       0.000434561461
  error estimate for blocks of size 2^( 4) =       0.000446918894
  error estimate for blocks of size 2^( 5) =       0.000458411533
  error estimate for blocks of size 2^( 6) =       0.000468193032
  error estimate for blocks of size 2^( 7) =       0.000474413968

      target function =                  N/A
              le_mean =     -16.909116442933
             les_mean =     286.254494131881
             stat err =       0.000461984357
             autocorr =       1.269373458224
              std dev =       0.579892592939
             le_variance =       0.336275419345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364583097
                                         uncertainty =       0.004863448286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364583097
                                         uncertainty =       0.004863448286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045858
  error estimate for blocks of size 2^( 2) =       0.000422126912
  error estimate for blocks of size 2^( 3) =       0.000434561349
  error estimate for blocks of size 2^( 4) =       0.000446918788
  error estimate for blocks of size 2^( 5) =       0.000458411482
  error estimate for blocks of size 2^( 6) =       0.000468192947
  error estimate for blocks of size 2^( 7) =       0.000474414018

      target function =                  N/A
              le_mean =     -16.909116444187
             les_mean =     286.254493966913
             stat err =       0.000461984309
             autocorr =       1.269373976150
              std dev =       0.579892414132
             le_variance =       0.336275211967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364413901
                                         uncertainty =       0.004863448835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364413901
                                         uncertainty =       0.004863448835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045755
  error estimate for blocks of size 2^( 2) =       0.000422126810
  error estimate for blocks of size 2^( 3) =       0.000434561258
  error estimate for blocks of size 2^( 4) =       0.000446918703
  error estimate for blocks of size 2^( 5) =       0.000458411446
  error estimate for blocks of size 2^( 6) =       0.000468192880
  error estimate for blocks of size 2^( 7) =       0.000474414073

      target function =                  N/A
              le_mean =     -16.909116445306
             les_mean =     286.254493835181
             stat err =       0.000461984276
             autocorr =       1.269374434030
              std dev =       0.579892267934
             le_variance =       0.336275042410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909116445473        initial  <--
     2.3283e+01     2.3283e+02             1.3226e-05       -16.909116442933
     9.3132e+01     9.3132e+02             3.3095e-06       -16.909116444187
     3.7253e+02     3.7253e+03             8.2757e-07       -16.909116445306

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.1562
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.085825e-01 1 1  ON 0
 uu_1                 1.422473e-01 1 1  ON 1
 uu_2                 4.267354e-02 1 1  ON 2
 uu_3                -2.075302e-02 1 1  ON 3
 uu_4                -6.908295e-02 1 1  ON 4
 uu_5                -1.036369e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401217e-01 1 1  ON 7
 uu_8                -1.303592e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321202e-01 1 1  ON 10
 ud_1                 1.758304e-01 1 1  ON 11
 ud_2                 6.449103e-02 1 1  ON 12
 ud_3                -2.868372e-03 1 1  ON 13
 ud_4                -5.884665e-02 1 1  ON 14
 ud_5                -1.018525e-01 1 1  ON 15
 ud_6                -1.318432e-01 1 1  ON 16
 ud_7                -1.515540e-01 1 1  ON 17
 ud_8                -1.548357e-01 1 1  ON 18
 ud_9                -1.441982e-01 1 1  ON 19
 eO_0                -7.551564e-01 1 1  ON 20
 eO_1                -4.406107e-01 1 1  ON 21
 eO_2                -2.620757e-02 1 1  ON 22
 eO_3                 2.963184e-01 1 1  ON 23
 eO_4                 5.235621e-01 1 1  ON 24
 eO_5                 4.855452e-01 1 1  ON 25
 eO_6                 2.577042e-01 1 1  ON 26
 eO_7                -4.294654e-02 1 1  ON 27
 eO_8                -2.201870e-01 1 1  ON 28
 eO_9                -7.889644e-02 1 1  ON 29
eH1_0                -2.471400e-01 1 1  ON 30
eH1_1                -1.452782e-01 1 1  ON 31
eH1_2                -1.014760e-01 1 1  ON 32
eH1_3                -4.945019e-02 1 1  ON 33
eH1_4                 2.090599e-03 1 1  ON 34
eH1_5                 3.699463e-02 1 1  ON 35
eH1_6                 9.737266e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820507e-01 1 1  ON 38
eH1_9                 7.070105e-02 1 1  ON 39
eH2_0                -2.407622e-01 1 1  ON 40
eH2_1                -1.387994e-01 1 1  ON 41
eH2_2                -9.515634e-02 1 1  ON 42
eH2_3                -4.345239e-02 1 1  ON 43
eH2_4                 7.855053e-03 1 1  ON 44
eH2_5                 4.185528e-02 1 1  ON 45
eH2_6                 1.026550e-01 1 1  ON 46
eH2_7                 1.565297e-01 1 1  ON 47
eH2_8                 1.803121e-01 1 1  ON 48
eH2_9                 4.625565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9209
    reference variance = 0.163877
====================================================
  Execution time = 2.4342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352775661067
                                         uncertainty =       0.008483318321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352775661067
                                         uncertainty =       0.008483318321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419920961
  error estimate for blocks of size 2^( 2) =       0.000431439806
  error estimate for blocks of size 2^( 3) =       0.000444095742
  error estimate for blocks of size 2^( 4) =       0.000456577454
  error estimate for blocks of size 2^( 5) =       0.000468322116
  error estimate for blocks of size 2^( 6) =       0.000477453852
  error estimate for blocks of size 2^( 7) =       0.000484705331

      target function =                  N/A
              le_mean =     -16.909688045225
             les_mean =     286.290216837574
             stat err =       0.000471764688
             autocorr =       1.262163897466
              std dev =       0.593857918259
             le_variance =       0.352667227079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690968804523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909688045225       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909688047292       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909688045117       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909688045659       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909688047767       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909688047732       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909688047319       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909688047482       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.018127e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909688045225       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909688045742       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909688045198       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909688045333       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909688045860       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909688045851       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909688045748       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909688045790       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.545382e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909688045225       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909688045354       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909688045218       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909688045252       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909688045384       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909688045382       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909688045357       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909688045368       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.363495e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0740e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422473e-01 1 1  ON 1
 uu_2                 4.267360e-02 1 1  ON 2
 uu_3                -2.075307e-02 1 1  ON 3
 uu_4                -6.908292e-02 1 1  ON 4
 uu_5                -1.036370e-01 1 1  ON 5
 uu_6                -1.293032e-01 1 1  ON 6
 uu_7                -1.401218e-01 1 1  ON 7
 uu_8                -1.303593e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321202e-01 1 1  ON 10
 ud_1                 1.758306e-01 1 1  ON 11
 ud_2                 6.449092e-02 1 1  ON 12
 ud_3                -2.868332e-03 1 1  ON 13
 ud_4                -5.884663e-02 1 1  ON 14
 ud_5                -1.018526e-01 1 1  ON 15
 ud_6                -1.318432e-01 1 1  ON 16
 ud_7                -1.515539e-01 1 1  ON 17
 ud_8                -1.548357e-01 1 1  ON 18
 ud_9                -1.441983e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406108e-01 1 1  ON 21
 eO_2                -2.620748e-02 1 1  ON 22
 eO_3                 2.963185e-01 1 1  ON 23
 eO_4                 5.235620e-01 1 1  ON 24
 eO_5                 4.855453e-01 1 1  ON 25
 eO_6                 2.577043e-01 1 1  ON 26
 eO_7                -4.294649e-02 1 1  ON 27
 eO_8                -2.201871e-01 1 1  ON 28
 eO_9                -7.889656e-02 1 1  ON 29
eH1_0                -2.471402e-01 1 1  ON 30
eH1_1                -1.452783e-01 1 1  ON 31
eH1_2                -1.014761e-01 1 1  ON 32
eH1_3                -4.945033e-02 1 1  ON 33
eH1_4                 2.090585e-03 1 1  ON 34
eH1_5                 3.699467e-02 1 1  ON 35
eH1_6                 9.737264e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820508e-01 1 1  ON 38
eH1_9                 7.070126e-02 1 1  ON 39
eH2_0                -2.407623e-01 1 1  ON 40
eH2_1                -1.387996e-01 1 1  ON 41
eH2_2                -9.515647e-02 1 1  ON 42
eH2_3                -4.345236e-02 1 1  ON 43
eH2_4                 7.855045e-03 1 1  ON 44
eH2_5                 4.185525e-02 1 1  ON 45
eH2_6                 1.026549e-01 1 1  ON 46
eH2_7                 1.565297e-01 1 1  ON 47
eH2_8                 1.803123e-01 1 1  ON 48
eH2_9                 4.625590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8735
    reference variance = 0.264212
====================================================
  Execution time = 2.3780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.0000e+06
  Execution time = 2.6949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363123850
                                         uncertainty =       0.004557289788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363123850
                                         uncertainty =       0.004557289788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065457
  error estimate for blocks of size 2^( 2) =       0.000424840468
  error estimate for blocks of size 2^( 3) =       0.000437335024
  error estimate for blocks of size 2^( 4) =       0.000449361418
  error estimate for blocks of size 2^( 5) =       0.000461061070
  error estimate for blocks of size 2^( 6) =       0.000469874555
  error estimate for blocks of size 2^( 7) =       0.000475484811

      target function =                  N/A
              le_mean =     -16.910139605975
             les_mean =     286.294067465826
             stat err =       0.000463945463
             autocorr =       1.261525719687
              std dev =       0.584162770891
             le_variance =       0.341246142895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363191897
                                         uncertainty =       0.004557290839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363191897
                                         uncertainty =       0.004557290839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065498
  error estimate for blocks of size 2^( 2) =       0.000424840501
  error estimate for blocks of size 2^( 3) =       0.000437335043
  error estimate for blocks of size 2^( 4) =       0.000449361433
  error estimate for blocks of size 2^( 5) =       0.000461061083
  error estimate for blocks of size 2^( 6) =       0.000469874567
  error estimate for blocks of size 2^( 7) =       0.000475484803

      target function =                  N/A
              le_mean =     -16.910139608149
             les_mean =     286.294067607611
             stat err =       0.000463945471
             autocorr =       1.261525511137
              std dev =       0.584162829321
             le_variance =       0.341246211161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363157771
                                         uncertainty =       0.004557290311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363157771
                                         uncertainty =       0.004557290311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065477
  error estimate for blocks of size 2^( 2) =       0.000424840485
  error estimate for blocks of size 2^( 3) =       0.000437335034
  error estimate for blocks of size 2^( 4) =       0.000449361425
  error estimate for blocks of size 2^( 5) =       0.000461061076
  error estimate for blocks of size 2^( 6) =       0.000469874561
  error estimate for blocks of size 2^( 7) =       0.000475484807

      target function =                  N/A
              le_mean =     -16.910139607062
             les_mean =     286.294067536630
             stat err =       0.000463945467
             autocorr =       1.261525615381
              std dev =       0.584162800018
             le_variance =       0.341246176925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363128086
                                         uncertainty =       0.004557289854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341363128086
                                         uncertainty =       0.004557289854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065459
  error estimate for blocks of size 2^( 2) =       0.000424840470
  error estimate for blocks of size 2^( 3) =       0.000437335026
  error estimate for blocks of size 2^( 4) =       0.000449361419
  error estimate for blocks of size 2^( 5) =       0.000461061071
  error estimate for blocks of size 2^( 6) =       0.000469874555
  error estimate for blocks of size 2^( 7) =       0.000475484811

      target function =                  N/A
              le_mean =     -16.910139606111
             les_mean =     286.294067474672
             stat err =       0.000463945464
             autocorr =       1.261525706643
              std dev =       0.584162774528
             le_variance =       0.341246147145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910139605975        initial
     2.3283e+02     2.3283e+03             1.0181e-06       -16.910139608149  <--
     9.3132e+02     9.3132e+03             2.5454e-07       -16.910139607062
     3.7253e+03     3.7253e+04             6.3635e-08       -16.910139606111

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 3.7420e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267379e-02 1 1  ON 2
 uu_3                -2.075321e-02 1 1  ON 3
 uu_4                -6.908282e-02 1 1  ON 4
 uu_5                -1.036374e-01 1 1  ON 5
 uu_6                -1.293031e-01 1 1  ON 6
 uu_7                -1.401222e-01 1 1  ON 7
 uu_8                -1.303598e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321203e-01 1 1  ON 10
 ud_1                 1.758309e-01 1 1  ON 11
 ud_2                 6.449060e-02 1 1  ON 12
 ud_3                -2.868214e-03 1 1  ON 13
 ud_4                -5.884654e-02 1 1  ON 14
 ud_5                -1.018526e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548357e-01 1 1  ON 18
 ud_9                -1.441985e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406109e-01 1 1  ON 21
 eO_2                -2.620720e-02 1 1  ON 22
 eO_3                 2.963187e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855458e-01 1 1  ON 25
 eO_6                 2.577047e-01 1 1  ON 26
 eO_7                -4.294634e-02 1 1  ON 27
 eO_8                -2.201874e-01 1 1  ON 28
 eO_9                -7.889695e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452785e-01 1 1  ON 31
eH1_2                -1.014762e-01 1 1  ON 32
eH1_3                -4.945072e-02 1 1  ON 33
eH1_4                 2.090546e-03 1 1  ON 34
eH1_5                 3.699476e-02 1 1  ON 35
eH1_6                 9.737256e-02 1 1  ON 36
eH1_7                 1.534853e-01 1 1  ON 37
eH1_8                 1.820512e-01 1 1  ON 38
eH1_9                 7.070191e-02 1 1  ON 39
eH2_0                -2.407624e-01 1 1  ON 40
eH2_1                -1.388001e-01 1 1  ON 41
eH2_2                -9.515687e-02 1 1  ON 42
eH2_3                -4.345227e-02 1 1  ON 43
eH2_4                 7.855023e-03 1 1  ON 44
eH2_5                 4.185515e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565298e-01 1 1  ON 47
eH2_8                 1.803128e-01 1 1  ON 48
eH2_9                 4.625666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 0.21917
====================================================
  Execution time = 2.4114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3487e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334894044196
                                         uncertainty =       0.006007185866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334894044196
                                         uncertainty =       0.006007185866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186639
  error estimate for blocks of size 2^( 2) =       0.000421431834
  error estimate for blocks of size 2^( 3) =       0.000433694077
  error estimate for blocks of size 2^( 4) =       0.000445993459
  error estimate for blocks of size 2^( 5) =       0.000456012381
  error estimate for blocks of size 2^( 6) =       0.000465275983
  error estimate for blocks of size 2^( 7) =       0.000469889643

      target function =                  N/A
              le_mean =     -16.910041769884
             les_mean =     286.284379902309
             stat err =       0.000459292867
             autocorr =       1.259901266529
              std dev =       0.578677293939
             le_variance =       0.334867410520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691004176988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910041769884       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910041769589       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910041770210       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910041768883       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910041774402       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910041775224       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910041771327       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.343111e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910041769884       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910041769810       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910041769960       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910041769625       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910041771005       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910041771209       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910041770238       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.360983e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910041769884       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910041769866       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910041769903       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910041769818       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910041770164       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910041770215       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910041769972       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.090446e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0591e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.085825e-01 1 1  ON 0
 uu_1                 1.422476e-01 1 1  ON 1
 uu_2                 4.267366e-02 1 1  ON 2
 uu_3                -2.075304e-02 1 1  ON 3
 uu_4                -6.908267e-02 1 1  ON 4
 uu_5                -1.036374e-01 1 1  ON 5
 uu_6                -1.293034e-01 1 1  ON 6
 uu_7                -1.401225e-01 1 1  ON 7
 uu_8                -1.303599e-01 1 1  ON 8
 uu_9                -1.002199e-01 1 1  ON 9
 ud_0                 4.321207e-01 1 1  ON 10
 ud_1                 1.758313e-01 1 1  ON 11
 ud_2                 6.449052e-02 1 1  ON 12
 ud_3                -2.868111e-03 1 1  ON 13
 ud_4                -5.884665e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318429e-01 1 1  ON 16
 ud_7                -1.515536e-01 1 1  ON 17
 ud_8                -1.548362e-01 1 1  ON 18
 ud_9                -1.441987e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406110e-01 1 1  ON 21
 eO_2                -2.620695e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235619e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577051e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201878e-01 1 1  ON 28
 eO_9                -7.889754e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452784e-01 1 1  ON 31
eH1_2                -1.014767e-01 1 1  ON 32
eH1_3                -4.945083e-02 1 1  ON 33
eH1_4                 2.090290e-03 1 1  ON 34
eH1_5                 3.699457e-02 1 1  ON 35
eH1_6                 9.737236e-02 1 1  ON 36
eH1_7                 1.534855e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070260e-02 1 1  ON 39
eH2_0                -2.407629e-01 1 1  ON 40
eH2_1                -1.388003e-01 1 1  ON 41
eH2_2                -9.515705e-02 1 1  ON 42
eH2_3                -4.345299e-02 1 1  ON 43
eH2_4                 7.854642e-03 1 1  ON 44
eH2_5                 4.185520e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565302e-01 1 1  ON 47
eH2_8                 1.803136e-01 1 1  ON 48
eH2_9                 4.625750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.269716
====================================================
  Execution time = 2.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4321e-01
  Total weights = 2.0000e+06
  Execution time = 2.6967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343347276946
                                         uncertainty =       0.006597916085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343347276946
                                         uncertainty =       0.006597916085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414252969
  error estimate for blocks of size 2^( 2) =       0.000426281109
  error estimate for blocks of size 2^( 3) =       0.000438857959
  error estimate for blocks of size 2^( 4) =       0.000450611901
  error estimate for blocks of size 2^( 5) =       0.000460285195
  error estimate for blocks of size 2^( 6) =       0.000468965089
  error estimate for blocks of size 2^( 7) =       0.000475312612

      target function =                  N/A
              le_mean =     -16.910116296249
             les_mean =     286.295244025210
             stat err =       0.000463793699
             autocorr =       1.253482946470
              std dev =       0.585842166573
             le_variance =       0.343211044134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343348855146
                                         uncertainty =       0.006597953392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343348855146
                                         uncertainty =       0.006597953392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414253920
  error estimate for blocks of size 2^( 2) =       0.000426282001
  error estimate for blocks of size 2^( 3) =       0.000438858778
  error estimate for blocks of size 2^( 4) =       0.000450612668
  error estimate for blocks of size 2^( 5) =       0.000460285932
  error estimate for blocks of size 2^( 6) =       0.000468965830
  error estimate for blocks of size 2^( 7) =       0.000475313372

      target function =                  N/A
              le_mean =     -16.910116279847
             les_mean =     286.295245047442
             stat err =       0.000463794450
             autocorr =       1.253481248027
              std dev =       0.585843512461
             le_variance =       0.343212621092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343348068225
                                         uncertainty =       0.006597934829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343348068225
                                         uncertainty =       0.006597934829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414253446
  error estimate for blocks of size 2^( 2) =       0.000426281556
  error estimate for blocks of size 2^( 3) =       0.000438858370
  error estimate for blocks of size 2^( 4) =       0.000450612285
  error estimate for blocks of size 2^( 5) =       0.000460285565
  error estimate for blocks of size 2^( 6) =       0.000468965460
  error estimate for blocks of size 2^( 7) =       0.000475312993

      target function =                  N/A
              le_mean =     -16.910116287989
             les_mean =     286.295244536511
             stat err =       0.000463794076
             autocorr =       1.253482094539
              std dev =       0.585842841374
             le_variance =       0.343211834790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343347375921
                                         uncertainty =       0.006597918431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343347375921
                                         uncertainty =       0.006597918431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414253028
  error estimate for blocks of size 2^( 2) =       0.000426281164
  error estimate for blocks of size 2^( 3) =       0.000438858011
  error estimate for blocks of size 2^( 4) =       0.000450611949
  error estimate for blocks of size 2^( 5) =       0.000460285241
  error estimate for blocks of size 2^( 6) =       0.000468965136
  error estimate for blocks of size 2^( 7) =       0.000475312660

      target function =                  N/A
              le_mean =     -16.910116295215
             les_mean =     286.295244089105
             stat err =       0.000463793746
             autocorr =       1.253482839900
              std dev =       0.585842250978
             le_variance =       0.343211143031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910116296249        initial  <--
     5.8208e+01     5.8208e+02             3.3431e-06       -16.910116279847
     2.3283e+02     2.3283e+03             8.3610e-07       -16.910116287989
     9.3132e+02     9.3132e+03             2.0904e-07       -16.910116295215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.3920
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267379e-02 1 1  ON 2
 uu_3                -2.075321e-02 1 1  ON 3
 uu_4                -6.908282e-02 1 1  ON 4
 uu_5                -1.036374e-01 1 1  ON 5
 uu_6                -1.293031e-01 1 1  ON 6
 uu_7                -1.401222e-01 1 1  ON 7
 uu_8                -1.303598e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321203e-01 1 1  ON 10
 ud_1                 1.758309e-01 1 1  ON 11
 ud_2                 6.449060e-02 1 1  ON 12
 ud_3                -2.868214e-03 1 1  ON 13
 ud_4                -5.884654e-02 1 1  ON 14
 ud_5                -1.018526e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548357e-01 1 1  ON 18
 ud_9                -1.441985e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406109e-01 1 1  ON 21
 eO_2                -2.620720e-02 1 1  ON 22
 eO_3                 2.963187e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855458e-01 1 1  ON 25
 eO_6                 2.577047e-01 1 1  ON 26
 eO_7                -4.294634e-02 1 1  ON 27
 eO_8                -2.201874e-01 1 1  ON 28
 eO_9                -7.889695e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452785e-01 1 1  ON 31
eH1_2                -1.014762e-01 1 1  ON 32
eH1_3                -4.945072e-02 1 1  ON 33
eH1_4                 2.090546e-03 1 1  ON 34
eH1_5                 3.699476e-02 1 1  ON 35
eH1_6                 9.737256e-02 1 1  ON 36
eH1_7                 1.534853e-01 1 1  ON 37
eH1_8                 1.820512e-01 1 1  ON 38
eH1_9                 7.070191e-02 1 1  ON 39
eH2_0                -2.407624e-01 1 1  ON 40
eH2_1                -1.388001e-01 1 1  ON 41
eH2_2                -9.515687e-02 1 1  ON 42
eH2_3                -4.345227e-02 1 1  ON 43
eH2_4                 7.855023e-03 1 1  ON 44
eH2_5                 4.185515e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565298e-01 1 1  ON 47
eH2_8                 1.803128e-01 1 1  ON 48
eH2_9                 4.625666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8618
    reference variance = 0.291165
====================================================
  Execution time = 2.4069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337180142205
                                         uncertainty =       0.004483144437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337180142205
                                         uncertainty =       0.004483144437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582536
  error estimate for blocks of size 2^( 2) =       0.000422687232
  error estimate for blocks of size 2^( 3) =       0.000434837414
  error estimate for blocks of size 2^( 4) =       0.000446256506
  error estimate for blocks of size 2^( 5) =       0.000457282833
  error estimate for blocks of size 2^( 6) =       0.000465207244
  error estimate for blocks of size 2^( 7) =       0.000467634995

      target function =                  N/A
              le_mean =     -16.908914918529
             les_mean =     286.248559591080
             stat err =       0.000459095395
             autocorr =       1.250273214450
              std dev =       0.580651390766
             le_variance =       0.337156037599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690891491853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908914918529       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908914918278       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908914920149       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908914920285       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908914920142       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908914920242       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908914919881       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908914919944       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.716040e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908914918529       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908914918466       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908914918934       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908914918968       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908914918932       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908914918958       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908914918866       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908914918883       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.290117e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908914918529       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908914918513       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908914918630       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908914918640       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908914918632       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908914918637       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908914918612       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908914918611       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.322530e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0477e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267382e-02 1 1  ON 2
 uu_3                -2.075323e-02 1 1  ON 3
 uu_4                -6.908284e-02 1 1  ON 4
 uu_5                -1.036374e-01 1 1  ON 5
 uu_6                -1.293031e-01 1 1  ON 6
 uu_7                -1.401222e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321203e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449063e-02 1 1  ON 12
 ud_3                -2.868259e-03 1 1  ON 13
 ud_4                -5.884653e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548358e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406110e-01 1 1  ON 21
 eO_2                -2.620718e-02 1 1  ON 22
 eO_3                 2.963187e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855458e-01 1 1  ON 25
 eO_6                 2.577047e-01 1 1  ON 26
 eO_7                -4.294632e-02 1 1  ON 27
 eO_8                -2.201874e-01 1 1  ON 28
 eO_9                -7.889699e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452785e-01 1 1  ON 31
eH1_2                -1.014762e-01 1 1  ON 32
eH1_3                -4.945075e-02 1 1  ON 33
eH1_4                 2.090543e-03 1 1  ON 34
eH1_5                 3.699474e-02 1 1  ON 35
eH1_6                 9.737252e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820512e-01 1 1  ON 38
eH1_9                 7.070201e-02 1 1  ON 39
eH2_0                -2.407625e-01 1 1  ON 40
eH2_1                -1.388002e-01 1 1  ON 41
eH2_2                -9.515691e-02 1 1  ON 42
eH2_3                -4.345227e-02 1 1  ON 43
eH2_4                 7.855043e-03 1 1  ON 44
eH2_5                 4.185515e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565298e-01 1 1  ON 47
eH2_8                 1.803128e-01 1 1  ON 48
eH2_9                 4.625675e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9206
    reference variance = 0.229091
====================================================
  Execution time = 2.6095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3533e-01
  Total weights = 2.0000e+06
  Execution time = 2.7149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309429611
                                         uncertainty =       0.005765916140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309429611
                                         uncertainty =       0.005765916140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466481
  error estimate for blocks of size 2^( 2) =       0.000421491558
  error estimate for blocks of size 2^( 3) =       0.000433441568
  error estimate for blocks of size 2^( 4) =       0.000444923978
  error estimate for blocks of size 2^( 5) =       0.000455085174
  error estimate for blocks of size 2^( 6) =       0.000461547687
  error estimate for blocks of size 2^( 7) =       0.000465881448

      target function =                  N/A
              le_mean =     -16.910157291039
             les_mean =     286.288745038511
             stat err =       0.000456859572
             autocorr =       1.244883596085
              std dev =       0.579073051095
             le_variance =       0.335325598504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309463675
                                         uncertainty =       0.005765918261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309463675
                                         uncertainty =       0.005765918261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466502
  error estimate for blocks of size 2^( 2) =       0.000421491579
  error estimate for blocks of size 2^( 3) =       0.000433441587
  error estimate for blocks of size 2^( 4) =       0.000444923993
  error estimate for blocks of size 2^( 5) =       0.000455085188
  error estimate for blocks of size 2^( 6) =       0.000461547701
  error estimate for blocks of size 2^( 7) =       0.000465881459

      target function =                  N/A
              le_mean =     -16.910157291497
             les_mean =     286.288745088130
             stat err =       0.000456859585
             autocorr =       1.244883542266
              std dev =       0.579073080569
             le_variance =       0.335325632639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309446641
                                         uncertainty =       0.005765917201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309446641
                                         uncertainty =       0.005765917201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466492
  error estimate for blocks of size 2^( 2) =       0.000421491568
  error estimate for blocks of size 2^( 3) =       0.000433441577
  error estimate for blocks of size 2^( 4) =       0.000444923986
  error estimate for blocks of size 2^( 5) =       0.000455085181
  error estimate for blocks of size 2^( 6) =       0.000461547694
  error estimate for blocks of size 2^( 7) =       0.000465881454

      target function =                  N/A
              le_mean =     -16.910157291268
             les_mean =     286.288745063316
             stat err =       0.000456859579
             autocorr =       1.244883569179
              std dev =       0.579073065830
             le_variance =       0.335325615570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309431739
                                         uncertainty =       0.005765916272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309431739
                                         uncertainty =       0.005765916272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466483
  error estimate for blocks of size 2^( 2) =       0.000421491559
  error estimate for blocks of size 2^( 3) =       0.000433441569
  error estimate for blocks of size 2^( 4) =       0.000444923979
  error estimate for blocks of size 2^( 5) =       0.000455085175
  error estimate for blocks of size 2^( 6) =       0.000461547688
  error estimate for blocks of size 2^( 7) =       0.000465881449

      target function =                  N/A
              le_mean =     -16.910157291067
             les_mean =     286.288745041611
             stat err =       0.000456859573
             autocorr =       1.244883592723
              std dev =       0.579073052937
             le_variance =       0.335325600637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910157291039        initial
     5.8208e+02     5.8208e+03             3.7160e-07       -16.910157291497  <--
     2.3283e+03     2.3283e+04             9.2901e-08       -16.910157291268
     9.3132e+03     9.3132e+04             2.3225e-08       -16.910157291067

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 3.9810e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884649e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620715e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294626e-02 1 1  ON 27
 eO_8                -2.201875e-01 1 1  ON 28
 eO_9                -7.889713e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945085e-02 1 1  ON 33
eH1_4                 2.090535e-03 1 1  ON 34
eH1_5                 3.699468e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070229e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515702e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855101e-03 1 1  ON 44
eH2_5                 4.185513e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.004
    reference variance = 0.289238
====================================================
  Execution time = 2.3955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3566e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335684951372
                                         uncertainty =       0.003845748739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335684951372
                                         uncertainty =       0.003845748739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409669833
  error estimate for blocks of size 2^( 2) =       0.000421587480
  error estimate for blocks of size 2^( 3) =       0.000434583092
  error estimate for blocks of size 2^( 4) =       0.000447483991
  error estimate for blocks of size 2^( 5) =       0.000459739465
  error estimate for blocks of size 2^( 6) =       0.000469607440
  error estimate for blocks of size 2^( 7) =       0.000473949113

      target function =                  N/A
              le_mean =     -16.909324229238
             les_mean =     286.260904466111
             stat err =       0.000462695002
             autocorr =       1.275620960472
              std dev =       0.579360634176
             le_variance =       0.335658744432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690932422924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909324229238       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909324233486       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909324236129       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909324237940       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909324244640       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909324242953       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909324243626       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909324243265       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.533049e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909324229238       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909324230301       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909324230964       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909324231417       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909324233093       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909324232673       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909324232842       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909324232751       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.832805e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909324229238       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909324229504       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909324229670       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909324229783       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909324230203       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909324230097       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909324230139       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909324230123       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.582127e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0349e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.085823e-01 1 1  ON 0
 uu_1                 1.422475e-01 1 1  ON 1
 uu_2                 4.267397e-02 1 1  ON 2
 uu_3                -2.075340e-02 1 1  ON 3
 uu_4                -6.908292e-02 1 1  ON 4
 uu_5                -1.036372e-01 1 1  ON 5
 uu_6                -1.293034e-01 1 1  ON 6
 uu_7                -1.401225e-01 1 1  ON 7
 uu_8                -1.303598e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321203e-01 1 1  ON 10
 ud_1                 1.758310e-01 1 1  ON 11
 ud_2                 6.449070e-02 1 1  ON 12
 ud_3                -2.868445e-03 1 1  ON 13
 ud_4                -5.884640e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515535e-01 1 1  ON 17
 ud_8                -1.548358e-01 1 1  ON 18
 ud_9                -1.441986e-01 1 1  ON 19
 eO_0                -7.551567e-01 1 1  ON 20
 eO_1                -4.406114e-01 1 1  ON 21
 eO_2                -2.620701e-02 1 1  ON 22
 eO_3                 2.963189e-01 1 1  ON 23
 eO_4                 5.235618e-01 1 1  ON 24
 eO_5                 4.855461e-01 1 1  ON 25
 eO_6                 2.577050e-01 1 1  ON 26
 eO_7                -4.294617e-02 1 1  ON 27
 eO_8                -2.201877e-01 1 1  ON 28
 eO_9                -7.889737e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452788e-01 1 1  ON 31
eH1_2                -1.014766e-01 1 1  ON 32
eH1_3                -4.945115e-02 1 1  ON 33
eH1_4                 2.090444e-03 1 1  ON 34
eH1_5                 3.699458e-02 1 1  ON 35
eH1_6                 9.737238e-02 1 1  ON 36
eH1_7                 1.534856e-01 1 1  ON 37
eH1_8                 1.820518e-01 1 1  ON 38
eH1_9                 7.070259e-02 1 1  ON 39
eH2_0                -2.407628e-01 1 1  ON 40
eH2_1                -1.388006e-01 1 1  ON 41
eH2_2                -9.515722e-02 1 1  ON 42
eH2_3                -4.345246e-02 1 1  ON 43
eH2_4                 7.855011e-03 1 1  ON 44
eH2_5                 4.185513e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565300e-01 1 1  ON 47
eH2_8                 1.803132e-01 1 1  ON 48
eH2_9                 4.625738e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.185066
====================================================
  Execution time = 2.4176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3180e-01
  Total weights = 2.0000e+06
  Execution time = 2.7082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331916084129
                                         uncertainty =       0.003785760980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331916084129
                                         uncertainty =       0.003785760980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407307459
  error estimate for blocks of size 2^( 2) =       0.000419315350
  error estimate for blocks of size 2^( 3) =       0.000432203466
  error estimate for blocks of size 2^( 4) =       0.000444831375
  error estimate for blocks of size 2^( 5) =       0.000456648787
  error estimate for blocks of size 2^( 6) =       0.000464758923
  error estimate for blocks of size 2^( 7) =       0.000471641610

      target function =                  N/A
              le_mean =     -16.909866922654
             les_mean =     286.275397908191
             stat err =       0.000459470174
             autocorr =       1.272535546280
              std dev =       0.576019732502
             le_variance =       0.331798732232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915572417
                                         uncertainty =       0.003785747602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915572417
                                         uncertainty =       0.003785747602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407307145
  error estimate for blocks of size 2^( 2) =       0.000419315046
  error estimate for blocks of size 2^( 3) =       0.000432203162
  error estimate for blocks of size 2^( 4) =       0.000444831078
  error estimate for blocks of size 2^( 5) =       0.000456648491
  error estimate for blocks of size 2^( 6) =       0.000464758636
  error estimate for blocks of size 2^( 7) =       0.000471641304

      target function =                  N/A
              le_mean =     -16.909866917501
             les_mean =     286.275397222672
             stat err =       0.000459469877
             autocorr =       1.272535865972
              std dev =       0.576019288716
             le_variance =       0.331798220973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915827339
                                         uncertainty =       0.003785754277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915827339
                                         uncertainty =       0.003785754277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407307301
  error estimate for blocks of size 2^( 2) =       0.000419315198
  error estimate for blocks of size 2^( 3) =       0.000432203314
  error estimate for blocks of size 2^( 4) =       0.000444831226
  error estimate for blocks of size 2^( 5) =       0.000456648638
  error estimate for blocks of size 2^( 6) =       0.000464758779
  error estimate for blocks of size 2^( 7) =       0.000471641456

      target function =                  N/A
              le_mean =     -16.909866920072
             les_mean =     286.275397564318
             stat err =       0.000459470025
             autocorr =       1.272535706850
              std dev =       0.576019509800
             le_variance =       0.331798475670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331916052000
                                         uncertainty =       0.003785760142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331916052000
                                         uncertainty =       0.003785760142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407307439
  error estimate for blocks of size 2^( 2) =       0.000419315331
  error estimate for blocks of size 2^( 3) =       0.000432203447
  error estimate for blocks of size 2^( 4) =       0.000444831356
  error estimate for blocks of size 2^( 5) =       0.000456648768
  error estimate for blocks of size 2^( 6) =       0.000464758905
  error estimate for blocks of size 2^( 7) =       0.000471641591

      target function =                  N/A
              le_mean =     -16.909866922331
             les_mean =     286.275397865168
             stat err =       0.000459470155
             autocorr =       1.272535566377
              std dev =       0.576019704639
             le_variance =       0.331798700132


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909866922654        initial  <--
     1.4552e+02     1.4552e+03             1.5330e-06       -16.909866917501
     5.8208e+02     5.8208e+03             3.8328e-07       -16.909866920072
     2.3283e+03     2.3283e+04             9.5821e-08       -16.909866922331

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8615
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884649e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620715e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294626e-02 1 1  ON 27
 eO_8                -2.201875e-01 1 1  ON 28
 eO_9                -7.889713e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945085e-02 1 1  ON 33
eH1_4                 2.090535e-03 1 1  ON 34
eH1_5                 3.699468e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070229e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515702e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855101e-03 1 1  ON 44
eH2_5                 4.185513e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8728
    reference variance = 0.266648
====================================================
  Execution time = 2.4055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337067592542
                                         uncertainty =       0.004140335823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337067592542
                                         uncertainty =       0.004140335823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410454375
  error estimate for blocks of size 2^( 2) =       0.000422064953
  error estimate for blocks of size 2^( 3) =       0.000434618509
  error estimate for blocks of size 2^( 4) =       0.000446993564
  error estimate for blocks of size 2^( 5) =       0.000457247870
  error estimate for blocks of size 2^( 6) =       0.000465187845
  error estimate for blocks of size 2^( 7) =       0.000468821324

      target function =                  N/A
              le_mean =     -16.909404663768
             les_mean =     286.264911502369
             stat err =       0.000459562651
             autocorr =       1.253601991663
              std dev =       0.580470143744
             le_variance =       0.336945587778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690940466377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909404663768       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909404664088       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909404664199       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909404664421       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909404664505       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909404664629       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909404664787       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909404664714       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.486628e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909404663768       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909404663848       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909404663876       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909404663931       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909404663956       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909404663980       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909404664021       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909404664005       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.716594e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909404663768       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909404663788       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909404663795       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909404663809       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909404663814       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909404663823       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909404663815       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909404663811       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.291501e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0398e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267391e-02 1 1  ON 2
 uu_3                -2.075332e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401225e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449070e-02 1 1  ON 12
 ud_3                -2.868392e-03 1 1  ON 13
 ud_4                -5.884648e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620713e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294625e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889716e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945085e-02 1 1  ON 33
eH1_4                 2.090512e-03 1 1  ON 34
eH1_5                 3.699467e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070232e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345227e-02 1 1  ON 43
eH2_4                 7.855081e-03 1 1  ON 44
eH2_5                 4.185512e-02 1 1  ON 45
eH2_6                 1.026546e-01 1 1  ON 46
eH2_7                 1.565300e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625704e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8294
    reference variance = 0.356395
====================================================
  Execution time = 2.3874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2935e-01
  Total weights = 2.0000e+06
  Execution time = 2.7003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436691792
                                         uncertainty =       0.003492758718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436691792
                                         uncertainty =       0.003492758718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405798963
  error estimate for blocks of size 2^( 2) =       0.000417459285
  error estimate for blocks of size 2^( 3) =       0.000429432798
  error estimate for blocks of size 2^( 4) =       0.000440762817
  error estimate for blocks of size 2^( 5) =       0.000450088660
  error estimate for blocks of size 2^( 6) =       0.000457907340
  error estimate for blocks of size 2^( 7) =       0.000461445613

      target function =                  N/A
              le_mean =     -16.909727727200
             les_mean =     286.268237240195
             stat err =       0.000452551108
             autocorr =       1.243693597226
              std dev =       0.573886397159
             le_variance =       0.329345596844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436664150
                                         uncertainty =       0.003492758836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436664150
                                         uncertainty =       0.003492758836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405798946
  error estimate for blocks of size 2^( 2) =       0.000417459267
  error estimate for blocks of size 2^( 3) =       0.000429432781
  error estimate for blocks of size 2^( 4) =       0.000440762799
  error estimate for blocks of size 2^( 5) =       0.000450088644
  error estimate for blocks of size 2^( 6) =       0.000457907324
  error estimate for blocks of size 2^( 7) =       0.000461445600

      target function =                  N/A
              le_mean =     -16.909727727158
             les_mean =     286.268237211141
             stat err =       0.000452551092
             autocorr =       1.243693614063
              std dev =       0.573886373084
             le_variance =       0.329345569211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436677964
                                         uncertainty =       0.003492758777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436677964
                                         uncertainty =       0.003492758777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405798955
  error estimate for blocks of size 2^( 2) =       0.000417459276
  error estimate for blocks of size 2^( 3) =       0.000429432790
  error estimate for blocks of size 2^( 4) =       0.000440762808
  error estimate for blocks of size 2^( 5) =       0.000450088652
  error estimate for blocks of size 2^( 6) =       0.000457907332
  error estimate for blocks of size 2^( 7) =       0.000461445607

      target function =                  N/A
              le_mean =     -16.909727727179
             les_mean =     286.268237225660
             stat err =       0.000452551100
             autocorr =       1.243693605649
              std dev =       0.573886385116
             le_variance =       0.329345583021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436690063
                                         uncertainty =       0.003492758726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329436690063
                                         uncertainty =       0.003492758726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405798962
  error estimate for blocks of size 2^( 2) =       0.000417459283
  error estimate for blocks of size 2^( 3) =       0.000429432797
  error estimate for blocks of size 2^( 4) =       0.000440762816
  error estimate for blocks of size 2^( 5) =       0.000450088659
  error estimate for blocks of size 2^( 6) =       0.000457907339
  error estimate for blocks of size 2^( 7) =       0.000461445613

      target function =                  N/A
              le_mean =     -16.909727727197
             les_mean =     286.268237238378
             stat err =       0.000452551107
             autocorr =       1.243693598281
              std dev =       0.573886395653
             le_variance =       0.329345595116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909727727200        initial  <--
     1.4552e+03     1.4552e+04             1.4866e-07       -16.909727727158
     5.8208e+03     5.8208e+04             3.7166e-08       -16.909727727179
     2.3283e+04     2.3283e+05             9.2915e-09       -16.909727727197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6864
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884649e-02 1 1  ON 14
 ud_5                -1.018527e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620715e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294626e-02 1 1  ON 27
 eO_8                -2.201875e-01 1 1  ON 28
 eO_9                -7.889713e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945085e-02 1 1  ON 33
eH1_4                 2.090535e-03 1 1  ON 34
eH1_5                 3.699468e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070229e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515702e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855101e-03 1 1  ON 44
eH2_5                 4.185513e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9541
    reference variance = 0.490872
====================================================
  Execution time = 2.4056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3187e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331190503728
                                         uncertainty =       0.004046260081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331190503728
                                         uncertainty =       0.004046260081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407352051
  error estimate for blocks of size 2^( 2) =       0.000419382774
  error estimate for blocks of size 2^( 3) =       0.000431747508
  error estimate for blocks of size 2^( 4) =       0.000443516618
  error estimate for blocks of size 2^( 5) =       0.000453817227
  error estimate for blocks of size 2^( 6) =       0.000461492472
  error estimate for blocks of size 2^( 7) =       0.000465130957

      target function =                  N/A
              le_mean =     -16.909399582041
             les_mean =     286.259665446718
             stat err =       0.000455989318
             autocorr =       1.253053238868
              std dev =       0.576082795714
             le_variance =       0.331871387517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690939958204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399582041       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399582062       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399582051       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399582066       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399582037       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399582067       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399582067       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399582049       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.590971e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399582041       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399582046       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399582044       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399582047       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399582043       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399582048       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399582052       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399582042       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.977431e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909399582041       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909399582043       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909399582042       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909399581999       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909399582049       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909399581919       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909399582029       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909399582037       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.943578e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0458e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422473e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075332e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868396e-03 1 1  ON 13
 ud_4                -5.884649e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620714e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294625e-02 1 1  ON 27
 eO_8                -2.201875e-01 1 1  ON 28
 eO_9                -7.889714e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945085e-02 1 1  ON 33
eH1_4                 2.090537e-03 1 1  ON 34
eH1_5                 3.699468e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070229e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515702e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855100e-03 1 1  ON 44
eH2_5                 4.185513e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9734
    reference variance = 0.349334
====================================================
  Execution time = 2.3892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3457e-01
  Total weights = 2.0000e+06
  Execution time = 2.7069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568703454
                                         uncertainty =       0.003236625793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568703454
                                         uncertainty =       0.003236625793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409007085
  error estimate for blocks of size 2^( 2) =       0.000420993639
  error estimate for blocks of size 2^( 3) =       0.000433002170
  error estimate for blocks of size 2^( 4) =       0.000444127751
  error estimate for blocks of size 2^( 5) =       0.000453686902
  error estimate for blocks of size 2^( 6) =       0.000462603728
  error estimate for blocks of size 2^( 7) =       0.000465272537

      target function =                  N/A
              le_mean =     -16.910581021263
             les_mean =     286.302323900029
             stat err =       0.000456422730
             autocorr =       1.245296782984
              std dev =       0.578423366247
             le_variance =       0.334573590620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568706319
                                         uncertainty =       0.003236625839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568706319
                                         uncertainty =       0.003236625839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409007086
  error estimate for blocks of size 2^( 2) =       0.000420993641
  error estimate for blocks of size 2^( 3) =       0.000433002172
  error estimate for blocks of size 2^( 4) =       0.000444127752
  error estimate for blocks of size 2^( 5) =       0.000453686904
  error estimate for blocks of size 2^( 6) =       0.000462603729
  error estimate for blocks of size 2^( 7) =       0.000465272538

      target function =                  N/A
              le_mean =     -16.910581021360
             les_mean =     286.302323906162
             stat err =       0.000456422731
             autocorr =       1.245296779174
              std dev =       0.578423368722
             le_variance =       0.334573593484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568704886
                                         uncertainty =       0.003236625816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568704886
                                         uncertainty =       0.003236625816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409007086
  error estimate for blocks of size 2^( 2) =       0.000420993640
  error estimate for blocks of size 2^( 3) =       0.000433002171
  error estimate for blocks of size 2^( 4) =       0.000444127751
  error estimate for blocks of size 2^( 5) =       0.000453686903
  error estimate for blocks of size 2^( 6) =       0.000462603729
  error estimate for blocks of size 2^( 7) =       0.000465272538

      target function =                  N/A
              le_mean =     -16.910581021311
             les_mean =     286.302323903095
             stat err =       0.000456422730
             autocorr =       1.245296781074
              std dev =       0.578423367485
             le_variance =       0.334573592052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568703633
                                         uncertainty =       0.003236625796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568703633
                                         uncertainty =       0.003236625796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409007085
  error estimate for blocks of size 2^( 2) =       0.000420993639
  error estimate for blocks of size 2^( 3) =       0.000433002170
  error estimate for blocks of size 2^( 4) =       0.000444127751
  error estimate for blocks of size 2^( 5) =       0.000453686902
  error estimate for blocks of size 2^( 6) =       0.000462603728
  error estimate for blocks of size 2^( 7) =       0.000465272537

      target function =                  N/A
              le_mean =     -16.910581021269
             les_mean =     286.302323900412
             stat err =       0.000456422730
             autocorr =       1.245296782736
              std dev =       0.578423366402
             le_variance =       0.334573590799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910581021263        initial
     1.4552e+04     1.4552e+05             1.5910e-08       -16.910581021360  <--
     5.8208e+04     5.8208e+05             3.9774e-09       -16.910581021311
     2.3283e+05     2.3283e+06             9.9436e-10       -16.910581021269

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 3.7522e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422473e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075332e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868397e-03 1 1  ON 13
 ud_4                -5.884649e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620714e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294625e-02 1 1  ON 27
 eO_8                -2.201875e-01 1 1  ON 28
 eO_9                -7.889714e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945086e-02 1 1  ON 33
eH1_4                 2.090543e-03 1 1  ON 34
eH1_5                 3.699467e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070230e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515703e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855097e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625702e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9874
    reference variance = 0.389107
====================================================
  Execution time = 2.4019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331956960146
                                         uncertainty =       0.003604763852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331956960146
                                         uncertainty =       0.003604763852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407439172
  error estimate for blocks of size 2^( 2) =       0.000419616007
  error estimate for blocks of size 2^( 3) =       0.000432062390
  error estimate for blocks of size 2^( 4) =       0.000444314664
  error estimate for blocks of size 2^( 5) =       0.000455080094
  error estimate for blocks of size 2^( 6) =       0.000463005314
  error estimate for blocks of size 2^( 7) =       0.000466526836

      target function =                  N/A
              le_mean =     -16.909705349290
             les_mean =     286.270148191063
             stat err =       0.000457231727
             autocorr =       1.259352058354
              std dev =       0.576206002444
             le_variance =       0.332013357252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690970534929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909705349290       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909705349435       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909705349380       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909705349532       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909705349597       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909705349529       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909705349579       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909705349582       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.266760e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909705349290       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909705349326       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909705349313       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909705349351       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909705349367       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909705349341       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909705349349       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909705349361       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.316728e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909705349290       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909705349299       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909705349296       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909705349305       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909705349329       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909705349366       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909705349286       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909705349368       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.291843e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0409e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075332e-02 1 1  ON 3
 uu_4                -6.908288e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002195e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868397e-03 1 1  ON 13
 ud_4                -5.884648e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318431e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620713e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294625e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889715e-02 1 1  ON 29
eH1_0                -2.471406e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945087e-02 1 1  ON 33
eH1_4                 2.090533e-03 1 1  ON 34
eH1_5                 3.699467e-02 1 1  ON 35
eH1_6                 9.737241e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820515e-01 1 1  ON 38
eH1_9                 7.070231e-02 1 1  ON 39
eH2_0                -2.407626e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515703e-02 1 1  ON 42
eH2_3                -4.345226e-02 1 1  ON 43
eH2_4                 7.855105e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803129e-01 1 1  ON 48
eH2_9                 4.625703e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9527
    reference variance = 0.262305
====================================================
  Execution time = 2.4039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2947e-01
  Total weights = 2.0000e+06
  Execution time = 2.6997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505219926
                                         uncertainty =       0.003063031944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505219926
                                         uncertainty =       0.003063031944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405877837
  error estimate for blocks of size 2^( 2) =       0.000418288901
  error estimate for blocks of size 2^( 3) =       0.000430554914
  error estimate for blocks of size 2^( 4) =       0.000442719511
  error estimate for blocks of size 2^( 5) =       0.000453806506
  error estimate for blocks of size 2^( 6) =       0.000462581880
  error estimate for blocks of size 2^( 7) =       0.000469261847

      target function =                  N/A
              le_mean =     -16.910600770095
             les_mean =     286.297891877458
             stat err =       0.000457092436
             autocorr =       1.268286574160
              std dev =       0.573997941340
             le_variance =       0.329473636663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505224511
                                         uncertainty =       0.003063032053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505224511
                                         uncertainty =       0.003063032053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405877840
  error estimate for blocks of size 2^( 2) =       0.000418288904
  error estimate for blocks of size 2^( 3) =       0.000430554916
  error estimate for blocks of size 2^( 4) =       0.000442719513
  error estimate for blocks of size 2^( 5) =       0.000453806508
  error estimate for blocks of size 2^( 6) =       0.000462581880
  error estimate for blocks of size 2^( 7) =       0.000469261848

      target function =                  N/A
              le_mean =     -16.910600770203
             les_mean =     286.297891885688
             stat err =       0.000457092437
             autocorr =       1.268286563522
              std dev =       0.573997945336
             le_variance =       0.329473641250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505222219
                                         uncertainty =       0.003063031998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505222219
                                         uncertainty =       0.003063031998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405877838
  error estimate for blocks of size 2^( 2) =       0.000418288903
  error estimate for blocks of size 2^( 3) =       0.000430554915
  error estimate for blocks of size 2^( 4) =       0.000442719512
  error estimate for blocks of size 2^( 5) =       0.000453806507
  error estimate for blocks of size 2^( 6) =       0.000462581880
  error estimate for blocks of size 2^( 7) =       0.000469261847

      target function =                  N/A
              le_mean =     -16.910600770149
             les_mean =     286.297891881573
             stat err =       0.000457092437
             autocorr =       1.268286568853
              std dev =       0.573997943338
             le_variance =       0.329473638956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505220213
                                         uncertainty =       0.003063031951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329505220213
                                         uncertainty =       0.003063031951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405877837
  error estimate for blocks of size 2^( 2) =       0.000418288902
  error estimate for blocks of size 2^( 3) =       0.000430554914
  error estimate for blocks of size 2^( 4) =       0.000442719511
  error estimate for blocks of size 2^( 5) =       0.000453806506
  error estimate for blocks of size 2^( 6) =       0.000462581880
  error estimate for blocks of size 2^( 7) =       0.000469261847

      target function =                  N/A
              le_mean =     -16.910600770102
             les_mean =     286.297891877973
             stat err =       0.000457092436
             autocorr =       1.268286573502
              std dev =       0.573997941590
             le_variance =       0.329473636949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910600770095        initial
     3.6380e+03     3.6380e+04             5.2668e-08       -16.910600770203  <--
     1.4552e+04     1.4552e+05             1.3167e-08       -16.910600770149
     5.8208e+04     5.8208e+05             3.2918e-09       -16.910600770102

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 4.1075e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0013
    reference variance = 0.223301
====================================================
  Execution time = 2.4020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343361631605
                                         uncertainty =       0.006047381518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343361631605
                                         uncertainty =       0.006047381518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414265268
  error estimate for blocks of size 2^( 2) =       0.000426424301
  error estimate for blocks of size 2^( 3) =       0.000438593130
  error estimate for blocks of size 2^( 4) =       0.000450668937
  error estimate for blocks of size 2^( 5) =       0.000461796169
  error estimate for blocks of size 2^( 6) =       0.000469826557
  error estimate for blocks of size 2^( 7) =       0.000474835138

      target function =                  N/A
              le_mean =     -16.910292999952
             les_mean =     286.301240596790
             stat err =       0.000464281700
             autocorr =       1.256047564687
              std dev =       0.585859560129
             le_variance =       0.343231424194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691029299995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910292999952       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910292999925       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910293000176       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910292999843       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910292999773       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910292999725       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910292999689       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910292999606       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 3.149485e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910292999952       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910292999945       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910293000008       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910292999924       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910292999907       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910292999895       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910292999887       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910292999865       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 7.875358e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910292999952       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910292999950       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910292999966       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910292999945       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910292999937       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910292999914       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910292999933       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910292999938       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.968942e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0401e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267392e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908284e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401225e-01 1 1  ON 7
 uu_8                -1.303598e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321205e-01 1 1  ON 10
 ud_1                 1.758309e-01 1 1  ON 11
 ud_2                 6.449075e-02 1 1  ON 12
 ud_3                -2.868406e-03 1 1  ON 13
 ud_4                -5.884641e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548360e-01 1 1  ON 18
 ud_9                -1.441985e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620707e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235618e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577049e-01 1 1  ON 26
 eO_7                -4.294622e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889723e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452787e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945094e-02 1 1  ON 33
eH1_4                 2.090500e-03 1 1  ON 34
eH1_5                 3.699463e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534855e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070239e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515708e-02 1 1  ON 42
eH2_3                -4.345229e-02 1 1  ON 43
eH2_4                 7.855130e-03 1 1  ON 44
eH2_5                 4.185516e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625711e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8188
    reference variance = 1.16459
====================================================
  Execution time = 2.3852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3838e-01
  Total weights = 2.0000e+06
  Execution time = 2.7002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405519174
                                         uncertainty =       0.005909210700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405519174
                                         uncertainty =       0.005909210700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328076
  error estimate for blocks of size 2^( 2) =       0.000423312795
  error estimate for blocks of size 2^( 3) =       0.000435926538
  error estimate for blocks of size 2^( 4) =       0.000448033463
  error estimate for blocks of size 2^( 5) =       0.000457975745
  error estimate for blocks of size 2^( 6) =       0.000466954417
  error estimate for blocks of size 2^( 7) =       0.000470109559

      target function =                  N/A
              le_mean =     -16.909654501510
             les_mean =     286.274796764157
             stat err =       0.000460768296
             autocorr =       1.254840331245
              std dev =       0.581705744259
             le_variance =       0.338381572904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405654746
                                         uncertainty =       0.005909213356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405654746
                                         uncertainty =       0.005909213356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328159
  error estimate for blocks of size 2^( 2) =       0.000423312872
  error estimate for blocks of size 2^( 3) =       0.000435926609
  error estimate for blocks of size 2^( 4) =       0.000448033529
  error estimate for blocks of size 2^( 5) =       0.000457975809
  error estimate for blocks of size 2^( 6) =       0.000466954480
  error estimate for blocks of size 2^( 7) =       0.000470109624

      target function =                  N/A
              le_mean =     -16.909654501356
             les_mean =     286.274796894525
             stat err =       0.000460768361
             autocorr =       1.254840181340
              std dev =       0.581705860786
             le_variance =       0.338381708473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405586978
                                         uncertainty =       0.005909212028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405586978
                                         uncertainty =       0.005909212028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328118
  error estimate for blocks of size 2^( 2) =       0.000423312834
  error estimate for blocks of size 2^( 3) =       0.000435926573
  error estimate for blocks of size 2^( 4) =       0.000448033496
  error estimate for blocks of size 2^( 5) =       0.000457975777
  error estimate for blocks of size 2^( 6) =       0.000466954449
  error estimate for blocks of size 2^( 7) =       0.000470109592

      target function =                  N/A
              le_mean =     -16.909654501433
             les_mean =     286.274796829355
             stat err =       0.000460768328
             autocorr =       1.254840256281
              std dev =       0.581705802538
             le_variance =       0.338381640707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405527650
                                         uncertainty =       0.005909210866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405527650
                                         uncertainty =       0.005909210866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328082
  error estimate for blocks of size 2^( 2) =       0.000423312800
  error estimate for blocks of size 2^( 3) =       0.000435926542
  error estimate for blocks of size 2^( 4) =       0.000448033467
  error estimate for blocks of size 2^( 5) =       0.000457975749
  error estimate for blocks of size 2^( 6) =       0.000466954421
  error estimate for blocks of size 2^( 7) =       0.000470109563

      target function =                  N/A
              le_mean =     -16.909654501501
             les_mean =     286.274796772307
             stat err =       0.000460768300
             autocorr =       1.254840321876
              std dev =       0.581705751545
             le_variance =       0.338381581380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909654501510        initial  <--
     9.0949e+02     9.0949e+03             3.1495e-07       -16.909654501356
     3.6380e+03     3.6380e+04             7.8754e-08       -16.909654501433
     1.4552e+04     1.4552e+05             1.9689e-08       -16.909654501501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5090
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7916e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8593
    reference variance = 0.456153
====================================================
  Execution time = 2.3902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337918483711
                                         uncertainty =       0.004499989342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337918483711
                                         uncertainty =       0.004499989342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411038002
  error estimate for blocks of size 2^( 2) =       0.000422767305
  error estimate for blocks of size 2^( 3) =       0.000435348785
  error estimate for blocks of size 2^( 4) =       0.000447337675
  error estimate for blocks of size 2^( 5) =       0.000457463808
  error estimate for blocks of size 2^( 6) =       0.000465683080
  error estimate for blocks of size 2^( 7) =       0.000470439239

      target function =                  N/A
              le_mean =     -16.910660954443
             les_mean =     286.308358224971
             stat err =       0.000460230950
             autocorr =       1.253682869972
              std dev =       0.581295516764
             le_variance =       0.337904477810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691066095444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910660954443       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910660954476       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910660954513       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910660954537       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910660954524       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910660954542       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910660954570       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910660954577       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.671620e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910660954443       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910660954451       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910660954460       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910660954467       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910660954468       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910660954363       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910660954474       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910660954506       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 6.679058e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910660954443       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910660954445       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910660954447       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910660954509       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910660954448       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910660954451       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910660954450       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910660954447       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.669765e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0267e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267388e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868393e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090502e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515705e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855127e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.57051
====================================================
  Execution time = 2.3640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3715e-01
  Total weights = 2.0000e+06
  Execution time = 2.7001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116945413
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116945413
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410579754
  error estimate for blocks of size 2^( 2) =       0.000422700763
  error estimate for blocks of size 2^( 3) =       0.000435305083
  error estimate for blocks of size 2^( 4) =       0.000447393827
  error estimate for blocks of size 2^( 5) =       0.000457786734
  error estimate for blocks of size 2^( 6) =       0.000466161818
  error estimate for blocks of size 2^( 7) =       0.000469559323

      target function =                  N/A
              le_mean =     -16.909483005803
             les_mean =     286.267766823988
             stat err =       0.000460225425
             autocorr =       1.256452731980
              std dev =       0.580647456745
             le_variance =       0.337151469025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116946952
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116946952
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410579755
  error estimate for blocks of size 2^( 2) =       0.000422700764
  error estimate for blocks of size 2^( 3) =       0.000435305084
  error estimate for blocks of size 2^( 4) =       0.000447393828
  error estimate for blocks of size 2^( 5) =       0.000457786735
  error estimate for blocks of size 2^( 6) =       0.000466161819
  error estimate for blocks of size 2^( 7) =       0.000469559323

      target function =                  N/A
              le_mean =     -16.909483005749
             les_mean =     286.267766823699
             stat err =       0.000460225426
             autocorr =       1.256452729537
              std dev =       0.580647458071
             le_variance =       0.337151470564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116946182
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116946182
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410579755
  error estimate for blocks of size 2^( 2) =       0.000422700764
  error estimate for blocks of size 2^( 3) =       0.000435305084
  error estimate for blocks of size 2^( 4) =       0.000447393827
  error estimate for blocks of size 2^( 5) =       0.000457786734
  error estimate for blocks of size 2^( 6) =       0.000466161818
  error estimate for blocks of size 2^( 7) =       0.000469559323

      target function =                  N/A
              le_mean =     -16.909483005776
             les_mean =     286.267766823843
             stat err =       0.000460225426
             autocorr =       1.256452730757
              std dev =       0.580647457408
             le_variance =       0.337151469794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116945509
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337116945509
                                         uncertainty =       0.003916527845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410579754
  error estimate for blocks of size 2^( 2) =       0.000422700763
  error estimate for blocks of size 2^( 3) =       0.000435305083
  error estimate for blocks of size 2^( 4) =       0.000447393827
  error estimate for blocks of size 2^( 5) =       0.000457786734
  error estimate for blocks of size 2^( 6) =       0.000466161818
  error estimate for blocks of size 2^( 7) =       0.000469559323

      target function =                  N/A
              le_mean =     -16.909483005800
             les_mean =     286.267766823970
             stat err =       0.000460225425
             autocorr =       1.256452731824
              std dev =       0.580647456828
             le_variance =       0.337151469121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909483005803        initial  <--
     9.0949e+03     9.0949e+04             2.6716e-08       -16.909483005749
     3.6380e+04     3.6380e+05             6.6791e-09       -16.909483005776
     1.4552e+05     1.4552e+06             1.6698e-09       -16.909483005800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.2938
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.209919
====================================================
  Execution time = 2.4044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2630e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326394062929
                                         uncertainty =       0.002541401945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326394062929
                                         uncertainty =       0.002541401945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403918844
  error estimate for blocks of size 2^( 2) =       0.000415833796
  error estimate for blocks of size 2^( 3) =       0.000428002256
  error estimate for blocks of size 2^( 4) =       0.000439625708
  error estimate for blocks of size 2^( 5) =       0.000450305452
  error estimate for blocks of size 2^( 6) =       0.000456786288
  error estimate for blocks of size 2^( 7) =       0.000461385758

      target function =                  N/A
              le_mean =     -16.910765446864
             les_mean =     286.300288700420
             stat err =       0.000452025802
             autocorr =       1.252386049343
              std dev =       0.571227506964
             le_variance =       0.326300864712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691076544686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910765446864       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910765446859       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910765446859       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910765446938       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910765446866       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910765446862       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910765446928       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910765446833       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.306741e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910765446864       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910765446863       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910765446863       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910765447092       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910765446865       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910765446865       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910765447109       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910765446493       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.766853e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910765446864       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910765446864       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910765446864       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910765446865       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910765446441       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910765446885       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910765446820       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910765447060       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.441713e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090503e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855129e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8047
    reference variance = 1.19707
====================================================
  Execution time = 2.3862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2419e-01
  Total weights = 2.0000e+06
  Execution time = 2.7115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009479
                                         uncertainty =       0.003253789446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009479
                                         uncertainty =       0.003253789446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402610129
  error estimate for blocks of size 2^( 2) =       0.000414890528
  error estimate for blocks of size 2^( 3) =       0.000427665237
  error estimate for blocks of size 2^( 4) =       0.000439407102
  error estimate for blocks of size 2^( 5) =       0.000450729446
  error estimate for blocks of size 2^( 6) =       0.000457187482
  error estimate for blocks of size 2^( 7) =       0.000463929918

      target function =                  N/A
              le_mean =     -16.910453837548
             les_mean =     286.287638661802
             stat err =       0.000452813487
             autocorr =       1.264938217878
              std dev =       0.569376704868
             le_variance =       0.324189832047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009012
                                         uncertainty =       0.003253789452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009012
                                         uncertainty =       0.003253789452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402610129
  error estimate for blocks of size 2^( 2) =       0.000414890527
  error estimate for blocks of size 2^( 3) =       0.000427665237
  error estimate for blocks of size 2^( 4) =       0.000439407102
  error estimate for blocks of size 2^( 5) =       0.000450729446
  error estimate for blocks of size 2^( 6) =       0.000457187482
  error estimate for blocks of size 2^( 7) =       0.000463929918

      target function =                  N/A
              le_mean =     -16.910453837539
             les_mean =     286.287638661010
             stat err =       0.000452813487
             autocorr =       1.264938217753
              std dev =       0.569376704457
             le_variance =       0.324189831578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009246
                                         uncertainty =       0.003253789449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009246
                                         uncertainty =       0.003253789449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402610129
  error estimate for blocks of size 2^( 2) =       0.000414890528
  error estimate for blocks of size 2^( 3) =       0.000427665237
  error estimate for blocks of size 2^( 4) =       0.000439407102
  error estimate for blocks of size 2^( 5) =       0.000450729446
  error estimate for blocks of size 2^( 6) =       0.000457187482
  error estimate for blocks of size 2^( 7) =       0.000463929918

      target function =                  N/A
              le_mean =     -16.910453837543
             les_mean =     286.287638661406
             stat err =       0.000452813487
             autocorr =       1.264938217816
              std dev =       0.569376704663
             le_variance =       0.324189831813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009450
                                         uncertainty =       0.003253789446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323916009450
                                         uncertainty =       0.003253789446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402610129
  error estimate for blocks of size 2^( 2) =       0.000414890528
  error estimate for blocks of size 2^( 3) =       0.000427665237
  error estimate for blocks of size 2^( 4) =       0.000439407102
  error estimate for blocks of size 2^( 5) =       0.000450729446
  error estimate for blocks of size 2^( 6) =       0.000457187482
  error estimate for blocks of size 2^( 7) =       0.000463929918

      target function =                  N/A
              le_mean =     -16.910453837548
             les_mean =     286.287638661753
             stat err =       0.000452813487
             autocorr =       1.264938217874
              std dev =       0.569376704843
             le_variance =       0.324189832017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910453837548        initial  <--
     9.0949e+04     9.0949e+05             2.3067e-09       -16.910453837539
     3.6380e+05     3.6380e+06             5.7669e-10       -16.910453837543
     1.4552e+06     1.4552e+07             1.4417e-10       -16.910453837548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5492
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8373
    reference variance = 0.187721
====================================================
  Execution time = 2.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329993738275
                                         uncertainty =       0.003429782093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329993738275
                                         uncertainty =       0.003429782093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406122135
  error estimate for blocks of size 2^( 2) =       0.000418350402
  error estimate for blocks of size 2^( 3) =       0.000431338203
  error estimate for blocks of size 2^( 4) =       0.000443798663
  error estimate for blocks of size 2^( 5) =       0.000453550444
  error estimate for blocks of size 2^( 6) =       0.000461313962
  error estimate for blocks of size 2^( 7) =       0.000464873326

      target function =                  N/A
              le_mean =     -16.910218611728
             les_mean =     286.285363708686
             stat err =       0.000455884099
             autocorr =       1.260072596992
              std dev =       0.574343431400
             le_variance =       0.329870377192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021861173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218611728       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218611728       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218611728       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218611728       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218611729       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218610769       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218611724       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218611923       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 2.827264e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218611728       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218611728       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218611728       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218611728       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218612331       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218613249       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218613010       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218607680       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 7.068103e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218611728       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218611728       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218611728       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218611728       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218610429       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218614514       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218608892       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218604419       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.767039e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0341e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9334
    reference variance = 0.806659
====================================================
  Execution time = 2.4181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.0000e+06
  Execution time = 2.7065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273546050
                                         uncertainty =       0.003943000836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273546050
                                         uncertainty =       0.003943000836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250724
  error estimate for blocks of size 2^( 2) =       0.000423135418
  error estimate for blocks of size 2^( 3) =       0.000435789116
  error estimate for blocks of size 2^( 4) =       0.000447858698
  error estimate for blocks of size 2^( 5) =       0.000458355662
  error estimate for blocks of size 2^( 6) =       0.000467835022
  error estimate for blocks of size 2^( 7) =       0.000472154334

      target function =                  N/A
              le_mean =     -16.909808512703
             les_mean =     286.279878082956
             stat err =       0.000461550929
             autocorr =       1.259580441106
              std dev =       0.581596351266
             le_variance =       0.338254315806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273545832
                                         uncertainty =       0.003943000834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273545832
                                         uncertainty =       0.003943000834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250724
  error estimate for blocks of size 2^( 2) =       0.000423135418
  error estimate for blocks of size 2^( 3) =       0.000435789116
  error estimate for blocks of size 2^( 4) =       0.000447858698
  error estimate for blocks of size 2^( 5) =       0.000458355662
  error estimate for blocks of size 2^( 6) =       0.000467835022
  error estimate for blocks of size 2^( 7) =       0.000472154334

      target function =                  N/A
              le_mean =     -16.909808512702
             les_mean =     286.279878082716
             stat err =       0.000461550929
             autocorr =       1.259580441284
              std dev =       0.581596351078
             le_variance =       0.338254315587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273545941
                                         uncertainty =       0.003943000835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273545941
                                         uncertainty =       0.003943000835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250724
  error estimate for blocks of size 2^( 2) =       0.000423135418
  error estimate for blocks of size 2^( 3) =       0.000435789116
  error estimate for blocks of size 2^( 4) =       0.000447858698
  error estimate for blocks of size 2^( 5) =       0.000458355662
  error estimate for blocks of size 2^( 6) =       0.000467835022
  error estimate for blocks of size 2^( 7) =       0.000472154334

      target function =                  N/A
              le_mean =     -16.909808512703
             les_mean =     286.279878082836
             stat err =       0.000461550929
             autocorr =       1.259580441199
              std dev =       0.581596351172
             le_variance =       0.338254315697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273546037
                                         uncertainty =       0.003943000836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273546037
                                         uncertainty =       0.003943000836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250724
  error estimate for blocks of size 2^( 2) =       0.000423135418
  error estimate for blocks of size 2^( 3) =       0.000435789116
  error estimate for blocks of size 2^( 4) =       0.000447858698
  error estimate for blocks of size 2^( 5) =       0.000458355662
  error estimate for blocks of size 2^( 6) =       0.000467835022
  error estimate for blocks of size 2^( 7) =       0.000472154334

      target function =                  N/A
              le_mean =     -16.909808512703
             les_mean =     286.279878082941
             stat err =       0.000461550929
             autocorr =       1.259580441114
              std dev =       0.581596351254
             le_variance =       0.338254315792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909808512703        initial  <--
     9.0949e+05     9.0949e+06             2.8273e-10       -16.909808512702
     3.6380e+06     3.6380e+07             7.0681e-11       -16.909808512703
     1.4552e+07     1.4552e+08             1.7670e-11       -16.909808512703

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8227
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.085824e-01 1 1  ON 0
 uu_1                 1.422474e-01 1 1  ON 1
 uu_2                 4.267389e-02 1 1  ON 2
 uu_3                -2.075331e-02 1 1  ON 3
 uu_4                -6.908286e-02 1 1  ON 4
 uu_5                -1.036373e-01 1 1  ON 5
 uu_6                -1.293033e-01 1 1  ON 6
 uu_7                -1.401224e-01 1 1  ON 7
 uu_8                -1.303597e-01 1 1  ON 8
 uu_9                -1.002196e-01 1 1  ON 9
 ud_0                 4.321204e-01 1 1  ON 10
 ud_1                 1.758308e-01 1 1  ON 11
 ud_2                 6.449071e-02 1 1  ON 12
 ud_3                -2.868395e-03 1 1  ON 13
 ud_4                -5.884645e-02 1 1  ON 14
 ud_5                -1.018528e-01 1 1  ON 15
 ud_6                -1.318430e-01 1 1  ON 16
 ud_7                -1.515537e-01 1 1  ON 17
 ud_8                -1.548359e-01 1 1  ON 18
 ud_9                -1.441984e-01 1 1  ON 19
 eO_0                -7.551565e-01 1 1  ON 20
 eO_1                -4.406112e-01 1 1  ON 21
 eO_2                -2.620711e-02 1 1  ON 22
 eO_3                 2.963188e-01 1 1  ON 23
 eO_4                 5.235617e-01 1 1  ON 24
 eO_5                 4.855459e-01 1 1  ON 25
 eO_6                 2.577048e-01 1 1  ON 26
 eO_7                -4.294623e-02 1 1  ON 27
 eO_8                -2.201876e-01 1 1  ON 28
 eO_9                -7.889719e-02 1 1  ON 29
eH1_0                -2.471407e-01 1 1  ON 30
eH1_1                -1.452786e-01 1 1  ON 31
eH1_2                -1.014765e-01 1 1  ON 32
eH1_3                -4.945091e-02 1 1  ON 33
eH1_4                 2.090504e-03 1 1  ON 34
eH1_5                 3.699465e-02 1 1  ON 35
eH1_6                 9.737243e-02 1 1  ON 36
eH1_7                 1.534854e-01 1 1  ON 37
eH1_8                 1.820516e-01 1 1  ON 38
eH1_9                 7.070235e-02 1 1  ON 39
eH2_0                -2.407627e-01 1 1  ON 40
eH2_1                -1.388004e-01 1 1  ON 41
eH2_2                -9.515704e-02 1 1  ON 42
eH2_3                -4.345228e-02 1 1  ON 43
eH2_4                 7.855128e-03 1 1  ON 44
eH2_5                 4.185514e-02 1 1  ON 45
eH2_6                 1.026545e-01 1 1  ON 46
eH2_7                 1.565299e-01 1 1  ON 47
eH2_8                 1.803130e-01 1 1  ON 48
eH2_9                 4.625706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8169e+01 secs
  Total Execution time = 2.7536e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
