Rank =    0  Free Memory = 86598 MB
Rank =    1  Free Memory = 86598 MB
Rank =    2  Free Memory = 86597 MB
Rank =    3  Free Memory = 86597 MB
Rank =    4  Free Memory = 86597 MB
Rank =    5  Free Memory = 86596 MB
Rank =    6  Free Memory = 86595 MB
Rank =    7  Free Memory = 86595 MB
Rank =    8  Free Memory = 86595 MB
Rank =    9  Free Memory = 86595 MB
Rank =   10  Free Memory = 86595 MB
Rank =   11  Free Memory = 86594 MB
Rank =   12  Free Memory = 86594 MB
Rank =   13  Free Memory = 86594 MB
Rank =   14  Free Memory = 86593 MB
Rank =   15  Free Memory = 86581 MB
Rank =   16  Free Memory = 86580 MB
Rank =   17  Free Memory = 86580 MB
Rank =   18  Free Memory = 86580 MB
Rank =   19  Free Memory = 86580 MB
Rank =   20  Free Memory = 86580 MB
Rank =   21  Free Memory = 86580 MB
Rank =   22  Free Memory = 86580 MB
Rank =   23  Free Memory = 86580 MB
Rank =   24  Free Memory = 86580 MB
Rank =   25  Free Memory = 86580 MB
Rank =   26  Free Memory = 86580 MB
Rank =   27  Free Memory = 86580 MB
Rank =   28  Free Memory = 86580 MB
Rank =   29  Free Memory = 86580 MB
Rank =   30  Free Memory = 86580 MB
Rank =   31  Free Memory = 86580 MB
Rank =   32  Free Memory = 72969 MB
Rank =   33  Free Memory = 72969 MB
Rank =   34  Free Memory = 72969 MB
Rank =   35  Free Memory = 72969 MB
Rank =   36  Free Memory = 72969 MB
Rank =   37  Free Memory = 72969 MB
Rank =   38  Free Memory = 72969 MB
Rank =   39  Free Memory = 72969 MB
Rank =   40  Free Memory = 72969 MB
Rank =   41  Free Memory = 72969 MB
Rank =   42  Free Memory = 72969 MB
Rank =   43  Free Memory = 72969 MB
Rank =   44  Free Memory = 72969 MB
Rank =   45  Free Memory = 72969 MB
Rank =   46  Free Memory = 72969 MB
Rank =   47  Free Memory = 72969 MB
Rank =   48  Free Memory = 72969 MB
Rank =   49  Free Memory = 72968 MB
Rank =   50  Free Memory = 72968 MB
Rank =   51  Free Memory = 72968 MB
Rank =   52  Free Memory = 72968 MB
Rank =   53  Free Memory = 72968 MB
Rank =   54  Free Memory = 72968 MB
Rank =   55  Free Memory = 72968 MB
Rank =   56  Free Memory = 72968 MB
Rank =   57  Free Memory = 72968 MB
Rank =   58  Free Memory = 72968 MB
Rank =   59  Free Memory = 72968 MB
Rank =   60  Free Memory = 72968 MB
Rank =   61  Free Memory = 72968 MB
Rank =   62  Free Memory = 72968 MB
Rank =   63  Free Memory = 72968 MB
Rank =   64  Free Memory = 87457 MB
Rank =   65  Free Memory = 87456 MB
Rank =   66  Free Memory = 87456 MB
Rank =   67  Free Memory = 87456 MB
Rank =   68  Free Memory = 87456 MB
Rank =   69  Free Memory = 87456 MB
Rank =   70  Free Memory = 87456 MB
Rank =   71  Free Memory = 87456 MB
Rank =   72  Free Memory = 87456 MB
Rank =   73  Free Memory = 87456 MB
Rank =   74  Free Memory = 87456 MB
Rank =   75  Free Memory = 87456 MB
Rank =   76  Free Memory = 87456 MB
Rank =   77  Free Memory = 87456 MB
Rank =   78  Free Memory = 87456 MB
Rank =   79  Free Memory = 87456 MB
Rank =   80  Free Memory = 87456 MB
Rank =   81  Free Memory = 87455 MB
Rank =   82  Free Memory = 87455 MB
Rank =   83  Free Memory = 87455 MB
Rank =   84  Free Memory = 87455 MB
Rank =   85  Free Memory = 87455 MB
Rank =   86  Free Memory = 87455 MB
Rank =   87  Free Memory = 87455 MB
Rank =   88  Free Memory = 87455 MB
Rank =   89  Free Memory = 87455 MB
Rank =   90  Free Memory = 87455 MB
Rank =   91  Free Memory = 87455 MB
Rank =   92  Free Memory = 87455 MB
Rank =   93  Free Memory = 87455 MB
Rank =   94  Free Memory = 87455 MB
Rank =   95  Free Memory = 87455 MB
Rank =   96  Free Memory = 76716 MB
Rank =   97  Free Memory = 76716 MB
Rank =   98  Free Memory = 76716 MB
Rank =   99  Free Memory = 76716 MB
Rank =  100  Free Memory = 76716 MB
Rank =  101  Free Memory = 76716 MB
Rank =  102  Free Memory = 76716 MB
Rank =  103  Free Memory = 76716 MB
Rank =  104  Free Memory = 76716 MB
Rank =  105  Free Memory = 76716 MB
Rank =  106  Free Memory = 76716 MB
Rank =  107  Free Memory = 76716 MB
Rank =  108  Free Memory = 76716 MB
Rank =  109  Free Memory = 76716 MB
Rank =  110  Free Memory = 76716 MB
Rank =  111  Free Memory = 76716 MB
Rank =  112  Free Memory = 76716 MB
Rank =  113  Free Memory = 76716 MB
Rank =  114  Free Memory = 76716 MB
Rank =  115  Free Memory = 76716 MB
Rank =  116  Free Memory = 76716 MB
Rank =  117  Free Memory = 76716 MB
Rank =  118  Free Memory = 76716 MB
Rank =  119  Free Memory = 76716 MB
Rank =  120  Free Memory = 76716 MB
Rank =  121  Free Memory = 76716 MB
Rank =  122  Free Memory = 76716 MB
Rank =  123  Free Memory = 76716 MB
Rank =  124  Free Memory = 76716 MB
Rank =  125  Free Memory = 76716 MB
Rank =  126  Free Memory = 76716 MB
Rank =  127  Free Memory = 76716 MB
  Input file(s): opt_h2o_1b1_gvptt_509dets_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_509dets_run001h.xml

  Project = H2O
  date    = 2023-05-15 14:14:11 PDT
  host    = n0086.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 163

  Range of prime numbers to use as seeds over processors and threads = 977-1913


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.103790e-01    1         1  ON     0
     uu_1                 1.452527e-01    1         1  ON     1
     uu_2                 4.714437e-02    1         1  ON     2
     uu_3                -1.665161e-02    1         1  ON     3
     uu_4                -6.730681e-02    1         1  ON     4
     uu_5                -1.046346e-01    1         1  ON     5
     uu_6                -1.336183e-01    1         1  ON     6
     uu_7                -1.483981e-01    1         1  ON     7
     uu_8                -1.420789e-01    1         1  ON     8
     uu_9                -1.136840e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.381310e-01    1         1  ON     0
     ud_1                 1.811497e-01    1         1  ON     1
     ud_2                 6.688545e-02    1         1  ON     2
     ud_3                -2.369286e-03    1         1  ON     3
     ud_4                -5.865174e-02    1         1  ON     4
     ud_5                -1.017969e-01    1         1  ON     5
     ud_6                -1.313468e-01    1         1  ON     6
     ud_7                -1.519660e-01    1         1  ON     7
     ud_8                -1.563799e-01    1         1  ON     8
     ud_9                -1.462335e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.499079e-01    1         1  ON     0
     eO_1                -4.329516e-01    1         1  ON     1
     eO_2                -1.089672e-02    1         1  ON     2
     eO_3                 3.130634e-01    1         1  ON     3
     eO_4                 5.356520e-01    1         1  ON     4
     eO_5                 4.901561e-01    1         1  ON     5
     eO_6                 2.521881e-01    1         1  ON     6
     eO_7                -5.286832e-02    1         1  ON     7
     eO_8                -2.396675e-01    1         1  ON     8
     eO_9                -1.015701e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.694189e-01    1         1  ON     0
     eH1_1                -1.627827e-01    1         1  ON     1
     eH1_2                -1.193841e-01    1         1  ON     2
     eH1_3                -6.625761e-02    1         1  ON     3
     eH1_4                -6.679753e-03    1         1  ON     4
     eH1_5                 3.776923e-02    1         1  ON     5
     eH1_6                 1.096079e-01    1         1  ON     6
     eH1_7                 1.752243e-01    1         1  ON     7
     eH1_8                 2.049504e-01    1         1  ON     8
     eH1_9                 9.470401e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.669707e-01    1         1  ON     0
     eH2_1                -1.607079e-01    1         1  ON     1
     eH2_2                -1.171339e-01    1         1  ON     2
     eH2_3                -6.377688e-02    1         1  ON     3
     eH2_4                -4.015082e-03    1         1  ON     4
     eH2_5                 3.958438e-02    1         1  ON     5
     eH2_6                 1.105059e-01    1         1  ON     6
     eH2_7                 1.732253e-01    1         1  ON     7
     eH2_8                 2.094903e-01    1         1  ON     8
     eH2_9                 9.005584e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 509 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 6.127074e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 94 unique up determinants.
Found 94 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0478e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9891
    reference variance = 0.151007
====================================================
  Execution time = 2.8619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332469215040
                                         uncertainty =       0.004305483192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332469215040
                                         uncertainty =       0.004305483192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407691147
  error estimate for blocks of size 2^( 2) =       0.000419548698
  error estimate for blocks of size 2^( 3) =       0.000431800040
  error estimate for blocks of size 2^( 4) =       0.000443898023
  error estimate for blocks of size 2^( 5) =       0.000453795132
  error estimate for blocks of size 2^( 6) =       0.000463486627
  error estimate for blocks of size 2^( 7) =       0.000464952998

      target function =                  N/A
              le_mean =     -16.910946601378
             les_mean =     286.312538931152
             stat err =       0.000456533195
             autocorr =       1.253955603755
              std dev =       0.576562349362
             le_variance =       0.332424142702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691094660138e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910946601378       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910951160164       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910951367635       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910950250318       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910952156893       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910951819569       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910953990151       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910954783434       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910953666434       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910953809998       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910953761534       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.775456e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910946601378       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910948282697       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910948109614       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910947971243       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910948555287       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910948477112       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910948887674       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910949194719       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910948957670       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.751565e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910946601378       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910947078380       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910947003607       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910946995809       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910947152710       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910947157615       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910947218502       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910947304123       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 7.567641e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5985e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.102618e-01                 1 1 ON  0
uu_1  1.453378e-01                 1 1 ON  1
uu_2  4.730561e-02                 1 1 ON  2
uu_3  -1.652465e-02                1 1 ON  3
uu_4  -6.717642e-02                1 1 ON  4
uu_5  -1.046632e-01                1 1 ON  5
uu_6  -1.336988e-01                1 1 ON  6
uu_7  -1.484572e-01                1 1 ON  7
uu_8  -1.421973e-01                1 1 ON  8
uu_9  -1.138513e-01                1 1 ON  9
ud_0  4.382886e-01                 1 1 ON  10
ud_1  1.813113e-01                 1 1 ON  11
ud_2  6.697931e-02                 1 1 ON  12
ud_3  -2.455687e-03                1 1 ON  13
ud_4  -5.870307e-02                1 1 ON  14
ud_5  -1.016781e-01                1 1 ON  15
ud_6  -1.313811e-01                1 1 ON  16
ud_7  -1.519982e-01                1 1 ON  17
ud_8  -1.564808e-01                1 1 ON  18
ud_9  -1.463316e-01                1 1 ON  19
eO_0  -7.496328e-01                1 1 ON  20
eO_1  -4.328015e-01                1 1 ON  21
eO_2  -1.102083e-02                1 1 ON  22
eO_3  3.129685e-01                 1 1 ON  23
eO_4  5.356791e-01                 1 1 ON  24
eO_5  4.902664e-01                 1 1 ON  25
eO_6  2.522777e-01                 1 1 ON  26
eO_7  -5.297252e-02                1 1 ON  27
eO_8  -2.398476e-01                1 1 ON  28
eO_9  -1.016954e-01                1 1 ON  29
eH1_0 -2.694830e-01                1 1 ON  30
eH1_1 -1.628146e-01                1 1 ON  31
eH1_2 -1.193902e-01                1 1 ON  32
eH1_3 -6.628198e-02                1 1 ON  33
eH1_4 -6.751016e-03                1 1 ON  34
eH1_5 3.768388e-02                 1 1 ON  35
eH1_6 1.094882e-01                 1 1 ON  36
eH1_7 1.752580e-01                 1 1 ON  37
eH1_8 2.050872e-01                 1 1 ON  38
eH1_9 9.488639e-02                 1 1 ON  39
eH2_0 -2.671368e-01                1 1 ON  40
eH2_1 -1.607909e-01                1 1 ON  41
eH2_2 -1.170934e-01                1 1 ON  42
eH2_3 -6.388891e-02                1 1 ON  43
eH2_4 -3.965138e-03                1 1 ON  44
eH2_5 3.959325e-02                 1 1 ON  45
eH2_6 1.103919e-01                 1 1 ON  46
eH2_7 1.732876e-01                 1 1 ON  47
eH2_8 2.096140e-01                 1 1 ON  48
eH2_9 9.023029e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.394246
====================================================
  Execution time = 2.7820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3324e-01
  Total weights = 2.0000e+06
  Execution time = 3.4818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333441203838
                                         uncertainty =       0.003292999695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333441203838
                                         uncertainty =       0.003292999695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408234242
  error estimate for blocks of size 2^( 2) =       0.000419849732
  error estimate for blocks of size 2^( 3) =       0.000431433197
  error estimate for blocks of size 2^( 4) =       0.000443034944
  error estimate for blocks of size 2^( 5) =       0.000453097680
  error estimate for blocks of size 2^( 6) =       0.000460236219
  error estimate for blocks of size 2^( 7) =       0.000467094542

      target function =                  N/A
              le_mean =     -16.910249247994
             les_mean =     286.289839854722
             stat err =       0.000455865846
             autocorr =       1.246967839063
              std dev =       0.577330401147
             le_variance =       0.333310392089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333321034187
                                         uncertainty =       0.003292891662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333321034187
                                         uncertainty =       0.003292891662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408160742
  error estimate for blocks of size 2^( 2) =       0.000419758036
  error estimate for blocks of size 2^( 3) =       0.000431323668
  error estimate for blocks of size 2^( 4) =       0.000442911602
  error estimate for blocks of size 2^( 5) =       0.000452968822
  error estimate for blocks of size 2^( 6) =       0.000460108950
  error estimate for blocks of size 2^( 7) =       0.000466972427

      target function =                  N/A
              le_mean =     -16.910250863338
             les_mean =     286.289774477368
             stat err =       0.000455740450
             autocorr =       1.246730810138
              std dev =       0.577226457234
             le_variance =       0.333190382931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333313693227
                                         uncertainty =       0.003292814322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333313693227
                                         uncertainty =       0.003292814322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408156231
  error estimate for blocks of size 2^( 2) =       0.000419759826
  error estimate for blocks of size 2^( 3) =       0.000431331455
  error estimate for blocks of size 2^( 4) =       0.000442923521
  error estimate for blocks of size 2^( 5) =       0.000452982139
  error estimate for blocks of size 2^( 6) =       0.000460122249
  error estimate for blocks of size 2^( 7) =       0.000466984676

      target function =                  N/A
              le_mean =     -16.910249119096
             les_mean =     286.289708121122
             stat err =       0.000455753146
             autocorr =       1.246827835563
              std dev =       0.577220077453
             le_variance =       0.333183017814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333419821077
                                         uncertainty =       0.003292946891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333419821077
                                         uncertainty =       0.003292946891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408221160
  error estimate for blocks of size 2^( 2) =       0.000419834948
  error estimate for blocks of size 2^( 3) =       0.000431416626
  error estimate for blocks of size 2^( 4) =       0.000443016916
  error estimate for blocks of size 2^( 5) =       0.000453079043
  error estimate for blocks of size 2^( 6) =       0.000460217793
  error estimate for blocks of size 2^( 7) =       0.000467076715

      target function =                  N/A
              le_mean =     -16.910248840603
             les_mean =     286.289804715782
             stat err =       0.000455847617
             autocorr =       1.246948025828
              std dev =       0.577311901225
             le_variance =       0.333289031297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910249247994        initial
     2.5000e-01     2.5000e+00             8.7755e-04       -16.910250863338  <--
     1.0000e+00     1.0000e+01             2.7516e-04       -16.910249119096
     4.0000e+00     4.0000e+01             7.5676e-05       -16.910248840603

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.8114e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.101756e-01 1 1  ON 0
 uu_1                 1.455305e-01 1 1  ON 1
 uu_2                 4.759850e-02 1 1  ON 2
 uu_3                -1.620589e-02 1 1  ON 3
 uu_4                -6.692758e-02 1 1  ON 4
 uu_5                -1.046818e-01 1 1  ON 5
 uu_6                -1.338842e-01 1 1  ON 6
 uu_7                -1.486213e-01 1 1  ON 7
 uu_8                -1.425086e-01 1 1  ON 8
 uu_9                -1.143355e-01 1 1  ON 9
 ud_0                 4.386350e-01 1 1  ON 10
 ud_1                 1.815940e-01 1 1  ON 11
 ud_2                 6.717903e-02 1 1  ON 12
 ud_3                -2.475955e-03 1 1  ON 13
 ud_4                -5.873595e-02 1 1  ON 14
 ud_5                -1.014911e-01 1 1  ON 15
 ud_6                -1.314126e-01 1 1  ON 16
 ud_7                -1.520415e-01 1 1  ON 17
 ud_8                -1.567063e-01 1 1  ON 18
 ud_9                -1.466047e-01 1 1  ON 19
 eO_0                -7.490304e-01 1 1  ON 20
 eO_1                -4.323612e-01 1 1  ON 21
 eO_2                -1.109824e-02 1 1  ON 22
 eO_3                 3.126632e-01 1 1  ON 23
 eO_4                 5.357049e-01 1 1  ON 24
 eO_5                 4.905746e-01 1 1  ON 25
 eO_6                 2.525413e-01 1 1  ON 26
 eO_7                -5.325696e-02 1 1  ON 27
 eO_8                -2.403740e-01 1 1  ON 28
 eO_9                -1.020709e-01 1 1  ON 29
eH1_0                -2.696925e-01 1 1  ON 30
eH1_1                -1.629142e-01 1 1  ON 31
eH1_2                -1.194576e-01 1 1  ON 32
eH1_3                -6.634807e-02 1 1  ON 33
eH1_4                -6.922091e-03 1 1  ON 34
eH1_5                 3.743606e-02 1 1  ON 35
eH1_6                 1.091464e-01 1 1  ON 36
eH1_7                 1.753470e-01 1 1  ON 37
eH1_8                 2.054998e-01 1 1  ON 38
eH1_9                 9.543762e-02 1 1  ON 39
eH2_0                -2.675924e-01 1 1  ON 40
eH2_1                -1.609925e-01 1 1  ON 41
eH2_2                -1.171144e-01 1 1  ON 42
eH2_3                -6.406574e-02 1 1  ON 43
eH2_4                -3.929481e-03 1 1  ON 44
eH2_5                 3.960088e-02 1 1  ON 45
eH2_6                 1.100838e-01 1 1  ON 46
eH2_7                 1.734626e-01 1 1  ON 47
eH2_8                 2.099856e-01 1 1  ON 48
eH2_9                 9.075689e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6965e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9108
    reference variance = 0.181105
====================================================
  Execution time = 2.8252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4504e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345171989042
                                         uncertainty =       0.005956420464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345171989042
                                         uncertainty =       0.005956420464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415354663
  error estimate for blocks of size 2^( 2) =       0.000426741500
  error estimate for blocks of size 2^( 3) =       0.000438473537
  error estimate for blocks of size 2^( 4) =       0.000450386604
  error estimate for blocks of size 2^( 5) =       0.000460654447
  error estimate for blocks of size 2^( 6) =       0.000470298319
  error estimate for blocks of size 2^( 7) =       0.000477848596

      target function =                  N/A
              le_mean =     -16.910317731316
             les_mean =     286.303884593616
             stat err =       0.000464796991
             autocorr =       1.252242489740
              std dev =       0.587400197556
             le_variance =       0.345038992089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031773132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317731316       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910327354218       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910330180796       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910329744517       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910328835298       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910330917772       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910333000466       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910330679233       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910331819071       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910332045001       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910333294837       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910333555489       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910333406466       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.211116e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317731316       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910323008854       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910324312939       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910324081692       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910323030982       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910323513963       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910324459203       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910324084264       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910324228236       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910324306772       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.883477e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317731316       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910319611944       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910320087253       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910320141072       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910319523272       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910319692389       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910319897175       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910319889749       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.248027e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5488e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.104510e-01 1 1  ON 0
 uu_1                 1.457294e-01 1 1  ON 1
 uu_2                 4.775981e-02 1 1  ON 2
 uu_3                -1.596817e-02 1 1  ON 3
 uu_4                -6.688301e-02 1 1  ON 4
 uu_5                -1.048598e-01 1 1  ON 5
 uu_6                -1.343147e-01 1 1  ON 6
 uu_7                -1.490961e-01 1 1  ON 7
 uu_8                -1.426950e-01 1 1  ON 8
 uu_9                -1.145290e-01 1 1  ON 9
 ud_0                 4.388811e-01 1 1  ON 10
 ud_1                 1.817328e-01 1 1  ON 11
 ud_2                 6.735013e-02 1 1  ON 12
 ud_3                -2.528777e-03 1 1  ON 13
 ud_4                -5.895354e-02 1 1  ON 14
 ud_5                -1.013618e-01 1 1  ON 15
 ud_6                -1.314276e-01 1 1  ON 16
 ud_7                -1.520098e-01 1 1  ON 17
 ud_8                -1.567810e-01 1 1  ON 18
 ud_9                -1.468682e-01 1 1  ON 19
 eO_0                -7.485631e-01 1 1  ON 20
 eO_1                -4.316316e-01 1 1  ON 21
 eO_2                -1.079465e-02 1 1  ON 22
 eO_3                 3.124735e-01 1 1  ON 23
 eO_4                 5.353964e-01 1 1  ON 24
 eO_5                 4.908683e-01 1 1  ON 25
 eO_6                 2.525480e-01 1 1  ON 26
 eO_7                -5.349286e-02 1 1  ON 27
 eO_8                -2.408436e-01 1 1  ON 28
 eO_9                -1.025728e-01 1 1  ON 29
eH1_0                -2.702253e-01 1 1  ON 30
eH1_1                -1.634082e-01 1 1  ON 31
eH1_2                -1.196749e-01 1 1  ON 32
eH1_3                -6.651625e-02 1 1  ON 33
eH1_4                -7.007266e-03 1 1  ON 34
eH1_5                 3.730589e-02 1 1  ON 35
eH1_6                 1.092878e-01 1 1  ON 36
eH1_7                 1.756718e-01 1 1  ON 37
eH1_8                 2.058499e-01 1 1  ON 38
eH1_9                 9.614568e-02 1 1  ON 39
eH2_0                -2.677490e-01 1 1  ON 40
eH2_1                -1.611754e-01 1 1  ON 41
eH2_2                -1.174539e-01 1 1  ON 42
eH2_3                -6.421598e-02 1 1  ON 43
eH2_4                -4.334998e-03 1 1  ON 44
eH2_5                 3.959193e-02 1 1  ON 45
eH2_6                 1.098304e-01 1 1  ON 46
eH2_7                 1.736531e-01 1 1  ON 47
eH2_8                 2.103081e-01 1 1  ON 48
eH2_9                 9.154524e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.155099
====================================================
  Execution time = 2.7507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.0000e+06
  Execution time = 3.4839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340650146132
                                         uncertainty =       0.004777895483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340650146132
                                         uncertainty =       0.004777895483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412695376
  error estimate for blocks of size 2^( 2) =       0.000424272923
  error estimate for blocks of size 2^( 3) =       0.000436435028
  error estimate for blocks of size 2^( 4) =       0.000448377994
  error estimate for blocks of size 2^( 5) =       0.000459019541
  error estimate for blocks of size 2^( 6) =       0.000465537964
  error estimate for blocks of size 2^( 7) =       0.000468744601

      target function =                  N/A
              le_mean =     -16.911628794011
             les_mean =     286.343823242624
             stat err =       0.000460420025
             autocorr =       1.244655615725
              std dev =       0.583639397682
             le_variance =       0.340634946527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340836458292
                                         uncertainty =       0.004781847751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340836458292
                                         uncertainty =       0.004781847751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412808050
  error estimate for blocks of size 2^( 2) =       0.000424363160
  error estimate for blocks of size 2^( 3) =       0.000436499238
  error estimate for blocks of size 2^( 4) =       0.000448435255
  error estimate for blocks of size 2^( 5) =       0.000459078241
  error estimate for blocks of size 2^( 6) =       0.000465578940
  error estimate for blocks of size 2^( 7) =       0.000468753877

      target function =                  N/A
              le_mean =     -16.911635488908
             les_mean =     286.344235711481
             stat err =       0.000460461578
             autocorr =       1.244200811748
              std dev =       0.583798742877
             le_variance =       0.340820972185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340894612874
                                         uncertainty =       0.004782090498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340894612874
                                         uncertainty =       0.004782090498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412843227
  error estimate for blocks of size 2^( 2) =       0.000424400071
  error estimate for blocks of size 2^( 3) =       0.000436536158
  error estimate for blocks of size 2^( 4) =       0.000448474228
  error estimate for blocks of size 2^( 5) =       0.000459117793
  error estimate for blocks of size 2^( 6) =       0.000465620448
  error estimate for blocks of size 2^( 7) =       0.000468791773

      target function =                  N/A
              le_mean =     -16.911638415633
             les_mean =     286.344392791474
             stat err =       0.000460501061
             autocorr =       1.244202129989
              std dev =       0.583848491311
             le_variance =       0.340879060806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340705340607
                                         uncertainty =       0.004778975906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340705340607
                                         uncertainty =       0.004778975906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412728763
  error estimate for blocks of size 2^( 2) =       0.000424302344
  error estimate for blocks of size 2^( 3) =       0.000436459437
  error estimate for blocks of size 2^( 4) =       0.000448401345
  error estimate for blocks of size 2^( 5) =       0.000459042910
  error estimate for blocks of size 2^( 6) =       0.000465557930
  error estimate for blocks of size 2^( 7) =       0.000468757207

      target function =                  N/A
              le_mean =     -16.911629800188
             les_mean =     286.343912391543
             stat err =       0.000460439848
             autocorr =       1.244561413940
              std dev =       0.583686613918
             le_variance =       0.340690063267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911628794011        initial
     6.2500e-02     6.2500e-01             3.2111e-03       -16.911635488908
     2.5000e-01     2.5000e+00             7.8835e-04       -16.911638415633  <--
     1.0000e+00     1.0000e+01             2.2480e-04       -16.911629800188

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.4974e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.104510e-01 1 1  ON 0
 uu_1                 1.457294e-01 1 1  ON 1
 uu_2                 4.775981e-02 1 1  ON 2
 uu_3                -1.596817e-02 1 1  ON 3
 uu_4                -6.688301e-02 1 1  ON 4
 uu_5                -1.048598e-01 1 1  ON 5
 uu_6                -1.343147e-01 1 1  ON 6
 uu_7                -1.490961e-01 1 1  ON 7
 uu_8                -1.426950e-01 1 1  ON 8
 uu_9                -1.145290e-01 1 1  ON 9
 ud_0                 4.388811e-01 1 1  ON 10
 ud_1                 1.817328e-01 1 1  ON 11
 ud_2                 6.735013e-02 1 1  ON 12
 ud_3                -2.528777e-03 1 1  ON 13
 ud_4                -5.895354e-02 1 1  ON 14
 ud_5                -1.013618e-01 1 1  ON 15
 ud_6                -1.314276e-01 1 1  ON 16
 ud_7                -1.520098e-01 1 1  ON 17
 ud_8                -1.567810e-01 1 1  ON 18
 ud_9                -1.468682e-01 1 1  ON 19
 eO_0                -7.485631e-01 1 1  ON 20
 eO_1                -4.316316e-01 1 1  ON 21
 eO_2                -1.079465e-02 1 1  ON 22
 eO_3                 3.124735e-01 1 1  ON 23
 eO_4                 5.353964e-01 1 1  ON 24
 eO_5                 4.908683e-01 1 1  ON 25
 eO_6                 2.525480e-01 1 1  ON 26
 eO_7                -5.349286e-02 1 1  ON 27
 eO_8                -2.408436e-01 1 1  ON 28
 eO_9                -1.025728e-01 1 1  ON 29
eH1_0                -2.702253e-01 1 1  ON 30
eH1_1                -1.634082e-01 1 1  ON 31
eH1_2                -1.196749e-01 1 1  ON 32
eH1_3                -6.651625e-02 1 1  ON 33
eH1_4                -7.007266e-03 1 1  ON 34
eH1_5                 3.730589e-02 1 1  ON 35
eH1_6                 1.092878e-01 1 1  ON 36
eH1_7                 1.756718e-01 1 1  ON 37
eH1_8                 2.058499e-01 1 1  ON 38
eH1_9                 9.614568e-02 1 1  ON 39
eH2_0                -2.677490e-01 1 1  ON 40
eH2_1                -1.611754e-01 1 1  ON 41
eH2_2                -1.174539e-01 1 1  ON 42
eH2_3                -6.421598e-02 1 1  ON 43
eH2_4                -4.334998e-03 1 1  ON 44
eH2_5                 3.959193e-02 1 1  ON 45
eH2_6                 1.098304e-01 1 1  ON 46
eH2_7                 1.736531e-01 1 1  ON 47
eH2_8                 2.103081e-01 1 1  ON 48
eH2_9                 9.154524e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6939e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.934
    reference variance = 0.192937
====================================================
  Execution time = 2.8374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3025e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330169940499
                                         uncertainty =       0.003270639756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330169940499
                                         uncertainty =       0.003270639756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406354730
  error estimate for blocks of size 2^( 2) =       0.000418299887
  error estimate for blocks of size 2^( 3) =       0.000430834604
  error estimate for blocks of size 2^( 4) =       0.000442926706
  error estimate for blocks of size 2^( 5) =       0.000453050328
  error estimate for blocks of size 2^( 6) =       0.000460854929
  error estimate for blocks of size 2^( 7) =       0.000467077598

      target function =                  N/A
              le_mean =     -16.910628310923
             les_mean =     286.299598038189
             stat err =       0.000455977390
             autocorr =       1.259145677859
              std dev =       0.574672370235
             le_variance =       0.330248333111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691062831092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910628310923       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910626612779       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910629751697       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910631055957       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910630709197       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910631670530       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910631849109       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910632499371       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910633508297       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910633912407       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910633550692       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910633839615       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910633967703       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.719097e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910628310923       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910627352043       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910629047701       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910629671762       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910629959674       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910630184642       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910629898683       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910629854648       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910630208137       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910630172765       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.870686e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910628310923       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910627961139       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910628569777       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910628782693       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910629053839       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910628994633       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910628910614       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910628897028       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.693087e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5493e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.106455e-01 1 1  ON 0
 uu_1                 1.458059e-01 1 1  ON 1
 uu_2                 4.791261e-02 1 1  ON 2
 uu_3                -1.586722e-02 1 1  ON 3
 uu_4                -6.690607e-02 1 1  ON 4
 uu_5                -1.048545e-01 1 1  ON 5
 uu_6                -1.341806e-01 1 1  ON 6
 uu_7                -1.494732e-01 1 1  ON 7
 uu_8                -1.430817e-01 1 1  ON 8
 uu_9                -1.148501e-01 1 1  ON 9
 ud_0                 4.389243e-01 1 1  ON 10
 ud_1                 1.819976e-01 1 1  ON 11
 ud_2                 6.750127e-02 1 1  ON 12
 ud_3                -2.359128e-03 1 1  ON 13
 ud_4                -5.870814e-02 1 1  ON 14
 ud_5                -1.014857e-01 1 1  ON 15
 ud_6                -1.314564e-01 1 1  ON 16
 ud_7                -1.521288e-01 1 1  ON 17
 ud_8                -1.566526e-01 1 1  ON 18
 ud_9                -1.469626e-01 1 1  ON 19
 eO_0                -7.480626e-01 1 1  ON 20
 eO_1                -4.312365e-01 1 1  ON 21
 eO_2                -1.069387e-02 1 1  ON 22
 eO_3                 3.123822e-01 1 1  ON 23
 eO_4                 5.354492e-01 1 1  ON 24
 eO_5                 4.913119e-01 1 1  ON 25
 eO_6                 2.526547e-01 1 1  ON 26
 eO_7                -5.392959e-02 1 1  ON 27
 eO_8                -2.413243e-01 1 1  ON 28
 eO_9                -1.030562e-01 1 1  ON 29
eH1_0                -2.706166e-01 1 1  ON 30
eH1_1                -1.636956e-01 1 1  ON 31
eH1_2                -1.198966e-01 1 1  ON 32
eH1_3                -6.673338e-02 1 1  ON 33
eH1_4                -7.019627e-03 1 1  ON 34
eH1_5                 3.724919e-02 1 1  ON 35
eH1_6                 1.090490e-01 1 1  ON 36
eH1_7                 1.756848e-01 1 1  ON 37
eH1_8                 2.064503e-01 1 1  ON 38
eH1_9                 9.683274e-02 1 1  ON 39
eH2_0                -2.681204e-01 1 1  ON 40
eH2_1                -1.616727e-01 1 1  ON 41
eH2_2                -1.177640e-01 1 1  ON 42
eH2_3                -6.452325e-02 1 1  ON 43
eH2_4                -4.638263e-03 1 1  ON 44
eH2_5                 3.944638e-02 1 1  ON 45
eH2_6                 1.101349e-01 1 1  ON 46
eH2_7                 1.741932e-01 1 1  ON 47
eH2_8                 2.106004e-01 1 1  ON 48
eH2_9                 9.217861e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.133385
====================================================
  Execution time = 2.7679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4138e-01
  Total weights = 2.0000e+06
  Execution time = 3.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590707598
                                         uncertainty =       0.006668296424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590707598
                                         uncertainty =       0.006668296424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413218727
  error estimate for blocks of size 2^( 2) =       0.000424795530
  error estimate for blocks of size 2^( 3) =       0.000437476759
  error estimate for blocks of size 2^( 4) =       0.000449091424
  error estimate for blocks of size 2^( 5) =       0.000460339443
  error estimate for blocks of size 2^( 6) =       0.000468631694
  error estimate for blocks of size 2^( 7) =       0.000475501251

      target function =                  N/A
              le_mean =     -16.910720095330
             les_mean =     286.313953403724
             stat err =       0.000463390953
             autocorr =       1.257578522123
              std dev =       0.584379527250
             le_variance =       0.341499431868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457271934
                                         uncertainty =       0.006668785149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457271934
                                         uncertainty =       0.006668785149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413138012
  error estimate for blocks of size 2^( 2) =       0.000424710720
  error estimate for blocks of size 2^( 3) =       0.000437383767
  error estimate for blocks of size 2^( 4) =       0.000448992533
  error estimate for blocks of size 2^( 5) =       0.000460239148
  error estimate for blocks of size 2^( 6) =       0.000468539226
  error estimate for blocks of size 2^( 7) =       0.000475419559

      target function =                  N/A
              le_mean =     -16.910720254113
             les_mean =     286.313825376532
             stat err =       0.000463297617
             autocorr =       1.257563202719
              std dev =       0.584265380073
             le_variance =       0.341366034352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341348786536
                                         uncertainty =       0.006667680922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341348786536
                                         uncertainty =       0.006667680922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413072362
  error estimate for blocks of size 2^( 2) =       0.000424649119
  error estimate for blocks of size 2^( 3) =       0.000437326014
  error estimate for blocks of size 2^( 4) =       0.000448939475
  error estimate for blocks of size 2^( 5) =       0.000460189803
  error estimate for blocks of size 2^( 6) =       0.000468486656
  error estimate for blocks of size 2^( 7) =       0.000475365385

      target function =                  N/A
              le_mean =     -16.910720301481
             les_mean =     286.313718496934
             stat err =       0.000463245330
             autocorr =       1.257679039777
              std dev =       0.584172536717
             le_variance =       0.341257552654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341525337164
                                         uncertainty =       0.006667962553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341525337164
                                         uncertainty =       0.006667962553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413179179
  error estimate for blocks of size 2^( 2) =       0.000424756522
  error estimate for blocks of size 2^( 3) =       0.000437437256
  error estimate for blocks of size 2^( 4) =       0.000449052292
  error estimate for blocks of size 2^( 5) =       0.000460301288
  error estimate for blocks of size 2^( 6) =       0.000468593787
  error estimate for blocks of size 2^( 7) =       0.000475464381

      target function =                  N/A
              le_mean =     -16.910719848886
             les_mean =     286.313879704871
             stat err =       0.000463352937
             autocorr =       1.257612900000
              std dev =       0.584323598780
             le_variance =       0.341434068091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910720095330        initial
     6.2500e-02     6.2500e-01             2.7191e-03       -16.910720254113
     2.5000e-01     2.5000e+00             6.8707e-04       -16.910720301481  <--
     1.0000e+00     1.0000e+01             1.6931e-04       -16.910719848886

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5086e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.106455e-01 1 1  ON 0
 uu_1                 1.458059e-01 1 1  ON 1
 uu_2                 4.791261e-02 1 1  ON 2
 uu_3                -1.586722e-02 1 1  ON 3
 uu_4                -6.690607e-02 1 1  ON 4
 uu_5                -1.048545e-01 1 1  ON 5
 uu_6                -1.341806e-01 1 1  ON 6
 uu_7                -1.494732e-01 1 1  ON 7
 uu_8                -1.430817e-01 1 1  ON 8
 uu_9                -1.148501e-01 1 1  ON 9
 ud_0                 4.389243e-01 1 1  ON 10
 ud_1                 1.819976e-01 1 1  ON 11
 ud_2                 6.750127e-02 1 1  ON 12
 ud_3                -2.359128e-03 1 1  ON 13
 ud_4                -5.870814e-02 1 1  ON 14
 ud_5                -1.014857e-01 1 1  ON 15
 ud_6                -1.314564e-01 1 1  ON 16
 ud_7                -1.521288e-01 1 1  ON 17
 ud_8                -1.566526e-01 1 1  ON 18
 ud_9                -1.469626e-01 1 1  ON 19
 eO_0                -7.480626e-01 1 1  ON 20
 eO_1                -4.312365e-01 1 1  ON 21
 eO_2                -1.069387e-02 1 1  ON 22
 eO_3                 3.123822e-01 1 1  ON 23
 eO_4                 5.354492e-01 1 1  ON 24
 eO_5                 4.913119e-01 1 1  ON 25
 eO_6                 2.526547e-01 1 1  ON 26
 eO_7                -5.392959e-02 1 1  ON 27
 eO_8                -2.413243e-01 1 1  ON 28
 eO_9                -1.030562e-01 1 1  ON 29
eH1_0                -2.706166e-01 1 1  ON 30
eH1_1                -1.636956e-01 1 1  ON 31
eH1_2                -1.198966e-01 1 1  ON 32
eH1_3                -6.673338e-02 1 1  ON 33
eH1_4                -7.019627e-03 1 1  ON 34
eH1_5                 3.724919e-02 1 1  ON 35
eH1_6                 1.090490e-01 1 1  ON 36
eH1_7                 1.756848e-01 1 1  ON 37
eH1_8                 2.064503e-01 1 1  ON 38
eH1_9                 9.683274e-02 1 1  ON 39
eH2_0                -2.681204e-01 1 1  ON 40
eH2_1                -1.616727e-01 1 1  ON 41
eH2_2                -1.177640e-01 1 1  ON 42
eH2_3                -6.452325e-02 1 1  ON 43
eH2_4                -4.638263e-03 1 1  ON 44
eH2_5                 3.944638e-02 1 1  ON 45
eH2_6                 1.101349e-01 1 1  ON 46
eH2_7                 1.741932e-01 1 1  ON 47
eH2_8                 2.106004e-01 1 1  ON 48
eH2_9                 9.217861e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8211
    reference variance = 0.261614
====================================================
  Execution time = 2.7906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712700132
                                         uncertainty =       0.003235963998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712700132
                                         uncertainty =       0.003235963998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331372
  error estimate for blocks of size 2^( 2) =       0.000421993005
  error estimate for blocks of size 2^( 3) =       0.000434139522
  error estimate for blocks of size 2^( 4) =       0.000446107201
  error estimate for blocks of size 2^( 5) =       0.000456786725
  error estimate for blocks of size 2^( 6) =       0.000464849739
  error estimate for blocks of size 2^( 7) =       0.000471529042

      target function =                  N/A
              le_mean =     -16.910882803512
             les_mean =     286.314700695963
             stat err =       0.000459818177
             autocorr =       1.255748952490
              std dev =       0.580296191796
             le_variance =       0.336743670213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691088280351e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910882803512       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910886103764       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910885090860       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910885873089       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910887045066       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910886305723       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910889502920       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910891400216       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910890657951       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910890867322       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910891310557       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910891493930       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910891509345       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.686367e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910882803512       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910884460511       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910883875891       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910884356579       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910884632850       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910884965880       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910885483449       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910885735829       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910885642959       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910885644999       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.759610e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910882803512       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910883357383       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910883148650       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910883354532       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910883417270       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910883597199       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910883643207       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910883672203       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.719970e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5093e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.104134e-01 1 1  ON 0
 uu_1                 1.458278e-01 1 1  ON 1
 uu_2                 4.803274e-02 1 1  ON 2
 uu_3                -1.567743e-02 1 1  ON 3
 uu_4                -6.663439e-02 1 1  ON 4
 uu_5                -1.048958e-01 1 1  ON 5
 uu_6                -1.341002e-01 1 1  ON 6
 uu_7                -1.493591e-01 1 1  ON 7
 uu_8                -1.431466e-01 1 1  ON 8
 uu_9                -1.154461e-01 1 1  ON 9
 ud_0                 4.390976e-01 1 1  ON 10
 ud_1                 1.820414e-01 1 1  ON 11
 ud_2                 6.771880e-02 1 1  ON 12
 ud_3                -2.222410e-03 1 1  ON 13
 ud_4                -5.866285e-02 1 1  ON 14
 ud_5                -1.016384e-01 1 1  ON 15
 ud_6                -1.315193e-01 1 1  ON 16
 ud_7                -1.521219e-01 1 1  ON 17
 ud_8                -1.563401e-01 1 1  ON 18
 ud_9                -1.473128e-01 1 1  ON 19
 eO_0                -7.475099e-01 1 1  ON 20
 eO_1                -4.307324e-01 1 1  ON 21
 eO_2                -1.062000e-02 1 1  ON 22
 eO_3                 3.124493e-01 1 1  ON 23
 eO_4                 5.353407e-01 1 1  ON 24
 eO_5                 4.912807e-01 1 1  ON 25
 eO_6                 2.529477e-01 1 1  ON 26
 eO_7                -5.408286e-02 1 1  ON 27
 eO_8                -2.418177e-01 1 1  ON 28
 eO_9                -1.036578e-01 1 1  ON 29
eH1_0                -2.712574e-01 1 1  ON 30
eH1_1                -1.641906e-01 1 1  ON 31
eH1_2                -1.200885e-01 1 1  ON 32
eH1_3                -6.686237e-02 1 1  ON 33
eH1_4                -7.031934e-03 1 1  ON 34
eH1_5                 3.751538e-02 1 1  ON 35
eH1_6                 1.092282e-01 1 1  ON 36
eH1_7                 1.756560e-01 1 1  ON 37
eH1_8                 2.067931e-01 1 1  ON 38
eH1_9                 9.750871e-02 1 1  ON 39
eH2_0                -2.685470e-01 1 1  ON 40
eH2_1                -1.619651e-01 1 1  ON 41
eH2_2                -1.178127e-01 1 1  ON 42
eH2_3                -6.473073e-02 1 1  ON 43
eH2_4                -5.068006e-03 1 1  ON 44
eH2_5                 3.947130e-02 1 1  ON 45
eH2_6                 1.100728e-01 1 1  ON 46
eH2_7                 1.744517e-01 1 1  ON 47
eH2_8                 2.110309e-01 1 1  ON 48
eH2_9                 9.278486e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.0341
    reference variance = 3.17699
====================================================
  Execution time = 2.7635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4508e-01
  Total weights = 2.0000e+06
  Execution time = 3.4654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345180072369
                                         uncertainty =       0.017848008249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345180072369
                                         uncertainty =       0.017848008249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415496460
  error estimate for blocks of size 2^( 2) =       0.000426956984
  error estimate for blocks of size 2^( 3) =       0.000439330983
  error estimate for blocks of size 2^( 4) =       0.000451101118
  error estimate for blocks of size 2^( 5) =       0.000461888439
  error estimate for blocks of size 2^( 6) =       0.000468762722
  error estimate for blocks of size 2^( 7) =       0.000474258747

      target function =                  N/A
              le_mean =     -16.910445859146
             les_mean =     286.308453599335
             stat err =       0.000464002757
             autocorr =       1.247114891136
              std dev =       0.587600729118
             le_variance =       0.345274616860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344799072826
                                         uncertainty =       0.017776076444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344799072826
                                         uncertainty =       0.017776076444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415267482
  error estimate for blocks of size 2^( 2) =       0.000426732561
  error estimate for blocks of size 2^( 3) =       0.000439115474
  error estimate for blocks of size 2^( 4) =       0.000450889495
  error estimate for blocks of size 2^( 5) =       0.000461683522
  error estimate for blocks of size 2^( 6) =       0.000468573921
  error estimate for blocks of size 2^( 7) =       0.000474091850

      target function =                  N/A
              le_mean =     -16.910443897844
             les_mean =     286.308006812352
             stat err =       0.000463809697
             autocorr =       1.247451875117
              std dev =       0.587276904604
             le_variance =       0.344894162681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344788213664
                                         uncertainty =       0.017767088820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344788213664
                                         uncertainty =       0.017767088820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415261028
  error estimate for blocks of size 2^( 2) =       0.000426730050
  error estimate for blocks of size 2^( 3) =       0.000439118032
  error estimate for blocks of size 2^( 4) =       0.000450894873
  error estimate for blocks of size 2^( 5) =       0.000461690539
  error estimate for blocks of size 2^( 6) =       0.000468578953
  error estimate for blocks of size 2^( 7) =       0.000474095401

      target function =                  N/A
              le_mean =     -16.910445037848
             les_mean =     286.308034648220
             stat err =       0.000463814942
             autocorr =       1.247518862244
              std dev =       0.587267777593
             le_variance =       0.344883442599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345117990858
                                         uncertainty =       0.017833249698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345117990858
                                         uncertainty =       0.017833249698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415459201
  error estimate for blocks of size 2^( 2) =       0.000426921184
  error estimate for blocks of size 2^( 3) =       0.000439298004
  error estimate for blocks of size 2^( 4) =       0.000451069152
  error estimate for blocks of size 2^( 5) =       0.000461858001
  error estimate for blocks of size 2^( 6) =       0.000468734753
  error estimate for blocks of size 2^( 7) =       0.000474234752

      target function =                  N/A
              le_mean =     -16.910445555503
             les_mean =     286.308381407979
             stat err =       0.000463974164
             autocorr =       1.247184871492
              std dev =       0.587548036285
             le_variance =       0.345212694942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910445859146        initial  <--
     6.2500e-02     6.2500e-01             2.6864e-03       -16.910443897844
     2.5000e-01     2.5000e+00             6.7596e-04       -16.910445037848
     1.0000e+00     1.0000e+01             1.7200e-04       -16.910445555503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0533
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.106455e-01 1 1  ON 0
 uu_1                 1.458059e-01 1 1  ON 1
 uu_2                 4.791261e-02 1 1  ON 2
 uu_3                -1.586722e-02 1 1  ON 3
 uu_4                -6.690607e-02 1 1  ON 4
 uu_5                -1.048545e-01 1 1  ON 5
 uu_6                -1.341806e-01 1 1  ON 6
 uu_7                -1.494732e-01 1 1  ON 7
 uu_8                -1.430817e-01 1 1  ON 8
 uu_9                -1.148501e-01 1 1  ON 9
 ud_0                 4.389243e-01 1 1  ON 10
 ud_1                 1.819976e-01 1 1  ON 11
 ud_2                 6.750127e-02 1 1  ON 12
 ud_3                -2.359128e-03 1 1  ON 13
 ud_4                -5.870814e-02 1 1  ON 14
 ud_5                -1.014857e-01 1 1  ON 15
 ud_6                -1.314564e-01 1 1  ON 16
 ud_7                -1.521288e-01 1 1  ON 17
 ud_8                -1.566526e-01 1 1  ON 18
 ud_9                -1.469626e-01 1 1  ON 19
 eO_0                -7.480626e-01 1 1  ON 20
 eO_1                -4.312365e-01 1 1  ON 21
 eO_2                -1.069387e-02 1 1  ON 22
 eO_3                 3.123822e-01 1 1  ON 23
 eO_4                 5.354492e-01 1 1  ON 24
 eO_5                 4.913119e-01 1 1  ON 25
 eO_6                 2.526547e-01 1 1  ON 26
 eO_7                -5.392959e-02 1 1  ON 27
 eO_8                -2.413243e-01 1 1  ON 28
 eO_9                -1.030562e-01 1 1  ON 29
eH1_0                -2.706166e-01 1 1  ON 30
eH1_1                -1.636956e-01 1 1  ON 31
eH1_2                -1.198966e-01 1 1  ON 32
eH1_3                -6.673338e-02 1 1  ON 33
eH1_4                -7.019627e-03 1 1  ON 34
eH1_5                 3.724919e-02 1 1  ON 35
eH1_6                 1.090490e-01 1 1  ON 36
eH1_7                 1.756848e-01 1 1  ON 37
eH1_8                 2.064503e-01 1 1  ON 38
eH1_9                 9.683274e-02 1 1  ON 39
eH2_0                -2.681204e-01 1 1  ON 40
eH2_1                -1.616727e-01 1 1  ON 41
eH2_2                -1.177640e-01 1 1  ON 42
eH2_3                -6.452325e-02 1 1  ON 43
eH2_4                -4.638263e-03 1 1  ON 44
eH2_5                 3.944638e-02 1 1  ON 45
eH2_6                 1.101349e-01 1 1  ON 46
eH2_7                 1.741932e-01 1 1  ON 47
eH2_8                 2.106004e-01 1 1  ON 48
eH2_9                 9.217861e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9406
    reference variance = 0.164477
====================================================
  Execution time = 2.8017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348591745536
                                         uncertainty =       0.006866989948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348591745536
                                         uncertainty =       0.006866989948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417424142
  error estimate for blocks of size 2^( 2) =       0.000428510417
  error estimate for blocks of size 2^( 3) =       0.000440519112
  error estimate for blocks of size 2^( 4) =       0.000452791248
  error estimate for blocks of size 2^( 5) =       0.000461876772
  error estimate for blocks of size 2^( 6) =       0.000469095387
  error estimate for blocks of size 2^( 7) =       0.000474764632

      target function =                  N/A
              le_mean =     -16.909928632417
             les_mean =     286.294172008196
             stat err =       0.000464632010
             autocorr =       1.238976661664
              std dev =       0.590326883170
             le_variance =       0.348485828993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690992863242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928632417       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928417488       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909929099588       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909929106893       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909929626746       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909929646251       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909929912242       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909929870289       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909929871898       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.292803e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928632417       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928568334       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909928764666       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909928756290       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909928926797       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909928918562       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909928944527       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909928930167       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.062498e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909928632417       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909928615586       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909928666518       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909928663411       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909928710249       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909928708000       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909928709834       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909928706492       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.099551e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133984 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5279e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.106798e-01 1 1  ON 0
 uu_1                 1.457737e-01 1 1  ON 1
 uu_2                 4.790946e-02 1 1  ON 2
 uu_3                -1.590181e-02 1 1  ON 3
 uu_4                -6.688056e-02 1 1  ON 4
 uu_5                -1.048587e-01 1 1  ON 5
 uu_6                -1.341234e-01 1 1  ON 6
 uu_7                -1.494322e-01 1 1  ON 7
 uu_8                -1.431386e-01 1 1  ON 8
 uu_9                -1.148926e-01 1 1  ON 9
 ud_0                 4.389878e-01 1 1  ON 10
 ud_1                 1.820319e-01 1 1  ON 11
 ud_2                 6.754539e-02 1 1  ON 12
 ud_3                -2.362198e-03 1 1  ON 13
 ud_4                -5.868755e-02 1 1  ON 14
 ud_5                -1.015334e-01 1 1  ON 15
 ud_6                -1.314926e-01 1 1  ON 16
 ud_7                -1.521338e-01 1 1  ON 17
 ud_8                -1.566787e-01 1 1  ON 18
 ud_9                -1.469859e-01 1 1  ON 19
 eO_0                -7.479841e-01 1 1  ON 20
 eO_1                -4.312362e-01 1 1  ON 21
 eO_2                -1.066444e-02 1 1  ON 22
 eO_3                 3.123995e-01 1 1  ON 23
 eO_4                 5.354643e-01 1 1  ON 24
 eO_5                 4.912988e-01 1 1  ON 25
 eO_6                 2.526633e-01 1 1  ON 26
 eO_7                -5.395326e-02 1 1  ON 27
 eO_8                -2.413677e-01 1 1  ON 28
 eO_9                -1.031130e-01 1 1  ON 29
eH1_0                -2.706519e-01 1 1  ON 30
eH1_1                -1.637318e-01 1 1  ON 31
eH1_2                -1.199033e-01 1 1  ON 32
eH1_3                -6.676748e-02 1 1  ON 33
eH1_4                -7.034094e-03 1 1  ON 34
eH1_5                 3.725745e-02 1 1  ON 35
eH1_6                 1.090131e-01 1 1  ON 36
eH1_7                 1.756865e-01 1 1  ON 37
eH1_8                 2.065119e-01 1 1  ON 38
eH1_9                 9.691337e-02 1 1  ON 39
eH2_0                -2.681805e-01 1 1  ON 40
eH2_1                -1.616785e-01 1 1  ON 41
eH2_2                -1.177968e-01 1 1  ON 42
eH2_3                -6.450697e-02 1 1  ON 43
eH2_4                -4.694624e-03 1 1  ON 44
eH2_5                 3.945075e-02 1 1  ON 45
eH2_6                 1.101316e-01 1 1  ON 46
eH2_7                 1.741964e-01 1 1  ON 47
eH2_8                 2.106340e-01 1 1  ON 48
eH2_9                 9.225847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9548
    reference variance = 0.303567
====================================================
  Execution time = 2.9643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3645e-01
  Total weights = 2.0000e+06
  Execution time = 3.4723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336576237626
                                         uncertainty =       0.003851859499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336576237626
                                         uncertainty =       0.003851859499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410141412
  error estimate for blocks of size 2^( 2) =       0.000421448333
  error estimate for blocks of size 2^( 3) =       0.000433659597
  error estimate for blocks of size 2^( 4) =       0.000445323760
  error estimate for blocks of size 2^( 5) =       0.000455560944
  error estimate for blocks of size 2^( 6) =       0.000462830581
  error estimate for blocks of size 2^( 7) =       0.000466716369

      target function =                  N/A
              le_mean =     -16.910625447806
             les_mean =     286.305684822893
             stat err =       0.000457607913
             autocorr =       1.244857982523
              std dev =       0.580027546854
             le_variance =       0.336431955109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336630528663
                                         uncertainty =       0.003852898690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336630528663
                                         uncertainty =       0.003852898690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410174489
  error estimate for blocks of size 2^( 2) =       0.000421479706
  error estimate for blocks of size 2^( 3) =       0.000433689369
  error estimate for blocks of size 2^( 4) =       0.000445352806
  error estimate for blocks of size 2^( 5) =       0.000455591055
  error estimate for blocks of size 2^( 6) =       0.000462859439
  error estimate for blocks of size 2^( 7) =       0.000466743749

      target function =                  N/A
              le_mean =     -16.910625895810
             les_mean =     286.305754243283
             stat err =       0.000457636762
             autocorr =       1.244814149218
              std dev =       0.580074325841
             le_variance =       0.336486223500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336614459872
                                         uncertainty =       0.003852597388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336614459872
                                         uncertainty =       0.003852597388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410164699
  error estimate for blocks of size 2^( 2) =       0.000421470738
  error estimate for blocks of size 2^( 3) =       0.000433681285
  error estimate for blocks of size 2^( 4) =       0.000445345051
  error estimate for blocks of size 2^( 5) =       0.000455583099
  error estimate for blocks of size 2^( 6) =       0.000462852098
  error estimate for blocks of size 2^( 7) =       0.000466737120

      target function =                  N/A
              le_mean =     -16.910625845383
             les_mean =     286.305736474403
             stat err =       0.000457629342
             autocorr =       1.244833208434
              std dev =       0.580060479680
             le_variance =       0.336470160087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336581140547
                                         uncertainty =       0.003851960745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336581140547
                                         uncertainty =       0.003851960745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144399
  error estimate for blocks of size 2^( 2) =       0.000421451221
  error estimate for blocks of size 2^( 3) =       0.000433662412
  error estimate for blocks of size 2^( 4) =       0.000445326526
  error estimate for blocks of size 2^( 5) =       0.000455563840
  error estimate for blocks of size 2^( 6) =       0.000462833394
  error estimate for blocks of size 2^( 7) =       0.000466719103

      target function =                  N/A
              le_mean =     -16.910625503684
             les_mean =     286.305691613400
             stat err =       0.000457610716
             autocorr =       1.244855095896
              std dev =       0.580031771338
             le_variance =       0.336436855761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910625447806        initial
     6.2500e-01     6.2500e+00             3.2928e-04       -16.910625895810  <--
     2.5000e+00     2.5000e+01             8.0625e-05       -16.910625845383
     1.0000e+01     1.0000e+02             2.0996e-05       -16.910625503684

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.7017e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.107322e-01 1 1  ON 0
 uu_1                 1.457105e-01 1 1  ON 1
 uu_2                 4.789384e-02 1 1  ON 2
 uu_3                -1.597183e-02 1 1  ON 3
 uu_4                -6.683310e-02 1 1  ON 4
 uu_5                -1.048430e-01 1 1  ON 5
 uu_6                -1.339885e-01 1 1  ON 6
 uu_7                -1.493100e-01 1 1  ON 7
 uu_8                -1.432874e-01 1 1  ON 8
 uu_9                -1.150155e-01 1 1  ON 9
 ud_0                 4.391294e-01 1 1  ON 10
 ud_1                 1.821285e-01 1 1  ON 11
 ud_2                 6.764860e-02 1 1  ON 12
 ud_3                -2.335317e-03 1 1  ON 13
 ud_4                -5.865171e-02 1 1  ON 14
 ud_5                -1.016362e-01 1 1  ON 15
 ud_6                -1.315879e-01 1 1  ON 16
 ud_7                -1.521478e-01 1 1  ON 17
 ud_8                -1.567432e-01 1 1  ON 18
 ud_9                -1.470504e-01 1 1  ON 19
 eO_0                -7.478043e-01 1 1  ON 20
 eO_1                -4.311833e-01 1 1  ON 21
 eO_2                -1.057266e-02 1 1  ON 22
 eO_3                 3.124530e-01 1 1  ON 23
 eO_4                 5.355105e-01 1 1  ON 24
 eO_5                 4.912595e-01 1 1  ON 25
 eO_6                 2.526859e-01 1 1  ON 26
 eO_7                -5.402071e-02 1 1  ON 27
 eO_8                -2.414960e-01 1 1  ON 28
 eO_9                -1.032865e-01 1 1  ON 29
eH1_0                -2.707690e-01 1 1  ON 30
eH1_1                -1.638260e-01 1 1  ON 31
eH1_2                -1.199505e-01 1 1  ON 32
eH1_3                -6.685192e-02 1 1  ON 33
eH1_4                -7.089230e-03 1 1  ON 34
eH1_5                 3.727957e-02 1 1  ON 35
eH1_6                 1.089115e-01 1 1  ON 36
eH1_7                 1.756940e-01 1 1  ON 37
eH1_8                 2.067010e-01 1 1  ON 38
eH1_9                 9.716203e-02 1 1  ON 39
eH2_0                -2.683577e-01 1 1  ON 40
eH2_1                -1.617079e-01 1 1  ON 41
eH2_2                -1.178850e-01 1 1  ON 42
eH2_3                -6.449305e-02 1 1  ON 43
eH2_4                -4.836042e-03 1 1  ON 44
eH2_5                 3.945555e-02 1 1  ON 45
eH2_6                 1.101197e-01 1 1  ON 46
eH2_7                 1.742086e-01 1 1  ON 47
eH2_8                 2.107396e-01 1 1  ON 48
eH2_9                 9.250512e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6935e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8682
    reference variance = 0.320576
====================================================
  Execution time = 2.9071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5938e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359528521898
                                         uncertainty =       0.031775795264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359528521898
                                         uncertainty =       0.031775795264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423897625
  error estimate for blocks of size 2^( 2) =       0.000434930941
  error estimate for blocks of size 2^( 3) =       0.000446806734
  error estimate for blocks of size 2^( 4) =       0.000457543199
  error estimate for blocks of size 2^( 5) =       0.000467699011
  error estimate for blocks of size 2^( 6) =       0.000475812680
  error estimate for blocks of size 2^( 7) =       0.000481123288

      target function =                  N/A
              le_mean =     -16.910190781574
             les_mean =     286.313930482634
             stat err =       0.000470544545
             autocorr =       1.232195216422
              std dev =       0.599481770451
             le_variance =       0.359378393103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691019078157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910190781574       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910191036960       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910192282049       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910193786453       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910194314267       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910194357735       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910194271316       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910193960916       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910194106253       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910193983980       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910194174913       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.174428e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910190781574       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910190884148       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910191401009       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910191892013       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910191915217       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910192066343       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910191902669       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910191922298       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910191874178       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.992944e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910190781574       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910190811801       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910190974542       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910191101339       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910191094347       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910191141600       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910191101435       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910191105696       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.006211e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6241e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.108374e-01 1 1  ON 0
 uu_1                 1.457964e-01 1 1  ON 1
 uu_2                 4.796465e-02 1 1  ON 2
 uu_3                -1.590743e-02 1 1  ON 3
 uu_4                -6.680317e-02 1 1  ON 4
 uu_5                -1.049662e-01 1 1  ON 5
 uu_6                -1.340727e-01 1 1  ON 6
 uu_7                -1.494802e-01 1 1  ON 7
 uu_8                -1.434554e-01 1 1  ON 8
 uu_9                -1.150976e-01 1 1  ON 9
 ud_0                 4.392438e-01 1 1  ON 10
 ud_1                 1.822265e-01 1 1  ON 11
 ud_2                 6.765526e-02 1 1  ON 12
 ud_3                -2.276033e-03 1 1  ON 13
 ud_4                -5.866526e-02 1 1  ON 14
 ud_5                -1.016203e-01 1 1  ON 15
 ud_6                -1.315413e-01 1 1  ON 16
 ud_7                -1.521634e-01 1 1  ON 17
 ud_8                -1.567407e-01 1 1  ON 18
 ud_9                -1.471802e-01 1 1  ON 19
 eO_0                -7.476748e-01 1 1  ON 20
 eO_1                -4.310203e-01 1 1  ON 21
 eO_2                -1.052148e-02 1 1  ON 22
 eO_3                 3.124289e-01 1 1  ON 23
 eO_4                 5.355493e-01 1 1  ON 24
 eO_5                 4.913493e-01 1 1  ON 25
 eO_6                 2.527982e-01 1 1  ON 26
 eO_7                -5.419430e-02 1 1  ON 27
 eO_8                -2.416887e-01 1 1  ON 28
 eO_9                -1.034534e-01 1 1  ON 29
eH1_0                -2.710683e-01 1 1  ON 30
eH1_1                -1.638716e-01 1 1  ON 31
eH1_2                -1.199814e-01 1 1  ON 32
eH1_3                -6.689704e-02 1 1  ON 33
eH1_4                -7.053073e-03 1 1  ON 34
eH1_5                 3.720470e-02 1 1  ON 35
eH1_6                 1.088146e-01 1 1  ON 36
eH1_7                 1.757038e-01 1 1  ON 37
eH1_8                 2.069034e-01 1 1  ON 38
eH1_9                 9.743680e-02 1 1  ON 39
eH2_0                -2.683977e-01 1 1  ON 40
eH2_1                -1.617580e-01 1 1  ON 41
eH2_2                -1.180942e-01 1 1  ON 42
eH2_3                -6.459792e-02 1 1  ON 43
eH2_4                -4.973653e-03 1 1  ON 44
eH2_5                 3.955592e-02 1 1  ON 45
eH2_6                 1.100341e-01 1 1  ON 46
eH2_7                 1.742375e-01 1 1  ON 47
eH2_8                 2.109141e-01 1 1  ON 48
eH2_9                 9.279976e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9782
    reference variance = 0.241545
====================================================
  Execution time = 2.8430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3023e-01
  Total weights = 2.0000e+06
  Execution time = 3.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330156025105
                                         uncertainty =       0.003802183962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330156025105
                                         uncertainty =       0.003802183962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406293684
  error estimate for blocks of size 2^( 2) =       0.000417745599
  error estimate for blocks of size 2^( 3) =       0.000429205033
  error estimate for blocks of size 2^( 4) =       0.000440023946
  error estimate for blocks of size 2^( 5) =       0.000448685633
  error estimate for blocks of size 2^( 6) =       0.000455149992
  error estimate for blocks of size 2^( 7) =       0.000458946568

      target function =                  N/A
              le_mean =     -16.910720143341
             les_mean =     286.302604716503
             stat err =       0.000450701535
             autocorr =       1.230546222917
              std dev =       0.574586038107
             le_variance =       0.330149115188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330332621072
                                         uncertainty =       0.003802953022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330332621072
                                         uncertainty =       0.003802953022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406402494
  error estimate for blocks of size 2^( 2) =       0.000417844440
  error estimate for blocks of size 2^( 3) =       0.000429291033
  error estimate for blocks of size 2^( 4) =       0.000440103597
  error estimate for blocks of size 2^( 5) =       0.000448767622
  error estimate for blocks of size 2^( 6) =       0.000455233745
  error estimate for blocks of size 2^( 7) =       0.000459031624

      target function =                  N/A
              le_mean =     -16.910723965767
             les_mean =     286.302910856263
             stat err =       0.000450784147
             autocorr =       1.230338287055
              std dev =       0.574739919485
             le_variance =       0.330325975049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330321693475
                                         uncertainty =       0.003803062258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330321693475
                                         uncertainty =       0.003803062258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406395763
  error estimate for blocks of size 2^( 2) =       0.000417839009
  error estimate for blocks of size 2^( 3) =       0.000429287335
  error estimate for blocks of size 2^( 4) =       0.000440101237
  error estimate for blocks of size 2^( 5) =       0.000448765057
  error estimate for blocks of size 2^( 6) =       0.000455229396
  error estimate for blocks of size 2^( 7) =       0.000459026960

      target function =                  N/A
              le_mean =     -16.910722663930
             les_mean =     286.302855884012
             stat err =       0.000450780663
             autocorr =       1.230360024564
              std dev =       0.574730400126
             le_variance =       0.330315032829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330184631701
                                         uncertainty =       0.003802360159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330184631701
                                         uncertainty =       0.003802360159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406311312
  error estimate for blocks of size 2^( 2) =       0.000417761784
  error estimate for blocks of size 2^( 3) =       0.000429219404
  error estimate for blocks of size 2^( 4) =       0.000440037523
  error estimate for blocks of size 2^( 5) =       0.000448699599
  error estimate for blocks of size 2^( 6) =       0.000455163718
  error estimate for blocks of size 2^( 7) =       0.000458960565

      target function =                  N/A
              le_mean =     -16.910720442221
             les_mean =     286.302643475162
             stat err =       0.000450715351
             autocorr =       1.230514888199
              std dev =       0.574610968667
             le_variance =       0.330177765312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910720143341        initial
     1.5625e-01     1.5625e+00             1.1744e-03       -16.910723965767  <--
     6.2500e-01     6.2500e+00             2.9929e-04       -16.910722663930
     2.5000e+00     2.5000e+01             8.0062e-05       -16.910720442221

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.6299e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.110562e-01 1 1  ON 0
 uu_1                 1.459783e-01 1 1  ON 1
 uu_2                 4.812388e-02 1 1  ON 2
 uu_3                -1.577032e-02 1 1  ON 3
 uu_4                -6.675396e-02 1 1  ON 4
 uu_5                -1.051583e-01 1 1  ON 5
 uu_6                -1.343316e-01 1 1  ON 6
 uu_7                -1.498779e-01 1 1  ON 7
 uu_8                -1.439033e-01 1 1  ON 8
 uu_9                -1.153488e-01 1 1  ON 9
 ud_0                 4.394614e-01 1 1  ON 10
 ud_1                 1.823891e-01 1 1  ON 11
 ud_2                 6.777587e-02 1 1  ON 12
 ud_3                -2.151918e-03 1 1  ON 13
 ud_4                -5.859809e-02 1 1  ON 14
 ud_5                -1.015364e-01 1 1  ON 15
 ud_6                -1.314888e-01 1 1  ON 16
 ud_7                -1.521334e-01 1 1  ON 17
 ud_8                -1.566841e-01 1 1  ON 18
 ud_9                -1.475429e-01 1 1  ON 19
 eO_0                -7.473248e-01 1 1  ON 20
 eO_1                -4.306559e-01 1 1  ON 21
 eO_2                -1.028586e-02 1 1  ON 22
 eO_3                 3.124660e-01 1 1  ON 23
 eO_4                 5.356429e-01 1 1  ON 24
 eO_5                 4.915766e-01 1 1  ON 25
 eO_6                 2.531130e-01 1 1  ON 26
 eO_7                -5.467246e-02 1 1  ON 27
 eO_8                -2.422535e-01 1 1  ON 28
 eO_9                -1.039518e-01 1 1  ON 29
eH1_0                -2.717329e-01 1 1  ON 30
eH1_1                -1.640433e-01 1 1  ON 31
eH1_2                -1.201743e-01 1 1  ON 32
eH1_3                -6.705498e-02 1 1  ON 33
eH1_4                -7.076402e-03 1 1  ON 34
eH1_5                 3.705864e-02 1 1  ON 35
eH1_6                 1.085419e-01 1 1  ON 36
eH1_7                 1.757121e-01 1 1  ON 37
eH1_8                 2.074967e-01 1 1  ON 38
eH1_9                 9.825691e-02 1 1  ON 39
eH2_0                -2.686407e-01 1 1  ON 40
eH2_1                -1.620339e-01 1 1  ON 41
eH2_2                -1.185311e-01 1 1  ON 42
eH2_3                -6.489664e-02 1 1  ON 43
eH2_4                -5.287307e-03 1 1  ON 44
eH2_5                 3.971912e-02 1 1  ON 45
eH2_6                 1.098328e-01 1 1  ON 46
eH2_7                 1.743484e-01 1 1  ON 47
eH2_8                 2.114432e-01 1 1  ON 48
eH2_9                 9.367955e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0726
    reference variance = 0.346792
====================================================
  Execution time = 2.7892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342400774062
                                         uncertainty =       0.005373539936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342400774062
                                         uncertainty =       0.005373539936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413796409
  error estimate for blocks of size 2^( 2) =       0.000425105954
  error estimate for blocks of size 2^( 3) =       0.000437182168
  error estimate for blocks of size 2^( 4) =       0.000449313891
  error estimate for blocks of size 2^( 5) =       0.000459647450
  error estimate for blocks of size 2^( 6) =       0.000466162322
  error estimate for blocks of size 2^( 7) =       0.000470295693

      target function =                  N/A
              le_mean =     -16.910496579131
             les_mean =     286.307349318509
             stat err =       0.000461354839
             autocorr =       1.243073260959
              std dev =       0.585196494304
             le_variance =       0.342454936945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691049657913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910496579131       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910498019502       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910498235004       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910497599626       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910497398342       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910495754890       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910499912151       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910501252883       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910501921299       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910499825381       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910500679413       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910501722867       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910502389870       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910501971524       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.557324e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910496579131       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910497497808       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910497402559       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910496777529       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910497288721       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910496998892       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910497626239       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910498290205       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910497811972       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910497857146       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.392424e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910496579131       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910496954288       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910496801723       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910496517692       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910497001746       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910496806936       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910496853973       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910496981031       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.469578e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5073e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.421783
====================================================
  Execution time = 2.7165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.0000e+06
  Execution time = 3.4604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335338009768
                                         uncertainty =       0.004829661840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335338009768
                                         uncertainty =       0.004829661840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409474450
  error estimate for blocks of size 2^( 2) =       0.000421426040
  error estimate for blocks of size 2^( 3) =       0.000433686135
  error estimate for blocks of size 2^( 4) =       0.000445654434
  error estimate for blocks of size 2^( 5) =       0.000456866197
  error estimate for blocks of size 2^( 6) =       0.000466138108
  error estimate for blocks of size 2^( 7) =       0.000471933245

      target function =                  N/A
              le_mean =     -16.910184526458
             les_mean =     286.289679201857
             stat err =       0.000460147996
             autocorr =       1.262820006034
              std dev =       0.579084320850
             le_variance =       0.335338650654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335183594463
                                         uncertainty =       0.004827738030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335183594463
                                         uncertainty =       0.004827738030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409379982
  error estimate for blocks of size 2^( 2) =       0.000421336090
  error estimate for blocks of size 2^( 3) =       0.000433600476
  error estimate for blocks of size 2^( 4) =       0.000445571213
  error estimate for blocks of size 2^( 5) =       0.000456775021
  error estimate for blocks of size 2^( 6) =       0.000466040805
  error estimate for blocks of size 2^( 7) =       0.000471824191

      target function =                  N/A
              le_mean =     -16.910187405384
             les_mean =     286.289621856813
             stat err =       0.000460052808
             autocorr =       1.262880234226
              std dev =       0.578950722608
             le_variance =       0.335183939208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335139014516
                                         uncertainty =       0.004826791894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335139014516
                                         uncertainty =       0.004826791894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409352706
  error estimate for blocks of size 2^( 2) =       0.000421310182
  error estimate for blocks of size 2^( 3) =       0.000433575715
  error estimate for blocks of size 2^( 4) =       0.000445549118
  error estimate for blocks of size 2^( 5) =       0.000456758518
  error estimate for blocks of size 2^( 6) =       0.000466026860
  error estimate for blocks of size 2^( 7) =       0.000471808153

      target function =                  N/A
              le_mean =     -16.910189676951
             les_mean =     286.289654018827
             stat err =       0.000460035662
             autocorr =       1.262954393119
              std dev =       0.578912148707
             le_variance =       0.335139275921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335283909479
                                         uncertainty =       0.004828999332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335283909479
                                         uncertainty =       0.004828999332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409441369
  error estimate for blocks of size 2^( 2) =       0.000421394129
  error estimate for blocks of size 2^( 3) =       0.000433655349
  error estimate for blocks of size 2^( 4) =       0.000445624721
  error estimate for blocks of size 2^( 5) =       0.000456836102
  error estimate for blocks of size 2^( 6) =       0.000466106351
  error estimate for blocks of size 2^( 7) =       0.000471898082

      target function =                  N/A
              le_mean =     -16.910185358806
             les_mean =     286.289653170252
             stat err =       0.000460116314
             autocorr =       1.262850160004
              std dev =       0.579037536526
             le_variance =       0.335284468707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910184526458        initial
     3.9062e-02     3.9062e-01             5.5573e-03       -16.910187405384
     1.5625e-01     1.5625e+00             1.3924e-03       -16.910189676951  <--
     6.2500e-01     6.2500e+00             3.4696e-04       -16.910185358806

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.4512e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6943e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.122036
====================================================
  Execution time = 2.7893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268606440
                                         uncertainty =       0.007531659718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343268606440
                                         uncertainty =       0.007531659718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414188807
  error estimate for blocks of size 2^( 2) =       0.000425232677
  error estimate for blocks of size 2^( 3) =       0.000435925211
  error estimate for blocks of size 2^( 4) =       0.000446979371
  error estimate for blocks of size 2^( 5) =       0.000454787545
  error estimate for blocks of size 2^( 6) =       0.000464234792
  error estimate for blocks of size 2^( 7) =       0.000470817799

      target function =                  N/A
              le_mean =     -16.911296239645
             les_mean =     286.335045069224
             stat err =       0.000459204877
             autocorr =       1.229182209779
              std dev =       0.585751428282
             le_variance =       0.343104735734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691129623965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911296239645       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911298438457       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911299816499       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911302441879       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911300868895       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911303239004       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911304982088       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911306355203       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911303134833       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911302164492       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911301921008       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911304383208       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911305922249       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911305735236       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911305591019       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.641153e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911296239645       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911297537177       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911298060401       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911299415136       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911298222951       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911299337129       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911299961008       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911299876604       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911299291174       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911299107583       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911299025292       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911299327012       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.162125e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911296239645       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911296731214       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911296877814       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911297322404       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911296911465       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911297243553       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911297356255       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911297274137       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911297269534       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.845626e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147294 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5052e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.107494e-01 1 1  ON 0
 uu_1                 1.460807e-01 1 1  ON 1
 uu_2                 4.815001e-02 1 1  ON 2
 uu_3                -1.551902e-02 1 1  ON 3
 uu_4                -6.692119e-02 1 1  ON 4
 uu_5                -1.050095e-01 1 1  ON 5
 uu_6                -1.342654e-01 1 1  ON 6
 uu_7                -1.502731e-01 1 1  ON 7
 uu_8                -1.445644e-01 1 1  ON 8
 uu_9                -1.157785e-01 1 1  ON 9
 ud_0                 4.396995e-01 1 1  ON 10
 ud_1                 1.828535e-01 1 1  ON 11
 ud_2                 6.821645e-02 1 1  ON 12
 ud_3                -1.777100e-03 1 1  ON 13
 ud_4                -5.804394e-02 1 1  ON 14
 ud_5                -1.014959e-01 1 1  ON 15
 ud_6                -1.315403e-01 1 1  ON 16
 ud_7                -1.523096e-01 1 1  ON 17
 ud_8                -1.573162e-01 1 1  ON 18
 ud_9                -1.475038e-01 1 1  ON 19
 eO_0                -7.462332e-01 1 1  ON 20
 eO_1                -4.294391e-01 1 1  ON 21
 eO_2                -9.267887e-03 1 1  ON 22
 eO_3                 3.129318e-01 1 1  ON 23
 eO_4                 5.356905e-01 1 1  ON 24
 eO_5                 4.911880e-01 1 1  ON 25
 eO_6                 2.533461e-01 1 1  ON 26
 eO_7                -5.574627e-02 1 1  ON 27
 eO_8                -2.433614e-01 1 1  ON 28
 eO_9                -1.051796e-01 1 1  ON 29
eH1_0                -2.723491e-01 1 1  ON 30
eH1_1                -1.656192e-01 1 1  ON 31
eH1_2                -1.214525e-01 1 1  ON 32
eH1_3                -6.777135e-02 1 1  ON 33
eH1_4                -7.698323e-03 1 1  ON 34
eH1_5                 3.729040e-02 1 1  ON 35
eH1_6                 1.088097e-01 1 1  ON 36
eH1_7                 1.758228e-01 1 1  ON 37
eH1_8                 2.089699e-01 1 1  ON 38
eH1_9                 1.005887e-01 1 1  ON 39
eH2_0                -2.699505e-01 1 1  ON 40
eH2_1                -1.629634e-01 1 1  ON 41
eH2_2                -1.188894e-01 1 1  ON 42
eH2_3                -6.580934e-02 1 1  ON 43
eH2_4                -5.753090e-03 1 1  ON 44
eH2_5                 3.926245e-02 1 1  ON 45
eH2_6                 1.099061e-01 1 1  ON 46
eH2_7                 1.748318e-01 1 1  ON 47
eH2_8                 2.123312e-01 1 1  ON 48
eH2_9                 9.623410e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.233226
====================================================
  Execution time = 2.7168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4023e-01
  Total weights = 2.0000e+06
  Execution time = 3.4835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340512225086
                                         uncertainty =       0.005492899871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340512225086
                                         uncertainty =       0.005492899871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570714
  error estimate for blocks of size 2^( 2) =       0.000424590359
  error estimate for blocks of size 2^( 3) =       0.000436392193
  error estimate for blocks of size 2^( 4) =       0.000448318304
  error estimate for blocks of size 2^( 5) =       0.000459974085
  error estimate for blocks of size 2^( 6) =       0.000465795748
  error estimate for blocks of size 2^( 7) =       0.000471676634

      target function =                  N/A
              le_mean =     -16.910948201893
             les_mean =     286.320598104574
             stat err =       0.000461441193
             autocorr =       1.250938415875
              std dev =       0.583463098809
             le_variance =       0.340429187672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340241964574
                                         uncertainty =       0.005493797014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340241964574
                                         uncertainty =       0.005493797014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412406862
  error estimate for blocks of size 2^( 2) =       0.000424419342
  error estimate for blocks of size 2^( 3) =       0.000436205497
  error estimate for blocks of size 2^( 4) =       0.000448119043
  error estimate for blocks of size 2^( 5) =       0.000459775745
  error estimate for blocks of size 2^( 6) =       0.000465612207
  error estimate for blocks of size 2^( 7) =       0.000471510900

      target function =                  N/A
              le_mean =     -16.910945160926
             les_mean =     286.320224906081
             stat err =       0.000461254474
             autocorr =       1.250919654879
              std dev =       0.583231378023
             le_variance =       0.340158840310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340131749582
                                         uncertainty =       0.005495042763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340131749582
                                         uncertainty =       0.005495042763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412340012
  error estimate for blocks of size 2^( 2) =       0.000424356709
  error estimate for blocks of size 2^( 3) =       0.000436146614
  error estimate for blocks of size 2^( 4) =       0.000448064339
  error estimate for blocks of size 2^( 5) =       0.000459722964
  error estimate for blocks of size 2^( 6) =       0.000465560189
  error estimate for blocks of size 2^( 7) =       0.000471452100

      target function =                  N/A
              le_mean =     -16.910945489186
             les_mean =     286.320125739770
             stat err =       0.000461199898
             autocorr =       1.251029199335
              std dev =       0.583136837778
             le_variance =       0.340048571574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340417370822
                                         uncertainty =       0.005493382155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340417370822
                                         uncertainty =       0.005493382155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412513210
  error estimate for blocks of size 2^( 2) =       0.000424532779
  error estimate for blocks of size 2^( 3) =       0.000436332806
  error estimate for blocks of size 2^( 4) =       0.000448258016
  error estimate for blocks of size 2^( 5) =       0.000459914630
  error estimate for blocks of size 2^( 6) =       0.000465738819
  error estimate for blocks of size 2^( 7) =       0.000471620546

      target function =                  N/A
              le_mean =     -16.910947258886
             les_mean =     286.320471319602
             stat err =       0.000461383003
             autocorr =       1.250971631274
              std dev =       0.583381776320
             le_variance =       0.340334296942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910948201893        initial  <--
     3.9062e-02     3.9062e-01             4.6412e-03       -16.910945160926
     1.5625e-01     1.5625e+00             1.1621e-03       -16.910945489186
     6.2500e-01     6.2500e+00             2.8456e-04       -16.910947258886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5435
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6937e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9028
    reference variance = 0.180383
====================================================
  Execution time = 2.8059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3861e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338711523534
                                         uncertainty =       0.005568829764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338711523534
                                         uncertainty =       0.005568829764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411467588
  error estimate for blocks of size 2^( 2) =       0.000423290950
  error estimate for blocks of size 2^( 3) =       0.000435343864
  error estimate for blocks of size 2^( 4) =       0.000446749971
  error estimate for blocks of size 2^( 5) =       0.000457251610
  error estimate for blocks of size 2^( 6) =       0.000464358319
  error estimate for blocks of size 2^( 7) =       0.000467630058

      target function =                  N/A
              le_mean =     -16.910422857196
             les_mean =     286.301012192336
             stat err =       0.000458997489
             autocorr =       1.244369499579
              std dev =       0.581903043874
             le_variance =       0.338611152470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691042285720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910422857196       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910423139584       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910423703784       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910424323152       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910424604331       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910424080941       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910423919491       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910424269185       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910424269593       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.262981e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910422857196       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910422946877       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910423128994       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910423228722       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910423417015       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910423307179       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910423200308       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910423268051       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.329444e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910422857196       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910422881241       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910422931087       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910422951184       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910423008427       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910422985046       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910422955068       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910422967865       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.342331e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5675e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.109289e-01 1 1  ON 0
 uu_1                 1.460230e-01 1 1  ON 1
 uu_2                 4.811930e-02 1 1  ON 2
 uu_3                -1.575783e-02 1 1  ON 3
 uu_4                -6.693442e-02 1 1  ON 4
 uu_5                -1.052334e-01 1 1  ON 5
 uu_6                -1.345373e-01 1 1  ON 6
 uu_7                -1.501360e-01 1 1  ON 7
 uu_8                -1.439480e-01 1 1  ON 8
 uu_9                -1.153430e-01 1 1  ON 9
 ud_0                 4.394851e-01 1 1  ON 10
 ud_1                 1.824082e-01 1 1  ON 11
 ud_2                 6.785755e-02 1 1  ON 12
 ud_3                -2.170408e-03 1 1  ON 13
 ud_4                -5.840390e-02 1 1  ON 14
 ud_5                -1.017388e-01 1 1  ON 15
 ud_6                -1.315536e-01 1 1  ON 16
 ud_7                -1.520383e-01 1 1  ON 17
 ud_8                -1.564555e-01 1 1  ON 18
 ud_9                -1.471794e-01 1 1  ON 19
 eO_0                -7.467442e-01 1 1  ON 20
 eO_1                -4.301688e-01 1 1  ON 21
 eO_2                -9.824558e-03 1 1  ON 22
 eO_3                 3.127801e-01 1 1  ON 23
 eO_4                 5.355822e-01 1 1  ON 24
 eO_5                 4.916077e-01 1 1  ON 25
 eO_6                 2.531045e-01 1 1  ON 26
 eO_7                -5.529892e-02 1 1  ON 27
 eO_8                -2.426801e-01 1 1  ON 28
 eO_9                -1.045603e-01 1 1  ON 29
eH1_0                -2.720138e-01 1 1  ON 30
eH1_1                -1.648109e-01 1 1  ON 31
eH1_2                -1.208412e-01 1 1  ON 32
eH1_3                -6.729219e-02 1 1  ON 33
eH1_4                -7.677301e-03 1 1  ON 34
eH1_5                 3.694380e-02 1 1  ON 35
eH1_6                 1.087048e-01 1 1  ON 36
eH1_7                 1.757350e-01 1 1  ON 37
eH1_8                 2.083614e-01 1 1  ON 38
eH1_9                 9.957599e-02 1 1  ON 39
eH2_0                -2.699390e-01 1 1  ON 40
eH2_1                -1.627701e-01 1 1  ON 41
eH2_2                -1.187182e-01 1 1  ON 42
eH2_3                -6.523282e-02 1 1  ON 43
eH2_4                -5.515850e-03 1 1  ON 44
eH2_5                 4.002362e-02 1 1  ON 45
eH2_6                 1.099973e-01 1 1  ON 46
eH2_7                 1.744436e-01 1 1  ON 47
eH2_8                 2.119409e-01 1 1  ON 48
eH2_9                 9.515774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9047
    reference variance = 0.263286
====================================================
  Execution time = 2.7534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3347e-01
  Total weights = 2.0000e+06
  Execution time = 3.4608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333547494122
                                         uncertainty =       0.003678934445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333547494122
                                         uncertainty =       0.003678934445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408335104
  error estimate for blocks of size 2^( 2) =       0.000419956121
  error estimate for blocks of size 2^( 3) =       0.000431960450
  error estimate for blocks of size 2^( 4) =       0.000443679038
  error estimate for blocks of size 2^( 5) =       0.000454630116
  error estimate for blocks of size 2^( 6) =       0.000460921220
  error estimate for blocks of size 2^( 7) =       0.000464781312

      target function =                  N/A
              le_mean =     -16.910750064699
             les_mean =     286.306942698096
             stat err =       0.000456002922
             autocorr =       1.247101542236
              std dev =       0.577473041907
             le_variance =       0.333475114129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333528089955
                                         uncertainty =       0.003678994360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333528089955
                                         uncertainty =       0.003678994360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408323210
  error estimate for blocks of size 2^( 2) =       0.000419947518
  error estimate for blocks of size 2^( 3) =       0.000431954045
  error estimate for blocks of size 2^( 4) =       0.000443674669
  error estimate for blocks of size 2^( 5) =       0.000454625126
  error estimate for blocks of size 2^( 6) =       0.000460920586
  error estimate for blocks of size 2^( 7) =       0.000464782024

      target function =                  N/A
              le_mean =     -16.910749087735
             les_mean =     286.306890229315
             stat err =       0.000456000601
             autocorr =       1.247161502700
              std dev =       0.577456221480
             le_variance =       0.333455687726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333537373529
                                         uncertainty =       0.003678882917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333537373529
                                         uncertainty =       0.003678882917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408328896
  error estimate for blocks of size 2^( 2) =       0.000419952361
  error estimate for blocks of size 2^( 3) =       0.000431958173
  error estimate for blocks of size 2^( 4) =       0.000443678307
  error estimate for blocks of size 2^( 5) =       0.000454628798
  error estimate for blocks of size 2^( 6) =       0.000460923185
  error estimate for blocks of size 2^( 7) =       0.000464783983

      target function =                  N/A
              le_mean =     -16.910749206060
             les_mean =     286.306903517806
             stat err =       0.000456003568
             autocorr =       1.247143000186
              std dev =       0.577464262338
             le_variance =       0.333464974277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333546149640
                                         uncertainty =       0.003678923122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333546149640
                                         uncertainty =       0.003678923122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408334279
  error estimate for blocks of size 2^( 2) =       0.000419955643
  error estimate for blocks of size 2^( 3) =       0.000431960178
  error estimate for blocks of size 2^( 4) =       0.000443678997
  error estimate for blocks of size 2^( 5) =       0.000454629981
  error estimate for blocks of size 2^( 6) =       0.000460921561
  error estimate for blocks of size 2^( 7) =       0.000464781756

      target function =                  N/A
              le_mean =     -16.910749930806
             les_mean =     286.306936822206
             stat err =       0.000456003074
             autocorr =       1.247107413292
              std dev =       0.577471875240
             le_variance =       0.333473766693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910750064699        initial  <--
     3.9062e-01     3.9062e+00             5.2630e-04       -16.910749087735
     1.5625e+00     1.5625e+01             1.3294e-04       -16.910749206060
     6.2500e+00     6.2500e+01             3.3423e-05       -16.910749930806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9674
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.314979
====================================================
  Execution time = 2.8122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750328478
                                         uncertainty =       0.004236618723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750328478
                                         uncertainty =       0.004236618723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409086490
  error estimate for blocks of size 2^( 2) =       0.000421378420
  error estimate for blocks of size 2^( 3) =       0.000433445675
  error estimate for blocks of size 2^( 4) =       0.000445458095
  error estimate for blocks of size 2^( 5) =       0.000455836695
  error estimate for blocks of size 2^( 6) =       0.000463785044
  error estimate for blocks of size 2^( 7) =       0.000469974820

      target function =                  N/A
              le_mean =     -16.910345705385
             les_mean =     286.294495221262
             stat err =       0.000458763663
             autocorr =       1.257615117655
              std dev =       0.578535662673
             le_variance =       0.334703512985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691034570538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910345705385       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910345805743       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910345659196       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910345638541       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910345691304       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910345836220       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910345781028       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910345775177       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.796230e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910345705385       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910345731553       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910345693189       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910345685508       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910345698479       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910345735754       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910345724094       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910345721687       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.200974e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910345705385       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910345711998       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910345702291       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910345700199       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910345703419       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910345712792       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910345710038       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910345709378       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.003805e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5266e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.108949e-01 1 1  ON 0
 uu_1                 1.460815e-01 1 1  ON 1
 uu_2                 4.815737e-02 1 1  ON 2
 uu_3                -1.575641e-02 1 1  ON 3
 uu_4                -6.691099e-02 1 1  ON 4
 uu_5                -1.052428e-01 1 1  ON 5
 uu_6                -1.345515e-01 1 1  ON 6
 uu_7                -1.501789e-01 1 1  ON 7
 uu_8                -1.439677e-01 1 1  ON 8
 uu_9                -1.153293e-01 1 1  ON 9
 ud_0                 4.394444e-01 1 1  ON 10
 ud_1                 1.823829e-01 1 1  ON 11
 ud_2                 6.780779e-02 1 1  ON 12
 ud_3                -2.207828e-03 1 1  ON 13
 ud_4                -5.843460e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315261e-01 1 1  ON 16
 ud_7                -1.520052e-01 1 1  ON 17
 ud_8                -1.563907e-01 1 1  ON 18
 ud_9                -1.471436e-01 1 1  ON 19
 eO_0                -7.468210e-01 1 1  ON 20
 eO_1                -4.302564e-01 1 1  ON 21
 eO_2                -9.794912e-03 1 1  ON 22
 eO_3                 3.127367e-01 1 1  ON 23
 eO_4                 5.355816e-01 1 1  ON 24
 eO_5                 4.915888e-01 1 1  ON 25
 eO_6                 2.531025e-01 1 1  ON 26
 eO_7                -5.526560e-02 1 1  ON 27
 eO_8                -2.426033e-01 1 1  ON 28
 eO_9                -1.044820e-01 1 1  ON 29
eH1_0                -2.719640e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207973e-01 1 1  ON 32
eH1_3                -6.725543e-02 1 1  ON 33
eH1_4                -7.659151e-03 1 1  ON 34
eH1_5                 3.700884e-02 1 1  ON 35
eH1_6                 1.087607e-01 1 1  ON 36
eH1_7                 1.757072e-01 1 1  ON 37
eH1_8                 2.082793e-01 1 1  ON 38
eH1_9                 9.945505e-02 1 1  ON 39
eH2_0                -2.698262e-01 1 1  ON 40
eH2_1                -1.627295e-01 1 1  ON 41
eH2_2                -1.186834e-01 1 1  ON 42
eH2_3                -6.516171e-02 1 1  ON 43
eH2_4                -5.521155e-03 1 1  ON 44
eH2_5                 3.994620e-02 1 1  ON 45
eH2_6                 1.099934e-01 1 1  ON 46
eH2_7                 1.743954e-01 1 1  ON 47
eH2_8                 2.119043e-01 1 1  ON 48
eH2_9                 9.508381e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.183461
====================================================
  Execution time = 2.7374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3512e-01
  Total weights = 2.0000e+06
  Execution time = 3.4593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152194308
                                         uncertainty =       0.004466840053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152194308
                                         uncertainty =       0.004466840053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409348863
  error estimate for blocks of size 2^( 2) =       0.000421501713
  error estimate for blocks of size 2^( 3) =       0.000433487944
  error estimate for blocks of size 2^( 4) =       0.000445113996
  error estimate for blocks of size 2^( 5) =       0.000455429289
  error estimate for blocks of size 2^( 6) =       0.000463218385
  error estimate for blocks of size 2^( 7) =       0.000467950862

      target function =                  N/A
              le_mean =     -16.911005240004
             les_mean =     286.317231043610
             stat err =       0.000457928133
             autocorr =       1.251432626898
              std dev =       0.578906714193
             le_variance =       0.335132983738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335106149537
                                         uncertainty =       0.004466440341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335106149537
                                         uncertainty =       0.004466440341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409320748
  error estimate for blocks of size 2^( 2) =       0.000421475146
  error estimate for blocks of size 2^( 3) =       0.000433462731
  error estimate for blocks of size 2^( 4) =       0.000445089359
  error estimate for blocks of size 2^( 5) =       0.000455405574
  error estimate for blocks of size 2^( 6) =       0.000463195629
  error estimate for blocks of size 2^( 7) =       0.000467929213

      target function =                  N/A
              le_mean =     -16.911004988080
             les_mean =     286.317176489312
             stat err =       0.000457904944
             autocorr =       1.251477788642
              std dev =       0.578866953603
             le_variance =       0.335086949974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335127418269
                                         uncertainty =       0.004466632391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335127418269
                                         uncertainty =       0.004466632391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333736
  error estimate for blocks of size 2^( 2) =       0.000421487420
  error estimate for blocks of size 2^( 3) =       0.000433474384
  error estimate for blocks of size 2^( 4) =       0.000445100734
  error estimate for blocks of size 2^( 5) =       0.000455416520
  error estimate for blocks of size 2^( 6) =       0.000463206133
  error estimate for blocks of size 2^( 7) =       0.000467939198

      target function =                  N/A
              le_mean =     -16.911005099893
             les_mean =     286.317201535085
             stat err =       0.000457915646
             autocorr =       1.251456875387
              std dev =       0.578885320290
             le_variance =       0.335108214048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149036413
                                         uncertainty =       0.004466813835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149036413
                                         uncertainty =       0.004466813835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409346935
  error estimate for blocks of size 2^( 2) =       0.000421499891
  error estimate for blocks of size 2^( 3) =       0.000433486216
  error estimate for blocks of size 2^( 4) =       0.000445112305
  error estimate for blocks of size 2^( 5) =       0.000455427661
  error estimate for blocks of size 2^( 6) =       0.000463216823
  error estimate for blocks of size 2^( 7) =       0.000467949375

      target function =                  N/A
              le_mean =     -16.911005221763
             les_mean =     286.317227269611
             stat err =       0.000457926541
             autocorr =       1.251435713839
              std dev =       0.578903987434
             le_variance =       0.335129826668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911005240004        initial  <--
     3.9062e+00     3.9062e+01             4.7962e-05       -16.911004988080
     1.5625e+01     1.5625e+02             1.2010e-05       -16.911005099893
     6.2500e+01     6.2500e+02             3.0038e-06       -16.911005221763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7719
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.24811
====================================================
  Execution time = 2.7917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3352e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333638827566
                                         uncertainty =       0.006160015135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333638827566
                                         uncertainty =       0.006160015135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408363787
  error estimate for blocks of size 2^( 2) =       0.000420393688
  error estimate for blocks of size 2^( 3) =       0.000432774972
  error estimate for blocks of size 2^( 4) =       0.000444496712
  error estimate for blocks of size 2^( 5) =       0.000455130210
  error estimate for blocks of size 2^( 6) =       0.000460746477
  error estimate for blocks of size 2^( 7) =       0.000467480816

      target function =                  N/A
              le_mean =     -16.911019343927
             les_mean =     286.316097048684
             stat err =       0.000456963554
             autocorr =       1.252185531943
              std dev =       0.577513605712
             le_variance =       0.333521964782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691101934393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911019343927       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911019360151       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911019377726       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911019385745       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911019382872       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911019385459       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911019383469       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.992209e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911019343927       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911019348006       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911019352436       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911019354443       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911019353723       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911019354371       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911019353877       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.249600e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911019343927       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911019344948       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911019346058       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911019346560       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911019346380       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911019346542       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911019346419       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.124964e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5123e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.109031e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815852e-02 1 1  ON 2
 uu_3                -1.575798e-02 1 1  ON 3
 uu_4                -6.690901e-02 1 1  ON 4
 uu_5                -1.052504e-01 1 1  ON 5
 uu_6                -1.345527e-01 1 1  ON 6
 uu_7                -1.501782e-01 1 1  ON 7
 uu_8                -1.439594e-01 1 1  ON 8
 uu_9                -1.153300e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823818e-01 1 1  ON 11
 ud_2                 6.780162e-02 1 1  ON 12
 ud_3                -2.207982e-03 1 1  ON 13
 ud_4                -5.843393e-02 1 1  ON 14
 ud_5                -1.017283e-01 1 1  ON 15
 ud_6                -1.315315e-01 1 1  ON 16
 ud_7                -1.520019e-01 1 1  ON 17
 ud_8                -1.563869e-01 1 1  ON 18
 ud_9                -1.471496e-01 1 1  ON 19
 eO_0                -7.468213e-01 1 1  ON 20
 eO_1                -4.302585e-01 1 1  ON 21
 eO_2                -9.799416e-03 1 1  ON 22
 eO_3                 3.127327e-01 1 1  ON 23
 eO_4                 5.355800e-01 1 1  ON 24
 eO_5                 4.915907e-01 1 1  ON 25
 eO_6                 2.530977e-01 1 1  ON 26
 eO_7                -5.526173e-02 1 1  ON 27
 eO_8                -2.425960e-01 1 1  ON 28
 eO_9                -1.044773e-01 1 1  ON 29
eH1_0                -2.719577e-01 1 1  ON 30
eH1_1                -1.648255e-01 1 1  ON 31
eH1_2                -1.207914e-01 1 1  ON 32
eH1_3                -6.725100e-02 1 1  ON 33
eH1_4                -7.647896e-03 1 1  ON 34
eH1_5                 3.700416e-02 1 1  ON 35
eH1_6                 1.087608e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082714e-01 1 1  ON 38
eH1_9                 9.944429e-02 1 1  ON 39
eH2_0                -2.698171e-01 1 1  ON 40
eH2_1                -1.627237e-01 1 1  ON 41
eH2_2                -1.186813e-01 1 1  ON 42
eH2_3                -6.515921e-02 1 1  ON 43
eH2_4                -5.518743e-03 1 1  ON 44
eH2_5                 3.995054e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119008e-01 1 1  ON 48
eH2_9                 9.507314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.379393
====================================================
  Execution time = 2.7372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4612e-01
  Total weights = 2.0000e+06
  Execution time = 3.4641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854337533
                                         uncertainty =       0.010861119321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854337533
                                         uncertainty =       0.010861119321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416006196
  error estimate for blocks of size 2^( 2) =       0.000427715316
  error estimate for blocks of size 2^( 3) =       0.000439325540
  error estimate for blocks of size 2^( 4) =       0.000450735811
  error estimate for blocks of size 2^( 5) =       0.000459249203
  error estimate for blocks of size 2^( 6) =       0.000465665492
  error estimate for blocks of size 2^( 7) =       0.000473180113

      target function =                  N/A
              le_mean =     -16.911358324173
             les_mean =     286.340162505704
             stat err =       0.000462207655
             autocorr =       1.234453311997
              std dev =       0.588321604375
             le_variance =       0.346122310174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854449623
                                         uncertainty =       0.010860927327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854449623
                                         uncertainty =       0.010860927327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416006263
  error estimate for blocks of size 2^( 2) =       0.000427715392
  error estimate for blocks of size 2^( 3) =       0.000439325619
  error estimate for blocks of size 2^( 4) =       0.000450735879
  error estimate for blocks of size 2^( 5) =       0.000459249261
  error estimate for blocks of size 2^( 6) =       0.000465665509
  error estimate for blocks of size 2^( 7) =       0.000473179997

      target function =                  N/A
              le_mean =     -16.911358312928
             les_mean =     286.340162237286
             stat err =       0.000462207662
             autocorr =       1.234452949124
              std dev =       0.588321699501
             le_variance =       0.346122422103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854396012
                                         uncertainty =       0.010861022715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854396012
                                         uncertainty =       0.010861022715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416006231
  error estimate for blocks of size 2^( 2) =       0.000427715355
  error estimate for blocks of size 2^( 3) =       0.000439325581
  error estimate for blocks of size 2^( 4) =       0.000450735846
  error estimate for blocks of size 2^( 5) =       0.000459249233
  error estimate for blocks of size 2^( 6) =       0.000465665502
  error estimate for blocks of size 2^( 7) =       0.000473180055

      target function =                  N/A
              le_mean =     -16.911358318424
             les_mean =     286.340162369649
             stat err =       0.000462207659
             autocorr =       1.234453127185
              std dev =       0.588321654007
             le_variance =       0.346122368574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854344909
                                         uncertainty =       0.010861107226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345854344909
                                         uncertainty =       0.010861107226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416006200
  error estimate for blocks of size 2^( 2) =       0.000427715321
  error estimate for blocks of size 2^( 3) =       0.000439325545
  error estimate for blocks of size 2^( 4) =       0.000450735815
  error estimate for blocks of size 2^( 5) =       0.000459249207
  error estimate for blocks of size 2^( 6) =       0.000465665493
  error estimate for blocks of size 2^( 7) =       0.000473180106

      target function =                  N/A
              le_mean =     -16.911358323449
             les_mean =     286.340162488575
             stat err =       0.000462207655
             autocorr =       1.234453288785
              std dev =       0.588321610635
             le_variance =       0.346122317540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911358324173        initial  <--
     3.9062e+01     3.9062e+02             4.9922e-06       -16.911358312928
     1.5625e+02     1.5625e+03             1.2496e-06       -16.911358318424
     6.2500e+02     6.2500e+03             3.1250e-07       -16.911358323449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7439
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.288715
====================================================
  Execution time = 2.7848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317771321
                                         uncertainty =       0.003041267257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317771321
                                         uncertainty =       0.003041267257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405763540
  error estimate for blocks of size 2^( 2) =       0.000417314426
  error estimate for blocks of size 2^( 3) =       0.000428643398
  error estimate for blocks of size 2^( 4) =       0.000440063398
  error estimate for blocks of size 2^( 5) =       0.000448606012
  error estimate for blocks of size 2^( 6) =       0.000455832564
  error estimate for blocks of size 2^( 7) =       0.000460509099

      target function =                  N/A
              le_mean =     -16.910486314107
             les_mean =     286.293835316378
             stat err =       0.000451252768
             autocorr =       1.236783595758
              std dev =       0.573836301927
             le_variance =       0.329288101409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691048631411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486314107       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486313768       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486312493       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486313240       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486314373       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486314250       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486314139       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.968863e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486314107       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486314022       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486313703       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486313890       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486314173       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486314142       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486314115       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.242303e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910486314107       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910486314086       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910486314006       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910486314051       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910486314125       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910486314115       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910486314108       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.105813e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4997e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815930e-02 1 1  ON 2
 uu_3                -1.575840e-02 1 1  ON 3
 uu_4                -6.690901e-02 1 1  ON 4
 uu_5                -1.052504e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153297e-01 1 1  ON 9
 ud_0                 4.394527e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780128e-02 1 1  ON 12
 ud_3                -2.208380e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017280e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563863e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468217e-01 1 1  ON 20
 eO_1                -4.302595e-01 1 1  ON 21
 eO_2                -9.798683e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526146e-02 1 1  ON 27
 eO_8                -2.425953e-01 1 1  ON 28
 eO_9                -1.044767e-01 1 1  ON 29
eH1_0                -2.719573e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647507e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087611e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082705e-01 1 1  ON 38
eH1_9                 9.944315e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515884e-02 1 1  ON 43
eH2_4                -5.518497e-03 1 1  ON 44
eH2_5                 3.995123e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119002e-01 1 1  ON 48
eH2_9                 9.507206e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9792
    reference variance = 0.330172
====================================================
  Execution time = 2.7324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.0000e+06
  Execution time = 3.4733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095343411
                                         uncertainty =       0.003106083781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095343411
                                         uncertainty =       0.003106083781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407528401
  error estimate for blocks of size 2^( 2) =       0.000419402639
  error estimate for blocks of size 2^( 3) =       0.000431310248
  error estimate for blocks of size 2^( 4) =       0.000442904872
  error estimate for blocks of size 2^( 5) =       0.000452037590
  error estimate for blocks of size 2^( 6) =       0.000458479933
  error estimate for blocks of size 2^( 7) =       0.000464428651

      target function =                  N/A
              le_mean =     -16.910456052032
             les_mean =     286.295682516080
             stat err =       0.000454462761
             autocorr =       1.243600379389
              std dev =       0.576332191066
             le_variance =       0.332158794459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095517323
                                         uncertainty =       0.003106085919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095517323
                                         uncertainty =       0.003106085919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407528507
  error estimate for blocks of size 2^( 2) =       0.000419402742
  error estimate for blocks of size 2^( 3) =       0.000431310349
  error estimate for blocks of size 2^( 4) =       0.000442904966
  error estimate for blocks of size 2^( 5) =       0.000452037681
  error estimate for blocks of size 2^( 6) =       0.000458480028
  error estimate for blocks of size 2^( 7) =       0.000464428744

      target function =                  N/A
              le_mean =     -16.910456051263
             les_mean =     286.295682663900
             stat err =       0.000454462855
             autocorr =       1.243600239311
              std dev =       0.576332341876
             le_variance =       0.332158968293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095430439
                                         uncertainty =       0.003106084851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095430439
                                         uncertainty =       0.003106084851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407528454
  error estimate for blocks of size 2^( 2) =       0.000419402690
  error estimate for blocks of size 2^( 3) =       0.000431310298
  error estimate for blocks of size 2^( 4) =       0.000442904919
  error estimate for blocks of size 2^( 5) =       0.000452037635
  error estimate for blocks of size 2^( 6) =       0.000458479981
  error estimate for blocks of size 2^( 7) =       0.000464428697

      target function =                  N/A
              le_mean =     -16.910456051647
             les_mean =     286.295682590043
             stat err =       0.000454462808
             autocorr =       1.243600309288
              std dev =       0.576332266534
             le_variance =       0.332158881448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095354292
                                         uncertainty =       0.003106083914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095354292
                                         uncertainty =       0.003106083914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407528407
  error estimate for blocks of size 2^( 2) =       0.000419402645
  error estimate for blocks of size 2^( 3) =       0.000431310254
  error estimate for blocks of size 2^( 4) =       0.000442904877
  error estimate for blocks of size 2^( 5) =       0.000452037595
  error estimate for blocks of size 2^( 6) =       0.000458479939
  error estimate for blocks of size 2^( 7) =       0.000464428656

      target function =                  N/A
              le_mean =     -16.910456051984
             les_mean =     286.295682525327
             stat err =       0.000454462767
             autocorr =       1.243600370624
              std dev =       0.576332200501
             le_variance =       0.332158805335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910456052032        initial  <--
     3.9062e+02     3.9062e+03             4.9689e-07       -16.910456051263
     1.5625e+03     1.5625e+04             1.2423e-07       -16.910456051647
     6.2500e+03     6.2500e+04             3.1058e-08       -16.910456051984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7254
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0232
    reference variance = 0.535678
====================================================
  Execution time = 3.0352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331532255928
                                         uncertainty =       0.003145372515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331532255928
                                         uncertainty =       0.003145372515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090258
  error estimate for blocks of size 2^( 2) =       0.000418992837
  error estimate for blocks of size 2^( 3) =       0.000430877348
  error estimate for blocks of size 2^( 4) =       0.000441992051
  error estimate for blocks of size 2^( 5) =       0.000451948803
  error estimate for blocks of size 2^( 6) =       0.000460240197
  error estimate for blocks of size 2^( 7) =       0.000464003661

      target function =                  N/A
              le_mean =     -16.910888104948
             les_mean =     286.309581288715
             stat err =       0.000454546178
             autocorr =       1.246736292451
              std dev =       0.575712564005
             le_variance =       0.331444956353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691088810495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910888104948       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910888104991       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910888104922       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910888104999       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910888104973       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910888105009       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910888104935       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.154746e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910888104948       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910888104959       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910888104942       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910888104961       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910888104952       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910888104959       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910888104946       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.288694e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910888104948       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910888104951       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910888104947       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910888104946       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910888104950       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910888104952       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910888104962       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 3.221740e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7550e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208410e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798733e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425952e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647484e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944306e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518464e-03 1 1  ON 44
eH2_5                 3.995130e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507199e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9269
    reference variance = 0.151837
====================================================
  Execution time = 2.7776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.0000e+06
  Execution time = 3.4825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750572424
                                         uncertainty =       0.004208622421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750572424
                                         uncertainty =       0.004208622421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409055098
  error estimate for blocks of size 2^( 2) =       0.000420908741
  error estimate for blocks of size 2^( 3) =       0.000433802224
  error estimate for blocks of size 2^( 4) =       0.000446362758
  error estimate for blocks of size 2^( 5) =       0.000457893324
  error estimate for blocks of size 2^( 6) =       0.000468529884
  error estimate for blocks of size 2^( 7) =       0.000475643042

      target function =                  N/A
              le_mean =     -16.910185434561
             les_mean =     286.289023410595
             stat err =       0.000462107252
             autocorr =       1.276209427563
              std dev =       0.578491267590
             le_variance =       0.334652146678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750530164
                                         uncertainty =       0.004208621929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750530164
                                         uncertainty =       0.004208621929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409055072
  error estimate for blocks of size 2^( 2) =       0.000420908716
  error estimate for blocks of size 2^( 3) =       0.000433802200
  error estimate for blocks of size 2^( 4) =       0.000446362734
  error estimate for blocks of size 2^( 5) =       0.000457893300
  error estimate for blocks of size 2^( 6) =       0.000468529861
  error estimate for blocks of size 2^( 7) =       0.000475643020

      target function =                  N/A
              le_mean =     -16.910185434265
             les_mean =     286.289023358355
             stat err =       0.000462107229
             autocorr =       1.276209461426
              std dev =       0.578491231082
             le_variance =       0.334652104439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750551293
                                         uncertainty =       0.004208622175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750551293
                                         uncertainty =       0.004208622175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409055085
  error estimate for blocks of size 2^( 2) =       0.000420908729
  error estimate for blocks of size 2^( 3) =       0.000433802212
  error estimate for blocks of size 2^( 4) =       0.000446362746
  error estimate for blocks of size 2^( 5) =       0.000457893312
  error estimate for blocks of size 2^( 6) =       0.000468529873
  error estimate for blocks of size 2^( 7) =       0.000475643031

      target function =                  N/A
              le_mean =     -16.910185434413
             les_mean =     286.289023384473
             stat err =       0.000462107240
             autocorr =       1.276209444495
              std dev =       0.578491249335
             le_variance =       0.334652125557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750569783
                                         uncertainty =       0.004208622390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334750569783
                                         uncertainty =       0.004208622390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409055097
  error estimate for blocks of size 2^( 2) =       0.000420908740
  error estimate for blocks of size 2^( 3) =       0.000433802223
  error estimate for blocks of size 2^( 4) =       0.000446362757
  error estimate for blocks of size 2^( 5) =       0.000457893322
  error estimate for blocks of size 2^( 6) =       0.000468529883
  error estimate for blocks of size 2^( 7) =       0.000475643040

      target function =                  N/A
              le_mean =     -16.910185434543
             les_mean =     286.289023407330
             stat err =       0.000462107250
             autocorr =       1.276209429677
              std dev =       0.578491265308
             le_variance =       0.334652144038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910185434561        initial  <--
     3.9062e+03     3.9062e+04             5.1547e-08       -16.910185434265
     1.5625e+04     1.5625e+05             1.2887e-08       -16.910185434413
     6.2500e+04     6.2500e+05             3.2217e-09       -16.910185434543

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3391
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208411e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647480e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9406
    reference variance = 0.201518
====================================================
  Execution time = 2.8420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4175e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341738562590
                                         uncertainty =       0.004858790399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341738562590
                                         uncertainty =       0.004858790399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413372461
  error estimate for blocks of size 2^( 2) =       0.000424597934
  error estimate for blocks of size 2^( 3) =       0.000436636537
  error estimate for blocks of size 2^( 4) =       0.000447497893
  error estimate for blocks of size 2^( 5) =       0.000456535176
  error estimate for blocks of size 2^( 6) =       0.000462238330
  error estimate for blocks of size 2^( 7) =       0.000468736667

      target function =                  N/A
              le_mean =     -16.911110696014
             les_mean =     286.327418384229
             stat err =       0.000458752017
             autocorr =       1.231609110377
              std dev =       0.584596940003
             le_variance =       0.341753582261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691111069601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911110696014       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911110696033       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911110696039       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911110696045       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911110696068       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911110696029       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911110696026       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911110696028       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.448493e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911110696014       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911110696019       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911110696020       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911110696110       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911110696082       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911110696154       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911110696058       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911110696128       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.112124e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911110696014       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911110696015       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911110696016       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911110696016       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911110696017       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911110695539       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911110696224       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911110696050       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 2.780311e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5645e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780122e-02 1 1  ON 12
 ud_3                -2.208410e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798739e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647481e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944304e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9319
    reference variance = 0.174824
====================================================
  Execution time = 2.7832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.9373e-01
  Total weights = 2.0000e+06
  Execution time = 3.4773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671148
                                         uncertainty =       0.064149372681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671148
                                         uncertainty =       0.064149372681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443697119
  error estimate for blocks of size 2^( 2) =       0.000454605871
  error estimate for blocks of size 2^( 3) =       0.000466228372
  error estimate for blocks of size 2^( 4) =       0.000477825998
  error estimate for blocks of size 2^( 5) =       0.000487990717
  error estimate for blocks of size 2^( 6) =       0.000495558071
  error estimate for blocks of size 2^( 7) =       0.000500416086

      target function =                  N/A
              le_mean =     -16.910917933853
             les_mean =     286.372879435412
             stat err =       0.000490447718
             autocorr =       1.221834035228
              std dev =       0.627482483248
             le_variance =       0.393734266783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671911
                                         uncertainty =       0.064149372687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671911
                                         uncertainty =       0.064149372687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443697119
  error estimate for blocks of size 2^( 2) =       0.000454605871
  error estimate for blocks of size 2^( 3) =       0.000466228372
  error estimate for blocks of size 2^( 4) =       0.000477825998
  error estimate for blocks of size 2^( 5) =       0.000487990718
  error estimate for blocks of size 2^( 6) =       0.000495558071
  error estimate for blocks of size 2^( 7) =       0.000500416086

      target function =                  N/A
              le_mean =     -16.910917933856
             les_mean =     286.372879436311
             stat err =       0.000490447718
             autocorr =       1.221834034521
              std dev =       0.627482483859
             le_variance =       0.393734267549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671529
                                         uncertainty =       0.064149372684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671529
                                         uncertainty =       0.064149372684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443697119
  error estimate for blocks of size 2^( 2) =       0.000454605871
  error estimate for blocks of size 2^( 3) =       0.000466228372
  error estimate for blocks of size 2^( 4) =       0.000477825998
  error estimate for blocks of size 2^( 5) =       0.000487990717
  error estimate for blocks of size 2^( 6) =       0.000495558071
  error estimate for blocks of size 2^( 7) =       0.000500416086

      target function =                  N/A
              le_mean =     -16.910917933855
             les_mean =     286.372879435861
             stat err =       0.000490447718
             autocorr =       1.221834034877
              std dev =       0.627482483553
             le_variance =       0.393734267166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671195
                                         uncertainty =       0.064149372681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393533671195
                                         uncertainty =       0.064149372681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443697119
  error estimate for blocks of size 2^( 2) =       0.000454605871
  error estimate for blocks of size 2^( 3) =       0.000466228372
  error estimate for blocks of size 2^( 4) =       0.000477825998
  error estimate for blocks of size 2^( 5) =       0.000487990717
  error estimate for blocks of size 2^( 6) =       0.000495558071
  error estimate for blocks of size 2^( 7) =       0.000500416086

      target function =                  N/A
              le_mean =     -16.910917933853
             les_mean =     286.372879435468
             stat err =       0.000490447718
             autocorr =       1.221834035181
              std dev =       0.627482483286
             le_variance =       0.393734266831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910917933853        initial
     3.9062e+04     3.9062e+05             4.4485e-09       -16.910917933856  <--
     1.5625e+05     1.5625e+06             1.1121e-09       -16.910917933855
     6.2500e+05     6.2500e+06             2.7803e-10       -16.910917933853

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 4.5372e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208408e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798737e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425951e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647481e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944305e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518466e-03 1 1  ON 44
eH2_5                 3.995131e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.476075
====================================================
  Execution time = 2.8569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330301612275
                                         uncertainty =       0.003258708510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330301612275
                                         uncertainty =       0.003258708510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406378417
  error estimate for blocks of size 2^( 2) =       0.000418204750
  error estimate for blocks of size 2^( 3) =       0.000430440104
  error estimate for blocks of size 2^( 4) =       0.000441740457
  error estimate for blocks of size 2^( 5) =       0.000452760740
  error estimate for blocks of size 2^( 6) =       0.000461859926
  error estimate for blocks of size 2^( 7) =       0.000466312286

      target function =                  N/A
              le_mean =     -16.910879648912
             les_mean =     286.308137169825
             stat err =       0.000455668352
             autocorr =       1.257292905388
              std dev =       0.574705868239
             le_variance =       0.330286834989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691087964891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910879648912       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910879648912       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910879648915       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910879648865       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910879648842       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910879648850       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910879648870       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.191516e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910879648912       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910879648912       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910879648913       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910879648898       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910879648908       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910879648900       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910879648899       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.478807e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910879648912       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910879648912       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910879648912       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910879648909       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910879649011       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910879649153       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910879648929       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.369703e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5663e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208407e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798738e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425952e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648249e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725065e-02 1 1  ON 33
eH1_4                -7.647483e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757058e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944305e-02 1 1  ON 39
eH2_0                -2.698167e-01 1 1  ON 40
eH2_1                -1.627238e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518467e-03 1 1  ON 44
eH2_5                 3.995130e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507199e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9377
    reference variance = 0.208848
====================================================
  Execution time = 2.7754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3058e-01
  Total weights = 2.0000e+06
  Execution time = 3.4769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601511394
                                         uncertainty =       0.003042262231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601511394
                                         uncertainty =       0.003042262231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406556703
  error estimate for blocks of size 2^( 2) =       0.000418167118
  error estimate for blocks of size 2^( 3) =       0.000430668815
  error estimate for blocks of size 2^( 4) =       0.000442008889
  error estimate for blocks of size 2^( 5) =       0.000452418877
  error estimate for blocks of size 2^( 6) =       0.000459733410
  error estimate for blocks of size 2^( 7) =       0.000463657695

      target function =                  N/A
              le_mean =     -16.910751186750
             les_mean =     286.304082240270
             stat err =       0.000454454718
             autocorr =       1.249507826403
              std dev =       0.574958003152
             le_variance =       0.330576705388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601514517
                                         uncertainty =       0.003042262243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601514517
                                         uncertainty =       0.003042262243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406556705
  error estimate for blocks of size 2^( 2) =       0.000418167120
  error estimate for blocks of size 2^( 3) =       0.000430668816
  error estimate for blocks of size 2^( 4) =       0.000442008890
  error estimate for blocks of size 2^( 5) =       0.000452418878
  error estimate for blocks of size 2^( 6) =       0.000459733411
  error estimate for blocks of size 2^( 7) =       0.000463657696

      target function =                  N/A
              le_mean =     -16.910751186792
             les_mean =     286.304082244815
             stat err =       0.000454454719
             autocorr =       1.249507823147
              std dev =       0.574958005869
             le_variance =       0.330576708513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601512955
                                         uncertainty =       0.003042262237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601512955
                                         uncertainty =       0.003042262237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406556704
  error estimate for blocks of size 2^( 2) =       0.000418167119
  error estimate for blocks of size 2^( 3) =       0.000430668816
  error estimate for blocks of size 2^( 4) =       0.000442008889
  error estimate for blocks of size 2^( 5) =       0.000452418878
  error estimate for blocks of size 2^( 6) =       0.000459733410
  error estimate for blocks of size 2^( 7) =       0.000463657696

      target function =                  N/A
              le_mean =     -16.910751186771
             les_mean =     286.304082242543
             stat err =       0.000454454718
             autocorr =       1.249507824773
              std dev =       0.574958004510
             le_variance =       0.330576706950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601511589
                                         uncertainty =       0.003042262232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330601511589
                                         uncertainty =       0.003042262232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406556703
  error estimate for blocks of size 2^( 2) =       0.000418167118
  error estimate for blocks of size 2^( 3) =       0.000430668815
  error estimate for blocks of size 2^( 4) =       0.000442008889
  error estimate for blocks of size 2^( 5) =       0.000452418877
  error estimate for blocks of size 2^( 6) =       0.000459733410
  error estimate for blocks of size 2^( 7) =       0.000463657695

      target function =                  N/A
              le_mean =     -16.910751186753
             les_mean =     286.304082240554
             stat err =       0.000454454718
             autocorr =       1.249507826208
              std dev =       0.574958003321
             le_variance =       0.330576705583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910751186750        initial
     9.7656e+03     9.7656e+04             2.1915e-08       -16.910751186792  <--
     3.9062e+04     3.9062e+05             5.4788e-09       -16.910751186771
     1.5625e+05     1.5625e+06             1.3697e-09       -16.910751186753

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 4.5124e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208404e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302596e-01 1 1  ON 21
 eO_2                -9.798740e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425952e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725066e-02 1 1  ON 33
eH1_4                -7.647488e-03 1 1  ON 34
eH1_5                 3.700387e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944306e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627238e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515881e-02 1 1  ON 43
eH2_4                -5.518470e-03 1 1  ON 44
eH2_5                 3.995129e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119001e-01 1 1  ON 48
eH2_9                 9.507200e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.187367
====================================================
  Execution time = 2.8504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349482459258
                                         uncertainty =       0.009966855414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349482459258
                                         uncertainty =       0.009966855414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417968741
  error estimate for blocks of size 2^( 2) =       0.000429384756
  error estimate for blocks of size 2^( 3) =       0.000441642670
  error estimate for blocks of size 2^( 4) =       0.000453531234
  error estimate for blocks of size 2^( 5) =       0.000464052136
  error estimate for blocks of size 2^( 6) =       0.000472520013
  error estimate for blocks of size 2^( 7) =       0.000477132779

      target function =                  N/A
              le_mean =     -16.910565713359
             les_mean =     286.316628307436
             stat err =       0.000466809040
             autocorr =       1.247357409475
              std dev =       0.591097061664
             le_variance =       0.349395736307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691056571336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910565713359       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910565713363       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910565713431       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910565713363       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910565713385       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910565713270       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910565713367       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910565713360       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.020396e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910565713359       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910565713360       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910565713377       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910565713359       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910565713366       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910565713337       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910565713359       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910565713325       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.551000e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910565713359       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910565713359       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910565713363       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910565713359       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910565713339       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910565713346       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910565713356       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910565713353       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.377508e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5633e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460879e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690905e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345519e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208397e-03 1 1  ON 13
 ud_4                -5.843368e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302595e-01 1 1  ON 21
 eO_2                -9.798742e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425952e-01 1 1  ON 28
 eO_9                -1.044766e-01 1 1  ON 29
eH1_0                -2.719572e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725067e-02 1 1  ON 33
eH1_4                -7.647498e-03 1 1  ON 34
eH1_5                 3.700388e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082704e-01 1 1  ON 38
eH1_9                 9.944308e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515882e-02 1 1  ON 43
eH2_4                -5.518471e-03 1 1  ON 44
eH2_5                 3.995128e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119002e-01 1 1  ON 48
eH2_9                 9.507203e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.445559
====================================================
  Execution time = 2.7731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.0000e+06
  Execution time = 3.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832088507
                                         uncertainty =       0.008201218263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832088507
                                         uncertainty =       0.008201218263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412791943
  error estimate for blocks of size 2^( 2) =       0.000424253445
  error estimate for blocks of size 2^( 3) =       0.000436291371
  error estimate for blocks of size 2^( 4) =       0.000447144087
  error estimate for blocks of size 2^( 5) =       0.000456718725
  error estimate for blocks of size 2^( 6) =       0.000462633217
  error estimate for blocks of size 2^( 7) =       0.000465252931

      target function =                  N/A
              le_mean =     -16.909729335127
             les_mean =     286.279740392923
             stat err =       0.000457937240
             autocorr =       1.230692349351
              std dev =       0.583775963939
             le_variance =       0.340794376073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832047674
                                         uncertainty =       0.008201217907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832047674
                                         uncertainty =       0.008201217907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412791918
  error estimate for blocks of size 2^( 2) =       0.000424253422
  error estimate for blocks of size 2^( 3) =       0.000436291349
  error estimate for blocks of size 2^( 4) =       0.000447144067
  error estimate for blocks of size 2^( 5) =       0.000456718707
  error estimate for blocks of size 2^( 6) =       0.000462633199
  error estimate for blocks of size 2^( 7) =       0.000465252912

      target function =                  N/A
              le_mean =     -16.909729335411
             les_mean =     286.279740361666
             stat err =       0.000457937221
             autocorr =       1.230692397144
              std dev =       0.583775928948
             le_variance =       0.340794335220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832068088
                                         uncertainty =       0.008201218085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832068088
                                         uncertainty =       0.008201218085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412791930
  error estimate for blocks of size 2^( 2) =       0.000424253433
  error estimate for blocks of size 2^( 3) =       0.000436291360
  error estimate for blocks of size 2^( 4) =       0.000447144077
  error estimate for blocks of size 2^( 5) =       0.000456718716
  error estimate for blocks of size 2^( 6) =       0.000462633208
  error estimate for blocks of size 2^( 7) =       0.000465252921

      target function =                  N/A
              le_mean =     -16.909729335269
             les_mean =     286.279740377293
             stat err =       0.000457937231
             autocorr =       1.230692373247
              std dev =       0.583775946442
             le_variance =       0.340794355644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832085955
                                         uncertainty =       0.008201218241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340832085955
                                         uncertainty =       0.008201218241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412791941
  error estimate for blocks of size 2^( 2) =       0.000424253443
  error estimate for blocks of size 2^( 3) =       0.000436291369
  error estimate for blocks of size 2^( 4) =       0.000447144085
  error estimate for blocks of size 2^( 5) =       0.000456718724
  error estimate for blocks of size 2^( 6) =       0.000462633216
  error estimate for blocks of size 2^( 7) =       0.000465252929

      target function =                  N/A
              le_mean =     -16.909729335145
             les_mean =     286.279740390970
             stat err =       0.000457937239
             autocorr =       1.230692352339
              std dev =       0.583775961752
             le_variance =       0.340794373519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909729335127        initial
     2.4414e+03     2.4414e+04             1.0204e-07       -16.909729335411  <--
     9.7656e+03     9.7656e+04             2.5510e-08       -16.909729335269
     3.9062e+04     3.9062e+05             6.3775e-09       -16.909729335145

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 4.5806e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460878e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575843e-02 1 1  ON 3
 uu_4                -6.690905e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780124e-02 1 1  ON 12
 ud_3                -2.208378e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017281e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468218e-01 1 1  ON 20
 eO_1                -4.302595e-01 1 1  ON 21
 eO_2                -9.798750e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425952e-01 1 1  ON 28
 eO_9                -1.044767e-01 1 1  ON 29
eH1_0                -2.719573e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725068e-02 1 1  ON 33
eH1_4                -7.647531e-03 1 1  ON 34
eH1_5                 3.700389e-02 1 1  ON 35
eH1_6                 1.087612e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082705e-01 1 1  ON 38
eH1_9                 9.944313e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186806e-01 1 1  ON 42
eH2_3                -6.515884e-02 1 1  ON 43
eH2_4                -5.518476e-03 1 1  ON 44
eH2_5                 3.995124e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743914e-01 1 1  ON 47
eH2_8                 2.119002e-01 1 1  ON 48
eH2_9                 9.507211e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.193263
====================================================
  Execution time = 2.8454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334149463117
                                         uncertainty =       0.003512178081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334149463117
                                         uncertainty =       0.003512178081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408736797
  error estimate for blocks of size 2^( 2) =       0.000420529123
  error estimate for blocks of size 2^( 3) =       0.000432666032
  error estimate for blocks of size 2^( 4) =       0.000444212416
  error estimate for blocks of size 2^( 5) =       0.000454602255
  error estimate for blocks of size 2^( 6) =       0.000463089820
  error estimate for blocks of size 2^( 7) =       0.000467642974

      target function =                  N/A
              le_mean =     -16.910756362245
             les_mean =     286.307812114915
             stat err =       0.000457386866
             autocorr =       1.252217890008
              std dev =       0.578041122029
             le_variance =       0.334131538757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691075636225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910756362245       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910756362402       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910756362539       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910756361862       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910756361986       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910756361933       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910756362062       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910756362040       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.973803e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910756362245       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910756362285       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910756362319       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910756362150       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910756362180       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910756362167       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910756362197       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910756362196       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.934677e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910756362245       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910756362255       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910756362264       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910756362220       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910756362231       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910756362226       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910756362226       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910756362234       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.483680e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5559e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460878e-01 1 1  ON 1
 uu_2                 4.815938e-02 1 1  ON 2
 uu_3                -1.575841e-02 1 1  ON 3
 uu_4                -6.690902e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153296e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780125e-02 1 1  ON 12
 ud_3                -2.208367e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017280e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471494e-01 1 1  ON 19
 eO_0                -7.468217e-01 1 1  ON 20
 eO_1                -4.302594e-01 1 1  ON 21
 eO_2                -9.798738e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530974e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425953e-01 1 1  ON 28
 eO_9                -1.044767e-01 1 1  ON 29
eH1_0                -2.719573e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207909e-01 1 1  ON 32
eH1_3                -6.725070e-02 1 1  ON 33
eH1_4                -7.647564e-03 1 1  ON 34
eH1_5                 3.700390e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082705e-01 1 1  ON 38
eH1_9                 9.944318e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627239e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515886e-02 1 1  ON 43
eH2_4                -5.518514e-03 1 1  ON 44
eH2_5                 3.995118e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119002e-01 1 1  ON 48
eH2_9                 9.507220e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.21939
====================================================
  Execution time = 2.7925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3531e-01
  Total weights = 2.0000e+06
  Execution time = 3.4574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411861061
                                         uncertainty =       0.003875852271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411861061
                                         uncertainty =       0.003875852271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455797
  error estimate for blocks of size 2^( 2) =       0.000421247462
  error estimate for blocks of size 2^( 3) =       0.000433006293
  error estimate for blocks of size 2^( 4) =       0.000444528885
  error estimate for blocks of size 2^( 5) =       0.000453652904
  error estimate for blocks of size 2^( 6) =       0.000458949743
  error estimate for blocks of size 2^( 7) =       0.000460985704

      target function =                  N/A
              le_mean =     -16.909746436901
             les_mean =     286.274832492702
             stat err =       0.000454529309
             autocorr =       1.232280954086
              std dev =       0.579057941894
             le_variance =       0.335308100070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411751136
                                         uncertainty =       0.003875851402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411751136
                                         uncertainty =       0.003875851402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455730
  error estimate for blocks of size 2^( 2) =       0.000421247397
  error estimate for blocks of size 2^( 3) =       0.000433006232
  error estimate for blocks of size 2^( 4) =       0.000444528824
  error estimate for blocks of size 2^( 5) =       0.000453652841
  error estimate for blocks of size 2^( 6) =       0.000458949681
  error estimate for blocks of size 2^( 7) =       0.000460985639

      target function =                  N/A
              le_mean =     -16.909746437171
             les_mean =     286.274832391891
             stat err =       0.000454529246
             autocorr =       1.232281016554
              std dev =       0.579057846969
             le_variance =       0.335307990137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411806078
                                         uncertainty =       0.003875851836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411806078
                                         uncertainty =       0.003875851836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455764
  error estimate for blocks of size 2^( 2) =       0.000421247429
  error estimate for blocks of size 2^( 3) =       0.000433006262
  error estimate for blocks of size 2^( 4) =       0.000444528855
  error estimate for blocks of size 2^( 5) =       0.000453652873
  error estimate for blocks of size 2^( 6) =       0.000458949712
  error estimate for blocks of size 2^( 7) =       0.000460985671

      target function =                  N/A
              le_mean =     -16.909746437036
             les_mean =     286.274832442278
             stat err =       0.000454529277
             autocorr =       1.232280985335
              std dev =       0.579057894413
             le_variance =       0.335308045082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411854188
                                         uncertainty =       0.003875852216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335411854188
                                         uncertainty =       0.003875852216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455793
  error estimate for blocks of size 2^( 2) =       0.000421247458
  error estimate for blocks of size 2^( 3) =       0.000433006289
  error estimate for blocks of size 2^( 4) =       0.000444528881
  error estimate for blocks of size 2^( 5) =       0.000453652901
  error estimate for blocks of size 2^( 6) =       0.000458949739
  error estimate for blocks of size 2^( 7) =       0.000460985700

      target function =                  N/A
              le_mean =     -16.909746436918
             les_mean =     286.274832486399
             stat err =       0.000454529305
             autocorr =       1.232280957989
              std dev =       0.579057935958
             le_variance =       0.335308093196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909746436901        initial
     6.1035e+02     6.1035e+03             3.9738e-07       -16.909746437171  <--
     2.4414e+03     2.4414e+04             9.9347e-08       -16.909746437036
     9.7656e+03     9.7656e+04             2.4837e-08       -16.909746436918

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 4.5291e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815943e-02 1 1  ON 2
 uu_3                -1.575836e-02 1 1  ON 3
 uu_4                -6.690891e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153297e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780126e-02 1 1  ON 12
 ud_3                -2.208334e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468217e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798702e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425954e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719574e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207910e-01 1 1  ON 32
eH1_3                -6.725075e-02 1 1  ON 33
eH1_4                -7.647664e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082706e-01 1 1  ON 38
eH1_9                 9.944335e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515893e-02 1 1  ON 43
eH2_4                -5.518627e-03 1 1  ON 44
eH2_5                 3.995101e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119004e-01 1 1  ON 48
eH2_9                 9.507250e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8905
    reference variance = 0.172118
====================================================
  Execution time = 2.8315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336741182223
                                         uncertainty =       0.005413212516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336741182223
                                         uncertainty =       0.005413212516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356415
  error estimate for blocks of size 2^( 2) =       0.000421818345
  error estimate for blocks of size 2^( 3) =       0.000433541256
  error estimate for blocks of size 2^( 4) =       0.000445000021
  error estimate for blocks of size 2^( 5) =       0.000455153845
  error estimate for blocks of size 2^( 6) =       0.000462801964
  error estimate for blocks of size 2^( 7) =       0.000463849255

      target function =                  N/A
              le_mean =     -16.910553664609
             les_mean =     286.303609850460
             stat err =       0.000456701271
             autocorr =       1.238631118340
              std dev =       0.580331607976
             le_variance =       0.336784775216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691055366461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910553664609       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910553669543       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910553673811       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910553678872       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910553678158       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910553677504       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910553678264       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910553678153       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.141502e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910553664609       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910553665844       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910553666913       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910553668178       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910553668000       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910553667837       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910553668026       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910553667998       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 2.853986e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910553664609       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910553664918       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910553665185       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910553665502       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910553665455       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910553665414       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910553665463       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910553665455       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.135109e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5452e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815948e-02 1 1  ON 2
 uu_3                -1.575826e-02 1 1  ON 3
 uu_4                -6.690889e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345521e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439602e-01 1 1  ON 8
 uu_9                -1.153299e-01 1 1  ON 9
 ud_0                 4.394527e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780139e-02 1 1  ON 12
 ud_3                -2.208253e-03 1 1  ON 13
 ud_4                -5.843372e-02 1 1  ON 14
 ud_5                -1.017277e-01 1 1  ON 15
 ud_6                -1.315318e-01 1 1  ON 16
 ud_7                -1.520018e-01 1 1  ON 17
 ud_8                -1.563864e-01 1 1  ON 18
 ud_9                -1.471497e-01 1 1  ON 19
 eO_0                -7.468214e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798689e-03 1 1  ON 22
 eO_3                 3.127329e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526160e-02 1 1  ON 27
 eO_8                -2.425957e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648251e-01 1 1  ON 31
eH1_2                -1.207910e-01 1 1  ON 32
eH1_3                -6.725101e-02 1 1  ON 33
eH1_4                -7.647688e-03 1 1  ON 34
eH1_5                 3.700393e-02 1 1  ON 35
eH1_6                 1.087614e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944358e-02 1 1  ON 39
eH2_0                -2.698171e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186808e-01 1 1  ON 42
eH2_3                -6.515910e-02 1 1  ON 43
eH2_4                -5.518727e-03 1 1  ON 44
eH2_5                 3.995106e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507272e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8556
    reference variance = 0.181481
====================================================
  Execution time = 2.7895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3613e-01
  Total weights = 2.0000e+06
  Execution time = 3.4586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162326416
                                         uncertainty =       0.003277522189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162326416
                                         uncertainty =       0.003277522189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409954987
  error estimate for blocks of size 2^( 2) =       0.000421417225
  error estimate for blocks of size 2^( 3) =       0.000433893829
  error estimate for blocks of size 2^( 4) =       0.000445351692
  error estimate for blocks of size 2^( 5) =       0.000456518283
  error estimate for blocks of size 2^( 6) =       0.000465117234
  error estimate for blocks of size 2^( 7) =       0.000471695460

      target function =                  N/A
              le_mean =     -16.910841356844
             les_mean =     286.312681411507
             stat err =       0.000459670667
             autocorr =       1.257248812728
              std dev =       0.579763903001
             le_variance =       0.336126183223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162570056
                                         uncertainty =       0.003277525014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162570056
                                         uncertainty =       0.003277525014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955136
  error estimate for blocks of size 2^( 2) =       0.000421417366
  error estimate for blocks of size 2^( 3) =       0.000433893962
  error estimate for blocks of size 2^( 4) =       0.000445351806
  error estimate for blocks of size 2^( 5) =       0.000456518398
  error estimate for blocks of size 2^( 6) =       0.000465117361
  error estimate for blocks of size 2^( 7) =       0.000471695587

      target function =                  N/A
              le_mean =     -16.910841355961
             les_mean =     286.312681625547
             stat err =       0.000459670788
             autocorr =       1.257248562329
              std dev =       0.579764113356
             le_variance =       0.336126427135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162448639
                                         uncertainty =       0.003277523607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162448639
                                         uncertainty =       0.003277523607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955062
  error estimate for blocks of size 2^( 2) =       0.000421417296
  error estimate for blocks of size 2^( 3) =       0.000433893896
  error estimate for blocks of size 2^( 4) =       0.000445351749
  error estimate for blocks of size 2^( 5) =       0.000456518341
  error estimate for blocks of size 2^( 6) =       0.000465117298
  error estimate for blocks of size 2^( 7) =       0.000471695524

      target function =                  N/A
              le_mean =     -16.910841356405
             les_mean =     286.312681519024
             stat err =       0.000459670728
             autocorr =       1.257248687233
              std dev =       0.579764008526
             le_variance =       0.336126305582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162341706
                                         uncertainty =       0.003277522366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336162341706
                                         uncertainty =       0.003277522366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409954997
  error estimate for blocks of size 2^( 2) =       0.000421417234
  error estimate for blocks of size 2^( 3) =       0.000433893838
  error estimate for blocks of size 2^( 4) =       0.000445351699
  error estimate for blocks of size 2^( 5) =       0.000456518290
  error estimate for blocks of size 2^( 6) =       0.000465117242
  error estimate for blocks of size 2^( 7) =       0.000471695468

      target function =                  N/A
              le_mean =     -16.910841356789
             les_mean =     286.312681424959
             stat err =       0.000459670675
             autocorr =       1.257248797021
              std dev =       0.579763916202
             le_variance =       0.336126198530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910841356844        initial  <--
     1.5259e+02     1.5259e+03             1.1415e-06       -16.910841355961
     6.1035e+02     6.1035e+03             2.8540e-07       -16.910841356405
     2.4414e+03     2.4414e+04             7.1351e-08       -16.910841356789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2932
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.109027e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815943e-02 1 1  ON 2
 uu_3                -1.575836e-02 1 1  ON 3
 uu_4                -6.690891e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153297e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780126e-02 1 1  ON 12
 ud_3                -2.208334e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563862e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468217e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798702e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425954e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719574e-01 1 1  ON 30
eH1_1                -1.648250e-01 1 1  ON 31
eH1_2                -1.207910e-01 1 1  ON 32
eH1_3                -6.725075e-02 1 1  ON 33
eH1_4                -7.647664e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082706e-01 1 1  ON 38
eH1_9                 9.944335e-02 1 1  ON 39
eH2_0                -2.698168e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515893e-02 1 1  ON 43
eH2_4                -5.518627e-03 1 1  ON 44
eH2_5                 3.995101e-02 1 1  ON 45
eH2_6                 1.099881e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119004e-01 1 1  ON 48
eH2_9                 9.507250e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.224563
====================================================
  Execution time = 2.8230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337702887589
                                         uncertainty =       0.003710718098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337702887589
                                         uncertainty =       0.003710718098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886563
  error estimate for blocks of size 2^( 2) =       0.000423276803
  error estimate for blocks of size 2^( 3) =       0.000436198392
  error estimate for blocks of size 2^( 4) =       0.000448467851
  error estimate for blocks of size 2^( 5) =       0.000458904717
  error estimate for blocks of size 2^( 6) =       0.000464632258
  error estimate for blocks of size 2^( 7) =       0.000469054349

      target function =                  N/A
              le_mean =     -16.909893060880
             les_mean =     286.282138696658
             stat err =       0.000460264794
             autocorr =       1.254791693818
              std dev =       0.581081349811
             le_variance =       0.337655535098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690989306088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893060880       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893061719       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909893061862       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909893061948       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909893061865       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909893061898       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909893061938       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909893061906       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.454504e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893060880       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893061090       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909893061125       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909893061147       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909893061126       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909893061138       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909893061144       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909893061138       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.636284e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893060880       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893060932       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909893060941       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909893060945       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909893060940       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909893060948       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909893060950       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909893060946       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 9.090725e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5391e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815942e-02 1 1  ON 2
 uu_3                -1.575834e-02 1 1  ON 3
 uu_4                -6.690894e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153297e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780123e-02 1 1  ON 12
 ud_3                -2.208318e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468217e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798709e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526142e-02 1 1  ON 27
 eO_8                -2.425954e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719574e-01 1 1  ON 30
eH1_1                -1.648251e-01 1 1  ON 31
eH1_2                -1.207910e-01 1 1  ON 32
eH1_3                -6.725076e-02 1 1  ON 33
eH1_4                -7.647661e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082706e-01 1 1  ON 38
eH1_9                 9.944338e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515894e-02 1 1  ON 43
eH2_4                -5.518627e-03 1 1  ON 44
eH2_5                 3.995098e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.404605
====================================================
  Execution time = 2.7901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.7655e-01
  Total weights = 2.0000e+06
  Execution time = 3.4564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701835543
                                         uncertainty =       0.040773017998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701835543
                                         uncertainty =       0.040773017998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433904505
  error estimate for blocks of size 2^( 2) =       0.000445249230
  error estimate for blocks of size 2^( 3) =       0.000457300121
  error estimate for blocks of size 2^( 4) =       0.000469696527
  error estimate for blocks of size 2^( 5) =       0.000480409091
  error estimate for blocks of size 2^( 6) =       0.000489935347
  error estimate for blocks of size 2^( 7) =       0.000495640459

      target function =                  N/A
              le_mean =     -16.909694492503
             les_mean =     286.314313880487
             stat err =       0.000483920356
             autocorr =       1.243825521417
              std dev =       0.613633635793
             le_variance =       0.376546238976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701948447
                                         uncertainty =       0.040773027487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701948447
                                         uncertainty =       0.040773027487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433904570
  error estimate for blocks of size 2^( 2) =       0.000445249293
  error estimate for blocks of size 2^( 3) =       0.000457300182
  error estimate for blocks of size 2^( 4) =       0.000469696588
  error estimate for blocks of size 2^( 5) =       0.000480409148
  error estimate for blocks of size 2^( 6) =       0.000489935406
  error estimate for blocks of size 2^( 7) =       0.000495640517

      target function =                  N/A
              le_mean =     -16.909694492796
             les_mean =     286.314314003252
             stat err =       0.000483920415
             autocorr =       1.243825450065
              std dev =       0.613633727747
             le_variance =       0.376546351828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701892009
                                         uncertainty =       0.040773022743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701892009
                                         uncertainty =       0.040773022743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433904538
  error estimate for blocks of size 2^( 2) =       0.000445249262
  error estimate for blocks of size 2^( 3) =       0.000457300152
  error estimate for blocks of size 2^( 4) =       0.000469696558
  error estimate for blocks of size 2^( 5) =       0.000480409120
  error estimate for blocks of size 2^( 6) =       0.000489935376
  error estimate for blocks of size 2^( 7) =       0.000495640488

      target function =                  N/A
              le_mean =     -16.909694492649
             les_mean =     286.314313941883
             stat err =       0.000483920385
             autocorr =       1.243825485728
              std dev =       0.613633681781
             le_variance =       0.376546295416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701842602
                                         uncertainty =       0.040773018591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376701842602
                                         uncertainty =       0.040773018591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433904509
  error estimate for blocks of size 2^( 2) =       0.000445249234
  error estimate for blocks of size 2^( 3) =       0.000457300125
  error estimate for blocks of size 2^( 4) =       0.000469696531
  error estimate for blocks of size 2^( 5) =       0.000480409095
  error estimate for blocks of size 2^( 6) =       0.000489935350
  error estimate for blocks of size 2^( 7) =       0.000495640463

      target function =                  N/A
              le_mean =     -16.909694492521
             les_mean =     286.314313888162
             stat err =       0.000483920360
             autocorr =       1.243825516956
              std dev =       0.613633641542
             le_variance =       0.376546246032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909694492503        initial
     1.5259e+03     1.5259e+04             1.4545e-07       -16.909694492796  <--
     6.1035e+03     6.1035e+04             3.6363e-08       -16.909694492649
     2.4414e+04     2.4414e+05             9.0907e-09       -16.909694492521

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 4.5262e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.971
    reference variance = 0.297223
====================================================
  Execution time = 2.8261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4341e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343223460500
                                         uncertainty =       0.006589430143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343223460500
                                         uncertainty =       0.006589430143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414371611
  error estimate for blocks of size 2^( 2) =       0.000425964931
  error estimate for blocks of size 2^( 3) =       0.000437857670
  error estimate for blocks of size 2^( 4) =       0.000448030039
  error estimate for blocks of size 2^( 5) =       0.000457782638
  error estimate for blocks of size 2^( 6) =       0.000465127892
  error estimate for blocks of size 2^( 7) =       0.000468572931

      target function =                  N/A
              le_mean =     -16.910314881949
             les_mean =     286.302156898792
             stat err =       0.000459878375
             autocorr =       1.231702970650
              std dev =       0.586009951987
             le_variance =       0.343407663828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031488195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314881949       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314881524       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314879273       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314878574       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314880122       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910314880320       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910314880432       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.659788e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314881949       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314881843       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314881280       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314881105       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314881492       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910314881541       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910314881570       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.415002e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314881949       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314881922       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314881782       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314881738       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314881835       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910314881849       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910314881855       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.537540e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5429e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815931e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690911e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208198e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798689e-03 1 1  ON 22
 eO_3                 3.127329e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915905e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648251e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725085e-02 1 1  ON 33
eH1_4                -7.647665e-03 1 1  ON 34
eH1_5                 3.700398e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944356e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515895e-02 1 1  ON 43
eH2_4                -5.518662e-03 1 1  ON 44
eH2_5                 3.995079e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9347
    reference variance = 0.342882
====================================================
  Execution time = 2.9478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.0000e+06
  Execution time = 3.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608663424
                                         uncertainty =       0.003266407577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608663424
                                         uncertainty =       0.003266407577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182465
  error estimate for blocks of size 2^( 2) =       0.000418726462
  error estimate for blocks of size 2^( 3) =       0.000430537230
  error estimate for blocks of size 2^( 4) =       0.000441783873
  error estimate for blocks of size 2^( 5) =       0.000450307621
  error estimate for blocks of size 2^( 6) =       0.000455994686
  error estimate for blocks of size 2^( 7) =       0.000459718024

      target function =                  N/A
              le_mean =     -16.911455249954
             les_mean =     286.328913624728
             stat err =       0.000451951051
             autocorr =       1.231982865831
              std dev =       0.575842964129
             le_variance =       0.331595119337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608476329
                                         uncertainty =       0.003266406524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608476329
                                         uncertainty =       0.003266406524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182350
  error estimate for blocks of size 2^( 2) =       0.000418726347
  error estimate for blocks of size 2^( 3) =       0.000430537120
  error estimate for blocks of size 2^( 4) =       0.000441783765
  error estimate for blocks of size 2^( 5) =       0.000450307514
  error estimate for blocks of size 2^( 6) =       0.000455994582
  error estimate for blocks of size 2^( 7) =       0.000459717929

      target function =                  N/A
              le_mean =     -16.911455249121
             les_mean =     286.328913409542
             stat err =       0.000451950948
             autocorr =       1.231982996225
              std dev =       0.575842801735
             le_variance =       0.331594932309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608569808
                                         uncertainty =       0.003266407050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608569808
                                         uncertainty =       0.003266407050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182407
  error estimate for blocks of size 2^( 2) =       0.000418726404
  error estimate for blocks of size 2^( 3) =       0.000430537175
  error estimate for blocks of size 2^( 4) =       0.000441783819
  error estimate for blocks of size 2^( 5) =       0.000450307568
  error estimate for blocks of size 2^( 6) =       0.000455994634
  error estimate for blocks of size 2^( 7) =       0.000459717977

      target function =                  N/A
              le_mean =     -16.911455249537
             les_mean =     286.328913517042
             stat err =       0.000451950999
             autocorr =       1.231982931056
              std dev =       0.575842882872
             le_variance =       0.331595025754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608651719
                                         uncertainty =       0.003266407511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608651719
                                         uncertainty =       0.003266407511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182458
  error estimate for blocks of size 2^( 2) =       0.000418726454
  error estimate for blocks of size 2^( 3) =       0.000430537223
  error estimate for blocks of size 2^( 4) =       0.000441783867
  error estimate for blocks of size 2^( 5) =       0.000450307615
  error estimate for blocks of size 2^( 6) =       0.000455994680
  error estimate for blocks of size 2^( 7) =       0.000459718018

      target function =                  N/A
              le_mean =     -16.911455249902
             les_mean =     286.328913611264
             stat err =       0.000451951045
             autocorr =       1.231982873982
              std dev =       0.575842953970
             le_variance =       0.331595107637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911455249954        initial  <--
     3.8147e+02     3.8147e+03             5.6598e-07       -16.911455249121
     1.5259e+03     1.5259e+04             1.4150e-07       -16.911455249537
     6.1035e+03     6.1035e+04             3.5375e-08       -16.911455249902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8454
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.201526
====================================================
  Execution time = 2.8104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354009096390
                                         uncertainty =       0.012241051696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354009096390
                                         uncertainty =       0.012241051696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420671698
  error estimate for blocks of size 2^( 2) =       0.000432548600
  error estimate for blocks of size 2^( 3) =       0.000444253231
  error estimate for blocks of size 2^( 4) =       0.000455393948
  error estimate for blocks of size 2^( 5) =       0.000464396634
  error estimate for blocks of size 2^( 6) =       0.000473365522
  error estimate for blocks of size 2^( 7) =       0.000477750377

      target function =                  N/A
              le_mean =     -16.910933749112
             les_mean =     286.333609444460
             stat err =       0.000467726620
             autocorr =       1.236225187660
              std dev =       0.594919620267
             le_variance =       0.353929354578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691093374911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910933749112       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910933749221       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910933749295       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933749522       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910933749644       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910933749704       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910933749731       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910933749701       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.290734e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910933749112       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910933749139       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910933749158       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933749213       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910933749246       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910933749262       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910933749264       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910933749255       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.572686e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910933749112       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910933749119       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910933749123       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933749151       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910933749153       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910933749195       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910933749163       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910933749031       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.931718e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5258e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798734e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647650e-03 1 1  ON 34
eH1_5                 3.700395e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944349e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515898e-02 1 1  ON 43
eH2_4                -5.518634e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507266e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9316
    reference variance = 0.254145
====================================================
  Execution time = 2.7434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3279e-01
  Total weights = 2.0000e+06
  Execution time = 3.4681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756804419
                                         uncertainty =       0.003104762942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756804419
                                         uncertainty =       0.003104762942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917439
  error estimate for blocks of size 2^( 2) =       0.000419531608
  error estimate for blocks of size 2^( 3) =       0.000431725865
  error estimate for blocks of size 2^( 4) =       0.000442944998
  error estimate for blocks of size 2^( 5) =       0.000454014445
  error estimate for blocks of size 2^( 6) =       0.000462946743
  error estimate for blocks of size 2^( 7) =       0.000470051092

      target function =                  N/A
              le_mean =     -16.910962623643
             les_mean =     286.313449965294
             stat err =       0.000457489319
             autocorr =       1.257816752661
              std dev =       0.576882374012
             le_variance =       0.332793273446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756787350
                                         uncertainty =       0.003104762794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756787350
                                         uncertainty =       0.003104762794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917428
  error estimate for blocks of size 2^( 2) =       0.000419531598
  error estimate for blocks of size 2^( 3) =       0.000431725856
  error estimate for blocks of size 2^( 4) =       0.000442944989
  error estimate for blocks of size 2^( 5) =       0.000454014436
  error estimate for blocks of size 2^( 6) =       0.000462946735
  error estimate for blocks of size 2^( 7) =       0.000470051084

      target function =                  N/A
              le_mean =     -16.910962623336
             les_mean =     286.313449937828
             stat err =       0.000457489311
             autocorr =       1.257816771470
              std dev =       0.576882359215
             le_variance =       0.332793256374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756795884
                                         uncertainty =       0.003104762868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756795884
                                         uncertainty =       0.003104762868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917433
  error estimate for blocks of size 2^( 2) =       0.000419531603
  error estimate for blocks of size 2^( 3) =       0.000431725861
  error estimate for blocks of size 2^( 4) =       0.000442944994
  error estimate for blocks of size 2^( 5) =       0.000454014441
  error estimate for blocks of size 2^( 6) =       0.000462946739
  error estimate for blocks of size 2^( 7) =       0.000470051088

      target function =                  N/A
              le_mean =     -16.910962623489
             les_mean =     286.313449951561
             stat err =       0.000457489315
             autocorr =       1.257816762060
              std dev =       0.576882366613
             le_variance =       0.332793264909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756803352
                                         uncertainty =       0.003104762932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332756803352
                                         uncertainty =       0.003104762932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917438
  error estimate for blocks of size 2^( 2) =       0.000419531608
  error estimate for blocks of size 2^( 3) =       0.000431725865
  error estimate for blocks of size 2^( 4) =       0.000442944997
  error estimate for blocks of size 2^( 5) =       0.000454014444
  error estimate for blocks of size 2^( 6) =       0.000462946742
  error estimate for blocks of size 2^( 7) =       0.000470051091

      target function =                  N/A
              le_mean =     -16.910962623624
             les_mean =     286.313449963578
             stat err =       0.000457489319
             autocorr =       1.257816753832
              std dev =       0.576882373087
             le_variance =       0.332793272379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910962623643        initial  <--
     3.8147e+03     3.8147e+04             6.2907e-08       -16.910962623336
     1.5259e+04     1.5259e+05             1.5727e-08       -16.910962623489
     6.1035e+04     6.1035e+05             3.9317e-09       -16.910962623624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7797
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.189278
====================================================
  Execution time = 2.7849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4709e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347106657168
                                         uncertainty =       0.007156917070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347106657168
                                         uncertainty =       0.007156917070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416589047
  error estimate for blocks of size 2^( 2) =       0.000428399853
  error estimate for blocks of size 2^( 3) =       0.000440134465
  error estimate for blocks of size 2^( 4) =       0.000452002493
  error estimate for blocks of size 2^( 5) =       0.000462464368
  error estimate for blocks of size 2^( 6) =       0.000471649117
  error estimate for blocks of size 2^( 7) =       0.000476054134

      target function =                  N/A
              le_mean =     -16.910687360211
             les_mean =     286.318439689954
             stat err =       0.000465542528
             autocorr =       1.248829146815
              std dev =       0.589145880654
             le_variance =       0.347092868692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691068736021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910687360211       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910687360216       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910687360212       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910687360216       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910687360216       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910687360225       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910687360222       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910687360249       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.400662e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910687360211       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910687360212       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910687360211       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910687360212       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910687360221       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910687360202       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910687360171       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910687360357       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.350166e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910687360211       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910687360212       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910687360211       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910687360212       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910687360223       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910687360387       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910687359744       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910687360542       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.375415e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5067e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815936e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647653e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518626e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0933
    reference variance = 1.03834
====================================================
  Execution time = 2.7209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3862e-01
  Total weights = 2.0000e+06
  Execution time = 3.4565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629743
                                         uncertainty =       0.006767494671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629743
                                         uncertainty =       0.006767494671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411473470
  error estimate for blocks of size 2^( 2) =       0.000422689158
  error estimate for blocks of size 2^( 3) =       0.000434534177
  error estimate for blocks of size 2^( 4) =       0.000445865085
  error estimate for blocks of size 2^( 5) =       0.000455422985
  error estimate for blocks of size 2^( 6) =       0.000462980494
  error estimate for blocks of size 2^( 7) =       0.000468219118

      target function =                  N/A
              le_mean =     -16.911133683116
             les_mean =     286.325063111530
             stat err =       0.000458121921
             autocorr =       1.239591152346
              std dev =       0.581911361472
             le_variance =       0.338620832610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629528
                                         uncertainty =       0.006767494621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629528
                                         uncertainty =       0.006767494621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411473470
  error estimate for blocks of size 2^( 2) =       0.000422689158
  error estimate for blocks of size 2^( 3) =       0.000434534177
  error estimate for blocks of size 2^( 4) =       0.000445865085
  error estimate for blocks of size 2^( 5) =       0.000455422985
  error estimate for blocks of size 2^( 6) =       0.000462980494
  error estimate for blocks of size 2^( 7) =       0.000468219118

      target function =                  N/A
              le_mean =     -16.911133683097
             les_mean =     286.325063110661
             stat err =       0.000458121920
             autocorr =       1.239591152579
              std dev =       0.581911361288
             le_variance =       0.338620832396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629636
                                         uncertainty =       0.006767494646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629636
                                         uncertainty =       0.006767494646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411473470
  error estimate for blocks of size 2^( 2) =       0.000422689158
  error estimate for blocks of size 2^( 3) =       0.000434534177
  error estimate for blocks of size 2^( 4) =       0.000445865085
  error estimate for blocks of size 2^( 5) =       0.000455422985
  error estimate for blocks of size 2^( 6) =       0.000462980494
  error estimate for blocks of size 2^( 7) =       0.000468219118

      target function =                  N/A
              le_mean =     -16.911133683107
             les_mean =     286.325063111096
             stat err =       0.000458121920
             autocorr =       1.239591152459
              std dev =       0.581911361380
             le_variance =       0.338620832503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629730
                                         uncertainty =       0.006767494668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601629730
                                         uncertainty =       0.006767494668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411473470
  error estimate for blocks of size 2^( 2) =       0.000422689158
  error estimate for blocks of size 2^( 3) =       0.000434534177
  error estimate for blocks of size 2^( 4) =       0.000445865085
  error estimate for blocks of size 2^( 5) =       0.000455422985
  error estimate for blocks of size 2^( 6) =       0.000462980494
  error estimate for blocks of size 2^( 7) =       0.000468219118

      target function =                  N/A
              le_mean =     -16.911133683115
             les_mean =     286.325063111476
             stat err =       0.000458121921
             autocorr =       1.239591152358
              std dev =       0.581911361461
             le_variance =       0.338620832597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911133683116        initial  <--
     3.8147e+04     3.8147e+05             5.4007e-09       -16.911133683097
     1.5259e+05     1.5259e+06             1.3502e-09       -16.911133683107
     6.1035e+05     6.1035e+06             3.3754e-10       -16.911133683115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5598
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8572
    reference variance = 0.271547
====================================================
  Execution time = 2.7963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4381e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343908651425
                                         uncertainty =       0.007669568976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343908651425
                                         uncertainty =       0.007669568976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414613163
  error estimate for blocks of size 2^( 2) =       0.000426183417
  error estimate for blocks of size 2^( 3) =       0.000437526346
  error estimate for blocks of size 2^( 4) =       0.000448492201
  error estimate for blocks of size 2^( 5) =       0.000458090840
  error estimate for blocks of size 2^( 6) =       0.000465129654
  error estimate for blocks of size 2^( 7) =       0.000468768869

      target function =                  N/A
              le_mean =     -16.911347161951
             les_mean =     286.337470809274
             stat err =       0.000460120391
             autocorr =       1.231563443458
              std dev =       0.586351557650
             le_variance =       0.343808149158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691134716195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911347161951       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911347161952       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911347161954       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911347161953       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911347161953       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911347161951       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911347161920       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911347162446       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.937823e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911347161951       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911347161951       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911347161951       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911347162325       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911347161951       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911347161951       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911347162028       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911347161045       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.484455e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911347161951       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911347161951       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911347161951       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911347159389       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911347163460       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911347162565       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911347162957       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911347161332       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.711135e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5059e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8751
    reference variance = 0.247252
====================================================
  Execution time = 2.7161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3976e-01
  Total weights = 2.0000e+06
  Execution time = 3.4714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756792
                                         uncertainty =       0.003611654021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756792
                                         uncertainty =       0.003611654021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412167106
  error estimate for blocks of size 2^( 2) =       0.000423958233
  error estimate for blocks of size 2^( 3) =       0.000435857019
  error estimate for blocks of size 2^( 4) =       0.000447346612
  error estimate for blocks of size 2^( 5) =       0.000457523233
  error estimate for blocks of size 2^( 6) =       0.000465732573
  error estimate for blocks of size 2^( 7) =       0.000470975968

      target function =                  N/A
              le_mean =     -16.910640095203
             les_mean =     286.309511705989
             stat err =       0.000460394596
             autocorr =       1.247710350883
              std dev =       0.582892311124
             le_variance =       0.339763446368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756423
                                         uncertainty =       0.003611654016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756423
                                         uncertainty =       0.003611654016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412167106
  error estimate for blocks of size 2^( 2) =       0.000423958233
  error estimate for blocks of size 2^( 3) =       0.000435857019
  error estimate for blocks of size 2^( 4) =       0.000447346612
  error estimate for blocks of size 2^( 5) =       0.000457523233
  error estimate for blocks of size 2^( 6) =       0.000465732573
  error estimate for blocks of size 2^( 7) =       0.000470975968

      target function =                  N/A
              le_mean =     -16.910640095200
             les_mean =     286.309511705514
             stat err =       0.000460394596
             autocorr =       1.247710351187
              std dev =       0.582892310807
             le_variance =       0.339763445998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756607
                                         uncertainty =       0.003611654018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756607
                                         uncertainty =       0.003611654018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412167106
  error estimate for blocks of size 2^( 2) =       0.000423958233
  error estimate for blocks of size 2^( 3) =       0.000435857019
  error estimate for blocks of size 2^( 4) =       0.000447346612
  error estimate for blocks of size 2^( 5) =       0.000457523233
  error estimate for blocks of size 2^( 6) =       0.000465732573
  error estimate for blocks of size 2^( 7) =       0.000470975968

      target function =                  N/A
              le_mean =     -16.910640095202
             les_mean =     286.309511705751
             stat err =       0.000460394596
             autocorr =       1.247710351026
              std dev =       0.582892310966
             le_variance =       0.339763446183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756769
                                         uncertainty =       0.003611654021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339774756769
                                         uncertainty =       0.003611654021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412167106
  error estimate for blocks of size 2^( 2) =       0.000423958233
  error estimate for blocks of size 2^( 3) =       0.000435857019
  error estimate for blocks of size 2^( 4) =       0.000447346612
  error estimate for blocks of size 2^( 5) =       0.000457523233
  error estimate for blocks of size 2^( 6) =       0.000465732573
  error estimate for blocks of size 2^( 7) =       0.000470975968

      target function =                  N/A
              le_mean =     -16.910640095203
             les_mean =     286.309511705959
             stat err =       0.000460394596
             autocorr =       1.247710350899
              std dev =       0.582892311104
             le_variance =       0.339763446344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910640095203        initial  <--
     3.8147e+05     3.8147e+06             5.9378e-10       -16.910640095200
     1.5259e+06     1.5259e+07             1.4845e-10       -16.910640095202
     6.1035e+06     6.1035e+07             3.7111e-11       -16.910640095203

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4977
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.315425
====================================================
  Execution time = 3.0141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340900783966
                                         uncertainty =       0.004811200453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340900783966
                                         uncertainty =       0.004811200453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412803686
  error estimate for blocks of size 2^( 2) =       0.000424004935
  error estimate for blocks of size 2^( 3) =       0.000436263832
  error estimate for blocks of size 2^( 4) =       0.000446921744
  error estimate for blocks of size 2^( 5) =       0.000456875868
  error estimate for blocks of size 2^( 6) =       0.000464555019
  error estimate for blocks of size 2^( 7) =       0.000468252918

      target function =                  N/A
              le_mean =     -16.910378929135
             les_mean =     286.301729122395
             stat err =       0.000459151387
             autocorr =       1.237156580706
              std dev =       0.583792570933
             le_variance =       0.340813765876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691037892913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910378929135       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910378929135       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910378929135       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910378928612       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910378930382       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910378929113       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910378931128       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910378929830       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.032631e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910378929135       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910378929135       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910378929135       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910378929135       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910378931047       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910378928022       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910378931620       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910378927366       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.258158e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910378929135       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910378929135       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910378929135       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910378915457       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910378928436       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910378928970       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910378940937       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910378882049       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.145422e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7272e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8068
    reference variance = 0.189562
====================================================
  Execution time = 2.7545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.0000e+06
  Execution time = 3.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074526
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074526
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229549
  error estimate for blocks of size 2^( 2) =       0.000422356690
  error estimate for blocks of size 2^( 3) =       0.000434238411
  error estimate for blocks of size 2^( 4) =       0.000445383611
  error estimate for blocks of size 2^( 5) =       0.000455975424
  error estimate for blocks of size 2^( 6) =       0.000462500062
  error estimate for blocks of size 2^( 7) =       0.000465399844

      target function =                  N/A
              le_mean =     -16.910277158632
             les_mean =     286.295692896936
             stat err =       0.000457314735
             autocorr =       1.236692601720
              std dev =       0.581566405737
             le_variance =       0.338219484282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074533
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074533
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229549
  error estimate for blocks of size 2^( 2) =       0.000422356690
  error estimate for blocks of size 2^( 3) =       0.000434238411
  error estimate for blocks of size 2^( 4) =       0.000445383611
  error estimate for blocks of size 2^( 5) =       0.000455975424
  error estimate for blocks of size 2^( 6) =       0.000462500062
  error estimate for blocks of size 2^( 7) =       0.000465399844

      target function =                  N/A
              le_mean =     -16.910277158633
             les_mean =     286.295692896949
             stat err =       0.000457314735
             autocorr =       1.236692601709
              std dev =       0.581566405743
             le_variance =       0.338219484289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074529
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074529
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229549
  error estimate for blocks of size 2^( 2) =       0.000422356690
  error estimate for blocks of size 2^( 3) =       0.000434238411
  error estimate for blocks of size 2^( 4) =       0.000445383611
  error estimate for blocks of size 2^( 5) =       0.000455975424
  error estimate for blocks of size 2^( 6) =       0.000462500062
  error estimate for blocks of size 2^( 7) =       0.000465399844

      target function =                  N/A
              le_mean =     -16.910277158632
             les_mean =     286.295692896943
             stat err =       0.000457314735
             autocorr =       1.236692601713
              std dev =       0.581566405740
             le_variance =       0.338219484286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074527
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074074527
                                         uncertainty =       0.004884415659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229549
  error estimate for blocks of size 2^( 2) =       0.000422356690
  error estimate for blocks of size 2^( 3) =       0.000434238411
  error estimate for blocks of size 2^( 4) =       0.000445383611
  error estimate for blocks of size 2^( 5) =       0.000455975424
  error estimate for blocks of size 2^( 6) =       0.000462500062
  error estimate for blocks of size 2^( 7) =       0.000465399844

      target function =                  N/A
              le_mean =     -16.910277158632
             les_mean =     286.295692896937
             stat err =       0.000457314735
             autocorr =       1.236692601712
              std dev =       0.581566405738
             le_variance =       0.338219484283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910277158632        initial
     3.8147e+06     3.8147e+07             5.0326e-11       -16.910277158633  <--
     1.5259e+07     1.5259e+08             1.2582e-11       -16.910277158632
     6.1035e+07     6.1035e+08             3.1454e-12       -16.910277158632

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 4.4940e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2221e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9558
    reference variance = 0.238284
====================================================
  Execution time = 2.7912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345928534756
                                         uncertainty =       0.007527359475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345928534756
                                         uncertainty =       0.007527359475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415874225
  error estimate for blocks of size 2^( 2) =       0.000426971678
  error estimate for blocks of size 2^( 3) =       0.000438757744
  error estimate for blocks of size 2^( 4) =       0.000449985473
  error estimate for blocks of size 2^( 5) =       0.000460038532
  error estimate for blocks of size 2^( 6) =       0.000467959727
  error estimate for blocks of size 2^( 7) =       0.000472701054

      target function =                  N/A
              le_mean =     -16.911135634734
             les_mean =     286.332411024961
             stat err =       0.000462671197
             autocorr =       1.237715753483
              std dev =       0.588134968821
             le_variance =       0.345902741551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691113563473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911135634734       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911135634734       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911135634735       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911135634906       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911135634758       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911135634916       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911135634975       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.164355e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911135634734       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911135634734       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911135634734       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911135634698       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911135635725       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911135635250       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911135636947       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.410903e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911135634734       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911135634734       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911135634734       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911135633211       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911135626614       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911135637213       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911135632773       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.352710e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5112e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.156931
====================================================
  Execution time = 2.7375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4247e-01
  Total weights = 2.0000e+06
  Execution time = 3.4767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053206
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053206
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413804503
  error estimate for blocks of size 2^( 2) =       0.000425039005
  error estimate for blocks of size 2^( 3) =       0.000436861728
  error estimate for blocks of size 2^( 4) =       0.000448875415
  error estimate for blocks of size 2^( 5) =       0.000459933803
  error estimate for blocks of size 2^( 6) =       0.000467697954
  error estimate for blocks of size 2^( 7) =       0.000473565135

      target function =                  N/A
              le_mean =     -16.911264698102
             les_mean =     286.333341851028
             stat err =       0.000462518077
             autocorr =       1.249300742232
              std dev =       0.585207939966
             le_variance =       0.342468333000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053083
                                         uncertainty =       0.005000098398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053083
                                         uncertainty =       0.005000098398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413804503
  error estimate for blocks of size 2^( 2) =       0.000425039005
  error estimate for blocks of size 2^( 3) =       0.000436861728
  error estimate for blocks of size 2^( 4) =       0.000448875415
  error estimate for blocks of size 2^( 5) =       0.000459933803
  error estimate for blocks of size 2^( 6) =       0.000467697954
  error estimate for blocks of size 2^( 7) =       0.000473565135

      target function =                  N/A
              le_mean =     -16.911264698102
             les_mean =     286.333341850913
             stat err =       0.000462518077
             autocorr =       1.249300742353
              std dev =       0.585207939861
             le_variance =       0.342468332876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053144
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053144
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413804503
  error estimate for blocks of size 2^( 2) =       0.000425039005
  error estimate for blocks of size 2^( 3) =       0.000436861728
  error estimate for blocks of size 2^( 4) =       0.000448875415
  error estimate for blocks of size 2^( 5) =       0.000459933803
  error estimate for blocks of size 2^( 6) =       0.000467697954
  error estimate for blocks of size 2^( 7) =       0.000473565135

      target function =                  N/A
              le_mean =     -16.911264698102
             les_mean =     286.333341850970
             stat err =       0.000462518077
             autocorr =       1.249300742290
              std dev =       0.585207939914
             le_variance =       0.342468332938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053198
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342548053198
                                         uncertainty =       0.005000098399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413804503
  error estimate for blocks of size 2^( 2) =       0.000425039005
  error estimate for blocks of size 2^( 3) =       0.000436861728
  error estimate for blocks of size 2^( 4) =       0.000448875415
  error estimate for blocks of size 2^( 5) =       0.000459933803
  error estimate for blocks of size 2^( 6) =       0.000467697954
  error estimate for blocks of size 2^( 7) =       0.000473565135

      target function =                  N/A
              le_mean =     -16.911264698102
             les_mean =     286.333341851021
             stat err =       0.000462518077
             autocorr =       1.249300742230
              std dev =       0.585207939960
             le_variance =       0.342468332992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911264698102        initial
     9.5367e+05     9.5367e+06             2.1644e-10       -16.911264698102  <--
     3.8147e+06     3.8147e+07             5.4109e-11       -16.911264698102
     1.5259e+07     1.5259e+08             1.3527e-11       -16.911264698102

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 4.4730e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.275051
====================================================
  Execution time = 2.8186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336441287515
                                         uncertainty =       0.005030684519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336441287515
                                         uncertainty =       0.005030684519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410248616
  error estimate for blocks of size 2^( 2) =       0.000422460536
  error estimate for blocks of size 2^( 3) =       0.000434798095
  error estimate for blocks of size 2^( 4) =       0.000446672388
  error estimate for blocks of size 2^( 5) =       0.000457221003
  error estimate for blocks of size 2^( 6) =       0.000465658438
  error estimate for blocks of size 2^( 7) =       0.000467046904

      target function =                  N/A
              le_mean =     -16.911153827259
             les_mean =     286.323731454409
             stat err =       0.000459149683
             autocorr =       1.252605543027
              std dev =       0.580179156377
             le_variance =       0.336607853494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691115382726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911153827259       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911153827258       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911153827260       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911153827236       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911153827062       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911153827198       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911153827432       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911153827104       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.409384e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911153827259       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911153827259       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911153827259       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911153827259       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911153827463       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911153827751       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911153827636       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911153827059       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.102347e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911153827259       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911153827259       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911153827259       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911153827259       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911153822294       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911153826102       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911153832339       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911153824912       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.255861e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5416e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.944
    reference variance = 0.967127
====================================================
  Execution time = 2.7390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3720e-01
  Total weights = 2.0000e+06
  Execution time = 3.4641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110329
                                         uncertainty =       0.005430032430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110329
                                         uncertainty =       0.005430032430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410606734
  error estimate for blocks of size 2^( 2) =       0.000422017595
  error estimate for blocks of size 2^( 3) =       0.000434030473
  error estimate for blocks of size 2^( 4) =       0.000445117574
  error estimate for blocks of size 2^( 5) =       0.000454026530
  error estimate for blocks of size 2^( 6) =       0.000460615630
  error estimate for blocks of size 2^( 7) =       0.000462720549

      target function =                  N/A
              le_mean =     -16.910950428418
             les_mean =     286.317440003451
             stat err =       0.000455620070
             autocorr =       1.231270740465
              std dev =       0.580685611701
             le_variance =       0.337195779637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110140
                                         uncertainty =       0.005430032424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110140
                                         uncertainty =       0.005430032424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410606734
  error estimate for blocks of size 2^( 2) =       0.000422017595
  error estimate for blocks of size 2^( 3) =       0.000434030473
  error estimate for blocks of size 2^( 4) =       0.000445117574
  error estimate for blocks of size 2^( 5) =       0.000454026530
  error estimate for blocks of size 2^( 6) =       0.000460615630
  error estimate for blocks of size 2^( 7) =       0.000462720549

      target function =                  N/A
              le_mean =     -16.910950428416
             les_mean =     286.317440003186
             stat err =       0.000455620070
             autocorr =       1.231270740551
              std dev =       0.580685611540
             le_variance =       0.337195779449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110235
                                         uncertainty =       0.005430032427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110235
                                         uncertainty =       0.005430032427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410606734
  error estimate for blocks of size 2^( 2) =       0.000422017595
  error estimate for blocks of size 2^( 3) =       0.000434030473
  error estimate for blocks of size 2^( 4) =       0.000445117574
  error estimate for blocks of size 2^( 5) =       0.000454026530
  error estimate for blocks of size 2^( 6) =       0.000460615630
  error estimate for blocks of size 2^( 7) =       0.000462720549

      target function =                  N/A
              le_mean =     -16.910950428417
             les_mean =     286.317440003318
             stat err =       0.000455620070
             autocorr =       1.231270740506
              std dev =       0.580685611620
             le_variance =       0.337195779543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110317
                                         uncertainty =       0.005430032429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337253110317
                                         uncertainty =       0.005430032429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410606734
  error estimate for blocks of size 2^( 2) =       0.000422017595
  error estimate for blocks of size 2^( 3) =       0.000434030473
  error estimate for blocks of size 2^( 4) =       0.000445117574
  error estimate for blocks of size 2^( 5) =       0.000454026530
  error estimate for blocks of size 2^( 6) =       0.000460615630
  error estimate for blocks of size 2^( 7) =       0.000462720549

      target function =                  N/A
              le_mean =     -16.910950428418
             les_mean =     286.317440003434
             stat err =       0.000455620070
             autocorr =       1.231270740469
              std dev =       0.580685611691
             le_variance =       0.337195779625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910950428418        initial  <--
     2.3842e+05     2.3842e+06             8.4094e-10       -16.910950428416
     9.5367e+05     9.5367e+06             2.1023e-10       -16.910950428417
     3.8147e+06     3.8147e+07             5.2559e-11       -16.910950428418

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7436
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8949
    reference variance = 0.308826
====================================================
  Execution time = 2.7858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3239e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332354147059
                                         uncertainty =       0.002947609958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332354147059
                                         uncertainty =       0.002947609958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407670658
  error estimate for blocks of size 2^( 2) =       0.000419775369
  error estimate for blocks of size 2^( 3) =       0.000432419862
  error estimate for blocks of size 2^( 4) =       0.000444207251
  error estimate for blocks of size 2^( 5) =       0.000455017899
  error estimate for blocks of size 2^( 6) =       0.000463384835
  error estimate for blocks of size 2^( 7) =       0.000470368711

      target function =                  N/A
              le_mean =     -16.910071046441
             les_mean =     286.282893360894
             stat err =       0.000458244674
             autocorr =       1.263502026911
              std dev =       0.576533374061
             le_variance =       0.332390731406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691007104644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071046441       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071046441       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071046441       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071046750       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071045886       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071043958       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071046937       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 8.192409e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071046441       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071046441       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071046441       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071046441       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071046439       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071049908       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071041813       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.048098e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071046441       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071046441       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071046441       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071046441       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071050922       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071035128       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071048560       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.120341e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5032e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8522
    reference variance = 0.208335
====================================================
  Execution time = 2.7248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3552e-01
  Total weights = 2.0000e+06
  Execution time = 3.4584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482919
                                         uncertainty =       0.003127009682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482919
                                         uncertainty =       0.003127009682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409582405
  error estimate for blocks of size 2^( 2) =       0.000421084220
  error estimate for blocks of size 2^( 3) =       0.000433078631
  error estimate for blocks of size 2^( 4) =       0.000444424186
  error estimate for blocks of size 2^( 5) =       0.000455694486
  error estimate for blocks of size 2^( 6) =       0.000465313480
  error estimate for blocks of size 2^( 7) =       0.000468572876

      target function =                  N/A
              le_mean =     -16.910793558241
             les_mean =     286.310454094982
             stat err =       0.000458501257
             autocorr =       1.253136781666
              std dev =       0.579236992339
             le_variance =       0.335515493294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482980
                                         uncertainty =       0.003127009683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482980
                                         uncertainty =       0.003127009683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409582405
  error estimate for blocks of size 2^( 2) =       0.000421084220
  error estimate for blocks of size 2^( 3) =       0.000433078631
  error estimate for blocks of size 2^( 4) =       0.000444424186
  error estimate for blocks of size 2^( 5) =       0.000455694486
  error estimate for blocks of size 2^( 6) =       0.000465313480
  error estimate for blocks of size 2^( 7) =       0.000468572876

      target function =                  N/A
              le_mean =     -16.910793558241
             les_mean =     286.310454095042
             stat err =       0.000458501257
             autocorr =       1.253136781611
              std dev =       0.579236992392
             le_variance =       0.335515493355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482949
                                         uncertainty =       0.003127009683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482949
                                         uncertainty =       0.003127009683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409582405
  error estimate for blocks of size 2^( 2) =       0.000421084220
  error estimate for blocks of size 2^( 3) =       0.000433078631
  error estimate for blocks of size 2^( 4) =       0.000444424186
  error estimate for blocks of size 2^( 5) =       0.000455694486
  error estimate for blocks of size 2^( 6) =       0.000465313480
  error estimate for blocks of size 2^( 7) =       0.000468572876

      target function =                  N/A
              le_mean =     -16.910793558241
             les_mean =     286.310454095012
             stat err =       0.000458501257
             autocorr =       1.253136781633
              std dev =       0.579236992366
             le_variance =       0.335515493325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482923
                                         uncertainty =       0.003127009682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550482923
                                         uncertainty =       0.003127009682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409582405
  error estimate for blocks of size 2^( 2) =       0.000421084220
  error estimate for blocks of size 2^( 3) =       0.000433078631
  error estimate for blocks of size 2^( 4) =       0.000444424186
  error estimate for blocks of size 2^( 5) =       0.000455694486
  error estimate for blocks of size 2^( 6) =       0.000465313480
  error estimate for blocks of size 2^( 7) =       0.000468572876

      target function =                  N/A
              le_mean =     -16.910793558241
             les_mean =     286.310454094986
             stat err =       0.000458501257
             autocorr =       1.253136781663
              std dev =       0.579236992342
             le_variance =       0.335515493298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910793558241        initial  <--
     2.3842e+06     2.3842e+07             8.1924e-11       -16.910793558241
     9.5367e+06     9.5367e+07             2.0481e-11       -16.910793558241
     3.8147e+07     3.8147e+08             5.1203e-12       -16.910793558241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8774
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.251251
====================================================
  Execution time = 2.8102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339239154738
                                         uncertainty =       0.004138954599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339239154738
                                         uncertainty =       0.004138954599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411812551
  error estimate for blocks of size 2^( 2) =       0.000423368373
  error estimate for blocks of size 2^( 3) =       0.000435488185
  error estimate for blocks of size 2^( 4) =       0.000446844077
  error estimate for blocks of size 2^( 5) =       0.000457884330
  error estimate for blocks of size 2^( 6) =       0.000466413255
  error estimate for blocks of size 2^( 7) =       0.000472865969

      target function =                  N/A
              le_mean =     -16.911061883817
             les_mean =     286.323193023507
             stat err =       0.000461001908
             autocorr =       1.253159317379
              std dev =       0.582390895199
             le_variance =       0.339179154811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691106188382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911061883817       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911061883817       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911061883817       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911061884735       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911061883647       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911061883817       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911061886180       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911061880213       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 8.614713e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911061883817       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911061883817       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911061883817       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911061875844       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911061883817       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911061911647       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911061816297       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911061927583       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.153634e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911061883817       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911061883817       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911061883817       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911061884098       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911061885846       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911061677783       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911061861294       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911061859761       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.384734e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5272e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8464
    reference variance = 0.167575
====================================================
  Execution time = 2.7394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4081e-01
  Total weights = 2.0000e+06
  Execution time = 3.4672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412802431
  error estimate for blocks of size 2^( 2) =       0.000424362066
  error estimate for blocks of size 2^( 3) =       0.000436598602
  error estimate for blocks of size 2^( 4) =       0.000447238578
  error estimate for blocks of size 2^( 5) =       0.000455883095
  error estimate for blocks of size 2^( 6) =       0.000462148074
  error estimate for blocks of size 2^( 7) =       0.000463735571

      target function =                  N/A
              le_mean =     -16.910383582345
             les_mean =     286.301884425975
             stat err =       0.000457251329
             autocorr =       1.226946032581
              std dev =       0.583790796721
             le_variance =       0.340811694337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552062
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552062
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412802431
  error estimate for blocks of size 2^( 2) =       0.000424362066
  error estimate for blocks of size 2^( 3) =       0.000436598602
  error estimate for blocks of size 2^( 4) =       0.000447238578
  error estimate for blocks of size 2^( 5) =       0.000455883095
  error estimate for blocks of size 2^( 6) =       0.000462148074
  error estimate for blocks of size 2^( 7) =       0.000463735571

      target function =                  N/A
              le_mean =     -16.910383582345
             les_mean =     286.301884425976
             stat err =       0.000457251329
             autocorr =       1.226946032586
              std dev =       0.583790796721
             le_variance =       0.340811694336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412802431
  error estimate for blocks of size 2^( 2) =       0.000424362066
  error estimate for blocks of size 2^( 3) =       0.000436598602
  error estimate for blocks of size 2^( 4) =       0.000447238578
  error estimate for blocks of size 2^( 5) =       0.000455883095
  error estimate for blocks of size 2^( 6) =       0.000462148074
  error estimate for blocks of size 2^( 7) =       0.000463735571

      target function =                  N/A
              le_mean =     -16.910383582345
             les_mean =     286.301884425975
             stat err =       0.000457251329
             autocorr =       1.226946032578
              std dev =       0.583790796721
             le_variance =       0.340811694336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340961552063
                                         uncertainty =       0.006187507550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412802431
  error estimate for blocks of size 2^( 2) =       0.000424362066
  error estimate for blocks of size 2^( 3) =       0.000436598602
  error estimate for blocks of size 2^( 4) =       0.000447238578
  error estimate for blocks of size 2^( 5) =       0.000455883095
  error estimate for blocks of size 2^( 6) =       0.000462148074
  error estimate for blocks of size 2^( 7) =       0.000463735571

      target function =                  N/A
              le_mean =     -16.910383582345
             les_mean =     286.301884425975
             stat err =       0.000457251329
             autocorr =       1.226946032584
              std dev =       0.583790796721
             le_variance =       0.340811694336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910383582345        initial
     2.3842e+07     2.3842e+08             8.6147e-12       -16.910383582345  <--
     9.5367e+07     9.5367e+08             2.1536e-12       -16.910383582345
     3.8147e+08     3.8147e+09             5.3847e-13       -16.910383582345

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 4.4730e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9585
    reference variance = 0.37474
====================================================
  Execution time = 2.8377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3960e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339677285169
                                         uncertainty =       0.005575863484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339677285169
                                         uncertainty =       0.005575863484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412065094
  error estimate for blocks of size 2^( 2) =       0.000423042022
  error estimate for blocks of size 2^( 3) =       0.000434882653
  error estimate for blocks of size 2^( 4) =       0.000445699506
  error estimate for blocks of size 2^( 5) =       0.000454288374
  error estimate for blocks of size 2^( 6) =       0.000461680089
  error estimate for blocks of size 2^( 7) =       0.000464201051

      target function =                  N/A
              le_mean =     -16.910602582766
             les_mean =     286.308074826126
             stat err =       0.000456467255
             autocorr =       1.227121605443
              std dev =       0.582748044760
             le_variance =       0.339595283672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691060258277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602582766       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602582766       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602582766       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602582273       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602582427       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602582484       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602591600       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910602583229       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.173554e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602582766       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602582766       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602582766       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602582766       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602575902       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602578458       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602588123       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910602580136       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 7.933920e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910602582766       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910602582766       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910602582766       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910602582766       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910602582766       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910602608765       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910602547927       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910602579039       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 1.983442e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5488e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.332017
====================================================
  Execution time = 2.7283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3146e-01
  Total weights = 2.0000e+06
  Execution time = 3.4587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156704
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156704
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407101897
  error estimate for blocks of size 2^( 2) =       0.000418624691
  error estimate for blocks of size 2^( 3) =       0.000430989271
  error estimate for blocks of size 2^( 4) =       0.000442298261
  error estimate for blocks of size 2^( 5) =       0.000452057648
  error estimate for blocks of size 2^( 6) =       0.000460705269
  error estimate for blocks of size 2^( 7) =       0.000466350027

      target function =                  N/A
              le_mean =     -16.911179520530
             les_mean =     286.319456518566
             stat err =       0.000455352801
             autocorr =       1.251093515715
              std dev =       0.575729023689
             le_variance =       0.331463908718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156714
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156714
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407101897
  error estimate for blocks of size 2^( 2) =       0.000418624691
  error estimate for blocks of size 2^( 3) =       0.000430989271
  error estimate for blocks of size 2^( 4) =       0.000442298261
  error estimate for blocks of size 2^( 5) =       0.000452057648
  error estimate for blocks of size 2^( 6) =       0.000460705269
  error estimate for blocks of size 2^( 7) =       0.000466350027

      target function =                  N/A
              le_mean =     -16.911179520530
             les_mean =     286.319456518577
             stat err =       0.000455352801
             autocorr =       1.251093515691
              std dev =       0.575729023697
             le_variance =       0.331463908728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156709
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156709
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407101897
  error estimate for blocks of size 2^( 2) =       0.000418624691
  error estimate for blocks of size 2^( 3) =       0.000430989271
  error estimate for blocks of size 2^( 4) =       0.000442298261
  error estimate for blocks of size 2^( 5) =       0.000452057648
  error estimate for blocks of size 2^( 6) =       0.000460705269
  error estimate for blocks of size 2^( 7) =       0.000466350027

      target function =                  N/A
              le_mean =     -16.911179520530
             les_mean =     286.319456518571
             stat err =       0.000455352801
             autocorr =       1.251093515711
              std dev =       0.575729023693
             le_variance =       0.331463908723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156705
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331411156705
                                         uncertainty =       0.003146127957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407101897
  error estimate for blocks of size 2^( 2) =       0.000418624691
  error estimate for blocks of size 2^( 3) =       0.000430989271
  error estimate for blocks of size 2^( 4) =       0.000442298261
  error estimate for blocks of size 2^( 5) =       0.000452057648
  error estimate for blocks of size 2^( 6) =       0.000460705269
  error estimate for blocks of size 2^( 7) =       0.000466350027

      target function =                  N/A
              le_mean =     -16.911179520530
             les_mean =     286.319456518566
             stat err =       0.000455352801
             autocorr =       1.251093515713
              std dev =       0.575729023689
             le_variance =       0.331463908718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911179520530        initial
     5.9605e+06     5.9605e+07             3.1736e-11       -16.911179520530  <--
     2.3842e+07     2.3842e+08             7.9339e-12       -16.911179520530
     9.5367e+07     9.5367e+08             1.9834e-12       -16.911179520530

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 4.4623e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8915
    reference variance = 0.137203
====================================================
  Execution time = 2.8114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680839910
                                         uncertainty =       0.004461448899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680839910
                                         uncertainty =       0.004461448899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409793771
  error estimate for blocks of size 2^( 2) =       0.000421744287
  error estimate for blocks of size 2^( 3) =       0.000433618738
  error estimate for blocks of size 2^( 4) =       0.000444346417
  error estimate for blocks of size 2^( 5) =       0.000453960496
  error estimate for blocks of size 2^( 6) =       0.000461663909
  error estimate for blocks of size 2^( 7) =       0.000465164840

      target function =                  N/A
              le_mean =     -16.911297677532
             les_mean =     286.327850839592
             stat err =       0.000456283915
             autocorr =       1.239765691466
              std dev =       0.579535908663
             le_variance =       0.335861869430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691129767753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911297677532       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911297677532       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911297677532       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911297677920       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911297677747       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911297676424       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911297677191       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911297678349       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.394384e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911297677532       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911297677532       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911297677532       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911297677533       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911297677155       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911297680783       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911297678699       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911297666922       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.485967e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911297677532       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911297677532       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911297677532       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911297670245       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911297677813       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911297673954       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911297673877       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911297679989       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 8.714855e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5319e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8281
    reference variance = 0.244258
====================================================
  Execution time = 2.7378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3274e-01
  Total weights = 2.0000e+06
  Execution time = 3.4675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367666
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367666
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407886701
  error estimate for blocks of size 2^( 2) =       0.000419760645
  error estimate for blocks of size 2^( 3) =       0.000431998464
  error estimate for blocks of size 2^( 4) =       0.000444333090
  error estimate for blocks of size 2^( 5) =       0.000454908817
  error estimate for blocks of size 2^( 6) =       0.000463412276
  error estimate for blocks of size 2^( 7) =       0.000468928111

      target function =                  N/A
              le_mean =     -16.910877135800
             les_mean =     286.310508457248
             stat err =       0.000457895573
             autocorr =       1.260241565604
              std dev =       0.576838904290
             le_variance =       0.332743121502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367635
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367635
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407886701
  error estimate for blocks of size 2^( 2) =       0.000419760645
  error estimate for blocks of size 2^( 3) =       0.000431998464
  error estimate for blocks of size 2^( 4) =       0.000444333090
  error estimate for blocks of size 2^( 5) =       0.000454908817
  error estimate for blocks of size 2^( 6) =       0.000463412276
  error estimate for blocks of size 2^( 7) =       0.000468928111

      target function =                  N/A
              le_mean =     -16.910877135800
             les_mean =     286.310508457231
             stat err =       0.000457895573
             autocorr =       1.260241565632
              std dev =       0.576838904264
             le_variance =       0.332743121472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367651
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367651
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407886701
  error estimate for blocks of size 2^( 2) =       0.000419760645
  error estimate for blocks of size 2^( 3) =       0.000431998464
  error estimate for blocks of size 2^( 4) =       0.000444333090
  error estimate for blocks of size 2^( 5) =       0.000454908817
  error estimate for blocks of size 2^( 6) =       0.000463412276
  error estimate for blocks of size 2^( 7) =       0.000468928111

      target function =                  N/A
              le_mean =     -16.910877135800
             les_mean =     286.310508457240
             stat err =       0.000457895573
             autocorr =       1.260241565620
              std dev =       0.576838904277
             le_variance =       0.332743121487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367664
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332798367664
                                         uncertainty =       0.003900627474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407886701
  error estimate for blocks of size 2^( 2) =       0.000419760645
  error estimate for blocks of size 2^( 3) =       0.000431998464
  error estimate for blocks of size 2^( 4) =       0.000444333090
  error estimate for blocks of size 2^( 5) =       0.000454908817
  error estimate for blocks of size 2^( 6) =       0.000463412276
  error estimate for blocks of size 2^( 7) =       0.000468928111

      target function =                  N/A
              le_mean =     -16.910877135800
             les_mean =     286.310508457247
             stat err =       0.000457895573
             autocorr =       1.260241565595
              std dev =       0.576838904288
             le_variance =       0.332743121500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910877135800        initial
     1.4901e+06     1.4901e+07             1.3944e-10       -16.910877135800  <--
     5.9605e+06     5.9605e+07             3.4860e-11       -16.910877135800
     2.3842e+07     2.3842e+08             8.7149e-12       -16.910877135800

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 4.4741e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9467
    reference variance = 0.188182
====================================================
  Execution time = 2.7943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4045e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340568801876
                                         uncertainty =       0.005486485809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340568801876
                                         uncertainty =       0.005486485809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412584003
  error estimate for blocks of size 2^( 2) =       0.000424273762
  error estimate for blocks of size 2^( 3) =       0.000436248724
  error estimate for blocks of size 2^( 4) =       0.000447591679
  error estimate for blocks of size 2^( 5) =       0.000457575583
  error estimate for blocks of size 2^( 6) =       0.000464373395
  error estimate for blocks of size 2^( 7) =       0.000467160027

      target function =                  N/A
              le_mean =     -16.910927105081
             les_mean =     286.319906501667
             stat err =       0.000459175171
             autocorr =       1.238602701022
              std dev =       0.583481892214
             le_variance =       0.340451118541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691092710508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910927105081       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910927105081       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910927105083       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910927104926       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910927105021       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910927104935       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910927105361       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910927105092       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.576017e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910927105081       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910927105081       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910927105081       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910927105081       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910927105394       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910927104928       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910927104875       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910927104883       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.894006e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910927105081       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910927105081       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910927105081       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910927105293       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910927105064       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910927103492       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910927099338       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910927105629       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.735056e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5063e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518626e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9633
    reference variance = 0.276588
====================================================
  Execution time = 2.9426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2542e-01
  Total weights = 2.0000e+06
  Execution time = 3.4605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882791
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882791
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370366
  error estimate for blocks of size 2^( 2) =       0.000415437313
  error estimate for blocks of size 2^( 3) =       0.000427270080
  error estimate for blocks of size 2^( 4) =       0.000439862386
  error estimate for blocks of size 2^( 5) =       0.000450185983
  error estimate for blocks of size 2^( 6) =       0.000458570348
  error estimate for blocks of size 2^( 7) =       0.000466985254

      target function =                  N/A
              le_mean =     -16.910226002078
             les_mean =     286.281158583044
             stat err =       0.000453900993
             autocorr =       1.266234921840
              std dev =       0.570451842322
             le_variance =       0.325415304409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882949
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882949
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370366
  error estimate for blocks of size 2^( 2) =       0.000415437313
  error estimate for blocks of size 2^( 3) =       0.000427270080
  error estimate for blocks of size 2^( 4) =       0.000439862386
  error estimate for blocks of size 2^( 5) =       0.000450185983
  error estimate for blocks of size 2^( 6) =       0.000458570348
  error estimate for blocks of size 2^( 7) =       0.000466985254

      target function =                  N/A
              le_mean =     -16.910226002079
             les_mean =     286.281158583239
             stat err =       0.000453900993
             autocorr =       1.266234921701
              std dev =       0.570451842461
             le_variance =       0.325415304567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882870
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882870
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370366
  error estimate for blocks of size 2^( 2) =       0.000415437313
  error estimate for blocks of size 2^( 3) =       0.000427270080
  error estimate for blocks of size 2^( 4) =       0.000439862386
  error estimate for blocks of size 2^( 5) =       0.000450185983
  error estimate for blocks of size 2^( 6) =       0.000458570348
  error estimate for blocks of size 2^( 7) =       0.000466985254

      target function =                  N/A
              le_mean =     -16.910226002078
             les_mean =     286.281158583142
             stat err =       0.000453900993
             autocorr =       1.266234921776
              std dev =       0.570451842391
             le_variance =       0.325415304488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882801
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325467882801
                                         uncertainty =       0.003194437593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370366
  error estimate for blocks of size 2^( 2) =       0.000415437313
  error estimate for blocks of size 2^( 3) =       0.000427270080
  error estimate for blocks of size 2^( 4) =       0.000439862386
  error estimate for blocks of size 2^( 5) =       0.000450185983
  error estimate for blocks of size 2^( 6) =       0.000458570348
  error estimate for blocks of size 2^( 7) =       0.000466985254

      target function =                  N/A
              le_mean =     -16.910226002078
             les_mean =     286.281158583056
             stat err =       0.000453900993
             autocorr =       1.266234921820
              std dev =       0.570451842331
             le_variance =       0.325415304419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910226002078        initial
     3.7253e+05     3.7253e+06             7.5760e-10       -16.910226002079  <--
     1.4901e+06     1.4901e+07             1.8940e-10       -16.910226002078
     5.9605e+06     5.9605e+07             4.7351e-11       -16.910226002078

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 4.6747e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575831e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518626e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.296351
====================================================
  Execution time = 2.8071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333024770186
                                         uncertainty =       0.003254105716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333024770186
                                         uncertainty =       0.003254105716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407987013
  error estimate for blocks of size 2^( 2) =       0.000419579333
  error estimate for blocks of size 2^( 3) =       0.000432083135
  error estimate for blocks of size 2^( 4) =       0.000443873082
  error estimate for blocks of size 2^( 5) =       0.000454205641
  error estimate for blocks of size 2^( 6) =       0.000463555197
  error estimate for blocks of size 2^( 7) =       0.000465607731

      target function =                  N/A
              le_mean =     -16.911846595429
             les_mean =     286.343461905869
             stat err =       0.000456810413
             autocorr =       1.253658682132
              std dev =       0.576980766588
             le_variance =       0.332906805012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691184659543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911846595429       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911846595432       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911846595434       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911846595428       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911846595426       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911846595368       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911846595462       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.061472e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911846595429       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911846595430       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911846595430       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911846595439       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911846595491       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911846595330       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911846595394       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 5.153684e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911846595429       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911846595429       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911846595429       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911846595429       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911846594801       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911846596841       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911846595070       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.288421e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5211e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690904e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518625e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9756
    reference variance = 0.22372
====================================================
  Execution time = 2.7325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3947e-01
  Total weights = 2.0000e+06
  Execution time = 3.4742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507534375
                                         uncertainty =       0.003888448148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507534375
                                         uncertainty =       0.003888448148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411988045
  error estimate for blocks of size 2^( 2) =       0.000423460913
  error estimate for blocks of size 2^( 3) =       0.000436264072
  error estimate for blocks of size 2^( 4) =       0.000448627897
  error estimate for blocks of size 2^( 5) =       0.000459434940
  error estimate for blocks of size 2^( 6) =       0.000467460236
  error estimate for blocks of size 2^( 7) =       0.000473112338

      target function =                  N/A
              le_mean =     -16.910470160685
             les_mean =     286.303469183867
             stat err =       0.000462158853
             autocorr =       1.258384398859
              std dev =       0.582639080541
             le_variance =       0.339468298174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507533470
                                         uncertainty =       0.003888448137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507533470
                                         uncertainty =       0.003888448137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411988044
  error estimate for blocks of size 2^( 2) =       0.000423460913
  error estimate for blocks of size 2^( 3) =       0.000436264071
  error estimate for blocks of size 2^( 4) =       0.000448627896
  error estimate for blocks of size 2^( 5) =       0.000459434939
  error estimate for blocks of size 2^( 6) =       0.000467460236
  error estimate for blocks of size 2^( 7) =       0.000473112338

      target function =                  N/A
              le_mean =     -16.910470160690
             les_mean =     286.303469183138
             stat err =       0.000462158852
             autocorr =       1.258384399642
              std dev =       0.582639079765
             le_variance =       0.339468297269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507533923
                                         uncertainty =       0.003888448143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507533923
                                         uncertainty =       0.003888448143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411988045
  error estimate for blocks of size 2^( 2) =       0.000423460913
  error estimate for blocks of size 2^( 3) =       0.000436264072
  error estimate for blocks of size 2^( 4) =       0.000448627897
  error estimate for blocks of size 2^( 5) =       0.000459434939
  error estimate for blocks of size 2^( 6) =       0.000467460236
  error estimate for blocks of size 2^( 7) =       0.000473112338

      target function =                  N/A
              le_mean =     -16.910470160688
             les_mean =     286.303469183503
             stat err =       0.000462158853
             autocorr =       1.258384399253
              std dev =       0.582639080153
             le_variance =       0.339468297721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507534318
                                         uncertainty =       0.003888448148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507534318
                                         uncertainty =       0.003888448148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411988045
  error estimate for blocks of size 2^( 2) =       0.000423460913
  error estimate for blocks of size 2^( 3) =       0.000436264072
  error estimate for blocks of size 2^( 4) =       0.000448627897
  error estimate for blocks of size 2^( 5) =       0.000459434940
  error estimate for blocks of size 2^( 6) =       0.000467460236
  error estimate for blocks of size 2^( 7) =       0.000473112338

      target function =                  N/A
              le_mean =     -16.910470160686
             les_mean =     286.303469183822
             stat err =       0.000462158853
             autocorr =       1.258384398908
              std dev =       0.582639080492
             le_variance =       0.339468298117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910470160685        initial
     9.3132e+04     9.3132e+05             2.0615e-09       -16.910470160690  <--
     3.7253e+05     3.7253e+06             5.1537e-10       -16.910470160688
     1.4901e+06     1.4901e+07             1.2884e-10       -16.910470160686

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 4.4738e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690903e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208272e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944347e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518624e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743915e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0554
    reference variance = 0.690028
====================================================
  Execution time = 2.7774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579549429
                                         uncertainty =       0.005151597194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579549429
                                         uncertainty =       0.005151597194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410799496
  error estimate for blocks of size 2^( 2) =       0.000422458442
  error estimate for blocks of size 2^( 3) =       0.000434700490
  error estimate for blocks of size 2^( 4) =       0.000446773965
  error estimate for blocks of size 2^( 5) =       0.000456429774
  error estimate for blocks of size 2^( 6) =       0.000463012688
  error estimate for blocks of size 2^( 7) =       0.000471248089

      target function =                  N/A
              le_mean =     -16.910991805687
             les_mean =     286.319156135146
             stat err =       0.000459366129
             autocorr =       1.250426401445
              std dev =       0.580958218704
             le_variance =       0.337512451879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691099180569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910991805687       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910991805688       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910991805684       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910991805711       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910991805728       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910991805721       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910991805800       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 8.659897e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910991805687       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910991805688       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910991805686       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910991805675       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910991805696       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910991805765       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910991805687       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.164979e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910991805687       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910991805687       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910991805687       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910991805660       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910991805693       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910991805527       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910991805673       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 5.412451e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4836e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690903e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501783e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208271e-03 1 1  ON 13
 ud_4                -5.843371e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798729e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944348e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515899e-02 1 1  ON 43
eH2_4                -5.518624e-03 1 1  ON 44
eH2_5                 3.995089e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8926
    reference variance = 0.561477
====================================================
  Execution time = 2.7232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3561e-01
  Total weights = 2.0000e+06
  Execution time = 3.4599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477892799
                                         uncertainty =       0.003737549724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477892799
                                         uncertainty =       0.003737549724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409640250
  error estimate for blocks of size 2^( 2) =       0.000421338143
  error estimate for blocks of size 2^( 3) =       0.000433510454
  error estimate for blocks of size 2^( 4) =       0.000444506711
  error estimate for blocks of size 2^( 5) =       0.000454263535
  error estimate for blocks of size 2^( 6) =       0.000462112925
  error estimate for blocks of size 2^( 7) =       0.000465046308

      target function =                  N/A
              le_mean =     -16.910540543069
             les_mean =     286.301991559575
             stat err =       0.000456482370
             autocorr =       1.241774602234
              std dev =       0.579318797026
             le_variance =       0.335610268588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477888263
                                         uncertainty =       0.003737549675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477888263
                                         uncertainty =       0.003737549675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409640247
  error estimate for blocks of size 2^( 2) =       0.000421338141
  error estimate for blocks of size 2^( 3) =       0.000433510452
  error estimate for blocks of size 2^( 4) =       0.000444506708
  error estimate for blocks of size 2^( 5) =       0.000454263533
  error estimate for blocks of size 2^( 6) =       0.000462112923
  error estimate for blocks of size 2^( 7) =       0.000465046306

      target function =                  N/A
              le_mean =     -16.910540543118
             les_mean =     286.301991556677
             stat err =       0.000456482367
             autocorr =       1.241774606733
              std dev =       0.579318793109
             le_variance =       0.335610264050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477890531
                                         uncertainty =       0.003737549699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477890531
                                         uncertainty =       0.003737549699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409640248
  error estimate for blocks of size 2^( 2) =       0.000421338142
  error estimate for blocks of size 2^( 3) =       0.000433510453
  error estimate for blocks of size 2^( 4) =       0.000444506710
  error estimate for blocks of size 2^( 5) =       0.000454263534
  error estimate for blocks of size 2^( 6) =       0.000462112924
  error estimate for blocks of size 2^( 7) =       0.000465046307

      target function =                  N/A
              le_mean =     -16.910540543094
             les_mean =     286.301991558126
             stat err =       0.000456482369
             autocorr =       1.241774604491
              std dev =       0.579318795067
             le_variance =       0.335610266318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477892516
                                         uncertainty =       0.003737549721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335477892516
                                         uncertainty =       0.003737549721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409640250
  error estimate for blocks of size 2^( 2) =       0.000421338143
  error estimate for blocks of size 2^( 3) =       0.000433510454
  error estimate for blocks of size 2^( 4) =       0.000444506711
  error estimate for blocks of size 2^( 5) =       0.000454263535
  error estimate for blocks of size 2^( 6) =       0.000462112925
  error estimate for blocks of size 2^( 7) =       0.000465046308

      target function =                  N/A
              le_mean =     -16.910540543072
             les_mean =     286.301991559394
             stat err =       0.000456482370
             autocorr =       1.241774602515
              std dev =       0.579318796781
             le_variance =       0.335610268304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910540543069        initial
     2.3283e+04     2.3283e+05             8.6599e-09       -16.910540543118  <--
     9.3132e+04     9.3132e+05             2.1650e-09       -16.910540543094
     3.7253e+05     3.7253e+06             5.4125e-10       -16.910540543072

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 4.4608e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690903e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208271e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302592e-01 1 1  ON 21
 eO_2                -9.798728e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944348e-02 1 1  ON 39
eH2_0                -2.698169e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515900e-02 1 1  ON 43
eH2_4                -5.518621e-03 1 1  ON 44
eH2_5                 3.995088e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119005e-01 1 1  ON 48
eH2_9                 9.507266e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.158555
====================================================
  Execution time = 2.7946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332792284314
                                         uncertainty =       0.003360951166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332792284314
                                         uncertainty =       0.003360951166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407931834
  error estimate for blocks of size 2^( 2) =       0.000419663345
  error estimate for blocks of size 2^( 3) =       0.000431755579
  error estimate for blocks of size 2^( 4) =       0.000443027534
  error estimate for blocks of size 2^( 5) =       0.000452670576
  error estimate for blocks of size 2^( 6) =       0.000460366741
  error estimate for blocks of size 2^( 7) =       0.000464296293

      target function =                  N/A
              le_mean =     -16.911703735639
             les_mean =     286.338539838583
             stat err =       0.000455090286
             autocorr =       1.244571737681
              std dev =       0.576902732669
             le_variance =       0.332816762961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691170373564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911703735639       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911703735834       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911703736045       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911703736034       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911703735943       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911703735969       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911703735969       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911703735951       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.725664e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911703735639       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911703735688       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911703735741       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911703735748       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911703735715       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911703735711       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911703735727       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911703735725       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.314461e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911703735639       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911703735651       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911703735664       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911703735667       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911703735613       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911703735686       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911703735645       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911703735616       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.328634e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5065e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815937e-02 1 1  ON 2
 uu_3                -1.575830e-02 1 1  ON 3
 uu_4                -6.690902e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780117e-02 1 1  ON 12
 ud_3                -2.208272e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798723e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526143e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700396e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944349e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515900e-02 1 1  ON 43
eH2_4                -5.518621e-03 1 1  ON 44
eH2_5                 3.995088e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507267e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.357124
====================================================
  Execution time = 2.7225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3363e-01
  Total weights = 2.0000e+06
  Execution time = 3.4618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640203961
                                         uncertainty =       0.003059882804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640203961
                                         uncertainty =       0.003059882804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408427678
  error estimate for blocks of size 2^( 2) =       0.000419634161
  error estimate for blocks of size 2^( 3) =       0.000431457463
  error estimate for blocks of size 2^( 4) =       0.000443389584
  error estimate for blocks of size 2^( 5) =       0.000454562849
  error estimate for blocks of size 2^( 6) =       0.000462955381
  error estimate for blocks of size 2^( 7) =       0.000466954311

      target function =                  N/A
              le_mean =     -16.910530955464
             les_mean =     286.299683365921
             stat err =       0.000456965531
             autocorr =       1.251804628958
              std dev =       0.577603962099
             le_variance =       0.333626337032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640193585
                                         uncertainty =       0.003059882653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640193585
                                         uncertainty =       0.003059882653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408427672
  error estimate for blocks of size 2^( 2) =       0.000419634155
  error estimate for blocks of size 2^( 3) =       0.000431457457
  error estimate for blocks of size 2^( 4) =       0.000443389579
  error estimate for blocks of size 2^( 5) =       0.000454562844
  error estimate for blocks of size 2^( 6) =       0.000462955377
  error estimate for blocks of size 2^( 7) =       0.000466954308

      target function =                  N/A
              le_mean =     -16.910530955716
             les_mean =     286.299683364074
             stat err =       0.000456965527
             autocorr =       1.251804646871
              std dev =       0.577603953111
             le_variance =       0.333626326650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640198773
                                         uncertainty =       0.003059882728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640198773
                                         uncertainty =       0.003059882728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408427675
  error estimate for blocks of size 2^( 2) =       0.000419634158
  error estimate for blocks of size 2^( 3) =       0.000431457460
  error estimate for blocks of size 2^( 4) =       0.000443389581
  error estimate for blocks of size 2^( 5) =       0.000454562846
  error estimate for blocks of size 2^( 6) =       0.000462955379
  error estimate for blocks of size 2^( 7) =       0.000466954310

      target function =                  N/A
              le_mean =     -16.910530955590
             les_mean =     286.299683364998
             stat err =       0.000456965529
             autocorr =       1.251804637919
              std dev =       0.577603957605
             le_variance =       0.333626331841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640203313
                                         uncertainty =       0.003059882794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640203313
                                         uncertainty =       0.003059882794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408427678
  error estimate for blocks of size 2^( 2) =       0.000419634161
  error estimate for blocks of size 2^( 3) =       0.000431457462
  error estimate for blocks of size 2^( 4) =       0.000443389583
  error estimate for blocks of size 2^( 5) =       0.000454562848
  error estimate for blocks of size 2^( 6) =       0.000462955381
  error estimate for blocks of size 2^( 7) =       0.000466954311

      target function =                  N/A
              le_mean =     -16.910530955480
             les_mean =     286.299683365806
             stat err =       0.000456965531
             autocorr =       1.251804630066
              std dev =       0.577603961537
             le_variance =       0.333626336383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910530955464        initial
     5.8208e+03     5.8208e+04             3.7257e-08       -16.910530955716  <--
     2.3283e+04     2.3283e+05             9.3145e-09       -16.910530955590
     9.3132e+04     9.3132e+05             2.3286e-09       -16.910530955480

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 4.4595e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815939e-02 1 1  ON 2
 uu_3                -1.575827e-02 1 1  ON 3
 uu_4                -6.690901e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780118e-02 1 1  ON 12
 ud_3                -2.208274e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798708e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647651e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944350e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515902e-02 1 1  ON 43
eH2_4                -5.518623e-03 1 1  ON 44
eH2_5                 3.995087e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507269e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.328023
====================================================
  Execution time = 2.7711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3992e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.3284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339708154807
                                         uncertainty =       0.005275154285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339708154807
                                         uncertainty =       0.005275154285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412263305
  error estimate for blocks of size 2^( 2) =       0.000423849129
  error estimate for blocks of size 2^( 3) =       0.000436282803
  error estimate for blocks of size 2^( 4) =       0.000449012113
  error estimate for blocks of size 2^( 5) =       0.000459847840
  error estimate for blocks of size 2^( 6) =       0.000469225512
  error estimate for blocks of size 2^( 7) =       0.000474068636

      target function =                  N/A
              le_mean =     -16.910841903744
             les_mean =     286.316495789008
             stat err =       0.000463038525
             autocorr =       1.261493133506
              std dev =       0.583028357406
             le_variance =       0.339922065540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691084190374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841903744       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841904026       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841904654       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910841904594       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910841904207       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910841904119       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910841904315       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910841904380       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.478587e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841903744       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841903815       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841903972       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910841903955       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910841903862       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910841903838       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910841903888       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910841903902       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.696600e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841903744       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841903762       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841903801       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910841903810       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910841903789       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910841903765       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910841903762       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910841903819       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.241583e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8069e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815940e-02 1 1  ON 2
 uu_3                -1.575826e-02 1 1  ON 3
 uu_4                -6.690899e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780119e-02 1 1  ON 12
 ud_3                -2.208273e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471496e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798695e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725079e-02 1 1  ON 33
eH1_4                -7.647663e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944352e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627242e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515903e-02 1 1  ON 43
eH2_4                -5.518614e-03 1 1  ON 44
eH2_5                 3.995086e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507272e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9345
    reference variance = 0.156908
====================================================
  Execution time = 2.7178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4324e-01
  Total weights = 2.0000e+06
  Execution time = 3.4815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389963330
                                         uncertainty =       0.009249070051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389963330
                                         uncertainty =       0.009249070051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414269858
  error estimate for blocks of size 2^( 2) =       0.000425848677
  error estimate for blocks of size 2^( 3) =       0.000437809057
  error estimate for blocks of size 2^( 4) =       0.000449213418
  error estimate for blocks of size 2^( 5) =       0.000459390604
  error estimate for blocks of size 2^( 6) =       0.000466965436
  error estimate for blocks of size 2^( 7) =       0.000470699330

      target function =                  N/A
              le_mean =     -16.911081398151
             les_mean =     286.327912913319
             stat err =       0.000461567197
             autocorr =       1.241375594051
              std dev =       0.585866051280
             le_variance =       0.343239030042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389960177
                                         uncertainty =       0.009249063962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389960177
                                         uncertainty =       0.009249063962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414269856
  error estimate for blocks of size 2^( 2) =       0.000425848675
  error estimate for blocks of size 2^( 3) =       0.000437809054
  error estimate for blocks of size 2^( 4) =       0.000449213416
  error estimate for blocks of size 2^( 5) =       0.000459390603
  error estimate for blocks of size 2^( 6) =       0.000466965431
  error estimate for blocks of size 2^( 7) =       0.000470699322

      target function =                  N/A
              le_mean =     -16.911081398086
             les_mean =     286.327912907963
             stat err =       0.000461567193
             autocorr =       1.241375582234
              std dev =       0.585866048596
             le_variance =       0.343239026898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389961754
                                         uncertainty =       0.009249067006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389961754
                                         uncertainty =       0.009249067006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414269857
  error estimate for blocks of size 2^( 2) =       0.000425848676
  error estimate for blocks of size 2^( 3) =       0.000437809055
  error estimate for blocks of size 2^( 4) =       0.000449213417
  error estimate for blocks of size 2^( 5) =       0.000459390603
  error estimate for blocks of size 2^( 6) =       0.000466965433
  error estimate for blocks of size 2^( 7) =       0.000470699326

      target function =                  N/A
              le_mean =     -16.911081398119
             les_mean =     286.327912910641
             stat err =       0.000461567195
             autocorr =       1.241375588150
              std dev =       0.585866049939
             le_variance =       0.343239028471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389963133
                                         uncertainty =       0.009249069670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343389963133
                                         uncertainty =       0.009249069670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414269858
  error estimate for blocks of size 2^( 2) =       0.000425848677
  error estimate for blocks of size 2^( 3) =       0.000437809056
  error estimate for blocks of size 2^( 4) =       0.000449213418
  error estimate for blocks of size 2^( 5) =       0.000459390604
  error estimate for blocks of size 2^( 6) =       0.000466965436
  error estimate for blocks of size 2^( 7) =       0.000470699329

      target function =                  N/A
              le_mean =     -16.911081398147
             les_mean =     286.327912912984
             stat err =       0.000461567197
             autocorr =       1.241375593315
              std dev =       0.585866051112
             le_variance =       0.343239029846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911081398151        initial  <--
     1.4552e+03     1.4552e+04             1.4786e-07       -16.911081398086
     5.8208e+03     5.8208e+04             3.6966e-08       -16.911081398119
     2.3283e+04     2.3283e+05             9.2416e-09       -16.911081398147

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5850
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815939e-02 1 1  ON 2
 uu_3                -1.575827e-02 1 1  ON 3
 uu_4                -6.690901e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780118e-02 1 1  ON 12
 ud_3                -2.208274e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798708e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725077e-02 1 1  ON 33
eH1_4                -7.647651e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944350e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515902e-02 1 1  ON 43
eH2_4                -5.518623e-03 1 1  ON 44
eH2_5                 3.995087e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507269e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2662e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9835
    reference variance = 0.410938
====================================================
  Execution time = 2.7752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3559e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335620037168
                                         uncertainty =       0.003212876994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335620037168
                                         uncertainty =       0.003212876994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409628314
  error estimate for blocks of size 2^( 2) =       0.000421326438
  error estimate for blocks of size 2^( 3) =       0.000433472064
  error estimate for blocks of size 2^( 4) =       0.000445304986
  error estimate for blocks of size 2^( 5) =       0.000456084545
  error estimate for blocks of size 2^( 6) =       0.000463309971
  error estimate for blocks of size 2^( 7) =       0.000468960120

      target function =                  N/A
              le_mean =     -16.910885175216
             les_mean =     286.313627952203
             stat err =       0.000458414906
             autocorr =       1.252384043525
              std dev =       0.579301916684
             le_variance =       0.335590710673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691088517522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910885175216       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910885175212       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910885175218       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910885175204       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910885175175       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910885175178       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910885175217       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910885175215       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.916474e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910885175216       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910885175215       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910885175216       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910885175213       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910885175204       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910885175236       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910885175005       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910885175210       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.791193e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910885175216       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910885175215       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910885175216       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910885175205       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910885175234       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910885175379       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910885175108       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910885175211       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.197799e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4933e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815939e-02 1 1  ON 2
 uu_3                -1.575827e-02 1 1  ON 3
 uu_4                -6.690901e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780118e-02 1 1  ON 12
 ud_3                -2.208274e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798708e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044770e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725078e-02 1 1  ON 33
eH1_4                -7.647652e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944351e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515902e-02 1 1  ON 43
eH2_4                -5.518624e-03 1 1  ON 44
eH2_5                 3.995086e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507269e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8337
    reference variance = 0.15802
====================================================
  Execution time = 2.7393e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3045e-01
  Total weights = 2.0000e+06
  Execution time = 3.4512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351541873
                                         uncertainty =       0.003140233455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351541873
                                         uncertainty =       0.003140233455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406476202
  error estimate for blocks of size 2^( 2) =       0.000417794531
  error estimate for blocks of size 2^( 3) =       0.000429911459
  error estimate for blocks of size 2^( 4) =       0.000441333208
  error estimate for blocks of size 2^( 5) =       0.000450271852
  error estimate for blocks of size 2^( 6) =       0.000458338808
  error estimate for blocks of size 2^( 7) =       0.000461353009

      target function =                  N/A
              le_mean =     -16.911293514039
             les_mean =     286.322293959138
             stat err =       0.000452824219
             autocorr =       1.241049332064
              std dev =       0.574844158336
             le_variance =       0.330445806374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351542641
                                         uncertainty =       0.003140233498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351542641
                                         uncertainty =       0.003140233498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406476203
  error estimate for blocks of size 2^( 2) =       0.000417794531
  error estimate for blocks of size 2^( 3) =       0.000429911460
  error estimate for blocks of size 2^( 4) =       0.000441333209
  error estimate for blocks of size 2^( 5) =       0.000450271853
  error estimate for blocks of size 2^( 6) =       0.000458338809
  error estimate for blocks of size 2^( 7) =       0.000461353010

      target function =                  N/A
              le_mean =     -16.911293514057
             les_mean =     286.322293960502
             stat err =       0.000452824220
             autocorr =       1.241049332345
              std dev =       0.574844159007
             le_variance =       0.330445807145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351542257
                                         uncertainty =       0.003140233476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351542257
                                         uncertainty =       0.003140233476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406476203
  error estimate for blocks of size 2^( 2) =       0.000417794531
  error estimate for blocks of size 2^( 3) =       0.000429911459
  error estimate for blocks of size 2^( 4) =       0.000441333208
  error estimate for blocks of size 2^( 5) =       0.000450271852
  error estimate for blocks of size 2^( 6) =       0.000458338809
  error estimate for blocks of size 2^( 7) =       0.000461353009

      target function =                  N/A
              le_mean =     -16.911293514048
             les_mean =     286.322293959820
             stat err =       0.000452824220
             autocorr =       1.241049332209
              std dev =       0.574844158672
             le_variance =       0.330445806759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351541921
                                         uncertainty =       0.003140233458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330351541921
                                         uncertainty =       0.003140233458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406476203
  error estimate for blocks of size 2^( 2) =       0.000417794531
  error estimate for blocks of size 2^( 3) =       0.000429911459
  error estimate for blocks of size 2^( 4) =       0.000441333208
  error estimate for blocks of size 2^( 5) =       0.000450271852
  error estimate for blocks of size 2^( 6) =       0.000458338808
  error estimate for blocks of size 2^( 7) =       0.000461353009

      target function =                  N/A
              le_mean =     -16.911293514040
             les_mean =     286.322293959223
             stat err =       0.000452824219
             autocorr =       1.241049332085
              std dev =       0.574844158378
             le_variance =       0.330445806422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911293514039        initial
     1.4552e+04     1.4552e+05             1.9165e-08       -16.911293514057  <--
     5.8208e+04     5.8208e+05             4.7912e-09       -16.911293514048
     2.3283e+05     2.3283e+06             1.1978e-09       -16.911293514040

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 4.4762e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815939e-02 1 1  ON 2
 uu_3                -1.575828e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780119e-02 1 1  ON 12
 ud_3                -2.208274e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798706e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725079e-02 1 1  ON 33
eH1_4                -7.647656e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944352e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515902e-02 1 1  ON 43
eH2_4                -5.518627e-03 1 1  ON 44
eH2_5                 3.995085e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507270e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9706e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.249814
====================================================
  Execution time = 2.7874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4052e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340526960344
                                         uncertainty =       0.004472539820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340526960344
                                         uncertainty =       0.004472539820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412622815
  error estimate for blocks of size 2^( 2) =       0.000424746626
  error estimate for blocks of size 2^( 3) =       0.000437004103
  error estimate for blocks of size 2^( 4) =       0.000449412814
  error estimate for blocks of size 2^( 5) =       0.000459656314
  error estimate for blocks of size 2^( 6) =       0.000468925054
  error estimate for blocks of size 2^( 7) =       0.000475923102

      target function =                  N/A
              le_mean =     -16.910356753680
             les_mean =     286.300680541631
             stat err =       0.000463479321
             autocorr =       1.261694613276
              std dev =       0.583536781323
             le_variance =       0.340515175157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691035675368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356753680       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356753957       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356754198       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910356754408       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910356754486       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910356754539       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910356754619       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910356754584       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 8.432246e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356753680       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356753749       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356753810       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910356753862       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910356753881       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910356753894       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910356753900       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910356753888       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.108181e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356753680       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356753697       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356753712       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910356753707       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910356753732       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910356753719       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910356753730       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910356753655       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.270528e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5026e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.109028e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815938e-02 1 1  ON 2
 uu_3                -1.575827e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052506e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439600e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394526e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780118e-02 1 1  ON 12
 ud_3                -2.208275e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302591e-01 1 1  ON 21
 eO_2                -9.798711e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725080e-02 1 1  ON 33
eH1_4                -7.647659e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082707e-01 1 1  ON 38
eH1_9                 9.944353e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515902e-02 1 1  ON 43
eH2_4                -5.518630e-03 1 1  ON 44
eH2_5                 3.995084e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.2361
====================================================
  Execution time = 2.7449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3009e-01
  Total weights = 2.0000e+06
  Execution time = 3.4551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193484230
                                         uncertainty =       0.002962718031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193484230
                                         uncertainty =       0.002962718031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406255285
  error estimate for blocks of size 2^( 2) =       0.000418146155
  error estimate for blocks of size 2^( 3) =       0.000430795986
  error estimate for blocks of size 2^( 4) =       0.000442159912
  error estimate for blocks of size 2^( 5) =       0.000452527773
  error estimate for blocks of size 2^( 6) =       0.000459517761
  error estimate for blocks of size 2^( 7) =       0.000468702336

      target function =                  N/A
              le_mean =     -16.910118417368
             les_mean =     286.282191437061
             stat err =       0.000455726946
             autocorr =       1.258378728361
              std dev =       0.574531733404
             le_variance =       0.330086712689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193483109
                                         uncertainty =       0.002962717973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193483109
                                         uncertainty =       0.002962717973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406255284
  error estimate for blocks of size 2^( 2) =       0.000418146155
  error estimate for blocks of size 2^( 3) =       0.000430795985
  error estimate for blocks of size 2^( 4) =       0.000442159912
  error estimate for blocks of size 2^( 5) =       0.000452527770
  error estimate for blocks of size 2^( 6) =       0.000459517759
  error estimate for blocks of size 2^( 7) =       0.000468702332

      target function =                  N/A
              le_mean =     -16.910118417539
             les_mean =     286.282191441711
             stat err =       0.000455726943
             autocorr =       1.258378720384
              std dev =       0.574531732439
             le_variance =       0.330086711579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193483668
                                         uncertainty =       0.002962718002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193483668
                                         uncertainty =       0.002962718002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406255284
  error estimate for blocks of size 2^( 2) =       0.000418146155
  error estimate for blocks of size 2^( 3) =       0.000430795986
  error estimate for blocks of size 2^( 4) =       0.000442159912
  error estimate for blocks of size 2^( 5) =       0.000452527772
  error estimate for blocks of size 2^( 6) =       0.000459517760
  error estimate for blocks of size 2^( 7) =       0.000468702334

      target function =                  N/A
              le_mean =     -16.910118417453
             les_mean =     286.282191439385
             stat err =       0.000455726944
             autocorr =       1.258378724376
              std dev =       0.574531732921
             le_variance =       0.330086712133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193484160
                                         uncertainty =       0.002962718028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330193484160
                                         uncertainty =       0.002962718028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406255285
  error estimate for blocks of size 2^( 2) =       0.000418146155
  error estimate for blocks of size 2^( 3) =       0.000430795986
  error estimate for blocks of size 2^( 4) =       0.000442159912
  error estimate for blocks of size 2^( 5) =       0.000452527773
  error estimate for blocks of size 2^( 6) =       0.000459517761
  error estimate for blocks of size 2^( 7) =       0.000468702335

      target function =                  N/A
              le_mean =     -16.910118417379
             les_mean =     286.282191437351
             stat err =       0.000455726945
             autocorr =       1.258378727867
              std dev =       0.574531733344
             le_variance =       0.330086712619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910118417368        initial
     3.6380e+03     3.6380e+04             8.4322e-08       -16.910118417539  <--
     1.4552e+04     1.4552e+05             2.1082e-08       -16.910118417453
     5.8208e+04     5.8208e+05             5.2705e-09       -16.910118417379

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 4.4848e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208278e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798727e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725082e-02 1 1  ON 33
eH1_4                -7.647669e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944357e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518640e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.232726
====================================================
  Execution time = 2.7849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4021e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339979471880
                                         uncertainty =       0.007747950759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339979471880
                                         uncertainty =       0.007747950759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412435749
  error estimate for blocks of size 2^( 2) =       0.000423985742
  error estimate for blocks of size 2^( 3) =       0.000435678149
  error estimate for blocks of size 2^( 4) =       0.000446952551
  error estimate for blocks of size 2^( 5) =       0.000455974463
  error estimate for blocks of size 2^( 6) =       0.000462742749
  error estimate for blocks of size 2^( 7) =       0.000466771351

      target function =                  N/A
              le_mean =     -16.910733200377
             les_mean =     286.313103697788
             stat err =       0.000458110278
             autocorr =       1.233750860691
              std dev =       0.583272229363
             le_variance =       0.340206493546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691073320038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910733200377       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910733200907       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910733201265       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910733201856       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910733202032       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910733202024       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910733201922       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.559089e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910733200377       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910733200510       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910733200599       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910733200747       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910733200790       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910733200787       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910733200765       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.398681e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910733200377       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910733200410       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910733200433       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910733200471       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910733200474       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910733200480       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910733200472       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.599730e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5123e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460876e-01 1 1  ON 1
 uu_2                 4.815933e-02 1 1  ON 2
 uu_3                -1.575823e-02 1 1  ON 3
 uu_4                -6.690902e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345521e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780117e-02 1 1  ON 12
 ud_3                -2.208240e-03 1 1  ON 13
 ud_4                -5.843370e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471496e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798708e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425956e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719576e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725084e-02 1 1  ON 33
eH1_4                -7.647685e-03 1 1  ON 34
eH1_5                 3.700392e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944362e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518657e-03 1 1  ON 44
eH2_5                 3.995076e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.157951
====================================================
  Execution time = 2.7411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4573e-01
  Total weights = 2.0000e+06
  Execution time = 3.4781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697702627
                                         uncertainty =       0.012966080300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697702627
                                         uncertainty =       0.012966080300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415770828
  error estimate for blocks of size 2^( 2) =       0.000427289186
  error estimate for blocks of size 2^( 3) =       0.000438794470
  error estimate for blocks of size 2^( 4) =       0.000449323059
  error estimate for blocks of size 2^( 5) =       0.000457992111
  error estimate for blocks of size 2^( 6) =       0.000465561683
  error estimate for blocks of size 2^( 7) =       0.000469947691

      target function =                  N/A
              le_mean =     -16.910923535265
             les_mean =     286.325065405937
             stat err =       0.000460706136
             autocorr =       1.227834874152
              std dev =       0.587988744129
             le_variance =       0.345730763222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697629184
                                         uncertainty =       0.012966069522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697629184
                                         uncertainty =       0.012966069522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415770784
  error estimate for blocks of size 2^( 2) =       0.000427289142
  error estimate for blocks of size 2^( 3) =       0.000438794426
  error estimate for blocks of size 2^( 4) =       0.000449323017
  error estimate for blocks of size 2^( 5) =       0.000457992071
  error estimate for blocks of size 2^( 6) =       0.000465561646
  error estimate for blocks of size 2^( 7) =       0.000469947653

      target function =                  N/A
              le_mean =     -16.910923534190
             les_mean =     286.325065296171
             stat err =       0.000460706097
             autocorr =       1.227834924859
              std dev =       0.587988681703
             le_variance =       0.345730689811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697665896
                                         uncertainty =       0.012966074911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697665896
                                         uncertainty =       0.012966074911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415770806
  error estimate for blocks of size 2^( 2) =       0.000427289164
  error estimate for blocks of size 2^( 3) =       0.000438794448
  error estimate for blocks of size 2^( 4) =       0.000449323038
  error estimate for blocks of size 2^( 5) =       0.000457992091
  error estimate for blocks of size 2^( 6) =       0.000465561665
  error estimate for blocks of size 2^( 7) =       0.000469947672

      target function =                  N/A
              le_mean =     -16.910923534727
             les_mean =     286.325065351041
             stat err =       0.000460706117
             autocorr =       1.227834899507
              std dev =       0.587988712908
             le_variance =       0.345730726507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697698036
                                         uncertainty =       0.012966079627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345697698036
                                         uncertainty =       0.012966079627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415770825
  error estimate for blocks of size 2^( 2) =       0.000427289183
  error estimate for blocks of size 2^( 3) =       0.000438794467
  error estimate for blocks of size 2^( 4) =       0.000449323057
  error estimate for blocks of size 2^( 5) =       0.000457992109
  error estimate for blocks of size 2^( 6) =       0.000465561681
  error estimate for blocks of size 2^( 7) =       0.000469947689

      target function =                  N/A
              le_mean =     -16.910923535198
             les_mean =     286.325065399075
             stat err =       0.000460706134
             autocorr =       1.227834877310
              std dev =       0.587988740226
             le_variance =       0.345730758633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910923535265        initial  <--
     9.0949e+02     9.0949e+03             2.5591e-07       -16.910923534190
     3.6380e+03     3.6380e+04             6.3987e-08       -16.910923534727
     1.4552e+04     1.4552e+05             1.5997e-08       -16.910923535198

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7666
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208278e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798727e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725082e-02 1 1  ON 33
eH1_4                -7.647669e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944357e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518640e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.309581
====================================================
  Execution time = 2.9670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3520e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335292089180
                                         uncertainty =       0.003945115594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335292089180
                                         uncertainty =       0.003945115594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409390180
  error estimate for blocks of size 2^( 2) =       0.000420978152
  error estimate for blocks of size 2^( 3) =       0.000432541484
  error estimate for blocks of size 2^( 4) =       0.000443822445
  error estimate for blocks of size 2^( 5) =       0.000453708291
  error estimate for blocks of size 2^( 6) =       0.000460210172
  error estimate for blocks of size 2^( 7) =       0.000463272248

      target function =                  N/A
              le_mean =     -16.910744133951
             les_mean =     286.308467635579
             stat err =       0.000455253289
             autocorr =       1.236605977224
              std dev =       0.578965145082
             le_variance =       0.335200639220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691074413395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910744133951       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910744133964       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910744133955       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910744133950       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910744134033       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910744134034       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910744134046       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910744134044       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.941503e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910744133951       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910744133954       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910744133952       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910744133951       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910744133974       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910744133963       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910744133976       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910744133974       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 4.853767e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910744133951       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910744133952       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910744133951       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910744133950       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910744133900       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910744133870       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910744134125       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910744133989       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.213443e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6896e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345521e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208277e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798726e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725083e-02 1 1  ON 33
eH1_4                -7.647668e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944358e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518639e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.42038
====================================================
  Execution time = 2.7563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4827e-01
  Total weights = 2.0000e+06
  Execution time = 3.4633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668289
                                         uncertainty =       0.010116000405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668289
                                         uncertainty =       0.010116000405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417294740
  error estimate for blocks of size 2^( 2) =       0.000428628929
  error estimate for blocks of size 2^( 3) =       0.000440192288
  error estimate for blocks of size 2^( 4) =       0.000451635522
  error estimate for blocks of size 2^( 5) =       0.000461147136
  error estimate for blocks of size 2^( 6) =       0.000468650573
  error estimate for blocks of size 2^( 7) =       0.000471748316

      target function =                  N/A
              le_mean =     -16.910442461428
             les_mean =     286.311333867179
             stat err =       0.000463295387
             autocorr =       1.232622612264
              std dev =       0.590143880804
             le_variance =       0.348269800051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397669513
                                         uncertainty =       0.010116000447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397669513
                                         uncertainty =       0.010116000447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417294741
  error estimate for blocks of size 2^( 2) =       0.000428628930
  error estimate for blocks of size 2^( 3) =       0.000440192289
  error estimate for blocks of size 2^( 4) =       0.000451635523
  error estimate for blocks of size 2^( 5) =       0.000461147136
  error estimate for blocks of size 2^( 6) =       0.000468650573
  error estimate for blocks of size 2^( 7) =       0.000471748316

      target function =                  N/A
              le_mean =     -16.910442461397
             les_mean =     286.311333867368
             stat err =       0.000463295387
             autocorr =       1.232622609676
              std dev =       0.590143881844
             le_variance =       0.348269801278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668901
                                         uncertainty =       0.010116000426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668901
                                         uncertainty =       0.010116000426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417294740
  error estimate for blocks of size 2^( 2) =       0.000428628929
  error estimate for blocks of size 2^( 3) =       0.000440192289
  error estimate for blocks of size 2^( 4) =       0.000451635523
  error estimate for blocks of size 2^( 5) =       0.000461147136
  error estimate for blocks of size 2^( 6) =       0.000468650573
  error estimate for blocks of size 2^( 7) =       0.000471748316

      target function =                  N/A
              le_mean =     -16.910442461413
             les_mean =     286.311333867273
             stat err =       0.000463295387
             autocorr =       1.232622610971
              std dev =       0.590143881324
             le_variance =       0.348269800664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668366
                                         uncertainty =       0.010116000407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348397668366
                                         uncertainty =       0.010116000407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417294740
  error estimate for blocks of size 2^( 2) =       0.000428628929
  error estimate for blocks of size 2^( 3) =       0.000440192288
  error estimate for blocks of size 2^( 4) =       0.000451635522
  error estimate for blocks of size 2^( 5) =       0.000461147136
  error estimate for blocks of size 2^( 6) =       0.000468650573
  error estimate for blocks of size 2^( 7) =       0.000471748316

      target function =                  N/A
              le_mean =     -16.910442461426
             les_mean =     286.311333867190
             stat err =       0.000463295387
             autocorr =       1.232622612105
              std dev =       0.590143880869
             le_variance =       0.348269800127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910442461428        initial  <--
     9.0949e+03     9.0949e+04             1.9415e-08       -16.910442461397
     3.6380e+04     3.6380e+05             4.8538e-09       -16.910442461413
     1.4552e+05     1.4552e+06             1.2134e-09       -16.910442461426

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8798
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208278e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798727e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725082e-02 1 1  ON 33
eH1_4                -7.647669e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944357e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518640e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9411
    reference variance = 0.13172
====================================================
  Execution time = 2.7714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680013997
                                         uncertainty =       0.006275988653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680013997
                                         uncertainty =       0.006275988653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409642329
  error estimate for blocks of size 2^( 2) =       0.000421262017
  error estimate for blocks of size 2^( 3) =       0.000433966321
  error estimate for blocks of size 2^( 4) =       0.000444836992
  error estimate for blocks of size 2^( 5) =       0.000455079268
  error estimate for blocks of size 2^( 6) =       0.000464455346
  error estimate for blocks of size 2^( 7) =       0.000472401795

      target function =                  N/A
              le_mean =     -16.910805952535
             les_mean =     286.310971472694
             stat err =       0.000459193350
             autocorr =       1.256555067826
              std dev =       0.579321738063
             le_variance =       0.335613676193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691080595254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910805952535       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910805952531       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910805952529       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910805952525       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910805952549       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910805952494       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910805952530       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910805952523       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.082701e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910805952535       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910805952534       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910805952534       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910805952533       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910805952518       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910805952574       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910805952473       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910805952545       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.206754e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910805952535       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910805952535       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910805952535       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910805952213       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910805952673       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910805952315       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910805952165       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910805952740       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.301688e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4831e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815935e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208278e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798727e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725082e-02 1 1  ON 33
eH1_4                -7.647669e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944357e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518640e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.408118
====================================================
  Execution time = 2.7181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5402e-01
  Total weights = 2.0000e+06
  Execution time = 3.4673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216236
                                         uncertainty =       0.011279808615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216236
                                         uncertainty =       0.011279808615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420725998
  error estimate for blocks of size 2^( 2) =       0.000431688933
  error estimate for blocks of size 2^( 3) =       0.000443241365
  error estimate for blocks of size 2^( 4) =       0.000454884589
  error estimate for blocks of size 2^( 5) =       0.000464945683
  error estimate for blocks of size 2^( 6) =       0.000473711364
  error estimate for blocks of size 2^( 7) =       0.000481829535

      target function =                  N/A
              le_mean =     -16.909951110428
             les_mean =     286.300467111088
             stat err =       0.000468842793
             autocorr =       1.241811820184
              std dev =       0.594996412609
             le_variance =       0.354020731018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883217729
                                         uncertainty =       0.011279808720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883217729
                                         uncertainty =       0.011279808720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420725999
  error estimate for blocks of size 2^( 2) =       0.000431688933
  error estimate for blocks of size 2^( 3) =       0.000443241366
  error estimate for blocks of size 2^( 4) =       0.000454884590
  error estimate for blocks of size 2^( 5) =       0.000464945684
  error estimate for blocks of size 2^( 6) =       0.000473711364
  error estimate for blocks of size 2^( 7) =       0.000481829536

      target function =                  N/A
              le_mean =     -16.909951110436
             les_mean =     286.300467112826
             stat err =       0.000468842793
             autocorr =       1.241811819090
              std dev =       0.594996413863
             le_variance =       0.354020732510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216983
                                         uncertainty =       0.011279808667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216983
                                         uncertainty =       0.011279808667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420725999
  error estimate for blocks of size 2^( 2) =       0.000431688933
  error estimate for blocks of size 2^( 3) =       0.000443241366
  error estimate for blocks of size 2^( 4) =       0.000454884590
  error estimate for blocks of size 2^( 5) =       0.000464945683
  error estimate for blocks of size 2^( 6) =       0.000473711364
  error estimate for blocks of size 2^( 7) =       0.000481829535

      target function =                  N/A
              le_mean =     -16.909951110432
             les_mean =     286.300467111957
             stat err =       0.000468842793
             autocorr =       1.241811819643
              std dev =       0.594996413236
             le_variance =       0.354020731764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216330
                                         uncertainty =       0.011279808621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353883216330
                                         uncertainty =       0.011279808621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420725998
  error estimate for blocks of size 2^( 2) =       0.000431688933
  error estimate for blocks of size 2^( 3) =       0.000443241365
  error estimate for blocks of size 2^( 4) =       0.000454884589
  error estimate for blocks of size 2^( 5) =       0.000464945683
  error estimate for blocks of size 2^( 6) =       0.000473711364
  error estimate for blocks of size 2^( 7) =       0.000481829535

      target function =                  N/A
              le_mean =     -16.909951110429
             les_mean =     286.300467111197
             stat err =       0.000468842793
             autocorr =       1.241811820122
              std dev =       0.594996412688
             le_variance =       0.354020731111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909951110428        initial
     9.0949e+04     9.0949e+05             2.0827e-09       -16.909951110436  <--
     3.6380e+05     3.6380e+06             5.2068e-10       -16.909951110432
     1.4552e+06     1.4552e+07             1.3017e-10       -16.909951110429

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 4.4519e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.109029e-01 1 1  ON 0
 uu_1                 1.460877e-01 1 1  ON 1
 uu_2                 4.815934e-02 1 1  ON 2
 uu_3                -1.575824e-02 1 1  ON 3
 uu_4                -6.690900e-02 1 1  ON 4
 uu_5                -1.052505e-01 1 1  ON 5
 uu_6                -1.345520e-01 1 1  ON 6
 uu_7                -1.501784e-01 1 1  ON 7
 uu_8                -1.439599e-01 1 1  ON 8
 uu_9                -1.153298e-01 1 1  ON 9
 ud_0                 4.394525e-01 1 1  ON 10
 ud_1                 1.823815e-01 1 1  ON 11
 ud_2                 6.780116e-02 1 1  ON 12
 ud_3                -2.208278e-03 1 1  ON 13
 ud_4                -5.843369e-02 1 1  ON 14
 ud_5                -1.017279e-01 1 1  ON 15
 ud_6                -1.315319e-01 1 1  ON 16
 ud_7                -1.520016e-01 1 1  ON 17
 ud_8                -1.563861e-01 1 1  ON 18
 ud_9                -1.471495e-01 1 1  ON 19
 eO_0                -7.468216e-01 1 1  ON 20
 eO_1                -4.302590e-01 1 1  ON 21
 eO_2                -9.798726e-03 1 1  ON 22
 eO_3                 3.127328e-01 1 1  ON 23
 eO_4                 5.355793e-01 1 1  ON 24
 eO_5                 4.915906e-01 1 1  ON 25
 eO_6                 2.530975e-01 1 1  ON 26
 eO_7                -5.526144e-02 1 1  ON 27
 eO_8                -2.425955e-01 1 1  ON 28
 eO_9                -1.044771e-01 1 1  ON 29
eH1_0                -2.719575e-01 1 1  ON 30
eH1_1                -1.648252e-01 1 1  ON 31
eH1_2                -1.207911e-01 1 1  ON 32
eH1_3                -6.725082e-02 1 1  ON 33
eH1_4                -7.647669e-03 1 1  ON 34
eH1_5                 3.700397e-02 1 1  ON 35
eH1_6                 1.087613e-01 1 1  ON 36
eH1_7                 1.757059e-01 1 1  ON 37
eH1_8                 2.082708e-01 1 1  ON 38
eH1_9                 9.944357e-02 1 1  ON 39
eH2_0                -2.698170e-01 1 1  ON 40
eH2_1                -1.627241e-01 1 1  ON 41
eH2_2                -1.186807e-01 1 1  ON 42
eH2_3                -6.515905e-02 1 1  ON 43
eH2_4                -5.518640e-03 1 1  ON 44
eH2_5                 3.995078e-02 1 1  ON 45
eH2_6                 1.099880e-01 1 1  ON 46
eH2_7                 1.743916e-01 1 1  ON 47
eH2_8                 2.119006e-01 1 1  ON 48
eH2_9                 9.507276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9371e+01 secs
  Total Execution time = 3.2288e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
