Rank =    0  Free Memory = 46676 MB
Rank =    1  Free Memory = 46676 MB
Rank =    2  Free Memory = 46676 MB
Rank =    3  Free Memory = 46676 MB
Rank =    4  Free Memory = 46676 MB
Rank =    5  Free Memory = 46676 MB
Rank =    6  Free Memory = 46675 MB
Rank =    7  Free Memory = 46674 MB
Rank =    8  Free Memory = 46674 MB
Rank =    9  Free Memory = 46674 MB
Rank =   10  Free Memory = 46674 MB
Rank =   11  Free Memory = 46674 MB
Rank =   12  Free Memory = 46674 MB
Rank =   13  Free Memory = 46674 MB
Rank =   14  Free Memory = 46674 MB
Rank =   15  Free Memory = 46660 MB
Rank =   16  Free Memory = 46660 MB
Rank =   17  Free Memory = 46660 MB
Rank =   18  Free Memory = 46660 MB
Rank =   19  Free Memory = 46660 MB
Rank =   20  Free Memory = 46660 MB
Rank =   21  Free Memory = 46660 MB
Rank =   22  Free Memory = 46660 MB
Rank =   23  Free Memory = 46660 MB
Rank =   24  Free Memory = 46660 MB
Rank =   25  Free Memory = 46660 MB
Rank =   26  Free Memory = 46660 MB
Rank =   27  Free Memory = 46660 MB
Rank =   28  Free Memory = 46660 MB
Rank =   29  Free Memory = 46660 MB
Rank =   30  Free Memory = 46660 MB
Rank =   31  Free Memory = 46660 MB
Rank =   32  Free Memory = 55748 MB
Rank =   33  Free Memory = 55748 MB
Rank =   34  Free Memory = 55748 MB
Rank =   35  Free Memory = 55748 MB
Rank =   36  Free Memory = 55748 MB
Rank =   37  Free Memory = 55748 MB
Rank =   38  Free Memory = 55748 MB
Rank =   39  Free Memory = 55748 MB
Rank =   40  Free Memory = 55747 MB
Rank =   41  Free Memory = 55747 MB
Rank =   42  Free Memory = 55747 MB
Rank =   43  Free Memory = 55747 MB
Rank =   44  Free Memory = 55747 MB
Rank =   45  Free Memory = 55747 MB
Rank =   46  Free Memory = 55747 MB
Rank =   47  Free Memory = 55747 MB
Rank =   48  Free Memory = 55747 MB
Rank =   49  Free Memory = 55747 MB
Rank =   50  Free Memory = 55747 MB
Rank =   51  Free Memory = 55747 MB
Rank =   52  Free Memory = 55747 MB
Rank =   53  Free Memory = 55747 MB
Rank =   54  Free Memory = 55747 MB
Rank =   55  Free Memory = 55747 MB
Rank =   56  Free Memory = 55747 MB
Rank =   57  Free Memory = 55747 MB
Rank =   58  Free Memory = 55747 MB
Rank =   59  Free Memory = 55747 MB
Rank =   60  Free Memory = 55747 MB
Rank =   61  Free Memory = 55747 MB
Rank =   62  Free Memory = 55747 MB
Rank =   63  Free Memory = 55747 MB
Rank =   64  Free Memory = 67563 MB
Rank =   65  Free Memory = 67563 MB
Rank =   66  Free Memory = 67563 MB
Rank =   67  Free Memory = 67563 MB
Rank =   68  Free Memory = 67563 MB
Rank =   69  Free Memory = 67563 MB
Rank =   70  Free Memory = 67563 MB
Rank =   71  Free Memory = 67563 MB
Rank =   72  Free Memory = 67563 MB
Rank =   73  Free Memory = 67563 MB
Rank =   74  Free Memory = 67562 MB
Rank =   75  Free Memory = 67562 MB
Rank =   76  Free Memory = 67562 MB
Rank =   77  Free Memory = 67562 MB
Rank =   78  Free Memory = 67562 MB
Rank =   79  Free Memory = 67562 MB
Rank =   80  Free Memory = 67562 MB
Rank =   81  Free Memory = 67562 MB
Rank =   82  Free Memory = 67562 MB
Rank =   83  Free Memory = 67562 MB
Rank =   84  Free Memory = 67562 MB
Rank =   85  Free Memory = 67562 MB
Rank =   86  Free Memory = 67562 MB
Rank =   87  Free Memory = 67562 MB
Rank =   88  Free Memory = 67562 MB
Rank =   89  Free Memory = 67561 MB
Rank =   90  Free Memory = 67561 MB
Rank =   91  Free Memory = 67561 MB
Rank =   92  Free Memory = 67561 MB
Rank =   93  Free Memory = 67561 MB
Rank =   94  Free Memory = 67561 MB
Rank =   95  Free Memory = 67561 MB
Rank =   96  Free Memory = 58817 MB
Rank =   97  Free Memory = 58817 MB
Rank =   98  Free Memory = 58817 MB
Rank =   99  Free Memory = 58817 MB
Rank =  100  Free Memory = 58817 MB
Rank =  101  Free Memory = 58817 MB
Rank =  102  Free Memory = 58817 MB
Rank =  103  Free Memory = 58817 MB
Rank =  104  Free Memory = 58817 MB
Rank =  105  Free Memory = 58817 MB
Rank =  106  Free Memory = 58817 MB
Rank =  107  Free Memory = 58817 MB
Rank =  108  Free Memory = 58817 MB
Rank =  109  Free Memory = 58817 MB
Rank =  110  Free Memory = 58817 MB
Rank =  111  Free Memory = 58817 MB
Rank =  112  Free Memory = 58817 MB
Rank =  113  Free Memory = 58817 MB
Rank =  114  Free Memory = 58817 MB
Rank =  115  Free Memory = 58817 MB
Rank =  116  Free Memory = 58817 MB
Rank =  117  Free Memory = 58817 MB
Rank =  118  Free Memory = 58817 MB
Rank =  119  Free Memory = 58817 MB
Rank =  120  Free Memory = 58817 MB
Rank =  121  Free Memory = 58817 MB
Rank =  122  Free Memory = 58817 MB
Rank =  123  Free Memory = 58817 MB
Rank =  124  Free Memory = 58817 MB
Rank =  125  Free Memory = 58817 MB
Rank =  126  Free Memory = 58817 MB
Rank =  127  Free Memory = 58817 MB
  Input file(s): opt_h2o_1b1_gvptt_369dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_369dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 14:50:16 PDT
  host    = n0071.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 792

  Range of prime numbers to use as seeds over processors and threads = 6089-7213


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.025231e-01    1         1  ON     0
     uu_1                 1.392119e-01    1         1  ON     1
     uu_2                 4.170540e-02    1         1  ON     2
     uu_3                -1.918535e-02    1         1  ON     3
     uu_4                -6.325451e-02    1         1  ON     4
     uu_5                -9.590828e-02    1         1  ON     5
     uu_6                -1.205705e-01    1         1  ON     6
     uu_7                -1.310320e-01    1         1  ON     7
     uu_8                -1.203745e-01    1         1  ON     8
     uu_9                -9.278897e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.117231e-01    1         1  ON     0
     ud_1                 1.592879e-01    1         1  ON     1
     ud_2                 6.036277e-02    1         1  ON     2
     ud_3                 1.859247e-03    1         1  ON     3
     ud_4                -5.685434e-02    1         1  ON     4
     ud_5                -1.013726e-01    1         1  ON     5
     ud_6                -1.286922e-01    1         1  ON     6
     ud_7                -1.435977e-01    1         1  ON     7
     ud_8                -1.425427e-01    1         1  ON     8
     ud_9                -1.344806e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.062111e-01    1         1  ON     0
     eO_1                -4.138918e-01    1         1  ON     1
     eO_2                -3.050825e-02    1         1  ON     2
     eO_3                 2.701635e-01    1         1  ON     3
     eO_4                 4.917052e-01    1         1  ON     4
     eO_5                 4.594119e-01    1         1  ON     5
     eO_6                 2.360327e-01    1         1  ON     6
     eO_7                -5.586989e-02    1         1  ON     7
     eO_8                -1.960064e-01    1         1  ON     8
     eO_9                -5.774368e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.108361e-01    1         1  ON     0
     eH1_1                -1.273912e-01    1         1  ON     1
     eH1_2                -8.825332e-02    1         1  ON     2
     eH1_3                -3.745039e-02    1         1  ON     3
     eH1_4                 1.200574e-02    1         1  ON     4
     eH1_5                 4.478229e-02    1         1  ON     5
     eH1_6                 9.481237e-02    1         1  ON     6
     eH1_7                 1.382219e-01    1         1  ON     7
     eH1_8                 1.457850e-01    1         1  ON     8
     eH1_9                 3.291496e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.097269e-01    1         1  ON     0
     eH2_1                -1.264569e-01    1         1  ON     1
     eH2_2                -8.726816e-02    1         1  ON     2
     eH2_3                -3.643120e-02    1         1  ON     3
     eH2_4                 1.332708e-02    1         1  ON     4
     eH2_5                 4.799450e-02    1         1  ON     5
     eH2_6                 1.006387e-01    1         1  ON     6
     eH2_7                 1.496079e-01    1         1  ON     7
     eH2_8                 1.538402e-01    1         1  ON     8
     eH2_9                 1.301177e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 369 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.963171e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 79 unique up determinants.
Found 79 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9753e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.270262
====================================================
  Execution time = 2.6430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2735e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327358151043
                                         uncertainty =       0.003999439739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327358151043
                                         uncertainty =       0.003999439739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404566771
  error estimate for blocks of size 2^( 2) =       0.000416977249
  error estimate for blocks of size 2^( 3) =       0.000429863976
  error estimate for blocks of size 2^( 4) =       0.000440929480
  error estimate for blocks of size 2^( 5) =       0.000451462450
  error estimate for blocks of size 2^( 6) =       0.000460124499
  error estimate for blocks of size 2^( 7) =       0.000463557820

      target function =                  N/A
              le_mean =     -16.910365821992
             les_mean =     286.287820615004
             stat err =       0.000454018562
             autocorr =       1.259409017017
              std dev =       0.572143815027
             le_variance =       0.327348545074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691036582199e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910365821992       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910497672829       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910575076464       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910621091260       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910649060429       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910661805369       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910666853872       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910671578604       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910670651912       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910670369026       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910671585894       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910671626009       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910671668969       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.885770e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910365821992       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910417312507       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910455878154       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910468956951       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910480854599       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910483967934       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910485128524       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910485573955       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910485375376       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910485614933       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910485525368       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.456364e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910365821992       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910380799144       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910393426397       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910396923830       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910400223032       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910401046306       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910401421938       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910401216753       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910401339846       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910401362672       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.802692e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3102e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.023425e-01                 1 1 ON  0
uu_1  1.387409e-01                 1 1 ON  1
uu_2  4.186009e-02                 1 1 ON  2
uu_3  -1.873214e-02                1 1 ON  3
uu_4  -6.321533e-02                1 1 ON  4
uu_5  -9.598903e-02                1 1 ON  5
uu_6  -1.205802e-01                1 1 ON  6
uu_7  -1.310475e-01                1 1 ON  7
uu_8  -1.204660e-01                1 1 ON  8
uu_9  -9.283497e-02                1 1 ON  9
ud_0  4.127229e-01                 1 1 ON  10
ud_1  1.608421e-01                 1 1 ON  11
ud_2  5.953725e-02                 1 1 ON  12
ud_3  2.626802e-04                 1 1 ON  13
ud_4  -5.660010e-02                1 1 ON  14
ud_5  -1.010427e-01                1 1 ON  15
ud_6  -1.287200e-01                1 1 ON  16
ud_7  -1.438547e-01                1 1 ON  17
ud_8  -1.428672e-01                1 1 ON  18
ud_9  -1.345992e-01                1 1 ON  19
eO_0  -7.096674e-01                1 1 ON  20
eO_1  -4.143116e-01                1 1 ON  21
eO_2  -2.812831e-02                1 1 ON  22
eO_3  2.721143e-01                 1 1 ON  23
eO_4  4.919652e-01                 1 1 ON  24
eO_5  4.590380e-01                 1 1 ON  25
eO_6  2.359533e-01                 1 1 ON  26
eO_7  -5.579217e-02                1 1 ON  27
eO_8  -1.962005e-01                1 1 ON  28
eO_9  -5.787439e-02                1 1 ON  29
eH1_0 -2.126738e-01                1 1 ON  30
eH1_1 -1.272446e-01                1 1 ON  31
eH1_2 -8.790987e-02                1 1 ON  32
eH1_3 -3.755293e-02                1 1 ON  33
eH1_4 1.280453e-02                 1 1 ON  34
eH1_5 4.489928e-02                 1 1 ON  35
eH1_6 9.493963e-02                 1 1 ON  36
eH1_7 1.382835e-01                 1 1 ON  37
eH1_8 1.459977e-01                 1 1 ON  38
eH1_9 3.305710e-02                 1 1 ON  39
eH2_0 -2.116514e-01                1 1 ON  40
eH2_1 -1.263242e-01                1 1 ON  41
eH2_2 -8.690437e-02                1 1 ON  42
eH2_3 -3.651253e-02                1 1 ON  43
eH2_4 1.409117e-02                 1 1 ON  44
eH2_5 4.812589e-02                 1 1 ON  45
eH2_6 1.008403e-01                 1 1 ON  46
eH2_7 1.496067e-01                 1 1 ON  47
eH2_8 1.540015e-01                 1 1 ON  48
eH2_9 1.325360e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9354
    reference variance = 0.268135
====================================================
  Execution time = 2.5571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4368e-01
  Total weights = 2.0000e+06
  Execution time = 2.9607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556219309
                                         uncertainty =       0.014831664530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556219309
                                         uncertainty =       0.014831664530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415006930
  error estimate for blocks of size 2^( 2) =       0.000427224538
  error estimate for blocks of size 2^( 3) =       0.000440372416
  error estimate for blocks of size 2^( 4) =       0.000452754323
  error estimate for blocks of size 2^( 5) =       0.000463425130
  error estimate for blocks of size 2^( 6) =       0.000473254969
  error estimate for blocks of size 2^( 7) =       0.000480814764

      target function =                  N/A
              le_mean =     -16.910624239017
             les_mean =     286.313673485339
             stat err =       0.000467562296
             autocorr =       1.269311654913
              std dev =       0.586908429265
             le_variance =       0.344461504342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343926029471
                                         uncertainty =       0.014798205291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343926029471
                                         uncertainty =       0.014798205291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414626328
  error estimate for blocks of size 2^( 2) =       0.000426556546
  error estimate for blocks of size 2^( 3) =       0.000439458708
  error estimate for blocks of size 2^( 4) =       0.000451657301
  error estimate for blocks of size 2^( 5) =       0.000462264475
  error estimate for blocks of size 2^( 6) =       0.000472088093
  error estimate for blocks of size 2^( 7) =       0.000479597835

      target function =                  N/A
              le_mean =     -16.910638543164
             les_mean =     286.313525748603
             stat err =       0.000466401926
             autocorr =       1.265339075863
              std dev =       0.586370175713
             le_variance =       0.343829982965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343284145818
                                         uncertainty =       0.014775273520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343284145818
                                         uncertainty =       0.014775273520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414239357
  error estimate for blocks of size 2^( 2) =       0.000426234991
  error estimate for blocks of size 2^( 3) =       0.000439198221
  error estimate for blocks of size 2^( 4) =       0.000451445491
  error estimate for blocks of size 2^( 5) =       0.000462078636
  error estimate for blocks of size 2^( 6) =       0.000471909484
  error estimate for blocks of size 2^( 7) =       0.000479412431

      target function =                  N/A
              le_mean =     -16.910614129235
             les_mean =     286.312058546792
             stat err =       0.000466211511
             autocorr =       1.266669358543
              std dev =       0.585822917366
             le_variance =       0.343188490512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344224476190
                                         uncertainty =       0.014820620630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344224476190
                                         uncertainty =       0.014820620630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414806962
  error estimate for blocks of size 2^( 2) =       0.000426987891
  error estimate for blocks of size 2^( 3) =       0.000440106084
  error estimate for blocks of size 2^( 4) =       0.000452467418
  error estimate for blocks of size 2^( 5) =       0.000463133640
  error estimate for blocks of size 2^( 6) =       0.000472964284
  error estimate for blocks of size 2^( 7) =       0.000480515321

      target function =                  N/A
              le_mean =     -16.910610312097
             les_mean =     286.312870586596
             stat err =       0.000467270166
             autocorr =       1.268948607200
              std dev =       0.586625631100
             le_variance =       0.344129631063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910624239017        initial
     2.5000e-01     2.5000e+00             9.8858e-03       -16.910638543164  <--
     1.0000e+00     1.0000e+01             3.4564e-03       -16.910614129235
     4.0000e+00     4.0000e+01             9.8027e-04       -16.910610312097

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.0422e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.023608e-01 1 1  ON 0
 uu_1                 1.385270e-01 1 1  ON 1
 uu_2                 4.199781e-02 1 1  ON 2
 uu_3                -1.830089e-02 1 1  ON 3
 uu_4                -6.319018e-02 1 1  ON 4
 uu_5                -9.614348e-02 1 1  ON 5
 uu_6                -1.207311e-01 1 1  ON 6
 uu_7                -1.312687e-01 1 1  ON 7
 uu_8                -1.208454e-01 1 1  ON 8
 uu_9                -9.303399e-02 1 1  ON 9
 ud_0                 4.153781e-01 1 1  ON 10
 ud_1                 1.630090e-01 1 1  ON 11
 ud_2                 5.869549e-02 1 1  ON 12
 ud_3                -2.174234e-03 1 1  ON 13
 ud_4                -5.699957e-02 1 1  ON 14
 ud_5                -1.005261e-01 1 1  ON 15
 ud_6                -1.286237e-01 1 1  ON 16
 ud_7                -1.443713e-01 1 1  ON 17
 ud_8                -1.437495e-01 1 1  ON 18
 ud_9                -1.349762e-01 1 1  ON 19
 eO_0                -7.160968e-01 1 1  ON 20
 eO_1                -4.158710e-01 1 1  ON 21
 eO_2                -2.427809e-02 1 1  ON 22
 eO_3                 2.764229e-01 1 1  ON 23
 eO_4                 4.934287e-01 1 1  ON 24
 eO_5                 4.585134e-01 1 1  ON 25
 eO_6                 2.356824e-01 1 1  ON 26
 eO_7                -5.561459e-02 1 1  ON 27
 eO_8                -1.967829e-01 1 1  ON 28
 eO_9                -5.826402e-02 1 1  ON 29
eH1_0                -2.166147e-01 1 1  ON 30
eH1_1                -1.272901e-01 1 1  ON 31
eH1_2                -8.733979e-02 1 1  ON 32
eH1_3                -3.760760e-02 1 1  ON 33
eH1_4                 1.409369e-02 1 1  ON 34
eH1_5                 4.542913e-02 1 1  ON 35
eH1_6                 9.543225e-02 1 1  ON 36
eH1_7                 1.384624e-01 1 1  ON 37
eH1_8                 1.465974e-01 1 1  ON 38
eH1_9                 3.346691e-02 1 1  ON 39
eH2_0                -2.157811e-01 1 1  ON 40
eH2_1                -1.263866e-01 1 1  ON 41
eH2_2                -8.631636e-02 1 1  ON 42
eH2_3                -3.654659e-02 1 1  ON 43
eH2_4                 1.531958e-02 1 1  ON 44
eH2_5                 4.867007e-02 1 1  ON 45
eH2_6                 1.015207e-01 1 1  ON 46
eH2_7                 1.496118e-01 1 1  ON 47
eH2_8                 1.544529e-01 1 1  ON 48
eH2_9                 1.395417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3531e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6942e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9115
    reference variance = 0.189177
====================================================
  Execution time = 2.5678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329912734008
                                         uncertainty =       0.004242332092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329912734008
                                         uncertainty =       0.004242332092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406031948
  error estimate for blocks of size 2^( 2) =       0.000418259396
  error estimate for blocks of size 2^( 3) =       0.000431249337
  error estimate for blocks of size 2^( 4) =       0.000443729547
  error estimate for blocks of size 2^( 5) =       0.000456362014
  error estimate for blocks of size 2^( 6) =       0.000465444846
  error estimate for blocks of size 2^( 7) =       0.000473948020

      target function =                  N/A
              le_mean =     -16.910181130544
             les_mean =     286.283949588432
             stat err =       0.000459871107
             autocorr =       1.282778979877
              std dev =       0.574215887539
             le_variance =       0.329723885502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691018113054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910181130544       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910238371926       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910266017425       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910343005275       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910378079143       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910408900953       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910418753411       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910419692077       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910419941360       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910416654304       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910419501038       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910420842713       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910420683158       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910421178043       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910421598696       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910422036524       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910421998259       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.455843e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910181130544       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910214945440       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910235108991       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910274257187       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910291994318       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910300710761       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910303772818       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910304159956       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910303134057       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910302104795       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910302194817       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910302500319       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910302541742       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.330756e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910181130544       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910193953562       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910203556591       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910216936175       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910222173147       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910223920739       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910224652411       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910224618138       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910224445051       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910224260721       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.096154e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2482e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.025261e-01 1 1  ON 0
 uu_1                 1.386946e-01 1 1  ON 1
 uu_2                 4.225840e-02 1 1  ON 2
 uu_3                -1.805410e-02 1 1  ON 3
 uu_4                -6.328848e-02 1 1  ON 4
 uu_5                -9.626738e-02 1 1  ON 5
 uu_6                -1.212518e-01 1 1  ON 6
 uu_7                -1.320362e-01 1 1  ON 7
 uu_8                -1.213862e-01 1 1  ON 8
 uu_9                -9.316306e-02 1 1  ON 9
 ud_0                 4.179493e-01 1 1  ON 10
 ud_1                 1.650112e-01 1 1  ON 11
 ud_2                 5.800731e-02 1 1  ON 12
 ud_3                -4.482377e-03 1 1  ON 13
 ud_4                -5.774763e-02 1 1  ON 14
 ud_5                -1.003879e-01 1 1  ON 15
 ud_6                -1.286348e-01 1 1  ON 16
 ud_7                -1.449191e-01 1 1  ON 17
 ud_8                -1.444779e-01 1 1  ON 18
 ud_9                -1.349068e-01 1 1  ON 19
 eO_0                -7.224276e-01 1 1  ON 20
 eO_1                -4.180917e-01 1 1  ON 21
 eO_2                -2.090096e-02 1 1  ON 22
 eO_3                 2.810493e-01 1 1  ON 23
 eO_4                 4.955715e-01 1 1  ON 24
 eO_5                 4.582447e-01 1 1  ON 25
 eO_6                 2.353753e-01 1 1  ON 26
 eO_7                -5.561312e-02 1 1  ON 27
 eO_8                -1.973026e-01 1 1  ON 28
 eO_9                -5.871674e-02 1 1  ON 29
eH1_0                -2.211554e-01 1 1  ON 30
eH1_1                -1.279508e-01 1 1  ON 31
eH1_2                -8.732407e-02 1 1  ON 32
eH1_3                -3.757100e-02 1 1  ON 33
eH1_4                 1.513788e-02 1 1  ON 34
eH1_5                 4.635630e-02 1 1  ON 35
eH1_6                 9.640226e-02 1 1  ON 36
eH1_7                 1.390688e-01 1 1  ON 37
eH1_8                 1.474335e-01 1 1  ON 38
eH1_9                 3.414303e-02 1 1  ON 39
eH2_0                -2.199932e-01 1 1  ON 40
eH2_1                -1.268636e-01 1 1  ON 41
eH2_2                -8.598844e-02 1 1  ON 42
eH2_3                -3.640832e-02 1 1  ON 43
eH2_4                 1.664991e-02 1 1  ON 44
eH2_5                 4.929603e-02 1 1  ON 45
eH2_6                 1.017445e-01 1 1  ON 46
eH2_7                 1.498098e-01 1 1  ON 47
eH2_8                 1.553624e-01 1 1  ON 48
eH2_9                 1.484824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.253236
====================================================
  Execution time = 2.4945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3638e-01
  Total weights = 2.0000e+06
  Execution time = 2.9640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335423726223
                                         uncertainty =       0.008212416155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335423726223
                                         uncertainty =       0.008212416155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409556703
  error estimate for blocks of size 2^( 2) =       0.000421469203
  error estimate for blocks of size 2^( 3) =       0.000434188803
  error estimate for blocks of size 2^( 4) =       0.000446329525
  error estimate for blocks of size 2^( 5) =       0.000455836742
  error estimate for blocks of size 2^( 6) =       0.000464787210
  error estimate for blocks of size 2^( 7) =       0.000471773043

      target function =                  N/A
              le_mean =     -16.910487893853
             les_mean =     286.300074026572
             stat err =       0.000459681630
             autocorr =       1.259755376520
              std dev =       0.579200644141
             le_variance =       0.335473386173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338190550446
                                         uncertainty =       0.008338783412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338190550446
                                         uncertainty =       0.008338783412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240700
  error estimate for blocks of size 2^( 2) =       0.000422937889
  error estimate for blocks of size 2^( 3) =       0.000435458599
  error estimate for blocks of size 2^( 4) =       0.000447387732
  error estimate for blocks of size 2^( 5) =       0.000456768178
  error estimate for blocks of size 2^( 6) =       0.000465653992
  error estimate for blocks of size 2^( 7) =       0.000472530993

      target function =                  N/A
              le_mean =     -16.910523716042
             les_mean =     286.304050008111
             stat err =       0.000460585223
             autocorr =       1.254376249543
              std dev =       0.581582175114
             le_variance =       0.338237826410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337641219995
                                         uncertainty =       0.008337385165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337641219995
                                         uncertainty =       0.008337385165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410906406
  error estimate for blocks of size 2^( 2) =       0.000422612982
  error estimate for blocks of size 2^( 3) =       0.000435158447
  error estimate for blocks of size 2^( 4) =       0.000447122399
  error estimate for blocks of size 2^( 5) =       0.000456524707
  error estimate for blocks of size 2^( 6) =       0.000465425146
  error estimate for blocks of size 2^( 7) =       0.000472296178

      target function =                  N/A
              le_mean =     -16.910531807038
             les_mean =     286.303773976476
             stat err =       0.000460342107
             autocorr =       1.255092052924
              std dev =       0.581109411794
             le_variance =       0.337688148475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335577864836
                                         uncertainty =       0.008232019791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335577864836
                                         uncertainty =       0.008232019791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409650472
  error estimate for blocks of size 2^( 2) =       0.000421516015
  error estimate for blocks of size 2^( 3) =       0.000434197817
  error estimate for blocks of size 2^( 4) =       0.000446306131
  error estimate for blocks of size 2^( 5) =       0.000455794567
  error estimate for blocks of size 2^( 6) =       0.000464736952
  error estimate for blocks of size 2^( 7) =       0.000471701796

      target function =                  N/A
              le_mean =     -16.910471382492
             les_mean =     286.299669228693
             stat err =       0.000459634861
             autocorr =       1.258922519558
              std dev =       0.579333253348
             le_variance =       0.335627018435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910487893853        initial
     6.2500e-02     6.2500e-01             1.4558e-02       -16.910523716042
     2.5000e-01     2.5000e+00             6.3308e-03       -16.910531807038  <--
     1.0000e+00     1.0000e+01             2.0962e-03       -16.910471382492

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.9905e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.025261e-01 1 1  ON 0
 uu_1                 1.386946e-01 1 1  ON 1
 uu_2                 4.225840e-02 1 1  ON 2
 uu_3                -1.805410e-02 1 1  ON 3
 uu_4                -6.328848e-02 1 1  ON 4
 uu_5                -9.626738e-02 1 1  ON 5
 uu_6                -1.212518e-01 1 1  ON 6
 uu_7                -1.320362e-01 1 1  ON 7
 uu_8                -1.213862e-01 1 1  ON 8
 uu_9                -9.316306e-02 1 1  ON 9
 ud_0                 4.179493e-01 1 1  ON 10
 ud_1                 1.650112e-01 1 1  ON 11
 ud_2                 5.800731e-02 1 1  ON 12
 ud_3                -4.482377e-03 1 1  ON 13
 ud_4                -5.774763e-02 1 1  ON 14
 ud_5                -1.003879e-01 1 1  ON 15
 ud_6                -1.286348e-01 1 1  ON 16
 ud_7                -1.449191e-01 1 1  ON 17
 ud_8                -1.444779e-01 1 1  ON 18
 ud_9                -1.349068e-01 1 1  ON 19
 eO_0                -7.224276e-01 1 1  ON 20
 eO_1                -4.180917e-01 1 1  ON 21
 eO_2                -2.090096e-02 1 1  ON 22
 eO_3                 2.810493e-01 1 1  ON 23
 eO_4                 4.955715e-01 1 1  ON 24
 eO_5                 4.582447e-01 1 1  ON 25
 eO_6                 2.353753e-01 1 1  ON 26
 eO_7                -5.561312e-02 1 1  ON 27
 eO_8                -1.973026e-01 1 1  ON 28
 eO_9                -5.871674e-02 1 1  ON 29
eH1_0                -2.211554e-01 1 1  ON 30
eH1_1                -1.279508e-01 1 1  ON 31
eH1_2                -8.732407e-02 1 1  ON 32
eH1_3                -3.757100e-02 1 1  ON 33
eH1_4                 1.513788e-02 1 1  ON 34
eH1_5                 4.635630e-02 1 1  ON 35
eH1_6                 9.640226e-02 1 1  ON 36
eH1_7                 1.390688e-01 1 1  ON 37
eH1_8                 1.474335e-01 1 1  ON 38
eH1_9                 3.414303e-02 1 1  ON 39
eH2_0                -2.199932e-01 1 1  ON 40
eH2_1                -1.268636e-01 1 1  ON 41
eH2_2                -8.598844e-02 1 1  ON 42
eH2_3                -3.640832e-02 1 1  ON 43
eH2_4                 1.664991e-02 1 1  ON 44
eH2_5                 4.929603e-02 1 1  ON 45
eH2_6                 1.017445e-01 1 1  ON 46
eH2_7                 1.498098e-01 1 1  ON 47
eH2_8                 1.553624e-01 1 1  ON 48
eH2_9                 1.484824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8654
    reference variance = 0.154761
====================================================
  Execution time = 2.5680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2611e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326176223642
                                         uncertainty =       0.002963555289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326176223642
                                         uncertainty =       0.002963555289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403799378
  error estimate for blocks of size 2^( 2) =       0.000415630395
  error estimate for blocks of size 2^( 3) =       0.000428807284
  error estimate for blocks of size 2^( 4) =       0.000441099753
  error estimate for blocks of size 2^( 5) =       0.000452712769
  error estimate for blocks of size 2^( 6) =       0.000461238564
  error estimate for blocks of size 2^( 7) =       0.000467162392

      target function =                  N/A
              le_mean =     -16.910894719940
             les_mean =     286.304467941398
             stat err =       0.000455553369
             autocorr =       1.272762100249
              std dev =       0.571058557028
             le_variance =       0.326107875555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691089471994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910894719940       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910910548148       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910930068097       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910970611890       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910995093521       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911002964996       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911008882248       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911010898471       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911010869929       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911012557555       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911011531140       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911012130262       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911012884291       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911014099277       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911013730660       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911014212706       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.078345e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910894719940       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910904053539       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910915578016       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910936019659       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910939041774       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910944913735       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910947655357       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910947291211       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910947588955       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910947481708       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910947103887       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910947294768       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.505223e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910894719940       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910898253683       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910902724140       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910907692133       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910910273631       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910911058737       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910912007072       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910911999132       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910911958924       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910911866658       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.460756e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2307e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.028929e-01 1 1  ON 0
 uu_1                 1.392811e-01 1 1  ON 1
 uu_2                 4.255045e-02 1 1  ON 2
 uu_3                -1.785186e-02 1 1  ON 3
 uu_4                -6.338772e-02 1 1  ON 4
 uu_5                -9.651662e-02 1 1  ON 5
 uu_6                -1.216625e-01 1 1  ON 6
 uu_7                -1.323376e-01 1 1  ON 7
 uu_8                -1.220706e-01 1 1  ON 8
 uu_9                -9.366097e-02 1 1  ON 9
 ud_0                 4.198956e-01 1 1  ON 10
 ud_1                 1.663647e-01 1 1  ON 11
 ud_2                 5.813112e-02 1 1  ON 12
 ud_3                -5.506796e-03 1 1  ON 13
 ud_4                -5.844966e-02 1 1  ON 14
 ud_5                -1.003021e-01 1 1  ON 15
 ud_6                -1.283195e-01 1 1  ON 16
 ud_7                -1.453776e-01 1 1  ON 17
 ud_8                -1.454445e-01 1 1  ON 18
 ud_9                -1.353355e-01 1 1  ON 19
 eO_0                -7.269328e-01 1 1  ON 20
 eO_1                -4.197475e-01 1 1  ON 21
 eO_2                -1.927401e-02 1 1  ON 22
 eO_3                 2.845228e-01 1 1  ON 23
 eO_4                 4.978008e-01 1 1  ON 24
 eO_5                 4.583589e-01 1 1  ON 25
 eO_6                 2.353743e-01 1 1  ON 26
 eO_7                -5.545656e-02 1 1  ON 27
 eO_8                -1.981161e-01 1 1  ON 28
 eO_9                -5.926403e-02 1 1  ON 29
eH1_0                -2.246413e-01 1 1  ON 30
eH1_1                -1.286054e-01 1 1  ON 31
eH1_2                -8.730418e-02 1 1  ON 32
eH1_3                -3.777320e-02 1 1  ON 33
eH1_4                 1.572177e-02 1 1  ON 34
eH1_5                 4.713032e-02 1 1  ON 35
eH1_6                 9.705763e-02 1 1  ON 36
eH1_7                 1.399198e-01 1 1  ON 37
eH1_8                 1.483311e-01 1 1  ON 38
eH1_9                 3.475598e-02 1 1  ON 39
eH2_0                -2.233966e-01 1 1  ON 40
eH2_1                -1.271538e-01 1 1  ON 41
eH2_2                -8.612236e-02 1 1  ON 42
eH2_3                -3.641519e-02 1 1  ON 43
eH2_4                 1.736453e-02 1 1  ON 44
eH2_5                 5.005966e-02 1 1  ON 45
eH2_6                 1.020519e-01 1 1  ON 46
eH2_7                 1.499979e-01 1 1  ON 47
eH2_8                 1.563105e-01 1 1  ON 48
eH2_9                 1.572330e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.262673
====================================================
  Execution time = 2.5076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3364e-01
  Total weights = 2.0000e+06
  Execution time = 2.9512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332953515154
                                         uncertainty =       0.005615870192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332953515154
                                         uncertainty =       0.005615870192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407995202
  error estimate for blocks of size 2^( 2) =       0.000420256371
  error estimate for blocks of size 2^( 3) =       0.000433121252
  error estimate for blocks of size 2^( 4) =       0.000445735206
  error estimate for blocks of size 2^( 5) =       0.000457361641
  error estimate for blocks of size 2^( 6) =       0.000464117652
  error estimate for blocks of size 2^( 7) =       0.000470285471

      target function =                  N/A
              le_mean =     -16.910205113913
             les_mean =     286.287956997499
             stat err =       0.000459374992
             autocorr =       1.267723634829
              std dev =       0.576992347731
             le_variance =       0.332920169340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334994267708
                                         uncertainty =       0.005641025485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334994267708
                                         uncertainty =       0.005641025485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409243433
  error estimate for blocks of size 2^( 2) =       0.000421385241
  error estimate for blocks of size 2^( 3) =       0.000434143902
  error estimate for blocks of size 2^( 4) =       0.000446625053
  error estimate for blocks of size 2^( 5) =       0.000458168450
  error estimate for blocks of size 2^( 6) =       0.000464929421
  error estimate for blocks of size 2^( 7) =       0.000471147410

      target function =                  N/A
              le_mean =     -16.910212231677
             les_mean =     286.290237927542
             stat err =       0.000460217584
             autocorr =       1.264628536453
              std dev =       0.578757613063
             le_variance =       0.334960374679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334520103662
                                         uncertainty =       0.005633028148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334520103662
                                         uncertainty =       0.005633028148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408953665
  error estimate for blocks of size 2^( 2) =       0.000421111098
  error estimate for blocks of size 2^( 3) =       0.000433894591
  error estimate for blocks of size 2^( 4) =       0.000446410033
  error estimate for blocks of size 2^( 5) =       0.000457980823
  error estimate for blocks of size 2^( 6) =       0.000464746138
  error estimate for blocks of size 2^( 7) =       0.000470971539

      target function =                  N/A
              le_mean =     -16.910209998541
             les_mean =     286.289688227862
             stat err =       0.000460027133
             autocorr =       1.265373357772
              std dev =       0.578347819511
             le_variance =       0.334486200333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333129290671
                                         uncertainty =       0.005617671027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333129290671
                                         uncertainty =       0.005617671027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408102830
  error estimate for blocks of size 2^( 2) =       0.000420344081
  error estimate for blocks of size 2^( 3) =       0.000433194330
  error estimate for blocks of size 2^( 4) =       0.000445792442
  error estimate for blocks of size 2^( 5) =       0.000457410740
  error estimate for blocks of size 2^( 6) =       0.000464168124
  error estimate for blocks of size 2^( 7) =       0.000470347091

      target function =                  N/A
              le_mean =     -16.910198367636
             les_mean =     286.287904506738
             stat err =       0.000459429599
             autocorr =       1.267356303414
              std dev =       0.577144557709
             le_variance =       0.333095840493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910205113913        initial
     6.2500e-02     6.2500e-01             1.0783e-02       -16.910212231677  <--
     2.5000e-01     2.5000e+00             4.5052e-03       -16.910209998541
     1.0000e+00     1.0000e+01             1.4608e-03       -16.910198367636

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.9930e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.046201e-01 1 1  ON 0
 uu_1                 1.406676e-01 1 1  ON 1
 uu_2                 4.334357e-02 1 1  ON 2
 uu_3                -1.771800e-02 1 1  ON 3
 uu_4                -6.389033e-02 1 1  ON 4
 uu_5                -9.718543e-02 1 1  ON 5
 uu_6                -1.226078e-01 1 1  ON 6
 uu_7                -1.333724e-01 1 1  ON 7
 uu_8                -1.237556e-01 1 1  ON 8
 uu_9                -9.514853e-02 1 1  ON 9
 ud_0                 4.228402e-01 1 1  ON 10
 ud_1                 1.685547e-01 1 1  ON 11
 ud_2                 5.914323e-02 1 1  ON 12
 ud_3                -5.838517e-03 1 1  ON 13
 ud_4                -5.923731e-02 1 1  ON 14
 ud_5                -1.006406e-01 1 1  ON 15
 ud_6                -1.284321e-01 1 1  ON 16
 ud_7                -1.460797e-01 1 1  ON 17
 ud_8                -1.472168e-01 1 1  ON 18
 ud_9                -1.365882e-01 1 1  ON 19
 eO_0                -7.332110e-01 1 1  ON 20
 eO_1                -4.232038e-01 1 1  ON 21
 eO_2                -1.833079e-02 1 1  ON 22
 eO_3                 2.892957e-01 1 1  ON 23
 eO_4                 5.027303e-01 1 1  ON 24
 eO_5                 4.605645e-01 1 1  ON 25
 eO_6                 2.360606e-01 1 1  ON 26
 eO_7                -5.502340e-02 1 1  ON 27
 eO_8                -2.004451e-01 1 1  ON 28
 eO_9                -6.092779e-02 1 1  ON 29
eH1_0                -2.300557e-01 1 1  ON 30
eH1_1                -1.307135e-01 1 1  ON 31
eH1_2                -8.872347e-02 1 1  ON 32
eH1_3                -3.877611e-02 1 1  ON 33
eH1_4                 1.542655e-02 1 1  ON 34
eH1_5                 4.817344e-02 1 1  ON 35
eH1_6                 9.897582e-02 1 1  ON 36
eH1_7                 1.426833e-01 1 1  ON 37
eH1_8                 1.510862e-01 1 1  ON 38
eH1_9                 3.666698e-02 1 1  ON 39
eH2_0                -2.285070e-01 1 1  ON 40
eH2_1                -1.288274e-01 1 1  ON 41
eH2_2                -8.736186e-02 1 1  ON 42
eH2_3                -3.712886e-02 1 1  ON 43
eH2_4                 1.732993e-02 1 1  ON 44
eH2_5                 5.105169e-02 1 1  ON 45
eH2_6                 1.032723e-01 1 1  ON 46
eH2_7                 1.510204e-01 1 1  ON 47
eH2_8                 1.590970e-01 1 1  ON 48
eH2_9                 1.835497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.40307
====================================================
  Execution time = 2.5556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329890865139
                                         uncertainty =       0.004333056078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329890865139
                                         uncertainty =       0.004333056078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406146170
  error estimate for blocks of size 2^( 2) =       0.000417724702
  error estimate for blocks of size 2^( 3) =       0.000430010447
  error estimate for blocks of size 2^( 4) =       0.000441999235
  error estimate for blocks of size 2^( 5) =       0.000452876264
  error estimate for blocks of size 2^( 6) =       0.000460009383
  error estimate for blocks of size 2^( 7) =       0.000465062717

      target function =                  N/A
              le_mean =     -16.910044728198
             les_mean =     286.279521967446
             stat err =       0.000454986900
             autocorr =       1.254969180426
              std dev =       0.574377421847
             le_variance =       0.329909422727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691004472820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910044728198       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910053595752       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910061562448       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071380269       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910085705467       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910091518527       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910089788912       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910094966074       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910093863707       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910102772716       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910100919201       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910101856470       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910109614747       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910111161135       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910110786897       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910115216523       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910114238893       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910113834265       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910113236756       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910112868623       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910112507271       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910112398227       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910112600747       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.359084e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910044728198       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910051473184       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910057622208       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910064899733       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071142955       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910072119653       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910074256948       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910072878590       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910073101212       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910073275362       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910075797113       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910074256911       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910075329737       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910075758062       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910075645017       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.834647e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910044728198       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910048173989       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910052310804       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910053965626       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910054900040       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910056057332       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910056686027       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910055535688       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910055939423       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910055872130       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910055929213       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.824492e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2339e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.073618e-01 1 1  ON 0
 uu_1                 1.424880e-01 1 1  ON 1
 uu_2                 4.442588e-02 1 1  ON 2
 uu_3                -1.742541e-02 1 1  ON 3
 uu_4                -6.421928e-02 1 1  ON 4
 uu_5                -9.840537e-02 1 1  ON 5
 uu_6                -1.236857e-01 1 1  ON 6
 uu_7                -1.349890e-01 1 1  ON 7
 uu_8                -1.255552e-01 1 1  ON 8
 uu_9                -9.711539e-02 1 1  ON 9
 ud_0                 4.261563e-01 1 1  ON 10
 ud_1                 1.710598e-01 1 1  ON 11
 ud_2                 6.060755e-02 1 1  ON 12
 ud_3                -5.428328e-03 1 1  ON 13
 ud_4                -5.960933e-02 1 1  ON 14
 ud_5                -1.005917e-01 1 1  ON 15
 ud_6                -1.284743e-01 1 1  ON 16
 ud_7                -1.465366e-01 1 1  ON 17
 ud_8                -1.492318e-01 1 1  ON 18
 ud_9                -1.392190e-01 1 1  ON 19
 eO_0                -7.380179e-01 1 1  ON 20
 eO_1                -4.267114e-01 1 1  ON 21
 eO_2                -1.781899e-02 1 1  ON 22
 eO_3                 2.938794e-01 1 1  ON 23
 eO_4                 5.075649e-01 1 1  ON 24
 eO_5                 4.629259e-01 1 1  ON 25
 eO_6                 2.365624e-01 1 1  ON 26
 eO_7                -5.394026e-02 1 1  ON 27
 eO_8                -2.030231e-01 1 1  ON 28
 eO_9                -6.359178e-02 1 1  ON 29
eH1_0                -2.342294e-01 1 1  ON 30
eH1_1                -1.328157e-01 1 1  ON 31
eH1_2                -9.067973e-02 1 1  ON 32
eH1_3                -4.012797e-02 1 1  ON 33
eH1_4                 1.447740e-02 1 1  ON 34
eH1_5                 4.892646e-02 1 1  ON 35
eH1_6                 1.012970e-01 1 1  ON 36
eH1_7                 1.451841e-01 1 1  ON 37
eH1_8                 1.542377e-01 1 1  ON 38
eH1_9                 3.876925e-02 1 1  ON 39
eH2_0                -2.327489e-01 1 1  ON 40
eH2_1                -1.314846e-01 1 1  ON 41
eH2_2                -8.935246e-02 1 1  ON 42
eH2_3                -3.800605e-02 1 1  ON 43
eH2_4                 1.666873e-02 1 1  ON 44
eH2_5                 5.208115e-02 1 1  ON 45
eH2_6                 1.052823e-01 1 1  ON 46
eH2_7                 1.522964e-01 1 1  ON 47
eH2_8                 1.622014e-01 1 1  ON 48
eH2_9                 2.157137e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8136
    reference variance = 0.194688
====================================================
  Execution time = 2.4947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3663e-01
  Total weights = 2.0000e+06
  Execution time = 3.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334836281837
                                         uncertainty =       0.005908843100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334836281837
                                         uncertainty =       0.005908843100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409201066
  error estimate for blocks of size 2^( 2) =       0.000420870668
  error estimate for blocks of size 2^( 3) =       0.000433325500
  error estimate for blocks of size 2^( 4) =       0.000444635171
  error estimate for blocks of size 2^( 5) =       0.000455465911
  error estimate for blocks of size 2^( 6) =       0.000461446242
  error estimate for blocks of size 2^( 7) =       0.000465065940

      target function =                  N/A
              le_mean =     -16.910621771705
             les_mean =     286.304019562575
             stat err =       0.000456653316
             autocorr =       1.245373784601
              std dev =       0.578697696863
             le_variance =       0.334891024354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337821228768
                                         uncertainty =       0.005940730521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337821228768
                                         uncertainty =       0.005940730521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411021667
  error estimate for blocks of size 2^( 2) =       0.000422603459
  error estimate for blocks of size 2^( 3) =       0.000434909136
  error estimate for blocks of size 2^( 4) =       0.000446072874
  error estimate for blocks of size 2^( 5) =       0.000456768892
  error estimate for blocks of size 2^( 6) =       0.000462716570
  error estimate for blocks of size 2^( 7) =       0.000466308028

      target function =                  N/A
              le_mean =     -16.910608202906
             les_mean =     286.306547244559
             stat err =       0.000457966591
             autocorr =       1.241475522846
              std dev =       0.581272415753
             le_variance =       0.337877621315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338418501248
                                         uncertainty =       0.005943684271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338418501248
                                         uncertainty =       0.005943684271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411385192
  error estimate for blocks of size 2^( 2) =       0.000422952827
  error estimate for blocks of size 2^( 3) =       0.000435251837
  error estimate for blocks of size 2^( 4) =       0.000446421649
  error estimate for blocks of size 2^( 5) =       0.000457127705
  error estimate for blocks of size 2^( 6) =       0.000463101876
  error estimate for blocks of size 2^( 7) =       0.000466686824

      target function =                  N/A
              le_mean =     -16.910617013789
             les_mean =     286.307443169634
             stat err =       0.000458334514
             autocorr =       1.241274445556
              std dev =       0.581786517401
             le_variance =       0.338475551830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335623615354
                                         uncertainty =       0.005916177824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335623615354
                                         uncertainty =       0.005916177824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409682151
  error estimate for blocks of size 2^( 2) =       0.000421324822
  error estimate for blocks of size 2^( 3) =       0.000433744944
  error estimate for blocks of size 2^( 4) =       0.000445026297
  error estimate for blocks of size 2^( 5) =       0.000455832455
  error estimate for blocks of size 2^( 6) =       0.000461816949
  error estimate for blocks of size 2^( 7) =       0.000465427873

      target function =                  N/A
              le_mean =     -16.910615122793
             les_mean =     286.304582593510
             stat err =       0.000457025893
             autocorr =       1.244478865581
              std dev =       0.579378054564
             le_variance =       0.335678930110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910621771705        initial  <--
     1.5625e-02     1.5625e-01             1.3591e-02       -16.910608202906
     6.2500e-02     6.2500e-01             4.8346e-03       -16.910617013789
     2.5000e-01     2.5000e+00             1.8245e-03       -16.910615122793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0417
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.046201e-01 1 1  ON 0
 uu_1                 1.406676e-01 1 1  ON 1
 uu_2                 4.334357e-02 1 1  ON 2
 uu_3                -1.771800e-02 1 1  ON 3
 uu_4                -6.389033e-02 1 1  ON 4
 uu_5                -9.718543e-02 1 1  ON 5
 uu_6                -1.226078e-01 1 1  ON 6
 uu_7                -1.333724e-01 1 1  ON 7
 uu_8                -1.237556e-01 1 1  ON 8
 uu_9                -9.514853e-02 1 1  ON 9
 ud_0                 4.228402e-01 1 1  ON 10
 ud_1                 1.685547e-01 1 1  ON 11
 ud_2                 5.914323e-02 1 1  ON 12
 ud_3                -5.838517e-03 1 1  ON 13
 ud_4                -5.923731e-02 1 1  ON 14
 ud_5                -1.006406e-01 1 1  ON 15
 ud_6                -1.284321e-01 1 1  ON 16
 ud_7                -1.460797e-01 1 1  ON 17
 ud_8                -1.472168e-01 1 1  ON 18
 ud_9                -1.365882e-01 1 1  ON 19
 eO_0                -7.332110e-01 1 1  ON 20
 eO_1                -4.232038e-01 1 1  ON 21
 eO_2                -1.833079e-02 1 1  ON 22
 eO_3                 2.892957e-01 1 1  ON 23
 eO_4                 5.027303e-01 1 1  ON 24
 eO_5                 4.605645e-01 1 1  ON 25
 eO_6                 2.360606e-01 1 1  ON 26
 eO_7                -5.502340e-02 1 1  ON 27
 eO_8                -2.004451e-01 1 1  ON 28
 eO_9                -6.092779e-02 1 1  ON 29
eH1_0                -2.300557e-01 1 1  ON 30
eH1_1                -1.307135e-01 1 1  ON 31
eH1_2                -8.872347e-02 1 1  ON 32
eH1_3                -3.877611e-02 1 1  ON 33
eH1_4                 1.542655e-02 1 1  ON 34
eH1_5                 4.817344e-02 1 1  ON 35
eH1_6                 9.897582e-02 1 1  ON 36
eH1_7                 1.426833e-01 1 1  ON 37
eH1_8                 1.510862e-01 1 1  ON 38
eH1_9                 3.666698e-02 1 1  ON 39
eH2_0                -2.285070e-01 1 1  ON 40
eH2_1                -1.288274e-01 1 1  ON 41
eH2_2                -8.736186e-02 1 1  ON 42
eH2_3                -3.712886e-02 1 1  ON 43
eH2_4                 1.732993e-02 1 1  ON 44
eH2_5                 5.105169e-02 1 1  ON 45
eH2_6                 1.032723e-01 1 1  ON 46
eH2_7                 1.510204e-01 1 1  ON 47
eH2_8                 1.590970e-01 1 1  ON 48
eH2_9                 1.835497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0113
    reference variance = 0.985842
====================================================
  Execution time = 2.6276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332170426200
                                         uncertainty =       0.007213752626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332170426200
                                         uncertainty =       0.007213752626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407530707
  error estimate for blocks of size 2^( 2) =       0.000419709947
  error estimate for blocks of size 2^( 3) =       0.000432096004
  error estimate for blocks of size 2^( 4) =       0.000444632540
  error estimate for blocks of size 2^( 5) =       0.000455589489
  error estimate for blocks of size 2^( 6) =       0.000463226423
  error estimate for blocks of size 2^( 7) =       0.000466269165

      target function =                  N/A
              le_mean =     -16.911228807792
             les_mean =     286.321822177056
             stat err =       0.000457429404
             autocorr =       1.259875067639
              std dev =       0.576335452356
             le_variance =       0.332162553642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691122880779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911228807792       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911232104078       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911234424344       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911241935535       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911248681072       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911247574287       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911248436275       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911249914894       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911250028157       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911249880675       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911249654246       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911249674618       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911249563444       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.802708e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911228807792       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911230037168       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911231168461       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911233239552       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911235986286       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911235563682       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911235117960       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911235452874       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911235503996       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911235457036       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.821961e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911228807792       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911229158225       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911229541674       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911230033535       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911230800779       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911230714473       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911230556110       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911230577156       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911230611184       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.385718e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2940e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.049732e-01 1 1  ON 0
 uu_1                 1.409066e-01 1 1  ON 1
 uu_2                 4.340202e-02 1 1  ON 2
 uu_3                -1.769468e-02 1 1  ON 3
 uu_4                -6.389499e-02 1 1  ON 4
 uu_5                -9.728580e-02 1 1  ON 5
 uu_6                -1.226547e-01 1 1  ON 6
 uu_7                -1.336205e-01 1 1  ON 7
 uu_8                -1.241149e-01 1 1  ON 8
 uu_9                -9.530629e-02 1 1  ON 9
 ud_0                 4.234386e-01 1 1  ON 10
 ud_1                 1.688689e-01 1 1  ON 11
 ud_2                 5.926525e-02 1 1  ON 12
 ud_3                -5.968048e-03 1 1  ON 13
 ud_4                -5.943106e-02 1 1  ON 14
 ud_5                -1.007005e-01 1 1  ON 15
 ud_6                -1.284791e-01 1 1  ON 16
 ud_7                -1.461310e-01 1 1  ON 17
 ud_8                -1.474381e-01 1 1  ON 18
 ud_9                -1.367601e-01 1 1  ON 19
 eO_0                -7.340932e-01 1 1  ON 20
 eO_1                -4.237482e-01 1 1  ON 21
 eO_2                -1.795903e-02 1 1  ON 22
 eO_3                 2.898902e-01 1 1  ON 23
 eO_4                 5.034339e-01 1 1  ON 24
 eO_5                 4.608253e-01 1 1  ON 25
 eO_6                 2.360412e-01 1 1  ON 26
 eO_7                -5.494969e-02 1 1  ON 27
 eO_8                -2.007384e-01 1 1  ON 28
 eO_9                -6.115172e-02 1 1  ON 29
eH1_0                -2.308235e-01 1 1  ON 30
eH1_1                -1.309388e-01 1 1  ON 31
eH1_2                -8.892920e-02 1 1  ON 32
eH1_3                -3.879164e-02 1 1  ON 33
eH1_4                 1.538648e-02 1 1  ON 34
eH1_5                 4.830058e-02 1 1  ON 35
eH1_6                 9.937995e-02 1 1  ON 36
eH1_7                 1.428380e-01 1 1  ON 37
eH1_8                 1.514216e-01 1 1  ON 38
eH1_9                 3.695369e-02 1 1  ON 39
eH2_0                -2.292514e-01 1 1  ON 40
eH2_1                -1.291790e-01 1 1  ON 41
eH2_2                -8.743104e-02 1 1  ON 42
eH2_3                -3.707098e-02 1 1  ON 43
eH2_4                 1.734170e-02 1 1  ON 44
eH2_5                 5.132071e-02 1 1  ON 45
eH2_6                 1.035911e-01 1 1  ON 46
eH2_7                 1.509942e-01 1 1  ON 47
eH2_8                 1.592885e-01 1 1  ON 48
eH2_9                 1.868350e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0827
    reference variance = 1.06652
====================================================
  Execution time = 2.5857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2834e-01
  Total weights = 2.0000e+06
  Execution time = 2.9917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328007968137
                                         uncertainty =       0.004187073903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328007968137
                                         uncertainty =       0.004187073903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404951096
  error estimate for blocks of size 2^( 2) =       0.000417151289
  error estimate for blocks of size 2^( 3) =       0.000429979213
  error estimate for blocks of size 2^( 4) =       0.000441688986
  error estimate for blocks of size 2^( 5) =       0.000451103548
  error estimate for blocks of size 2^( 6) =       0.000459046076
  error estimate for blocks of size 2^( 7) =       0.000463988374

      target function =                  N/A
              le_mean =     -16.910085443944
             les_mean =     286.278960337215
             stat err =       0.000453956746
             autocorr =       1.256677363049
              std dev =       0.572687331549
             le_variance =       0.327970779717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328982156850
                                         uncertainty =       0.004201142465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328982156850
                                         uncertainty =       0.004201142465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405551887
  error estimate for blocks of size 2^( 2) =       0.000417716979
  error estimate for blocks of size 2^( 3) =       0.000430502688
  error estimate for blocks of size 2^( 4) =       0.000442174906
  error estimate for blocks of size 2^( 5) =       0.000451567045
  error estimate for blocks of size 2^( 6) =       0.000459492211
  error estimate for blocks of size 2^( 7) =       0.000464424751

      target function =                  N/A
              le_mean =     -16.910080177275
             les_mean =     286.279756103491
             stat err =       0.000454414728
             autocorr =       1.255486203914
              std dev =       0.573536978846
             le_variance =       0.328944666103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328757358356
                                         uncertainty =       0.004197602117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328757358356
                                         uncertainty =       0.004197602117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405413306
  error estimate for blocks of size 2^( 2) =       0.000417587025
  error estimate for blocks of size 2^( 3) =       0.000430385676
  error estimate for blocks of size 2^( 4) =       0.000442070889
  error estimate for blocks of size 2^( 5) =       0.000451469564
  error estimate for blocks of size 2^( 6) =       0.000459400160
  error estimate for blocks of size 2^( 7) =       0.000464338307

      target function =                  N/A
              le_mean =     -16.910080545279
             les_mean =     286.279543780554
             stat err =       0.000454319730
             autocorr =       1.255819431865
              std dev =       0.573340995465
             le_variance =       0.328719897080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328123915750
                                         uncertainty =       0.004188662315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328123915750
                                         uncertainty =       0.004188662315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405022641
  error estimate for blocks of size 2^( 2) =       0.000417218666
  error estimate for blocks of size 2^( 3) =       0.000430042178
  error estimate for blocks of size 2^( 4) =       0.000441748454
  error estimate for blocks of size 2^( 5) =       0.000451160657
  error estimate for blocks of size 2^( 6) =       0.000459101369
  error estimate for blocks of size 2^( 7) =       0.000464043103

      target function =                  N/A
              le_mean =     -16.910084429922
             les_mean =     286.279041943060
             stat err =       0.000454013396
             autocorr =       1.256546981573
              std dev =       0.572788512470
             le_variance =       0.328086680018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910085443944        initial  <--
     1.5625e-01     1.5625e+00             2.8027e-03       -16.910080177275
     6.2500e-01     6.2500e+00             8.8220e-04       -16.910080545279
     2.5000e+00     2.5000e+01             2.3857e-04       -16.910084429922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9766
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.046201e-01 1 1  ON 0
 uu_1                 1.406676e-01 1 1  ON 1
 uu_2                 4.334357e-02 1 1  ON 2
 uu_3                -1.771800e-02 1 1  ON 3
 uu_4                -6.389033e-02 1 1  ON 4
 uu_5                -9.718543e-02 1 1  ON 5
 uu_6                -1.226078e-01 1 1  ON 6
 uu_7                -1.333724e-01 1 1  ON 7
 uu_8                -1.237556e-01 1 1  ON 8
 uu_9                -9.514853e-02 1 1  ON 9
 ud_0                 4.228402e-01 1 1  ON 10
 ud_1                 1.685547e-01 1 1  ON 11
 ud_2                 5.914323e-02 1 1  ON 12
 ud_3                -5.838517e-03 1 1  ON 13
 ud_4                -5.923731e-02 1 1  ON 14
 ud_5                -1.006406e-01 1 1  ON 15
 ud_6                -1.284321e-01 1 1  ON 16
 ud_7                -1.460797e-01 1 1  ON 17
 ud_8                -1.472168e-01 1 1  ON 18
 ud_9                -1.365882e-01 1 1  ON 19
 eO_0                -7.332110e-01 1 1  ON 20
 eO_1                -4.232038e-01 1 1  ON 21
 eO_2                -1.833079e-02 1 1  ON 22
 eO_3                 2.892957e-01 1 1  ON 23
 eO_4                 5.027303e-01 1 1  ON 24
 eO_5                 4.605645e-01 1 1  ON 25
 eO_6                 2.360606e-01 1 1  ON 26
 eO_7                -5.502340e-02 1 1  ON 27
 eO_8                -2.004451e-01 1 1  ON 28
 eO_9                -6.092779e-02 1 1  ON 29
eH1_0                -2.300557e-01 1 1  ON 30
eH1_1                -1.307135e-01 1 1  ON 31
eH1_2                -8.872347e-02 1 1  ON 32
eH1_3                -3.877611e-02 1 1  ON 33
eH1_4                 1.542655e-02 1 1  ON 34
eH1_5                 4.817344e-02 1 1  ON 35
eH1_6                 9.897582e-02 1 1  ON 36
eH1_7                 1.426833e-01 1 1  ON 37
eH1_8                 1.510862e-01 1 1  ON 38
eH1_9                 3.666698e-02 1 1  ON 39
eH2_0                -2.285070e-01 1 1  ON 40
eH2_1                -1.288274e-01 1 1  ON 41
eH2_2                -8.736186e-02 1 1  ON 42
eH2_3                -3.712886e-02 1 1  ON 43
eH2_4                 1.732993e-02 1 1  ON 44
eH2_5                 5.105169e-02 1 1  ON 45
eH2_6                 1.032723e-01 1 1  ON 46
eH2_7                 1.510204e-01 1 1  ON 47
eH2_8                 1.590970e-01 1 1  ON 48
eH2_9                 1.835497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6936e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.95
    reference variance = 0.248113
====================================================
  Execution time = 2.6411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324168260693
                                         uncertainty =       0.002627800806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324168260693
                                         uncertainty =       0.002627800806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402595195
  error estimate for blocks of size 2^( 2) =       0.000414378072
  error estimate for blocks of size 2^( 3) =       0.000427302165
  error estimate for blocks of size 2^( 4) =       0.000439130078
  error estimate for blocks of size 2^( 5) =       0.000449929257
  error estimate for blocks of size 2^( 6) =       0.000458503774
  error estimate for blocks of size 2^( 7) =       0.000463418320

      target function =                  N/A
              le_mean =     -16.909940786244
             les_mean =     286.270263013682
             stat err =       0.000452745357
             autocorr =       1.264651423802
              std dev =       0.569355584388
             le_variance =       0.324165781473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690994078624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909940786244       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909941752448       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909942274457       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909943082492       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909943698770       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909944002258       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909943867989       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909943923022       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909944001011       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.255006e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909940786244       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909941063658       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909941210408       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909941437823       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909941609625       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909941677944       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909941624713       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909941632808       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909941655387       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.315398e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909940786244       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909940858271       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909940896218       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909940955046       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909940999531       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909941016475       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909941001751       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909941003199       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909941008959       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.090212e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3084e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.046577e-01 1 1  ON 0
 uu_1                 1.407005e-01 1 1  ON 1
 uu_2                 4.334312e-02 1 1  ON 2
 uu_3                -1.772356e-02 1 1  ON 3
 uu_4                -6.389100e-02 1 1  ON 4
 uu_5                -9.721285e-02 1 1  ON 5
 uu_6                -1.226211e-01 1 1  ON 6
 uu_7                -1.333982e-01 1 1  ON 7
 uu_8                -1.237843e-01 1 1  ON 8
 uu_9                -9.516056e-02 1 1  ON 9
 ud_0                 4.229159e-01 1 1  ON 10
 ud_1                 1.685845e-01 1 1  ON 11
 ud_2                 5.913160e-02 1 1  ON 12
 ud_3                -5.863029e-03 1 1  ON 13
 ud_4                -5.926685e-02 1 1  ON 14
 ud_5                -1.006410e-01 1 1  ON 15
 ud_6                -1.284471e-01 1 1  ON 16
 ud_7                -1.460909e-01 1 1  ON 17
 ud_8                -1.472407e-01 1 1  ON 18
 ud_9                -1.365809e-01 1 1  ON 19
 eO_0                -7.332916e-01 1 1  ON 20
 eO_1                -4.232802e-01 1 1  ON 21
 eO_2                -1.829517e-02 1 1  ON 22
 eO_3                 2.893680e-01 1 1  ON 23
 eO_4                 5.028006e-01 1 1  ON 24
 eO_5                 4.605878e-01 1 1  ON 25
 eO_6                 2.360595e-01 1 1  ON 26
 eO_7                -5.501768e-02 1 1  ON 27
 eO_8                -2.004736e-01 1 1  ON 28
 eO_9                -6.094769e-02 1 1  ON 29
eH1_0                -2.301389e-01 1 1  ON 30
eH1_1                -1.307370e-01 1 1  ON 31
eH1_2                -8.874808e-02 1 1  ON 32
eH1_3                -3.877150e-02 1 1  ON 33
eH1_4                 1.542598e-02 1 1  ON 34
eH1_5                 4.818289e-02 1 1  ON 35
eH1_6                 9.900918e-02 1 1  ON 36
eH1_7                 1.427039e-01 1 1  ON 37
eH1_8                 1.511182e-01 1 1  ON 38
eH1_9                 3.669394e-02 1 1  ON 39
eH2_0                -2.285822e-01 1 1  ON 40
eH2_1                -1.288532e-01 1 1  ON 41
eH2_2                -8.737430e-02 1 1  ON 42
eH2_3                -3.713695e-02 1 1  ON 43
eH2_4                 1.732248e-02 1 1  ON 44
eH2_5                 5.107080e-02 1 1  ON 45
eH2_6                 1.033118e-01 1 1  ON 46
eH2_7                 1.510182e-01 1 1  ON 47
eH2_8                 1.591285e-01 1 1  ON 48
eH2_9                 1.839574e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8133
    reference variance = 0.288825
====================================================
  Execution time = 2.5846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2845e-01
  Total weights = 2.0000e+06
  Execution time = 2.9527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328405960508
                                         uncertainty =       0.004441650769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328405960508
                                         uncertainty =       0.004441650769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405208537
  error estimate for blocks of size 2^( 2) =       0.000417085834
  error estimate for blocks of size 2^( 3) =       0.000429134764
  error estimate for blocks of size 2^( 4) =       0.000441171191
  error estimate for blocks of size 2^( 5) =       0.000451581298
  error estimate for blocks of size 2^( 6) =       0.000461697179
  error estimate for blocks of size 2^( 7) =       0.000466218012

      target function =                  N/A
              le_mean =     -16.910402933198
             les_mean =     286.290115115349
             stat err =       0.000455166920
             autocorr =       1.261781660802
              std dev =       0.573051408180
             le_variance =       0.328387916417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328639488662
                                         uncertainty =       0.004447579942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328639488662
                                         uncertainty =       0.004447579942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405352572
  error estimate for blocks of size 2^( 2) =       0.000417222116
  error estimate for blocks of size 2^( 3) =       0.000429262819
  error estimate for blocks of size 2^( 4) =       0.000441293245
  error estimate for blocks of size 2^( 5) =       0.000451697576
  error estimate for blocks of size 2^( 6) =       0.000461807983
  error estimate for blocks of size 2^( 7) =       0.000466329970

      target function =                  N/A
              le_mean =     -16.910403685979
             les_mean =     286.290374073164
             stat err =       0.000455282193
             autocorr =       1.261523846644
              std dev =       0.573255104388
             le_variance =       0.328621414707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328537670326
                                         uncertainty =       0.004445038599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328537670326
                                         uncertainty =       0.004445038599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405289779
  error estimate for blocks of size 2^( 2) =       0.000417162657
  error estimate for blocks of size 2^( 3) =       0.000429206989
  error estimate for blocks of size 2^( 4) =       0.000441240121
  error estimate for blocks of size 2^( 5) =       0.000451646945
  error estimate for blocks of size 2^( 6) =       0.000461759995
  error estimate for blocks of size 2^( 7) =       0.000466281698

      target function =                  N/A
              le_mean =     -16.910403287845
             les_mean =     286.290258802668
             stat err =       0.000455232190
             autocorr =       1.261637604403
              std dev =       0.573166301660
             le_variance =       0.328519609358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328422967899
                                         uncertainty =       0.004442090844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328422967899
                                         uncertainty =       0.004442090844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405219028
  error estimate for blocks of size 2^( 2) =       0.000417095750
  error estimate for blocks of size 2^( 3) =       0.000429144086
  error estimate for blocks of size 2^( 4) =       0.000441180090
  error estimate for blocks of size 2^( 5) =       0.000451589770
  error estimate for blocks of size 2^( 6) =       0.000461705295
  error estimate for blocks of size 2^( 7) =       0.000466226250

      target function =                  N/A
              le_mean =     -16.910402972571
             les_mean =     286.290133452150
             stat err =       0.000455175351
             autocorr =       1.261763065768
              std dev =       0.573066245400
             le_variance =       0.328404921617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910402933198        initial
     1.5625e+00     1.5625e+01             3.2550e-04       -16.910403685979  <--
     6.2500e+00     6.2500e+01             8.3154e-05       -16.910403287845
     2.5000e+01     2.5000e+02             2.0902e-05       -16.910402972571

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.0699e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.047654e-01 1 1  ON 0
 uu_1                 1.407872e-01 1 1  ON 1
 uu_2                 4.335085e-02 1 1  ON 2
 uu_3                -1.773999e-02 1 1  ON 3
 uu_4                -6.389921e-02 1 1  ON 4
 uu_5                -9.728527e-02 1 1  ON 5
 uu_6                -1.226609e-01 1 1  ON 6
 uu_7                -1.334729e-01 1 1  ON 7
 uu_8                -1.238682e-01 1 1  ON 8
 uu_9                -9.519605e-02 1 1  ON 9
 ud_0                 4.231139e-01 1 1  ON 10
 ud_1                 1.686679e-01 1 1  ON 11
 ud_2                 5.911076e-02 1 1  ON 12
 ud_3                -5.930049e-03 1 1  ON 13
 ud_4                -5.934669e-02 1 1  ON 14
 ud_5                -1.006484e-01 1 1  ON 15
 ud_6                -1.284852e-01 1 1  ON 16
 ud_7                -1.461220e-01 1 1  ON 17
 ud_8                -1.473100e-01 1 1  ON 18
 ud_9                -1.365592e-01 1 1  ON 19
 eO_0                -7.335334e-01 1 1  ON 20
 eO_1                -4.234874e-01 1 1  ON 21
 eO_2                -1.820711e-02 1 1  ON 22
 eO_3                 2.895784e-01 1 1  ON 23
 eO_4                 5.030108e-01 1 1  ON 24
 eO_5                 4.606593e-01 1 1  ON 25
 eO_6                 2.360569e-01 1 1  ON 26
 eO_7                -5.500099e-02 1 1  ON 27
 eO_8                -2.005577e-01 1 1  ON 28
 eO_9                -6.100643e-02 1 1  ON 29
eH1_0                -2.303812e-01 1 1  ON 30
eH1_1                -1.308085e-01 1 1  ON 31
eH1_2                -8.882026e-02 1 1  ON 32
eH1_3                -3.876241e-02 1 1  ON 33
eH1_4                 1.542215e-02 1 1  ON 34
eH1_5                 4.821312e-02 1 1  ON 35
eH1_6                 9.910907e-02 1 1  ON 36
eH1_7                 1.427657e-01 1 1  ON 37
eH1_8                 1.512130e-01 1 1  ON 38
eH1_9                 3.677367e-02 1 1  ON 39
eH2_0                -2.288016e-01 1 1  ON 40
eH2_1                -1.289286e-01 1 1  ON 41
eH2_2                -8.741609e-02 1 1  ON 42
eH2_3                -3.716073e-02 1 1  ON 43
eH2_4                 1.729739e-02 1 1  ON 44
eH2_5                 5.112869e-02 1 1  ON 45
eH2_6                 1.034299e-01 1 1  ON 46
eH2_7                 1.510130e-01 1 1  ON 47
eH2_8                 1.592216e-01 1 1  ON 48
eH2_9                 1.851625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.747655
====================================================
  Execution time = 2.5747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331097730840
                                         uncertainty =       0.005055094441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331097730840
                                         uncertainty =       0.005055094441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406885676
  error estimate for blocks of size 2^( 2) =       0.000419122753
  error estimate for blocks of size 2^( 3) =       0.000431362142
  error estimate for blocks of size 2^( 4) =       0.000443305536
  error estimate for blocks of size 2^( 5) =       0.000453128445
  error estimate for blocks of size 2^( 6) =       0.000462477091
  error estimate for blocks of size 2^( 7) =       0.000468691446

      target function =                  N/A
              le_mean =     -16.910004430788
             les_mean =     286.279361591003
             stat err =       0.000456900630
             autocorr =       1.260952449316
              std dev =       0.575423241861
             le_variance =       0.331111907274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691000443079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910004430788       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910004879618       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910005593227       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910005170015       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910004379424       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910006123227       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910005780153       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910005885719       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910005936550       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910005860621       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910005860925       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.013419e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910004430788       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910004580422       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910004810259       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910004700454       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910004398481       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910004543448       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910004795149       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910004735152       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910004732888       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.784831e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910004430788       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910004471600       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910004533605       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910004506608       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910004430510       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910004436282       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910004509425       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910004500849       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.140615e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2367e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.048979e-01 1 1  ON 0
 uu_1                 1.408325e-01 1 1  ON 1
 uu_2                 4.336029e-02 1 1  ON 2
 uu_3                -1.773935e-02 1 1  ON 3
 uu_4                -6.394388e-02 1 1  ON 4
 uu_5                -9.732512e-02 1 1  ON 5
 uu_6                -1.226962e-01 1 1  ON 6
 uu_7                -1.335514e-01 1 1  ON 7
 uu_8                -1.239362e-01 1 1  ON 8
 uu_9                -9.524215e-02 1 1  ON 9
 ud_0                 4.233079e-01 1 1  ON 10
 ud_1                 1.687877e-01 1 1  ON 11
 ud_2                 5.916132e-02 1 1  ON 12
 ud_3                -5.966811e-03 1 1  ON 13
 ud_4                -5.946341e-02 1 1  ON 14
 ud_5                -1.006462e-01 1 1  ON 15
 ud_6                -1.285313e-01 1 1  ON 16
 ud_7                -1.461431e-01 1 1  ON 17
 ud_8                -1.473851e-01 1 1  ON 18
 ud_9                -1.365772e-01 1 1  ON 19
 eO_0                -7.338031e-01 1 1  ON 20
 eO_1                -4.237414e-01 1 1  ON 21
 eO_2                -1.811271e-02 1 1  ON 22
 eO_3                 2.898352e-01 1 1  ON 23
 eO_4                 5.032195e-01 1 1  ON 24
 eO_5                 4.607303e-01 1 1  ON 25
 eO_6                 2.361033e-01 1 1  ON 26
 eO_7                -5.495862e-02 1 1  ON 27
 eO_8                -2.006629e-01 1 1  ON 28
 eO_9                -6.108801e-02 1 1  ON 29
eH1_0                -2.306597e-01 1 1  ON 30
eH1_1                -1.308755e-01 1 1  ON 31
eH1_2                -8.888375e-02 1 1  ON 32
eH1_3                -3.879443e-02 1 1  ON 33
eH1_4                 1.538982e-02 1 1  ON 34
eH1_5                 4.829873e-02 1 1  ON 35
eH1_6                 9.922654e-02 1 1  ON 36
eH1_7                 1.428306e-01 1 1  ON 37
eH1_8                 1.513261e-01 1 1  ON 38
eH1_9                 3.687464e-02 1 1  ON 39
eH2_0                -2.290569e-01 1 1  ON 40
eH2_1                -1.290817e-01 1 1  ON 41
eH2_2                -8.749644e-02 1 1  ON 42
eH2_3                -3.718434e-02 1 1  ON 43
eH2_4                 1.727685e-02 1 1  ON 44
eH2_5                 5.122694e-02 1 1  ON 45
eH2_6                 1.035370e-01 1 1  ON 46
eH2_7                 1.510802e-01 1 1  ON 47
eH2_8                 1.593416e-01 1 1  ON 48
eH2_9                 1.864247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9763
    reference variance = 0.313213
====================================================
  Execution time = 2.5278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3098e-01
  Total weights = 2.0000e+06
  Execution time = 2.9601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330914365202
                                         uncertainty =       0.004875312940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330914365202
                                         uncertainty =       0.004875312940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406734138
  error estimate for blocks of size 2^( 2) =       0.000418528326
  error estimate for blocks of size 2^( 3) =       0.000431060147
  error estimate for blocks of size 2^( 4) =       0.000443317141
  error estimate for blocks of size 2^( 5) =       0.000454590912
  error estimate for blocks of size 2^( 6) =       0.000463994847
  error estimate for blocks of size 2^( 7) =       0.000469925445

      target function =                  N/A
              le_mean =     -16.910334447552
             les_mean =     286.290276280244
             stat err =       0.000457957086
             autocorr =       1.267734522816
              std dev =       0.575208933878
             le_variance =       0.330865317613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331275817014
                                         uncertainty =       0.004888536910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331275817014
                                         uncertainty =       0.004888536910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406956169
  error estimate for blocks of size 2^( 2) =       0.000418739504
  error estimate for blocks of size 2^( 3) =       0.000431255922
  error estimate for blocks of size 2^( 4) =       0.000443500753
  error estimate for blocks of size 2^( 5) =       0.000454761339
  error estimate for blocks of size 2^( 6) =       0.000464155088
  error estimate for blocks of size 2^( 7) =       0.000470085018

      target function =                  N/A
              le_mean =     -16.910332486989
             les_mean =     286.290571302163
             stat err =       0.000458125550
             autocorr =       1.267283419733
              std dev =       0.575522933748
             le_variance =       0.331226647270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331140512800
                                         uncertainty =       0.004883689065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331140512800
                                         uncertainty =       0.004883689065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406873070
  error estimate for blocks of size 2^( 2) =       0.000418660505
  error estimate for blocks of size 2^( 3) =       0.000431183187
  error estimate for blocks of size 2^( 4) =       0.000443433513
  error estimate for blocks of size 2^( 5) =       0.000454699563
  error estimate for blocks of size 2^( 6) =       0.000464098097
  error estimate for blocks of size 2^( 7) =       0.000470028711

      target function =                  N/A
              le_mean =     -16.910333021416
             les_mean =     286.290454119288
             stat err =       0.000458064971
             autocorr =       1.267465867963
              std dev =       0.575405413277
             le_variance =       0.331091389628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330944808582
                                         uncertainty =       0.004876430456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330944808582
                                         uncertainty =       0.004876430456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406752843
  error estimate for blocks of size 2^( 2) =       0.000418546114
  error estimate for blocks of size 2^( 3) =       0.000431076739
  error estimate for blocks of size 2^( 4) =       0.000443332859
  error estimate for blocks of size 2^( 5) =       0.000454605611
  error estimate for blocks of size 2^( 6) =       0.000464008858
  error estimate for blocks of size 2^( 7) =       0.000469939455

      target function =                  N/A
              le_mean =     -16.910334210920
             les_mean =     286.290298710550
             stat err =       0.000457971696
             autocorr =       1.267698805010
              std dev =       0.575235387471
             le_variance =       0.330895750999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910334447552        initial  <--
     3.9062e-01     3.9062e+00             1.0134e-03       -16.910332486989
     1.5625e+00     1.5625e+01             2.7848e-04       -16.910333021416
     6.2500e+00     6.2500e+01             7.1406e-05       -16.910334210920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1723
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.047654e-01 1 1  ON 0
 uu_1                 1.407872e-01 1 1  ON 1
 uu_2                 4.335085e-02 1 1  ON 2
 uu_3                -1.773999e-02 1 1  ON 3
 uu_4                -6.389921e-02 1 1  ON 4
 uu_5                -9.728527e-02 1 1  ON 5
 uu_6                -1.226609e-01 1 1  ON 6
 uu_7                -1.334729e-01 1 1  ON 7
 uu_8                -1.238682e-01 1 1  ON 8
 uu_9                -9.519605e-02 1 1  ON 9
 ud_0                 4.231139e-01 1 1  ON 10
 ud_1                 1.686679e-01 1 1  ON 11
 ud_2                 5.911076e-02 1 1  ON 12
 ud_3                -5.930049e-03 1 1  ON 13
 ud_4                -5.934669e-02 1 1  ON 14
 ud_5                -1.006484e-01 1 1  ON 15
 ud_6                -1.284852e-01 1 1  ON 16
 ud_7                -1.461220e-01 1 1  ON 17
 ud_8                -1.473100e-01 1 1  ON 18
 ud_9                -1.365592e-01 1 1  ON 19
 eO_0                -7.335334e-01 1 1  ON 20
 eO_1                -4.234874e-01 1 1  ON 21
 eO_2                -1.820711e-02 1 1  ON 22
 eO_3                 2.895784e-01 1 1  ON 23
 eO_4                 5.030108e-01 1 1  ON 24
 eO_5                 4.606593e-01 1 1  ON 25
 eO_6                 2.360569e-01 1 1  ON 26
 eO_7                -5.500099e-02 1 1  ON 27
 eO_8                -2.005577e-01 1 1  ON 28
 eO_9                -6.100643e-02 1 1  ON 29
eH1_0                -2.303812e-01 1 1  ON 30
eH1_1                -1.308085e-01 1 1  ON 31
eH1_2                -8.882026e-02 1 1  ON 32
eH1_3                -3.876241e-02 1 1  ON 33
eH1_4                 1.542215e-02 1 1  ON 34
eH1_5                 4.821312e-02 1 1  ON 35
eH1_6                 9.910907e-02 1 1  ON 36
eH1_7                 1.427657e-01 1 1  ON 37
eH1_8                 1.512130e-01 1 1  ON 38
eH1_9                 3.677367e-02 1 1  ON 39
eH2_0                -2.288016e-01 1 1  ON 40
eH2_1                -1.289286e-01 1 1  ON 41
eH2_2                -8.741609e-02 1 1  ON 42
eH2_3                -3.716073e-02 1 1  ON 43
eH2_4                 1.729739e-02 1 1  ON 44
eH2_5                 5.112869e-02 1 1  ON 45
eH2_6                 1.034299e-01 1 1  ON 46
eH2_7                 1.510130e-01 1 1  ON 47
eH2_8                 1.592216e-01 1 1  ON 48
eH2_9                 1.851625e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.381446
====================================================
  Execution time = 2.5660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4278e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342798548353
                                         uncertainty =       0.007233628159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342798548353
                                         uncertainty =       0.007233628159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413993437
  error estimate for blocks of size 2^( 2) =       0.000425826298
  error estimate for blocks of size 2^( 3) =       0.000438419084
  error estimate for blocks of size 2^( 4) =       0.000450802140
  error estimate for blocks of size 2^( 5) =       0.000461094605
  error estimate for blocks of size 2^( 6) =       0.000467482783
  error estimate for blocks of size 2^( 7) =       0.000471390488

      target function =                  N/A
              le_mean =     -16.910388886407
             les_mean =     286.304033250020
             stat err =       0.000462692504
             autocorr =       1.249102318827
              std dev =       0.585475133446
             le_variance =       0.342781131883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691038888641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910388886407       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910389261226       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910389601408       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910389698074       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910389700737       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910389795681       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910389793335       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910389814072       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910389847880       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.356982e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910388886407       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910388982760       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910389071208       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910389097669       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910389095002       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910389119382       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910389116503       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910389120583       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910389129002       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.547899e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910388886407       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910388910667       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910388933008       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910388939776       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910388938951       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910388945051       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910388944169       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910388945110       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910388947194       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.976116e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2256e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.047867e-01 1 1  ON 0
 uu_1                 1.407892e-01 1 1  ON 1
 uu_2                 4.335702e-02 1 1  ON 2
 uu_3                -1.774507e-02 1 1  ON 3
 uu_4                -6.389873e-02 1 1  ON 4
 uu_5                -9.728905e-02 1 1  ON 5
 uu_6                -1.226695e-01 1 1  ON 6
 uu_7                -1.334795e-01 1 1  ON 7
 uu_8                -1.238811e-01 1 1  ON 8
 uu_9                -9.520045e-02 1 1  ON 9
 ud_0                 4.231493e-01 1 1  ON 10
 ud_1                 1.686798e-01 1 1  ON 11
 ud_2                 5.911366e-02 1 1  ON 12
 ud_3                -5.934120e-03 1 1  ON 13
 ud_4                -5.935317e-02 1 1  ON 14
 ud_5                -1.006499e-01 1 1  ON 15
 ud_6                -1.284842e-01 1 1  ON 16
 ud_7                -1.461297e-01 1 1  ON 17
 ud_8                -1.473264e-01 1 1  ON 18
 ud_9                -1.365719e-01 1 1  ON 19
 eO_0                -7.335606e-01 1 1  ON 20
 eO_1                -4.235202e-01 1 1  ON 21
 eO_2                -1.819770e-02 1 1  ON 22
 eO_3                 2.896103e-01 1 1  ON 23
 eO_4                 5.030429e-01 1 1  ON 24
 eO_5                 4.606657e-01 1 1  ON 25
 eO_6                 2.360601e-01 1 1  ON 26
 eO_7                -5.499925e-02 1 1  ON 27
 eO_8                -2.005720e-01 1 1  ON 28
 eO_9                -6.101561e-02 1 1  ON 29
eH1_0                -2.304095e-01 1 1  ON 30
eH1_1                -1.308174e-01 1 1  ON 31
eH1_2                -8.882594e-02 1 1  ON 32
eH1_3                -3.876421e-02 1 1  ON 33
eH1_4                 1.541388e-02 1 1  ON 34
eH1_5                 4.822525e-02 1 1  ON 35
eH1_6                 9.912203e-02 1 1  ON 36
eH1_7                 1.427712e-01 1 1  ON 37
eH1_8                 1.512261e-01 1 1  ON 38
eH1_9                 3.678443e-02 1 1  ON 39
eH2_0                -2.288339e-01 1 1  ON 40
eH2_1                -1.289430e-01 1 1  ON 41
eH2_2                -8.742053e-02 1 1  ON 42
eH2_3                -3.715509e-02 1 1  ON 43
eH2_4                 1.729906e-02 1 1  ON 44
eH2_5                 5.113180e-02 1 1  ON 45
eH2_6                 1.034426e-01 1 1  ON 46
eH2_7                 1.510171e-01 1 1  ON 47
eH2_8                 1.592335e-01 1 1  ON 48
eH2_9                 1.852898e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.192492
====================================================
  Execution time = 2.5303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2788e-01
  Total weights = 2.0000e+06
  Execution time = 2.9664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327914870507
                                         uncertainty =       0.004059380086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327914870507
                                         uncertainty =       0.004059380086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404883900
  error estimate for blocks of size 2^( 2) =       0.000416644992
  error estimate for blocks of size 2^( 3) =       0.000429065323
  error estimate for blocks of size 2^( 4) =       0.000441134439
  error estimate for blocks of size 2^( 5) =       0.000451862330
  error estimate for blocks of size 2^( 6) =       0.000459379771
  error estimate for blocks of size 2^( 7) =       0.000467493572

      target function =                  N/A
              le_mean =     -16.910004047154
             les_mean =     286.276098656294
             stat err =       0.000454967528
             autocorr =       1.262698855405
              std dev =       0.572592303010
             le_variance =       0.327861945466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328002310151
                                         uncertainty =       0.004060518485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328002310151
                                         uncertainty =       0.004060518485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404937883
  error estimate for blocks of size 2^( 2) =       0.000416696516
  error estimate for blocks of size 2^( 3) =       0.000429113906
  error estimate for blocks of size 2^( 4) =       0.000441180246
  error estimate for blocks of size 2^( 5) =       0.000451906784
  error estimate for blocks of size 2^( 6) =       0.000459422970
  error estimate for blocks of size 2^( 7) =       0.000467538044

      target function =                  N/A
              le_mean =     -16.910004382346
             les_mean =     286.276197425841
             stat err =       0.000455012011
             autocorr =       1.262609070946
              std dev =       0.572668646657
             le_variance =       0.327949378864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327961012165
                                         uncertainty =       0.004059983744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327961012165
                                         uncertainty =       0.004059983744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404912388
  error estimate for blocks of size 2^( 2) =       0.000416672187
  error estimate for blocks of size 2^( 3) =       0.000429090982
  error estimate for blocks of size 2^( 4) =       0.000441158662
  error estimate for blocks of size 2^( 5) =       0.000451885856
  error estimate for blocks of size 2^( 6) =       0.000459402648
  error estimate for blocks of size 2^( 7) =       0.000467517111

      target function =                  N/A
              le_mean =     -16.910004212954
             les_mean =     286.276150401721
             stat err =       0.000454991069
             autocorr =       1.262651843076
              std dev =       0.572632590366
             le_variance =       0.327908083550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327920717170
                                         uncertainty =       0.004059456718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327920717170
                                         uncertainty =       0.004059456718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404887510
  error estimate for blocks of size 2^( 2) =       0.000416648438
  error estimate for blocks of size 2^( 3) =       0.000429068575
  error estimate for blocks of size 2^( 4) =       0.000441137510
  error estimate for blocks of size 2^( 5) =       0.000451865312
  error estimate for blocks of size 2^( 6) =       0.000459382671
  error estimate for blocks of size 2^( 7) =       0.000467496557

      target function =                  N/A
              le_mean =     -16.910004067312
             les_mean =     286.276105184239
             stat err =       0.000454970513
             autocorr =       1.262692905822
              std dev =       0.572597408016
             le_variance =       0.327867791666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910004047154        initial
     3.9062e+00     3.9062e+01             1.3570e-04       -16.910004382346  <--
     1.5625e+01     1.5625e+02             3.5479e-05       -16.910004212954
     6.2500e+01     6.2500e+02             8.9761e-06       -16.910004067312

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.2312e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.048478e-01 1 1  ON 0
 uu_1                 1.407966e-01 1 1  ON 1
 uu_2                 4.337457e-02 1 1  ON 2
 uu_3                -1.775867e-02 1 1  ON 3
 uu_4                -6.389861e-02 1 1  ON 4
 uu_5                -9.729997e-02 1 1  ON 5
 uu_6                -1.226944e-01 1 1  ON 6
 uu_7                -1.334991e-01 1 1  ON 7
 uu_8                -1.239196e-01 1 1  ON 8
 uu_9                -9.521359e-02 1 1  ON 9
 ud_0                 4.232496e-01 1 1  ON 10
 ud_1                 1.687161e-01 1 1  ON 11
 ud_2                 5.912368e-02 1 1  ON 12
 ud_3                -5.945222e-03 1 1  ON 13
 ud_4                -5.937151e-02 1 1  ON 14
 ud_5                -1.006544e-01 1 1  ON 15
 ud_6                -1.284812e-01 1 1  ON 16
 ud_7                -1.461518e-01 1 1  ON 17
 ud_8                -1.473748e-01 1 1  ON 18
 ud_9                -1.366098e-01 1 1  ON 19
 eO_0                -7.336435e-01 1 1  ON 20
 eO_1                -4.236145e-01 1 1  ON 21
 eO_2                -1.817154e-02 1 1  ON 22
 eO_3                 2.897049e-01 1 1  ON 23
 eO_4                 5.031388e-01 1 1  ON 24
 eO_5                 4.606851e-01 1 1  ON 25
 eO_6                 2.360698e-01 1 1  ON 26
 eO_7                -5.499407e-02 1 1  ON 27
 eO_8                -2.006148e-01 1 1  ON 28
 eO_9                -6.104297e-02 1 1  ON 29
eH1_0                -2.304935e-01 1 1  ON 30
eH1_1                -1.308436e-01 1 1  ON 31
eH1_2                -8.884382e-02 1 1  ON 32
eH1_3                -3.876984e-02 1 1  ON 33
eH1_4                 1.538909e-02 1 1  ON 34
eH1_5                 4.826147e-02 1 1  ON 35
eH1_6                 9.916113e-02 1 1  ON 36
eH1_7                 1.427878e-01 1 1  ON 37
eH1_8                 1.512655e-01 1 1  ON 38
eH1_9                 3.681651e-02 1 1  ON 39
eH2_0                -2.289297e-01 1 1  ON 40
eH2_1                -1.289848e-01 1 1  ON 41
eH2_2                -8.743470e-02 1 1  ON 42
eH2_3                -3.713929e-02 1 1  ON 43
eH2_4                 1.730372e-02 1 1  ON 44
eH2_5                 5.114150e-02 1 1  ON 45
eH2_6                 1.034805e-01 1 1  ON 46
eH2_7                 1.510293e-01 1 1  ON 47
eH2_8                 1.592690e-01 1 1  ON 48
eH2_9                 1.856692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4591e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.285712
====================================================
  Execution time = 2.5696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331121318676
                                         uncertainty =       0.003934836830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331121318676
                                         uncertainty =       0.003934836830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406916486
  error estimate for blocks of size 2^( 2) =       0.000419018787
  error estimate for blocks of size 2^( 3) =       0.000432000518
  error estimate for blocks of size 2^( 4) =       0.000443830695
  error estimate for blocks of size 2^( 5) =       0.000455652574
  error estimate for blocks of size 2^( 6) =       0.000465381318
  error estimate for blocks of size 2^( 7) =       0.000469075302

      target function =                  N/A
              le_mean =     -16.910825092683
             les_mean =     286.307167202691
             stat err =       0.000458484972
             autocorr =       1.269520270836
              std dev =       0.575466813073
             le_variance =       0.331162052948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691082509268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910825092683       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910825870123       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910826761627       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910829505965       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910828921841       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910829735663       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910828916442       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910828978169       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910829093311       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 5.644980e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910825092683       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910825308871       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910825598390       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910826254425       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910826067693       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910826331692       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910826195869       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910826178125       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910826198654       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.497859e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910825092683       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910825148291       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910825226373       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910825387603       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910825335992       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910825406299       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910825381269       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910825374977       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.810614e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2339e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.049187e-01 1 1  ON 0
 uu_1                 1.408214e-01 1 1  ON 1
 uu_2                 4.337185e-02 1 1  ON 2
 uu_3                -1.776782e-02 1 1  ON 3
 uu_4                -6.390920e-02 1 1  ON 4
 uu_5                -9.731760e-02 1 1  ON 5
 uu_6                -1.226999e-01 1 1  ON 6
 uu_7                -1.335385e-01 1 1  ON 7
 uu_8                -1.239537e-01 1 1  ON 8
 uu_9                -9.523217e-02 1 1  ON 9
 ud_0                 4.233075e-01 1 1  ON 10
 ud_1                 1.687826e-01 1 1  ON 11
 ud_2                 5.916521e-02 1 1  ON 12
 ud_3                -5.963373e-03 1 1  ON 13
 ud_4                -5.942059e-02 1 1  ON 14
 ud_5                -1.006557e-01 1 1  ON 15
 ud_6                -1.285086e-01 1 1  ON 16
 ud_7                -1.461696e-01 1 1  ON 17
 ud_8                -1.474230e-01 1 1  ON 18
 ud_9                -1.366171e-01 1 1  ON 19
 eO_0                -7.337933e-01 1 1  ON 20
 eO_1                -4.236778e-01 1 1  ON 21
 eO_2                -1.815140e-02 1 1  ON 22
 eO_3                 2.898404e-01 1 1  ON 23
 eO_4                 5.032469e-01 1 1  ON 24
 eO_5                 4.607093e-01 1 1  ON 25
 eO_6                 2.360693e-01 1 1  ON 26
 eO_7                -5.498983e-02 1 1  ON 27
 eO_8                -2.006598e-01 1 1  ON 28
 eO_9                -6.107264e-02 1 1  ON 29
eH1_0                -2.306164e-01 1 1  ON 30
eH1_1                -1.308711e-01 1 1  ON 31
eH1_2                -8.890073e-02 1 1  ON 32
eH1_3                -3.878026e-02 1 1  ON 33
eH1_4                 1.535809e-02 1 1  ON 34
eH1_5                 4.830042e-02 1 1  ON 35
eH1_6                 9.923690e-02 1 1  ON 36
eH1_7                 1.428300e-01 1 1  ON 37
eH1_8                 1.513145e-01 1 1  ON 38
eH1_9                 3.685662e-02 1 1  ON 39
eH2_0                -2.290478e-01 1 1  ON 40
eH2_1                -1.290409e-01 1 1  ON 41
eH2_2                -8.745327e-02 1 1  ON 42
eH2_3                -3.716664e-02 1 1  ON 43
eH2_4                 1.729402e-02 1 1  ON 44
eH2_5                 5.119408e-02 1 1  ON 45
eH2_6                 1.035208e-01 1 1  ON 46
eH2_7                 1.510373e-01 1 1  ON 47
eH2_8                 1.593207e-01 1 1  ON 48
eH2_9                 1.863339e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.447714
====================================================
  Execution time = 2.5219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3271e-01
  Total weights = 2.0000e+06
  Execution time = 2.9480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332700651879
                                         uncertainty =       0.007697826172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332700651879
                                         uncertainty =       0.007697826172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407845007
  error estimate for blocks of size 2^( 2) =       0.000419917126
  error estimate for blocks of size 2^( 3) =       0.000432600378
  error estimate for blocks of size 2^( 4) =       0.000444983233
  error estimate for blocks of size 2^( 5) =       0.000456144318
  error estimate for blocks of size 2^( 6) =       0.000464223931
  error estimate for blocks of size 2^( 7) =       0.000470160792

      target function =                  N/A
              le_mean =     -16.910291934734
             les_mean =     286.290648250696
             stat err =       0.000458878069
             autocorr =       1.265914295046
              std dev =       0.576779939921
             le_variance =       0.332675099095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332840577703
                                         uncertainty =       0.007707652276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332840577703
                                         uncertainty =       0.007707652276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407930783
  error estimate for blocks of size 2^( 2) =       0.000419998789
  error estimate for blocks of size 2^( 3) =       0.000432677230
  error estimate for blocks of size 2^( 4) =       0.000445053254
  error estimate for blocks of size 2^( 5) =       0.000456208518
  error estimate for blocks of size 2^( 6) =       0.000464284142
  error estimate for blocks of size 2^( 7) =       0.000470213096

      target function =                  N/A
              le_mean =     -16.910293269039
             les_mean =     286.290833325789
             stat err =       0.000458939753
             autocorr =       1.265722197084
              std dev =       0.576901245694
             le_variance =       0.332815047283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332766099364
                                         uncertainty =       0.007703296190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332766099364
                                         uncertainty =       0.007703296190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407885130
  error estimate for blocks of size 2^( 2) =       0.000419955373
  error estimate for blocks of size 2^( 3) =       0.000432636463
  error estimate for blocks of size 2^( 4) =       0.000445015876
  error estimate for blocks of size 2^( 5) =       0.000456173887
  error estimate for blocks of size 2^( 6) =       0.000464251565
  error estimate for blocks of size 2^( 7) =       0.000470184094

      target function =                  N/A
              le_mean =     -16.910292640192
             les_mean =     286.290737568760
             stat err =       0.000458906356
             autocorr =       1.265821302218
              std dev =       0.576836682428
             le_variance =       0.332740558194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332708479639
                                         uncertainty =       0.007698540051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332708479639
                                         uncertainty =       0.007698540051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407849806
  error estimate for blocks of size 2^( 2) =       0.000419921703
  error estimate for blocks of size 2^( 3) =       0.000432604693
  error estimate for blocks of size 2^( 4) =       0.000444987128
  error estimate for blocks of size 2^( 5) =       0.000456147818
  error estimate for blocks of size 2^( 6) =       0.000464227185
  error estimate for blocks of size 2^( 7) =       0.000470163503

      target function =                  N/A
              le_mean =     -16.910292018130
             les_mean =     286.290658900350
             stat err =       0.000458881409
             autocorr =       1.265902931454
              std dev =       0.576786726855
             le_variance =       0.332682928276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910291934734        initial
     9.7656e-01     9.7656e+00             5.6450e-04       -16.910293269039  <--
     3.9062e+00     3.9062e+01             1.4979e-04       -16.910292640192
     1.5625e+01     1.5625e+02             3.8106e-05       -16.910292018130

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.0076e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.051146e-01 1 1  ON 0
 uu_1                 1.408947e-01 1 1  ON 1
 uu_2                 4.337870e-02 1 1  ON 2
 uu_3                -1.779270e-02 1 1  ON 3
 uu_4                -6.394215e-02 1 1  ON 4
 uu_5                -9.736933e-02 1 1  ON 5
 uu_6                -1.227224e-01 1 1  ON 6
 uu_7                -1.336493e-01 1 1  ON 7
 uu_8                -1.240548e-01 1 1  ON 8
 uu_9                -9.528872e-02 1 1  ON 9
 ud_0                 4.234894e-01 1 1  ON 10
 ud_1                 1.689631e-01 1 1  ON 11
 ud_2                 5.927091e-02 1 1  ON 12
 ud_3                -6.001480e-03 1 1  ON 13
 ud_4                -5.955167e-02 1 1  ON 14
 ud_5                -1.006797e-01 1 1  ON 15
 ud_6                -1.285786e-01 1 1  ON 16
 ud_7                -1.462212e-01 1 1  ON 17
 ud_8                -1.475635e-01 1 1  ON 18
 ud_9                -1.366394e-01 1 1  ON 19
 eO_0                -7.342080e-01 1 1  ON 20
 eO_1                -4.238673e-01 1 1  ON 21
 eO_2                -1.809352e-02 1 1  ON 22
 eO_3                 2.902106e-01 1 1  ON 23
 eO_4                 5.035621e-01 1 1  ON 24
 eO_5                 4.607903e-01 1 1  ON 25
 eO_6                 2.360709e-01 1 1  ON 26
 eO_7                -5.497781e-02 1 1  ON 27
 eO_8                -2.007931e-01 1 1  ON 28
 eO_9                -6.116084e-02 1 1  ON 29
eH1_0                -2.309657e-01 1 1  ON 30
eH1_1                -1.309712e-01 1 1  ON 31
eH1_2                -8.905608e-02 1 1  ON 32
eH1_3                -3.882125e-02 1 1  ON 33
eH1_4                 1.527070e-02 1 1  ON 34
eH1_5                 4.840727e-02 1 1  ON 35
eH1_6                 9.946190e-02 1 1  ON 36
eH1_7                 1.429584e-01 1 1  ON 37
eH1_8                 1.514606e-01 1 1  ON 38
eH1_9                 3.697590e-02 1 1  ON 39
eH2_0                -2.293857e-01 1 1  ON 40
eH2_1                -1.291979e-01 1 1  ON 41
eH2_2                -8.752410e-02 1 1  ON 42
eH2_3                -3.724414e-02 1 1  ON 43
eH2_4                 1.725842e-02 1 1  ON 44
eH2_5                 5.134132e-02 1 1  ON 45
eH2_6                 1.036442e-01 1 1  ON 46
eH2_7                 1.510638e-01 1 1  ON 47
eH2_8                 1.594736e-01 1 1  ON 48
eH2_9                 1.883058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0247
    reference variance = 0.397451
====================================================
  Execution time = 2.5687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2350e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323528539978
                                         uncertainty =       0.002496548670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323528539978
                                         uncertainty =       0.002496548670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402180399
  error estimate for blocks of size 2^( 2) =       0.000414166139
  error estimate for blocks of size 2^( 3) =       0.000427072757
  error estimate for blocks of size 2^( 4) =       0.000439014757
  error estimate for blocks of size 2^( 5) =       0.000450223880
  error estimate for blocks of size 2^( 6) =       0.000458568119
  error estimate for blocks of size 2^( 7) =       0.000461306748

      target function =                  N/A
              le_mean =     -16.910221689661
             les_mean =     286.279095578929
             stat err =       0.000452278376
             autocorr =       1.264648538818
              std dev =       0.568768975249
             le_variance =       0.323498147206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691022168966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910221689661       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910223895823       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910231349134       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910233628166       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910230624031       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910231125811       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910231758008       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910232087543       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910232097437       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910232452270       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910232353559       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.641818e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910221689661       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910222491569       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910225693786       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910226131283       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910225279836       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910225162088       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910225253813       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910225244951       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910225286489       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.691251e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910221689661       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910221915802       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910222883038       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910222965392       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910222767423       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910222707978       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910222718499       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910222718076       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910222731024       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.204561e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2373e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.052695e-01 1 1  ON 0
 uu_1                 1.409788e-01 1 1  ON 1
 uu_2                 4.342450e-02 1 1  ON 2
 uu_3                -1.778370e-02 1 1  ON 3
 uu_4                -6.400224e-02 1 1  ON 4
 uu_5                -9.744850e-02 1 1  ON 5
 uu_6                -1.227812e-01 1 1  ON 6
 uu_7                -1.337789e-01 1 1  ON 7
 uu_8                -1.241753e-01 1 1  ON 8
 uu_9                -9.540669e-02 1 1  ON 9
 ud_0                 4.237967e-01 1 1  ON 10
 ud_1                 1.691004e-01 1 1  ON 11
 ud_2                 5.930778e-02 1 1  ON 12
 ud_3                -6.109402e-03 1 1  ON 13
 ud_4                -5.959455e-02 1 1  ON 14
 ud_5                -1.007120e-01 1 1  ON 15
 ud_6                -1.286245e-01 1 1  ON 16
 ud_7                -1.461127e-01 1 1  ON 17
 ud_8                -1.477436e-01 1 1  ON 18
 ud_9                -1.368170e-01 1 1  ON 19
 eO_0                -7.346772e-01 1 1  ON 20
 eO_1                -4.242542e-01 1 1  ON 21
 eO_2                -1.788084e-02 1 1  ON 22
 eO_3                 2.905591e-01 1 1  ON 23
 eO_4                 5.039132e-01 1 1  ON 24
 eO_5                 4.610275e-01 1 1  ON 25
 eO_6                 2.360851e-01 1 1  ON 26
 eO_7                -5.491865e-02 1 1  ON 27
 eO_8                -2.010044e-01 1 1  ON 28
 eO_9                -6.129669e-02 1 1  ON 29
eH1_0                -2.313458e-01 1 1  ON 30
eH1_1                -1.311881e-01 1 1  ON 31
eH1_2                -8.913846e-02 1 1  ON 32
eH1_3                -3.890700e-02 1 1  ON 33
eH1_4                 1.521702e-02 1 1  ON 34
eH1_5                 4.849116e-02 1 1  ON 35
eH1_6                 9.968961e-02 1 1  ON 36
eH1_7                 1.431809e-01 1 1  ON 37
eH1_8                 1.516670e-01 1 1  ON 38
eH1_9                 3.708432e-02 1 1  ON 39
eH2_0                -2.298502e-01 1 1  ON 40
eH2_1                -1.294110e-01 1 1  ON 41
eH2_2                -8.752939e-02 1 1  ON 42
eH2_3                -3.727663e-02 1 1  ON 43
eH2_4                 1.721784e-02 1 1  ON 44
eH2_5                 5.152544e-02 1 1  ON 45
eH2_6                 1.037263e-01 1 1  ON 46
eH2_7                 1.510568e-01 1 1  ON 47
eH2_8                 1.596972e-01 1 1  ON 48
eH2_9                 1.909298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.353363
====================================================
  Execution time = 2.5440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2769e-01
  Total weights = 2.0000e+06
  Execution time = 2.9486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327453785836
                                         uncertainty =       0.004663952123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327453785836
                                         uncertainty =       0.004663952123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404672328
  error estimate for blocks of size 2^( 2) =       0.000416908830
  error estimate for blocks of size 2^( 3) =       0.000429754856
  error estimate for blocks of size 2^( 4) =       0.000442355007
  error estimate for blocks of size 2^( 5) =       0.000455424153
  error estimate for blocks of size 2^( 6) =       0.000463799245
  error estimate for blocks of size 2^( 7) =       0.000471219796

      target function =                  N/A
              le_mean =     -16.910739054753
             les_mean =     286.300614600078
             stat err =       0.000458199550
             autocorr =       1.282042143930
              std dev =       0.572293094387
             le_variance =       0.327519385883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327943599081
                                         uncertainty =       0.004671979906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327943599081
                                         uncertainty =       0.004671979906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404974585
  error estimate for blocks of size 2^( 2) =       0.000417195913
  error estimate for blocks of size 2^( 3) =       0.000430023717
  error estimate for blocks of size 2^( 4) =       0.000442607482
  error estimate for blocks of size 2^( 5) =       0.000455655152
  error estimate for blocks of size 2^( 6) =       0.000464017055
  error estimate for blocks of size 2^( 7) =       0.000471426543

      target function =                  N/A
              le_mean =     -16.910743238976
             les_mean =     286.301245559227
             stat err =       0.000458426558
             autocorr =       1.281397882352
              std dev =       0.572720550239
             le_variance =       0.328008828666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327795110081
                                         uncertainty =       0.004670112197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327795110081
                                         uncertainty =       0.004670112197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404882968
  error estimate for blocks of size 2^( 2) =       0.000417108944
  error estimate for blocks of size 2^( 3) =       0.000429943553
  error estimate for blocks of size 2^( 4) =       0.000442533932
  error estimate for blocks of size 2^( 5) =       0.000455590353
  error estimate for blocks of size 2^( 6) =       0.000463959745
  error estimate for blocks of size 2^( 7) =       0.000471372975

      target function =                  N/A
              le_mean =     -16.910741216480
             les_mean =     286.301028761792
             stat err =       0.000458364252
             autocorr =       1.281629404877
              std dev =       0.572590984011
             le_variance =       0.327860434971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327502278872
                                         uncertainty =       0.004664850456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327502278872
                                         uncertainty =       0.004664850456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404702260
  error estimate for blocks of size 2^( 2) =       0.000416937261
  error estimate for blocks of size 2^( 3) =       0.000429781713
  error estimate for blocks of size 2^( 4) =       0.000442380502
  error estimate for blocks of size 2^( 5) =       0.000455447923
  error estimate for blocks of size 2^( 6) =       0.000463822418
  error estimate for blocks of size 2^( 7) =       0.000471241877

      target function =                  N/A
              le_mean =     -16.910739218085
             les_mean =     286.300668577387
             stat err =       0.000458223180
             autocorr =       1.281984722285
              std dev =       0.572335425332
             le_variance =       0.327567839090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910739054753        initial
     2.4414e-01     2.4414e+00             1.6418e-03       -16.910743238976  <--
     9.7656e-01     9.7656e+00             4.6913e-04       -16.910741216480
     3.9062e+00     3.9062e+01             1.2046e-04       -16.910739218085

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.0298e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.056843e-01 1 1  ON 0
 uu_1                 1.412243e-01 1 1  ON 1
 uu_2                 4.356440e-02 1 1  ON 2
 uu_3                -1.779443e-02 1 1  ON 3
 uu_4                -6.414337e-02 1 1  ON 4
 uu_5                -9.768643e-02 1 1  ON 5
 uu_6                -1.230032e-01 1 1  ON 6
 uu_7                -1.341162e-01 1 1  ON 7
 uu_8                -1.245101e-01 1 1  ON 8
 uu_9                -9.575320e-02 1 1  ON 9
 ud_0                 4.244090e-01 1 1  ON 10
 ud_1                 1.694914e-01 1 1  ON 11
 ud_2                 5.947558e-02 1 1  ON 12
 ud_3                -6.219300e-03 1 1  ON 13
 ud_4                -5.971756e-02 1 1  ON 14
 ud_5                -1.008155e-01 1 1  ON 15
 ud_6                -1.287133e-01 1 1  ON 16
 ud_7                -1.459297e-01 1 1  ON 17
 ud_8                -1.481688e-01 1 1  ON 18
 ud_9                -1.373082e-01 1 1  ON 19
 eO_0                -7.358498e-01 1 1  ON 20
 eO_1                -4.251446e-01 1 1  ON 21
 eO_2                -1.761335e-02 1 1  ON 22
 eO_3                 2.913838e-01 1 1  ON 23
 eO_4                 5.049197e-01 1 1  ON 24
 eO_5                 4.618123e-01 1 1  ON 25
 eO_6                 2.361804e-01 1 1  ON 26
 eO_7                -5.474016e-02 1 1  ON 27
 eO_8                -2.016270e-01 1 1  ON 28
 eO_9                -6.170756e-02 1 1  ON 29
eH1_0                -2.323307e-01 1 1  ON 30
eH1_1                -1.317741e-01 1 1  ON 31
eH1_2                -8.949239e-02 1 1  ON 32
eH1_3                -3.916489e-02 1 1  ON 33
eH1_4                 1.500020e-02 1 1  ON 34
eH1_5                 4.866521e-02 1 1  ON 35
eH1_6                 1.003352e-01 1 1  ON 36
eH1_7                 1.438684e-01 1 1  ON 37
eH1_8                 1.523061e-01 1 1  ON 38
eH1_9                 3.742622e-02 1 1  ON 39
eH2_0                -2.309879e-01 1 1  ON 40
eH2_1                -1.299530e-01 1 1  ON 41
eH2_2                -8.775109e-02 1 1  ON 42
eH2_3                -3.741739e-02 1 1  ON 43
eH2_4                 1.705926e-02 1 1  ON 44
eH2_5                 5.190798e-02 1 1  ON 45
eH2_6                 1.039979e-01 1 1  ON 46
eH2_7                 1.510905e-01 1 1  ON 47
eH2_8                 1.603750e-01 1 1  ON 48
eH2_9                 1.989344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2678e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8631
    reference variance = 0.280946
====================================================
  Execution time = 2.5695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336716618919
                                         uncertainty =       0.007603826175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336716618919
                                         uncertainty =       0.007603826175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410263725
  error estimate for blocks of size 2^( 2) =       0.000422098522
  error estimate for blocks of size 2^( 3) =       0.000434871706
  error estimate for blocks of size 2^( 4) =       0.000447502362
  error estimate for blocks of size 2^( 5) =       0.000458144347
  error estimate for blocks of size 2^( 6) =       0.000466027252
  error estimate for blocks of size 2^( 7) =       0.000471884090

      target function =                  N/A
              le_mean =     -16.910354749938
             les_mean =     286.296730247992
             stat err =       0.000460889513
             autocorr =       1.262023422292
              std dev =       0.580200523567
             le_variance =       0.336632647548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691035474994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910354749938       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910352841829       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910362127386       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910368928241       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910374895943       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910375255965       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910374748656       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910374555003       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910376217099       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910376598775       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910377799091       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910377410987       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910377143615       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910377658449       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910377607441       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.754115e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910354749938       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910353571788       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910359298920       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910362508125       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910362748480       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910363072387       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910361815250       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910361544076       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910361643790       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910361993454       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910361997500       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.594845e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910354749938       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910354284308       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910355727677       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910356399185       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910357462674       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910357129707       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910356777226       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910356613187       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910356617575       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.517869e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2354e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.063891e-01 1 1  ON 0
 uu_1                 1.416489e-01 1 1  ON 1
 uu_2                 4.385396e-02 1 1  ON 2
 uu_3                -1.759489e-02 1 1  ON 3
 uu_4                -6.432380e-02 1 1  ON 4
 uu_5                -9.800396e-02 1 1  ON 5
 uu_6                -1.236943e-01 1 1  ON 6
 uu_7                -1.345802e-01 1 1  ON 7
 uu_8                -1.251345e-01 1 1  ON 8
 uu_9                -9.603525e-02 1 1  ON 9
 ud_0                 4.252327e-01 1 1  ON 10
 ud_1                 1.698816e-01 1 1  ON 11
 ud_2                 5.952200e-02 1 1  ON 12
 ud_3                -6.336781e-03 1 1  ON 13
 ud_4                -6.008170e-02 1 1  ON 14
 ud_5                -1.009067e-01 1 1  ON 15
 ud_6                -1.287512e-01 1 1  ON 16
 ud_7                -1.460426e-01 1 1  ON 17
 ud_8                -1.482810e-01 1 1  ON 18
 ud_9                -1.375705e-01 1 1  ON 19
 eO_0                -7.374447e-01 1 1  ON 20
 eO_1                -4.261602e-01 1 1  ON 21
 eO_2                -1.764705e-02 1 1  ON 22
 eO_3                 2.926297e-01 1 1  ON 23
 eO_4                 5.064870e-01 1 1  ON 24
 eO_5                 4.626160e-01 1 1  ON 25
 eO_6                 2.362451e-01 1 1  ON 26
 eO_7                -5.439941e-02 1 1  ON 27
 eO_8                -2.023634e-01 1 1  ON 28
 eO_9                -6.227553e-02 1 1  ON 29
eH1_0                -2.338308e-01 1 1  ON 30
eH1_1                -1.323626e-01 1 1  ON 31
eH1_2                -8.998888e-02 1 1  ON 32
eH1_3                -3.971060e-02 1 1  ON 33
eH1_4                 1.443486e-02 1 1  ON 34
eH1_5                 4.878053e-02 1 1  ON 35
eH1_6                 1.012600e-01 1 1  ON 36
eH1_7                 1.448447e-01 1 1  ON 37
eH1_8                 1.533131e-01 1 1  ON 38
eH1_9                 3.808591e-02 1 1  ON 39
eH2_0                -2.321993e-01 1 1  ON 40
eH2_1                -1.302107e-01 1 1  ON 41
eH2_2                -8.809800e-02 1 1  ON 42
eH2_3                -3.759450e-02 1 1  ON 43
eH2_4                 1.665070e-02 1 1  ON 44
eH2_5                 5.201847e-02 1 1  ON 45
eH2_6                 1.044959e-01 1 1  ON 46
eH2_7                 1.512775e-01 1 1  ON 47
eH2_8                 1.611365e-01 1 1  ON 48
eH2_9                 2.082050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.393116
====================================================
  Execution time = 2.5197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2882e-01
  Total weights = 2.0000e+06
  Execution time = 2.9567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328262463161
                                         uncertainty =       0.004204988444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328262463161
                                         uncertainty =       0.004204988444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405079561
  error estimate for blocks of size 2^( 2) =       0.000417027714
  error estimate for blocks of size 2^( 3) =       0.000429326928
  error estimate for blocks of size 2^( 4) =       0.000440895406
  error estimate for blocks of size 2^( 5) =       0.000451646083
  error estimate for blocks of size 2^( 6) =       0.000462081302
  error estimate for blocks of size 2^( 7) =       0.000467636682

      target function =                  N/A
              le_mean =     -16.911201791758
             les_mean =     286.316924779075
             stat err =       0.000455564868
             autocorr =       1.264793976448
              std dev =       0.572869009118
             le_variance =       0.328178901608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329653797919
                                         uncertainty =       0.004227039486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329653797919
                                         uncertainty =       0.004227039486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405937167
  error estimate for blocks of size 2^( 2) =       0.000417855907
  error estimate for blocks of size 2^( 3) =       0.000430109630
  error estimate for blocks of size 2^( 4) =       0.000441625601
  error estimate for blocks of size 2^( 5) =       0.000452344431
  error estimate for blocks of size 2^( 6) =       0.000462750238
  error estimate for blocks of size 2^( 7) =       0.000468263493

      target function =                  N/A
              le_mean =     -16.911194576356
             les_mean =     286.318071801821
             stat err =       0.000456245941
             autocorr =       1.263224074143
              std dev =       0.574081847166
             le_variance =       0.329569967246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329565111668
                                         uncertainty =       0.004228039334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329565111668
                                         uncertainty =       0.004228039334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405882623
  error estimate for blocks of size 2^( 2) =       0.000417800019
  error estimate for blocks of size 2^( 3) =       0.000430062769
  error estimate for blocks of size 2^( 4) =       0.000441596643
  error estimate for blocks of size 2^( 5) =       0.000452324196
  error estimate for blocks of size 2^( 6) =       0.000462741653
  error estimate for blocks of size 2^( 7) =       0.000468266642

      target function =                  N/A
              le_mean =     -16.911195016291
             les_mean =     286.317998121253
             stat err =       0.000456232284
             autocorr =       1.263487968762
              std dev =       0.574004709895
             le_variance =       0.329481406981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328491873835
                                         uncertainty =       0.004209344195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328491873835
                                         uncertainty =       0.004209344195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405221112
  error estimate for blocks of size 2^( 2) =       0.000417163178
  error estimate for blocks of size 2^( 3) =       0.000429456192
  error estimate for blocks of size 2^( 4) =       0.000441019578
  error estimate for blocks of size 2^( 5) =       0.000451766352
  error estimate for blocks of size 2^( 6) =       0.000462198719
  error estimate for blocks of size 2^( 7) =       0.000467749564

      target function =                  N/A
              le_mean =     -16.911200171573
             les_mean =     286.317099378252
             stat err =       0.000455683553
             autocorr =       1.264569142544
              std dev =       0.573069192547
             le_variance =       0.328408299446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911201791758        initial  <--
     6.1035e-02     6.1035e-01             4.7541e-03       -16.911194576356
     2.4414e-01     2.4414e+00             1.5948e-03       -16.911195016291
     9.7656e-01     9.7656e+00             4.5179e-04       -16.911200171573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0666
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.056843e-01 1 1  ON 0
 uu_1                 1.412243e-01 1 1  ON 1
 uu_2                 4.356440e-02 1 1  ON 2
 uu_3                -1.779443e-02 1 1  ON 3
 uu_4                -6.414337e-02 1 1  ON 4
 uu_5                -9.768643e-02 1 1  ON 5
 uu_6                -1.230032e-01 1 1  ON 6
 uu_7                -1.341162e-01 1 1  ON 7
 uu_8                -1.245101e-01 1 1  ON 8
 uu_9                -9.575320e-02 1 1  ON 9
 ud_0                 4.244090e-01 1 1  ON 10
 ud_1                 1.694914e-01 1 1  ON 11
 ud_2                 5.947558e-02 1 1  ON 12
 ud_3                -6.219300e-03 1 1  ON 13
 ud_4                -5.971756e-02 1 1  ON 14
 ud_5                -1.008155e-01 1 1  ON 15
 ud_6                -1.287133e-01 1 1  ON 16
 ud_7                -1.459297e-01 1 1  ON 17
 ud_8                -1.481688e-01 1 1  ON 18
 ud_9                -1.373082e-01 1 1  ON 19
 eO_0                -7.358498e-01 1 1  ON 20
 eO_1                -4.251446e-01 1 1  ON 21
 eO_2                -1.761335e-02 1 1  ON 22
 eO_3                 2.913838e-01 1 1  ON 23
 eO_4                 5.049197e-01 1 1  ON 24
 eO_5                 4.618123e-01 1 1  ON 25
 eO_6                 2.361804e-01 1 1  ON 26
 eO_7                -5.474016e-02 1 1  ON 27
 eO_8                -2.016270e-01 1 1  ON 28
 eO_9                -6.170756e-02 1 1  ON 29
eH1_0                -2.323307e-01 1 1  ON 30
eH1_1                -1.317741e-01 1 1  ON 31
eH1_2                -8.949239e-02 1 1  ON 32
eH1_3                -3.916489e-02 1 1  ON 33
eH1_4                 1.500020e-02 1 1  ON 34
eH1_5                 4.866521e-02 1 1  ON 35
eH1_6                 1.003352e-01 1 1  ON 36
eH1_7                 1.438684e-01 1 1  ON 37
eH1_8                 1.523061e-01 1 1  ON 38
eH1_9                 3.742622e-02 1 1  ON 39
eH2_0                -2.309879e-01 1 1  ON 40
eH2_1                -1.299530e-01 1 1  ON 41
eH2_2                -8.775109e-02 1 1  ON 42
eH2_3                -3.741739e-02 1 1  ON 43
eH2_4                 1.705926e-02 1 1  ON 44
eH2_5                 5.190798e-02 1 1  ON 45
eH2_6                 1.039979e-01 1 1  ON 46
eH2_7                 1.510905e-01 1 1  ON 47
eH2_8                 1.603750e-01 1 1  ON 48
eH2_9                 1.989344e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9311
    reference variance = 0.266372
====================================================
  Execution time = 2.5882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330183651602
                                         uncertainty =       0.005053932806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330183651602
                                         uncertainty =       0.005053932806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406225684
  error estimate for blocks of size 2^( 2) =       0.000418331629
  error estimate for blocks of size 2^( 3) =       0.000431648525
  error estimate for blocks of size 2^( 4) =       0.000444637186
  error estimate for blocks of size 2^( 5) =       0.000454193901
  error estimate for blocks of size 2^( 6) =       0.000461779584
  error estimate for blocks of size 2^( 7) =       0.000466720240

      target function =                  N/A
              le_mean =     -16.910775675500
             les_mean =     286.304372394266
             stat err =       0.000456832728
             autocorr =       1.264677122070
              std dev =       0.574489871290
             le_variance =       0.330038612215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691077567550e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910775675500       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910776196455       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910777516412       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910778321766       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910778930715       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910779387482       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910779557510       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910779368305       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910779200035       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 7.055765e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910775675500       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910775825511       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910776247780       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910776449620       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910776596356       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910776665936       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910776720744       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910776689517       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.849380e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910775675500       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910775714482       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910775828123       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910775878370       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910775914405       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910775927862       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910775941530       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910775935669       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.685065e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2475e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.057552e-01 1 1  ON 0
 uu_1                 1.412847e-01 1 1  ON 1
 uu_2                 4.357348e-02 1 1  ON 2
 uu_3                -1.778906e-02 1 1  ON 3
 uu_4                -6.415058e-02 1 1  ON 4
 uu_5                -9.776883e-02 1 1  ON 5
 uu_6                -1.230259e-01 1 1  ON 6
 uu_7                -1.341622e-01 1 1  ON 7
 uu_8                -1.245725e-01 1 1  ON 8
 uu_9                -9.575436e-02 1 1  ON 9
 ud_0                 4.245408e-01 1 1  ON 10
 ud_1                 1.695431e-01 1 1  ON 11
 ud_2                 5.951145e-02 1 1  ON 12
 ud_3                -6.214716e-03 1 1  ON 13
 ud_4                -5.977373e-02 1 1  ON 14
 ud_5                -1.008132e-01 1 1  ON 15
 ud_6                -1.287230e-01 1 1  ON 16
 ud_7                -1.459455e-01 1 1  ON 17
 ud_8                -1.482170e-01 1 1  ON 18
 ud_9                -1.373742e-01 1 1  ON 19
 eO_0                -7.360124e-01 1 1  ON 20
 eO_1                -4.252445e-01 1 1  ON 21
 eO_2                -1.761242e-02 1 1  ON 22
 eO_3                 2.914788e-01 1 1  ON 23
 eO_4                 5.051046e-01 1 1  ON 24
 eO_5                 4.618795e-01 1 1  ON 25
 eO_6                 2.361936e-01 1 1  ON 26
 eO_7                -5.471277e-02 1 1  ON 27
 eO_8                -2.016857e-01 1 1  ON 28
 eO_9                -6.176420e-02 1 1  ON 29
eH1_0                -2.325041e-01 1 1  ON 30
eH1_1                -1.318143e-01 1 1  ON 31
eH1_2                -8.957059e-02 1 1  ON 32
eH1_3                -3.918947e-02 1 1  ON 33
eH1_4                 1.496503e-02 1 1  ON 34
eH1_5                 4.870026e-02 1 1  ON 35
eH1_6                 1.004440e-01 1 1  ON 36
eH1_7                 1.439340e-01 1 1  ON 37
eH1_8                 1.523866e-01 1 1  ON 38
eH1_9                 3.748566e-02 1 1  ON 39
eH2_0                -2.311535e-01 1 1  ON 40
eH2_1                -1.300430e-01 1 1  ON 41
eH2_2                -8.779972e-02 1 1  ON 42
eH2_3                -3.739185e-02 1 1  ON 43
eH2_4                 1.704392e-02 1 1  ON 44
eH2_5                 5.194917e-02 1 1  ON 45
eH2_6                 1.040847e-01 1 1  ON 46
eH2_7                 1.511003e-01 1 1  ON 47
eH2_8                 1.604289e-01 1 1  ON 48
eH2_9                 1.999084e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.97
    reference variance = 0.155671
====================================================
  Execution time = 2.5359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6991e+01
  VMC Evar = 1.2850e+04
  Total weights = 2.0000e+06
  Execution time = 2.9721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12853.749529731009
                                         uncertainty =   12788.987174158303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12853.749529731009
                                         uncertainty =   12788.987174158303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.080103632430
  error estimate for blocks of size 2^( 2) =       0.080108946350
  error estimate for blocks of size 2^( 3) =       0.080108925428
  error estimate for blocks of size 2^( 4) =       0.080109386229
  error estimate for blocks of size 2^( 5) =       0.080150180246
  error estimate for blocks of size 2^( 6) =       0.080150697426
  error estimate for blocks of size 2^( 7) =       0.080151221813

      target function =                  N/A
              le_mean =     -16.990626371557
             les_mean =   13121.858824912735
             stat err =       0.080140371429
             autocorr =       1.000917497055
              std dev =     113.283643378057
             le_variance =   12833.183857006805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12920.717780989622
                                         uncertainty =   12855.619462376300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12920.717780989622
                                         uncertainty =   12855.619462376300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.080312031973
  error estimate for blocks of size 2^( 2) =       0.080317358890
  error estimate for blocks of size 2^( 3) =       0.080317337682
  error estimate for blocks of size 2^( 4) =       0.080317798979
  error estimate for blocks of size 2^( 5) =       0.080358701474
  error estimate for blocks of size 2^( 6) =       0.080359216465
  error estimate for blocks of size 2^( 7) =       0.080359740893

      target function =                  N/A
              le_mean =     -16.990835528239
             les_mean =   13188.727001094792
             stat err =       0.080348864453
             autocorr =       1.000917444749
              std dev =     113.578364837541
             le_variance =   12900.044959169614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12886.753005196899
                                         uncertainty =   12821.825034456111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12886.753005196899
                                         uncertainty =   12821.825034456111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.080206404130
  error estimate for blocks of size 2^( 2) =       0.080211724274
  error estimate for blocks of size 2^( 3) =       0.080211703151
  error estimate for blocks of size 2^( 4) =       0.080212164669
  error estimate for blocks of size 2^( 5) =       0.080253012667
  error estimate for blocks of size 2^( 6) =       0.080253528730
  error estimate for blocks of size 2^( 7) =       0.080254052295

      target function =                  N/A
              le_mean =     -16.990729589561
             les_mean =   13154.812985690198
             stat err =       0.080243189591
             autocorr =       1.000917480268
              std dev =     113.428984509127
             le_variance =   12866.134526771883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12858.044777024981
                                         uncertainty =   12793.260866485814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =   12858.044777024981
                                         uncertainty =   12793.260866485814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.080117015146
  error estimate for blocks of size 2^( 2) =       0.080122329869
  error estimate for blocks of size 2^( 3) =       0.080122308923
  error estimate for blocks of size 2^( 4) =       0.080122769833
  error estimate for blocks of size 2^( 5) =       0.080163570897
  error estimate for blocks of size 2^( 6) =       0.080164087919
  error estimate for blocks of size 2^( 7) =       0.080164612182

      target function =                  N/A
              le_mean =     -16.990639804204
             les_mean =   13126.147654107210
             stat err =       0.080153760208
             autocorr =       1.000917495191
              std dev =     113.302569396670
             le_variance =   12837.472231887128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.990626371557        initial
     6.1035e-01     6.1035e+00             7.0558e-04       -16.990835528239  <--
     2.4414e+00     2.4414e+01             1.8494e-04       -16.990729589561
     9.7656e+00     9.7656e+01             4.6851e-05       -16.990639804204

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.4167e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.059635e-01 1 1  ON 0
 uu_1                 1.414315e-01 1 1  ON 1
 uu_2                 4.361681e-02 1 1  ON 2
 uu_3                -1.778007e-02 1 1  ON 3
 uu_4                -6.419065e-02 1 1  ON 4
 uu_5                -9.795402e-02 1 1  ON 5
 uu_6                -1.231184e-01 1 1  ON 6
 uu_7                -1.342987e-01 1 1  ON 7
 uu_8                -1.247528e-01 1 1  ON 8
 uu_9                -9.575890e-02 1 1  ON 9
 ud_0                 4.248439e-01 1 1  ON 10
 ud_1                 1.697244e-01 1 1  ON 11
 ud_2                 5.962243e-02 1 1  ON 12
 ud_3                -6.186583e-03 1 1  ON 13
 ud_4                -5.989251e-02 1 1  ON 14
 ud_5                -1.008300e-01 1 1  ON 15
 ud_6                -1.287429e-01 1 1  ON 16
 ud_7                -1.459891e-01 1 1  ON 17
 ud_8                -1.483524e-01 1 1  ON 18
 ud_9                -1.375701e-01 1 1  ON 19
 eO_0                -7.364672e-01 1 1  ON 20
 eO_1                -4.255407e-01 1 1  ON 21
 eO_2                -1.762265e-02 1 1  ON 22
 eO_3                 2.917347e-01 1 1  ON 23
 eO_4                 5.056253e-01 1 1  ON 24
 eO_5                 4.621068e-01 1 1  ON 25
 eO_6                 2.362489e-01 1 1  ON 26
 eO_7                -5.462877e-02 1 1  ON 27
 eO_8                -2.018622e-01 1 1  ON 28
 eO_9                -6.193666e-02 1 1  ON 29
eH1_0                -2.329873e-01 1 1  ON 30
eH1_1                -1.319704e-01 1 1  ON 31
eH1_2                -8.979171e-02 1 1  ON 32
eH1_3                -3.926745e-02 1 1  ON 33
eH1_4                 1.486384e-02 1 1  ON 34
eH1_5                 4.878295e-02 1 1  ON 35
eH1_6                 1.007591e-01 1 1  ON 36
eH1_7                 1.441382e-01 1 1  ON 37
eH1_8                 1.526339e-01 1 1  ON 38
eH1_9                 3.766847e-02 1 1  ON 39
eH2_0                -2.316199e-01 1 1  ON 40
eH2_1                -1.302776e-01 1 1  ON 41
eH2_2                -8.795026e-02 1 1  ON 42
eH2_3                -3.735521e-02 1 1  ON 43
eH2_4                 1.699322e-02 1 1  ON 44
eH2_5                 5.204080e-02 1 1  ON 45
eH2_6                 1.043381e-01 1 1  ON 46
eH2_7                 1.511412e-01 1 1  ON 47
eH2_8                 1.605955e-01 1 1  ON 48
eH2_9                 2.028852e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.247936
====================================================
  Execution time = 2.5754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2895e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328979381303
                                         uncertainty =       0.004123552332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328979381303
                                         uncertainty =       0.004123552332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405554655
  error estimate for blocks of size 2^( 2) =       0.000417638735
  error estimate for blocks of size 2^( 3) =       0.000431028399
  error estimate for blocks of size 2^( 4) =       0.000443810730
  error estimate for blocks of size 2^( 5) =       0.000456170359
  error estimate for blocks of size 2^( 6) =       0.000466210298
  error estimate for blocks of size 2^( 7) =       0.000470622659

      target function =                  N/A
              le_mean =     -16.909667809833
             les_mean =     286.265814430944
             stat err =       0.000459203512
             autocorr =       1.282069650201
              std dev =       0.573540893501
             le_variance =       0.328949156518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690966780983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909667809833       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909671681651       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909672410322       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909675233644       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909680197535       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909679662184       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909680477018       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909681122168       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909682038482       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909681654798       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909681594424       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.587232e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909667809833       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669257286       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669672070       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909671585125       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909672103999       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909671864194       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909671903158       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909671971522       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909672115839       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 7.342891e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909667809833       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909668222845       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909668379842       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909669043952       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669050169       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909668991804       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909668969725       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909669007232       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.938994e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2421e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.062310e-01 1 1  ON 0
 uu_1                 1.415708e-01 1 1  ON 1
 uu_2                 4.368464e-02 1 1  ON 2
 uu_3                -1.789968e-02 1 1  ON 3
 uu_4                -6.434022e-02 1 1  ON 4
 uu_5                -9.809125e-02 1 1  ON 5
 uu_6                -1.233184e-01 1 1  ON 6
 uu_7                -1.345199e-01 1 1  ON 7
 uu_8                -1.248346e-01 1 1  ON 8
 uu_9                -9.571495e-02 1 1  ON 9
 ud_0                 4.249785e-01 1 1  ON 10
 ud_1                 1.698435e-01 1 1  ON 11
 ud_2                 5.957814e-02 1 1  ON 12
 ud_3                -6.242443e-03 1 1  ON 13
 ud_4                -6.003256e-02 1 1  ON 14
 ud_5                -1.009049e-01 1 1  ON 15
 ud_6                -1.286645e-01 1 1  ON 16
 ud_7                -1.462226e-01 1 1  ON 17
 ud_8                -1.483436e-01 1 1  ON 18
 ud_9                -1.374156e-01 1 1  ON 19
 eO_0                -7.371807e-01 1 1  ON 20
 eO_1                -4.259695e-01 1 1  ON 21
 eO_2                -1.768889e-02 1 1  ON 22
 eO_3                 2.921739e-01 1 1  ON 23
 eO_4                 5.063596e-01 1 1  ON 24
 eO_5                 4.624622e-01 1 1  ON 25
 eO_6                 2.362115e-01 1 1  ON 26
 eO_7                -5.462452e-02 1 1  ON 27
 eO_8                -2.020079e-01 1 1  ON 28
 eO_9                -6.206003e-02 1 1  ON 29
eH1_0                -2.337092e-01 1 1  ON 30
eH1_1                -1.322046e-01 1 1  ON 31
eH1_2                -9.015027e-02 1 1  ON 32
eH1_3                -3.942989e-02 1 1  ON 33
eH1_4                 1.466523e-02 1 1  ON 34
eH1_5                 4.894008e-02 1 1  ON 35
eH1_6                 1.011059e-01 1 1  ON 36
eH1_7                 1.444472e-01 1 1  ON 37
eH1_8                 1.530995e-01 1 1  ON 38
eH1_9                 3.800902e-02 1 1  ON 39
eH2_0                -2.321373e-01 1 1  ON 40
eH2_1                -1.304526e-01 1 1  ON 41
eH2_2                -8.832139e-02 1 1  ON 42
eH2_3                -3.749569e-02 1 1  ON 43
eH2_4                 1.684858e-02 1 1  ON 44
eH2_5                 5.198327e-02 1 1  ON 45
eH2_6                 1.046039e-01 1 1  ON 46
eH2_7                 1.514848e-01 1 1  ON 47
eH2_8                 1.610479e-01 1 1  ON 48
eH2_9                 2.063103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9806
    reference variance = 0.639244
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3888e-01
  Total weights = 2.0000e+06
  Execution time = 2.9607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338752893522
                                         uncertainty =       0.007272887675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338752893522
                                         uncertainty =       0.007272887675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411497734
  error estimate for blocks of size 2^( 2) =       0.000423495081
  error estimate for blocks of size 2^( 3) =       0.000435748781
  error estimate for blocks of size 2^( 4) =       0.000447138816
  error estimate for blocks of size 2^( 5) =       0.000457372449
  error estimate for blocks of size 2^( 6) =       0.000464727168
  error estimate for blocks of size 2^( 7) =       0.000468886546

      target function =                  N/A
              le_mean =     -16.910197162721
             les_mean =     286.293428683030
             stat err =       0.000459531245
             autocorr =       1.247082529026
              std dev =       0.581945676382
             le_variance =       0.338660770260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392353751
                                         uncertainty =       0.007282973459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392353751
                                         uncertainty =       0.007282973459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411885863
  error estimate for blocks of size 2^( 2) =       0.000423871670
  error estimate for blocks of size 2^( 3) =       0.000436099980
  error estimate for blocks of size 2^( 4) =       0.000447459433
  error estimate for blocks of size 2^( 5) =       0.000457667183
  error estimate for blocks of size 2^( 6) =       0.000464994755
  error estimate for blocks of size 2^( 7) =       0.000469131814

      target function =                  N/A
              le_mean =     -16.910196781875
             les_mean =     286.294054959868
             stat err =       0.000459813296
             autocorr =       1.246261788753
              std dev =       0.582494573178
             le_variance =       0.339299927782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339189673839
                                         uncertainty =       0.007280634032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339189673839
                                         uncertainty =       0.007280634032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411762926
  error estimate for blocks of size 2^( 2) =       0.000423750316
  error estimate for blocks of size 2^( 3) =       0.000435985725
  error estimate for blocks of size 2^( 4) =       0.000447355716
  error estimate for blocks of size 2^( 5) =       0.000457573231
  error estimate for blocks of size 2^( 6) =       0.000464908608
  error estimate for blocks of size 2^( 7) =       0.000469052622

      target function =                  N/A
              le_mean =     -16.910197112999
             les_mean =     286.293863645260
             stat err =       0.000459722544
             autocorr =       1.246513884775
              std dev =       0.582320714326
             le_variance =       0.339097414333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338811323276
                                         uncertainty =       0.007274031328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338811323276
                                         uncertainty =       0.007274031328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411533221
  error estimate for blocks of size 2^( 2) =       0.000423529015
  error estimate for blocks of size 2^( 3) =       0.000435780068
  error estimate for blocks of size 2^( 4) =       0.000447167339
  error estimate for blocks of size 2^( 5) =       0.000457398781
  error estimate for blocks of size 2^( 6) =       0.000464750639
  error estimate for blocks of size 2^( 7) =       0.000468907911

      target function =                  N/A
              le_mean =     -16.910197093199
             les_mean =     286.293484745578
             stat err =       0.000459556167
             autocorr =       1.247002714925
              std dev =       0.581995862608
             le_variance =       0.338719184093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910197162721        initial  <--
     1.5259e-01     1.5259e+00             2.5872e-03       -16.910196781875
     6.1035e-01     6.1035e+00             7.3429e-04       -16.910197112999
     2.4414e+00     2.4414e+01             1.9390e-04       -16.910197093199

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0618
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.059635e-01 1 1  ON 0
 uu_1                 1.414315e-01 1 1  ON 1
 uu_2                 4.361681e-02 1 1  ON 2
 uu_3                -1.778007e-02 1 1  ON 3
 uu_4                -6.419065e-02 1 1  ON 4
 uu_5                -9.795402e-02 1 1  ON 5
 uu_6                -1.231184e-01 1 1  ON 6
 uu_7                -1.342987e-01 1 1  ON 7
 uu_8                -1.247528e-01 1 1  ON 8
 uu_9                -9.575890e-02 1 1  ON 9
 ud_0                 4.248439e-01 1 1  ON 10
 ud_1                 1.697244e-01 1 1  ON 11
 ud_2                 5.962243e-02 1 1  ON 12
 ud_3                -6.186583e-03 1 1  ON 13
 ud_4                -5.989251e-02 1 1  ON 14
 ud_5                -1.008300e-01 1 1  ON 15
 ud_6                -1.287429e-01 1 1  ON 16
 ud_7                -1.459891e-01 1 1  ON 17
 ud_8                -1.483524e-01 1 1  ON 18
 ud_9                -1.375701e-01 1 1  ON 19
 eO_0                -7.364672e-01 1 1  ON 20
 eO_1                -4.255407e-01 1 1  ON 21
 eO_2                -1.762265e-02 1 1  ON 22
 eO_3                 2.917347e-01 1 1  ON 23
 eO_4                 5.056253e-01 1 1  ON 24
 eO_5                 4.621068e-01 1 1  ON 25
 eO_6                 2.362489e-01 1 1  ON 26
 eO_7                -5.462877e-02 1 1  ON 27
 eO_8                -2.018622e-01 1 1  ON 28
 eO_9                -6.193666e-02 1 1  ON 29
eH1_0                -2.329873e-01 1 1  ON 30
eH1_1                -1.319704e-01 1 1  ON 31
eH1_2                -8.979171e-02 1 1  ON 32
eH1_3                -3.926745e-02 1 1  ON 33
eH1_4                 1.486384e-02 1 1  ON 34
eH1_5                 4.878295e-02 1 1  ON 35
eH1_6                 1.007591e-01 1 1  ON 36
eH1_7                 1.441382e-01 1 1  ON 37
eH1_8                 1.526339e-01 1 1  ON 38
eH1_9                 3.766847e-02 1 1  ON 39
eH2_0                -2.316199e-01 1 1  ON 40
eH2_1                -1.302776e-01 1 1  ON 41
eH2_2                -8.795026e-02 1 1  ON 42
eH2_3                -3.735521e-02 1 1  ON 43
eH2_4                 1.699322e-02 1 1  ON 44
eH2_5                 5.204080e-02 1 1  ON 45
eH2_6                 1.043381e-01 1 1  ON 46
eH2_7                 1.511412e-01 1 1  ON 47
eH2_8                 1.605955e-01 1 1  ON 48
eH2_9                 2.028852e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.230263
====================================================
  Execution time = 2.6245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.9739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328460617826
                                         uncertainty =       0.003485430318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328460617826
                                         uncertainty =       0.003485430318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405221702
  error estimate for blocks of size 2^( 2) =       0.000417209517
  error estimate for blocks of size 2^( 3) =       0.000429815958
  error estimate for blocks of size 2^( 4) =       0.000442101067
  error estimate for blocks of size 2^( 5) =       0.000453199382
  error estimate for blocks of size 2^( 6) =       0.000459101515
  error estimate for blocks of size 2^( 7) =       0.000463488149

      target function =                  N/A
              le_mean =     -16.909893504382
             les_mean =     286.272907421540
             stat err =       0.000454472528
             autocorr =       1.257852968519
              std dev =       0.573070027302
             le_variance =       0.328409256192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690989350438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893504382       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893751917       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909894451259       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909895395867       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909895477735       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909895439463       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909895471147       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909895494173       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909895493202       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.642720e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893504382       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893571816       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909893763889       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909894019695       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909894033879       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909894028949       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909894027889       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909894030127       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.811660e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909893504382       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909893521627       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909893570949       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909893636207       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909893639662       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909893638794       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909893637929       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909893638234       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.716472e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3225e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.059817e-01 1 1  ON 0
 uu_1                 1.414431e-01 1 1  ON 1
 uu_2                 4.363440e-02 1 1  ON 2
 uu_3                -1.777850e-02 1 1  ON 3
 uu_4                -6.420903e-02 1 1  ON 4
 uu_5                -9.795522e-02 1 1  ON 5
 uu_6                -1.231538e-01 1 1  ON 6
 uu_7                -1.343191e-01 1 1  ON 7
 uu_8                -1.247776e-01 1 1  ON 8
 uu_9                -9.576223e-02 1 1  ON 9
 ud_0                 4.248731e-01 1 1  ON 10
 ud_1                 1.697364e-01 1 1  ON 11
 ud_2                 5.963373e-02 1 1  ON 12
 ud_3                -6.176362e-03 1 1  ON 13
 ud_4                -5.991900e-02 1 1  ON 14
 ud_5                -1.008257e-01 1 1  ON 15
 ud_6                -1.287488e-01 1 1  ON 16
 ud_7                -1.459938e-01 1 1  ON 17
 ud_8                -1.483714e-01 1 1  ON 18
 ud_9                -1.375818e-01 1 1  ON 19
 eO_0                -7.365206e-01 1 1  ON 20
 eO_1                -4.255770e-01 1 1  ON 21
 eO_2                -1.763685e-02 1 1  ON 22
 eO_3                 2.917877e-01 1 1  ON 23
 eO_4                 5.056828e-01 1 1  ON 24
 eO_5                 4.621373e-01 1 1  ON 25
 eO_6                 2.362480e-01 1 1  ON 26
 eO_7                -5.461812e-02 1 1  ON 27
 eO_8                -2.018909e-01 1 1  ON 28
 eO_9                -6.195227e-02 1 1  ON 29
eH1_0                -2.330482e-01 1 1  ON 30
eH1_1                -1.320119e-01 1 1  ON 31
eH1_2                -8.982414e-02 1 1  ON 32
eH1_3                -3.927197e-02 1 1  ON 33
eH1_4                 1.484293e-02 1 1  ON 34
eH1_5                 4.879802e-02 1 1  ON 35
eH1_6                 1.007955e-01 1 1  ON 36
eH1_7                 1.441698e-01 1 1  ON 37
eH1_8                 1.526722e-01 1 1  ON 38
eH1_9                 3.770162e-02 1 1  ON 39
eH2_0                -2.316880e-01 1 1  ON 40
eH2_1                -1.302950e-01 1 1  ON 41
eH2_2                -8.796965e-02 1 1  ON 42
eH2_3                -3.736297e-02 1 1  ON 43
eH2_4                 1.700361e-02 1 1  ON 44
eH2_5                 5.204482e-02 1 1  ON 45
eH2_6                 1.043697e-01 1 1  ON 46
eH2_7                 1.511515e-01 1 1  ON 47
eH2_8                 1.606166e-01 1 1  ON 48
eH2_9                 2.032117e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9693
    reference variance = 0.597414
====================================================
  Execution time = 2.5519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2928e-01
  Total weights = 2.0000e+06
  Execution time = 2.9585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329318926143
                                         uncertainty =       0.005277659422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329318926143
                                         uncertainty =       0.005277659422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405751547
  error estimate for blocks of size 2^( 2) =       0.000418066923
  error estimate for blocks of size 2^( 3) =       0.000430804523
  error estimate for blocks of size 2^( 4) =       0.000442513898
  error estimate for blocks of size 2^( 5) =       0.000452116771
  error estimate for blocks of size 2^( 6) =       0.000460224362
  error estimate for blocks of size 2^( 7) =       0.000467361558

      target function =                  N/A
              le_mean =     -16.910181523264
             les_mean =     286.283507620575
             stat err =       0.000455554148
             autocorr =       1.260548737201
              std dev =       0.573819340434
             le_variance =       0.329268635456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329372632574
                                         uncertainty =       0.005278511636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329372632574
                                         uncertainty =       0.005278511636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405784594
  error estimate for blocks of size 2^( 2) =       0.000418098817
  error estimate for blocks of size 2^( 3) =       0.000430833958
  error estimate for blocks of size 2^( 4) =       0.000442540218
  error estimate for blocks of size 2^( 5) =       0.000452138899
  error estimate for blocks of size 2^( 6) =       0.000460243228
  error estimate for blocks of size 2^( 7) =       0.000467378082

      target function =                  N/A
              le_mean =     -16.910182021106
             les_mean =     286.283578095194
             stat err =       0.000455575107
             autocorr =       1.260459403563
              std dev =       0.573866075762
             le_variance =       0.329322272910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329347894431
                                         uncertainty =       0.005278133086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329347894431
                                         uncertainty =       0.005278133086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405769371
  error estimate for blocks of size 2^( 2) =       0.000418084147
  error estimate for blocks of size 2^( 3) =       0.000430820462
  error estimate for blocks of size 2^( 4) =       0.000442528188
  error estimate for blocks of size 2^( 5) =       0.000452128871
  error estimate for blocks of size 2^( 6) =       0.000460234668
  error estimate for blocks of size 2^( 7) =       0.000467370796

      target function =                  N/A
              le_mean =     -16.910181806738
             les_mean =     286.283546137545
             stat err =       0.000455565631
             autocorr =       1.260501540136
              std dev =       0.573844547987
             le_variance =       0.329297565255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329322634029
                                         uncertainty =       0.005277719897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329322634029
                                         uncertainty =       0.005277719897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405753828
  error estimate for blocks of size 2^( 2) =       0.000418069127
  error estimate for blocks of size 2^( 3) =       0.000430806564
  error estimate for blocks of size 2^( 4) =       0.000442515729
  error estimate for blocks of size 2^( 5) =       0.000452118323
  error estimate for blocks of size 2^( 6) =       0.000460225688
  error estimate for blocks of size 2^( 7) =       0.000467362751

      target function =                  N/A
              le_mean =     -16.910181557897
             les_mean =     286.283512494795
             stat err =       0.000455555623
             autocorr =       1.260542726480
              std dev =       0.573822566984
             le_variance =       0.329272338380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910181523264        initial
     1.5259e+00     1.5259e+01             2.6427e-04       -16.910182021106  <--
     6.1035e+00     6.1035e+01             6.8117e-05       -16.910181806738
     2.4414e+01     2.4414e+02             1.7165e-05       -16.910181557897

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.0524e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.060369e-01 1 1  ON 0
 uu_1                 1.414784e-01 1 1  ON 1
 uu_2                 4.368103e-02 1 1  ON 2
 uu_3                -1.777093e-02 1 1  ON 3
 uu_4                -6.425712e-02 1 1  ON 4
 uu_5                -9.796862e-02 1 1  ON 5
 uu_6                -1.232515e-01 1 1  ON 6
 uu_7                -1.343810e-01 1 1  ON 7
 uu_8                -1.248543e-01 1 1  ON 8
 uu_9                -9.577330e-02 1 1  ON 9
 ud_0                 4.249549e-01 1 1  ON 10
 ud_1                 1.697807e-01 1 1  ON 11
 ud_2                 5.966576e-02 1 1  ON 12
 ud_3                -6.152640e-03 1 1  ON 13
 ud_4                -5.998455e-02 1 1  ON 14
 ud_5                -1.008212e-01 1 1  ON 15
 ud_6                -1.287630e-01 1 1  ON 16
 ud_7                -1.460086e-01 1 1  ON 17
 ud_8                -1.484292e-01 1 1  ON 18
 ud_9                -1.376178e-01 1 1  ON 19
 eO_0                -7.366779e-01 1 1  ON 20
 eO_1                -4.256876e-01 1 1  ON 21
 eO_2                -1.767131e-02 1 1  ON 22
 eO_3                 2.919360e-01 1 1  ON 23
 eO_4                 5.058515e-01 1 1  ON 24
 eO_5                 4.622326e-01 1 1  ON 25
 eO_6                 2.362489e-01 1 1  ON 26
 eO_7                -5.458650e-02 1 1  ON 27
 eO_8                -2.019782e-01 1 1  ON 28
 eO_9                -6.199967e-02 1 1  ON 29
eH1_0                -2.332278e-01 1 1  ON 30
eH1_1                -1.321312e-01 1 1  ON 31
eH1_2                -8.991886e-02 1 1  ON 32
eH1_3                -3.929385e-02 1 1  ON 33
eH1_4                 1.478235e-02 1 1  ON 34
eH1_5                 4.883726e-02 1 1  ON 35
eH1_6                 1.009024e-01 1 1  ON 36
eH1_7                 1.442653e-01 1 1  ON 37
eH1_8                 1.527880e-01 1 1  ON 38
eH1_9                 3.780208e-02 1 1  ON 39
eH2_0                -2.318842e-01 1 1  ON 40
eH2_1                -1.303503e-01 1 1  ON 41
eH2_2                -8.802731e-02 1 1  ON 42
eH2_3                -3.738566e-02 1 1  ON 43
eH2_4                 1.702651e-02 1 1  ON 44
eH2_5                 5.205576e-02 1 1  ON 45
eH2_6                 1.044645e-01 1 1  ON 46
eH2_7                 1.511839e-01 1 1  ON 47
eH2_8                 1.606804e-01 1 1  ON 48
eH2_9                 2.042005e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.192657
====================================================
  Execution time = 2.5998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336823272258
                                         uncertainty =       0.005625234793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336823272258
                                         uncertainty =       0.005625234793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410326625
  error estimate for blocks of size 2^( 2) =       0.000422020163
  error estimate for blocks of size 2^( 3) =       0.000434069239
  error estimate for blocks of size 2^( 4) =       0.000444967426
  error estimate for blocks of size 2^( 5) =       0.000453973937
  error estimate for blocks of size 2^( 6) =       0.000461700941
  error estimate for blocks of size 2^( 7) =       0.000463218190

      target function =                  N/A
              le_mean =     -16.911081814949
             les_mean =     286.321423862109
             stat err =       0.000455965123
             autocorr =       1.234820564137
              std dev =       0.580289478269
             le_variance =       0.336735878590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691108181495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911081814949       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911085091470       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911084552710       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911084256447       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911085879759       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911086588414       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911087500069       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911087173553       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911087338108       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 8.589049e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911081814949       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911082785345       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911082538656       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911082561411       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911083078347       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911083115165       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911083353646       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911083312255       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.374838e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911081814949       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911082069290       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911081999462       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911082019078       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911082150503       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911082144772       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911082203926       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911082197202       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.162352e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2651e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.061603e-01 1 1  ON 0
 uu_1                 1.415559e-01 1 1  ON 1
 uu_2                 4.373208e-02 1 1  ON 2
 uu_3                -1.774495e-02 1 1  ON 3
 uu_4                -6.425239e-02 1 1  ON 4
 uu_5                -9.805336e-02 1 1  ON 5
 uu_6                -1.233316e-01 1 1  ON 6
 uu_7                -1.344193e-01 1 1  ON 7
 uu_8                -1.249580e-01 1 1  ON 8
 uu_9                -9.586682e-02 1 1  ON 9
 ud_0                 4.250376e-01 1 1  ON 10
 ud_1                 1.698917e-01 1 1  ON 11
 ud_2                 5.971103e-02 1 1  ON 12
 ud_3                -6.116080e-03 1 1  ON 13
 ud_4                -6.004104e-02 1 1  ON 14
 ud_5                -1.008438e-01 1 1  ON 15
 ud_6                -1.287433e-01 1 1  ON 16
 ud_7                -1.460603e-01 1 1  ON 17
 ud_8                -1.484796e-01 1 1  ON 18
 ud_9                -1.377054e-01 1 1  ON 19
 eO_0                -7.369154e-01 1 1  ON 20
 eO_1                -4.258057e-01 1 1  ON 21
 eO_2                -1.768522e-02 1 1  ON 22
 eO_3                 2.921304e-01 1 1  ON 23
 eO_4                 5.060509e-01 1 1  ON 24
 eO_5                 4.623861e-01 1 1  ON 25
 eO_6                 2.362636e-01 1 1  ON 26
 eO_7                -5.454286e-02 1 1  ON 27
 eO_8                -2.021108e-01 1 1  ON 28
 eO_9                -6.209338e-02 1 1  ON 29
eH1_0                -2.334440e-01 1 1  ON 30
eH1_1                -1.322071e-01 1 1  ON 31
eH1_2                -8.995364e-02 1 1  ON 32
eH1_3                -3.933750e-02 1 1  ON 33
eH1_4                 1.473287e-02 1 1  ON 34
eH1_5                 4.890132e-02 1 1  ON 35
eH1_6                 1.009404e-01 1 1  ON 36
eH1_7                 1.443333e-01 1 1  ON 37
eH1_8                 1.529028e-01 1 1  ON 38
eH1_9                 3.792014e-02 1 1  ON 39
eH2_0                -2.320878e-01 1 1  ON 40
eH2_1                -1.304282e-01 1 1  ON 41
eH2_2                -8.816908e-02 1 1  ON 42
eH2_3                -3.739124e-02 1 1  ON 43
eH2_4                 1.703665e-02 1 1  ON 44
eH2_5                 5.204565e-02 1 1  ON 45
eH2_6                 1.045537e-01 1 1  ON 46
eH2_7                 1.512400e-01 1 1  ON 47
eH2_8                 1.608180e-01 1 1  ON 48
eH2_9                 2.056650e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9932
    reference variance = 0.314498
====================================================
  Execution time = 2.5303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3036e-01
  Total weights = 2.0000e+06
  Execution time = 2.9661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330229323865
                                         uncertainty =       0.009722709582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330229323865
                                         uncertainty =       0.009722709582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406399021
  error estimate for blocks of size 2^( 2) =       0.000417923993
  error estimate for blocks of size 2^( 3) =       0.000430461444
  error estimate for blocks of size 2^( 4) =       0.000441905521
  error estimate for blocks of size 2^( 5) =       0.000451629771
  error estimate for blocks of size 2^( 6) =       0.000459820624
  error estimate for blocks of size 2^( 7) =       0.000464888604

      target function =                  N/A
              le_mean =     -16.910419518553
             les_mean =     286.292608457400
             stat err =       0.000454561130
             autocorr =       1.251063302622
              std dev =       0.574735007718
             le_variance =       0.330320329097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330401871666
                                         uncertainty =       0.009713925350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330401871666
                                         uncertainty =       0.009713925350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406505149
  error estimate for blocks of size 2^( 2) =       0.000418024826
  error estimate for blocks of size 2^( 3) =       0.000430552505
  error estimate for blocks of size 2^( 4) =       0.000441983964
  error estimate for blocks of size 2^( 5) =       0.000451702261
  error estimate for blocks of size 2^( 6) =       0.000459893889
  error estimate for blocks of size 2^( 7) =       0.000464955049

      target function =                  N/A
              le_mean =     -16.910419568479
             les_mean =     286.292782688704
             stat err =       0.000454633791
             autocorr =       1.250809934434
              std dev =       0.574885094571
             le_variance =       0.330492871960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330303252870
                                         uncertainty =       0.009717470978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330303252870
                                         uncertainty =       0.009717470978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406444480
  error estimate for blocks of size 2^( 2) =       0.000417967062
  error estimate for blocks of size 2^( 3) =       0.000430499659
  error estimate for blocks of size 2^( 4) =       0.000441937206
  error estimate for blocks of size 2^( 5) =       0.000451659014
  error estimate for blocks of size 2^( 6) =       0.000459850584
  error estimate for blocks of size 2^( 7) =       0.000464913663

      target function =                  N/A
              le_mean =     -16.910419572909
             les_mean =     286.292684197536
             stat err =       0.000454590117
             autocorr =       1.250942995382
              std dev =       0.574799296184
             le_variance =       0.330394230894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330237415834
                                         uncertainty =       0.009722033147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330237415834
                                         uncertainty =       0.009722033147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406403996
  error estimate for blocks of size 2^( 2) =       0.000417928678
  error estimate for blocks of size 2^( 3) =       0.000430465529
  error estimate for blocks of size 2^( 4) =       0.000441908779
  error estimate for blocks of size 2^( 5) =       0.000451632758
  error estimate for blocks of size 2^( 6) =       0.000459823712
  error estimate for blocks of size 2^( 7) =       0.000464890929

      target function =                  N/A
              le_mean =     -16.910419515846
             les_mean =     286.292616452125
             stat err =       0.000454564044
             autocorr =       1.251048719215
              std dev =       0.574742042467
             le_variance =       0.330328415380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910419518553        initial
     3.8147e-01     3.8147e+00             8.5890e-04       -16.910419568479
     1.5259e+00     1.5259e+01             2.3748e-04       -16.910419572909  <--
     6.1035e+00     6.1035e+01             6.1624e-05       -16.910419515846

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.0389e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.061603e-01 1 1  ON 0
 uu_1                 1.415559e-01 1 1  ON 1
 uu_2                 4.373208e-02 1 1  ON 2
 uu_3                -1.774495e-02 1 1  ON 3
 uu_4                -6.425239e-02 1 1  ON 4
 uu_5                -9.805336e-02 1 1  ON 5
 uu_6                -1.233316e-01 1 1  ON 6
 uu_7                -1.344193e-01 1 1  ON 7
 uu_8                -1.249580e-01 1 1  ON 8
 uu_9                -9.586682e-02 1 1  ON 9
 ud_0                 4.250376e-01 1 1  ON 10
 ud_1                 1.698917e-01 1 1  ON 11
 ud_2                 5.971103e-02 1 1  ON 12
 ud_3                -6.116080e-03 1 1  ON 13
 ud_4                -6.004104e-02 1 1  ON 14
 ud_5                -1.008438e-01 1 1  ON 15
 ud_6                -1.287433e-01 1 1  ON 16
 ud_7                -1.460603e-01 1 1  ON 17
 ud_8                -1.484796e-01 1 1  ON 18
 ud_9                -1.377054e-01 1 1  ON 19
 eO_0                -7.369154e-01 1 1  ON 20
 eO_1                -4.258057e-01 1 1  ON 21
 eO_2                -1.768522e-02 1 1  ON 22
 eO_3                 2.921304e-01 1 1  ON 23
 eO_4                 5.060509e-01 1 1  ON 24
 eO_5                 4.623861e-01 1 1  ON 25
 eO_6                 2.362636e-01 1 1  ON 26
 eO_7                -5.454286e-02 1 1  ON 27
 eO_8                -2.021108e-01 1 1  ON 28
 eO_9                -6.209338e-02 1 1  ON 29
eH1_0                -2.334440e-01 1 1  ON 30
eH1_1                -1.322071e-01 1 1  ON 31
eH1_2                -8.995364e-02 1 1  ON 32
eH1_3                -3.933750e-02 1 1  ON 33
eH1_4                 1.473287e-02 1 1  ON 34
eH1_5                 4.890132e-02 1 1  ON 35
eH1_6                 1.009404e-01 1 1  ON 36
eH1_7                 1.443333e-01 1 1  ON 37
eH1_8                 1.529028e-01 1 1  ON 38
eH1_9                 3.792014e-02 1 1  ON 39
eH2_0                -2.320878e-01 1 1  ON 40
eH2_1                -1.304282e-01 1 1  ON 41
eH2_2                -8.816908e-02 1 1  ON 42
eH2_3                -3.739124e-02 1 1  ON 43
eH2_4                 1.703665e-02 1 1  ON 44
eH2_5                 5.204565e-02 1 1  ON 45
eH2_6                 1.045537e-01 1 1  ON 46
eH2_7                 1.512400e-01 1 1  ON 47
eH2_8                 1.608180e-01 1 1  ON 48
eH2_9                 2.056650e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3047e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8752
    reference variance = 0.247991
====================================================
  Execution time = 2.6518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913928026
                                         uncertainty =       0.005859829242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913928026
                                         uncertainty =       0.005859829242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412898429
  error estimate for blocks of size 2^( 2) =       0.000424716518
  error estimate for blocks of size 2^( 3) =       0.000436763098
  error estimate for blocks of size 2^( 4) =       0.000448512157
  error estimate for blocks of size 2^( 5) =       0.000458358559
  error estimate for blocks of size 2^( 6) =       0.000463967123
  error estimate for blocks of size 2^( 7) =       0.000467577655

      target function =                  N/A
              le_mean =     -16.910778863539
             les_mean =     286.315411825927
             stat err =       0.000459603873
             autocorr =       1.239027370043
              std dev =       0.583926557800
             le_variance =       0.340970224904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691077886354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910778863539       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910778437482       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910777639845       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910778647416       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910780693624       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910780794255       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910780672782       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910780783102       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910781088588       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910781014511       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 8.979596e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910778863539       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910778728362       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910778485032       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910778566196       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910779149551       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910779280861       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910779278991       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910779295080       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.435025e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910778863539       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910778827307       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910778763277       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910778776110       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910778907221       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910778946870       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910778959281       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910778963615       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.201107e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3100e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.062727e-01 1 1  ON 0
 uu_1                 1.415976e-01 1 1  ON 1
 uu_2                 4.376748e-02 1 1  ON 2
 uu_3                -1.771375e-02 1 1  ON 3
 uu_4                -6.427744e-02 1 1  ON 4
 uu_5                -9.811336e-02 1 1  ON 5
 uu_6                -1.233618e-01 1 1  ON 6
 uu_7                -1.344575e-01 1 1  ON 7
 uu_8                -1.250403e-01 1 1  ON 8
 uu_9                -9.593046e-02 1 1  ON 9
 ud_0                 4.251200e-01 1 1  ON 10
 ud_1                 1.699955e-01 1 1  ON 11
 ud_2                 5.976419e-02 1 1  ON 12
 ud_3                -6.109609e-03 1 1  ON 13
 ud_4                -6.004843e-02 1 1  ON 14
 ud_5                -1.008686e-01 1 1  ON 15
 ud_6                -1.287406e-01 1 1  ON 16
 ud_7                -1.460233e-01 1 1  ON 17
 ud_8                -1.485939e-01 1 1  ON 18
 ud_9                -1.378189e-01 1 1  ON 19
 eO_0                -7.371157e-01 1 1  ON 20
 eO_1                -4.259361e-01 1 1  ON 21
 eO_2                -1.765170e-02 1 1  ON 22
 eO_3                 2.922412e-01 1 1  ON 23
 eO_4                 5.062385e-01 1 1  ON 24
 eO_5                 4.625076e-01 1 1  ON 25
 eO_6                 2.363274e-01 1 1  ON 26
 eO_7                -5.447381e-02 1 1  ON 27
 eO_8                -2.022519e-01 1 1  ON 28
 eO_9                -6.219294e-02 1 1  ON 29
eH1_0                -2.336875e-01 1 1  ON 30
eH1_1                -1.323094e-01 1 1  ON 31
eH1_2                -9.004118e-02 1 1  ON 32
eH1_3                -3.937406e-02 1 1  ON 33
eH1_4                 1.464400e-02 1 1  ON 34
eH1_5                 4.896361e-02 1 1  ON 35
eH1_6                 1.011458e-01 1 1  ON 36
eH1_7                 1.444403e-01 1 1  ON 37
eH1_8                 1.530094e-01 1 1  ON 38
eH1_9                 3.800094e-02 1 1  ON 39
eH2_0                -2.322382e-01 1 1  ON 40
eH2_1                -1.304562e-01 1 1  ON 41
eH2_2                -8.825490e-02 1 1  ON 42
eH2_3                -3.747419e-02 1 1  ON 43
eH2_4                 1.701094e-02 1 1  ON 44
eH2_5                 5.198087e-02 1 1  ON 45
eH2_6                 1.046297e-01 1 1  ON 46
eH2_7                 1.512677e-01 1 1  ON 47
eH2_8                 1.609500e-01 1 1  ON 48
eH2_9                 2.073734e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.0026
    reference variance = 0.350118
====================================================
  Execution time = 2.5548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3299e-01
  Total weights = 2.0000e+06
  Execution time = 2.9533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333055559866
                                         uncertainty =       0.003895801331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333055559866
                                         uncertainty =       0.003895801331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408017741
  error estimate for blocks of size 2^( 2) =       0.000419609460
  error estimate for blocks of size 2^( 3) =       0.000431813320
  error estimate for blocks of size 2^( 4) =       0.000443801359
  error estimate for blocks of size 2^( 5) =       0.000453115307
  error estimate for blocks of size 2^( 6) =       0.000459194954
  error estimate for blocks of size 2^( 7) =       0.000461456383

      target function =                  N/A
              le_mean =     -16.911462302240
             les_mean =     286.330513986991
             stat err =       0.000454392001
             autocorr =       1.240232938555
              std dev =       0.577024222533
             le_variance =       0.332956953390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333197971990
                                         uncertainty =       0.003898896208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333197971990
                                         uncertainty =       0.003898896208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408104942
  error estimate for blocks of size 2^( 2) =       0.000419691744
  error estimate for blocks of size 2^( 3) =       0.000431888722
  error estimate for blocks of size 2^( 4) =       0.000443866903
  error estimate for blocks of size 2^( 5) =       0.000453173097
  error estimate for blocks of size 2^( 6) =       0.000459249752
  error estimate for blocks of size 2^( 7) =       0.000461509513

      target function =                  N/A
              le_mean =     -16.911459284125
             les_mean =     286.330554240181
             stat err =       0.000454449816
             autocorr =       1.240018473848
              std dev =       0.577147544499
             le_variance =       0.333099288121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333121665640
                                         uncertainty =       0.003897570793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333121665640
                                         uncertainty =       0.003897570793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408058222
  error estimate for blocks of size 2^( 2) =       0.000419647362
  error estimate for blocks of size 2^( 3) =       0.000431847740
  error estimate for blocks of size 2^( 4) =       0.000443830640
  error estimate for blocks of size 2^( 5) =       0.000453141100
  error estimate for blocks of size 2^( 6) =       0.000459219880
  error estimate for blocks of size 2^( 7) =       0.000461481130

      target function =                  N/A
              le_mean =     -16.911460211818
             les_mean =     286.330509354569
             stat err =       0.000454418187
             autocorr =       1.240129801116
              std dev =       0.577081471865
             le_variance =       0.333023025170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333062277358
                                         uncertainty =       0.003896025779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333062277358
                                         uncertainty =       0.003896025779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408021854
  error estimate for blocks of size 2^( 2) =       0.000419613270
  error estimate for blocks of size 2^( 3) =       0.000431816710
  error estimate for blocks of size 2^( 4) =       0.000443804100
  error estimate for blocks of size 2^( 5) =       0.000453117663
  error estimate for blocks of size 2^( 6) =       0.000459197239
  error estimate for blocks of size 2^( 7) =       0.000461458704

      target function =                  N/A
              le_mean =     -16.911461999438
             les_mean =     286.330510458749
             stat err =       0.000454394426
             autocorr =       1.240221172422
              std dev =       0.577030039762
             le_variance =       0.332963666788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911462302240        initial  <--
     3.8147e-01     3.8147e+00             8.9796e-04       -16.911459284125
     1.5259e+00     1.5259e+01             2.4350e-04       -16.911460211818
     6.1035e+00     6.1035e+01             6.2011e-05       -16.911461999438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.4479
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.061603e-01 1 1  ON 0
 uu_1                 1.415559e-01 1 1  ON 1
 uu_2                 4.373208e-02 1 1  ON 2
 uu_3                -1.774495e-02 1 1  ON 3
 uu_4                -6.425239e-02 1 1  ON 4
 uu_5                -9.805336e-02 1 1  ON 5
 uu_6                -1.233316e-01 1 1  ON 6
 uu_7                -1.344193e-01 1 1  ON 7
 uu_8                -1.249580e-01 1 1  ON 8
 uu_9                -9.586682e-02 1 1  ON 9
 ud_0                 4.250376e-01 1 1  ON 10
 ud_1                 1.698917e-01 1 1  ON 11
 ud_2                 5.971103e-02 1 1  ON 12
 ud_3                -6.116080e-03 1 1  ON 13
 ud_4                -6.004104e-02 1 1  ON 14
 ud_5                -1.008438e-01 1 1  ON 15
 ud_6                -1.287433e-01 1 1  ON 16
 ud_7                -1.460603e-01 1 1  ON 17
 ud_8                -1.484796e-01 1 1  ON 18
 ud_9                -1.377054e-01 1 1  ON 19
 eO_0                -7.369154e-01 1 1  ON 20
 eO_1                -4.258057e-01 1 1  ON 21
 eO_2                -1.768522e-02 1 1  ON 22
 eO_3                 2.921304e-01 1 1  ON 23
 eO_4                 5.060509e-01 1 1  ON 24
 eO_5                 4.623861e-01 1 1  ON 25
 eO_6                 2.362636e-01 1 1  ON 26
 eO_7                -5.454286e-02 1 1  ON 27
 eO_8                -2.021108e-01 1 1  ON 28
 eO_9                -6.209338e-02 1 1  ON 29
eH1_0                -2.334440e-01 1 1  ON 30
eH1_1                -1.322071e-01 1 1  ON 31
eH1_2                -8.995364e-02 1 1  ON 32
eH1_3                -3.933750e-02 1 1  ON 33
eH1_4                 1.473287e-02 1 1  ON 34
eH1_5                 4.890132e-02 1 1  ON 35
eH1_6                 1.009404e-01 1 1  ON 36
eH1_7                 1.443333e-01 1 1  ON 37
eH1_8                 1.529028e-01 1 1  ON 38
eH1_9                 3.792014e-02 1 1  ON 39
eH2_0                -2.320878e-01 1 1  ON 40
eH2_1                -1.304282e-01 1 1  ON 41
eH2_2                -8.816908e-02 1 1  ON 42
eH2_3                -3.739124e-02 1 1  ON 43
eH2_4                 1.703665e-02 1 1  ON 44
eH2_5                 5.204565e-02 1 1  ON 45
eH2_6                 1.045537e-01 1 1  ON 46
eH2_7                 1.512400e-01 1 1  ON 47
eH2_8                 1.608180e-01 1 1  ON 48
eH2_9                 2.056650e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.157228
====================================================
  Execution time = 2.8502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353521596854
                                         uncertainty =       0.015583630447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353521596854
                                         uncertainty =       0.015583630447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420381241
  error estimate for blocks of size 2^( 2) =       0.000431873302
  error estimate for blocks of size 2^( 3) =       0.000443917988
  error estimate for blocks of size 2^( 4) =       0.000454909062
  error estimate for blocks of size 2^( 5) =       0.000464501172
  error estimate for blocks of size 2^( 6) =       0.000471442145
  error estimate for blocks of size 2^( 7) =       0.000475595819

      target function =                  N/A
              le_mean =     -16.910646052495
             les_mean =     286.323390511072
             stat err =       0.000466612049
             autocorr =       1.232041236255
              std dev =       0.594508851921
             le_variance =       0.353440775012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691064605250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646052495       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646186804       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646136240       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910646211205       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910646278589       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910646407122       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910646380158       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.032762e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646052495       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646086538       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646073373       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910646093277       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910646104578       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910646142142       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910646134842       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.592830e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646052495       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646061036       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646057711       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910646062741       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910646065526       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910646074970       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910646073114       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 6.488320e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5172e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.061751e-01 1 1  ON 0
 uu_1                 1.415617e-01 1 1  ON 1
 uu_2                 4.373729e-02 1 1  ON 2
 uu_3                -1.774764e-02 1 1  ON 3
 uu_4                -6.425803e-02 1 1  ON 4
 uu_5                -9.805304e-02 1 1  ON 5
 uu_6                -1.233351e-01 1 1  ON 6
 uu_7                -1.344276e-01 1 1  ON 7
 uu_8                -1.249678e-01 1 1  ON 8
 uu_9                -9.587206e-02 1 1  ON 9
 ud_0                 4.250370e-01 1 1  ON 10
 ud_1                 1.699048e-01 1 1  ON 11
 ud_2                 5.971665e-02 1 1  ON 12
 ud_3                -6.114184e-03 1 1  ON 13
 ud_4                -6.003870e-02 1 1  ON 14
 ud_5                -1.008525e-01 1 1  ON 15
 ud_6                -1.287439e-01 1 1  ON 16
 ud_7                -1.460643e-01 1 1  ON 17
 ud_8                -1.484900e-01 1 1  ON 18
 ud_9                -1.377076e-01 1 1  ON 19
 eO_0                -7.369319e-01 1 1  ON 20
 eO_1                -4.258243e-01 1 1  ON 21
 eO_2                -1.768262e-02 1 1  ON 22
 eO_3                 2.921454e-01 1 1  ON 23
 eO_4                 5.060769e-01 1 1  ON 24
 eO_5                 4.623939e-01 1 1  ON 25
 eO_6                 2.362643e-01 1 1  ON 26
 eO_7                -5.453799e-02 1 1  ON 27
 eO_8                -2.021223e-01 1 1  ON 28
 eO_9                -6.210234e-02 1 1  ON 29
eH1_0                -2.334670e-01 1 1  ON 30
eH1_1                -1.322165e-01 1 1  ON 31
eH1_2                -8.996365e-02 1 1  ON 32
eH1_3                -3.933798e-02 1 1  ON 33
eH1_4                 1.472903e-02 1 1  ON 34
eH1_5                 4.890495e-02 1 1  ON 35
eH1_6                 1.009547e-01 1 1  ON 36
eH1_7                 1.443403e-01 1 1  ON 37
eH1_8                 1.529125e-01 1 1  ON 38
eH1_9                 3.793090e-02 1 1  ON 39
eH2_0                -2.321111e-01 1 1  ON 40
eH2_1                -1.304375e-01 1 1  ON 41
eH2_2                -8.817499e-02 1 1  ON 42
eH2_3                -3.739709e-02 1 1  ON 43
eH2_4                 1.703571e-02 1 1  ON 44
eH2_5                 5.204536e-02 1 1  ON 45
eH2_6                 1.045649e-01 1 1  ON 46
eH2_7                 1.512482e-01 1 1  ON 47
eH2_8                 1.608289e-01 1 1  ON 48
eH2_9                 2.058188e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.272157
====================================================
  Execution time = 2.5632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3060e-01
  Total weights = 2.0000e+06
  Execution time = 2.9526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330649040769
                                         uncertainty =       0.004957355623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330649040769
                                         uncertainty =       0.004957355623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406571232
  error estimate for blocks of size 2^( 2) =       0.000418344292
  error estimate for blocks of size 2^( 3) =       0.000430378678
  error estimate for blocks of size 2^( 4) =       0.000442219321
  error estimate for blocks of size 2^( 5) =       0.000453396772
  error estimate for blocks of size 2^( 6) =       0.000461796858
  error estimate for blocks of size 2^( 7) =       0.000467463502

      target function =                  N/A
              le_mean =     -16.909787412124
             les_mean =     286.271510490638
             stat err =       0.000456219113
             autocorr =       1.259138958655
              std dev =       0.574978549798
             le_variance =       0.330600332727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330636471406
                                         uncertainty =       0.004957095350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330636471406
                                         uncertainty =       0.004957095350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406563510
  error estimate for blocks of size 2^( 2) =       0.000418336830
  error estimate for blocks of size 2^( 3) =       0.000430370970
  error estimate for blocks of size 2^( 4) =       0.000442211420
  error estimate for blocks of size 2^( 5) =       0.000453388319
  error estimate for blocks of size 2^( 6) =       0.000461788169
  error estimate for blocks of size 2^( 7) =       0.000467455931

      target function =                  N/A
              le_mean =     -16.909787477717
             les_mean =     286.271500152090
             stat err =       0.000456210960
             autocorr =       1.259141778173
              std dev =       0.574967630232
             le_variance =       0.330587775814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330641145073
                                         uncertainty =       0.004957194931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330641145073
                                         uncertainty =       0.004957194931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406566381
  error estimate for blocks of size 2^( 2) =       0.000418339605
  error estimate for blocks of size 2^( 3) =       0.000430373905
  error estimate for blocks of size 2^( 4) =       0.000442214482
  error estimate for blocks of size 2^( 5) =       0.000453391669
  error estimate for blocks of size 2^( 6) =       0.000461791670
  error estimate for blocks of size 2^( 7) =       0.000467458914

      target function =                  N/A
              le_mean =     -16.909787448628
             les_mean =     286.271503836382
             stat err =       0.000456214184
             autocorr =       1.259141793454
              std dev =       0.574971689664
             le_variance =       0.330592443915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330647995303
                                         uncertainty =       0.004957334446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330647995303
                                         uncertainty =       0.004957334446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406570589
  error estimate for blocks of size 2^( 2) =       0.000418343671
  error estimate for blocks of size 2^( 3) =       0.000430378048
  error estimate for blocks of size 2^( 4) =       0.000442218683
  error estimate for blocks of size 2^( 5) =       0.000453396103
  error estimate for blocks of size 2^( 6) =       0.000461796179
  error estimate for blocks of size 2^( 7) =       0.000467462899

      target function =                  N/A
              le_mean =     -16.909787416650
             les_mean =     286.271509599135
             stat err =       0.000456218466
             autocorr =       1.259139363936
              std dev =       0.574977641431
             le_variance =       0.330599288145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909787412124        initial
     3.8147e+00     3.8147e+01             1.0328e-04       -16.909787477717  <--
     1.5259e+01     1.5259e+02             2.5928e-05       -16.909787448628
     6.1035e+01     6.1035e+02             6.4883e-06       -16.909787416650

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.0524e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.062183e-01 1 1  ON 0
 uu_1                 1.415794e-01 1 1  ON 1
 uu_2                 4.375281e-02 1 1  ON 2
 uu_3                -1.775473e-02 1 1  ON 3
 uu_4                -6.427405e-02 1 1  ON 4
 uu_5                -9.805305e-02 1 1  ON 5
 uu_6                -1.233452e-01 1 1  ON 6
 uu_7                -1.344520e-01 1 1  ON 7
 uu_8                -1.249973e-01 1 1  ON 8
 uu_9                -9.588777e-02 1 1  ON 9
 ud_0                 4.250386e-01 1 1  ON 10
 ud_1                 1.699420e-01 1 1  ON 11
 ud_2                 5.973345e-02 1 1  ON 12
 ud_3                -6.108658e-03 1 1  ON 13
 ud_4                -6.003325e-02 1 1  ON 14
 ud_5                -1.008768e-01 1 1  ON 15
 ud_6                -1.287468e-01 1 1  ON 16
 ud_7                -1.460764e-01 1 1  ON 17
 ud_8                -1.485210e-01 1 1  ON 18
 ud_9                -1.377140e-01 1 1  ON 19
 eO_0                -7.369816e-01 1 1  ON 20
 eO_1                -4.258780e-01 1 1  ON 21
 eO_2                -1.767563e-02 1 1  ON 22
 eO_3                 2.921900e-01 1 1  ON 23
 eO_4                 5.061542e-01 1 1  ON 24
 eO_5                 4.624170e-01 1 1  ON 25
 eO_6                 2.362660e-01 1 1  ON 26
 eO_7                -5.452357e-02 1 1  ON 27
 eO_8                -2.021565e-01 1 1  ON 28
 eO_9                -6.212905e-02 1 1  ON 29
eH1_0                -2.335352e-01 1 1  ON 30
eH1_1                -1.322446e-01 1 1  ON 31
eH1_2                -8.999316e-02 1 1  ON 32
eH1_3                -3.934020e-02 1 1  ON 33
eH1_4                 1.471752e-02 1 1  ON 34
eH1_5                 4.891606e-02 1 1  ON 35
eH1_6                 1.009976e-01 1 1  ON 36
eH1_7                 1.443612e-01 1 1  ON 37
eH1_8                 1.529414e-01 1 1  ON 38
eH1_9                 3.796290e-02 1 1  ON 39
eH2_0                -2.321801e-01 1 1  ON 40
eH2_1                -1.304654e-01 1 1  ON 41
eH2_2                -8.819344e-02 1 1  ON 42
eH2_3                -3.741382e-02 1 1  ON 43
eH2_4                 1.703270e-02 1 1  ON 44
eH2_5                 5.204476e-02 1 1  ON 45
eH2_6                 1.045984e-01 1 1  ON 46
eH2_7                 1.512729e-01 1 1  ON 47
eH2_8                 1.608615e-01 1 1  ON 48
eH2_9                 2.062765e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.94
    reference variance = 0.168855
====================================================
  Execution time = 2.6050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2757e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327633509465
                                         uncertainty =       0.002938596880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327633509465
                                         uncertainty =       0.002938596880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404706685
  error estimate for blocks of size 2^( 2) =       0.000416593528
  error estimate for blocks of size 2^( 3) =       0.000429016844
  error estimate for blocks of size 2^( 4) =       0.000441190624
  error estimate for blocks of size 2^( 5) =       0.000452837866
  error estimate for blocks of size 2^( 6) =       0.000459657067
  error estimate for blocks of size 2^( 7) =       0.000465877377

      target function =                  N/A
              le_mean =     -16.910780590285
             les_mean =     286.302075011254
             stat err =       0.000454890733
             autocorr =       1.263378328189
              std dev =       0.572341683169
             le_variance =       0.327575002293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078059028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910780590285       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910780780712       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910780874471       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910781194550       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910780863205       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910781943802       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910781846163       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910781837529       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910781973930       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 4.487514e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910780590285       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910780642332       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910780669132       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910780715317       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910780548591       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910780803302       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910780845419       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910780849677       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.156519e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910780590285       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910780603607       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910780610584       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910780619461       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910780570853       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910780631357       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910780647485       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910780648890       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.905967e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2739e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.062525e-01 1 1  ON 0
 uu_1                 1.416305e-01 1 1  ON 1
 uu_2                 4.378507e-02 1 1  ON 2
 uu_3                -1.777291e-02 1 1  ON 3
 uu_4                -6.429452e-02 1 1  ON 4
 uu_5                -9.804915e-02 1 1  ON 5
 uu_6                -1.233806e-01 1 1  ON 6
 uu_7                -1.344573e-01 1 1  ON 7
 uu_8                -1.250587e-01 1 1  ON 8
 uu_9                -9.591347e-02 1 1  ON 9
 ud_0                 4.250653e-01 1 1  ON 10
 ud_1                 1.699796e-01 1 1  ON 11
 ud_2                 5.977034e-02 1 1  ON 12
 ud_3                -6.103312e-03 1 1  ON 13
 ud_4                -6.001164e-02 1 1  ON 14
 ud_5                -1.008783e-01 1 1  ON 15
 ud_6                -1.287442e-01 1 1  ON 16
 ud_7                -1.461091e-01 1 1  ON 17
 ud_8                -1.485608e-01 1 1  ON 18
 ud_9                -1.377486e-01 1 1  ON 19
 eO_0                -7.370687e-01 1 1  ON 20
 eO_1                -4.259365e-01 1 1  ON 21
 eO_2                -1.766910e-02 1 1  ON 22
 eO_3                 2.922497e-01 1 1  ON 23
 eO_4                 5.062699e-01 1 1  ON 24
 eO_5                 4.624610e-01 1 1  ON 25
 eO_6                 2.362681e-01 1 1  ON 26
 eO_7                -5.451922e-02 1 1  ON 27
 eO_8                -2.022035e-01 1 1  ON 28
 eO_9                -6.216529e-02 1 1  ON 29
eH1_0                -2.336303e-01 1 1  ON 30
eH1_1                -1.322483e-01 1 1  ON 31
eH1_2                -9.002033e-02 1 1  ON 32
eH1_3                -3.936530e-02 1 1  ON 33
eH1_4                 1.472086e-02 1 1  ON 34
eH1_5                 4.892311e-02 1 1  ON 35
eH1_6                 1.010302e-01 1 1  ON 36
eH1_7                 1.443878e-01 1 1  ON 37
eH1_8                 1.529885e-01 1 1  ON 38
eH1_9                 3.800081e-02 1 1  ON 39
eH2_0                -2.322685e-01 1 1  ON 40
eH2_1                -1.305155e-01 1 1  ON 41
eH2_2                -8.823014e-02 1 1  ON 42
eH2_3                -3.740597e-02 1 1  ON 43
eH2_4                 1.700445e-02 1 1  ON 44
eH2_5                 5.209266e-02 1 1  ON 45
eH2_6                 1.046240e-01 1 1  ON 46
eH2_7                 1.512863e-01 1 1  ON 47
eH2_8                 1.609167e-01 1 1  ON 48
eH2_9                 2.068275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8767
    reference variance = 0.210581
====================================================
  Execution time = 2.5599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6085e-01
  Total weights = 2.0000e+06
  Execution time = 2.9533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360811654345
                                         uncertainty =       0.023897931591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360811654345
                                         uncertainty =       0.023897931591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424765248
  error estimate for blocks of size 2^( 2) =       0.000436357150
  error estimate for blocks of size 2^( 3) =       0.000448036119
  error estimate for blocks of size 2^( 4) =       0.000459221262
  error estimate for blocks of size 2^( 5) =       0.000468587529
  error estimate for blocks of size 2^( 6) =       0.000476021620
  error estimate for blocks of size 2^( 7) =       0.000480340032

      target function =                  N/A
              le_mean =     -16.910185004442
             les_mean =     286.315207736217
             stat err =       0.000471042611
             autocorr =       1.229765865607
              std dev =       0.600708774846
             le_variance =       0.360851032177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360847405645
                                         uncertainty =       0.023894541621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360847405645
                                         uncertainty =       0.023894541621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424786307
  error estimate for blocks of size 2^( 2) =       0.000436376663
  error estimate for blocks of size 2^( 3) =       0.000448052046
  error estimate for blocks of size 2^( 4) =       0.000459233454
  error estimate for blocks of size 2^( 5) =       0.000468598150
  error estimate for blocks of size 2^( 6) =       0.000476027491
  error estimate for blocks of size 2^( 7) =       0.000480347020

      target function =                  N/A
              le_mean =     -16.910185233512
             les_mean =     286.315251264987
             stat err =       0.000471051529
             autocorr =       1.229690496120
              std dev =       0.600738556908
             le_variance =       0.360886813756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360817207835
                                         uncertainty =       0.023895028274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360817207835
                                         uncertainty =       0.023895028274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424768534
  error estimate for blocks of size 2^( 2) =       0.000436359867
  error estimate for blocks of size 2^( 3) =       0.000448037154
  error estimate for blocks of size 2^( 4) =       0.000459220506
  error estimate for blocks of size 2^( 5) =       0.000468586069
  error estimate for blocks of size 2^( 6) =       0.000476017353
  error estimate for blocks of size 2^( 7) =       0.000480336003

      target function =                  N/A
              le_mean =     -16.910185013550
             les_mean =     286.315213627100
             stat err =       0.000471039983
             autocorr =       1.229733119163
              std dev =       0.600713421728
             le_variance =       0.360856615044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360811838734
                                         uncertainty =       0.023897528561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360811838734
                                         uncertainty =       0.023897528561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424765359
  error estimate for blocks of size 2^( 2) =       0.000436357198
  error estimate for blocks of size 2^( 3) =       0.000448035962
  error estimate for blocks of size 2^( 4) =       0.000459220883
  error estimate for blocks of size 2^( 5) =       0.000468587064
  error estimate for blocks of size 2^( 6) =       0.000476020788
  error estimate for blocks of size 2^( 7) =       0.000480339218

      target function =                  N/A
              le_mean =     -16.910184997054
             les_mean =     286.315207674892
             stat err =       0.000471041988
             autocorr =       1.229761973101
              std dev =       0.600708931800
             le_variance =       0.360851220744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910185004442        initial
     9.5367e-01     9.5367e+00             4.4875e-04       -16.910185233512  <--
     3.8147e+00     3.8147e+01             1.1565e-04       -16.910185013550
     1.5259e+01     1.5259e+02             2.9060e-05       -16.910184997054

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.0431e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.063684e-01 1 1  ON 0
 uu_1                 1.417710e-01 1 1  ON 1
 uu_2                 4.386651e-02 1 1  ON 2
 uu_3                -1.780955e-02 1 1  ON 3
 uu_4                -6.435856e-02 1 1  ON 4
 uu_5                -9.805164e-02 1 1  ON 5
 uu_6                -1.234722e-01 1 1  ON 6
 uu_7                -1.344780e-01 1 1  ON 7
 uu_8                -1.252397e-01 1 1  ON 8
 uu_9                -9.599050e-02 1 1  ON 9
 ud_0                 4.251611e-01 1 1  ON 10
 ud_1                 1.700850e-01 1 1  ON 11
 ud_2                 5.986881e-02 1 1  ON 12
 ud_3                -6.068060e-03 1 1  ON 13
 ud_4                -5.996688e-02 1 1  ON 14
 ud_5                -1.008770e-01 1 1  ON 15
 ud_6                -1.287440e-01 1 1  ON 16
 ud_7                -1.462007e-01 1 1  ON 17
 ud_8                -1.486778e-01 1 1  ON 18
 ud_9                -1.378532e-01 1 1  ON 19
 eO_0                -7.373134e-01 1 1  ON 20
 eO_1                -4.261040e-01 1 1  ON 21
 eO_2                -1.765469e-02 1 1  ON 22
 eO_3                 2.924114e-01 1 1  ON 23
 eO_4                 5.066030e-01 1 1  ON 24
 eO_5                 4.626030e-01 1 1  ON 25
 eO_6                 2.362786e-01 1 1  ON 26
 eO_7                -5.450696e-02 1 1  ON 27
 eO_8                -2.023451e-01 1 1  ON 28
 eO_9                -6.227485e-02 1 1  ON 29
eH1_0                -2.338962e-01 1 1  ON 30
eH1_1                -1.322731e-01 1 1  ON 31
eH1_2                -9.010294e-02 1 1  ON 32
eH1_3                -3.943824e-02 1 1  ON 33
eH1_4                 1.472050e-02 1 1  ON 34
eH1_5                 4.894499e-02 1 1  ON 35
eH1_6                 1.011274e-01 1 1  ON 36
eH1_7                 1.444691e-01 1 1  ON 37
eH1_8                 1.531305e-01 1 1  ON 38
eH1_9                 3.811568e-02 1 1  ON 39
eH2_0                -2.325266e-01 1 1  ON 40
eH2_1                -1.306532e-01 1 1  ON 41
eH2_2                -8.833415e-02 1 1  ON 42
eH2_3                -3.740308e-02 1 1  ON 43
eH2_4                 1.692912e-02 1 1  ON 44
eH2_5                 5.221771e-02 1 1  ON 45
eH2_6                 1.046994e-01 1 1  ON 46
eH2_7                 1.513296e-01 1 1  ON 47
eH2_8                 1.610834e-01 1 1  ON 48
eH2_9                 2.084927e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8837
    reference variance = 0.145858
====================================================
  Execution time = 2.6077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331047606273
                                         uncertainty =       0.005081890912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331047606273
                                         uncertainty =       0.005081890912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406916657
  error estimate for blocks of size 2^( 2) =       0.000418556695
  error estimate for blocks of size 2^( 3) =       0.000430899064
  error estimate for blocks of size 2^( 4) =       0.000442957915
  error estimate for blocks of size 2^( 5) =       0.000452090469
  error estimate for blocks of size 2^( 6) =       0.000460480093
  error estimate for blocks of size 2^( 7) =       0.000464093913

      target function =                  N/A
              le_mean =     -16.910361582901
             les_mean =     286.291491031019
             stat err =       0.000454905597
             autocorr =       1.249774400831
              std dev =       0.575467055646
             le_variance =       0.331162332133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691036158290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910361582901       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910362906580       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910363572055       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910365852846       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910365672280       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910365454302       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910367395616       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910367807945       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910367388845       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910367410156       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910367477738       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.348174e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910361582901       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910362052270       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910362204046       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910362575597       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910362736337       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910362878345       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910363209128       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910363214796       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910363147578       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.637834e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910361582901       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910361713950       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910361752008       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910361802335       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910361852663       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910361924989       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910362010641       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910362002317       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.206988e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2708e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.065293e-01 1 1  ON 0
 uu_1                 1.418496e-01 1 1  ON 1
 uu_2                 4.386411e-02 1 1  ON 2
 uu_3                -1.775947e-02 1 1  ON 3
 uu_4                -6.446055e-02 1 1  ON 4
 uu_5                -9.805041e-02 1 1  ON 5
 uu_6                -1.235437e-01 1 1  ON 6
 uu_7                -1.344953e-01 1 1  ON 7
 uu_8                -1.253243e-01 1 1  ON 8
 uu_9                -9.613174e-02 1 1  ON 9
 ud_0                 4.254532e-01 1 1  ON 10
 ud_1                 1.703019e-01 1 1  ON 11
 ud_2                 5.995470e-02 1 1  ON 12
 ud_3                -5.984999e-03 1 1  ON 13
 ud_4                -5.994152e-02 1 1  ON 14
 ud_5                -1.009161e-01 1 1  ON 15
 ud_6                -1.286894e-01 1 1  ON 16
 ud_7                -1.463290e-01 1 1  ON 17
 ud_8                -1.489623e-01 1 1  ON 18
 ud_9                -1.380754e-01 1 1  ON 19
 eO_0                -7.375881e-01 1 1  ON 20
 eO_1                -4.263478e-01 1 1  ON 21
 eO_2                -1.765899e-02 1 1  ON 22
 eO_3                 2.926565e-01 1 1  ON 23
 eO_4                 5.069667e-01 1 1  ON 24
 eO_5                 4.628039e-01 1 1  ON 25
 eO_6                 2.363343e-01 1 1  ON 26
 eO_7                -5.443953e-02 1 1  ON 27
 eO_8                -2.025681e-01 1 1  ON 28
 eO_9                -6.244128e-02 1 1  ON 29
eH1_0                -2.342047e-01 1 1  ON 30
eH1_1                -1.323825e-01 1 1  ON 31
eH1_2                -9.025351e-02 1 1  ON 32
eH1_3                -3.955348e-02 1 1  ON 33
eH1_4                 1.466172e-02 1 1  ON 34
eH1_5                 4.896118e-02 1 1  ON 35
eH1_6                 1.012915e-01 1 1  ON 36
eH1_7                 1.446491e-01 1 1  ON 37
eH1_8                 1.533593e-01 1 1  ON 38
eH1_9                 3.828049e-02 1 1  ON 39
eH2_0                -2.328021e-01 1 1  ON 40
eH2_1                -1.308033e-01 1 1  ON 41
eH2_2                -8.843726e-02 1 1  ON 42
eH2_3                -3.744018e-02 1 1  ON 43
eH2_4                 1.689810e-02 1 1  ON 44
eH2_5                 5.219374e-02 1 1  ON 45
eH2_6                 1.048208e-01 1 1  ON 46
eH2_7                 1.513781e-01 1 1  ON 47
eH2_8                 1.612940e-01 1 1  ON 48
eH2_9                 2.107236e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8322
    reference variance = 0.171049
====================================================
  Execution time = 2.5495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3205e-01
  Total weights = 2.0000e+06
  Execution time = 2.9554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331853692047
                                         uncertainty =       0.006177894485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331853692047
                                         uncertainty =       0.006177894485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407361756
  error estimate for blocks of size 2^( 2) =       0.000419536957
  error estimate for blocks of size 2^( 3) =       0.000432774586
  error estimate for blocks of size 2^( 4) =       0.000444962577
  error estimate for blocks of size 2^( 5) =       0.000454927939
  error estimate for blocks of size 2^( 6) =       0.000462013281
  error estimate for blocks of size 2^( 7) =       0.000468647496

      target function =                  N/A
              le_mean =     -16.910356654345
             les_mean =     286.292049211127
             stat err =       0.000457637823
             autocorr =       1.262069626751
              std dev =       0.576096519615
             le_variance =       0.331887199913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332296385310
                                         uncertainty =       0.006193015248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332296385310
                                         uncertainty =       0.006193015248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407633336
  error estimate for blocks of size 2^( 2) =       0.000419793703
  error estimate for blocks of size 2^( 3) =       0.000433014135
  error estimate for blocks of size 2^( 4) =       0.000445183223
  error estimate for blocks of size 2^( 5) =       0.000455132854
  error estimate for blocks of size 2^( 6) =       0.000462221845
  error estimate for blocks of size 2^( 7) =       0.000468855659

      target function =                  N/A
              le_mean =     -16.910357156894
             les_mean =     286.292508881534
             stat err =       0.000457848395
             autocorr =       1.261548657170
              std dev =       0.576480592894
             le_variance =       0.332329873983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332190004913
                                         uncertainty =       0.006189463548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332190004913
                                         uncertainty =       0.006189463548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407568085
  error estimate for blocks of size 2^( 2) =       0.000419731522
  error estimate for blocks of size 2^( 3) =       0.000432957551
  error estimate for blocks of size 2^( 4) =       0.000445132984
  error estimate for blocks of size 2^( 5) =       0.000455089235
  error estimate for blocks of size 2^( 6) =       0.000462176927
  error estimate for blocks of size 2^( 7) =       0.000468810337

      target function =                  N/A
              le_mean =     -16.910356787479
             les_mean =     286.292390000732
             stat err =       0.000457802371
             autocorr =       1.261698940314
              std dev =       0.576388312702
             le_variance =       0.332223487019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331903260933
                                         uncertainty =       0.006179616960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331903260933
                                         uncertainty =       0.006179616960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407392170
  error estimate for blocks of size 2^( 2) =       0.000419565590
  error estimate for blocks of size 2^( 3) =       0.000432801551
  error estimate for blocks of size 2^( 4) =       0.000444987745
  error estimate for blocks of size 2^( 5) =       0.000454951929
  error estimate for blocks of size 2^( 6) =       0.000462037675
  error estimate for blocks of size 2^( 7) =       0.000468671676

      target function =                  N/A
              le_mean =     -16.910356646050
             les_mean =     286.292098490953
             stat err =       0.000457662256
             autocorr =       1.262015936146
              std dev =       0.576139531976
             le_variance =       0.331936760306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910356654345        initial
     2.3842e-01     2.3842e+00             1.3482e-03       -16.910357156894  <--
     9.5367e-01     9.5367e+00             3.6378e-04       -16.910356787479
     3.8147e+00     3.8147e+01             9.2070e-05       -16.910356646050

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.0322e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.068780e-01 1 1  ON 0
 uu_1                 1.420575e-01 1 1  ON 1
 uu_2                 4.394663e-02 1 1  ON 2
 uu_3                -1.770628e-02 1 1  ON 3
 uu_4                -6.461399e-02 1 1  ON 4
 uu_5                -9.810699e-02 1 1  ON 5
 uu_6                -1.237134e-01 1 1  ON 6
 uu_7                -1.345818e-01 1 1  ON 7
 uu_8                -1.255383e-01 1 1  ON 8
 uu_9                -9.653017e-02 1 1  ON 9
 ud_0                 4.261077e-01 1 1  ON 10
 ud_1                 1.708364e-01 1 1  ON 11
 ud_2                 6.032608e-02 1 1  ON 12
 ud_3                -5.751566e-03 1 1  ON 13
 ud_4                -5.984580e-02 1 1  ON 14
 ud_5                -1.009550e-01 1 1  ON 15
 ud_6                -1.286608e-01 1 1  ON 16
 ud_7                -1.465949e-01 1 1  ON 17
 ud_8                -1.496688e-01 1 1  ON 18
 ud_9                -1.387210e-01 1 1  ON 19
 eO_0                -7.383423e-01 1 1  ON 20
 eO_1                -4.269506e-01 1 1  ON 21
 eO_2                -1.773309e-02 1 1  ON 22
 eO_3                 2.932614e-01 1 1  ON 23
 eO_4                 5.079511e-01 1 1  ON 24
 eO_5                 4.634445e-01 1 1  ON 25
 eO_6                 2.365425e-01 1 1  ON 26
 eO_7                -5.422610e-02 1 1  ON 27
 eO_8                -2.032240e-01 1 1  ON 28
 eO_9                -6.294267e-02 1 1  ON 29
eH1_0                -2.349953e-01 1 1  ON 30
eH1_1                -1.327948e-01 1 1  ON 31
eH1_2                -9.069921e-02 1 1  ON 32
eH1_3                -3.989101e-02 1 1  ON 33
eH1_4                 1.444831e-02 1 1  ON 34
eH1_5                 4.896961e-02 1 1  ON 35
eH1_6                 1.017524e-01 1 1  ON 36
eH1_7                 1.452064e-01 1 1  ON 37
eH1_8                 1.540603e-01 1 1  ON 38
eH1_9                 3.878561e-02 1 1  ON 39
eH2_0                -2.335127e-01 1 1  ON 40
eH2_1                -1.312199e-01 1 1  ON 41
eH2_2                -8.878640e-02 1 1  ON 42
eH2_3                -3.763664e-02 1 1  ON 43
eH2_4                 1.677377e-02 1 1  ON 44
eH2_5                 5.211057e-02 1 1  ON 45
eH2_6                 1.051603e-01 1 1  ON 46
eH2_7                 1.515495e-01 1 1  ON 47
eH2_8                 1.619331e-01 1 1  ON 48
eH2_9                 2.174897e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.0143
    reference variance = 0.437586
====================================================
  Execution time = 2.5882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341104849182
                                         uncertainty =       0.005583786308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341104849182
                                         uncertainty =       0.005583786308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412953020
  error estimate for blocks of size 2^( 2) =       0.000424783364
  error estimate for blocks of size 2^( 3) =       0.000437510298
  error estimate for blocks of size 2^( 4) =       0.000449552927
  error estimate for blocks of size 2^( 5) =       0.000460773570
  error estimate for blocks of size 2^( 6) =       0.000468757850
  error estimate for blocks of size 2^( 7) =       0.000473773555

      target function =                  N/A
              le_mean =     -16.910842472735
             les_mean =     286.317653360889
             stat err =       0.000463214475
             autocorr =       1.258238448168
              std dev =       0.584003761757
             le_variance =       0.341060393746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691084247274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910842472735       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910846963007       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910846680555       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910848955729       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910849698891       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910858933936       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910856885054       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910860888922       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910861426569       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910860596818       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910860896793       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910861756908       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910861744223       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910861357370       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 4.707952e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910842472735       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910844868711       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910844521490       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910845817169       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910846528465       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910847953812       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910848457328       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910847813161       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910848735610       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910848497487       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910848554746       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.242946e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910842472735       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910843308843       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910843220610       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910843701717       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910843986395       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910844041450       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910844188050       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910844111707       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910844207819       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.270480e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2464e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.072150e-01 1 1  ON 0
 uu_1                 1.423338e-01 1 1  ON 1
 uu_2                 4.415379e-02 1 1  ON 2
 uu_3                -1.765105e-02 1 1  ON 3
 uu_4                -6.452947e-02 1 1  ON 4
 uu_5                -9.827845e-02 1 1  ON 5
 uu_6                -1.239950e-01 1 1  ON 6
 uu_7                -1.351149e-01 1 1  ON 7
 uu_8                -1.257546e-01 1 1  ON 8
 uu_9                -9.680706e-02 1 1  ON 9
 ud_0                 4.264137e-01 1 1  ON 10
 ud_1                 1.713349e-01 1 1  ON 11
 ud_2                 6.067878e-02 1 1  ON 12
 ud_3                -5.647126e-03 1 1  ON 13
 ud_4                -5.994374e-02 1 1  ON 14
 ud_5                -1.011967e-01 1 1  ON 15
 ud_6                -1.292712e-01 1 1  ON 16
 ud_7                -1.470065e-01 1 1  ON 17
 ud_8                -1.493897e-01 1 1  ON 18
 ud_9                -1.386440e-01 1 1  ON 19
 eO_0                -7.393925e-01 1 1  ON 20
 eO_1                -4.273971e-01 1 1  ON 21
 eO_2                -1.781087e-02 1 1  ON 22
 eO_3                 2.935554e-01 1 1  ON 23
 eO_4                 5.090969e-01 1 1  ON 24
 eO_5                 4.644078e-01 1 1  ON 25
 eO_6                 2.367460e-01 1 1  ON 26
 eO_7                -5.403751e-02 1 1  ON 27
 eO_8                -2.037430e-01 1 1  ON 28
 eO_9                -6.353320e-02 1 1  ON 29
eH1_0                -2.359754e-01 1 1  ON 30
eH1_1                -1.337085e-01 1 1  ON 31
eH1_2                -9.121160e-02 1 1  ON 32
eH1_3                -4.033245e-02 1 1  ON 33
eH1_4                 1.441785e-02 1 1  ON 34
eH1_5                 4.900310e-02 1 1  ON 35
eH1_6                 1.023454e-01 1 1  ON 36
eH1_7                 1.464493e-01 1 1  ON 37
eH1_8                 1.548948e-01 1 1  ON 38
eH1_9                 3.917576e-02 1 1  ON 39
eH2_0                -2.345374e-01 1 1  ON 40
eH2_1                -1.322075e-01 1 1  ON 41
eH2_2                -8.952887e-02 1 1  ON 42
eH2_3                -3.802219e-02 1 1  ON 43
eH2_4                 1.640122e-02 1 1  ON 44
eH2_5                 5.227427e-02 1 1  ON 45
eH2_6                 1.059699e-01 1 1  ON 46
eH2_7                 1.521623e-01 1 1  ON 47
eH2_8                 1.627867e-01 1 1  ON 48
eH2_9                 2.271632e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9363
    reference variance = 0.126241
====================================================
  Execution time = 2.5392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3076e-01
  Total weights = 2.0000e+06
  Execution time = 2.9441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330680416725
                                         uncertainty =       0.004876698680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330680416725
                                         uncertainty =       0.004876698680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406644726
  error estimate for blocks of size 2^( 2) =       0.000418944085
  error estimate for blocks of size 2^( 3) =       0.000432049544
  error estimate for blocks of size 2^( 4) =       0.000445101293
  error estimate for blocks of size 2^( 5) =       0.000456945235
  error estimate for blocks of size 2^( 6) =       0.000465043885
  error estimate for blocks of size 2^( 7) =       0.000470917983

      target function =                  N/A
              le_mean =     -16.909613410985
             les_mean =     286.265745410178
             stat err =       0.000459502099
             autocorr =       1.276864201536
              std dev =       0.575082486756
             le_variance =       0.330719866574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132034895
                                         uncertainty =       0.004878579145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132034895
                                         uncertainty =       0.004878579145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406922072
  error estimate for blocks of size 2^( 2) =       0.000419218191
  error estimate for blocks of size 2^( 3) =       0.000432300451
  error estimate for blocks of size 2^( 4) =       0.000445314070
  error estimate for blocks of size 2^( 5) =       0.000457135319
  error estimate for blocks of size 2^( 6) =       0.000465215026
  error estimate for blocks of size 2^( 7) =       0.000471081519

      target function =                  N/A
              le_mean =     -16.909623275446
             les_mean =     286.266530297379
             stat err =       0.000459686483
             autocorr =       1.276147791357
              std dev =       0.575474713136
             le_variance =       0.331171145459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330778268757
                                         uncertainty =       0.004876004747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330778268757
                                         uncertainty =       0.004876004747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406704730
  error estimate for blocks of size 2^( 2) =       0.000419008454
  error estimate for blocks of size 2^( 3) =       0.000432105915
  error estimate for blocks of size 2^( 4) =       0.000445135256
  error estimate for blocks of size 2^( 5) =       0.000456969947
  error estimate for blocks of size 2^( 6) =       0.000465060734
  error estimate for blocks of size 2^( 7) =       0.000470947608

      target function =                  N/A
              le_mean =     -16.909620601716
             les_mean =     286.266086203545
             stat err =       0.000459528386
             autocorr =       1.276633512728
              std dev =       0.575167345196
             le_variance =       0.330817474980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330654491994
                                         uncertainty =       0.004876047400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330654491994
                                         uncertainty =       0.004876047400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406628765
  error estimate for blocks of size 2^( 2) =       0.000418929680
  error estimate for blocks of size 2^( 3) =       0.000432034994
  error estimate for blocks of size 2^( 4) =       0.000445083857
  error estimate for blocks of size 2^( 5) =       0.000456927593
  error estimate for blocks of size 2^( 6) =       0.000465026087
  error estimate for blocks of size 2^( 7) =       0.000470904997

      target function =                  N/A
              le_mean =     -16.909614140960
             les_mean =     286.265744135152
             stat err =       0.000459485634
             autocorr =       1.276872931208
              std dev =       0.575059913694
             le_variance =       0.330693904337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909613410985        initial
     5.9605e-02     5.9605e-01             4.7080e-03       -16.909623275446  <--
     2.3842e-01     2.3842e+00             1.2429e-03       -16.909620601716
     9.5367e-01     9.5367e+00             3.2705e-04       -16.909614140960

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.0231e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.081249e-01 1 1  ON 0
 uu_1                 1.431557e-01 1 1  ON 1
 uu_2                 4.476623e-02 1 1  ON 2
 uu_3                -1.729051e-02 1 1  ON 3
 uu_4                -6.449215e-02 1 1  ON 4
 uu_5                -9.868159e-02 1 1  ON 5
 uu_6                -1.246994e-01 1 1  ON 6
 uu_7                -1.362558e-01 1 1  ON 7
 uu_8                -1.267290e-01 1 1  ON 8
 uu_9                -9.780713e-02 1 1  ON 9
 ud_0                 4.274411e-01 1 1  ON 10
 ud_1                 1.723132e-01 1 1  ON 11
 ud_2                 6.142426e-02 1 1  ON 12
 ud_3                -5.238266e-03 1 1  ON 13
 ud_4                -5.998551e-02 1 1  ON 14
 ud_5                -1.016443e-01 1 1  ON 15
 ud_6                -1.302177e-01 1 1  ON 16
 ud_7                -1.478294e-01 1 1  ON 17
 ud_8                -1.494862e-01 1 1  ON 18
 ud_9                -1.386647e-01 1 1  ON 19
 eO_0                -7.412768e-01 1 1  ON 20
 eO_1                -4.285680e-01 1 1  ON 21
 eO_2                -1.814911e-02 1 1  ON 22
 eO_3                 2.943622e-01 1 1  ON 23
 eO_4                 5.114162e-01 1 1  ON 24
 eO_5                 4.669314e-01 1 1  ON 25
 eO_6                 2.377781e-01 1 1  ON 26
 eO_7                -5.357410e-02 1 1  ON 27
 eO_8                -2.053833e-01 1 1  ON 28
 eO_9                -6.530973e-02 1 1  ON 29
eH1_0                -2.382538e-01 1 1  ON 30
eH1_1                -1.356704e-01 1 1  ON 31
eH1_2                -9.279894e-02 1 1  ON 32
eH1_3                -4.165844e-02 1 1  ON 33
eH1_4                 1.379356e-02 1 1  ON 34
eH1_5                 4.892471e-02 1 1  ON 35
eH1_6                 1.036937e-01 1 1  ON 36
eH1_7                 1.499143e-01 1 1  ON 37
eH1_8                 1.573994e-01 1 1  ON 38
eH1_9                 4.035894e-02 1 1  ON 39
eH2_0                -2.370254e-01 1 1  ON 40
eH2_1                -1.345044e-01 1 1  ON 41
eH2_2                -9.145484e-02 1 1  ON 42
eH2_3                -3.953987e-02 1 1  ON 43
eH2_4                 1.532658e-02 1 1  ON 44
eH2_5                 5.209908e-02 1 1  ON 45
eH2_6                 1.076936e-01 1 1  ON 46
eH2_7                 1.541624e-01 1 1  ON 47
eH2_8                 1.653691e-01 1 1  ON 48
eH2_9                 2.557160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2708e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9677
    reference variance = 0.470469
====================================================
  Execution time = 2.8082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332879545877
                                         uncertainty =       0.005062535359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332879545877
                                         uncertainty =       0.005062535359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060194
  error estimate for blocks of size 2^( 2) =       0.000419700357
  error estimate for blocks of size 2^( 3) =       0.000432023124
  error estimate for blocks of size 2^( 4) =       0.000443073493
  error estimate for blocks of size 2^( 5) =       0.000452716237
  error estimate for blocks of size 2^( 6) =       0.000459486382
  error estimate for blocks of size 2^( 7) =       0.000463615043

      target function =                  N/A
              le_mean =     -16.910574428599
             les_mean =     286.300553583055
             stat err =       0.000454722789
             autocorr =       1.241780898886
              std dev =       0.577084261081
             le_variance =       0.333026244387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691057442860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574428599       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910575280763       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910577891377       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910579346195       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910579212826       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910585854644       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910585847940       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910587940351       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910584121541       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910589325428       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910591274491       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910594186407       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910597731361       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910598231639       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910599157771       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910599317785       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910598859825       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910599598171       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910600098335       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-02 is 1.612698e-02

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574428599       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910575134409       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910577315900       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910577998451       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910577750189       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910582240680       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910580326581       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910580978687       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910579952764       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910581379144       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910581573655       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910581974449       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910582434399       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.886647e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574428599       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910574846987       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910576195497       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910576166745       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910576224365       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910577577019       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910577335917       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910577449798       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910576910600       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910577096964       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910577170557       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 9.764172e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4644e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091802e-01 1 1  ON 0
 uu_1                 1.436187e-01 1 1  ON 1
 uu_2                 4.503420e-02 1 1  ON 2
 uu_3                -1.750711e-02 1 1  ON 3
 uu_4                -6.521071e-02 1 1  ON 4
 uu_5                -9.939899e-02 1 1  ON 5
 uu_6                -1.246468e-01 1 1  ON 6
 uu_7                -1.359683e-01 1 1  ON 7
 uu_8                -1.282672e-01 1 1  ON 8
 uu_9                -9.997058e-02 1 1  ON 9
 ud_0                 4.285425e-01 1 1  ON 10
 ud_1                 1.730997e-01 1 1  ON 11
 ud_2                 6.218079e-02 1 1  ON 12
 ud_3                -4.627498e-03 1 1  ON 13
 ud_4                -5.991941e-02 1 1  ON 14
 ud_5                -1.018018e-01 1 1  ON 15
 ud_6                -1.305920e-01 1 1  ON 16
 ud_7                -1.488311e-01 1 1  ON 17
 ud_8                -1.503969e-01 1 1  ON 18
 ud_9                -1.388849e-01 1 1  ON 19
 eO_0                -7.430474e-01 1 1  ON 20
 eO_1                -4.297964e-01 1 1  ON 21
 eO_2                -1.809621e-02 1 1  ON 22
 eO_3                 2.963854e-01 1 1  ON 23
 eO_4                 5.134802e-01 1 1  ON 24
 eO_5                 4.690578e-01 1 1  ON 25
 eO_6                 2.393295e-01 1 1  ON 26
 eO_7                -5.310937e-02 1 1  ON 27
 eO_8                -2.080008e-01 1 1  ON 28
 eO_9                -6.764997e-02 1 1  ON 29
eH1_0                -2.404779e-01 1 1  ON 30
eH1_1                -1.372167e-01 1 1  ON 31
eH1_2                -9.434238e-02 1 1  ON 32
eH1_3                -4.278250e-02 1 1  ON 33
eH1_4                 1.209343e-02 1 1  ON 34
eH1_5                 4.782321e-02 1 1  ON 35
eH1_6                 1.031441e-01 1 1  ON 36
eH1_7                 1.518880e-01 1 1  ON 37
eH1_8                 1.607710e-01 1 1  ON 38
eH1_9                 4.424559e-02 1 1  ON 39
eH2_0                -2.392437e-01 1 1  ON 40
eH2_1                -1.365531e-01 1 1  ON 41
eH2_2                -9.307333e-02 1 1  ON 42
eH2_3                -4.136308e-02 1 1  ON 43
eH2_4                 1.388766e-02 1 1  ON 44
eH2_5                 5.144043e-02 1 1  ON 45
eH2_6                 1.086581e-01 1 1  ON 46
eH2_7                 1.554254e-01 1 1  ON 47
eH2_8                 1.690493e-01 1 1  ON 48
eH2_9                 2.929137e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9461
    reference variance = 0.281337
====================================================
  Execution time = 2.5689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4339e-01
  Total weights = 2.0000e+06
  Execution time = 2.9637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342495957203
                                         uncertainty =       0.007414769402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342495957203
                                         uncertainty =       0.007414769402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414004177
  error estimate for blocks of size 2^( 2) =       0.000425585453
  error estimate for blocks of size 2^( 3) =       0.000437552981
  error estimate for blocks of size 2^( 4) =       0.000448698700
  error estimate for blocks of size 2^( 5) =       0.000458318491
  error estimate for blocks of size 2^( 6) =       0.000465721846
  error estimate for blocks of size 2^( 7) =       0.000472122020

      target function =                  N/A
              le_mean =     -16.910492294333
             les_mean =     286.307548382663
             stat err =       0.000461215264
             autocorr =       1.241074631371
              std dev =       0.585490322187
             le_variance =       0.342798917374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621046245
                                         uncertainty =       0.007442868759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621046245
                                         uncertainty =       0.007442868759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414683344
  error estimate for blocks of size 2^( 2) =       0.000426247159
  error estimate for blocks of size 2^( 3) =       0.000438180815
  error estimate for blocks of size 2^( 4) =       0.000449277444
  error estimate for blocks of size 2^( 5) =       0.000458847471
  error estimate for blocks of size 2^( 6) =       0.000466199907
  error estimate for blocks of size 2^( 7) =       0.000472561672

      target function =                  N/A
              le_mean =     -16.910487454089
             les_mean =     286.308510314577
             stat err =       0.000461721623
             autocorr =       1.239730379784
              std dev =       0.586450809216
             le_variance =       0.343924551630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703359519
                                         uncertainty =       0.007449207766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703359519
                                         uncertainty =       0.007449207766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414733073
  error estimate for blocks of size 2^( 2) =       0.000426296211
  error estimate for blocks of size 2^( 3) =       0.000438239514
  error estimate for blocks of size 2^( 4) =       0.000449354177
  error estimate for blocks of size 2^( 5) =       0.000458944418
  error estimate for blocks of size 2^( 6) =       0.000466309557
  error estimate for blocks of size 2^( 7) =       0.000472661886

      target function =                  N/A
              le_mean =     -16.910487665389
             les_mean =     286.308599952781
             stat err =       0.000461817509
             autocorr =       1.239947937112
              std dev =       0.586521136456
             le_variance =       0.344007043510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342736976676
                                         uncertainty =       0.007422949128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342736976676
                                         uncertainty =       0.007422949128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414149805
  error estimate for blocks of size 2^( 2) =       0.000425726277
  error estimate for blocks of size 2^( 3) =       0.000437690114
  error estimate for blocks of size 2^( 4) =       0.000448832028
  error estimate for blocks of size 2^( 5) =       0.000458449361
  error estimate for blocks of size 2^( 6) =       0.000465846537
  error estimate for blocks of size 2^( 7) =       0.000472235753

      target function =                  N/A
              le_mean =     -16.910489605793
             les_mean =     286.307698658488
             stat err =       0.000461340920
             autocorr =       1.240877847650
              std dev =       0.585696271438
             le_variance =       0.343040122377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910492294333        initial  <--
     1.4901e-02     1.4901e-01             1.6127e-02       -16.910487454089
     5.9605e-02     5.9605e-01             3.8866e-03       -16.910487665389
     2.3842e-01     2.3842e+00             9.7642e-04       -16.910489605793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5380
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.081249e-01 1 1  ON 0
 uu_1                 1.431557e-01 1 1  ON 1
 uu_2                 4.476623e-02 1 1  ON 2
 uu_3                -1.729051e-02 1 1  ON 3
 uu_4                -6.449215e-02 1 1  ON 4
 uu_5                -9.868159e-02 1 1  ON 5
 uu_6                -1.246994e-01 1 1  ON 6
 uu_7                -1.362558e-01 1 1  ON 7
 uu_8                -1.267290e-01 1 1  ON 8
 uu_9                -9.780713e-02 1 1  ON 9
 ud_0                 4.274411e-01 1 1  ON 10
 ud_1                 1.723132e-01 1 1  ON 11
 ud_2                 6.142426e-02 1 1  ON 12
 ud_3                -5.238266e-03 1 1  ON 13
 ud_4                -5.998551e-02 1 1  ON 14
 ud_5                -1.016443e-01 1 1  ON 15
 ud_6                -1.302177e-01 1 1  ON 16
 ud_7                -1.478294e-01 1 1  ON 17
 ud_8                -1.494862e-01 1 1  ON 18
 ud_9                -1.386647e-01 1 1  ON 19
 eO_0                -7.412768e-01 1 1  ON 20
 eO_1                -4.285680e-01 1 1  ON 21
 eO_2                -1.814911e-02 1 1  ON 22
 eO_3                 2.943622e-01 1 1  ON 23
 eO_4                 5.114162e-01 1 1  ON 24
 eO_5                 4.669314e-01 1 1  ON 25
 eO_6                 2.377781e-01 1 1  ON 26
 eO_7                -5.357410e-02 1 1  ON 27
 eO_8                -2.053833e-01 1 1  ON 28
 eO_9                -6.530973e-02 1 1  ON 29
eH1_0                -2.382538e-01 1 1  ON 30
eH1_1                -1.356704e-01 1 1  ON 31
eH1_2                -9.279894e-02 1 1  ON 32
eH1_3                -4.165844e-02 1 1  ON 33
eH1_4                 1.379356e-02 1 1  ON 34
eH1_5                 4.892471e-02 1 1  ON 35
eH1_6                 1.036937e-01 1 1  ON 36
eH1_7                 1.499143e-01 1 1  ON 37
eH1_8                 1.573994e-01 1 1  ON 38
eH1_9                 4.035894e-02 1 1  ON 39
eH2_0                -2.370254e-01 1 1  ON 40
eH2_1                -1.345044e-01 1 1  ON 41
eH2_2                -9.145484e-02 1 1  ON 42
eH2_3                -3.953987e-02 1 1  ON 43
eH2_4                 1.532658e-02 1 1  ON 44
eH2_5                 5.209908e-02 1 1  ON 45
eH2_6                 1.076936e-01 1 1  ON 46
eH2_7                 1.541624e-01 1 1  ON 47
eH2_8                 1.653691e-01 1 1  ON 48
eH2_9                 2.557160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9311
    reference variance = 0.170063
====================================================
  Execution time = 2.6372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284525718
                                         uncertainty =       0.004300274235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284525718
                                         uncertainty =       0.004300274235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405223620
  error estimate for blocks of size 2^( 2) =       0.000416977556
  error estimate for blocks of size 2^( 3) =       0.000429977305
  error estimate for blocks of size 2^( 4) =       0.000443024176
  error estimate for blocks of size 2^( 5) =       0.000455090824
  error estimate for blocks of size 2^( 6) =       0.000463967521
  error estimate for blocks of size 2^( 7) =       0.000467368893

      target function =                  N/A
              le_mean =     -16.910612379619
             les_mean =     286.297223254160
             stat err =       0.000457362853
             autocorr =       1.273891011060
              std dev =       0.573072739386
             le_variance =       0.328412364628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691061237962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910612379619       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910613089463       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910614481127       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910618298878       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910620029486       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910619020472       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910618915427       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910619391226       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910619122393       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910619166399       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910619385408       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.960251e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910612379619       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910612672359       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910613399413       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910614470442       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910614787436       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910615118054       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910614748938       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910614811778       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910614735215       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 4.933225e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910612379619       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910612466994       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910612723634       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910612979361       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910613011751       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910613161913       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910613092553       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910613102999       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.228052e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2984e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081156e-01 1 1  ON 0
 uu_1                 1.430982e-01 1 1  ON 1
 uu_2                 4.485738e-02 1 1  ON 2
 uu_3                -1.730421e-02 1 1  ON 3
 uu_4                -6.453168e-02 1 1  ON 4
 uu_5                -9.878140e-02 1 1  ON 5
 uu_6                -1.246883e-01 1 1  ON 6
 uu_7                -1.363233e-01 1 1  ON 7
 uu_8                -1.268560e-01 1 1  ON 8
 uu_9                -9.788770e-02 1 1  ON 9
 ud_0                 4.274936e-01 1 1  ON 10
 ud_1                 1.722698e-01 1 1  ON 11
 ud_2                 6.141659e-02 1 1  ON 12
 ud_3                -5.277596e-03 1 1  ON 13
 ud_4                -5.996889e-02 1 1  ON 14
 ud_5                -1.017551e-01 1 1  ON 15
 ud_6                -1.301930e-01 1 1  ON 16
 ud_7                -1.478994e-01 1 1  ON 17
 ud_8                -1.495016e-01 1 1  ON 18
 ud_9                -1.385306e-01 1 1  ON 19
 eO_0                -7.414597e-01 1 1  ON 20
 eO_1                -4.287064e-01 1 1  ON 21
 eO_2                -1.826488e-02 1 1  ON 22
 eO_3                 2.945135e-01 1 1  ON 23
 eO_4                 5.116371e-01 1 1  ON 24
 eO_5                 4.671478e-01 1 1  ON 25
 eO_6                 2.379186e-01 1 1  ON 26
 eO_7                -5.351248e-02 1 1  ON 27
 eO_8                -2.055604e-01 1 1  ON 28
 eO_9                -6.548013e-02 1 1  ON 29
eH1_0                -2.386042e-01 1 1  ON 30
eH1_1                -1.359008e-01 1 1  ON 31
eH1_2                -9.309766e-02 1 1  ON 32
eH1_3                -4.179805e-02 1 1  ON 33
eH1_4                 1.359293e-02 1 1  ON 34
eH1_5                 4.881862e-02 1 1  ON 35
eH1_6                 1.039454e-01 1 1  ON 36
eH1_7                 1.502716e-01 1 1  ON 37
eH1_8                 1.577898e-01 1 1  ON 38
eH1_9                 4.068139e-02 1 1  ON 39
eH2_0                -2.372600e-01 1 1  ON 40
eH2_1                -1.346004e-01 1 1  ON 41
eH2_2                -9.172383e-02 1 1  ON 42
eH2_3                -3.974031e-02 1 1  ON 43
eH2_4                 1.512321e-02 1 1  ON 44
eH2_5                 5.192406e-02 1 1  ON 45
eH2_6                 1.079013e-01 1 1  ON 46
eH2_7                 1.542393e-01 1 1  ON 47
eH2_8                 1.656493e-01 1 1  ON 48
eH2_9                 2.606492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9292
    reference variance = 0.302196
====================================================
  Execution time = 2.5526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5358e-01
  Total weights = 2.0000e+06
  Execution time = 2.9501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353693717139
                                         uncertainty =       0.016773159915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353693717139
                                         uncertainty =       0.016773159915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420436677
  error estimate for blocks of size 2^( 2) =       0.000432074973
  error estimate for blocks of size 2^( 3) =       0.000444395704
  error estimate for blocks of size 2^( 4) =       0.000455385902
  error estimate for blocks of size 2^( 5) =       0.000465727893
  error estimate for blocks of size 2^( 6) =       0.000474109978
  error estimate for blocks of size 2^( 7) =       0.000476921192

      target function =                  N/A
              le_mean =     -16.910354944185
             les_mean =     286.313638160833
             stat err =       0.000468036241
             autocorr =       1.239246711893
              std dev =       0.594587251180
             le_variance =       0.353533999265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353857811212
                                         uncertainty =       0.016789497842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353857811212
                                         uncertainty =       0.016789497842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420534166
  error estimate for blocks of size 2^( 2) =       0.000432173514
  error estimate for blocks of size 2^( 3) =       0.000444493804
  error estimate for blocks of size 2^( 4) =       0.000455476370
  error estimate for blocks of size 2^( 5) =       0.000465806571
  error estimate for blocks of size 2^( 6) =       0.000474170688
  error estimate for blocks of size 2^( 7) =       0.000476975112

      target function =                  N/A
              le_mean =     -16.910354022558
             les_mean =     286.313770960879
             stat err =       0.000468107185
             autocorr =       1.239047752051
              std dev =       0.594725120937
             le_variance =       0.353697969473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353790222820
                                         uncertainty =       0.016785989796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353790222820
                                         uncertainty =       0.016785989796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420494011
  error estimate for blocks of size 2^( 2) =       0.000432132723
  error estimate for blocks of size 2^( 3) =       0.000444454039
  error estimate for blocks of size 2^( 4) =       0.000455439159
  error estimate for blocks of size 2^( 5) =       0.000465773922
  error estimate for blocks of size 2^( 6) =       0.000474144520
  error estimate for blocks of size 2^( 7) =       0.000476953485

      target function =                  N/A
              le_mean =     -16.910354357008
             les_mean =     286.313714729043
             stat err =       0.000468077771
             autocorr =       1.239128670067
              std dev =       0.594668332997
             le_variance =       0.353630426269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353712328786
                                         uncertainty =       0.016775456002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353712328786
                                         uncertainty =       0.016775456002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420447735
  error estimate for blocks of size 2^( 2) =       0.000432085861
  error estimate for blocks of size 2^( 3) =       0.000444406602
  error estimate for blocks of size 2^( 4) =       0.000455395942
  error estimate for blocks of size 2^( 5) =       0.000465736791
  error estimate for blocks of size 2^( 6) =       0.000474117117
  error estimate for blocks of size 2^( 7) =       0.000476928408

      target function =                  N/A
              le_mean =     -16.910354824514
             les_mean =     286.313652710238
             stat err =       0.000468044565
             autocorr =       1.239225602606
              std dev =       0.594602889375
             le_variance =       0.353552596054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910354944185        initial  <--
     1.4901e-01     1.4901e+00             1.9603e-03       -16.910354022558
     5.9605e-01     5.9605e+00             4.9332e-04       -16.910354357008
     2.3842e+00     2.3842e+01             1.2281e-04       -16.910354824514

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3744
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081249e-01 1 1  ON 0
 uu_1                 1.431557e-01 1 1  ON 1
 uu_2                 4.476623e-02 1 1  ON 2
 uu_3                -1.729051e-02 1 1  ON 3
 uu_4                -6.449215e-02 1 1  ON 4
 uu_5                -9.868159e-02 1 1  ON 5
 uu_6                -1.246994e-01 1 1  ON 6
 uu_7                -1.362558e-01 1 1  ON 7
 uu_8                -1.267290e-01 1 1  ON 8
 uu_9                -9.780713e-02 1 1  ON 9
 ud_0                 4.274411e-01 1 1  ON 10
 ud_1                 1.723132e-01 1 1  ON 11
 ud_2                 6.142426e-02 1 1  ON 12
 ud_3                -5.238266e-03 1 1  ON 13
 ud_4                -5.998551e-02 1 1  ON 14
 ud_5                -1.016443e-01 1 1  ON 15
 ud_6                -1.302177e-01 1 1  ON 16
 ud_7                -1.478294e-01 1 1  ON 17
 ud_8                -1.494862e-01 1 1  ON 18
 ud_9                -1.386647e-01 1 1  ON 19
 eO_0                -7.412768e-01 1 1  ON 20
 eO_1                -4.285680e-01 1 1  ON 21
 eO_2                -1.814911e-02 1 1  ON 22
 eO_3                 2.943622e-01 1 1  ON 23
 eO_4                 5.114162e-01 1 1  ON 24
 eO_5                 4.669314e-01 1 1  ON 25
 eO_6                 2.377781e-01 1 1  ON 26
 eO_7                -5.357410e-02 1 1  ON 27
 eO_8                -2.053833e-01 1 1  ON 28
 eO_9                -6.530973e-02 1 1  ON 29
eH1_0                -2.382538e-01 1 1  ON 30
eH1_1                -1.356704e-01 1 1  ON 31
eH1_2                -9.279894e-02 1 1  ON 32
eH1_3                -4.165844e-02 1 1  ON 33
eH1_4                 1.379356e-02 1 1  ON 34
eH1_5                 4.892471e-02 1 1  ON 35
eH1_6                 1.036937e-01 1 1  ON 36
eH1_7                 1.499143e-01 1 1  ON 37
eH1_8                 1.573994e-01 1 1  ON 38
eH1_9                 4.035894e-02 1 1  ON 39
eH2_0                -2.370254e-01 1 1  ON 40
eH2_1                -1.345044e-01 1 1  ON 41
eH2_2                -9.145484e-02 1 1  ON 42
eH2_3                -3.953987e-02 1 1  ON 43
eH2_4                 1.532658e-02 1 1  ON 44
eH2_5                 5.209908e-02 1 1  ON 45
eH2_6                 1.076936e-01 1 1  ON 46
eH2_7                 1.541624e-01 1 1  ON 47
eH2_8                 1.653691e-01 1 1  ON 48
eH2_9                 2.557160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.401068
====================================================
  Execution time = 2.6038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3656e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336555964730
                                         uncertainty =       0.008352842032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336555964730
                                         uncertainty =       0.008352842032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410217784
  error estimate for blocks of size 2^( 2) =       0.000421977798
  error estimate for blocks of size 2^( 3) =       0.000434466722
  error estimate for blocks of size 2^( 4) =       0.000446633931
  error estimate for blocks of size 2^( 5) =       0.000456046539
  error estimate for blocks of size 2^( 6) =       0.000462857209
  error estimate for blocks of size 2^( 7) =       0.000465862396

      target function =                  N/A
              le_mean =     -16.910062681523
             les_mean =     286.286776985906
             stat err =       0.000457850019
             autocorr =       1.245711585309
              std dev =       0.580135554116
             le_variance =       0.336557261149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691006268152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910062681523       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910063376908       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910063633826       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910063529040       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910063550068       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910063651310       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910063794563       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910063726453       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910063766851       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.779908e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910062681523       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910062880815       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910062948194       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910062922307       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910062926983       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910062948463       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910062982441       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910062964059       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910062971939       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.609569e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910062681523       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910062733238       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910062750313       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910062743911       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910062745075       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910062750280       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910062758613       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910062753988       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910062755730       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.162949e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2697e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.081503e-01 1 1  ON 0
 uu_1                 1.431679e-01 1 1  ON 1
 uu_2                 4.478593e-02 1 1  ON 2
 uu_3                -1.728674e-02 1 1  ON 3
 uu_4                -6.449515e-02 1 1  ON 4
 uu_5                -9.870725e-02 1 1  ON 5
 uu_6                -1.246951e-01 1 1  ON 6
 uu_7                -1.362655e-01 1 1  ON 7
 uu_8                -1.267508e-01 1 1  ON 8
 uu_9                -9.783915e-02 1 1  ON 9
 ud_0                 4.274806e-01 1 1  ON 10
 ud_1                 1.723107e-01 1 1  ON 11
 ud_2                 6.143083e-02 1 1  ON 12
 ud_3                -5.232175e-03 1 1  ON 13
 ud_4                -5.998934e-02 1 1  ON 14
 ud_5                -1.016483e-01 1 1  ON 15
 ud_6                -1.301954e-01 1 1  ON 16
 ud_7                -1.478482e-01 1 1  ON 17
 ud_8                -1.495302e-01 1 1  ON 18
 ud_9                -1.386773e-01 1 1  ON 19
 eO_0                -7.412905e-01 1 1  ON 20
 eO_1                -4.286030e-01 1 1  ON 21
 eO_2                -1.816322e-02 1 1  ON 22
 eO_3                 2.943999e-01 1 1  ON 23
 eO_4                 5.114497e-01 1 1  ON 24
 eO_5                 4.669564e-01 1 1  ON 25
 eO_6                 2.378049e-01 1 1  ON 26
 eO_7                -5.357202e-02 1 1  ON 27
 eO_8                -2.054200e-01 1 1  ON 28
 eO_9                -6.533326e-02 1 1  ON 29
eH1_0                -2.382727e-01 1 1  ON 30
eH1_1                -1.356785e-01 1 1  ON 31
eH1_2                -9.282415e-02 1 1  ON 32
eH1_3                -4.168028e-02 1 1  ON 33
eH1_4                 1.374747e-02 1 1  ON 34
eH1_5                 4.893901e-02 1 1  ON 35
eH1_6                 1.037170e-01 1 1  ON 36
eH1_7                 1.499343e-01 1 1  ON 37
eH1_8                 1.574301e-01 1 1  ON 38
eH1_9                 4.038471e-02 1 1  ON 39
eH2_0                -2.370519e-01 1 1  ON 40
eH2_1                -1.345092e-01 1 1  ON 41
eH2_2                -9.147181e-02 1 1  ON 42
eH2_3                -3.957943e-02 1 1  ON 43
eH2_4                 1.531671e-02 1 1  ON 44
eH2_5                 5.210237e-02 1 1  ON 45
eH2_6                 1.077142e-01 1 1  ON 46
eH2_7                 1.541794e-01 1 1  ON 47
eH2_8                 1.653913e-01 1 1  ON 48
eH2_9                 2.560767e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9339
    reference variance = 0.218558
====================================================
  Execution time = 2.5488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2683e-01
  Total weights = 2.0000e+06
  Execution time = 2.9505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326824481275
                                         uncertainty =       0.003106666889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326824481275
                                         uncertainty =       0.003106666889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228858
  error estimate for blocks of size 2^( 2) =       0.000416439411
  error estimate for blocks of size 2^( 3) =       0.000428940779
  error estimate for blocks of size 2^( 4) =       0.000441369632
  error estimate for blocks of size 2^( 5) =       0.000452585249
  error estimate for blocks of size 2^( 6) =       0.000461980458
  error estimate for blocks of size 2^( 7) =       0.000467105635

      target function =                  N/A
              le_mean =     -16.909914000735
             les_mean =     286.271993288901
             stat err =       0.000455760243
             autocorr =       1.271212768826
              std dev =       0.571665933963
             le_variance =       0.326801940054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326917967250
                                         uncertainty =       0.003107569125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326917967250
                                         uncertainty =       0.003107569125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404286648
  error estimate for blocks of size 2^( 2) =       0.000416494494
  error estimate for blocks of size 2^( 3) =       0.000428994089
  error estimate for blocks of size 2^( 4) =       0.000441420265
  error estimate for blocks of size 2^( 5) =       0.000452633301
  error estimate for blocks of size 2^( 6) =       0.000462026421
  error estimate for blocks of size 2^( 7) =       0.000467150629

      target function =                  N/A
              le_mean =     -16.909914324890
             les_mean =     286.272097698375
             stat err =       0.000455807654
             autocorr =       1.271113792564
              std dev =       0.571747659984
             le_variance =       0.326895386697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326880830550
                                         uncertainty =       0.003107232283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326880830550
                                         uncertainty =       0.003107232283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404263694
  error estimate for blocks of size 2^( 2) =       0.000416472633
  error estimate for blocks of size 2^( 3) =       0.000428972992
  error estimate for blocks of size 2^( 4) =       0.000441400351
  error estimate for blocks of size 2^( 5) =       0.000452614410
  error estimate for blocks of size 2^( 6) =       0.000462008618
  error estimate for blocks of size 2^( 7) =       0.000467133182

      target function =                  N/A
              le_mean =     -16.909914167271
             les_mean =     286.272055249482
             stat err =       0.000455789140
             autocorr =       1.271154873537
              std dev =       0.571715198722
             le_variance =       0.326858268450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326831908794
                                         uncertainty =       0.003106742292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326831908794
                                         uncertainty =       0.003106742292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404233450
  error estimate for blocks of size 2^( 2) =       0.000416443790
  error estimate for blocks of size 2^( 3) =       0.000428945026
  error estimate for blocks of size 2^( 4) =       0.000441373686
  error estimate for blocks of size 2^( 5) =       0.000452589097
  error estimate for blocks of size 2^( 6) =       0.000461984183
  error estimate for blocks of size 2^( 7) =       0.000467109278

      target function =                  N/A
              le_mean =     -16.909914020090
             les_mean =     286.272001368341
             stat err =       0.000455764061
             autocorr =       1.271205182083
              std dev =       0.571672427989
             le_variance =       0.326809364923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909914000735        initial
     1.4901e+00     1.4901e+01             1.7799e-04       -16.909914324890  <--
     5.9605e+00     5.9605e+01             4.6096e-05       -16.909914167271
     2.3842e+01     2.3842e+02             1.1629e-05       -16.909914020090

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.0330e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.082218e-01 1 1  ON 0
 uu_1                 1.432054e-01 1 1  ON 1
 uu_2                 4.483876e-02 1 1  ON 2
 uu_3                -1.727475e-02 1 1  ON 3
 uu_4                -6.450577e-02 1 1  ON 4
 uu_5                -9.877441e-02 1 1  ON 5
 uu_6                -1.246878e-01 1 1  ON 6
 uu_7                -1.362922e-01 1 1  ON 7
 uu_8                -1.268133e-01 1 1  ON 8
 uu_9                -9.793403e-02 1 1  ON 9
 ud_0                 4.275751e-01 1 1  ON 10
 ud_1                 1.723147e-01 1 1  ON 11
 ud_2                 6.145344e-02 1 1  ON 12
 ud_3                -5.214685e-03 1 1  ON 13
 ud_4                -5.999541e-02 1 1  ON 14
 ud_5                -1.016577e-01 1 1  ON 15
 ud_6                -1.301376e-01 1 1  ON 16
 ud_7                -1.478967e-01 1 1  ON 17
 ud_8                -1.496571e-01 1 1  ON 18
 ud_9                -1.387155e-01 1 1  ON 19
 eO_0                -7.413421e-01 1 1  ON 20
 eO_1                -4.286994e-01 1 1  ON 21
 eO_2                -1.819952e-02 1 1  ON 22
 eO_3                 2.945088e-01 1 1  ON 23
 eO_4                 5.115488e-01 1 1  ON 24
 eO_5                 4.670303e-01 1 1  ON 25
 eO_6                 2.378851e-01 1 1  ON 26
 eO_7                -5.356467e-02 1 1  ON 27
 eO_8                -2.055291e-01 1 1  ON 28
 eO_9                -6.540346e-02 1 1  ON 29
eH1_0                -2.383291e-01 1 1  ON 30
eH1_1                -1.357093e-01 1 1  ON 31
eH1_2                -9.289938e-02 1 1  ON 32
eH1_3                -4.174450e-02 1 1  ON 33
eH1_4                 1.361557e-02 1 1  ON 34
eH1_5                 4.897911e-02 1 1  ON 35
eH1_6                 1.037873e-01 1 1  ON 36
eH1_7                 1.499953e-01 1 1  ON 37
eH1_8                 1.575221e-01 1 1  ON 38
eH1_9                 4.046150e-02 1 1  ON 39
eH2_0                -2.371295e-01 1 1  ON 40
eH2_1                -1.345295e-01 1 1  ON 41
eH2_2                -9.152595e-02 1 1  ON 42
eH2_3                -3.968675e-02 1 1  ON 43
eH2_4                 1.528174e-02 1 1  ON 44
eH2_5                 5.211324e-02 1 1  ON 45
eH2_6                 1.077765e-01 1 1  ON 46
eH2_7                 1.542309e-01 1 1  ON 47
eH2_8                 1.654579e-01 1 1  ON 48
eH2_9                 2.571512e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8754
    reference variance = 0.228299
====================================================
  Execution time = 2.5922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4950e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349542562527
                                         uncertainty =       0.011104318528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349542562527
                                         uncertainty =       0.011104318528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418029672
  error estimate for blocks of size 2^( 2) =       0.000429734110
  error estimate for blocks of size 2^( 3) =       0.000442453815
  error estimate for blocks of size 2^( 4) =       0.000455581401
  error estimate for blocks of size 2^( 5) =       0.000465700469
  error estimate for blocks of size 2^( 6) =       0.000474156349
  error estimate for blocks of size 2^( 7) =       0.000478568249

      target function =                  N/A
              le_mean =     -16.910943455102
             les_mean =     286.329505980299
             stat err =       0.000468501617
             autocorr =       1.256053012810
              std dev =       0.591183231661
             le_variance =       0.349497613397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691094345510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910943455102       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910945292779       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910946626815       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910946052209       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910946978211       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910946084521       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910947781542       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910947374385       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910947291114       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910947443526       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 7.939172e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910943455102       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910944033930       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910944658802       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910944625613       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910944782613       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910944457946       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910944875218       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910944761212       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 2.127525e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910943455102       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910943609865       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910943800573       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910943807207       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910943857391       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910943760328       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910943848267       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910943824235       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 5.384002e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2659e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082751e-01 1 1  ON 0
 uu_1                 1.432204e-01 1 1  ON 1
 uu_2                 4.485088e-02 1 1  ON 2
 uu_3                -1.727334e-02 1 1  ON 3
 uu_4                -6.453686e-02 1 1  ON 4
 uu_5                -9.887841e-02 1 1  ON 5
 uu_6                -1.247564e-01 1 1  ON 6
 uu_7                -1.363618e-01 1 1  ON 7
 uu_8                -1.268147e-01 1 1  ON 8
 uu_9                -9.795450e-02 1 1  ON 9
 ud_0                 4.276329e-01 1 1  ON 10
 ud_1                 1.723184e-01 1 1  ON 11
 ud_2                 6.142587e-02 1 1  ON 12
 ud_3                -5.235856e-03 1 1  ON 13
 ud_4                -6.004861e-02 1 1  ON 14
 ud_5                -1.016806e-01 1 1  ON 15
 ud_6                -1.301270e-01 1 1  ON 16
 ud_7                -1.478334e-01 1 1  ON 17
 ud_8                -1.496385e-01 1 1  ON 18
 ud_9                -1.387503e-01 1 1  ON 19
 eO_0                -7.414160e-01 1 1  ON 20
 eO_1                -4.287928e-01 1 1  ON 21
 eO_2                -1.827948e-02 1 1  ON 22
 eO_3                 2.946707e-01 1 1  ON 23
 eO_4                 5.116335e-01 1 1  ON 24
 eO_5                 4.671019e-01 1 1  ON 25
 eO_6                 2.379273e-01 1 1  ON 26
 eO_7                -5.349130e-02 1 1  ON 27
 eO_8                -2.056076e-01 1 1  ON 28
 eO_9                -6.549745e-02 1 1  ON 29
eH1_0                -2.385419e-01 1 1  ON 30
eH1_1                -1.358291e-01 1 1  ON 31
eH1_2                -9.302618e-02 1 1  ON 32
eH1_3                -4.175040e-02 1 1  ON 33
eH1_4                 1.359939e-02 1 1  ON 34
eH1_5                 4.900613e-02 1 1  ON 35
eH1_6                 1.038818e-01 1 1  ON 36
eH1_7                 1.501052e-01 1 1  ON 37
eH1_8                 1.576738e-01 1 1  ON 38
eH1_9                 4.058001e-02 1 1  ON 39
eH2_0                -2.372586e-01 1 1  ON 40
eH2_1                -1.345879e-01 1 1  ON 41
eH2_2                -9.158219e-02 1 1  ON 42
eH2_3                -3.974340e-02 1 1  ON 43
eH2_4                 1.522604e-02 1 1  ON 44
eH2_5                 5.202816e-02 1 1  ON 45
eH2_6                 1.078447e-01 1 1  ON 46
eH2_7                 1.542687e-01 1 1  ON 47
eH2_8                 1.656184e-01 1 1  ON 48
eH2_9                 2.588375e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.969
    reference variance = 0.311022
====================================================
  Execution time = 2.5409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3286e-01
  Total weights = 2.0000e+06
  Execution time = 2.9479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332862172252
                                         uncertainty =       0.004257331642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332862172252
                                         uncertainty =       0.004257331642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407918255
  error estimate for blocks of size 2^( 2) =       0.000419611249
  error estimate for blocks of size 2^( 3) =       0.000432186911
  error estimate for blocks of size 2^( 4) =       0.000444309213
  error estimate for blocks of size 2^( 5) =       0.000454665306
  error estimate for blocks of size 2^( 6) =       0.000462428133
  error estimate for blocks of size 2^( 7) =       0.000466809369

      target function =                  N/A
              le_mean =     -16.911254820177
             les_mean =     286.323334032587
             stat err =       0.000457053005
             autocorr =       1.255413675783
              std dev =       0.576883529005
             le_variance =       0.332794606037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333041495628
                                         uncertainty =       0.004257998583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333041495628
                                         uncertainty =       0.004257998583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408028111
  error estimate for blocks of size 2^( 2) =       0.000419719058
  error estimate for blocks of size 2^( 3) =       0.000432293147
  error estimate for blocks of size 2^( 4) =       0.000444413670
  error estimate for blocks of size 2^( 5) =       0.000454771193
  error estimate for blocks of size 2^( 6) =       0.000462526126
  error estimate for blocks of size 2^( 7) =       0.000466896035

      target function =                  N/A
              le_mean =     -16.911252376525
             les_mean =     286.323430655015
             stat err =       0.000457151756
             autocorr =       1.255280015356
              std dev =       0.577038888618
             le_variance =       0.332973878977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332990282614
                                         uncertainty =       0.004257802688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332990282614
                                         uncertainty =       0.004257802688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407996738
  error estimate for blocks of size 2^( 2) =       0.000419687860
  error estimate for blocks of size 2^( 3) =       0.000432262219
  error estimate for blocks of size 2^( 4) =       0.000444383322
  error estimate for blocks of size 2^( 5) =       0.000454741058
  error estimate for blocks of size 2^( 6) =       0.000462498370
  error estimate for blocks of size 2^( 7) =       0.000466872570

      target function =                  N/A
              le_mean =     -16.911253042839
             les_mean =     286.323401988483
             stat err =       0.000457123830
             autocorr =       1.255319694317
              std dev =       0.576994519905
             le_variance =       0.332922676000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332881185748
                                         uncertainty =       0.004257413279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332881185748
                                         uncertainty =       0.004257413279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407929904
  error estimate for blocks of size 2^( 2) =       0.000419622576
  error estimate for blocks of size 2^( 3) =       0.000432198011
  error estimate for blocks of size 2^( 4) =       0.000444320136
  error estimate for blocks of size 2^( 5) =       0.000454676462
  error estimate for blocks of size 2^( 6) =       0.000462438536
  error estimate for blocks of size 2^( 7) =       0.000466818821

      target function =                  N/A
              le_mean =     -16.911254547580
             les_mean =     286.323343820144
             stat err =       0.000457063489
             autocorr =       1.255399564960
              std dev =       0.576900003052
             le_variance =       0.332813613522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911254820177        initial  <--
     3.7253e-01     3.7253e+00             7.9392e-04       -16.911252376525
     1.4901e+00     1.4901e+01             2.1275e-04       -16.911253042839
     5.9605e+00     5.9605e+01             5.3840e-05       -16.911254547580

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2393
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082218e-01 1 1  ON 0
 uu_1                 1.432054e-01 1 1  ON 1
 uu_2                 4.483876e-02 1 1  ON 2
 uu_3                -1.727475e-02 1 1  ON 3
 uu_4                -6.450577e-02 1 1  ON 4
 uu_5                -9.877441e-02 1 1  ON 5
 uu_6                -1.246878e-01 1 1  ON 6
 uu_7                -1.362922e-01 1 1  ON 7
 uu_8                -1.268133e-01 1 1  ON 8
 uu_9                -9.793403e-02 1 1  ON 9
 ud_0                 4.275751e-01 1 1  ON 10
 ud_1                 1.723147e-01 1 1  ON 11
 ud_2                 6.145344e-02 1 1  ON 12
 ud_3                -5.214685e-03 1 1  ON 13
 ud_4                -5.999541e-02 1 1  ON 14
 ud_5                -1.016577e-01 1 1  ON 15
 ud_6                -1.301376e-01 1 1  ON 16
 ud_7                -1.478967e-01 1 1  ON 17
 ud_8                -1.496571e-01 1 1  ON 18
 ud_9                -1.387155e-01 1 1  ON 19
 eO_0                -7.413421e-01 1 1  ON 20
 eO_1                -4.286994e-01 1 1  ON 21
 eO_2                -1.819952e-02 1 1  ON 22
 eO_3                 2.945088e-01 1 1  ON 23
 eO_4                 5.115488e-01 1 1  ON 24
 eO_5                 4.670303e-01 1 1  ON 25
 eO_6                 2.378851e-01 1 1  ON 26
 eO_7                -5.356467e-02 1 1  ON 27
 eO_8                -2.055291e-01 1 1  ON 28
 eO_9                -6.540346e-02 1 1  ON 29
eH1_0                -2.383291e-01 1 1  ON 30
eH1_1                -1.357093e-01 1 1  ON 31
eH1_2                -9.289938e-02 1 1  ON 32
eH1_3                -4.174450e-02 1 1  ON 33
eH1_4                 1.361557e-02 1 1  ON 34
eH1_5                 4.897911e-02 1 1  ON 35
eH1_6                 1.037873e-01 1 1  ON 36
eH1_7                 1.499953e-01 1 1  ON 37
eH1_8                 1.575221e-01 1 1  ON 38
eH1_9                 4.046150e-02 1 1  ON 39
eH2_0                -2.371295e-01 1 1  ON 40
eH2_1                -1.345295e-01 1 1  ON 41
eH2_2                -9.152595e-02 1 1  ON 42
eH2_3                -3.968675e-02 1 1  ON 43
eH2_4                 1.528174e-02 1 1  ON 44
eH2_5                 5.211324e-02 1 1  ON 45
eH2_6                 1.077765e-01 1 1  ON 46
eH2_7                 1.542309e-01 1 1  ON 47
eH2_8                 1.654579e-01 1 1  ON 48
eH2_9                 2.571512e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9939
    reference variance = 0.228245
====================================================
  Execution time = 2.8088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327116061269
                                         uncertainty =       0.004387243367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327116061269
                                         uncertainty =       0.004387243367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404444075
  error estimate for blocks of size 2^( 2) =       0.000416336279
  error estimate for blocks of size 2^( 3) =       0.000429354751
  error estimate for blocks of size 2^( 4) =       0.000440944743
  error estimate for blocks of size 2^( 5) =       0.000452210303
  error estimate for blocks of size 2^( 6) =       0.000460300804
  error estimate for blocks of size 2^( 7) =       0.000467497573

      target function =                  N/A
              le_mean =     -16.910860771652
             les_mean =     286.304361893801
             stat err =       0.000455238356
             autocorr =       1.266953680421
              std dev =       0.571970295704
             le_variance =       0.327150019168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691086077165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910860771652       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910861049318       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910861376335       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910861521545       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910861402625       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910861389399       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910861436391       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910861440339       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 6.723086e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910860771652       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910860843574       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910860931871       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910860969955       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910860942396       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910860936348       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910860945033       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910860947889       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.682244e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910860771652       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910860789796       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910860812319       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910860821963       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910860815241       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910860813554       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910860815495       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910860816315       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.206969e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4776e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082338e-01 1 1  ON 0
 uu_1                 1.432084e-01 1 1  ON 1
 uu_2                 4.484550e-02 1 1  ON 2
 uu_3                -1.727521e-02 1 1  ON 3
 uu_4                -6.451437e-02 1 1  ON 4
 uu_5                -9.878038e-02 1 1  ON 5
 uu_6                -1.246924e-01 1 1  ON 6
 uu_7                -1.363019e-01 1 1  ON 7
 uu_8                -1.268239e-01 1 1  ON 8
 uu_9                -9.793570e-02 1 1  ON 9
 ud_0                 4.275820e-01 1 1  ON 10
 ud_1                 1.723115e-01 1 1  ON 11
 ud_2                 6.144812e-02 1 1  ON 12
 ud_3                -5.214824e-03 1 1  ON 13
 ud_4                -5.999545e-02 1 1  ON 14
 ud_5                -1.016614e-01 1 1  ON 15
 ud_6                -1.301313e-01 1 1  ON 16
 ud_7                -1.478986e-01 1 1  ON 17
 ud_8                -1.496592e-01 1 1  ON 18
 ud_9                -1.387152e-01 1 1  ON 19
 eO_0                -7.413568e-01 1 1  ON 20
 eO_1                -4.287059e-01 1 1  ON 21
 eO_2                -1.819889e-02 1 1  ON 22
 eO_3                 2.945179e-01 1 1  ON 23
 eO_4                 5.115612e-01 1 1  ON 24
 eO_5                 4.670386e-01 1 1  ON 25
 eO_6                 2.378926e-01 1 1  ON 26
 eO_7                -5.356286e-02 1 1  ON 27
 eO_8                -2.055397e-01 1 1  ON 28
 eO_9                -6.541067e-02 1 1  ON 29
eH1_0                -2.383368e-01 1 1  ON 30
eH1_1                -1.357199e-01 1 1  ON 31
eH1_2                -9.291203e-02 1 1  ON 32
eH1_3                -4.175110e-02 1 1  ON 33
eH1_4                 1.360257e-02 1 1  ON 34
eH1_5                 4.898229e-02 1 1  ON 35
eH1_6                 1.037972e-01 1 1  ON 36
eH1_7                 1.500056e-01 1 1  ON 37
eH1_8                 1.575366e-01 1 1  ON 38
eH1_9                 4.047287e-02 1 1  ON 39
eH2_0                -2.371393e-01 1 1  ON 40
eH2_1                -1.345293e-01 1 1  ON 41
eH2_2                -9.153231e-02 1 1  ON 42
eH2_3                -3.970040e-02 1 1  ON 43
eH2_4                 1.528156e-02 1 1  ON 44
eH2_5                 5.210423e-02 1 1  ON 45
eH2_6                 1.077761e-01 1 1  ON 46
eH2_7                 1.542365e-01 1 1  ON 47
eH2_8                 1.654722e-01 1 1  ON 48
eH2_9                 2.573194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9527
    reference variance = 0.221532
====================================================
  Execution time = 2.5540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.6646e-01
  Total weights = 2.0000e+06
  Execution time = 2.9523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366536989965
                                         uncertainty =       0.026174168078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366536989965
                                         uncertainty =       0.026174168078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428044097
  error estimate for blocks of size 2^( 2) =       0.000439502211
  error estimate for blocks of size 2^( 3) =       0.000451493280
  error estimate for blocks of size 2^( 4) =       0.000464169148
  error estimate for blocks of size 2^( 5) =       0.000476249163
  error estimate for blocks of size 2^( 6) =       0.000484404082
  error estimate for blocks of size 2^( 7) =       0.000492730969

      target function =                  N/A
              le_mean =     -16.911761526045
             les_mean =     286.374121229231
             stat err =       0.000479388340
             autocorr =       1.254289852516
              std dev =       0.605345767846
             le_variance =       0.366443498649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366584048252
                                         uncertainty =       0.026177272605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366584048252
                                         uncertainty =       0.026177272605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428071572
  error estimate for blocks of size 2^( 2) =       0.000439528473
  error estimate for blocks of size 2^( 3) =       0.000451517988
  error estimate for blocks of size 2^( 4) =       0.000464193010
  error estimate for blocks of size 2^( 5) =       0.000476271917
  error estimate for blocks of size 2^( 6) =       0.000484427113
  error estimate for blocks of size 2^( 7) =       0.000492753846

      target function =                  N/A
              le_mean =     -16.911761871586
             les_mean =     286.374179959270
             stat err =       0.000479411471
             autocorr =       1.254249881507
              std dev =       0.605384622604
             le_variance =       0.366490541285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366562059671
                                         uncertainty =       0.026175832837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366562059671
                                         uncertainty =       0.026175832837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428058734
  error estimate for blocks of size 2^( 2) =       0.000439516193
  error estimate for blocks of size 2^( 3) =       0.000451506427
  error estimate for blocks of size 2^( 4) =       0.000464181851
  error estimate for blocks of size 2^( 5) =       0.000476261289
  error estimate for blocks of size 2^( 6) =       0.000484416381
  error estimate for blocks of size 2^( 7) =       0.000492743201

      target function =                  N/A
              le_mean =     -16.911761711490
             les_mean =     286.374152563184
             stat err =       0.000479400681
             autocorr =       1.254268646638
              std dev =       0.605366467673
             le_variance =       0.366468560183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366540175129
                                         uncertainty =       0.026174380134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366540175129
                                         uncertainty =       0.026174380134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428045957
  error estimate for blocks of size 2^( 2) =       0.000439503987
  error estimate for blocks of size 2^( 3) =       0.000451494950
  error estimate for blocks of size 2^( 4) =       0.000464170762
  error estimate for blocks of size 2^( 5) =       0.000476250703
  error estimate for blocks of size 2^( 6) =       0.000484405645
  error estimate for blocks of size 2^( 7) =       0.000492732524

      target function =                  N/A
              le_mean =     -16.911761549480
             les_mean =     286.374125206028
             stat err =       0.000479389909
             autocorr =       1.254287159890
              std dev =       0.605348397849
             le_variance =       0.366446682778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911761526045        initial
     3.7253e+00     3.7253e+01             6.7231e-05       -16.911761871586  <--
     1.4901e+01     1.4901e+02             1.6822e-05       -16.911761711490
     5.9605e+01     5.9605e+02             4.2070e-06       -16.911761549480

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 4.0378e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082689e-01 1 1  ON 0
 uu_1                 1.432179e-01 1 1  ON 1
 uu_2                 4.486407e-02 1 1  ON 2
 uu_3                -1.727640e-02 1 1  ON 3
 uu_4                -6.453876e-02 1 1  ON 4
 uu_5                -9.879847e-02 1 1  ON 5
 uu_6                -1.247063e-01 1 1  ON 6
 uu_7                -1.363307e-01 1 1  ON 7
 uu_8                -1.268556e-01 1 1  ON 8
 uu_9                -9.794070e-02 1 1  ON 9
 ud_0                 4.276000e-01 1 1  ON 10
 ud_1                 1.723032e-01 1 1  ON 11
 ud_2                 6.143387e-02 1 1  ON 12
 ud_3                -5.215873e-03 1 1  ON 13
 ud_4                -5.999589e-02 1 1  ON 14
 ud_5                -1.016719e-01 1 1  ON 15
 ud_6                -1.301135e-01 1 1  ON 16
 ud_7                -1.479038e-01 1 1  ON 17
 ud_8                -1.496652e-01 1 1  ON 18
 ud_9                -1.387145e-01 1 1  ON 19
 eO_0                -7.414003e-01 1 1  ON 20
 eO_1                -4.287257e-01 1 1  ON 21
 eO_2                -1.819710e-02 1 1  ON 22
 eO_3                 2.945451e-01 1 1  ON 23
 eO_4                 5.115978e-01 1 1  ON 24
 eO_5                 4.670635e-01 1 1  ON 25
 eO_6                 2.379152e-01 1 1  ON 26
 eO_7                -5.355733e-02 1 1  ON 27
 eO_8                -2.055714e-01 1 1  ON 28
 eO_9                -6.543228e-02 1 1  ON 29
eH1_0                -2.383600e-01 1 1  ON 30
eH1_1                -1.357519e-01 1 1  ON 31
eH1_2                -9.294928e-02 1 1  ON 32
eH1_3                -4.177129e-02 1 1  ON 33
eH1_4                 1.356445e-02 1 1  ON 34
eH1_5                 4.899127e-02 1 1  ON 35
eH1_6                 1.038267e-01 1 1  ON 36
eH1_7                 1.500366e-01 1 1  ON 37
eH1_8                 1.575801e-01 1 1  ON 38
eH1_9                 4.050696e-02 1 1  ON 39
eH2_0                -2.371682e-01 1 1  ON 40
eH2_1                -1.345298e-01 1 1  ON 41
eH2_2                -9.155141e-02 1 1  ON 42
eH2_3                -3.974039e-02 1 1  ON 43
eH2_4                 1.527980e-02 1 1  ON 44
eH2_5                 5.207791e-02 1 1  ON 45
eH2_6                 1.077751e-01 1 1  ON 46
eH2_7                 1.542534e-01 1 1  ON 47
eH2_8                 1.655150e-01 1 1  ON 48
eH2_9                 2.578235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.223292
====================================================
  Execution time = 2.6265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432674192
                                         uncertainty =       0.007781158652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432674192
                                         uncertainty =       0.007781158652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411331665
  error estimate for blocks of size 2^( 2) =       0.000423096097
  error estimate for blocks of size 2^( 3) =       0.000435754342
  error estimate for blocks of size 2^( 4) =       0.000447164741
  error estimate for blocks of size 2^( 5) =       0.000459528221
  error estimate for blocks of size 2^( 6) =       0.000468685059
  error estimate for blocks of size 2^( 7) =       0.000472927641

      target function =                  N/A
              le_mean =     -16.910527383007
             les_mean =     286.304323679286
             stat err =       0.000462076416
             autocorr =       1.261953401319
              std dev =       0.581710819082
             le_variance =       0.338387477037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691052738301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910527383007       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910528506199       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910528771654       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910529024558       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910529245096       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910529436843       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910529319589       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910529213790       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 2.929024e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910527383007       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910527704096       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910527790547       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910527858739       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910527964086       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910527973218       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910527955636       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910527928580       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 7.354490e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910527383007       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910527466266       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910527489608       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910527506976       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910527536008       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910527534745       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910527533294       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910527526978       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.840228e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2865e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082948e-01 1 1  ON 0
 uu_1                 1.432172e-01 1 1  ON 1
 uu_2                 4.488315e-02 1 1  ON 2
 uu_3                -1.727078e-02 1 1  ON 3
 uu_4                -6.454656e-02 1 1  ON 4
 uu_5                -9.880835e-02 1 1  ON 5
 uu_6                -1.246950e-01 1 1  ON 6
 uu_7                -1.363606e-01 1 1  ON 7
 uu_8                -1.269057e-01 1 1  ON 8
 uu_9                -9.795365e-02 1 1  ON 9
 ud_0                 4.276597e-01 1 1  ON 10
 ud_1                 1.723056e-01 1 1  ON 11
 ud_2                 6.145047e-02 1 1  ON 12
 ud_3                -5.223924e-03 1 1  ON 13
 ud_4                -5.999536e-02 1 1  ON 14
 ud_5                -1.016994e-01 1 1  ON 15
 ud_6                -1.301110e-01 1 1  ON 16
 ud_7                -1.479047e-01 1 1  ON 17
 ud_8                -1.496896e-01 1 1  ON 18
 ud_9                -1.387202e-01 1 1  ON 19
 eO_0                -7.414613e-01 1 1  ON 20
 eO_1                -4.287701e-01 1 1  ON 21
 eO_2                -1.820548e-02 1 1  ON 22
 eO_3                 2.945923e-01 1 1  ON 23
 eO_4                 5.116668e-01 1 1  ON 24
 eO_5                 4.671159e-01 1 1  ON 25
 eO_6                 2.379481e-01 1 1  ON 26
 eO_7                -5.356116e-02 1 1  ON 27
 eO_8                -2.056186e-01 1 1  ON 28
 eO_9                -6.546535e-02 1 1  ON 29
eH1_0                -2.383941e-01 1 1  ON 30
eH1_1                -1.357556e-01 1 1  ON 31
eH1_2                -9.299999e-02 1 1  ON 32
eH1_3                -4.179652e-02 1 1  ON 33
eH1_4                 1.352515e-02 1 1  ON 34
eH1_5                 4.900232e-02 1 1  ON 35
eH1_6                 1.038639e-01 1 1  ON 36
eH1_7                 1.500696e-01 1 1  ON 37
eH1_8                 1.576196e-01 1 1  ON 38
eH1_9                 4.053894e-02 1 1  ON 39
eH2_0                -2.372402e-01 1 1  ON 40
eH2_1                -1.345476e-01 1 1  ON 41
eH2_2                -9.156468e-02 1 1  ON 42
eH2_3                -3.979207e-02 1 1  ON 43
eH2_4                 1.523656e-02 1 1  ON 44
eH2_5                 5.207386e-02 1 1  ON 45
eH2_6                 1.077925e-01 1 1  ON 46
eH2_7                 1.542963e-01 1 1  ON 47
eH2_8                 1.655885e-01 1 1  ON 48
eH2_9                 2.584826e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9569
    reference variance = 0.245269
====================================================
  Execution time = 2.5464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3269e-01
  Total weights = 2.0000e+06
  Execution time = 2.9571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332766781778
                                         uncertainty =       0.004102771979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332766781778
                                         uncertainty =       0.004102771979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407831422
  error estimate for blocks of size 2^( 2) =       0.000422994430
  error estimate for blocks of size 2^( 3) =       0.000441678287
  error estimate for blocks of size 2^( 4) =       0.000465566920
  error estimate for blocks of size 2^( 5) =       0.000499037851
  error estimate for blocks of size 2^( 6) =       0.000546521224
  error estimate for blocks of size 2^( 7) =       0.000616852998

      target function =                  N/A
              le_mean =     -16.910798932718
             les_mean =     286.307773313859
             stat err =       0.000531994748
             autocorr =       1.701583725694
              std dev =       0.576760728011
             le_variance =       0.332652937376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332888200064
                                         uncertainty =       0.004103526360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332888200064
                                         uncertainty =       0.004103526360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905804
  error estimate for blocks of size 2^( 2) =       0.000423065720
  error estimate for blocks of size 2^( 3) =       0.000441745219
  error estimate for blocks of size 2^( 4) =       0.000465628438
  error estimate for blocks of size 2^( 5) =       0.000499093059
  error estimate for blocks of size 2^( 6) =       0.000546568546
  error estimate for blocks of size 2^( 7) =       0.000616889019

      target function =                  N/A
              le_mean =     -16.910798864621
             les_mean =     286.307892362696
             stat err =       0.000532044765
             autocorr =       1.701283069278
              std dev =       0.576865919781
             le_variance =       0.332774289405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841545301
                                         uncertainty =       0.004103266552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841545301
                                         uncertainty =       0.004103266552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407877221
  error estimate for blocks of size 2^( 2) =       0.000423038284
  error estimate for blocks of size 2^( 3) =       0.000441719526
  error estimate for blocks of size 2^( 4) =       0.000465605061
  error estimate for blocks of size 2^( 5) =       0.000499072280
  error estimate for blocks of size 2^( 6) =       0.000546550847
  error estimate for blocks of size 2^( 7) =       0.000616875619

      target function =                  N/A
              le_mean =     -16.910798820158
             les_mean =     286.307844224246
             stat err =       0.000532025952
             autocorr =       1.701401186273
              std dev =       0.576825497672
             le_variance =       0.332727654765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776669856
                                         uncertainty =       0.004102838070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776669856
                                         uncertainty =       0.004102838070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407837479
  error estimate for blocks of size 2^( 2) =       0.000423000228
  error estimate for blocks of size 2^( 3) =       0.000441683740
  error estimate for blocks of size 2^( 4) =       0.000465571971
  error estimate for blocks of size 2^( 5) =       0.000499042414
  error estimate for blocks of size 2^( 6) =       0.000546525148
  error estimate for blocks of size 2^( 7) =       0.000616855984

      target function =                  N/A
              le_mean =     -16.910798912840
             les_mean =     286.307782523289
             stat err =       0.000531998879
             autocorr =       1.701559604997
              std dev =       0.576769294521
             le_variance =       0.332662819103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910798932718        initial  <--
     9.3132e-01     9.3132e+00             2.9290e-04       -16.910798864621
     3.7253e+00     3.7253e+01             7.3545e-05       -16.910798820158
     1.4901e+01     1.4901e+02             1.8402e-05       -16.910798912840

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3027
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082689e-01 1 1  ON 0
 uu_1                 1.432179e-01 1 1  ON 1
 uu_2                 4.486407e-02 1 1  ON 2
 uu_3                -1.727640e-02 1 1  ON 3
 uu_4                -6.453876e-02 1 1  ON 4
 uu_5                -9.879847e-02 1 1  ON 5
 uu_6                -1.247063e-01 1 1  ON 6
 uu_7                -1.363307e-01 1 1  ON 7
 uu_8                -1.268556e-01 1 1  ON 8
 uu_9                -9.794070e-02 1 1  ON 9
 ud_0                 4.276000e-01 1 1  ON 10
 ud_1                 1.723032e-01 1 1  ON 11
 ud_2                 6.143387e-02 1 1  ON 12
 ud_3                -5.215873e-03 1 1  ON 13
 ud_4                -5.999589e-02 1 1  ON 14
 ud_5                -1.016719e-01 1 1  ON 15
 ud_6                -1.301135e-01 1 1  ON 16
 ud_7                -1.479038e-01 1 1  ON 17
 ud_8                -1.496652e-01 1 1  ON 18
 ud_9                -1.387145e-01 1 1  ON 19
 eO_0                -7.414003e-01 1 1  ON 20
 eO_1                -4.287257e-01 1 1  ON 21
 eO_2                -1.819710e-02 1 1  ON 22
 eO_3                 2.945451e-01 1 1  ON 23
 eO_4                 5.115978e-01 1 1  ON 24
 eO_5                 4.670635e-01 1 1  ON 25
 eO_6                 2.379152e-01 1 1  ON 26
 eO_7                -5.355733e-02 1 1  ON 27
 eO_8                -2.055714e-01 1 1  ON 28
 eO_9                -6.543228e-02 1 1  ON 29
eH1_0                -2.383600e-01 1 1  ON 30
eH1_1                -1.357519e-01 1 1  ON 31
eH1_2                -9.294928e-02 1 1  ON 32
eH1_3                -4.177129e-02 1 1  ON 33
eH1_4                 1.356445e-02 1 1  ON 34
eH1_5                 4.899127e-02 1 1  ON 35
eH1_6                 1.038267e-01 1 1  ON 36
eH1_7                 1.500366e-01 1 1  ON 37
eH1_8                 1.575801e-01 1 1  ON 38
eH1_9                 4.050696e-02 1 1  ON 39
eH2_0                -2.371682e-01 1 1  ON 40
eH2_1                -1.345298e-01 1 1  ON 41
eH2_2                -9.155141e-02 1 1  ON 42
eH2_3                -3.974039e-02 1 1  ON 43
eH2_4                 1.527980e-02 1 1  ON 44
eH2_5                 5.207791e-02 1 1  ON 45
eH2_6                 1.077751e-01 1 1  ON 46
eH2_7                 1.542534e-01 1 1  ON 47
eH2_8                 1.655150e-01 1 1  ON 48
eH2_9                 2.578235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.259029
====================================================
  Execution time = 2.6070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3370e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772293535
                                         uncertainty =       0.003971794398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772293535
                                         uncertainty =       0.003971794398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471634
  error estimate for blocks of size 2^( 2) =       0.000420032708
  error estimate for blocks of size 2^( 3) =       0.000432378832
  error estimate for blocks of size 2^( 4) =       0.000444000838
  error estimate for blocks of size 2^( 5) =       0.000453616194
  error estimate for blocks of size 2^( 6) =       0.000461082986
  error estimate for blocks of size 2^( 7) =       0.000465825556

      target function =                  N/A
              le_mean =     -16.910925430834
             les_mean =     286.313096912050
             stat err =       0.000456131394
             autocorr =       1.246970336350
              std dev =       0.577666124748
             le_variance =       0.333698151682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691092543083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925430834       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925418625       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925442388       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925453383       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925454260       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925484993       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925459937       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910925472920       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.427793e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925430834       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925427747       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925433694       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925436167       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925435822       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925443275       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925437219       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.951807e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910925430834       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910925430060       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910925431547       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910925432147       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910925432023       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910925433871       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910925432370       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.488954e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2641e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082713e-01 1 1  ON 0
 uu_1                 1.432197e-01 1 1  ON 1
 uu_2                 4.486418e-02 1 1  ON 2
 uu_3                -1.727357e-02 1 1  ON 3
 uu_4                -6.454138e-02 1 1  ON 4
 uu_5                -9.879827e-02 1 1  ON 5
 uu_6                -1.247087e-01 1 1  ON 6
 uu_7                -1.363337e-01 1 1  ON 7
 uu_8                -1.268586e-01 1 1  ON 8
 uu_9                -9.794213e-02 1 1  ON 9
 ud_0                 4.276054e-01 1 1  ON 10
 ud_1                 1.723024e-01 1 1  ON 11
 ud_2                 6.143566e-02 1 1  ON 12
 ud_3                -5.215012e-03 1 1  ON 13
 ud_4                -5.999773e-02 1 1  ON 14
 ud_5                -1.016703e-01 1 1  ON 15
 ud_6                -1.301121e-01 1 1  ON 16
 ud_7                -1.479052e-01 1 1  ON 17
 ud_8                -1.496677e-01 1 1  ON 18
 ud_9                -1.387160e-01 1 1  ON 19
 eO_0                -7.414037e-01 1 1  ON 20
 eO_1                -4.287268e-01 1 1  ON 21
 eO_2                -1.819956e-02 1 1  ON 22
 eO_3                 2.945475e-01 1 1  ON 23
 eO_4                 5.116022e-01 1 1  ON 24
 eO_5                 4.670677e-01 1 1  ON 25
 eO_6                 2.379194e-01 1 1  ON 26
 eO_7                -5.355635e-02 1 1  ON 27
 eO_8                -2.055761e-01 1 1  ON 28
 eO_9                -6.543615e-02 1 1  ON 29
eH1_0                -2.383657e-01 1 1  ON 30
eH1_1                -1.357562e-01 1 1  ON 31
eH1_2                -9.295023e-02 1 1  ON 32
eH1_3                -4.177644e-02 1 1  ON 33
eH1_4                 1.356364e-02 1 1  ON 34
eH1_5                 4.899121e-02 1 1  ON 35
eH1_6                 1.038286e-01 1 1  ON 36
eH1_7                 1.500406e-01 1 1  ON 37
eH1_8                 1.575860e-01 1 1  ON 38
eH1_9                 4.051194e-02 1 1  ON 39
eH2_0                -2.371742e-01 1 1  ON 40
eH2_1                -1.345329e-01 1 1  ON 41
eH2_2                -9.155599e-02 1 1  ON 42
eH2_3                -3.974094e-02 1 1  ON 43
eH2_4                 1.527906e-02 1 1  ON 44
eH2_5                 5.207819e-02 1 1  ON 45
eH2_6                 1.077795e-01 1 1  ON 46
eH2_7                 1.542544e-01 1 1  ON 47
eH2_8                 1.655189e-01 1 1  ON 48
eH2_9                 2.578748e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.218167
====================================================
  Execution time = 2.5423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.0000e+06
  Execution time = 2.9576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332459654787
                                         uncertainty =       0.003177172213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332459654787
                                         uncertainty =       0.003177172213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613760
  error estimate for blocks of size 2^( 2) =       0.000419662847
  error estimate for blocks of size 2^( 3) =       0.000431959882
  error estimate for blocks of size 2^( 4) =       0.000443072992
  error estimate for blocks of size 2^( 5) =       0.000452081754
  error estimate for blocks of size 2^( 6) =       0.000459107585
  error estimate for blocks of size 2^( 7) =       0.000462570957

      target function =                  N/A
              le_mean =     -16.911084632637
             les_mean =     286.317081240887
             stat err =       0.000454208322
             autocorr =       1.241688049688
              std dev =       0.576452907711
             le_variance =       0.332297954809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332473847550
                                         uncertainty =       0.003177294411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332473847550
                                         uncertainty =       0.003177294411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407622463
  error estimate for blocks of size 2^( 2) =       0.000419671192
  error estimate for blocks of size 2^( 3) =       0.000431967937
  error estimate for blocks of size 2^( 4) =       0.000443080789
  error estimate for blocks of size 2^( 5) =       0.000452089478
  error estimate for blocks of size 2^( 6) =       0.000459115187
  error estimate for blocks of size 2^( 7) =       0.000462577661

      target function =                  N/A
              le_mean =     -16.911084705705
             les_mean =     286.317097902055
             stat err =       0.000454215779
             autocorr =       1.241675796395
              std dev =       0.576465215514
             le_variance =       0.332312144697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332467303020
                                         uncertainty =       0.003177236539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332467303020
                                         uncertainty =       0.003177236539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407618450
  error estimate for blocks of size 2^( 2) =       0.000419667346
  error estimate for blocks of size 2^( 3) =       0.000431964231
  error estimate for blocks of size 2^( 4) =       0.000443077210
  error estimate for blocks of size 2^( 5) =       0.000452085942
  error estimate for blocks of size 2^( 6) =       0.000459111709
  error estimate for blocks of size 2^( 7) =       0.000462574577

      target function =                  N/A
              le_mean =     -16.911084670426
             les_mean =     286.317090165636
             stat err =       0.000454212360
             autocorr =       1.241681552180
              std dev =       0.576459540199
             le_variance =       0.332305601487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332460619195
                                         uncertainty =       0.003177180333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332460619195
                                         uncertainty =       0.003177180333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407614351
  error estimate for blocks of size 2^( 2) =       0.000419663414
  error estimate for blocks of size 2^( 3) =       0.000431960431
  error estimate for blocks of size 2^( 4) =       0.000443073524
  error estimate for blocks of size 2^( 5) =       0.000452082282
  error estimate for blocks of size 2^( 6) =       0.000459108105
  error estimate for blocks of size 2^( 7) =       0.000462571413

      target function =                  N/A
              le_mean =     -16.911084637357
             les_mean =     286.317082364727
             stat err =       0.000454208831
             autocorr =       1.241687231479
              std dev =       0.576453744043
             le_variance =       0.332298919021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911084632637        initial
     9.3132e+00     9.3132e+01             2.4278e-05       -16.911084705705  <--
     3.7253e+01     3.7253e+02             5.9518e-06       -16.911084670426
     1.4901e+02     1.4901e+03             1.4890e-06       -16.911084637357

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.0255e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082783e-01 1 1  ON 0
 uu_1                 1.432243e-01 1 1  ON 1
 uu_2                 4.486538e-02 1 1  ON 2
 uu_3                -1.726603e-02 1 1  ON 3
 uu_4                -6.454914e-02 1 1  ON 4
 uu_5                -9.879823e-02 1 1  ON 5
 uu_6                -1.247156e-01 1 1  ON 6
 uu_7                -1.363424e-01 1 1  ON 7
 uu_8                -1.268678e-01 1 1  ON 8
 uu_9                -9.794648e-02 1 1  ON 9
 ud_0                 4.276204e-01 1 1  ON 10
 ud_1                 1.723009e-01 1 1  ON 11
 ud_2                 6.144043e-02 1 1  ON 12
 ud_3                -5.212263e-03 1 1  ON 13
 ud_4                -6.000228e-02 1 1  ON 14
 ud_5                -1.016657e-01 1 1  ON 15
 ud_6                -1.301080e-01 1 1  ON 16
 ud_7                -1.479091e-01 1 1  ON 17
 ud_8                -1.496750e-01 1 1  ON 18
 ud_9                -1.387207e-01 1 1  ON 19
 eO_0                -7.414141e-01 1 1  ON 20
 eO_1                -4.287309e-01 1 1  ON 21
 eO_2                -1.820607e-02 1 1  ON 22
 eO_3                 2.945543e-01 1 1  ON 23
 eO_4                 5.116152e-01 1 1  ON 24
 eO_5                 4.670806e-01 1 1  ON 25
 eO_6                 2.379328e-01 1 1  ON 26
 eO_7                -5.355309e-02 1 1  ON 27
 eO_8                -2.055903e-01 1 1  ON 28
 eO_9                -6.544813e-02 1 1  ON 29
eH1_0                -2.383828e-01 1 1  ON 30
eH1_1                -1.357688e-01 1 1  ON 31
eH1_2                -9.295280e-02 1 1  ON 32
eH1_3                -4.179139e-02 1 1  ON 33
eH1_4                 1.355943e-02 1 1  ON 34
eH1_5                 4.899031e-02 1 1  ON 35
eH1_6                 1.038345e-01 1 1  ON 36
eH1_7                 1.500531e-01 1 1  ON 37
eH1_8                 1.576044e-01 1 1  ON 38
eH1_9                 4.052742e-02 1 1  ON 39
eH2_0                -2.371921e-01 1 1  ON 40
eH2_1                -1.345426e-01 1 1  ON 41
eH2_2                -9.156963e-02 1 1  ON 42
eH2_3                -3.974341e-02 1 1  ON 43
eH2_4                 1.527710e-02 1 1  ON 44
eH2_5                 5.207881e-02 1 1  ON 45
eH2_6                 1.077927e-01 1 1  ON 46
eH2_7                 1.542575e-01 1 1  ON 47
eH2_8                 1.655311e-01 1 1  ON 48
eH2_9                 2.580346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.0015
    reference variance = 0.222143
====================================================
  Execution time = 2.5864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3366e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333714996581
                                         uncertainty =       0.004958312629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333714996581
                                         uncertainty =       0.004958312629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408448040
  error estimate for blocks of size 2^( 2) =       0.000420134386
  error estimate for blocks of size 2^( 3) =       0.000432789997
  error estimate for blocks of size 2^( 4) =       0.000445021361
  error estimate for blocks of size 2^( 5) =       0.000456696805
  error estimate for blocks of size 2^( 6) =       0.000466111080
  error estimate for blocks of size 2^( 7) =       0.000473788907

      target function =                  N/A
              le_mean =     -16.910307174372
             les_mean =     286.292148166817
             stat err =       0.000460404538
             autocorr =       1.270590369861
              std dev =       0.577632757053
             le_variance =       0.333659602020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691030717437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910307174372       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910307180942       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910307429526       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910307336071       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910307423056       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910307551419       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910307596910       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910307611775       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.186897e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910307174372       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910307176098       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910307241541       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910307216803       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910307244546       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910307271313       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910307279986       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910307285517       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 3.056174e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910307174372       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910307174809       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910307191388       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910307185123       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910307192499       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910307198853       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910307200793       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910307202299       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 7.701251e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2501e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082769e-01 1 1  ON 0
 uu_1                 1.432350e-01 1 1  ON 1
 uu_2                 4.487740e-02 1 1  ON 2
 uu_3                -1.726793e-02 1 1  ON 3
 uu_4                -6.454153e-02 1 1  ON 4
 uu_5                -9.881526e-02 1 1  ON 5
 uu_6                -1.247267e-01 1 1  ON 6
 uu_7                -1.363428e-01 1 1  ON 7
 uu_8                -1.268698e-01 1 1  ON 8
 uu_9                -9.795392e-02 1 1  ON 9
 ud_0                 4.276395e-01 1 1  ON 10
 ud_1                 1.722898e-01 1 1  ON 11
 ud_2                 6.143986e-02 1 1  ON 12
 ud_3                -5.217986e-03 1 1  ON 13
 ud_4                -5.999901e-02 1 1  ON 14
 ud_5                -1.016694e-01 1 1  ON 15
 ud_6                -1.300999e-01 1 1  ON 16
 ud_7                -1.479128e-01 1 1  ON 17
 ud_8                -1.496783e-01 1 1  ON 18
 ud_9                -1.387218e-01 1 1  ON 19
 eO_0                -7.414447e-01 1 1  ON 20
 eO_1                -4.287375e-01 1 1  ON 21
 eO_2                -1.820556e-02 1 1  ON 22
 eO_3                 2.945702e-01 1 1  ON 23
 eO_4                 5.116348e-01 1 1  ON 24
 eO_5                 4.670996e-01 1 1  ON 25
 eO_6                 2.379327e-01 1 1  ON 26
 eO_7                -5.354343e-02 1 1  ON 27
 eO_8                -2.056003e-01 1 1  ON 28
 eO_9                -6.546297e-02 1 1  ON 29
eH1_0                -2.384067e-01 1 1  ON 30
eH1_1                -1.357864e-01 1 1  ON 31
eH1_2                -9.297221e-02 1 1  ON 32
eH1_3                -4.179730e-02 1 1  ON 33
eH1_4                 1.354097e-02 1 1  ON 34
eH1_5                 4.898297e-02 1 1  ON 35
eH1_6                 1.038515e-01 1 1  ON 36
eH1_7                 1.500807e-01 1 1  ON 37
eH1_8                 1.576325e-01 1 1  ON 38
eH1_9                 4.054832e-02 1 1  ON 39
eH2_0                -2.372221e-01 1 1  ON 40
eH2_1                -1.345512e-01 1 1  ON 41
eH2_2                -9.157043e-02 1 1  ON 42
eH2_3                -3.976220e-02 1 1  ON 43
eH2_4                 1.527457e-02 1 1  ON 44
eH2_5                 5.207188e-02 1 1  ON 45
eH2_6                 1.078097e-01 1 1  ON 46
eH2_7                 1.542676e-01 1 1  ON 47
eH2_8                 1.655455e-01 1 1  ON 48
eH2_9                 2.582702e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.306888
====================================================
  Execution time = 2.5391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3914e-01
  Total weights = 2.0000e+06
  Execution time = 2.9551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339211517484
                                         uncertainty =       0.004903514430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339211517484
                                         uncertainty =       0.004903514430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411781437
  error estimate for blocks of size 2^( 2) =       0.000423185749
  error estimate for blocks of size 2^( 3) =       0.000434558459
  error estimate for blocks of size 2^( 4) =       0.000446432006
  error estimate for blocks of size 2^( 5) =       0.000455680197
  error estimate for blocks of size 2^( 6) =       0.000463356617
  error estimate for blocks of size 2^( 7) =       0.000467579809

      target function =                  N/A
              le_mean =     -16.910568682582
             les_mean =     286.306460901723
             stat err =       0.000458262157
             autocorr =       1.238495580995
              std dev =       0.582346892293
             le_variance =       0.339127902963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339269632652
                                         uncertainty =       0.004905308938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339269632652
                                         uncertainty =       0.004905308938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411816695
  error estimate for blocks of size 2^( 2) =       0.000423219619
  error estimate for blocks of size 2^( 3) =       0.000434591642
  error estimate for blocks of size 2^( 4) =       0.000446463872
  error estimate for blocks of size 2^( 5) =       0.000455711337
  error estimate for blocks of size 2^( 6) =       0.000463387370
  error estimate for blocks of size 2^( 7) =       0.000467606931

      target function =                  N/A
              le_mean =     -16.910568755166
             les_mean =     286.306521434378
             stat err =       0.000458292378
             autocorr =       1.238446842027
              std dev =       0.582396755470
             le_variance =       0.339185980781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339244287599
                                         uncertainty =       0.004904503114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339244287599
                                         uncertainty =       0.004904503114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411801319
  error estimate for blocks of size 2^( 2) =       0.000423204813
  error estimate for blocks of size 2^( 3) =       0.000434577149
  error estimate for blocks of size 2^( 4) =       0.000446449989
  error estimate for blocks of size 2^( 5) =       0.000455697817
  error estimate for blocks of size 2^( 6) =       0.000463374103
  error estimate for blocks of size 2^( 7) =       0.000467595244

      target function =                  N/A
              le_mean =     -16.910568732919
             les_mean =     286.306495353179
             stat err =       0.000458279288
             autocorr =       1.238468582313
              std dev =       0.582375009755
             le_variance =       0.339160651987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339215743451
                                         uncertainty =       0.004903641386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339215743451
                                         uncertainty =       0.004903641386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411784001
  error estimate for blocks of size 2^( 2) =       0.000423188206
  error estimate for blocks of size 2^( 3) =       0.000434560868
  error estimate for blocks of size 2^( 4) =       0.000446434325
  error estimate for blocks of size 2^( 5) =       0.000455682470
  error estimate for blocks of size 2^( 6) =       0.000463358876
  error estimate for blocks of size 2^( 7) =       0.000467581803

      target function =                  N/A
              le_mean =     -16.910568688767
             les_mean =     286.306465334136
             stat err =       0.000458264369
             autocorr =       1.238492112837
              std dev =       0.582350518337
             le_variance =       0.339132126208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910568682582        initial
     2.3283e+00     2.3283e+01             1.1869e-04       -16.910568755166  <--
     9.3132e+00     9.3132e+01             3.0562e-05       -16.910568732919
     3.7253e+01     3.7253e+02             7.7013e-06       -16.910568688767

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 4.0226e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082767e-01 1 1  ON 0
 uu_1                 1.432671e-01 1 1  ON 1
 uu_2                 4.490811e-02 1 1  ON 2
 uu_3                -1.727036e-02 1 1  ON 3
 uu_4                -6.452499e-02 1 1  ON 4
 uu_5                -9.886091e-02 1 1  ON 5
 uu_6                -1.247606e-01 1 1  ON 6
 uu_7                -1.363457e-01 1 1  ON 7
 uu_8                -1.268755e-01 1 1  ON 8
 uu_9                -9.797578e-02 1 1  ON 9
 ud_0                 4.276865e-01 1 1  ON 10
 ud_1                 1.722650e-01 1 1  ON 11
 ud_2                 6.143785e-02 1 1  ON 12
 ud_3                -5.232036e-03 1 1  ON 13
 ud_4                -5.999121e-02 1 1  ON 14
 ud_5                -1.016783e-01 1 1  ON 15
 ud_6                -1.300774e-01 1 1  ON 16
 ud_7                -1.479238e-01 1 1  ON 17
 ud_8                -1.496877e-01 1 1  ON 18
 ud_9                -1.387251e-01 1 1  ON 19
 eO_0                -7.415328e-01 1 1  ON 20
 eO_1                -4.287609e-01 1 1  ON 21
 eO_2                -1.820338e-02 1 1  ON 22
 eO_3                 2.946168e-01 1 1  ON 23
 eO_4                 5.116944e-01 1 1  ON 24
 eO_5                 4.671565e-01 1 1  ON 25
 eO_6                 2.379319e-01 1 1  ON 26
 eO_7                -5.351474e-02 1 1  ON 27
 eO_8                -2.056301e-01 1 1  ON 28
 eO_9                -6.550720e-02 1 1  ON 29
eH1_0                -2.384775e-01 1 1  ON 30
eH1_1                -1.358400e-01 1 1  ON 31
eH1_2                -9.302863e-02 1 1  ON 32
eH1_3                -4.181751e-02 1 1  ON 33
eH1_4                 1.348716e-02 1 1  ON 34
eH1_5                 4.896085e-02 1 1  ON 35
eH1_6                 1.039024e-01 1 1  ON 36
eH1_7                 1.501635e-01 1 1  ON 37
eH1_8                 1.577165e-01 1 1  ON 38
eH1_9                 4.061072e-02 1 1  ON 39
eH2_0                -2.373100e-01 1 1  ON 40
eH2_1                -1.345770e-01 1 1  ON 41
eH2_2                -9.157556e-02 1 1  ON 42
eH2_3                -3.981585e-02 1 1  ON 43
eH2_4                 1.526511e-02 1 1  ON 44
eH2_5                 5.205176e-02 1 1  ON 45
eH2_6                 1.078605e-01 1 1  ON 46
eH2_7                 1.542977e-01 1 1  ON 47
eH2_8                 1.655883e-01 1 1  ON 48
eH2_9                 2.589732e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8923
    reference variance = 0.311626
====================================================
  Execution time = 2.8161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5018e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350271596894
                                         uncertainty =       0.013121356398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350271596894
                                         uncertainty =       0.013121356398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418435407
  error estimate for blocks of size 2^( 2) =       0.000429980480
  error estimate for blocks of size 2^( 3) =       0.000442215159
  error estimate for blocks of size 2^( 4) =       0.000453105508
  error estimate for blocks of size 2^( 5) =       0.000463638700
  error estimate for blocks of size 2^( 6) =       0.000470880834
  error estimate for blocks of size 2^( 7) =       0.000478493087

      target function =                  N/A
              le_mean =     -16.910506882584
             les_mean =     286.315419230046
             stat err =       0.000466529532
             autocorr =       1.243086725739
              std dev =       0.591757027168
             le_variance =       0.350176379203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691050688258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910506882584       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910509994526       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910509248983       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910509451883       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910509433046       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910509604745       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910509381504       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910509619429       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910509646760       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 4.505293e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910506882584       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910507909975       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910507706667       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910507729467       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910507765485       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910507699830       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910507687206       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910507737006       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.152182e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910506882584       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910507161810       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910507113975       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910507114906       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910507125994       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910507102980       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910507104166       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910507114407       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.896899e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4773e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.082932e-01 1 1  ON 0
 uu_1                 1.433051e-01 1 1  ON 1
 uu_2                 4.495223e-02 1 1  ON 2
 uu_3                -1.727077e-02 1 1  ON 3
 uu_4                -6.453722e-02 1 1  ON 4
 uu_5                -9.886569e-02 1 1  ON 5
 uu_6                -1.247689e-01 1 1  ON 6
 uu_7                -1.363406e-01 1 1  ON 7
 uu_8                -1.269240e-01 1 1  ON 8
 uu_9                -9.804869e-02 1 1  ON 9
 ud_0                 4.277719e-01 1 1  ON 10
 ud_1                 1.723032e-01 1 1  ON 11
 ud_2                 6.148072e-02 1 1  ON 12
 ud_3                -5.224559e-03 1 1  ON 13
 ud_4                -5.997956e-02 1 1  ON 14
 ud_5                -1.016581e-01 1 1  ON 15
 ud_6                -1.300675e-01 1 1  ON 16
 ud_7                -1.478982e-01 1 1  ON 17
 ud_8                -1.497609e-01 1 1  ON 18
 ud_9                -1.388404e-01 1 1  ON 19
 eO_0                -7.416159e-01 1 1  ON 20
 eO_1                -4.288422e-01 1 1  ON 21
 eO_2                -1.815772e-02 1 1  ON 22
 eO_3                 2.946922e-01 1 1  ON 23
 eO_4                 5.117437e-01 1 1  ON 24
 eO_5                 4.672346e-01 1 1  ON 25
 eO_6                 2.380012e-01 1 1  ON 26
 eO_7                -5.350230e-02 1 1  ON 27
 eO_8                -2.057090e-01 1 1  ON 28
 eO_9                -6.558347e-02 1 1  ON 29
eH1_0                -2.385723e-01 1 1  ON 30
eH1_1                -1.358822e-01 1 1  ON 31
eH1_2                -9.311093e-02 1 1  ON 32
eH1_3                -4.187526e-02 1 1  ON 33
eH1_4                 1.342597e-02 1 1  ON 34
eH1_5                 4.898391e-02 1 1  ON 35
eH1_6                 1.039731e-01 1 1  ON 36
eH1_7                 1.502571e-01 1 1  ON 37
eH1_8                 1.578110e-01 1 1  ON 38
eH1_9                 4.066919e-02 1 1  ON 39
eH2_0                -2.373617e-01 1 1  ON 40
eH2_1                -1.346303e-01 1 1  ON 41
eH2_2                -9.157768e-02 1 1  ON 42
eH2_3                -3.988064e-02 1 1  ON 43
eH2_4                 1.526777e-02 1 1  ON 44
eH2_5                 5.204339e-02 1 1  ON 45
eH2_6                 1.079135e-01 1 1  ON 46
eH2_7                 1.543261e-01 1 1  ON 47
eH2_8                 1.656284e-01 1 1  ON 48
eH2_9                 2.595706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.132257
====================================================
  Execution time = 2.5487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3170e-01
  Total weights = 2.0000e+06
  Execution time = 2.9412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331732019964
                                         uncertainty =       0.007658288015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331732019964
                                         uncertainty =       0.007658288015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407230275
  error estimate for blocks of size 2^( 2) =       0.000419234423
  error estimate for blocks of size 2^( 3) =       0.000431750760
  error estimate for blocks of size 2^( 4) =       0.000443558404
  error estimate for blocks of size 2^( 5) =       0.000452592287
  error estimate for blocks of size 2^( 6) =       0.000460107929
  error estimate for blocks of size 2^( 7) =       0.000463042068

      target function =                  N/A
              le_mean =     -16.911150250450
             les_mean =     286.318675621195
             stat err =       0.000454825172
             autocorr =       1.247408988649
              std dev =       0.575910577890
             le_variance =       0.331672993726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331831066641
                                         uncertainty =       0.007660977958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331831066641
                                         uncertainty =       0.007660977958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407291080
  error estimate for blocks of size 2^( 2) =       0.000419292171
  error estimate for blocks of size 2^( 3) =       0.000431803325
  error estimate for blocks of size 2^( 4) =       0.000443606468
  error estimate for blocks of size 2^( 5) =       0.000452636878
  error estimate for blocks of size 2^( 6) =       0.000460150009
  error estimate for blocks of size 2^( 7) =       0.000463077205

      target function =                  N/A
              le_mean =     -16.911150418092
             les_mean =     286.318780345540
             stat err =       0.000454867640
             autocorr =       1.247269449587
              std dev =       0.575996569502
             le_variance =       0.331772048079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790776103
                                         uncertainty =       0.007660019891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790776103
                                         uncertainty =       0.007660019891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407266346
  error estimate for blocks of size 2^( 2) =       0.000419268905
  error estimate for blocks of size 2^( 3) =       0.000431782329
  error estimate for blocks of size 2^( 4) =       0.000443587424
  error estimate for blocks of size 2^( 5) =       0.000452619183
  error estimate for blocks of size 2^( 6) =       0.000460133528
  error estimate for blocks of size 2^( 7) =       0.000463062974

      target function =                  N/A
              le_mean =     -16.911150157979
             les_mean =     286.318731253464
             stat err =       0.000454850777
             autocorr =       1.247328465180
              std dev =       0.575961590397
             le_variance =       0.331731753612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331739729297
                                         uncertainty =       0.007658525151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331739729297
                                         uncertainty =       0.007658525151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407235008
  error estimate for blocks of size 2^( 2) =       0.000419238956
  error estimate for blocks of size 2^( 3) =       0.000431754915
  error estimate for blocks of size 2^( 4) =       0.000443562225
  error estimate for blocks of size 2^( 5) =       0.000452595824
  error estimate for blocks of size 2^( 6) =       0.000460111292
  error estimate for blocks of size 2^( 7) =       0.000463044788

      target function =                  N/A
              le_mean =     -16.911150225064
             les_mean =     286.318682472294
             stat err =       0.000454828532
             autocorr =       1.247398426815
              std dev =       0.575917271367
             le_variance =       0.331680703458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911150250450        initial
     5.8208e-01     5.8208e+00             4.5053e-04       -16.911150418092  <--
     2.3283e+00     2.3283e+01             1.1522e-04       -16.911150157979
     9.3132e+00     9.3132e+01             2.8969e-05       -16.911150225064

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 4.0292e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.083635e-01 1 1  ON 0
 uu_1                 1.434046e-01 1 1  ON 1
 uu_2                 4.504977e-02 1 1  ON 2
 uu_3                -1.724896e-02 1 1  ON 3
 uu_4                -6.457027e-02 1 1  ON 4
 uu_5                -9.888454e-02 1 1  ON 5
 uu_6                -1.248029e-01 1 1  ON 6
 uu_7                -1.363308e-01 1 1  ON 7
 uu_8                -1.270555e-01 1 1  ON 8
 uu_9                -9.826055e-02 1 1  ON 9
 ud_0                 4.279837e-01 1 1  ON 10
 ud_1                 1.724432e-01 1 1  ON 11
 ud_2                 6.159566e-02 1 1  ON 12
 ud_3                -5.183940e-03 1 1  ON 13
 ud_4                -5.994476e-02 1 1  ON 14
 ud_5                -1.016008e-01 1 1  ON 15
 ud_6                -1.300456e-01 1 1  ON 16
 ud_7                -1.478303e-01 1 1  ON 17
 ud_8                -1.499560e-01 1 1  ON 18
 ud_9                -1.391757e-01 1 1  ON 19
 eO_0                -7.418593e-01 1 1  ON 20
 eO_1                -4.290383e-01 1 1  ON 21
 eO_2                -1.806215e-02 1 1  ON 22
 eO_3                 2.948997e-01 1 1  ON 23
 eO_4                 5.118929e-01 1 1  ON 24
 eO_5                 4.674667e-01 1 1  ON 25
 eO_6                 2.382063e-01 1 1  ON 26
 eO_7                -5.346111e-02 1 1  ON 27
 eO_8                -2.059410e-01 1 1  ON 28
 eO_9                -6.581125e-02 1 1  ON 29
eH1_0                -2.388445e-01 1 1  ON 30
eH1_1                -1.360363e-01 1 1  ON 31
eH1_2                -9.333454e-02 1 1  ON 32
eH1_3                -4.205120e-02 1 1  ON 33
eH1_4                 1.325205e-02 1 1  ON 34
eH1_5                 4.904129e-02 1 1  ON 35
eH1_6                 1.041789e-01 1 1  ON 36
eH1_7                 1.505375e-01 1 1  ON 37
eH1_8                 1.580962e-01 1 1  ON 38
eH1_9                 4.084583e-02 1 1  ON 39
eH2_0                -2.375123e-01 1 1  ON 40
eH2_1                -1.347681e-01 1 1  ON 41
eH2_2                -9.162292e-02 1 1  ON 42
eH2_3                -4.004211e-02 1 1  ON 43
eH2_4                 1.524567e-02 1 1  ON 44
eH2_5                 5.202710e-02 1 1  ON 45
eH2_6                 1.080706e-01 1 1  ON 46
eH2_7                 1.544124e-01 1 1  ON 47
eH2_8                 1.657495e-01 1 1  ON 48
eH2_9                 2.613675e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9411
    reference variance = 0.304483
====================================================
  Execution time = 2.6163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3289e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332969700570
                                         uncertainty =       0.003760324812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332969700570
                                         uncertainty =       0.003760324812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407978116
  error estimate for blocks of size 2^( 2) =       0.000419858840
  error estimate for blocks of size 2^( 3) =       0.000432527334
  error estimate for blocks of size 2^( 4) =       0.000444764066
  error estimate for blocks of size 2^( 5) =       0.000456033008
  error estimate for blocks of size 2^( 6) =       0.000462847148
  error estimate for blocks of size 2^( 7) =       0.000469144862

      target function =                  N/A
              le_mean =     -16.910671960390
             les_mean =     286.303718271214
             stat err =       0.000458197271
             autocorr =       1.261337363390
              std dev =       0.576968184330
             le_variance =       0.332892285729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691067196039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910671960390       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910673843630       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910675497689       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910676334728       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910676914220       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910677910920       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910679429656       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910679067720       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910679467054       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910679485063       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910679599991       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 1.578048e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910671960390       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910672717118       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910673405922       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910673437779       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910673478349       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910673895717       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910673781446       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910673984808       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910673959017       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 4.563786e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910671960390       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910672183435       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910672377953       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910672343412       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910672332595       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910672431918       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910672428503       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910672444055       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.210080e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2791e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.085644e-01 1 1  ON 0
 uu_1                 1.434932e-01 1 1  ON 1
 uu_2                 4.512900e-02 1 1  ON 2
 uu_3                -1.726244e-02 1 1  ON 3
 uu_4                -6.462380e-02 1 1  ON 4
 uu_5                -9.908199e-02 1 1  ON 5
 uu_6                -1.249904e-01 1 1  ON 6
 uu_7                -1.364160e-01 1 1  ON 7
 uu_8                -1.271368e-01 1 1  ON 8
 uu_9                -9.833672e-02 1 1  ON 9
 ud_0                 4.280074e-01 1 1  ON 10
 ud_1                 1.726080e-01 1 1  ON 11
 ud_2                 6.166139e-02 1 1  ON 12
 ud_3                -5.026735e-03 1 1  ON 13
 ud_4                -5.989287e-02 1 1  ON 14
 ud_5                -1.016256e-01 1 1  ON 15
 ud_6                -1.300793e-01 1 1  ON 16
 ud_7                -1.478185e-01 1 1  ON 17
 ud_8                -1.501489e-01 1 1  ON 18
 ud_9                -1.393919e-01 1 1  ON 19
 eO_0                -7.421877e-01 1 1  ON 20
 eO_1                -4.290934e-01 1 1  ON 21
 eO_2                -1.806133e-02 1 1  ON 22
 eO_3                 2.949774e-01 1 1  ON 23
 eO_4                 5.121684e-01 1 1  ON 24
 eO_5                 4.676409e-01 1 1  ON 25
 eO_6                 2.384779e-01 1 1  ON 26
 eO_7                -5.327111e-02 1 1  ON 27
 eO_8                -2.062415e-01 1 1  ON 28
 eO_9                -6.607207e-02 1 1  ON 29
eH1_0                -2.390708e-01 1 1  ON 30
eH1_1                -1.364262e-01 1 1  ON 31
eH1_2                -9.350902e-02 1 1  ON 32
eH1_3                -4.213897e-02 1 1  ON 33
eH1_4                 1.303925e-02 1 1  ON 34
eH1_5                 4.910296e-02 1 1  ON 35
eH1_6                 1.043718e-01 1 1  ON 36
eH1_7                 1.507085e-01 1 1  ON 37
eH1_8                 1.584555e-01 1 1  ON 38
eH1_9                 4.117371e-02 1 1  ON 39
eH2_0                -2.379686e-01 1 1  ON 40
eH2_1                -1.349377e-01 1 1  ON 41
eH2_2                -9.189689e-02 1 1  ON 42
eH2_3                -4.032374e-02 1 1  ON 43
eH2_4                 1.512085e-02 1 1  ON 44
eH2_5                 5.207870e-02 1 1  ON 45
eH2_6                 1.083492e-01 1 1  ON 46
eH2_7                 1.546409e-01 1 1  ON 47
eH2_8                 1.661064e-01 1 1  ON 48
eH2_9                 2.650716e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.166441
====================================================
  Execution time = 2.5488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.0000e+06
  Execution time = 2.9701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341065886107
                                         uncertainty =       0.007545402219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341065886107
                                         uncertainty =       0.007545402219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413069541
  error estimate for blocks of size 2^( 2) =       0.000424683509
  error estimate for blocks of size 2^( 3) =       0.000436518671
  error estimate for blocks of size 2^( 4) =       0.000448250839
  error estimate for blocks of size 2^( 5) =       0.000458028665
  error estimate for blocks of size 2^( 6) =       0.000466727975
  error estimate for blocks of size 2^( 7) =       0.000475105524

      target function =                  N/A
              le_mean =     -16.910665385605
             les_mean =     286.311856504003
             stat err =       0.000462028251
             autocorr =       1.251096243367
              std dev =       0.584168546511
             le_variance =       0.341252890733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341156761875
                                         uncertainty =       0.007541073577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341156761875
                                         uncertainty =       0.007541073577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413124424
  error estimate for blocks of size 2^( 2) =       0.000424735203
  error estimate for blocks of size 2^( 3) =       0.000436563750
  error estimate for blocks of size 2^( 4) =       0.000448288759
  error estimate for blocks of size 2^( 5) =       0.000458059077
  error estimate for blocks of size 2^( 6) =       0.000466766246
  error estimate for blocks of size 2^( 7) =       0.000475147986

      target function =                  N/A
              le_mean =     -16.910665916334
             les_mean =     286.311965142131
             stat err =       0.000462065517
             autocorr =       1.250965625978
              std dev =       0.584246162956
             le_variance =       0.341343578928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341061363959
                                         uncertainty =       0.007540514496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341061363959
                                         uncertainty =       0.007540514496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413066683
  error estimate for blocks of size 2^( 2) =       0.000424679254
  error estimate for blocks of size 2^( 3) =       0.000436511364
  error estimate for blocks of size 2^( 4) =       0.000448241506
  error estimate for blocks of size 2^( 5) =       0.000458018075
  error estimate for blocks of size 2^( 6) =       0.000466726187
  error estimate for blocks of size 2^( 7) =       0.000475107050

      target function =                  N/A
              le_mean =     -16.910664520406
             les_mean =     286.311822519665
             stat err =       0.000462023205
             autocorr =       1.251086225539
              std dev =       0.584164504726
             le_variance =       0.341248168582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050365636
                                         uncertainty =       0.007544411046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050365636
                                         uncertainty =       0.007544411046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413060117
  error estimate for blocks of size 2^( 2) =       0.000424674150
  error estimate for blocks of size 2^( 3) =       0.000436509148
  error estimate for blocks of size 2^( 4) =       0.000448241315
  error estimate for blocks of size 2^( 5) =       0.000458019271
  error estimate for blocks of size 2^( 6) =       0.000466720105
  error estimate for blocks of size 2^( 7) =       0.000475098409

      target function =                  N/A
              le_mean =     -16.910665020294
             les_mean =     286.311828578543
             stat err =       0.000462019775
             autocorr =       1.251107424048
              std dev =       0.584155219582
             le_variance =       0.341237320565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910665385605        initial
     1.4552e-01     1.4552e+00             1.5780e-03       -16.910665916334  <--
     5.8208e-01     5.8208e+00             4.5638e-04       -16.910664520406
     2.3283e+00     2.3283e+01             1.2101e-04       -16.910665020294

*****************************************************************************
Applying the update for shift_i =   1.4552e-01     and shift_s =   1.4552e+00
*****************************************************************************

  Execution time = 4.0589e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.089438e-01 1 1  ON 0
 uu_1                 1.437420e-01 1 1  ON 1
 uu_2                 4.529314e-02 1 1  ON 2
 uu_3                -1.723780e-02 1 1  ON 3
 uu_4                -6.476122e-02 1 1  ON 4
 uu_5                -9.947160e-02 1 1  ON 5
 uu_6                -1.254202e-01 1 1  ON 6
 uu_7                -1.367776e-01 1 1  ON 7
 uu_8                -1.274008e-01 1 1  ON 8
 uu_9                -9.854894e-02 1 1  ON 9
 ud_0                 4.283078e-01 1 1  ON 10
 ud_1                 1.729894e-01 1 1  ON 11
 ud_2                 6.195797e-02 1 1  ON 12
 ud_3                -4.745760e-03 1 1  ON 13
 ud_4                -5.974799e-02 1 1  ON 14
 ud_5                -1.016685e-01 1 1  ON 15
 ud_6                -1.302174e-01 1 1  ON 16
 ud_7                -1.479322e-01 1 1  ON 17
 ud_8                -1.506233e-01 1 1  ON 18
 ud_9                -1.399953e-01 1 1  ON 19
 eO_0                -7.428644e-01 1 1  ON 20
 eO_1                -4.294110e-01 1 1  ON 21
 eO_2                -1.811772e-02 1 1  ON 22
 eO_3                 2.952681e-01 1 1  ON 23
 eO_4                 5.128354e-01 1 1  ON 24
 eO_5                 4.681953e-01 1 1  ON 25
 eO_6                 2.392507e-01 1 1  ON 26
 eO_7                -5.272190e-02 1 1  ON 27
 eO_8                -2.071121e-01 1 1  ON 28
 eO_9                -6.684900e-02 1 1  ON 29
eH1_0                -2.398330e-01 1 1  ON 30
eH1_1                -1.372603e-01 1 1  ON 31
eH1_2                -9.408275e-02 1 1  ON 32
eH1_3                -4.255703e-02 1 1  ON 33
eH1_4                 1.257637e-02 1 1  ON 34
eH1_5                 4.911116e-02 1 1  ON 35
eH1_6                 1.048970e-01 1 1  ON 36
eH1_7                 1.512345e-01 1 1  ON 37
eH1_8                 1.595215e-01 1 1  ON 38
eH1_9                 4.216026e-02 1 1  ON 39
eH2_0                -2.390903e-01 1 1  ON 40
eH2_1                -1.356533e-01 1 1  ON 41
eH2_2                -9.265337e-02 1 1  ON 42
eH2_3                -4.103797e-02 1 1  ON 43
eH2_4                 1.466512e-02 1 1  ON 44
eH2_5                 5.211402e-02 1 1  ON 45
eH2_6                 1.091162e-01 1 1  ON 46
eH2_7                 1.553479e-01 1 1  ON 47
eH2_8                 1.671784e-01 1 1  ON 48
eH2_9                 2.762450e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3386e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.065
    reference variance = 2.18793
====================================================
  Execution time = 2.6004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4840e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348362364408
                                         uncertainty =       0.013705672536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348362364408
                                         uncertainty =       0.013705672536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417370249
  error estimate for blocks of size 2^( 2) =       0.000429210355
  error estimate for blocks of size 2^( 3) =       0.000441984763
  error estimate for blocks of size 2^( 4) =       0.000454450204
  error estimate for blocks of size 2^( 5) =       0.000465954999
  error estimate for blocks of size 2^( 6) =       0.000476099566
  error estimate for blocks of size 2^( 7) =       0.000483329611

      target function =                  N/A
              le_mean =     -16.910122653277
             les_mean =     286.300643824714
             stat err =       0.000469958595
             autocorr =       1.267874351037
              std dev =       0.590250667120
             le_variance =       0.348395850035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691012265328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910122653277       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910125412085       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910127632730       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910130150810       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910133423474       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910134386042       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910140065010       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910143012824       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910141701165       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910142032124       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910142281363       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910142692499       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910143626026       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910143840286       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910143195145       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-02 is 6.656596e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910122653277       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910124727540       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910126006062       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910127388426       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910128632806       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910128763548       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910129653288       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910130554449       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910130180887       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910129916293       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910129946582       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910130091099       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 1.671996e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910122653277       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910123694300       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910124179611       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910124601419       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910124936215       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910125025863       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910125012960       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910125259231       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910125197027       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 4.365979e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2605e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.095769e-01 1 1  ON 0
 uu_1                 1.441737e-01 1 1  ON 1
 uu_2                 4.557733e-02 1 1  ON 2
 uu_3                -1.724097e-02 1 1  ON 3
 uu_4                -6.515822e-02 1 1  ON 4
 uu_5                -9.983718e-02 1 1  ON 5
 uu_6                -1.255970e-01 1 1  ON 6
 uu_7                -1.372757e-01 1 1  ON 7
 uu_8                -1.285957e-01 1 1  ON 8
 uu_9                -9.904186e-02 1 1  ON 9
 ud_0                 4.289691e-01 1 1  ON 10
 ud_1                 1.733234e-01 1 1  ON 11
 ud_2                 6.228072e-02 1 1  ON 12
 ud_3                -4.654645e-03 1 1  ON 13
 ud_4                -5.968385e-02 1 1  ON 14
 ud_5                -1.019279e-01 1 1  ON 15
 ud_6                -1.305085e-01 1 1  ON 16
 ud_7                -1.482389e-01 1 1  ON 17
 ud_8                -1.507013e-01 1 1  ON 18
 ud_9                -1.402500e-01 1 1  ON 19
 eO_0                -7.434130e-01 1 1  ON 20
 eO_1                -4.302790e-01 1 1  ON 21
 eO_2                -1.832125e-02 1 1  ON 22
 eO_3                 2.960008e-01 1 1  ON 23
 eO_4                 5.139463e-01 1 1  ON 24
 eO_5                 4.691423e-01 1 1  ON 25
 eO_6                 2.400422e-01 1 1  ON 26
 eO_7                -5.257201e-02 1 1  ON 27
 eO_8                -2.082405e-01 1 1  ON 28
 eO_9                -6.770384e-02 1 1  ON 29
eH1_0                -2.413865e-01 1 1  ON 30
eH1_1                -1.381887e-01 1 1  ON 31
eH1_2                -9.538916e-02 1 1  ON 32
eH1_3                -4.359010e-02 1 1  ON 33
eH1_4                 1.224695e-02 1 1  ON 34
eH1_5                 4.957911e-02 1 1  ON 35
eH1_6                 1.059020e-01 1 1  ON 36
eH1_7                 1.523770e-01 1 1  ON 37
eH1_8                 1.609947e-01 1 1  ON 38
eH1_9                 4.324106e-02 1 1  ON 39
eH2_0                -2.398714e-01 1 1  ON 40
eH2_1                -1.362137e-01 1 1  ON 41
eH2_2                -9.360884e-02 1 1  ON 42
eH2_3                -4.179796e-02 1 1  ON 43
eH2_4                 1.397282e-02 1 1  ON 44
eH2_5                 5.204882e-02 1 1  ON 45
eH2_6                 1.092010e-01 1 1  ON 46
eH2_7                 1.558320e-01 1 1  ON 47
eH2_8                 1.686099e-01 1 1  ON 48
eH2_9                 2.929649e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.107544
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3006e-01
  Total weights = 2.0000e+06
  Execution time = 2.9569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329652129038
                                         uncertainty =       0.004595923321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329652129038
                                         uncertainty =       0.004595923321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405941247
  error estimate for blocks of size 2^( 2) =       0.000417804023
  error estimate for blocks of size 2^( 3) =       0.000430685193
  error estimate for blocks of size 2^( 4) =       0.000442605468
  error estimate for blocks of size 2^( 5) =       0.000452835888
  error estimate for blocks of size 2^( 6) =       0.000461817664
  error estimate for blocks of size 2^( 7) =       0.000467034462

      target function =                  N/A
              le_mean =     -16.910867505562
             les_mean =     286.307016217387
             stat err =       0.000456073371
             autocorr =       1.262243282321
              std dev =       0.574087616577
             le_variance =       0.329576591507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330622175913
                                         uncertainty =       0.004603448593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330622175913
                                         uncertainty =       0.004603448593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406537980
  error estimate for blocks of size 2^( 2) =       0.000418379381
  error estimate for blocks of size 2^( 3) =       0.000431222701
  error estimate for blocks of size 2^( 4) =       0.000443099664
  error estimate for blocks of size 2^( 5) =       0.000453281174
  error estimate for blocks of size 2^( 6) =       0.000462228214
  error estimate for blocks of size 2^( 7) =       0.000467423128

      target function =                  N/A
              le_mean =     -16.910865428154
             les_mean =     286.307915622855
             stat err =       0.000456508045
             autocorr =       1.260940576067
              std dev =       0.574931525483
             le_variance =       0.330546258994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330627128607
                                         uncertainty =       0.004602893793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330627128607
                                         uncertainty =       0.004602893793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406540986
  error estimate for blocks of size 2^( 2) =       0.000418381467
  error estimate for blocks of size 2^( 3) =       0.000431229164
  error estimate for blocks of size 2^( 4) =       0.000443118389
  error estimate for blocks of size 2^( 5) =       0.000453309661
  error estimate for blocks of size 2^( 6) =       0.000462274070
  error estimate for blocks of size 2^( 7) =       0.000467470992

      target function =                  N/A
              le_mean =     -16.910865622554
             les_mean =     286.307927084920
             stat err =       0.000456543278
             autocorr =       1.261116573470
              std dev =       0.574935775640
             le_variance =       0.330551146111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329846115474
                                         uncertainty =       0.004597243036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329846115474
                                         uncertainty =       0.004597243036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406060633
  error estimate for blocks of size 2^( 2) =       0.000417918501
  error estimate for blocks of size 2^( 3) =       0.000430793463
  error estimate for blocks of size 2^( 4) =       0.000442708786
  error estimate for blocks of size 2^( 5) =       0.000452932277
  error estimate for blocks of size 2^( 6) =       0.000461911861
  error estimate for blocks of size 2^( 7) =       0.000467124392

      target function =                  N/A
              le_mean =     -16.910866394857
             les_mean =     286.307172535786
             stat err =       0.000456169329
             autocorr =       1.262032060885
              std dev =       0.574256454884
             le_variance =       0.329770475976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910867505562        initial  <--
     3.6380e-02     3.6380e-01             6.6566e-03       -16.910865428154
     1.4552e-01     1.4552e+00             1.6720e-03       -16.910865622554
     5.8208e-01     5.8208e+00             4.3660e-04       -16.910866394857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3764
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.089438e-01 1 1  ON 0
 uu_1                 1.437420e-01 1 1  ON 1
 uu_2                 4.529314e-02 1 1  ON 2
 uu_3                -1.723780e-02 1 1  ON 3
 uu_4                -6.476122e-02 1 1  ON 4
 uu_5                -9.947160e-02 1 1  ON 5
 uu_6                -1.254202e-01 1 1  ON 6
 uu_7                -1.367776e-01 1 1  ON 7
 uu_8                -1.274008e-01 1 1  ON 8
 uu_9                -9.854894e-02 1 1  ON 9
 ud_0                 4.283078e-01 1 1  ON 10
 ud_1                 1.729894e-01 1 1  ON 11
 ud_2                 6.195797e-02 1 1  ON 12
 ud_3                -4.745760e-03 1 1  ON 13
 ud_4                -5.974799e-02 1 1  ON 14
 ud_5                -1.016685e-01 1 1  ON 15
 ud_6                -1.302174e-01 1 1  ON 16
 ud_7                -1.479322e-01 1 1  ON 17
 ud_8                -1.506233e-01 1 1  ON 18
 ud_9                -1.399953e-01 1 1  ON 19
 eO_0                -7.428644e-01 1 1  ON 20
 eO_1                -4.294110e-01 1 1  ON 21
 eO_2                -1.811772e-02 1 1  ON 22
 eO_3                 2.952681e-01 1 1  ON 23
 eO_4                 5.128354e-01 1 1  ON 24
 eO_5                 4.681953e-01 1 1  ON 25
 eO_6                 2.392507e-01 1 1  ON 26
 eO_7                -5.272190e-02 1 1  ON 27
 eO_8                -2.071121e-01 1 1  ON 28
 eO_9                -6.684900e-02 1 1  ON 29
eH1_0                -2.398330e-01 1 1  ON 30
eH1_1                -1.372603e-01 1 1  ON 31
eH1_2                -9.408275e-02 1 1  ON 32
eH1_3                -4.255703e-02 1 1  ON 33
eH1_4                 1.257637e-02 1 1  ON 34
eH1_5                 4.911116e-02 1 1  ON 35
eH1_6                 1.048970e-01 1 1  ON 36
eH1_7                 1.512345e-01 1 1  ON 37
eH1_8                 1.595215e-01 1 1  ON 38
eH1_9                 4.216026e-02 1 1  ON 39
eH2_0                -2.390903e-01 1 1  ON 40
eH2_1                -1.356533e-01 1 1  ON 41
eH2_2                -9.265337e-02 1 1  ON 42
eH2_3                -4.103797e-02 1 1  ON 43
eH2_4                 1.466512e-02 1 1  ON 44
eH2_5                 5.211402e-02 1 1  ON 45
eH2_6                 1.091162e-01 1 1  ON 46
eH2_7                 1.553479e-01 1 1  ON 47
eH2_8                 1.671784e-01 1 1  ON 48
eH2_9                 2.762450e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.867
    reference variance = 0.30381
====================================================
  Execution time = 2.5784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2917e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329251624721
                                         uncertainty =       0.003139763782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329251624721
                                         uncertainty =       0.003139763782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405693857
  error estimate for blocks of size 2^( 2) =       0.000418016260
  error estimate for blocks of size 2^( 3) =       0.000430887395
  error estimate for blocks of size 2^( 4) =       0.000443266668
  error estimate for blocks of size 2^( 5) =       0.000454584633
  error estimate for blocks of size 2^( 6) =       0.000461951062
  error estimate for blocks of size 2^( 7) =       0.000465822472

      target function =                  N/A
              le_mean =     -16.910326834839
             les_mean =     286.288328507453
             stat err =       0.000456406209
             autocorr =       1.265628437369
              std dev =       0.573737754519
             le_variance =       0.329175010961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691032683484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910326834839       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910327263145       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910327120760       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910327421838       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910327081923       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910327701702       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910327871912       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910328084302       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910327991338       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 8.197656e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910326834839       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910326994979       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910326952189       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910326991743       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910326836884       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910327012441       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910327066875       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910327097648       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 2.045391e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910326834839       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910326880535       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910326869659       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910326873805       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910326830254       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910326872601       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910326885381       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910326891434       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 5.141574e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2438e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.090219e-01 1 1  ON 0
 uu_1                 1.437874e-01 1 1  ON 1
 uu_2                 4.531565e-02 1 1  ON 2
 uu_3                -1.723947e-02 1 1  ON 3
 uu_4                -6.476738e-02 1 1  ON 4
 uu_5                -9.951563e-02 1 1  ON 5
 uu_6                -1.254981e-01 1 1  ON 6
 uu_7                -1.368605e-01 1 1  ON 7
 uu_8                -1.274495e-01 1 1  ON 8
 uu_9                -9.857302e-02 1 1  ON 9
 ud_0                 4.283542e-01 1 1  ON 10
 ud_1                 1.729973e-01 1 1  ON 11
 ud_2                 6.198482e-02 1 1  ON 12
 ud_3                -4.749721e-03 1 1  ON 13
 ud_4                -5.974070e-02 1 1  ON 14
 ud_5                -1.016649e-01 1 1  ON 15
 ud_6                -1.301723e-01 1 1  ON 16
 ud_7                -1.479988e-01 1 1  ON 17
 ud_8                -1.506805e-01 1 1  ON 18
 ud_9                -1.400424e-01 1 1  ON 19
 eO_0                -7.428476e-01 1 1  ON 20
 eO_1                -4.295548e-01 1 1  ON 21
 eO_2                -1.812267e-02 1 1  ON 22
 eO_3                 2.953074e-01 1 1  ON 23
 eO_4                 5.129882e-01 1 1  ON 24
 eO_5                 4.682839e-01 1 1  ON 25
 eO_6                 2.392926e-01 1 1  ON 26
 eO_7                -5.268699e-02 1 1  ON 27
 eO_8                -2.072411e-01 1 1  ON 28
 eO_9                -6.694237e-02 1 1  ON 29
eH1_0                -2.399030e-01 1 1  ON 30
eH1_1                -1.373177e-01 1 1  ON 31
eH1_2                -9.415926e-02 1 1  ON 32
eH1_3                -4.258360e-02 1 1  ON 33
eH1_4                 1.250946e-02 1 1  ON 34
eH1_5                 4.900501e-02 1 1  ON 35
eH1_6                 1.049380e-01 1 1  ON 36
eH1_7                 1.513140e-01 1 1  ON 37
eH1_8                 1.596584e-01 1 1  ON 38
eH1_9                 4.228604e-02 1 1  ON 39
eH2_0                -2.392023e-01 1 1  ON 40
eH2_1                -1.357369e-01 1 1  ON 41
eH2_2                -9.273682e-02 1 1  ON 42
eH2_3                -4.114377e-02 1 1  ON 43
eH2_4                 1.455470e-02 1 1  ON 44
eH2_5                 5.207450e-02 1 1  ON 45
eH2_6                 1.091899e-01 1 1  ON 46
eH2_7                 1.554296e-01 1 1  ON 47
eH2_8                 1.673474e-01 1 1  ON 48
eH2_9                 2.782904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9459
    reference variance = 0.38261
====================================================
  Execution time = 2.5370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.0000e+06
  Execution time = 2.9525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338281585816
                                         uncertainty =       0.005462150191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338281585816
                                         uncertainty =       0.005462150191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411274525
  error estimate for blocks of size 2^( 2) =       0.000422420027
  error estimate for blocks of size 2^( 3) =       0.000434643618
  error estimate for blocks of size 2^( 4) =       0.000446421440
  error estimate for blocks of size 2^( 5) =       0.000456229454
  error estimate for blocks of size 2^( 6) =       0.000464066904
  error estimate for blocks of size 2^( 7) =       0.000471513858

      target function =                  N/A
              le_mean =     -16.911098192654
             les_mean =     286.323535381923
             stat err =       0.000459557914
             autocorr =       1.248581455772
              std dev =       0.581630010819
             le_variance =       0.338293469485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338381898611
                                         uncertainty =       0.005463056044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338381898611
                                         uncertainty =       0.005463056044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411335546
  error estimate for blocks of size 2^( 2) =       0.000422479722
  error estimate for blocks of size 2^( 3) =       0.000434701513
  error estimate for blocks of size 2^( 4) =       0.000446473292
  error estimate for blocks of size 2^( 5) =       0.000456276183
  error estimate for blocks of size 2^( 6) =       0.000464103435
  error estimate for blocks of size 2^( 7) =       0.000471551523

      target function =                  N/A
              le_mean =     -16.911098236339
             les_mean =     286.323637252848
             stat err =       0.000459601108
             autocorr =       1.248445683326
              std dev =       0.581716307949
             le_variance =       0.338393862934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338354852017
                                         uncertainty =       0.005462691376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338354852017
                                         uncertainty =       0.005462691376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411319088
  error estimate for blocks of size 2^( 2) =       0.000422463498
  error estimate for blocks of size 2^( 3) =       0.000434686071
  error estimate for blocks of size 2^( 4) =       0.000446460014
  error estimate for blocks of size 2^( 5) =       0.000456265270
  error estimate for blocks of size 2^( 6) =       0.000464095333
  error estimate for blocks of size 2^( 7) =       0.000471544304

      target function =                  N/A
              le_mean =     -16.911098273730
             les_mean =     286.323611438356
             stat err =       0.000459591230
             autocorr =       1.248491926743
              std dev =       0.581693032262
             le_variance =       0.338366783783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292623189
                                         uncertainty =       0.005462221951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292623189
                                         uncertainty =       0.005462221951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411281238
  error estimate for blocks of size 2^( 2) =       0.000422426555
  error estimate for blocks of size 2^( 3) =       0.000434650004
  error estimate for blocks of size 2^( 4) =       0.000446427286
  error estimate for blocks of size 2^( 5) =       0.000456234947
  error estimate for blocks of size 2^( 6) =       0.000464071319
  error estimate for blocks of size 2^( 7) =       0.000471518606

      target function =                  N/A
              le_mean =     -16.911098185754
             les_mean =     286.323546192275
             stat err =       0.000459563040
             autocorr =       1.248568547699
              std dev =       0.581639504512
             le_variance =       0.338304513209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911098192654        initial
     3.6380e-01     3.6380e+00             8.1977e-04       -16.911098236339
     1.4552e+00     1.4552e+01             2.0454e-04       -16.911098273730  <--
     5.8208e+00     5.8208e+01             5.1416e-05       -16.911098185754

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 4.0320e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.090219e-01 1 1  ON 0
 uu_1                 1.437874e-01 1 1  ON 1
 uu_2                 4.531565e-02 1 1  ON 2
 uu_3                -1.723947e-02 1 1  ON 3
 uu_4                -6.476738e-02 1 1  ON 4
 uu_5                -9.951563e-02 1 1  ON 5
 uu_6                -1.254981e-01 1 1  ON 6
 uu_7                -1.368605e-01 1 1  ON 7
 uu_8                -1.274495e-01 1 1  ON 8
 uu_9                -9.857302e-02 1 1  ON 9
 ud_0                 4.283542e-01 1 1  ON 10
 ud_1                 1.729973e-01 1 1  ON 11
 ud_2                 6.198482e-02 1 1  ON 12
 ud_3                -4.749721e-03 1 1  ON 13
 ud_4                -5.974070e-02 1 1  ON 14
 ud_5                -1.016649e-01 1 1  ON 15
 ud_6                -1.301723e-01 1 1  ON 16
 ud_7                -1.479988e-01 1 1  ON 17
 ud_8                -1.506805e-01 1 1  ON 18
 ud_9                -1.400424e-01 1 1  ON 19
 eO_0                -7.428476e-01 1 1  ON 20
 eO_1                -4.295548e-01 1 1  ON 21
 eO_2                -1.812267e-02 1 1  ON 22
 eO_3                 2.953074e-01 1 1  ON 23
 eO_4                 5.129882e-01 1 1  ON 24
 eO_5                 4.682839e-01 1 1  ON 25
 eO_6                 2.392926e-01 1 1  ON 26
 eO_7                -5.268699e-02 1 1  ON 27
 eO_8                -2.072411e-01 1 1  ON 28
 eO_9                -6.694237e-02 1 1  ON 29
eH1_0                -2.399030e-01 1 1  ON 30
eH1_1                -1.373177e-01 1 1  ON 31
eH1_2                -9.415926e-02 1 1  ON 32
eH1_3                -4.258360e-02 1 1  ON 33
eH1_4                 1.250946e-02 1 1  ON 34
eH1_5                 4.900501e-02 1 1  ON 35
eH1_6                 1.049380e-01 1 1  ON 36
eH1_7                 1.513140e-01 1 1  ON 37
eH1_8                 1.596584e-01 1 1  ON 38
eH1_9                 4.228604e-02 1 1  ON 39
eH2_0                -2.392023e-01 1 1  ON 40
eH2_1                -1.357369e-01 1 1  ON 41
eH2_2                -9.273682e-02 1 1  ON 42
eH2_3                -4.114377e-02 1 1  ON 43
eH2_4                 1.455470e-02 1 1  ON 44
eH2_5                 5.207450e-02 1 1  ON 45
eH2_6                 1.091899e-01 1 1  ON 46
eH2_7                 1.554296e-01 1 1  ON 47
eH2_8                 1.673474e-01 1 1  ON 48
eH2_9                 2.782904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9668
    reference variance = 0.428989
====================================================
  Execution time = 2.6953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3592e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335855209698
                                         uncertainty =       0.007031101220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335855209698
                                         uncertainty =       0.007031101220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409831613
  error estimate for blocks of size 2^( 2) =       0.000422090271
  error estimate for blocks of size 2^( 3) =       0.000434382930
  error estimate for blocks of size 2^( 4) =       0.000445901570
  error estimate for blocks of size 2^( 5) =       0.000456542317
  error estimate for blocks of size 2^( 6) =       0.000463815789
  error estimate for blocks of size 2^( 7) =       0.000468790517

      target function =                  N/A
              le_mean =     -16.910127702314
             les_mean =     286.288342642683
             stat err =       0.000458762548
             autocorr =       1.253040192631
              std dev =       0.579589425450
             le_variance =       0.335923902093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691012770231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910127702314       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910127688894       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910128495472       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910127721735       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910127417191       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910127389318       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910128043164       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910128168550       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910128568804       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 6.766188e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910127702314       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910127698227       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910127973138       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910127743919       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910127701633       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910127441151       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910127574374       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910127642532       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.687486e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910127702314       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910127701233       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910127778031       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910127719188       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910127713328       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910127625478       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910127643709       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910127660313       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 4.233332e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3807e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.090920e-01 1 1  ON 0
 uu_1                 1.438259e-01 1 1  ON 1
 uu_2                 4.529002e-02 1 1  ON 2
 uu_3                -1.721865e-02 1 1  ON 3
 uu_4                -6.480981e-02 1 1  ON 4
 uu_5                -9.951198e-02 1 1  ON 5
 uu_6                -1.255419e-01 1 1  ON 6
 uu_7                -1.368937e-01 1 1  ON 7
 uu_8                -1.274896e-01 1 1  ON 8
 uu_9                -9.861586e-02 1 1  ON 9
 ud_0                 4.284644e-01 1 1  ON 10
 ud_1                 1.729560e-01 1 1  ON 11
 ud_2                 6.201627e-02 1 1  ON 12
 ud_3                -4.762285e-03 1 1  ON 13
 ud_4                -5.979051e-02 1 1  ON 14
 ud_5                -1.016554e-01 1 1  ON 15
 ud_6                -1.300953e-01 1 1  ON 16
 ud_7                -1.480343e-01 1 1  ON 17
 ud_8                -1.507145e-01 1 1  ON 18
 ud_9                -1.400750e-01 1 1  ON 19
 eO_0                -7.429387e-01 1 1  ON 20
 eO_1                -4.296581e-01 1 1  ON 21
 eO_2                -1.816110e-02 1 1  ON 22
 eO_3                 2.953967e-01 1 1  ON 23
 eO_4                 5.131259e-01 1 1  ON 24
 eO_5                 4.684096e-01 1 1  ON 25
 eO_6                 2.393567e-01 1 1  ON 26
 eO_7                -5.267590e-02 1 1  ON 27
 eO_8                -2.073403e-01 1 1  ON 28
 eO_9                -6.702843e-02 1 1  ON 29
eH1_0                -2.400619e-01 1 1  ON 30
eH1_1                -1.373624e-01 1 1  ON 31
eH1_2                -9.426020e-02 1 1  ON 32
eH1_3                -4.266201e-02 1 1  ON 33
eH1_4                 1.248998e-02 1 1  ON 34
eH1_5                 4.894429e-02 1 1  ON 35
eH1_6                 1.050293e-01 1 1  ON 36
eH1_7                 1.514145e-01 1 1  ON 37
eH1_8                 1.598271e-01 1 1  ON 38
eH1_9                 4.240196e-02 1 1  ON 39
eH2_0                -2.392687e-01 1 1  ON 40
eH2_1                -1.357444e-01 1 1  ON 41
eH2_2                -9.283307e-02 1 1  ON 42
eH2_3                -4.122898e-02 1 1  ON 43
eH2_4                 1.442426e-02 1 1  ON 44
eH2_5                 5.210865e-02 1 1  ON 45
eH2_6                 1.092132e-01 1 1  ON 46
eH2_7                 1.554448e-01 1 1  ON 47
eH2_8                 1.674765e-01 1 1  ON 48
eH2_9                 2.799310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8281
    reference variance = 0.185378
====================================================
  Execution time = 2.5483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3544e-01
  Total weights = 2.0000e+06
  Execution time = 2.9534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335343980627
                                         uncertainty =       0.003684354597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335343980627
                                         uncertainty =       0.003684354597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466164
  error estimate for blocks of size 2^( 2) =       0.000421408318
  error estimate for blocks of size 2^( 3) =       0.000434044909
  error estimate for blocks of size 2^( 4) =       0.000446207679
  error estimate for blocks of size 2^( 5) =       0.000456242459
  error estimate for blocks of size 2^( 6) =       0.000464938123
  error estimate for blocks of size 2^( 7) =       0.000472301966

      target function =                  N/A
              le_mean =     -16.910461875519
             les_mean =     286.299045755405
             stat err =       0.000459922557
             autocorr =       1.261633983538
              std dev =       0.579072603127
             le_variance =       0.335325079692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335601586513
                                         uncertainty =       0.003686091969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335601586513
                                         uncertainty =       0.003686091969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409623440
  error estimate for blocks of size 2^( 2) =       0.000421562302
  error estimate for blocks of size 2^( 3) =       0.000434194408
  error estimate for blocks of size 2^( 4) =       0.000446351573
  error estimate for blocks of size 2^( 5) =       0.000456378167
  error estimate for blocks of size 2^( 6) =       0.000465070787
  error estimate for blocks of size 2^( 7) =       0.000472431098

      target function =                  N/A
              le_mean =     -16.910461490555
             les_mean =     286.299290380190
             stat err =       0.000460057906
             autocorr =       1.261407466176
              std dev =       0.579295023669
             le_variance =       0.335582724448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335572190141
                                         uncertainty =       0.003686087497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335572190141
                                         uncertainty =       0.003686087497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409605485
  error estimate for blocks of size 2^( 2) =       0.000421543958
  error estimate for blocks of size 2^( 3) =       0.000434176691
  error estimate for blocks of size 2^( 4) =       0.000446335218
  error estimate for blocks of size 2^( 5) =       0.000456364133
  error estimate for blocks of size 2^( 6) =       0.000465059110
  error estimate for blocks of size 2^( 7) =       0.000472421835

      target function =                  N/A
              le_mean =     -16.910461352212
             les_mean =     286.299256284032
             stat err =       0.000460045074
             autocorr =       1.261447678247
              std dev =       0.579269632525
             le_variance =       0.335553307166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378491247
                                         uncertainty =       0.003684626723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378491247
                                         uncertainty =       0.003684626723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409487236
  error estimate for blocks of size 2^( 2) =       0.000421428807
  error estimate for blocks of size 2^( 3) =       0.000434064832
  error estimate for blocks of size 2^( 4) =       0.000446226996
  error estimate for blocks of size 2^( 5) =       0.000456260934
  error estimate for blocks of size 2^( 6) =       0.000464956607
  error estimate for blocks of size 2^( 7) =       0.000472320441

      target function =                  N/A
              le_mean =     -16.910461760666
             les_mean =     286.299076384233
             stat err =       0.000459941245
             autocorr =       1.261606662582
              std dev =       0.579102402827
             le_variance =       0.335359592960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910461875519        initial  <--
     3.6380e-01     3.6380e+00             6.7662e-04       -16.910461490555
     1.4552e+00     1.4552e+01             1.6875e-04       -16.910461352212
     5.8208e+00     5.8208e+01             4.2333e-05       -16.910461760666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3118
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.090219e-01 1 1  ON 0
 uu_1                 1.437874e-01 1 1  ON 1
 uu_2                 4.531565e-02 1 1  ON 2
 uu_3                -1.723947e-02 1 1  ON 3
 uu_4                -6.476738e-02 1 1  ON 4
 uu_5                -9.951563e-02 1 1  ON 5
 uu_6                -1.254981e-01 1 1  ON 6
 uu_7                -1.368605e-01 1 1  ON 7
 uu_8                -1.274495e-01 1 1  ON 8
 uu_9                -9.857302e-02 1 1  ON 9
 ud_0                 4.283542e-01 1 1  ON 10
 ud_1                 1.729973e-01 1 1  ON 11
 ud_2                 6.198482e-02 1 1  ON 12
 ud_3                -4.749721e-03 1 1  ON 13
 ud_4                -5.974070e-02 1 1  ON 14
 ud_5                -1.016649e-01 1 1  ON 15
 ud_6                -1.301723e-01 1 1  ON 16
 ud_7                -1.479988e-01 1 1  ON 17
 ud_8                -1.506805e-01 1 1  ON 18
 ud_9                -1.400424e-01 1 1  ON 19
 eO_0                -7.428476e-01 1 1  ON 20
 eO_1                -4.295548e-01 1 1  ON 21
 eO_2                -1.812267e-02 1 1  ON 22
 eO_3                 2.953074e-01 1 1  ON 23
 eO_4                 5.129882e-01 1 1  ON 24
 eO_5                 4.682839e-01 1 1  ON 25
 eO_6                 2.392926e-01 1 1  ON 26
 eO_7                -5.268699e-02 1 1  ON 27
 eO_8                -2.072411e-01 1 1  ON 28
 eO_9                -6.694237e-02 1 1  ON 29
eH1_0                -2.399030e-01 1 1  ON 30
eH1_1                -1.373177e-01 1 1  ON 31
eH1_2                -9.415926e-02 1 1  ON 32
eH1_3                -4.258360e-02 1 1  ON 33
eH1_4                 1.250946e-02 1 1  ON 34
eH1_5                 4.900501e-02 1 1  ON 35
eH1_6                 1.049380e-01 1 1  ON 36
eH1_7                 1.513140e-01 1 1  ON 37
eH1_8                 1.596584e-01 1 1  ON 38
eH1_9                 4.228604e-02 1 1  ON 39
eH2_0                -2.392023e-01 1 1  ON 40
eH2_1                -1.357369e-01 1 1  ON 41
eH2_2                -9.273682e-02 1 1  ON 42
eH2_3                -4.114377e-02 1 1  ON 43
eH2_4                 1.455470e-02 1 1  ON 44
eH2_5                 5.207450e-02 1 1  ON 45
eH2_6                 1.091899e-01 1 1  ON 46
eH2_7                 1.554296e-01 1 1  ON 47
eH2_8                 1.673474e-01 1 1  ON 48
eH2_9                 2.782904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8765
    reference variance = 0.288964
====================================================
  Execution time = 2.5942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638794004
                                         uncertainty =       0.005416803168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638794004
                                         uncertainty =       0.005416803168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411406049
  error estimate for blocks of size 2^( 2) =       0.000422582262
  error estimate for blocks of size 2^( 3) =       0.000434567206
  error estimate for blocks of size 2^( 4) =       0.000446485894
  error estimate for blocks of size 2^( 5) =       0.000456816235
  error estimate for blocks of size 2^( 6) =       0.000464670486
  error estimate for blocks of size 2^( 7) =       0.000469843898

      target function =                  N/A
              le_mean =     -16.910059884227
             les_mean =     286.288634992975
             stat err =       0.000459454128
             autocorr =       1.247219724702
              std dev =       0.581816013940
             le_variance =       0.338509874077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691005988423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059884227       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059931792       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910060091403       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910060149294       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910060212418       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910060330182       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910060223340       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910060255960       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 6.167157e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059884227       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059896358       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910059937021       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910059948633       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910059995691       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910059995955       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910059970818       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910059977849       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.547678e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059884227       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059887275       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910059897487       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910059900163       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910059908978       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910059912475       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910059905991       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910059907680       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.873052e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2561e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.090359e-01 1 1  ON 0
 uu_1                 1.437829e-01 1 1  ON 1
 uu_2                 4.531232e-02 1 1  ON 2
 uu_3                -1.724351e-02 1 1  ON 3
 uu_4                -6.477732e-02 1 1  ON 4
 uu_5                -9.951936e-02 1 1  ON 5
 uu_6                -1.254944e-01 1 1  ON 6
 uu_7                -1.368639e-01 1 1  ON 7
 uu_8                -1.274492e-01 1 1  ON 8
 uu_9                -9.857671e-02 1 1  ON 9
 ud_0                 4.283656e-01 1 1  ON 10
 ud_1                 1.729970e-01 1 1  ON 11
 ud_2                 6.199178e-02 1 1  ON 12
 ud_3                -4.749537e-03 1 1  ON 13
 ud_4                -5.974208e-02 1 1  ON 14
 ud_5                -1.016669e-01 1 1  ON 15
 ud_6                -1.301702e-01 1 1  ON 16
 ud_7                -1.480071e-01 1 1  ON 17
 ud_8                -1.506860e-01 1 1  ON 18
 ud_9                -1.400456e-01 1 1  ON 19
 eO_0                -7.428492e-01 1 1  ON 20
 eO_1                -4.295673e-01 1 1  ON 21
 eO_2                -1.812642e-02 1 1  ON 22
 eO_3                 2.953159e-01 1 1  ON 23
 eO_4                 5.129952e-01 1 1  ON 24
 eO_5                 4.682928e-01 1 1  ON 25
 eO_6                 2.392992e-01 1 1  ON 26
 eO_7                -5.267980e-02 1 1  ON 27
 eO_8                -2.072504e-01 1 1  ON 28
 eO_9                -6.695210e-02 1 1  ON 29
eH1_0                -2.399097e-01 1 1  ON 30
eH1_1                -1.373308e-01 1 1  ON 31
eH1_2                -9.417421e-02 1 1  ON 32
eH1_3                -4.259131e-02 1 1  ON 33
eH1_4                 1.250037e-02 1 1  ON 34
eH1_5                 4.901055e-02 1 1  ON 35
eH1_6                 1.049481e-01 1 1  ON 36
eH1_7                 1.513245e-01 1 1  ON 37
eH1_8                 1.596715e-01 1 1  ON 38
eH1_9                 4.229710e-02 1 1  ON 39
eH2_0                -2.392095e-01 1 1  ON 40
eH2_1                -1.357392e-01 1 1  ON 41
eH2_2                -9.274137e-02 1 1  ON 42
eH2_3                -4.115875e-02 1 1  ON 43
eH2_4                 1.454915e-02 1 1  ON 44
eH2_5                 5.207115e-02 1 1  ON 45
eH2_6                 1.091921e-01 1 1  ON 46
eH2_7                 1.554352e-01 1 1  ON 47
eH2_8                 1.673614e-01 1 1  ON 48
eH2_9                 2.784451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.834
    reference variance = 0.276971
====================================================
  Execution time = 2.5279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3174e-01
  Total weights = 2.0000e+06
  Execution time = 2.9552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331882989326
                                         uncertainty =       0.004509840350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331882989326
                                         uncertainty =       0.004509840350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407263502
  error estimate for blocks of size 2^( 2) =       0.000419368330
  error estimate for blocks of size 2^( 3) =       0.000431256347
  error estimate for blocks of size 2^( 4) =       0.000443409856
  error estimate for blocks of size 2^( 5) =       0.000455457512
  error estimate for blocks of size 2^( 6) =       0.000461896290
  error estimate for blocks of size 2^( 7) =       0.000467660795

      target function =                  N/A
              le_mean =     -16.909944518328
             les_mean =     286.277950567162
             stat err =       0.000457106113
             autocorr =       1.259746255038
              std dev =       0.575957567974
             le_variance =       0.331727120106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331917641729
                                         uncertainty =       0.004510694137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331917641729
                                         uncertainty =       0.004510694137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407284765
  error estimate for blocks of size 2^( 2) =       0.000419389166
  error estimate for blocks of size 2^( 3) =       0.000431276449
  error estimate for blocks of size 2^( 4) =       0.000443429183
  error estimate for blocks of size 2^( 5) =       0.000455475274
  error estimate for blocks of size 2^( 6) =       0.000461912036
  error estimate for blocks of size 2^( 7) =       0.000467676490

      target function =                  N/A
              le_mean =     -16.909944263144
             les_mean =     286.277976576484
             stat err =       0.000457123246
             autocorr =       1.259709148108
              std dev =       0.575987638533
             le_variance =       0.331761759743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331901442832
                                         uncertainty =       0.004510290820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331901442832
                                         uncertainty =       0.004510290820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407274825
  error estimate for blocks of size 2^( 2) =       0.000419379427
  error estimate for blocks of size 2^( 3) =       0.000431267061
  error estimate for blocks of size 2^( 4) =       0.000443420165
  error estimate for blocks of size 2^( 5) =       0.000455466979
  error estimate for blocks of size 2^( 6) =       0.000461904696
  error estimate for blocks of size 2^( 7) =       0.000467669188

      target function =                  N/A
              le_mean =     -16.909944379486
             les_mean =     286.277964318141
             stat err =       0.000457115257
             autocorr =       1.259726604697
              std dev =       0.575973581614
             le_variance =       0.331745566717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331885333561
                                         uncertainty =       0.004509897461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331885333561
                                         uncertainty =       0.004509897461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407264940
  error estimate for blocks of size 2^( 2) =       0.000419369740
  error estimate for blocks of size 2^( 3) =       0.000431257708
  error estimate for blocks of size 2^( 4) =       0.000443411166
  error estimate for blocks of size 2^( 5) =       0.000455458715
  error estimate for blocks of size 2^( 6) =       0.000461897358
  error estimate for blocks of size 2^( 7) =       0.000467661862

      target function =                  N/A
              le_mean =     -16.909944500346
             les_mean =     286.277952302390
             stat err =       0.000457107275
             autocorr =       1.259743760479
              std dev =       0.575959602281
             le_variance =       0.331729463460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909944518328        initial  <--
     3.6380e+00     3.6380e+01             6.1672e-05       -16.909944263144
     1.4552e+01     1.4552e+02             1.5477e-05       -16.909944379486
     5.8208e+01     5.8208e+02             3.8731e-06       -16.909944500346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8530
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.090219e-01 1 1  ON 0
 uu_1                 1.437874e-01 1 1  ON 1
 uu_2                 4.531565e-02 1 1  ON 2
 uu_3                -1.723947e-02 1 1  ON 3
 uu_4                -6.476738e-02 1 1  ON 4
 uu_5                -9.951563e-02 1 1  ON 5
 uu_6                -1.254981e-01 1 1  ON 6
 uu_7                -1.368605e-01 1 1  ON 7
 uu_8                -1.274495e-01 1 1  ON 8
 uu_9                -9.857302e-02 1 1  ON 9
 ud_0                 4.283542e-01 1 1  ON 10
 ud_1                 1.729973e-01 1 1  ON 11
 ud_2                 6.198482e-02 1 1  ON 12
 ud_3                -4.749721e-03 1 1  ON 13
 ud_4                -5.974070e-02 1 1  ON 14
 ud_5                -1.016649e-01 1 1  ON 15
 ud_6                -1.301723e-01 1 1  ON 16
 ud_7                -1.479988e-01 1 1  ON 17
 ud_8                -1.506805e-01 1 1  ON 18
 ud_9                -1.400424e-01 1 1  ON 19
 eO_0                -7.428476e-01 1 1  ON 20
 eO_1                -4.295548e-01 1 1  ON 21
 eO_2                -1.812267e-02 1 1  ON 22
 eO_3                 2.953074e-01 1 1  ON 23
 eO_4                 5.129882e-01 1 1  ON 24
 eO_5                 4.682839e-01 1 1  ON 25
 eO_6                 2.392926e-01 1 1  ON 26
 eO_7                -5.268699e-02 1 1  ON 27
 eO_8                -2.072411e-01 1 1  ON 28
 eO_9                -6.694237e-02 1 1  ON 29
eH1_0                -2.399030e-01 1 1  ON 30
eH1_1                -1.373177e-01 1 1  ON 31
eH1_2                -9.415926e-02 1 1  ON 32
eH1_3                -4.258360e-02 1 1  ON 33
eH1_4                 1.250946e-02 1 1  ON 34
eH1_5                 4.900501e-02 1 1  ON 35
eH1_6                 1.049380e-01 1 1  ON 36
eH1_7                 1.513140e-01 1 1  ON 37
eH1_8                 1.596584e-01 1 1  ON 38
eH1_9                 4.228604e-02 1 1  ON 39
eH2_0                -2.392023e-01 1 1  ON 40
eH2_1                -1.357369e-01 1 1  ON 41
eH2_2                -9.273682e-02 1 1  ON 42
eH2_3                -4.114377e-02 1 1  ON 43
eH2_4                 1.455470e-02 1 1  ON 44
eH2_5                 5.207450e-02 1 1  ON 45
eH2_6                 1.091899e-01 1 1  ON 46
eH2_7                 1.554296e-01 1 1  ON 47
eH2_8                 1.673474e-01 1 1  ON 48
eH2_9                 2.782904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.426979
====================================================
  Execution time = 2.7196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4993e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349976168846
                                         uncertainty =       0.013614533505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349976168846
                                         uncertainty =       0.013614533505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418288145
  error estimate for blocks of size 2^( 2) =       0.000429572829
  error estimate for blocks of size 2^( 3) =       0.000441495307
  error estimate for blocks of size 2^( 4) =       0.000452724789
  error estimate for blocks of size 2^( 5) =       0.000464383826
  error estimate for blocks of size 2^( 6) =       0.000471493868
  error estimate for blocks of size 2^( 7) =       0.000477004529

      target function =                  N/A
              le_mean =     -16.910863609713
             les_mean =     286.327237795485
             stat err =       0.000466401753
             autocorr =       1.243280827044
              std dev =       0.591548767347
             le_variance =       0.349929944150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691086360971e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910863609713       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910863608801       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910863610895       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910863621822       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910863626512       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910863627452       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910863630222       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910863628987       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 6.665511e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910863609713       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910863609484       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910863610010       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910863612740       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910863613926       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910863614164       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910863614860       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910863614546       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.666889e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910863609713       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910863609655       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910863609787       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910863610469       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910863610767       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910863610825       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910863611001       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910863610922       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 4.167544e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3817e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.090220e-01 1 1  ON 0
 uu_1                 1.437885e-01 1 1  ON 1
 uu_2                 4.531557e-02 1 1  ON 2
 uu_3                -1.723940e-02 1 1  ON 3
 uu_4                -6.476739e-02 1 1  ON 4
 uu_5                -9.951635e-02 1 1  ON 5
 uu_6                -1.254986e-01 1 1  ON 6
 uu_7                -1.368616e-01 1 1  ON 7
 uu_8                -1.274502e-01 1 1  ON 8
 uu_9                -9.857288e-02 1 1  ON 9
 ud_0                 4.283544e-01 1 1  ON 10
 ud_1                 1.729972e-01 1 1  ON 11
 ud_2                 6.198523e-02 1 1  ON 12
 ud_3                -4.750011e-03 1 1  ON 13
 ud_4                -5.974156e-02 1 1  ON 14
 ud_5                -1.016651e-01 1 1  ON 15
 ud_6                -1.301724e-01 1 1  ON 16
 ud_7                -1.479994e-01 1 1  ON 17
 ud_8                -1.506797e-01 1 1  ON 18
 ud_9                -1.400420e-01 1 1  ON 19
 eO_0                -7.428482e-01 1 1  ON 20
 eO_1                -4.295561e-01 1 1  ON 21
 eO_2                -1.812285e-02 1 1  ON 22
 eO_3                 2.953086e-01 1 1  ON 23
 eO_4                 5.129891e-01 1 1  ON 24
 eO_5                 4.682854e-01 1 1  ON 25
 eO_6                 2.392927e-01 1 1  ON 26
 eO_7                -5.268719e-02 1 1  ON 27
 eO_8                -2.072416e-01 1 1  ON 28
 eO_9                -6.694306e-02 1 1  ON 29
eH1_0                -2.399044e-01 1 1  ON 30
eH1_1                -1.373184e-01 1 1  ON 31
eH1_2                -9.416043e-02 1 1  ON 32
eH1_3                -4.258432e-02 1 1  ON 33
eH1_4                 1.250930e-02 1 1  ON 34
eH1_5                 4.900481e-02 1 1  ON 35
eH1_6                 1.049391e-01 1 1  ON 36
eH1_7                 1.513146e-01 1 1  ON 37
eH1_8                 1.596597e-01 1 1  ON 38
eH1_9                 4.228722e-02 1 1  ON 39
eH2_0                -2.392036e-01 1 1  ON 40
eH2_1                -1.357369e-01 1 1  ON 41
eH2_2                -9.273775e-02 1 1  ON 42
eH2_3                -4.114450e-02 1 1  ON 43
eH2_4                 1.455377e-02 1 1  ON 44
eH2_5                 5.207369e-02 1 1  ON 45
eH2_6                 1.091899e-01 1 1  ON 46
eH2_7                 1.554308e-01 1 1  ON 47
eH2_8                 1.673488e-01 1 1  ON 48
eH2_9                 2.783070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.877
    reference variance = 0.2832
====================================================
  Execution time = 2.5584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5510e-01
  Total weights = 2.0000e+06
  Execution time = 2.9776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355206788709
                                         uncertainty =       0.014052243160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355206788709
                                         uncertainty =       0.014052243160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421368795
  error estimate for blocks of size 2^( 2) =       0.000432910250
  error estimate for blocks of size 2^( 3) =       0.000445041528
  error estimate for blocks of size 2^( 4) =       0.000456394886
  error estimate for blocks of size 2^( 5) =       0.000465549498
  error estimate for blocks of size 2^( 6) =       0.000471521167
  error estimate for blocks of size 2^( 7) =       0.000477134738

      target function =                  N/A
              le_mean =     -16.911353050926
             les_mean =     286.348965158792
             stat err =       0.000467650072
             autocorr =       1.231734967367
              std dev =       0.595905465044
             le_variance =       0.355103323269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355207984007
                                         uncertainty =       0.014052480124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355207984007
                                         uncertainty =       0.014052480124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421369503
  error estimate for blocks of size 2^( 2) =       0.000432910951
  error estimate for blocks of size 2^( 3) =       0.000445042182
  error estimate for blocks of size 2^( 4) =       0.000456395476
  error estimate for blocks of size 2^( 5) =       0.000465550062
  error estimate for blocks of size 2^( 6) =       0.000471521705
  error estimate for blocks of size 2^( 7) =       0.000477135256

      target function =                  N/A
              le_mean =     -16.911353067058
             les_mean =     286.348966898058
             stat err =       0.000467650625
             autocorr =       1.231733736865
              std dev =       0.595906466586
             le_variance =       0.355104516918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355207391016
                                         uncertainty =       0.014052362652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355207391016
                                         uncertainty =       0.014052362652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421369152
  error estimate for blocks of size 2^( 2) =       0.000432910603
  error estimate for blocks of size 2^( 3) =       0.000445041858
  error estimate for blocks of size 2^( 4) =       0.000456395183
  error estimate for blocks of size 2^( 5) =       0.000465549783
  error estimate for blocks of size 2^( 6) =       0.000471521438
  error estimate for blocks of size 2^( 7) =       0.000477135000

      target function =                  N/A
              le_mean =     -16.911353058961
             les_mean =     286.348966032016
             stat err =       0.000467650351
             autocorr =       1.231734348442
              std dev =       0.595905969714
             le_variance =       0.355103924741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355206864133
                                         uncertainty =       0.014052258128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355206864133
                                         uncertainty =       0.014052258128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421368840
  error estimate for blocks of size 2^( 2) =       0.000432910294
  error estimate for blocks of size 2^( 3) =       0.000445041569
  error estimate for blocks of size 2^( 4) =       0.000456394923
  error estimate for blocks of size 2^( 5) =       0.000465549534
  error estimate for blocks of size 2^( 6) =       0.000471521201
  error estimate for blocks of size 2^( 7) =       0.000477134771

      target function =                  N/A
              le_mean =     -16.911353051928
             les_mean =     286.348965267992
             stat err =       0.000467650107
             autocorr =       1.231734889884
              std dev =       0.595905528242
             le_variance =       0.355103398589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911353050926        initial
     3.6380e+01     3.6380e+02             6.6655e-06       -16.911353067058  <--
     1.4552e+02     1.4552e+03             1.6669e-06       -16.911353058961
     5.8208e+02     5.8208e+03             4.1675e-07       -16.911353051928

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 4.0485e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.090225e-01 1 1  ON 0
 uu_1                 1.437918e-01 1 1  ON 1
 uu_2                 4.531534e-02 1 1  ON 2
 uu_3                -1.723917e-02 1 1  ON 3
 uu_4                -6.476742e-02 1 1  ON 4
 uu_5                -9.951849e-02 1 1  ON 5
 uu_6                -1.255003e-01 1 1  ON 6
 uu_7                -1.368647e-01 1 1  ON 7
 uu_8                -1.274525e-01 1 1  ON 8
 uu_9                -9.857248e-02 1 1  ON 9
 ud_0                 4.283549e-01 1 1  ON 10
 ud_1                 1.729972e-01 1 1  ON 11
 ud_2                 6.198645e-02 1 1  ON 12
 ud_3                -4.750875e-03 1 1  ON 13
 ud_4                -5.974413e-02 1 1  ON 14
 ud_5                -1.016657e-01 1 1  ON 15
 ud_6                -1.301728e-01 1 1  ON 16
 ud_7                -1.480010e-01 1 1  ON 17
 ud_8                -1.506773e-01 1 1  ON 18
 ud_9                -1.400408e-01 1 1  ON 19
 eO_0                -7.428500e-01 1 1  ON 20
 eO_1                -4.295601e-01 1 1  ON 21
 eO_2                -1.812339e-02 1 1  ON 22
 eO_3                 2.953119e-01 1 1  ON 23
 eO_4                 5.129917e-01 1 1  ON 24
 eO_5                 4.682898e-01 1 1  ON 25
 eO_6                 2.392932e-01 1 1  ON 26
 eO_7                -5.268781e-02 1 1  ON 27
 eO_8                -2.072432e-01 1 1  ON 28
 eO_9                -6.694513e-02 1 1  ON 29
eH1_0                -2.399085e-01 1 1  ON 30
eH1_1                -1.373206e-01 1 1  ON 31
eH1_2                -9.416393e-02 1 1  ON 32
eH1_3                -4.258646e-02 1 1  ON 33
eH1_4                 1.250881e-02 1 1  ON 34
eH1_5                 4.900421e-02 1 1  ON 35
eH1_6                 1.049424e-01 1 1  ON 36
eH1_7                 1.513165e-01 1 1  ON 37
eH1_8                 1.596635e-01 1 1  ON 38
eH1_9                 4.229075e-02 1 1  ON 39
eH2_0                -2.392073e-01 1 1  ON 40
eH2_1                -1.357370e-01 1 1  ON 41
eH2_2                -9.274056e-02 1 1  ON 42
eH2_3                -4.114667e-02 1 1  ON 43
eH2_4                 1.455096e-02 1 1  ON 44
eH2_5                 5.207126e-02 1 1  ON 45
eH2_6                 1.091900e-01 1 1  ON 46
eH2_7                 1.554347e-01 1 1  ON 47
eH2_8                 1.673531e-01 1 1  ON 48
eH2_9                 2.783570e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.985
    reference variance = 0.156824
====================================================
  Execution time = 2.6077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339266361887
                                         uncertainty =       0.005723141870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339266361887
                                         uncertainty =       0.005723141870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411883848
  error estimate for blocks of size 2^( 2) =       0.000423712697
  error estimate for blocks of size 2^( 3) =       0.000436104413
  error estimate for blocks of size 2^( 4) =       0.000448564948
  error estimate for blocks of size 2^( 5) =       0.000460796995
  error estimate for blocks of size 2^( 6) =       0.000470215286
  error estimate for blocks of size 2^( 7) =       0.000477338179

      target function =                  N/A
              le_mean =     -16.909340260721
             les_mean =     286.265084491342
             stat err =       0.000464228852
             autocorr =       1.270324676856
              std dev =       0.582491723670
             le_variance =       0.339296608144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690934026072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909340260721       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909340326167       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909340492874       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909340580729       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909340515188       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909340526541       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909340536737       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909340523814       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 2.912540e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909340260721       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909340277301       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909340320464       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909340342305       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909340326133       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909340329039       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909340331201       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909340328211       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 7.284829e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909340260721       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909340264880       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909340275767       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909340281219       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909340277192       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909340277925       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909340278439       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909340277707       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.821414e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2901e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.090265e-01 1 1  ON 0
 uu_1                 1.437931e-01 1 1  ON 1
 uu_2                 4.531500e-02 1 1  ON 2
 uu_3                -1.724099e-02 1 1  ON 3
 uu_4                -6.476983e-02 1 1  ON 4
 uu_5                -9.952175e-02 1 1  ON 5
 uu_6                -1.255032e-01 1 1  ON 6
 uu_7                -1.368676e-01 1 1  ON 7
 uu_8                -1.274526e-01 1 1  ON 8
 uu_9                -9.857189e-02 1 1  ON 9
 ud_0                 4.283585e-01 1 1  ON 10
 ud_1                 1.729970e-01 1 1  ON 11
 ud_2                 6.198833e-02 1 1  ON 12
 ud_3                -4.753638e-03 1 1  ON 13
 ud_4                -5.974446e-02 1 1  ON 14
 ud_5                -1.016653e-01 1 1  ON 15
 ud_6                -1.301736e-01 1 1  ON 16
 ud_7                -1.480032e-01 1 1  ON 17
 ud_8                -1.506785e-01 1 1  ON 18
 ud_9                -1.400403e-01 1 1  ON 19
 eO_0                -7.428513e-01 1 1  ON 20
 eO_1                -4.295673e-01 1 1  ON 21
 eO_2                -1.812458e-02 1 1  ON 22
 eO_3                 2.953152e-01 1 1  ON 23
 eO_4                 5.129974e-01 1 1  ON 24
 eO_5                 4.682945e-01 1 1  ON 25
 eO_6                 2.392940e-01 1 1  ON 26
 eO_7                -5.268591e-02 1 1  ON 27
 eO_8                -2.072468e-01 1 1  ON 28
 eO_9                -6.694820e-02 1 1  ON 29
eH1_0                -2.399146e-01 1 1  ON 30
eH1_1                -1.373219e-01 1 1  ON 31
eH1_2                -9.417025e-02 1 1  ON 32
eH1_3                -4.259083e-02 1 1  ON 33
eH1_4                 1.250800e-02 1 1  ON 34
eH1_5                 4.900120e-02 1 1  ON 35
eH1_6                 1.049450e-01 1 1  ON 36
eH1_7                 1.513217e-01 1 1  ON 37
eH1_8                 1.596708e-01 1 1  ON 38
eH1_9                 4.229682e-02 1 1  ON 39
eH2_0                -2.392091e-01 1 1  ON 40
eH2_1                -1.357379e-01 1 1  ON 41
eH2_2                -9.274734e-02 1 1  ON 42
eH2_3                -4.114820e-02 1 1  ON 43
eH2_4                 1.454799e-02 1 1  ON 44
eH2_5                 5.206885e-02 1 1  ON 45
eH2_6                 1.091916e-01 1 1  ON 46
eH2_7                 1.554359e-01 1 1  ON 47
eH2_8                 1.673586e-01 1 1  ON 48
eH2_9                 2.784270e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.185282
====================================================
  Execution time = 2.5336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4286e-01
  Total weights = 2.0000e+06
  Execution time = 2.9681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342989387033
                                         uncertainty =       0.007769092995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342989387033
                                         uncertainty =       0.007769092995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414037892
  error estimate for blocks of size 2^( 2) =       0.000425682942
  error estimate for blocks of size 2^( 3) =       0.000437989013
  error estimate for blocks of size 2^( 4) =       0.000449936748
  error estimate for blocks of size 2^( 5) =       0.000461076661
  error estimate for blocks of size 2^( 6) =       0.000470101490
  error estimate for blocks of size 2^( 7) =       0.000476824460

      target function =                  N/A
              le_mean =     -16.910973605219
             les_mean =     286.323882857270
             stat err =       0.000464484840
             autocorr =       1.258528077896
              std dev =       0.585538002423
             le_variance =       0.342854752281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343005956037
                                         uncertainty =       0.007769153354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343005956037
                                         uncertainty =       0.007769153354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414047897
  error estimate for blocks of size 2^( 2) =       0.000425692706
  error estimate for blocks of size 2^( 3) =       0.000437998429
  error estimate for blocks of size 2^( 4) =       0.000449945587
  error estimate for blocks of size 2^( 5) =       0.000461084986
  error estimate for blocks of size 2^( 6) =       0.000470109737
  error estimate for blocks of size 2^( 7) =       0.000476832403

      target function =                  N/A
              le_mean =     -16.910973682886
             les_mean =     286.323902053745
             stat err =       0.000464493178
             autocorr =       1.258512444085
              std dev =       0.585552151325
             le_variance =       0.342871321921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342997888471
                                         uncertainty =       0.007769128627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342997888471
                                         uncertainty =       0.007769128627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414043026
  error estimate for blocks of size 2^( 2) =       0.000425687951
  error estimate for blocks of size 2^( 3) =       0.000437993845
  error estimate for blocks of size 2^( 4) =       0.000449941286
  error estimate for blocks of size 2^( 5) =       0.000461080934
  error estimate for blocks of size 2^( 6) =       0.000470105721
  error estimate for blocks of size 2^( 7) =       0.000476828535

      target function =                  N/A
              le_mean =     -16.910973645380
             les_mean =     286.323892717325
             stat err =       0.000464489119
             autocorr =       1.258520059839
              std dev =       0.585545262140
             le_variance =       0.342863254014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342990456521
                                         uncertainty =       0.007769097633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342990456521
                                         uncertainty =       0.007769097633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414038538
  error estimate for blocks of size 2^( 2) =       0.000425683572
  error estimate for blocks of size 2^( 3) =       0.000437989621
  error estimate for blocks of size 2^( 4) =       0.000449937319
  error estimate for blocks of size 2^( 5) =       0.000461077198
  error estimate for blocks of size 2^( 6) =       0.000470102022
  error estimate for blocks of size 2^( 7) =       0.000476824973

      target function =                  N/A
              le_mean =     -16.910973610252
             les_mean =     286.323884097007
             stat err =       0.000464485378
             autocorr =       1.258527069126
              std dev =       0.585538915705
             le_variance =       0.342855821805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910973605219        initial
     9.0949e+00     9.0949e+01             2.9125e-05       -16.910973682886  <--
     3.6380e+01     3.6380e+02             7.2848e-06       -16.910973645380
     1.4552e+02     1.4552e+03             1.8214e-06       -16.910973610252

*****************************************************************************
Applying the update for shift_i =   9.0949e+00     and shift_s =   9.0949e+01
*****************************************************************************

  Execution time = 4.0279e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.090385e-01 1 1  ON 0
 uu_1                 1.437967e-01 1 1  ON 1
 uu_2                 4.531408e-02 1 1  ON 2
 uu_3                -1.724637e-02 1 1  ON 3
 uu_4                -6.477700e-02 1 1  ON 4
 uu_5                -9.953145e-02 1 1  ON 5
 uu_6                -1.255119e-01 1 1  ON 6
 uu_7                -1.368765e-01 1 1  ON 7
 uu_8                -1.274529e-01 1 1  ON 8
 uu_9                -9.857011e-02 1 1  ON 9
 ud_0                 4.283691e-01 1 1  ON 10
 ud_1                 1.729969e-01 1 1  ON 11
 ud_2                 6.199368e-02 1 1  ON 12
 ud_3                -4.761491e-03 1 1  ON 13
 ud_4                -5.974558e-02 1 1  ON 14
 ud_5                -1.016643e-01 1 1  ON 15
 ud_6                -1.301760e-01 1 1  ON 16
 ud_7                -1.480099e-01 1 1  ON 17
 ud_8                -1.506820e-01 1 1  ON 18
 ud_9                -1.400389e-01 1 1  ON 19
 eO_0                -7.428554e-01 1 1  ON 20
 eO_1                -4.295885e-01 1 1  ON 21
 eO_2                -1.812824e-02 1 1  ON 22
 eO_3                 2.953253e-01 1 1  ON 23
 eO_4                 5.130145e-01 1 1  ON 24
 eO_5                 4.683088e-01 1 1  ON 25
 eO_6                 2.392962e-01 1 1  ON 26
 eO_7                -5.268021e-02 1 1  ON 27
 eO_8                -2.072575e-01 1 1  ON 28
 eO_9                -6.695742e-02 1 1  ON 29
eH1_0                -2.399328e-01 1 1  ON 30
eH1_1                -1.373260e-01 1 1  ON 31
eH1_2                -9.418906e-02 1 1  ON 32
eH1_3                -4.260385e-02 1 1  ON 33
eH1_4                 1.250538e-02 1 1  ON 34
eH1_5                 4.899225e-02 1 1  ON 35
eH1_6                 1.049527e-01 1 1  ON 36
eH1_7                 1.513375e-01 1 1  ON 37
eH1_8                 1.596926e-01 1 1  ON 38
eH1_9                 4.231500e-02 1 1  ON 39
eH2_0                -2.392144e-01 1 1  ON 40
eH2_1                -1.357410e-01 1 1  ON 41
eH2_2                -9.276738e-02 1 1  ON 42
eH2_3                -4.115284e-02 1 1  ON 43
eH2_4                 1.453909e-02 1 1  ON 44
eH2_5                 5.206164e-02 1 1  ON 45
eH2_6                 1.091962e-01 1 1  ON 46
eH2_7                 1.554397e-01 1 1  ON 47
eH2_8                 1.673754e-01 1 1  ON 48
eH2_9                 2.786365e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8881
    reference variance = 0.19035
====================================================
  Execution time = 2.5402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336601150529
                                         uncertainty =       0.006447394001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336601150529
                                         uncertainty =       0.006447394001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410175600
  error estimate for blocks of size 2^( 2) =       0.000421531606
  error estimate for blocks of size 2^( 3) =       0.000433402419
  error estimate for blocks of size 2^( 4) =       0.000445106419
  error estimate for blocks of size 2^( 5) =       0.000454698363
  error estimate for blocks of size 2^( 6) =       0.000462269895
  error estimate for blocks of size 2^( 7) =       0.000465835185

      target function =                  N/A
              le_mean =     -16.911266133886
             les_mean =     286.327410127768
             stat err =       0.000456977465
             autocorr =       1.241223318539
              std dev =       0.580075895803
             le_variance =       0.336488044892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691126613389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911266133886       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911266175944       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911266301732       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911266317732       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911266551886       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911266531509       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911266530407       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911266543340       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+00 is 1.253108e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911266133886       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911266145148       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911266179218       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911266182570       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911266243556       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911266237943       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911266233446       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911266237053       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 3.143928e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911266133886       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911266136752       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911266145460       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911266146257       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911266161625       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911266160225       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911266158845       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911266159741       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 7.867144e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4214e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.090405e-01 1 1  ON 0
 uu_1                 1.437962e-01 1 1  ON 1
 uu_2                 4.531957e-02 1 1  ON 2
 uu_3                -1.723607e-02 1 1  ON 3
 uu_4                -6.477832e-02 1 1  ON 4
 uu_5                -9.953379e-02 1 1  ON 5
 uu_6                -1.255050e-01 1 1  ON 6
 uu_7                -1.368903e-01 1 1  ON 7
 uu_8                -1.274659e-01 1 1  ON 8
 uu_9                -9.858059e-02 1 1  ON 9
 ud_0                 4.283735e-01 1 1  ON 10
 ud_1                 1.730038e-01 1 1  ON 11
 ud_2                 6.201400e-02 1 1  ON 12
 ud_3                -4.763673e-03 1 1  ON 13
 ud_4                -5.974359e-02 1 1  ON 14
 ud_5                -1.016618e-01 1 1  ON 15
 ud_6                -1.301704e-01 1 1  ON 16
 ud_7                -1.480242e-01 1 1  ON 17
 ud_8                -1.506919e-01 1 1  ON 18
 ud_9                -1.400435e-01 1 1  ON 19
 eO_0                -7.428648e-01 1 1  ON 20
 eO_1                -4.295986e-01 1 1  ON 21
 eO_2                -1.813747e-02 1 1  ON 22
 eO_3                 2.953386e-01 1 1  ON 23
 eO_4                 5.130394e-01 1 1  ON 24
 eO_5                 4.683252e-01 1 1  ON 25
 eO_6                 2.393045e-01 1 1  ON 26
 eO_7                -5.267439e-02 1 1  ON 27
 eO_8                -2.072780e-01 1 1  ON 28
 eO_9                -6.697481e-02 1 1  ON 29
eH1_0                -2.399490e-01 1 1  ON 30
eH1_1                -1.373361e-01 1 1  ON 31
eH1_2                -9.420276e-02 1 1  ON 32
eH1_3                -4.262224e-02 1 1  ON 33
eH1_4                 1.249443e-02 1 1  ON 34
eH1_5                 4.899448e-02 1 1  ON 35
eH1_6                 1.049522e-01 1 1  ON 36
eH1_7                 1.513518e-01 1 1  ON 37
eH1_8                 1.597241e-01 1 1  ON 38
eH1_9                 4.233698e-02 1 1  ON 39
eH2_0                -2.392240e-01 1 1  ON 40
eH2_1                -1.357577e-01 1 1  ON 41
eH2_2                -9.278090e-02 1 1  ON 42
eH2_3                -4.116024e-02 1 1  ON 43
eH2_4                 1.453860e-02 1 1  ON 44
eH2_5                 5.205892e-02 1 1  ON 45
eH2_6                 1.092026e-01 1 1  ON 46
eH2_7                 1.554506e-01 1 1  ON 47
eH2_8                 1.673916e-01 1 1  ON 48
eH2_9                 2.788101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.20628
====================================================
  Execution time = 2.5338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3397e-01
  Total weights = 2.0000e+06
  Execution time = 2.9602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334000235176
                                         uncertainty =       0.003288444643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334000235176
                                         uncertainty =       0.003288444643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408644272
  error estimate for blocks of size 2^( 2) =       0.000420676571
  error estimate for blocks of size 2^( 3) =       0.000432575426
  error estimate for blocks of size 2^( 4) =       0.000444443949
  error estimate for blocks of size 2^( 5) =       0.000454862627
  error estimate for blocks of size 2^( 6) =       0.000462468994
  error estimate for blocks of size 2^( 7) =       0.000468594925

      target function =                  N/A
              le_mean =     -16.911323400364
             les_mean =     286.326839266306
             stat err =       0.000457592624
             autocorr =       1.253912406406
              std dev =       0.577910271225
             le_variance =       0.333980281588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333966286883
                                         uncertainty =       0.003288127904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333966286883
                                         uncertainty =       0.003288127904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408623500
  error estimate for blocks of size 2^( 2) =       0.000420657313
  error estimate for blocks of size 2^( 3) =       0.000432556812
  error estimate for blocks of size 2^( 4) =       0.000444425607
  error estimate for blocks of size 2^( 5) =       0.000454844968
  error estimate for blocks of size 2^( 6) =       0.000462451900
  error estimate for blocks of size 2^( 7) =       0.000468576923

      target function =                  N/A
              le_mean =     -16.911323163274
             les_mean =     286.326797295757
             stat err =       0.000457574850
             autocorr =       1.253942471224
              std dev =       0.577880896068
             le_variance =       0.333946330040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333980449064
                                         uncertainty =       0.003288261766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333980449064
                                         uncertainty =       0.003288261766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408632166
  error estimate for blocks of size 2^( 2) =       0.000420665350
  error estimate for blocks of size 2^( 3) =       0.000432564631
  error estimate for blocks of size 2^( 4) =       0.000444433379
  error estimate for blocks of size 2^( 5) =       0.000454852480
  error estimate for blocks of size 2^( 6) =       0.000462459176
  error estimate for blocks of size 2^( 7) =       0.000468584560

      target function =                  N/A
              le_mean =     -16.911323260514
             les_mean =     286.326814748292
             stat err =       0.000457582399
             autocorr =       1.253930663493
              std dev =       0.577893150747
             le_variance =       0.333960493680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333997655638
                                         uncertainty =       0.003288420880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333997655638
                                         uncertainty =       0.003288420880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408642693
  error estimate for blocks of size 2^( 2) =       0.000420675108
  error estimate for blocks of size 2^( 3) =       0.000432574020
  error estimate for blocks of size 2^( 4) =       0.000444442575
  error estimate for blocks of size 2^( 5) =       0.000454861309
  error estimate for blocks of size 2^( 6) =       0.000462467718
  error estimate for blocks of size 2^( 7) =       0.000468593577

      target function =                  N/A
              le_mean =     -16.911323381549
             les_mean =     286.326836050157
             stat err =       0.000457591295
             autocorr =       1.253914808148
              std dev =       0.577908039239
             le_variance =       0.333977701817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911323400364        initial  <--
     2.2737e+00     2.2737e+01             1.2531e-04       -16.911323163274
     9.0949e+00     9.0949e+01             3.1439e-05       -16.911323260514
     3.6380e+01     3.6380e+02             7.8671e-06       -16.911323381549

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1802
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.090385e-01 1 1  ON 0
 uu_1                 1.437967e-01 1 1  ON 1
 uu_2                 4.531408e-02 1 1  ON 2
 uu_3                -1.724637e-02 1 1  ON 3
 uu_4                -6.477700e-02 1 1  ON 4
 uu_5                -9.953145e-02 1 1  ON 5
 uu_6                -1.255119e-01 1 1  ON 6
 uu_7                -1.368765e-01 1 1  ON 7
 uu_8                -1.274529e-01 1 1  ON 8
 uu_9                -9.857011e-02 1 1  ON 9
 ud_0                 4.283691e-01 1 1  ON 10
 ud_1                 1.729969e-01 1 1  ON 11
 ud_2                 6.199368e-02 1 1  ON 12
 ud_3                -4.761491e-03 1 1  ON 13
 ud_4                -5.974558e-02 1 1  ON 14
 ud_5                -1.016643e-01 1 1  ON 15
 ud_6                -1.301760e-01 1 1  ON 16
 ud_7                -1.480099e-01 1 1  ON 17
 ud_8                -1.506820e-01 1 1  ON 18
 ud_9                -1.400389e-01 1 1  ON 19
 eO_0                -7.428554e-01 1 1  ON 20
 eO_1                -4.295885e-01 1 1  ON 21
 eO_2                -1.812824e-02 1 1  ON 22
 eO_3                 2.953253e-01 1 1  ON 23
 eO_4                 5.130145e-01 1 1  ON 24
 eO_5                 4.683088e-01 1 1  ON 25
 eO_6                 2.392962e-01 1 1  ON 26
 eO_7                -5.268021e-02 1 1  ON 27
 eO_8                -2.072575e-01 1 1  ON 28
 eO_9                -6.695742e-02 1 1  ON 29
eH1_0                -2.399328e-01 1 1  ON 30
eH1_1                -1.373260e-01 1 1  ON 31
eH1_2                -9.418906e-02 1 1  ON 32
eH1_3                -4.260385e-02 1 1  ON 33
eH1_4                 1.250538e-02 1 1  ON 34
eH1_5                 4.899225e-02 1 1  ON 35
eH1_6                 1.049527e-01 1 1  ON 36
eH1_7                 1.513375e-01 1 1  ON 37
eH1_8                 1.596926e-01 1 1  ON 38
eH1_9                 4.231500e-02 1 1  ON 39
eH2_0                -2.392144e-01 1 1  ON 40
eH2_1                -1.357410e-01 1 1  ON 41
eH2_2                -9.276738e-02 1 1  ON 42
eH2_3                -4.115284e-02 1 1  ON 43
eH2_4                 1.453909e-02 1 1  ON 44
eH2_5                 5.206164e-02 1 1  ON 45
eH2_6                 1.091962e-01 1 1  ON 46
eH2_7                 1.554397e-01 1 1  ON 47
eH2_8                 1.673754e-01 1 1  ON 48
eH2_9                 2.786365e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.7776
    reference variance = 0.365107
====================================================
  Execution time = 2.5655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337752029749
                                         uncertainty =       0.007455039533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337752029749
                                         uncertainty =       0.007455039533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410925865
  error estimate for blocks of size 2^( 2) =       0.000422795948
  error estimate for blocks of size 2^( 3) =       0.000435014221
  error estimate for blocks of size 2^( 4) =       0.000446305299
  error estimate for blocks of size 2^( 5) =       0.000457309663
  error estimate for blocks of size 2^( 6) =       0.000466323334
  error estimate for blocks of size 2^( 7) =       0.000473892135

      target function =                  N/A
              le_mean =     -16.911057693987
             les_mean =     286.321592293959
             stat err =       0.000460957607
             autocorr =       1.258331350993
              std dev =       0.581136931770
             le_variance =       0.337720133467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691105769399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911057693987       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911057704845       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911057752076       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911057781371       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911057787809       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911057786641       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911057784739       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911057784777       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 9.820414e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911057693987       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911057696716       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911057708677       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911057716017       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911057717627       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911057717359       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911057716896       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911057716898       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.456519e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911057693987       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911057694670       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911057697670       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911057699506       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911057699909       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911057699843       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911057699728       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911057699728       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 6.142179e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2225e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.090387e-01 1 1  ON 0
 uu_1                 1.437973e-01 1 1  ON 1
 uu_2                 4.531426e-02 1 1  ON 2
 uu_3                -1.724527e-02 1 1  ON 3
 uu_4                -6.477862e-02 1 1  ON 4
 uu_5                -9.953080e-02 1 1  ON 5
 uu_6                -1.255108e-01 1 1  ON 6
 uu_7                -1.368778e-01 1 1  ON 7
 uu_8                -1.274552e-01 1 1  ON 8
 uu_9                -9.857117e-02 1 1  ON 9
 ud_0                 4.283688e-01 1 1  ON 10
 ud_1                 1.729967e-01 1 1  ON 11
 ud_2                 6.199493e-02 1 1  ON 12
 ud_3                -4.761264e-03 1 1  ON 13
 ud_4                -5.974572e-02 1 1  ON 14
 ud_5                -1.016632e-01 1 1  ON 15
 ud_6                -1.301763e-01 1 1  ON 16
 ud_7                -1.480108e-01 1 1  ON 17
 ud_8                -1.506823e-01 1 1  ON 18
 ud_9                -1.400390e-01 1 1  ON 19
 eO_0                -7.428573e-01 1 1  ON 20
 eO_1                -4.295893e-01 1 1  ON 21
 eO_2                -1.812964e-02 1 1  ON 22
 eO_3                 2.953275e-01 1 1  ON 23
 eO_4                 5.130158e-01 1 1  ON 24
 eO_5                 4.683112e-01 1 1  ON 25
 eO_6                 2.392978e-01 1 1  ON 26
 eO_7                -5.268008e-02 1 1  ON 27
 eO_8                -2.072593e-01 1 1  ON 28
 eO_9                -6.695891e-02 1 1  ON 29
eH1_0                -2.399347e-01 1 1  ON 30
eH1_1                -1.373261e-01 1 1  ON 31
eH1_2                -9.419102e-02 1 1  ON 32
eH1_3                -4.260599e-02 1 1  ON 33
eH1_4                 1.250508e-02 1 1  ON 34
eH1_5                 4.899286e-02 1 1  ON 35
eH1_6                 1.049535e-01 1 1  ON 36
eH1_7                 1.513392e-01 1 1  ON 37
eH1_8                 1.596946e-01 1 1  ON 38
eH1_9                 4.231661e-02 1 1  ON 39
eH2_0                -2.392159e-01 1 1  ON 40
eH2_1                -1.357425e-01 1 1  ON 41
eH2_2                -9.276860e-02 1 1  ON 42
eH2_3                -4.115368e-02 1 1  ON 43
eH2_4                 1.453707e-02 1 1  ON 44
eH2_5                 5.206217e-02 1 1  ON 45
eH2_6                 1.091979e-01 1 1  ON 46
eH2_7                 1.554405e-01 1 1  ON 47
eH2_8                 1.673771e-01 1 1  ON 48
eH2_9                 2.786583e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.268941
====================================================
  Execution time = 2.5161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2617e-01
  Total weights = 2.0000e+06
  Execution time = 2.9430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326285046692
                                         uncertainty =       0.002484173936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326285046692
                                         uncertainty =       0.002484173936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403839915
  error estimate for blocks of size 2^( 2) =       0.000416070468
  error estimate for blocks of size 2^( 3) =       0.000428669995
  error estimate for blocks of size 2^( 4) =       0.000440655821
  error estimate for blocks of size 2^( 5) =       0.000451536365
  error estimate for blocks of size 2^( 6) =       0.000458811426
  error estimate for blocks of size 2^( 7) =       0.000464407252

      target function =                  N/A
              le_mean =     -16.910553315888
             les_mean =     286.292986640050
             stat err =       0.000453852716
             autocorr =       1.263023392582
              std dev =       0.571115884610
             le_variance =       0.326173353654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326282466855
                                         uncertainty =       0.002484163328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326282466855
                                         uncertainty =       0.002484163328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403838318
  error estimate for blocks of size 2^( 2) =       0.000416069042
  error estimate for blocks of size 2^( 3) =       0.000428668661
  error estimate for blocks of size 2^( 4) =       0.000440654645
  error estimate for blocks of size 2^( 5) =       0.000451535110
  error estimate for blocks of size 2^( 6) =       0.000458809999
  error estimate for blocks of size 2^( 7) =       0.000464405806

      target function =                  N/A
              le_mean =     -16.910553359909
             les_mean =     286.292985549255
             stat err =       0.000453851390
             autocorr =       1.263026001490
              std dev =       0.571113626172
             le_variance =       0.326170774000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326283745711
                                         uncertainty =       0.002484168629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326283745711
                                         uncertainty =       0.002484168629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403839110
  error estimate for blocks of size 2^( 2) =       0.000416069749
  error estimate for blocks of size 2^( 3) =       0.000428669323
  error estimate for blocks of size 2^( 4) =       0.000440655229
  error estimate for blocks of size 2^( 5) =       0.000451535733
  error estimate for blocks of size 2^( 6) =       0.000458810707
  error estimate for blocks of size 2^( 7) =       0.000464406524

      target function =                  N/A
              le_mean =     -16.910553338188
             les_mean =     286.292986093374
             stat err =       0.000453852048
             autocorr =       1.263024712192
              std dev =       0.571114745712
             le_variance =       0.326172052769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326284883672
                                         uncertainty =       0.002484173273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326284883672
                                         uncertainty =       0.002484173273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403839814
  error estimate for blocks of size 2^( 2) =       0.000416070378
  error estimate for blocks of size 2^( 3) =       0.000428669911
  error estimate for blocks of size 2^( 4) =       0.000440655747
  error estimate for blocks of size 2^( 5) =       0.000451536286
  error estimate for blocks of size 2^( 6) =       0.000458811336
  error estimate for blocks of size 2^( 7) =       0.000464407161

      target function =                  N/A
              le_mean =     -16.910553318677
             les_mean =     286.292986571365
             stat err =       0.000453852632
             autocorr =       1.263023558004
              std dev =       0.571115741900
             le_variance =       0.326173190646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910553315888        initial
     2.2737e+01     2.2737e+02             9.8204e-06       -16.910553359909  <--
     9.0949e+01     9.0949e+02             2.4565e-06       -16.910553338188
     3.6380e+02     3.6380e+03             6.1422e-07       -16.910553318677

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 3.9992e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.090392e-01 1 1  ON 0
 uu_1                 1.437992e-01 1 1  ON 1
 uu_2                 4.531485e-02 1 1  ON 2
 uu_3                -1.724205e-02 1 1  ON 3
 uu_4                -6.478339e-02 1 1  ON 4
 uu_5                -9.952892e-02 1 1  ON 5
 uu_6                -1.255073e-01 1 1  ON 6
 uu_7                -1.368816e-01 1 1  ON 7
 uu_8                -1.274621e-01 1 1  ON 8
 uu_9                -9.857436e-02 1 1  ON 9
 ud_0                 4.283680e-01 1 1  ON 10
 ud_1                 1.729961e-01 1 1  ON 11
 ud_2                 6.199863e-02 1 1  ON 12
 ud_3                -4.760567e-03 1 1  ON 13
 ud_4                -5.974615e-02 1 1  ON 14
 ud_5                -1.016598e-01 1 1  ON 15
 ud_6                -1.301772e-01 1 1  ON 16
 ud_7                -1.480133e-01 1 1  ON 17
 ud_8                -1.506832e-01 1 1  ON 18
 ud_9                -1.400391e-01 1 1  ON 19
 eO_0                -7.428630e-01 1 1  ON 20
 eO_1                -4.295918e-01 1 1  ON 21
 eO_2                -1.813379e-02 1 1  ON 22
 eO_3                 2.953343e-01 1 1  ON 23
 eO_4                 5.130197e-01 1 1  ON 24
 eO_5                 4.683186e-01 1 1  ON 25
 eO_6                 2.393023e-01 1 1  ON 26
 eO_7                -5.267969e-02 1 1  ON 27
 eO_8                -2.072648e-01 1 1  ON 28
 eO_9                -6.696338e-02 1 1  ON 29
eH1_0                -2.399403e-01 1 1  ON 30
eH1_1                -1.373266e-01 1 1  ON 31
eH1_2                -9.419688e-02 1 1  ON 32
eH1_3                -4.261236e-02 1 1  ON 33
eH1_4                 1.250412e-02 1 1  ON 34
eH1_5                 4.899470e-02 1 1  ON 35
eH1_6                 1.049560e-01 1 1  ON 36
eH1_7                 1.513442e-01 1 1  ON 37
eH1_8                 1.597005e-01 1 1  ON 38
eH1_9                 4.232142e-02 1 1  ON 39
eH2_0                -2.392206e-01 1 1  ON 40
eH2_1                -1.357470e-01 1 1  ON 41
eH2_2                -9.277230e-02 1 1  ON 42
eH2_3                -4.115620e-02 1 1  ON 43
eH2_4                 1.453104e-02 1 1  ON 44
eH2_5                 5.206376e-02 1 1  ON 45
eH2_6                 1.092028e-01 1 1  ON 46
eH2_7                 1.554430e-01 1 1  ON 47
eH2_8                 1.673824e-01 1 1  ON 48
eH2_9                 2.787236e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.308767
====================================================
  Execution time = 2.5393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337403319332
                                         uncertainty =       0.004297631843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337403319332
                                         uncertainty =       0.004297631843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410670447
  error estimate for blocks of size 2^( 2) =       0.000422230128
  error estimate for blocks of size 2^( 3) =       0.000434986927
  error estimate for blocks of size 2^( 4) =       0.000447197482
  error estimate for blocks of size 2^( 5) =       0.000457617426
  error estimate for blocks of size 2^( 6) =       0.000467167968
  error estimate for blocks of size 2^( 7) =       0.000471883295

      target function =                  N/A
              le_mean =     -16.909275188337
             les_mean =     286.260887658299
             stat err =       0.000460966543
             autocorr =       1.259945931931
              std dev =       0.580775715781
             le_variance =       0.337300432040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690927518834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909275188337       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909275310865       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909275318201       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909275295960       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909275251505       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909275282365       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909275313222       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909275332241       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 4.632873e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909275188337       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909275219867       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909275222261       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909275216934       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909275205586       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909275213099       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909275220541       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909275224428       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 1.159980e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909275188337       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909275196278       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909275196914       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909275195599       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909275192754       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909275194619       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909275196459       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909275197373       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.901045e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1937e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.090432e-01 1 1  ON 0
 uu_1                 1.437994e-01 1 1  ON 1
 uu_2                 4.531342e-02 1 1  ON 2
 uu_3                -1.723970e-02 1 1  ON 3
 uu_4                -6.479201e-02 1 1  ON 4
 uu_5                -9.953009e-02 1 1  ON 5
 uu_6                -1.255056e-01 1 1  ON 6
 uu_7                -1.368809e-01 1 1  ON 7
 uu_8                -1.274673e-01 1 1  ON 8
 uu_9                -9.857730e-02 1 1  ON 9
 ud_0                 4.283759e-01 1 1  ON 10
 ud_1                 1.729989e-01 1 1  ON 11
 ud_2                 6.199765e-02 1 1  ON 12
 ud_3                -4.761882e-03 1 1  ON 13
 ud_4                -5.974609e-02 1 1  ON 14
 ud_5                -1.016629e-01 1 1  ON 15
 ud_6                -1.301796e-01 1 1  ON 16
 ud_7                -1.480211e-01 1 1  ON 17
 ud_8                -1.506830e-01 1 1  ON 18
 ud_9                -1.400361e-01 1 1  ON 19
 eO_0                -7.428650e-01 1 1  ON 20
 eO_1                -4.296030e-01 1 1  ON 21
 eO_2                -1.813504e-02 1 1  ON 22
 eO_3                 2.953431e-01 1 1  ON 23
 eO_4                 5.130268e-01 1 1  ON 24
 eO_5                 4.683258e-01 1 1  ON 25
 eO_6                 2.393057e-01 1 1  ON 26
 eO_7                -5.267804e-02 1 1  ON 27
 eO_8                -2.072723e-01 1 1  ON 28
 eO_9                -6.696878e-02 1 1  ON 29
eH1_0                -2.399464e-01 1 1  ON 30
eH1_1                -1.373265e-01 1 1  ON 31
eH1_2                -9.420512e-02 1 1  ON 32
eH1_3                -4.262258e-02 1 1  ON 33
eH1_4                 1.249950e-02 1 1  ON 34
eH1_5                 4.899182e-02 1 1  ON 35
eH1_6                 1.049588e-01 1 1  ON 36
eH1_7                 1.513552e-01 1 1  ON 37
eH1_8                 1.597121e-01 1 1  ON 38
eH1_9                 4.232879e-02 1 1  ON 39
eH2_0                -2.392301e-01 1 1  ON 40
eH2_1                -1.357499e-01 1 1  ON 41
eH2_2                -9.277837e-02 1 1  ON 42
eH2_3                -4.115586e-02 1 1  ON 43
eH2_4                 1.452881e-02 1 1  ON 44
eH2_5                 5.206061e-02 1 1  ON 45
eH2_6                 1.092053e-01 1 1  ON 46
eH2_7                 1.554450e-01 1 1  ON 47
eH2_8                 1.673891e-01 1 1  ON 48
eH2_9                 2.788292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9668
    reference variance = 0.231431
====================================================
  Execution time = 2.4912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3934e-01
  Total weights = 2.0000e+06
  Execution time = 2.9561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339386151232
                                         uncertainty =       0.004242138050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339386151232
                                         uncertainty =       0.004242138050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411905475
  error estimate for blocks of size 2^( 2) =       0.000424206996
  error estimate for blocks of size 2^( 3) =       0.000437214607
  error estimate for blocks of size 2^( 4) =       0.000449615525
  error estimate for blocks of size 2^( 5) =       0.000462352789
  error estimate for blocks of size 2^( 6) =       0.000473732411
  error estimate for blocks of size 2^( 7) =       0.000481757245

      target function =                  N/A
              le_mean =     -16.909262799804
             les_mean =     286.262500504072
             stat err =       0.000466864493
             autocorr =       1.284655144201
              std dev =       0.582522309372
             le_variance =       0.339332240916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414591517
                                         uncertainty =       0.004242624769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414591517
                                         uncertainty =       0.004242624769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411922724
  error estimate for blocks of size 2^( 2) =       0.000424223761
  error estimate for blocks of size 2^( 3) =       0.000437230637
  error estimate for blocks of size 2^( 4) =       0.000449630978
  error estimate for blocks of size 2^( 5) =       0.000462367706
  error estimate for blocks of size 2^( 6) =       0.000473747061
  error estimate for blocks of size 2^( 7) =       0.000481771467

      target function =                  N/A
              le_mean =     -16.909262943158
             les_mean =     286.262533773029
             stat err =       0.000466879303
             autocorr =       1.284629057741
              std dev =       0.582546703593
             le_variance =       0.339360661867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400950100
                                         uncertainty =       0.004242394474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400950100
                                         uncertainty =       0.004242394474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411914451
  error estimate for blocks of size 2^( 2) =       0.000424215717
  error estimate for blocks of size 2^( 3) =       0.000437222945
  error estimate for blocks of size 2^( 4) =       0.000449623565
  error estimate for blocks of size 2^( 5) =       0.000462360561
  error estimate for blocks of size 2^( 6) =       0.000473740058
  error estimate for blocks of size 2^( 7) =       0.000481764676

      target function =                  N/A
              le_mean =     -16.909262873324
             les_mean =     286.262517779289
             stat err =       0.000466872215
             autocorr =       1.284641655425
              std dev =       0.582535003068
             le_variance =       0.339347029800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339388019410
                                         uncertainty =       0.004242170543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339388019410
                                         uncertainty =       0.004242170543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411906608
  error estimate for blocks of size 2^( 2) =       0.000424208096
  error estimate for blocks of size 2^( 3) =       0.000437215659
  error estimate for blocks of size 2^( 4) =       0.000449616540
  error estimate for blocks of size 2^( 5) =       0.000462353770
  error estimate for blocks of size 2^( 6) =       0.000473733377
  error estimate for blocks of size 2^( 7) =       0.000481758184

      target function =                  N/A
              le_mean =     -16.909262808919
             les_mean =     286.262502679262
             stat err =       0.000466865468
             autocorr =       1.284653443361
              std dev =       0.582523911815
             le_variance =       0.339334107836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909262799804        initial
     5.6843e+00     5.6843e+01             4.6329e-05       -16.909262943158  <--
     2.2737e+01     2.2737e+02             1.1600e-05       -16.909262873324
     9.0949e+01     9.0949e+02             2.9010e-06       -16.909262808919

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 3.9776e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.090545e-01 1 1  ON 0
 uu_1                 1.438000e-01 1 1  ON 1
 uu_2                 4.530979e-02 1 1  ON 2
 uu_3                -1.723383e-02 1 1  ON 3
 uu_4                -6.481617e-02 1 1  ON 4
 uu_5                -9.953404e-02 1 1  ON 5
 uu_6                -1.255008e-01 1 1  ON 6
 uu_7                -1.368787e-01 1 1  ON 7
 uu_8                -1.274829e-01 1 1  ON 8
 uu_9                -9.858609e-02 1 1  ON 9
 ud_0                 4.283987e-01 1 1  ON 10
 ud_1                 1.730071e-01 1 1  ON 11
 ud_2                 6.199542e-02 1 1  ON 12
 ud_3                -4.765667e-03 1 1  ON 13
 ud_4                -5.974625e-02 1 1  ON 14
 ud_5                -1.016720e-01 1 1  ON 15
 ud_6                -1.301866e-01 1 1  ON 16
 ud_7                -1.480443e-01 1 1  ON 17
 ud_8                -1.506824e-01 1 1  ON 18
 ud_9                -1.400270e-01 1 1  ON 19
 eO_0                -7.428718e-01 1 1  ON 20
 eO_1                -4.296355e-01 1 1  ON 21
 eO_2                -1.813909e-02 1 1  ON 22
 eO_3                 2.953696e-01 1 1  ON 23
 eO_4                 5.130483e-01 1 1  ON 24
 eO_5                 4.683472e-01 1 1  ON 25
 eO_6                 2.393156e-01 1 1  ON 26
 eO_7                -5.267307e-02 1 1  ON 27
 eO_8                -2.072949e-01 1 1  ON 28
 eO_9                -6.698491e-02 1 1  ON 29
eH1_0                -2.399646e-01 1 1  ON 30
eH1_1                -1.373270e-01 1 1  ON 31
eH1_2                -9.422982e-02 1 1  ON 32
eH1_3                -4.265248e-02 1 1  ON 33
eH1_4                 1.248522e-02 1 1  ON 34
eH1_5                 4.898338e-02 1 1  ON 35
eH1_6                 1.049675e-01 1 1  ON 36
eH1_7                 1.513881e-01 1 1  ON 37
eH1_8                 1.597469e-01 1 1  ON 38
eH1_9                 4.235082e-02 1 1  ON 39
eH2_0                -2.392583e-01 1 1  ON 40
eH2_1                -1.357583e-01 1 1  ON 41
eH2_2                -9.279645e-02 1 1  ON 42
eH2_3                -4.115508e-02 1 1  ON 43
eH2_4                 1.452213e-02 1 1  ON 44
eH2_5                 5.205126e-02 1 1  ON 45
eH2_6                 1.092128e-01 1 1  ON 46
eH2_7                 1.554510e-01 1 1  ON 47
eH2_8                 1.674092e-01 1 1  ON 48
eH2_9                 2.791451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1720e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.179982
====================================================
  Execution time = 2.5337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332927796929
                                         uncertainty =       0.003404394474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332927796929
                                         uncertainty =       0.003404394474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407986263
  error estimate for blocks of size 2^( 2) =       0.000419511729
  error estimate for blocks of size 2^( 3) =       0.000432060677
  error estimate for blocks of size 2^( 4) =       0.000443902940
  error estimate for blocks of size 2^( 5) =       0.000455373148
  error estimate for blocks of size 2^( 6) =       0.000462575324
  error estimate for blocks of size 2^( 7) =       0.000467931180

      target function =                  N/A
              le_mean =     -16.910360529535
             les_mean =     286.293198654133
             stat err =       0.000457445648
             autocorr =       1.257152372578
              std dev =       0.576979706519
             le_variance =       0.332905581735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691036052953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910360529535       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910360711077       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910360537090       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910360625372       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910361227126       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910361293382       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910361338820       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910361283010       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910361274241       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+00 is 1.784801e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910360529535       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910360579227       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910360522698       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910360538753       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910360688737       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910360712471       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910360722042       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910360710220       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 4.395184e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910360529535       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910360542260       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910360527098       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910360530657       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910360567916       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910360574284       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910360576757       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910360573887       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 1.100934e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1912e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.090801e-01 1 1  ON 0
 uu_1                 1.438021e-01 1 1  ON 1
 uu_2                 4.529586e-02 1 1  ON 2
 uu_3                -1.722666e-02 1 1  ON 3
 uu_4                -6.483802e-02 1 1  ON 4
 uu_5                -9.953417e-02 1 1  ON 5
 uu_6                -1.254901e-01 1 1  ON 6
 uu_7                -1.369033e-01 1 1  ON 7
 uu_8                -1.274919e-01 1 1  ON 8
 uu_9                -9.858817e-02 1 1  ON 9
 ud_0                 4.284286e-01 1 1  ON 10
 ud_1                 1.730108e-01 1 1  ON 11
 ud_2                 6.200369e-02 1 1  ON 12
 ud_3                -4.760885e-03 1 1  ON 13
 ud_4                -5.974838e-02 1 1  ON 14
 ud_5                -1.016787e-01 1 1  ON 15
 ud_6                -1.301861e-01 1 1  ON 16
 ud_7                -1.480616e-01 1 1  ON 17
 ud_8                -1.506873e-01 1 1  ON 18
 ud_9                -1.400365e-01 1 1  ON 19
 eO_0                -7.428719e-01 1 1  ON 20
 eO_1                -4.296624e-01 1 1  ON 21
 eO_2                -1.816845e-02 1 1  ON 22
 eO_3                 2.954065e-01 1 1  ON 23
 eO_4                 5.130699e-01 1 1  ON 24
 eO_5                 4.683759e-01 1 1  ON 25
 eO_6                 2.393313e-01 1 1  ON 26
 eO_7                -5.267166e-02 1 1  ON 27
 eO_8                -2.073166e-01 1 1  ON 28
 eO_9                -6.700761e-02 1 1  ON 29
eH1_0                -2.399909e-01 1 1  ON 30
eH1_1                -1.373245e-01 1 1  ON 31
eH1_2                -9.426447e-02 1 1  ON 32
eH1_3                -4.268185e-02 1 1  ON 33
eH1_4                 1.247922e-02 1 1  ON 34
eH1_5                 4.896771e-02 1 1  ON 35
eH1_6                 1.049877e-01 1 1  ON 36
eH1_7                 1.514133e-01 1 1  ON 37
eH1_8                 1.597850e-01 1 1  ON 38
eH1_9                 4.237706e-02 1 1  ON 39
eH2_0                -2.392848e-01 1 1  ON 40
eH2_1                -1.357859e-01 1 1  ON 41
eH2_2                -9.281310e-02 1 1  ON 42
eH2_3                -4.115691e-02 1 1  ON 43
eH2_4                 1.452259e-02 1 1  ON 44
eH2_5                 5.202646e-02 1 1  ON 45
eH2_6                 1.092064e-01 1 1  ON 46
eH2_7                 1.554698e-01 1 1  ON 47
eH2_8                 1.674494e-01 1 1  ON 48
eH2_9                 2.795846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9341
    reference variance = 0.278664
====================================================
  Execution time = 2.5148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4739e-01
  Total weights = 2.0000e+06
  Execution time = 2.9615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347453187275
                                         uncertainty =       0.015759354702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347453187275
                                         uncertainty =       0.015759354702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416750011
  error estimate for blocks of size 2^( 2) =       0.000428039629
  error estimate for blocks of size 2^( 3) =       0.000439414527
  error estimate for blocks of size 2^( 4) =       0.000451034802
  error estimate for blocks of size 2^( 5) =       0.000460569472
  error estimate for blocks of size 2^( 6) =       0.000469285579
  error estimate for blocks of size 2^( 7) =       0.000473881809

      target function =                  N/A
              le_mean =     -16.910892945601
             les_mean =     286.325661186729
             stat err =       0.000463692916
             autocorr =       1.237968750645
              std dev =       0.589373517233
             le_variance =       0.347361142816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347543371762
                                         uncertainty =       0.015759800326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347543371762
                                         uncertainty =       0.015759800326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416804078
  error estimate for blocks of size 2^( 2) =       0.000428092343
  error estimate for blocks of size 2^( 3) =       0.000439466008
  error estimate for blocks of size 2^( 4) =       0.000451084796
  error estimate for blocks of size 2^( 5) =       0.000460615169
  error estimate for blocks of size 2^( 6) =       0.000469329408
  error estimate for blocks of size 2^( 7) =       0.000473930530

      target function =                  N/A
              le_mean =     -16.910893469679
             les_mean =     286.325769048189
             stat err =       0.000463739976
             autocorr =       1.237898825531
              std dev =       0.589449980141
             le_variance =       0.347451279088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347509236217
                                         uncertainty =       0.015760088936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347509236217
                                         uncertainty =       0.015760088936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416783613
  error estimate for blocks of size 2^( 2) =       0.000428072341
  error estimate for blocks of size 2^( 3) =       0.000439446436
  error estimate for blocks of size 2^( 4) =       0.000451065859
  error estimate for blocks of size 2^( 5) =       0.000460598113
  error estimate for blocks of size 2^( 6) =       0.000469313155
  error estimate for blocks of size 2^( 7) =       0.000473912165

      target function =                  N/A
              le_mean =     -16.910893246587
             les_mean =     286.325727383618
             stat err =       0.000463722323
             autocorr =       1.237926145416
              std dev =       0.589421037860
             le_variance =       0.347417159872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347460618959
                                         uncertainty =       0.015759486765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347460618959
                                         uncertainty =       0.015759486765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416754466
  error estimate for blocks of size 2^( 2) =       0.000428043964
  error estimate for blocks of size 2^( 3) =       0.000439418753
  error estimate for blocks of size 2^( 4) =       0.000451038919
  error estimate for blocks of size 2^( 5) =       0.000460573275
  error estimate for blocks of size 2^( 6) =       0.000469289244
  error estimate for blocks of size 2^( 7) =       0.000473885827

      target function =                  N/A
              le_mean =     -16.910892981849
             les_mean =     286.325669840076
             stat err =       0.000463696816
             autocorr =       1.237963108824
              std dev =       0.589379818286
             le_variance =       0.347368570203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910892945601        initial
     1.4211e+00     1.4211e+01             1.7848e-04       -16.910893469679  <--
     5.6843e+00     5.6843e+01             4.3952e-05       -16.910893246587
     2.2737e+01     2.2737e+02             1.1009e-05       -16.910892981849

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 4.0005e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091451e-01 1 1  ON 0
 uu_1                 1.438076e-01 1 1  ON 1
 uu_2                 4.526876e-02 1 1  ON 2
 uu_3                -1.721964e-02 1 1  ON 3
 uu_4                -6.488875e-02 1 1  ON 4
 uu_5                -9.954102e-02 1 1  ON 5
 uu_6                -1.254622e-01 1 1  ON 6
 uu_7                -1.369702e-01 1 1  ON 7
 uu_8                -1.275182e-01 1 1  ON 8
 uu_9                -9.859529e-02 1 1  ON 9
 ud_0                 4.284984e-01 1 1  ON 10
 ud_1                 1.730259e-01 1 1  ON 11
 ud_2                 6.202993e-02 1 1  ON 12
 ud_3                -4.743695e-03 1 1  ON 13
 ud_4                -5.975048e-02 1 1  ON 14
 ud_5                -1.016923e-01 1 1  ON 15
 ud_6                -1.301851e-01 1 1  ON 16
 ud_7                -1.481098e-01 1 1  ON 17
 ud_8                -1.507025e-01 1 1  ON 18
 ud_9                -1.400661e-01 1 1  ON 19
 eO_0                -7.428886e-01 1 1  ON 20
 eO_1                -4.297340e-01 1 1  ON 21
 eO_2                -1.824421e-02 1 1  ON 22
 eO_3                 2.955075e-01 1 1  ON 23
 eO_4                 5.131383e-01 1 1  ON 24
 eO_5                 4.684636e-01 1 1  ON 25
 eO_6                 2.393809e-01 1 1  ON 26
 eO_7                -5.266611e-02 1 1  ON 27
 eO_8                -2.073836e-01 1 1  ON 28
 eO_9                -6.707734e-02 1 1  ON 29
eH1_0                -2.400678e-01 1 1  ON 30
eH1_1                -1.373305e-01 1 1  ON 31
eH1_2                -9.436432e-02 1 1  ON 32
eH1_3                -4.276759e-02 1 1  ON 33
eH1_4                 1.245707e-02 1 1  ON 34
eH1_5                 4.892510e-02 1 1  ON 35
eH1_6                 1.050477e-01 1 1  ON 36
eH1_7                 1.514894e-01 1 1  ON 37
eH1_8                 1.599022e-01 1 1  ON 38
eH1_9                 4.245759e-02 1 1  ON 39
eH2_0                -2.393653e-01 1 1  ON 40
eH2_1                -1.358647e-01 1 1  ON 41
eH2_2                -9.286237e-02 1 1  ON 42
eH2_3                -4.116637e-02 1 1  ON 43
eH2_4                 1.451613e-02 1 1  ON 44
eH2_5                 5.195402e-02 1 1  ON 45
eH2_6                 1.091876e-01 1 1  ON 46
eH2_7                 1.555268e-01 1 1  ON 47
eH2_8                 1.675721e-01 1 1  ON 48
eH2_9                 2.809299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1924e+01 secs
  Total Execution time = 2.9366e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
