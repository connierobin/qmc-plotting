Rank =    0  Free Memory = 70173 MB
Rank =    1  Free Memory = 70172 MB
Rank =    2  Free Memory = 70172 MB
Rank =    3  Free Memory = 70172 MB
Rank =    4  Free Memory = 70172 MB
Rank =    5  Free Memory = 70172 MB
Rank =    6  Free Memory = 70172 MB
Rank =    7  Free Memory = 70172 MB
Rank =    8  Free Memory = 70172 MB
Rank =    9  Free Memory = 70172 MB
Rank =   10  Free Memory = 70172 MB
Rank =   11  Free Memory = 70172 MB
Rank =   12  Free Memory = 70172 MB
Rank =   13  Free Memory = 70172 MB
Rank =   14  Free Memory = 70171 MB
Rank =   15  Free Memory = 70156 MB
Rank =   16  Free Memory = 70156 MB
Rank =   17  Free Memory = 70155 MB
Rank =   18  Free Memory = 70155 MB
Rank =   19  Free Memory = 70155 MB
Rank =   20  Free Memory = 70155 MB
Rank =   21  Free Memory = 70155 MB
Rank =   22  Free Memory = 70155 MB
Rank =   23  Free Memory = 70155 MB
Rank =   24  Free Memory = 70155 MB
Rank =   25  Free Memory = 70155 MB
Rank =   26  Free Memory = 70155 MB
Rank =   27  Free Memory = 70155 MB
Rank =   28  Free Memory = 70155 MB
Rank =   29  Free Memory = 70155 MB
Rank =   30  Free Memory = 70155 MB
Rank =   31  Free Memory = 70155 MB
Rank =   32  Free Memory = 77980 MB
Rank =   33  Free Memory = 77980 MB
Rank =   34  Free Memory = 77980 MB
Rank =   35  Free Memory = 77980 MB
Rank =   36  Free Memory = 77980 MB
Rank =   37  Free Memory = 77980 MB
Rank =   38  Free Memory = 77980 MB
Rank =   39  Free Memory = 77980 MB
Rank =   40  Free Memory = 77980 MB
Rank =   41  Free Memory = 77980 MB
Rank =   42  Free Memory = 77980 MB
Rank =   43  Free Memory = 77980 MB
Rank =   44  Free Memory = 77980 MB
Rank =   45  Free Memory = 77980 MB
Rank =   46  Free Memory = 77980 MB
Rank =   47  Free Memory = 77980 MB
Rank =   48  Free Memory = 77980 MB
Rank =   49  Free Memory = 77980 MB
Rank =   50  Free Memory = 77980 MB
Rank =   51  Free Memory = 77980 MB
Rank =   52  Free Memory = 77980 MB
Rank =   53  Free Memory = 77980 MB
Rank =   54  Free Memory = 77980 MB
Rank =   55  Free Memory = 77980 MB
Rank =   56  Free Memory = 77980 MB
Rank =   57  Free Memory = 77980 MB
Rank =   58  Free Memory = 77980 MB
Rank =   59  Free Memory = 77980 MB
Rank =   60  Free Memory = 77980 MB
Rank =   61  Free Memory = 77980 MB
Rank =   62  Free Memory = 77980 MB
Rank =   63  Free Memory = 77980 MB
Rank =   64  Free Memory = 71942 MB
Rank =   65  Free Memory = 71942 MB
Rank =   66  Free Memory = 71941 MB
Rank =   67  Free Memory = 71941 MB
Rank =   68  Free Memory = 71941 MB
Rank =   69  Free Memory = 71941 MB
Rank =   70  Free Memory = 71941 MB
Rank =   71  Free Memory = 71941 MB
Rank =   72  Free Memory = 71941 MB
Rank =   73  Free Memory = 71941 MB
Rank =   74  Free Memory = 71941 MB
Rank =   75  Free Memory = 71941 MB
Rank =   76  Free Memory = 71941 MB
Rank =   77  Free Memory = 71941 MB
Rank =   78  Free Memory = 71941 MB
Rank =   79  Free Memory = 71941 MB
Rank =   80  Free Memory = 71941 MB
Rank =   81  Free Memory = 71941 MB
Rank =   82  Free Memory = 71941 MB
Rank =   83  Free Memory = 71941 MB
Rank =   84  Free Memory = 71941 MB
Rank =   85  Free Memory = 71941 MB
Rank =   86  Free Memory = 71941 MB
Rank =   87  Free Memory = 71941 MB
Rank =   88  Free Memory = 71941 MB
Rank =   89  Free Memory = 71941 MB
Rank =   90  Free Memory = 71941 MB
Rank =   91  Free Memory = 71941 MB
Rank =   92  Free Memory = 71941 MB
Rank =   93  Free Memory = 71941 MB
Rank =   94  Free Memory = 71941 MB
Rank =   95  Free Memory = 71941 MB
Rank =   96  Free Memory = 74936 MB
Rank =   97  Free Memory = 74936 MB
Rank =   98  Free Memory = 74936 MB
Rank =   99  Free Memory = 74936 MB
Rank =  100  Free Memory = 74936 MB
Rank =  101  Free Memory = 74936 MB
Rank =  102  Free Memory = 74936 MB
Rank =  103  Free Memory = 74936 MB
Rank =  104  Free Memory = 74936 MB
Rank =  105  Free Memory = 74936 MB
Rank =  106  Free Memory = 74936 MB
Rank =  107  Free Memory = 74936 MB
Rank =  108  Free Memory = 74936 MB
Rank =  109  Free Memory = 74935 MB
Rank =  110  Free Memory = 74935 MB
Rank =  111  Free Memory = 74935 MB
Rank =  112  Free Memory = 74935 MB
Rank =  113  Free Memory = 74935 MB
Rank =  114  Free Memory = 74935 MB
Rank =  115  Free Memory = 74935 MB
Rank =  116  Free Memory = 74935 MB
Rank =  117  Free Memory = 74935 MB
Rank =  118  Free Memory = 74935 MB
Rank =  119  Free Memory = 74935 MB
Rank =  120  Free Memory = 74935 MB
Rank =  121  Free Memory = 74935 MB
Rank =  122  Free Memory = 74935 MB
Rank =  123  Free Memory = 74935 MB
Rank =  124  Free Memory = 74935 MB
Rank =  125  Free Memory = 74935 MB
Rank =  126  Free Memory = 74935 MB
Rank =  127  Free Memory = 74935 MB
  Input file(s): opt_h2o_1b1_gvptt_369dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_369dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:23:35 PDT
  host    = n0087.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 23

  Range of prime numbers to use as seeds over processors and threads = 97-883


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 369 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.821259e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 79 unique up determinants.
Found 79 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3330e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.279253
====================================================
  Execution time = 2.6281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330463567102
                                         uncertainty =       0.003811189492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330463567102
                                         uncertainty =       0.003811189492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406486136
  error estimate for blocks of size 2^( 2) =       0.000419387069
  error estimate for blocks of size 2^( 3) =       0.000433217795
  error estimate for blocks of size 2^( 4) =       0.000445122933
  error estimate for blocks of size 2^( 5) =       0.000455808984
  error estimate for blocks of size 2^( 6) =       0.000464541645
  error estimate for blocks of size 2^( 7) =       0.000468131638

      target function =                  N/A
              le_mean =     -16.908910138213
             les_mean =     286.241703854980
             stat err =       0.000458401300
             autocorr =       1.271745486908
              std dev =       0.574858206900
             le_variance =       0.330461958040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690891013821e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908910138213       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909094439217       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909194483071       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909263013641       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909302850713       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909323372906       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909337774106       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909338719991       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909341099274       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909343442936       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909343137407       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909343812587       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909343457666       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.172206e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908910138213       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908980311813       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909032178514       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909053106296       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909066050500       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909071625707       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909076230198       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909076710039       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909077014111       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909077047765       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909077153169       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.117677e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908910138213       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908930320379       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908947525647       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908953134349       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908956281595       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908957847848       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908958867785       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908959231552       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908959186731       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908959171769       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908959189692       residual = 7.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.171282e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2931e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.024406e-01                 1 1 ON  0
uu_1  1.389519e-01                 1 1 ON  1
uu_2  4.179030e-02                 1 1 ON  2
uu_3  -1.896776e-02                1 1 ON  3
uu_4  -6.319965e-02                1 1 ON  4
uu_5  -9.589056e-02                1 1 ON  5
uu_6  -1.205749e-01                1 1 ON  6
uu_7  -1.311175e-01                1 1 ON  7
uu_8  -1.204420e-01                1 1 ON  8
uu_9  -9.281089e-02                1 1 ON  9
ud_0  4.123716e-01                 1 1 ON  10
ud_1  1.601446e-01                 1 1 ON  11
ud_2  5.984686e-02                 1 1 ON  12
ud_3  9.204556e-04                 1 1 ON  13
ud_4  -5.680361e-02                1 1 ON  14
ud_5  -1.011763e-01                1 1 ON  15
ud_6  -1.286412e-01                1 1 ON  16
ud_7  -1.438365e-01                1 1 ON  17
ud_8  -1.426726e-01                1 1 ON  18
ud_9  -1.345056e-01                1 1 ON  19
eO_0  -7.084277e-01                1 1 ON  20
eO_1  -4.142266e-01                1 1 ON  21
eO_2  -2.899072e-02                1 1 ON  22
eO_3  2.713777e-01                 1 1 ON  23
eO_4  4.918703e-01                 1 1 ON  24
eO_5  4.592432e-01                 1 1 ON  25
eO_6  2.359382e-01                 1 1 ON  26
eO_7  -5.581099e-02                1 1 ON  27
eO_8  -1.960902e-01                1 1 ON  28
eO_9  -5.779544e-02                1 1 ON  29
eH1_0 -2.119648e-01                1 1 ON  30
eH1_1 -1.274116e-01                1 1 ON  31
eH1_2 -8.808073e-02                1 1 ON  32
eH1_3 -3.749794e-02                1 1 ON  33
eH1_4 1.250315e-02                 1 1 ON  34
eH1_5 4.487450e-02                 1 1 ON  35
eH1_6 9.484342e-02                 1 1 ON  36
eH1_7 1.383185e-01                 1 1 ON  37
eH1_8 1.459389e-01                 1 1 ON  38
eH1_9 3.305546e-02                 1 1 ON  39
eH2_0 -2.108810e-01                1 1 ON  40
eH2_1 -1.263076e-01                1 1 ON  41
eH2_2 -8.700807e-02                1 1 ON  42
eH2_3 -3.650410e-02                1 1 ON  43
eH2_4 1.387769e-02                 1 1 ON  44
eH2_5 4.804376e-02                 1 1 ON  45
eH2_6 1.006195e-01                 1 1 ON  46
eH2_7 1.495076e-01                 1 1 ON  47
eH2_8 1.540105e-01                 1 1 ON  48
eH2_9 1.317114e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9371
    reference variance = 0.512732
====================================================
  Execution time = 2.5318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2593e-01
  Total weights = 2.0000e+06
  Execution time = 2.9634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326924699273
                                         uncertainty =       0.003107107351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326924699273
                                         uncertainty =       0.003107107351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404452456
  error estimate for blocks of size 2^( 2) =       0.000417232165
  error estimate for blocks of size 2^( 3) =       0.000431421355
  error estimate for blocks of size 2^( 4) =       0.000444234081
  error estimate for blocks of size 2^( 5) =       0.000454647012
  error estimate for blocks of size 2^( 6) =       0.000461585690
  error estimate for blocks of size 2^( 7) =       0.000463871310

      target function =                  N/A
              le_mean =     -16.909282327104
             les_mean =     286.250992232338
             stat err =       0.000456084523
             autocorr =       1.271615217439
              std dev =       0.571982148506
             le_variance =       0.327163578210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325491834948
                                         uncertainty =       0.003115697009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325491834948
                                         uncertainty =       0.003115697009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403565564
  error estimate for blocks of size 2^( 2) =       0.000415945542
  error estimate for blocks of size 2^( 3) =       0.000429831854
  error estimate for blocks of size 2^( 4) =       0.000442415000
  error estimate for blocks of size 2^( 5) =       0.000452712424
  error estimate for blocks of size 2^( 6) =       0.000459678963
  error estimate for blocks of size 2^( 7) =       0.000461985106

      target function =                  N/A
              le_mean =     -16.909262251516
             les_mean =     286.248880056939
             stat err =       0.000454197873
             autocorr =       1.266665640768
              std dev =       0.570727894229
             le_variance =       0.325730329251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872063634
                                         uncertainty =       0.003106709854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872063634
                                         uncertainty =       0.003106709854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403181027
  error estimate for blocks of size 2^( 2) =       0.000415656472
  error estimate for blocks of size 2^( 3) =       0.000429624832
  error estimate for blocks of size 2^( 4) =       0.000442276417
  error estimate for blocks of size 2^( 5) =       0.000452614859
  error estimate for blocks of size 2^( 6) =       0.000459581116
  error estimate for blocks of size 2^( 7) =       0.000461906452

      target function =                  N/A
              le_mean =     -16.909237035914
             les_mean =     286.247406854782
             stat err =       0.000454094711
             autocorr =       1.268506550389
              std dev =       0.570184076089
             le_variance =       0.325109880626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326429182414
                                         uncertainty =       0.003106283069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326429182414
                                         uncertainty =       0.003106283069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404145914
  error estimate for blocks of size 2^( 2) =       0.000416875596
  error estimate for blocks of size 2^( 3) =       0.000431029501
  error estimate for blocks of size 2^( 4) =       0.000443817466
  error estimate for blocks of size 2^( 5) =       0.000454220180
  error estimate for blocks of size 2^( 6) =       0.000461164067
  error estimate for blocks of size 2^( 7) =       0.000463457537

      target function =                  N/A
              le_mean =     -16.909257821104
             les_mean =     286.249667736243
             stat err =       0.000455664812
             autocorr =       1.271202098342
              std dev =       0.571548632238
             le_variance =       0.326667839013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909282327104        initial  <--
     2.5000e-01     2.5000e+00             1.1722e-02       -16.909262251516
     1.0000e+00     1.0000e+01             4.1177e-03       -16.909237035914
     4.0000e+00     4.0000e+01             1.1713e-03       -16.909257821104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1877
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9642
    reference variance = 0.227832
====================================================
  Execution time = 2.8033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334064923530
                                         uncertainty =       0.005771556939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334064923530
                                         uncertainty =       0.005771556939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408659730
  error estimate for blocks of size 2^( 2) =       0.000420977762
  error estimate for blocks of size 2^( 3) =       0.000434271451
  error estimate for blocks of size 2^( 4) =       0.000446444905
  error estimate for blocks of size 2^( 5) =       0.000456937338
  error estimate for blocks of size 2^( 6) =       0.000463650228
  error estimate for blocks of size 2^( 7) =       0.000467396228

      target function =                  N/A
              le_mean =     -16.909020115534
             les_mean =     286.248966650589
             stat err =       0.000458607175
             autocorr =       1.259383507947
              std dev =       0.577932132737
             le_variance =       0.334005550050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690902011553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909020115534       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909048195637       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909078062169       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909085370727       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909090043381       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909091897489       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909092490541       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909092841794       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909093238889       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909093278885       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909093239539       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.794212e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909020115534       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909027575932       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909035981591       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909037930338       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909039042138       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909039488417       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909039588444       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909039641979       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909039752796       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909039775299       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909039766368       residual = 7.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.758833e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909020115534       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909022010349       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909024179188       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909024676538       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909024949375       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909025059866       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909025080824       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909025092723       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909025119909       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909025125800       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.209784e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4756e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.026701e-01 1 1  ON 0
 uu_1                 1.394639e-01 1 1  ON 1
 uu_2                 4.161934e-02 1 1  ON 2
 uu_3                -1.939224e-02 1 1  ON 3
 uu_4                -6.331233e-02 1 1  ON 4
 uu_5                -9.588819e-02 1 1  ON 5
 uu_6                -1.205761e-01 1 1  ON 6
 uu_7                -1.310523e-01 1 1  ON 7
 uu_8                -1.203354e-01 1 1  ON 8
 uu_9                -9.277596e-02 1 1  ON 9
 ud_0                 4.115081e-01 1 1  ON 10
 ud_1                 1.585927e-01 1 1  ON 11
 ud_2                 6.077717e-02 1 1  ON 12
 ud_3                 2.487547e-03 1 1  ON 13
 ud_4                -5.706184e-02 1 1  ON 14
 ud_5                -1.014726e-01 1 1  ON 15
 ud_6                -1.286669e-01 1 1  ON 16
 ud_7                -1.435331e-01 1 1  ON 17
 ud_8                -1.424618e-01 1 1  ON 18
 ud_9                -1.344609e-01 1 1  ON 19
 eO_0                -7.047859e-01 1 1  ON 20
 eO_1                -4.137514e-01 1 1  ON 21
 eO_2                -3.151635e-02 1 1  ON 22
 eO_3                 2.694324e-01 1 1  ON 23
 eO_4                 4.916593e-01 1 1  ON 24
 eO_5                 4.595678e-01 1 1  ON 25
 eO_6                 2.360301e-01 1 1  ON 26
 eO_7                -5.591330e-02 1 1  ON 27
 eO_8                -1.959428e-01 1 1  ON 28
 eO_9                -5.770103e-02 1 1  ON 29
eH1_0                -2.101720e-01 1 1  ON 30
eH1_1                -1.274738e-01 1 1  ON 31
eH1_2                -8.834932e-02 1 1  ON 32
eH1_3                -3.739831e-02 1 1  ON 33
eH1_4                 1.171248e-02 1 1  ON 34
eH1_5                 4.474633e-02 1 1  ON 35
eH1_6                 9.477283e-02 1 1  ON 36
eH1_7                 1.381890e-01 1 1  ON 37
eH1_8                 1.457176e-01 1 1  ON 38
eH1_9                 3.285540e-02 1 1  ON 39
eH2_0                -2.090502e-01 1 1  ON 40
eH2_1                -1.265238e-01 1 1  ON 41
eH2_2                -8.736853e-02 1 1  ON 42
eH2_3                -3.641729e-02 1 1  ON 43
eH2_4                 1.300551e-02 1 1  ON 44
eH2_5                 4.795690e-02 1 1  ON 45
eH2_6                 1.006217e-01 1 1  ON 46
eH2_7                 1.496003e-01 1 1  ON 47
eH2_8                 1.537677e-01 1 1  ON 48
eH2_9                 1.294826e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.252262
====================================================
  Execution time = 2.4988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3025e-01
  Total weights = 2.0000e+06
  Execution time = 2.9490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330562443623
                                         uncertainty =       0.007255705368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330562443623
                                         uncertainty =       0.007255705368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406481619
  error estimate for blocks of size 2^( 2) =       0.000419033469
  error estimate for blocks of size 2^( 3) =       0.000432899082
  error estimate for blocks of size 2^( 4) =       0.000445695855
  error estimate for blocks of size 2^( 5) =       0.000456609475
  error estimate for blocks of size 2^( 6) =       0.000464371969
  error estimate for blocks of size 2^( 7) =       0.000470723102

      target function =                  N/A
              le_mean =     -16.907511418216
             les_mean =     286.194396804715
             stat err =       0.000459350100
             autocorr =       1.277043844987
              std dev =       0.574851818168
             le_variance =       0.330454612851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329903890223
                                         uncertainty =       0.007298280432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329903890223
                                         uncertainty =       0.007298280432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406076548
  error estimate for blocks of size 2^( 2) =       0.000418546175
  error estimate for blocks of size 2^( 3) =       0.000432347005
  error estimate for blocks of size 2^( 4) =       0.000445105877
  error estimate for blocks of size 2^( 5) =       0.000456002766
  error estimate for blocks of size 2^( 6) =       0.000463749899
  error estimate for blocks of size 2^( 7) =       0.000470081089

      target function =                  N/A
              le_mean =     -16.907507134125
             les_mean =     286.193593650782
             stat err =       0.000458734908
             autocorr =       1.276167740459
              std dev =       0.574278961133
             le_variance =       0.329796325200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330156246833
                                         uncertainty =       0.007278473957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330156246833
                                         uncertainty =       0.007278473957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406231816
  error estimate for blocks of size 2^( 2) =       0.000418739297
  error estimate for blocks of size 2^( 3) =       0.000432570409
  error estimate for blocks of size 2^( 4) =       0.000445347037
  error estimate for blocks of size 2^( 5) =       0.000456252169
  error estimate for blocks of size 2^( 6) =       0.000464007221
  error estimate for blocks of size 2^( 7) =       0.000470347071

      target function =                  N/A
              le_mean =     -16.907507242556
             les_mean =     286.193849569343
             stat err =       0.000458988375
             autocorr =       1.276601946695
              std dev =       0.574498544204
             le_variance =       0.330048577292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330507313582
                                         uncertainty =       0.007258621166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330507313582
                                         uncertainty =       0.007258621166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406447724
  error estimate for blocks of size 2^( 2) =       0.000418993842
  error estimate for blocks of size 2^( 3) =       0.000432855024
  error estimate for blocks of size 2^( 4) =       0.000445649220
  error estimate for blocks of size 2^( 5) =       0.000456561773
  error estimate for blocks of size 2^( 6) =       0.000464323357
  error estimate for blocks of size 2^( 7) =       0.000470673038

      target function =                  N/A
              le_mean =     -16.907510627717
             les_mean =     286.194314965602
             stat err =       0.000459301847
             autocorr =       1.276988516226
              std dev =       0.574803883464
             le_variance =       0.330399504445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907511418216        initial  <--
     2.5000e+00     2.5000e+01             1.7942e-03       -16.907507134125
     1.0000e+01     1.0000e+02             4.7588e-04       -16.907507242556
     4.0000e+01     4.0000e+02             1.2098e-04       -16.907510627717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8495
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4613e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8986
    reference variance = 0.142052
====================================================
  Execution time = 2.5537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584212873
                                         uncertainty =       0.003575041749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584212873
                                         uncertainty =       0.003575041749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407827153
  error estimate for blocks of size 2^( 2) =       0.000420697883
  error estimate for blocks of size 2^( 3) =       0.000434312431
  error estimate for blocks of size 2^( 4) =       0.000446849426
  error estimate for blocks of size 2^( 5) =       0.000458452143
  error estimate for blocks of size 2^( 6) =       0.000464171698
  error estimate for blocks of size 2^( 7) =       0.000470345262

      target function =                  N/A
              le_mean =     -16.908604407020
             les_mean =     286.233548800827
             stat err =       0.000459954632
             autocorr =       1.271972487900
              std dev =       0.576754691394
             le_variance =       0.332645974045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690860440702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908604407020       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908607689483       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908610891443       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908612495645       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908612998974       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908613183767       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908613191510       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908613197378       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908613209312       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908613211523       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.931858e-04

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908604407020       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908605232847       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908606043722       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908606447994       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908606573643       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908606619938       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908606621762       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908606623056       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908606626023       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908606626518       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.860680e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908604407020       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908604613805       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908604817183       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908604918454       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908604949858       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908604961436       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908604961886       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908604962198       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908604962938       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908604963061       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.217132e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2150e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.027062e-01 1 1  ON 0
 uu_1                 1.395401e-01 1 1  ON 1
 uu_2                 4.158875e-02 1 1  ON 2
 uu_3                -1.945679e-02 1 1  ON 3
 uu_4                -6.333085e-02 1 1  ON 4
 uu_5                -9.587592e-02 1 1  ON 5
 uu_6                -1.205703e-01 1 1  ON 6
 uu_7                -1.310571e-01 1 1  ON 7
 uu_8                -1.203237e-01 1 1  ON 8
 uu_9                -9.277357e-02 1 1  ON 9
 ud_0                 4.114471e-01 1 1  ON 10
 ud_1                 1.583660e-01 1 1  ON 11
 ud_2                 6.091240e-02 1 1  ON 12
 ud_3                 2.678066e-03 1 1  ON 13
 ud_4                -5.713130e-02 1 1  ON 14
 ud_5                -1.014963e-01 1 1  ON 15
 ud_6                -1.286696e-01 1 1  ON 16
 ud_7                -1.435059e-01 1 1  ON 17
 ud_8                -1.424351e-01 1 1  ON 18
 ud_9                -1.344552e-01 1 1  ON 19
 eO_0                -7.043586e-01 1 1  ON 20
 eO_1                -4.137199e-01 1 1  ON 21
 eO_2                -3.182200e-02 1 1  ON 22
 eO_3                 2.692258e-01 1 1  ON 23
 eO_4                 4.916469e-01 1 1  ON 24
 eO_5                 4.596053e-01 1 1  ON 25
 eO_6                 2.360352e-01 1 1  ON 26
 eO_7                -5.591912e-02 1 1  ON 27
 eO_8                -1.959258e-01 1 1  ON 28
 eO_9                -5.769014e-02 1 1  ON 29
eH1_0                -2.099631e-01 1 1  ON 30
eH1_1                -1.274852e-01 1 1  ON 31
eH1_2                -8.837902e-02 1 1  ON 32
eH1_3                -3.738865e-02 1 1  ON 33
eH1_4                 1.160993e-02 1 1  ON 34
eH1_5                 4.473157e-02 1 1  ON 35
eH1_6                 9.476284e-02 1 1  ON 36
eH1_7                 1.381773e-01 1 1  ON 37
eH1_8                 1.456951e-01 1 1  ON 38
eH1_9                 3.284016e-02 1 1  ON 39
eH2_0                -2.088425e-01 1 1  ON 40
eH2_1                -1.265461e-01 1 1  ON 41
eH2_2                -8.740658e-02 1 1  ON 42
eH2_3                -3.640855e-02 1 1  ON 43
eH2_4                 1.290758e-02 1 1  ON 44
eH2_5                 4.795116e-02 1 1  ON 45
eH2_6                 1.006146e-01 1 1  ON 46
eH2_7                 1.496011e-01 1 1  ON 47
eH2_8                 1.537452e-01 1 1  ON 48
eH2_9                 1.292582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8418
    reference variance = 0.205115
====================================================
  Execution time = 2.5189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3389e-01
  Total weights = 2.0000e+06
  Execution time = 2.9522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748448290
                                         uncertainty =       0.005081216471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748448290
                                         uncertainty =       0.005081216471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408605408
  error estimate for blocks of size 2^( 2) =       0.000421350749
  error estimate for blocks of size 2^( 3) =       0.000434467984
  error estimate for blocks of size 2^( 4) =       0.000446964082
  error estimate for blocks of size 2^( 5) =       0.000458827832
  error estimate for blocks of size 2^( 6) =       0.000468412767
  error estimate for blocks of size 2^( 7) =       0.000471930439

      target function =                  N/A
              le_mean =     -16.908561356795
             les_mean =     286.233363749086
             stat err =       0.000461533780
             autocorr =       1.275847492537
              std dev =       0.577855310211
             le_variance =       0.333916759539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333653492045
                                         uncertainty =       0.005081980325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333653492045
                                         uncertainty =       0.005081980325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408547275
  error estimate for blocks of size 2^( 2) =       0.000421283998
  error estimate for blocks of size 2^( 3) =       0.000434395133
  error estimate for blocks of size 2^( 4) =       0.000446888072
  error estimate for blocks of size 2^( 5) =       0.000458749323
  error estimate for blocks of size 2^( 6) =       0.000468335027
  error estimate for blocks of size 2^( 7) =       0.000471853768

      target function =                  N/A
              le_mean =     -16.908561110146
             les_mean =     286.233260400408
             stat err =       0.000461456547
             autocorr =       1.275783522324
              std dev =       0.577773097144
             le_variance =       0.333821751783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699864948
                                         uncertainty =       0.005081595220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699864948
                                         uncertainty =       0.005081595220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575666
  error estimate for blocks of size 2^( 2) =       0.000421316666
  error estimate for blocks of size 2^( 3) =       0.000434430836
  error estimate for blocks of size 2^( 4) =       0.000446925350
  error estimate for blocks of size 2^( 5) =       0.000458787845
  error estimate for blocks of size 2^( 6) =       0.000468373165
  error estimate for blocks of size 2^( 7) =       0.000471891376

      target function =                  N/A
              le_mean =     -16.908561206232
             les_mean =     286.233310048011
             stat err =       0.000461494434
             autocorr =       1.275815691615
              std dev =       0.577813248423
             le_variance =       0.333868150053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333742326569
                                         uncertainty =       0.005081263693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333742326569
                                         uncertainty =       0.005081263693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408601661
  error estimate for blocks of size 2^( 2) =       0.000421346457
  error estimate for blocks of size 2^( 3) =       0.000434463308
  error estimate for blocks of size 2^( 4) =       0.000446959208
  error estimate for blocks of size 2^( 5) =       0.000458822801
  error estimate for blocks of size 2^( 6) =       0.000468407784
  error estimate for blocks of size 2^( 7) =       0.000471925523

      target function =                  N/A
              le_mean =     -16.908561335158
             les_mean =     286.233356892394
             stat err =       0.000461528829
             autocorr =       1.275843521489
              std dev =       0.577850010417
             le_variance =       0.333910634538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908561356795        initial  <--
     2.5000e+01     2.5000e+02             1.9319e-04       -16.908561110146
     1.0000e+02     1.0000e+03             4.8607e-05       -16.908561206232
     4.0000e+02     4.0000e+03             1.2171e-05       -16.908561335158

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0529
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.151254
====================================================
  Execution time = 2.5525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3112e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331148430055
                                         uncertainty =       0.003941913676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331148430055
                                         uncertainty =       0.003941913676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406889266
  error estimate for blocks of size 2^( 2) =       0.000420277141
  error estimate for blocks of size 2^( 3) =       0.000433742741
  error estimate for blocks of size 2^( 4) =       0.000445869176
  error estimate for blocks of size 2^( 5) =       0.000457330008
  error estimate for blocks of size 2^( 6) =       0.000465622457
  error estimate for blocks of size 2^( 7) =       0.000470032432

      target function =                  N/A
              le_mean =     -16.908323067611
             les_mean =     286.222506542790
             stat err =       0.000459713518
             autocorr =       1.276503714824
              std dev =       0.575428318433
             le_variance =       0.331117749655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690832306761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908323067611       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908323375705       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908323649746       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908323746020       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908323819508       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908323858267       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908323861888       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908323858042       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908323861955       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908323862037       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.952559e-05

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908323067611       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908323144682       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908323213284       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908323237354       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908323255712       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908323265413       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908323266324       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908323265355       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908323266331       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908323266356       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 4.884531e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908323067611       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908323086882       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908323104038       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908323110053       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908323114644       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908323117070       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908323117298       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908323117058       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908323117314       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908323117304       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+03 is 1.221329e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2137e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.027103e-01 1 1  ON 0
 uu_1                 1.395489e-01 1 1  ON 1
 uu_2                 4.158493e-02 1 1  ON 2
 uu_3                -1.946340e-02 1 1  ON 3
 uu_4                -6.333218e-02 1 1  ON 4
 uu_5                -9.587538e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310579e-01 1 1  ON 7
 uu_8                -1.203233e-01 1 1  ON 8
 uu_9                -9.277334e-02 1 1  ON 9
 ud_0                 4.114421e-01 1 1  ON 10
 ud_1                 1.583427e-01 1 1  ON 11
 ud_2                 6.092534e-02 1 1  ON 12
 ud_3                 2.697496e-03 1 1  ON 13
 ud_4                -5.713909e-02 1 1  ON 14
 ud_5                -1.014994e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435032e-01 1 1  ON 17
 ud_8                -1.424321e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043149e-01 1 1  ON 20
 eO_1                -4.137159e-01 1 1  ON 21
 eO_2                -3.185396e-02 1 1  ON 22
 eO_3                 2.692054e-01 1 1  ON 23
 eO_4                 4.916458e-01 1 1  ON 24
 eO_5                 4.596086e-01 1 1  ON 25
 eO_6                 2.360352e-01 1 1  ON 26
 eO_7                -5.591956e-02 1 1  ON 27
 eO_8                -1.959244e-01 1 1  ON 28
 eO_9                -5.768896e-02 1 1  ON 29
eH1_0                -2.099427e-01 1 1  ON 30
eH1_1                -1.274875e-01 1 1  ON 31
eH1_2                -8.838215e-02 1 1  ON 32
eH1_3                -3.738662e-02 1 1  ON 33
eH1_4                 1.160053e-02 1 1  ON 34
eH1_5                 4.473083e-02 1 1  ON 35
eH1_6                 9.476168e-02 1 1  ON 36
eH1_7                 1.381758e-01 1 1  ON 37
eH1_8                 1.456926e-01 1 1  ON 38
eH1_9                 3.283842e-02 1 1  ON 39
eH2_0                -2.088222e-01 1 1  ON 40
eH2_1                -1.265483e-01 1 1  ON 41
eH2_2                -8.740995e-02 1 1  ON 42
eH2_3                -3.640798e-02 1 1  ON 43
eH2_4                 1.289774e-02 1 1  ON 44
eH2_5                 4.794983e-02 1 1  ON 45
eH2_6                 1.006132e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537441e-01 1 1  ON 48
eH2_9                 1.292444e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.331284
====================================================
  Execution time = 2.5159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.5666e-01
  Total weights = 2.0000e+06
  Execution time = 2.9475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356742754867
                                         uncertainty =       0.025301289969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356742754867
                                         uncertainty =       0.025301289969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422290469
  error estimate for blocks of size 2^( 2) =       0.000434827712
  error estimate for blocks of size 2^( 3) =       0.000447683898
  error estimate for blocks of size 2^( 4) =       0.000460012527
  error estimate for blocks of size 2^( 5) =       0.000470148764
  error estimate for blocks of size 2^( 6) =       0.000477815455
  error estimate for blocks of size 2^( 7) =       0.000483197354

      target function =                  N/A
              le_mean =     -16.908118400605
             les_mean =     286.241126150544
             stat err =       0.000472793525
             autocorr =       1.253488868724
              std dev =       0.597208908158
             le_variance =       0.356658479984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356732696188
                                         uncertainty =       0.025300770426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356732696188
                                         uncertainty =       0.025300770426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422284512
  error estimate for blocks of size 2^( 2) =       0.000434820913
  error estimate for blocks of size 2^( 3) =       0.000447676422
  error estimate for blocks of size 2^( 4) =       0.000460004735
  error estimate for blocks of size 2^( 5) =       0.000470140933
  error estimate for blocks of size 2^( 6) =       0.000477807851
  error estimate for blocks of size 2^( 7) =       0.000483189385

      target function =                  N/A
              le_mean =     -16.908118356687
             les_mean =     286.241114604144
             stat err =       0.000472785726
             autocorr =       1.253482875703
              std dev =       0.597200484526
             le_variance =       0.356648418718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356737713509
                                         uncertainty =       0.025301029385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356737713509
                                         uncertainty =       0.025301029385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422287483
  error estimate for blocks of size 2^( 2) =       0.000434824305
  error estimate for blocks of size 2^( 3) =       0.000447680152
  error estimate for blocks of size 2^( 4) =       0.000460008623
  error estimate for blocks of size 2^( 5) =       0.000470144841
  error estimate for blocks of size 2^( 6) =       0.000477811646
  error estimate for blocks of size 2^( 7) =       0.000483193362

      target function =                  N/A
              le_mean =     -16.908118378410
             les_mean =     286.241120357342
             stat err =       0.000472789618
             autocorr =       1.253485874631
              std dev =       0.597204686294
             le_variance =       0.356653437332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356742124186
                                         uncertainty =       0.025301257371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356742124186
                                         uncertainty =       0.025301257371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422290095
  error estimate for blocks of size 2^( 2) =       0.000434827286
  error estimate for blocks of size 2^( 3) =       0.000447683430
  error estimate for blocks of size 2^( 4) =       0.000460012038
  error estimate for blocks of size 2^( 5) =       0.000470148273
  error estimate for blocks of size 2^( 6) =       0.000477814979
  error estimate for blocks of size 2^( 7) =       0.000483196855

      target function =                  N/A
              le_mean =     -16.908118397804
             les_mean =     286.241125424977
             stat err =       0.000472793036
             autocorr =       1.253488494496
              std dev =       0.597208379999
             le_variance =       0.356657849142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908118400605        initial  <--
     2.5000e+02     2.5000e+03             1.9526e-05       -16.908118356687
     1.0000e+03     1.0000e+04             4.8845e-06       -16.908118378410
     4.0000e+03     4.0000e+04             1.2213e-06       -16.908118397804

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0193
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.207479
====================================================
  Execution time = 2.5478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3039e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330357756300
                                         uncertainty =       0.003995413540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330357756300
                                         uncertainty =       0.003995413540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406439159
  error estimate for blocks of size 2^( 2) =       0.000418674877
  error estimate for blocks of size 2^( 3) =       0.000431666192
  error estimate for blocks of size 2^( 4) =       0.000443576221
  error estimate for blocks of size 2^( 5) =       0.000454572382
  error estimate for blocks of size 2^( 6) =       0.000459259681
  error estimate for blocks of size 2^( 7) =       0.000465724263

      target function =                  N/A
              le_mean =     -16.908215768526
             les_mean =     286.218145890498
             stat err =       0.000455783137
             autocorr =       1.257550451079
              std dev =       0.574791771567
             le_variance =       0.330385580661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690821576853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908215768526       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908215793725       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908215821212       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908215829370       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908215838091       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908215839906       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908215841270       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908215841143       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908215841092       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908215841063       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.918916e-06

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908215768526       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908215774826       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908215781699       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908215783743       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908215785919       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908215786373       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908215786717       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908215786691       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908215786670       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908215786697       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 4.797606e-07

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908215768526       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908215770101       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908215771819       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908215772329       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908215772875       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908215772969       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908215773038       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908215773060       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908215773065       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908215773004       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+04 is 1.199421e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2115e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395498e-01 1 1  ON 1
 uu_2                 4.158460e-02 1 1  ON 2
 uu_3                -1.946402e-02 1 1  ON 3
 uu_4                -6.333237e-02 1 1  ON 4
 uu_5                -9.587526e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583403e-01 1 1  ON 11
 ud_2                 6.092669e-02 1 1  ON 12
 ud_3                 2.699528e-03 1 1  ON 13
 ud_4                -5.713977e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435030e-01 1 1  ON 17
 ud_8                -1.424320e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043105e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185717e-02 1 1  ON 22
 eO_3                 2.692033e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360352e-01 1 1  ON 26
 eO_7                -5.591966e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768885e-02 1 1  ON 29
eH1_0                -2.099407e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838241e-02 1 1  ON 32
eH1_3                -3.738647e-02 1 1  ON 33
eH1_4                 1.159954e-02 1 1  ON 34
eH1_5                 4.473071e-02 1 1  ON 35
eH1_6                 9.476146e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283824e-02 1 1  ON 39
eH2_0                -2.088200e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741028e-02 1 1  ON 42
eH2_3                -3.640780e-02 1 1  ON 43
eH2_4                 1.289664e-02 1 1  ON 44
eH2_5                 4.794968e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292426e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.229768
====================================================
  Execution time = 2.4940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2409e-01
  Total weights = 2.0000e+06
  Execution time = 2.9366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102583836
                                         uncertainty =       0.003489335691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102583836
                                         uncertainty =       0.003489335691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402548410
  error estimate for blocks of size 2^( 2) =       0.000415888680
  error estimate for blocks of size 2^( 3) =       0.000429583889
  error estimate for blocks of size 2^( 4) =       0.000442551568
  error estimate for blocks of size 2^( 5) =       0.000453420192
  error estimate for blocks of size 2^( 6) =       0.000459836228
  error estimate for blocks of size 2^( 7) =       0.000464460076

      target function =                  N/A
              le_mean =     -16.908660524758
             les_mean =     286.226891024762
             stat err =       0.000455067016
             autocorr =       1.277951830423
              std dev =       0.569289421392
             le_variance =       0.324090445309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324101612447
                                         uncertainty =       0.003489335227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324101612447
                                         uncertainty =       0.003489335227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402547807
  error estimate for blocks of size 2^( 2) =       0.000415887986
  error estimate for blocks of size 2^( 3) =       0.000429583115
  error estimate for blocks of size 2^( 4) =       0.000442550755
  error estimate for blocks of size 2^( 5) =       0.000453419359
  error estimate for blocks of size 2^( 6) =       0.000459835382
  error estimate for blocks of size 2^( 7) =       0.000464459260

      target function =                  N/A
              le_mean =     -16.908660535503
             les_mean =     286.226890417447
             stat err =       0.000455066189
             autocorr =       1.277951013657
              std dev =       0.569288568833
             le_variance =       0.324089474604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102098030
                                         uncertainty =       0.003489335458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102098030
                                         uncertainty =       0.003489335458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402548109
  error estimate for blocks of size 2^( 2) =       0.000415888333
  error estimate for blocks of size 2^( 3) =       0.000429583502
  error estimate for blocks of size 2^( 4) =       0.000442551162
  error estimate for blocks of size 2^( 5) =       0.000453419775
  error estimate for blocks of size 2^( 6) =       0.000459835805
  error estimate for blocks of size 2^( 7) =       0.000464459668

      target function =                  N/A
              le_mean =     -16.908660530129
             les_mean =     286.226890720926
             stat err =       0.000455066602
             autocorr =       1.277951422060
              std dev =       0.569288995015
             le_variance =       0.324089959845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102523106
                                         uncertainty =       0.003489335662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102523106
                                         uncertainty =       0.003489335662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402548373
  error estimate for blocks of size 2^( 2) =       0.000415888637
  error estimate for blocks of size 2^( 3) =       0.000429583840
  error estimate for blocks of size 2^( 4) =       0.000442551517
  error estimate for blocks of size 2^( 5) =       0.000453420139
  error estimate for blocks of size 2^( 6) =       0.000459836175
  error estimate for blocks of size 2^( 7) =       0.000464460025

      target function =                  N/A
              le_mean =     -16.908660525429
             les_mean =     286.226890986769
             stat err =       0.000455066964
             autocorr =       1.277951779380
              std dev =       0.569289368091
             le_variance =       0.324090384621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908660524758        initial
     2.5000e+03     2.5000e+04             1.9189e-06       -16.908660535503  <--
     1.0000e+04     1.0000e+05             4.7976e-07       -16.908660530129
     4.0000e+04     4.0000e+05             1.1994e-07       -16.908660525429

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 3.9773e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.027106e-01 1 1  ON 0
 uu_1                 1.395495e-01 1 1  ON 1
 uu_2                 4.158469e-02 1 1  ON 2
 uu_3                -1.946379e-02 1 1  ON 3
 uu_4                -6.333232e-02 1 1  ON 4
 uu_5                -9.587532e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277331e-02 1 1  ON 9
 ud_0                 4.114418e-01 1 1  ON 10
 ud_1                 1.583411e-01 1 1  ON 11
 ud_2                 6.092623e-02 1 1  ON 12
 ud_3                 2.698862e-03 1 1  ON 13
 ud_4                -5.713951e-02 1 1  ON 14
 ud_5                -1.014995e-01 1 1  ON 15
 ud_6                -1.286688e-01 1 1  ON 16
 ud_7                -1.435030e-01 1 1  ON 17
 ud_8                -1.424320e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043119e-01 1 1  ON 20
 eO_1                -4.137155e-01 1 1  ON 21
 eO_2                -3.185612e-02 1 1  ON 22
 eO_3                 2.692039e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596089e-01 1 1  ON 25
 eO_6                 2.360352e-01 1 1  ON 26
 eO_7                -5.591963e-02 1 1  ON 27
 eO_8                -1.959243e-01 1 1  ON 28
 eO_9                -5.768889e-02 1 1  ON 29
eH1_0                -2.099414e-01 1 1  ON 30
eH1_1                -1.274876e-01 1 1  ON 31
eH1_2                -8.838232e-02 1 1  ON 32
eH1_3                -3.738650e-02 1 1  ON 33
eH1_4                 1.159989e-02 1 1  ON 34
eH1_5                 4.473076e-02 1 1  ON 35
eH1_6                 9.476151e-02 1 1  ON 36
eH1_7                 1.381757e-01 1 1  ON 37
eH1_8                 1.456925e-01 1 1  ON 38
eH1_9                 3.283827e-02 1 1  ON 39
eH2_0                -2.088207e-01 1 1  ON 40
eH2_1                -1.265484e-01 1 1  ON 41
eH2_2                -8.741019e-02 1 1  ON 42
eH2_3                -3.640784e-02 1 1  ON 43
eH2_4                 1.289695e-02 1 1  ON 44
eH2_5                 4.794969e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537440e-01 1 1  ON 48
eH2_9                 1.292434e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.476139
====================================================
  Execution time = 2.7849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3611e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335720804117
                                         uncertainty =       0.007888713028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335720804117
                                         uncertainty =       0.007888713028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409946664
  error estimate for blocks of size 2^( 2) =       0.000422693104
  error estimate for blocks of size 2^( 3) =       0.000436109509
  error estimate for blocks of size 2^( 4) =       0.000449077589
  error estimate for blocks of size 2^( 5) =       0.000462056612
  error estimate for blocks of size 2^( 6) =       0.000470257379
  error estimate for blocks of size 2^( 7) =       0.000476863826

      target function =                  N/A
              le_mean =     -16.909458907053
             les_mean =     286.265912895853
             stat err =       0.000464563851
             autocorr =       1.284210196853
              std dev =       0.579752132028
             le_variance =       0.336112534591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690945890705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458907053       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909459036509       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909459169645       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909459209495       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909459235914       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909459247817       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909459255497       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909459256559       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909459255950       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909459255845       residual = 8.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.856557e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458907053       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909458939425       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909458972727       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909458982693       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909458989296       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909458992273       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909458994193       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909458994460       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909458994306       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909458994273       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.964655e-06

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458907053       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909458915147       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909458923473       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909458925954       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909458927616       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909458928364       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909458928836       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909458928896       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909458928907       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909458928858       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 4.911961e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4621e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.027105e-01 1 1  ON 0
 uu_1                 1.395491e-01 1 1  ON 1
 uu_2                 4.158481e-02 1 1  ON 2
 uu_3                -1.946349e-02 1 1  ON 3
 uu_4                -6.333227e-02 1 1  ON 4
 uu_5                -9.587540e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310579e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277329e-02 1 1  ON 9
 ud_0                 4.114419e-01 1 1  ON 10
 ud_1                 1.583422e-01 1 1  ON 11
 ud_2                 6.092559e-02 1 1  ON 12
 ud_3                 2.698006e-03 1 1  ON 13
 ud_4                -5.713919e-02 1 1  ON 14
 ud_5                -1.014994e-01 1 1  ON 15
 ud_6                -1.286688e-01 1 1  ON 16
 ud_7                -1.435032e-01 1 1  ON 17
 ud_8                -1.424321e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043139e-01 1 1  ON 20
 eO_1                -4.137157e-01 1 1  ON 21
 eO_2                -3.185474e-02 1 1  ON 22
 eO_3                 2.692048e-01 1 1  ON 23
 eO_4                 4.916457e-01 1 1  ON 24
 eO_5                 4.596088e-01 1 1  ON 25
 eO_6                 2.360352e-01 1 1  ON 26
 eO_7                -5.591958e-02 1 1  ON 27
 eO_8                -1.959243e-01 1 1  ON 28
 eO_9                -5.768893e-02 1 1  ON 29
eH1_0                -2.099422e-01 1 1  ON 30
eH1_1                -1.274875e-01 1 1  ON 31
eH1_2                -8.838220e-02 1 1  ON 32
eH1_3                -3.738655e-02 1 1  ON 33
eH1_4                 1.160036e-02 1 1  ON 34
eH1_5                 4.473079e-02 1 1  ON 35
eH1_6                 9.476155e-02 1 1  ON 36
eH1_7                 1.381757e-01 1 1  ON 37
eH1_8                 1.456925e-01 1 1  ON 38
eH1_9                 3.283833e-02 1 1  ON 39
eH2_0                -2.088216e-01 1 1  ON 40
eH2_1                -1.265483e-01 1 1  ON 41
eH2_2                -8.741008e-02 1 1  ON 42
eH2_3                -3.640788e-02 1 1  ON 43
eH2_4                 1.289734e-02 1 1  ON 44
eH2_5                 4.794973e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537441e-01 1 1  ON 48
eH2_9                 1.292445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.186829
====================================================
  Execution time = 2.5412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.0000e+06
  Execution time = 2.9575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854389818
                                         uncertainty =       0.011931047353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854389818
                                         uncertainty =       0.011931047353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409717310
  error estimate for blocks of size 2^( 2) =       0.000422527766
  error estimate for blocks of size 2^( 3) =       0.000436267135
  error estimate for blocks of size 2^( 4) =       0.000448978847
  error estimate for blocks of size 2^( 5) =       0.000459853561
  error estimate for blocks of size 2^( 6) =       0.000468522906
  error estimate for blocks of size 2^( 7) =       0.000474211591

      target function =                  N/A
              le_mean =     -16.907361944813
             les_mean =     286.194624313154
             stat err =       0.000462891726
             autocorr =       1.276410038953
              std dev =       0.579427776450
             le_variance =       0.335736548122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335851011352
                                         uncertainty =       0.011931518349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335851011352
                                         uncertainty =       0.011931518349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409715249
  error estimate for blocks of size 2^( 2) =       0.000422525328
  error estimate for blocks of size 2^( 3) =       0.000436264427
  error estimate for blocks of size 2^( 4) =       0.000448976018
  error estimate for blocks of size 2^( 5) =       0.000459850658
  error estimate for blocks of size 2^( 6) =       0.000468519963
  error estimate for blocks of size 2^( 7) =       0.000474208691

      target function =                  N/A
              le_mean =     -16.907361947356
             les_mean =     286.194621021873
             stat err =       0.000462888833
             autocorr =       1.276406920608
              std dev =       0.579424862104
             le_variance =       0.335733170825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335852698882
                                         uncertainty =       0.011931282934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335852698882
                                         uncertainty =       0.011931282934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716279
  error estimate for blocks of size 2^( 2) =       0.000422526546
  error estimate for blocks of size 2^( 3) =       0.000436265780
  error estimate for blocks of size 2^( 4) =       0.000448977431
  error estimate for blocks of size 2^( 5) =       0.000459852108
  error estimate for blocks of size 2^( 6) =       0.000468521433
  error estimate for blocks of size 2^( 7) =       0.000474210140

      target function =                  N/A
              le_mean =     -16.907361946043
             les_mean =     286.194622664409
             stat err =       0.000462890278
             autocorr =       1.276408480010
              std dev =       0.579426317810
             le_variance =       0.335734857771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854178376
                                         uncertainty =       0.011931076803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854178376
                                         uncertainty =       0.011931076803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409717181
  error estimate for blocks of size 2^( 2) =       0.000422527613
  error estimate for blocks of size 2^( 3) =       0.000436266966
  error estimate for blocks of size 2^( 4) =       0.000448978670
  error estimate for blocks of size 2^( 5) =       0.000459853380
  error estimate for blocks of size 2^( 6) =       0.000468522721
  error estimate for blocks of size 2^( 7) =       0.000474211410

      target function =                  N/A
              le_mean =     -16.907361944962
             les_mean =     286.194624106835
             stat err =       0.000462891545
             autocorr =       1.276409844097
              std dev =       0.579427594055
             le_variance =       0.335736336752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907361944813        initial
     6.2500e+02     6.2500e+03             7.8566e-06       -16.907361947356  <--
     2.5000e+03     2.5000e+04             1.9647e-06       -16.907361946043
     1.0000e+04     1.0000e+05             4.9120e-07       -16.907361944962

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 4.0243e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.027099e-01 1 1  ON 0
 uu_1                 1.395478e-01 1 1  ON 1
 uu_2                 4.158518e-02 1 1  ON 2
 uu_3                -1.946258e-02 1 1  ON 3
 uu_4                -6.333213e-02 1 1  ON 4
 uu_5                -9.587562e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310576e-01 1 1  ON 7
 uu_8                -1.203231e-01 1 1  ON 8
 uu_9                -9.277325e-02 1 1  ON 9
 ud_0                 4.114425e-01 1 1  ON 10
 ud_1                 1.583453e-01 1 1  ON 11
 ud_2                 6.092370e-02 1 1  ON 12
 ud_3                 2.695436e-03 1 1  ON 13
 ud_4                -5.713824e-02 1 1  ON 14
 ud_5                -1.014990e-01 1 1  ON 15
 ud_6                -1.286689e-01 1 1  ON 16
 ud_7                -1.435036e-01 1 1  ON 17
 ud_8                -1.424323e-01 1 1  ON 18
 ud_9                -1.344545e-01 1 1  ON 19
 eO_0                -7.043198e-01 1 1  ON 20
 eO_1                -4.137160e-01 1 1  ON 21
 eO_2                -3.185062e-02 1 1  ON 22
 eO_3                 2.692075e-01 1 1  ON 23
 eO_4                 4.916458e-01 1 1  ON 24
 eO_5                 4.596083e-01 1 1  ON 25
 eO_6                 2.360351e-01 1 1  ON 26
 eO_7                -5.591943e-02 1 1  ON 27
 eO_8                -1.959245e-01 1 1  ON 28
 eO_9                -5.768904e-02 1 1  ON 29
eH1_0                -2.099448e-01 1 1  ON 30
eH1_1                -1.274872e-01 1 1  ON 31
eH1_2                -8.838184e-02 1 1  ON 32
eH1_3                -3.738671e-02 1 1  ON 33
eH1_4                 1.160179e-02 1 1  ON 34
eH1_5                 4.473085e-02 1 1  ON 35
eH1_6                 9.476169e-02 1 1  ON 36
eH1_7                 1.381758e-01 1 1  ON 37
eH1_8                 1.456927e-01 1 1  ON 38
eH1_9                 3.283849e-02 1 1  ON 39
eH2_0                -2.088243e-01 1 1  ON 40
eH2_1                -1.265481e-01 1 1  ON 41
eH2_2                -8.740975e-02 1 1  ON 42
eH2_3                -3.640802e-02 1 1  ON 43
eH2_4                 1.289848e-02 1 1  ON 44
eH2_5                 4.794983e-02 1 1  ON 45
eH2_6                 1.006133e-01 1 1  ON 46
eH2_7                 1.496010e-01 1 1  ON 47
eH2_8                 1.537445e-01 1 1  ON 48
eH2_9                 1.292478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.192374
====================================================
  Execution time = 2.5693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4676e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346822322952
                                         uncertainty =       0.008280233490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346822322952
                                         uncertainty =       0.008280233490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416386360
  error estimate for blocks of size 2^( 2) =       0.000429382175
  error estimate for blocks of size 2^( 3) =       0.000442433463
  error estimate for blocks of size 2^( 4) =       0.000455376983
  error estimate for blocks of size 2^( 5) =       0.000464821666
  error estimate for blocks of size 2^( 6) =       0.000474044488
  error estimate for blocks of size 2^( 7) =       0.000479988258

      target function =                  N/A
              le_mean =     -16.908693485108
             les_mean =     286.250670400972
             stat err =       0.000468557849
             autocorr =       1.266290782817
              std dev =       0.588859237003
             le_variance =       0.346755201003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690869348511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908693485108       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908694058212       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908694703069       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908694925731       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908694988294       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908695002335       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908695011193       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908695017729       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908695020608       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908695021253       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.119569e-05

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908693485108       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908693628530       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908693790084       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908693845871       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908693861486       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908693865002       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908693867193       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908693868827       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908693869548       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908693869707       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.807049e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908693485108       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908693520973       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908693561383       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908693575335       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908693579240       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908693580118       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908693580663       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908693581079       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908693581263       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908693581297       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.952271e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2335e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.027091e-01 1 1  ON 0
 uu_1                 1.395464e-01 1 1  ON 1
 uu_2                 4.158577e-02 1 1  ON 2
 uu_3                -1.946153e-02 1 1  ON 3
 uu_4                -6.333186e-02 1 1  ON 4
 uu_5                -9.587572e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310576e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277321e-02 1 1  ON 9
 ud_0                 4.114435e-01 1 1  ON 10
 ud_1                 1.583494e-01 1 1  ON 11
 ud_2                 6.092129e-02 1 1  ON 12
 ud_3                 2.691900e-03 1 1  ON 13
 ud_4                -5.713687e-02 1 1  ON 14
 ud_5                -1.014986e-01 1 1  ON 15
 ud_6                -1.286691e-01 1 1  ON 16
 ud_7                -1.435040e-01 1 1  ON 17
 ud_8                -1.424326e-01 1 1  ON 18
 ud_9                -1.344546e-01 1 1  ON 19
 eO_0                -7.043276e-01 1 1  ON 20
 eO_1                -4.137167e-01 1 1  ON 21
 eO_2                -3.184494e-02 1 1  ON 22
 eO_3                 2.692112e-01 1 1  ON 23
 eO_4                 4.916461e-01 1 1  ON 24
 eO_5                 4.596076e-01 1 1  ON 25
 eO_6                 2.360350e-01 1 1  ON 26
 eO_7                -5.591932e-02 1 1  ON 27
 eO_8                -1.959247e-01 1 1  ON 28
 eO_9                -5.768922e-02 1 1  ON 29
eH1_0                -2.099485e-01 1 1  ON 30
eH1_1                -1.274870e-01 1 1  ON 31
eH1_2                -8.838136e-02 1 1  ON 32
eH1_3                -3.738700e-02 1 1  ON 33
eH1_4                 1.160343e-02 1 1  ON 34
eH1_5                 4.473123e-02 1 1  ON 35
eH1_6                 9.476182e-02 1 1  ON 36
eH1_7                 1.381760e-01 1 1  ON 37
eH1_8                 1.456931e-01 1 1  ON 38
eH1_9                 3.283884e-02 1 1  ON 39
eH2_0                -2.088280e-01 1 1  ON 40
eH2_1                -1.265476e-01 1 1  ON 41
eH2_2                -8.740934e-02 1 1  ON 42
eH2_3                -3.640809e-02 1 1  ON 43
eH2_4                 1.290036e-02 1 1  ON 44
eH2_5                 4.795002e-02 1 1  ON 45
eH2_6                 1.006134e-01 1 1  ON 46
eH2_7                 1.496010e-01 1 1  ON 47
eH2_8                 1.537448e-01 1 1  ON 48
eH2_9                 1.292511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.325656
====================================================
  Execution time = 2.5047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2386e-01
  Total weights = 2.0000e+06
  Execution time = 3.0272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323876521424
                                         uncertainty =       0.002862867601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323876521424
                                         uncertainty =       0.002862867601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402409320
  error estimate for blocks of size 2^( 2) =       0.000415044572
  error estimate for blocks of size 2^( 3) =       0.000428833943
  error estimate for blocks of size 2^( 4) =       0.000441789037
  error estimate for blocks of size 2^( 5) =       0.000451705504
  error estimate for blocks of size 2^( 6) =       0.000460108202
  error estimate for blocks of size 2^( 7) =       0.000464563943

      target function =                  N/A
              le_mean =     -16.908604410782
             les_mean =     286.224769479517
             stat err =       0.000454541671
             autocorr =       1.275884461440
              std dev =       0.569092717509
             le_variance =       0.323866521122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323862347912
                                         uncertainty =       0.002862841581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323862347912
                                         uncertainty =       0.002862841581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402400524
  error estimate for blocks of size 2^( 2) =       0.000415034446
  error estimate for blocks of size 2^( 3) =       0.000428822862
  error estimate for blocks of size 2^( 4) =       0.000441777148
  error estimate for blocks of size 2^( 5) =       0.000451693478
  error estimate for blocks of size 2^( 6) =       0.000460096564
  error estimate for blocks of size 2^( 7) =       0.000464552845

      target function =                  N/A
              le_mean =     -16.908604455854
             les_mean =     286.224756845959
             stat err =       0.000454530009
             autocorr =       1.275874764999
              std dev =       0.569080278487
             le_variance =       0.323852363362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323869407456
                                         uncertainty =       0.002862854422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323869407456
                                         uncertainty =       0.002862854422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402404905
  error estimate for blocks of size 2^( 2) =       0.000415039491
  error estimate for blocks of size 2^( 3) =       0.000428828384
  error estimate for blocks of size 2^( 4) =       0.000441783074
  error estimate for blocks of size 2^( 5) =       0.000451699473
  error estimate for blocks of size 2^( 6) =       0.000460102366
  error estimate for blocks of size 2^( 7) =       0.000464558377

      target function =                  N/A
              le_mean =     -16.908604432771
             les_mean =     286.224763117041
             stat err =       0.000454535822
             autocorr =       1.275879620419
              std dev =       0.569086474133
             le_variance =       0.323859415042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323875630987
                                         uncertainty =       0.002862865948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323875630987
                                         uncertainty =       0.002862865948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402408767
  error estimate for blocks of size 2^( 2) =       0.000415043936
  error estimate for blocks of size 2^( 3) =       0.000428833247
  error estimate for blocks of size 2^( 4) =       0.000441788290
  error estimate for blocks of size 2^( 5) =       0.000451704749
  error estimate for blocks of size 2^( 6) =       0.000460107471
  error estimate for blocks of size 2^( 7) =       0.000464563247

      target function =                  N/A
              le_mean =     -16.908604413465
             les_mean =     286.224768680787
             stat err =       0.000454540939
             autocorr =       1.275883856499
              std dev =       0.569091936045
             le_variance =       0.323865631672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908604410782        initial
     1.5625e+02     1.5625e+03             3.1196e-05       -16.908604455854  <--
     6.2500e+02     6.2500e+03             7.8070e-06       -16.908604432771
     2.5000e+03     2.5000e+04             1.9523e-06       -16.908604413465

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 3.9966e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.027066e-01 1 1  ON 0
 uu_1                 1.395422e-01 1 1  ON 1
 uu_2                 4.158754e-02 1 1  ON 2
 uu_3                -1.945837e-02 1 1  ON 3
 uu_4                -6.333103e-02 1 1  ON 4
 uu_5                -9.587599e-02 1 1  ON 5
 uu_6                -1.205709e-01 1 1  ON 6
 uu_7                -1.310574e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277308e-02 1 1  ON 9
 ud_0                 4.114467e-01 1 1  ON 10
 ud_1                 1.583617e-01 1 1  ON 11
 ud_2                 6.091408e-02 1 1  ON 12
 ud_3                 2.681304e-03 1 1  ON 13
 ud_4                -5.713280e-02 1 1  ON 14
 ud_5                -1.014975e-01 1 1  ON 15
 ud_6                -1.286697e-01 1 1  ON 16
 ud_7                -1.435052e-01 1 1  ON 17
 ud_8                -1.424336e-01 1 1  ON 18
 ud_9                -1.344548e-01 1 1  ON 19
 eO_0                -7.043510e-01 1 1  ON 20
 eO_1                -4.137186e-01 1 1  ON 21
 eO_2                -3.182792e-02 1 1  ON 22
 eO_3                 2.692223e-01 1 1  ON 23
 eO_4                 4.916469e-01 1 1  ON 24
 eO_5                 4.596052e-01 1 1  ON 25
 eO_6                 2.360347e-01 1 1  ON 26
 eO_7                -5.591900e-02 1 1  ON 27
 eO_8                -1.959256e-01 1 1  ON 28
 eO_9                -5.768975e-02 1 1  ON 29
eH1_0                -2.099596e-01 1 1  ON 30
eH1_1                -1.274861e-01 1 1  ON 31
eH1_2                -8.837992e-02 1 1  ON 32
eH1_3                -3.738785e-02 1 1  ON 33
eH1_4                 1.160833e-02 1 1  ON 34
eH1_5                 4.473235e-02 1 1  ON 35
eH1_6                 9.476224e-02 1 1  ON 36
eH1_7                 1.381767e-01 1 1  ON 37
eH1_8                 1.456943e-01 1 1  ON 38
eH1_9                 3.283989e-02 1 1  ON 39
eH2_0                -2.088391e-01 1 1  ON 40
eH2_1                -1.265462e-01 1 1  ON 41
eH2_2                -8.740809e-02 1 1  ON 42
eH2_3                -3.640832e-02 1 1  ON 43
eH2_4                 1.290601e-02 1 1  ON 44
eH2_5                 4.795061e-02 1 1  ON 45
eH2_6                 1.006138e-01 1 1  ON 46
eH2_7                 1.496012e-01 1 1  ON 47
eH2_8                 1.537456e-01 1 1  ON 48
eH2_9                 1.292609e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8464
    reference variance = 0.475163
====================================================
  Execution time = 2.5915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338398247217
                                         uncertainty =       0.011202102322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338398247217
                                         uncertainty =       0.011202102322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411520429
  error estimate for blocks of size 2^( 2) =       0.000424298336
  error estimate for blocks of size 2^( 3) =       0.000437906424
  error estimate for blocks of size 2^( 4) =       0.000450008713
  error estimate for blocks of size 2^( 5) =       0.000460944638
  error estimate for blocks of size 2^( 6) =       0.000467645253
  error estimate for blocks of size 2^( 7) =       0.000470942820

      target function =                  N/A
              le_mean =     -16.908779881606
             les_mean =     286.245535041961
             stat err =       0.000462385356
             autocorr =       1.262482432478
              std dev =       0.581977771651
             le_variance =       0.338698126696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690877988161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779881606       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908782222889       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908784014431       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908784498412       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908784823387       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908785042080       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908785164714       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908785191824       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908785200341       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908785201787       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908785200611       residual = 6.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.239058e-04

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779881606       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908780469266       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908780921097       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908781042610       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908781123656       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908781178527       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908781208875       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908781215808       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908781217913       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908781218287       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.112717e-05

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908779881606       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908780028668       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908780141875       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908780172287       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908780192535       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908780206266       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908780213834       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908780215574       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908780216101       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908780216196       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.789839e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2573e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.027032e-01 1 1  ON 0
 uu_1                 1.395357e-01 1 1  ON 1
 uu_2                 4.158944e-02 1 1  ON 2
 uu_3                -1.945388e-02 1 1  ON 3
 uu_4                -6.332991e-02 1 1  ON 4
 uu_5                -9.587698e-02 1 1  ON 5
 uu_6                -1.205707e-01 1 1  ON 6
 uu_7                -1.310554e-01 1 1  ON 7
 uu_8                -1.203228e-01 1 1  ON 8
 uu_9                -9.277354e-02 1 1  ON 9
 ud_0                 4.114502e-01 1 1  ON 10
 ud_1                 1.583787e-01 1 1  ON 11
 ud_2                 6.090440e-02 1 1  ON 12
 ud_3                 2.667694e-03 1 1  ON 13
 ud_4                -5.712790e-02 1 1  ON 14
 ud_5                -1.014955e-01 1 1  ON 15
 ud_6                -1.286704e-01 1 1  ON 16
 ud_7                -1.435076e-01 1 1  ON 17
 ud_8                -1.424349e-01 1 1  ON 18
 ud_9                -1.344553e-01 1 1  ON 19
 eO_0                -7.043821e-01 1 1  ON 20
 eO_1                -4.137212e-01 1 1  ON 21
 eO_2                -3.180565e-02 1 1  ON 22
 eO_3                 2.692372e-01 1 1  ON 23
 eO_4                 4.916478e-01 1 1  ON 24
 eO_5                 4.596019e-01 1 1  ON 25
 eO_6                 2.360347e-01 1 1  ON 26
 eO_7                -5.591772e-02 1 1  ON 27
 eO_8                -1.959266e-01 1 1  ON 28
 eO_9                -5.769084e-02 1 1  ON 29
eH1_0                -2.099741e-01 1 1  ON 30
eH1_1                -1.274853e-01 1 1  ON 31
eH1_2                -8.837819e-02 1 1  ON 32
eH1_3                -3.738902e-02 1 1  ON 33
eH1_4                 1.161537e-02 1 1  ON 34
eH1_5                 4.473336e-02 1 1  ON 35
eH1_6                 9.476337e-02 1 1  ON 36
eH1_7                 1.381776e-01 1 1  ON 37
eH1_8                 1.456963e-01 1 1  ON 38
eH1_9                 3.284110e-02 1 1  ON 39
eH2_0                -2.088537e-01 1 1  ON 40
eH2_1                -1.265443e-01 1 1  ON 41
eH2_2                -8.740586e-02 1 1  ON 42
eH2_3                -3.640925e-02 1 1  ON 43
eH2_4                 1.291318e-02 1 1  ON 44
eH2_5                 4.795111e-02 1 1  ON 45
eH2_6                 1.006144e-01 1 1  ON 46
eH2_7                 1.496012e-01 1 1  ON 47
eH2_8                 1.537470e-01 1 1  ON 48
eH2_9                 1.292767e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.393452
====================================================
  Execution time = 2.5385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3414e-01
  Total weights = 2.0000e+06
  Execution time = 2.9574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334183090365
                                         uncertainty =       0.004535398887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334183090365
                                         uncertainty =       0.004535398887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408752100
  error estimate for blocks of size 2^( 2) =       0.000421467940
  error estimate for blocks of size 2^( 3) =       0.000435679105
  error estimate for blocks of size 2^( 4) =       0.000448617079
  error estimate for blocks of size 2^( 5) =       0.000458794348
  error estimate for blocks of size 2^( 6) =       0.000467429625
  error estimate for blocks of size 2^( 7) =       0.000473248154

      target function =                  N/A
              le_mean =     -16.907972741926
             les_mean =     286.213698633200
             stat err =       0.000462022301
             autocorr =       1.277632304213
              std dev =       0.578062763527
             le_variance =       0.334156558576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334122471404
                                         uncertainty =       0.004535278902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334122471404
                                         uncertainty =       0.004535278902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408714994
  error estimate for blocks of size 2^( 2) =       0.000421425703
  error estimate for blocks of size 2^( 3) =       0.000435632615
  error estimate for blocks of size 2^( 4) =       0.000448568094
  error estimate for blocks of size 2^( 5) =       0.000458744725
  error estimate for blocks of size 2^( 6) =       0.000467381064
  error estimate for blocks of size 2^( 7) =       0.000473198427

      target function =                  N/A
              le_mean =     -16.907972770922
             les_mean =     286.213638947929
             stat err =       0.000461973078
             autocorr =       1.277592026713
              std dev =       0.578010287750
             le_variance =       0.334095892745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334152315072
                                         uncertainty =       0.004535336484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334152315072
                                         uncertainty =       0.004535336484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408733262
  error estimate for blocks of size 2^( 2) =       0.000421446523
  error estimate for blocks of size 2^( 3) =       0.000435655552
  error estimate for blocks of size 2^( 4) =       0.000448592277
  error estimate for blocks of size 2^( 5) =       0.000458769231
  error estimate for blocks of size 2^( 6) =       0.000467405051
  error estimate for blocks of size 2^( 7) =       0.000473222997

      target function =                  N/A
              le_mean =     -16.907972747099
             les_mean =     286.213668009200
             stat err =       0.000461997389
             autocorr =       1.277612282643
              std dev =       0.578036123111
             le_variance =       0.334125759622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334179223636
                                         uncertainty =       0.004535391027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334179223636
                                         uncertainty =       0.004535391027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408749733
  error estimate for blocks of size 2^( 2) =       0.000421465250
  error estimate for blocks of size 2^( 3) =       0.000435676147
  error estimate for blocks of size 2^( 4) =       0.000448613965
  error estimate for blocks of size 2^( 5) =       0.000458791195
  error estimate for blocks of size 2^( 6) =       0.000467426540
  error estimate for blocks of size 2^( 7) =       0.000473244996

      target function =                  N/A
              le_mean =     -16.907972741483
             les_mean =     286.213694748551
             stat err =       0.000462019174
             autocorr =       1.277629803805
              std dev =       0.578059416397
             le_variance =       0.334152688885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907972741926        initial
     3.9062e+01     3.9062e+02             1.2391e-04       -16.907972770922  <--
     1.5625e+02     1.5625e+03             3.1127e-05       -16.907972747099
     6.2500e+02     6.2500e+03             7.7898e-06       -16.907972741483

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.0247e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.026932e-01 1 1  ON 0
 uu_1                 1.395162e-01 1 1  ON 1
 uu_2                 4.159490e-02 1 1  ON 2
 uu_3                -1.944041e-02 1 1  ON 3
 uu_4                -6.332653e-02 1 1  ON 4
 uu_5                -9.588011e-02 1 1  ON 5
 uu_6                -1.205701e-01 1 1  ON 6
 uu_7                -1.310494e-01 1 1  ON 7
 uu_8                -1.203218e-01 1 1  ON 8
 uu_9                -9.277499e-02 1 1  ON 9
 ud_0                 4.114613e-01 1 1  ON 10
 ud_1                 1.584292e-01 1 1  ON 11
 ud_2                 6.087574e-02 1 1  ON 12
 ud_3                 2.627052e-03 1 1  ON 13
 ud_4                -5.711359e-02 1 1  ON 14
 ud_5                -1.014898e-01 1 1  ON 15
 ud_6                -1.286725e-01 1 1  ON 16
 ud_7                -1.435145e-01 1 1  ON 17
 ud_8                -1.424390e-01 1 1  ON 18
 ud_9                -1.344567e-01 1 1  ON 19
 eO_0                -7.044749e-01 1 1  ON 20
 eO_1                -4.137298e-01 1 1  ON 21
 eO_2                -3.173925e-02 1 1  ON 22
 eO_3                 2.692816e-01 1 1  ON 23
 eO_4                 4.916508e-01 1 1  ON 24
 eO_5                 4.595923e-01 1 1  ON 25
 eO_6                 2.360346e-01 1 1  ON 26
 eO_7                -5.591382e-02 1 1  ON 27
 eO_8                -1.959298e-01 1 1  ON 28
 eO_9                -5.769417e-02 1 1  ON 29
eH1_0                -2.100179e-01 1 1  ON 30
eH1_1                -1.274832e-01 1 1  ON 31
eH1_2                -8.837298e-02 1 1  ON 32
eH1_3                -3.739257e-02 1 1  ON 33
eH1_4                 1.163645e-02 1 1  ON 34
eH1_5                 4.473633e-02 1 1  ON 35
eH1_6                 9.476682e-02 1 1  ON 36
eH1_7                 1.381805e-01 1 1  ON 37
eH1_8                 1.457022e-01 1 1  ON 38
eH1_9                 3.284478e-02 1 1  ON 39
eH2_0                -2.088976e-01 1 1  ON 40
eH2_1                -1.265389e-01 1 1  ON 41
eH2_2                -8.739912e-02 1 1  ON 42
eH2_3                -3.641208e-02 1 1  ON 43
eH2_4                 1.293465e-02 1 1  ON 44
eH2_5                 4.795255e-02 1 1  ON 45
eH2_6                 1.006163e-01 1 1  ON 46
eH2_7                 1.496014e-01 1 1  ON 47
eH2_8                 1.537513e-01 1 1  ON 48
eH2_9                 1.293250e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8082
    reference variance = 0.248224
====================================================
  Execution time = 2.5804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690218421
                                         uncertainty =       0.013341148033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690218421
                                         uncertainty =       0.013341148033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989787
  error estimate for blocks of size 2^( 2) =       0.000423720430
  error estimate for blocks of size 2^( 3) =       0.000436390174
  error estimate for blocks of size 2^( 4) =       0.000448603448
  error estimate for blocks of size 2^( 5) =       0.000459486944
  error estimate for blocks of size 2^( 6) =       0.000465843927
  error estimate for blocks of size 2^( 7) =       0.000473076765

      target function =                  N/A
              le_mean =     -16.909016950393
             les_mean =     286.252679269824
             stat err =       0.000461752771
             autocorr =       1.262283662906
              std dev =       0.581227330798
             le_variance =       0.337825210067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690901695039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909016950393       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909026798927       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909035854056       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909040000134       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909041182854       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909041609547       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909041644457       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909041633957       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909041692859       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909041685107       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909041688083       residual = 6.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.942107e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909016950393       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909019451812       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909021790777       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909022848678       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909023136917       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909023246145       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909023257691       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909023252281       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909023266853       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909023265089       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.256940e-04

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909016950393       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909017578252       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909018167872       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909018433701       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909018505352       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909018532790       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909018535864       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909018534351       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909018537970       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909018537540       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.155709e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2386e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.026786e-01 1 1  ON 0
 uu_1                 1.394938e-01 1 1  ON 1
 uu_2                 4.160316e-02 1 1  ON 2
 uu_3                -1.942081e-02 1 1  ON 3
 uu_4                -6.332179e-02 1 1  ON 4
 uu_5                -9.588085e-02 1 1  ON 5
 uu_6                -1.205661e-01 1 1  ON 6
 uu_7                -1.310471e-01 1 1  ON 7
 uu_8                -1.203238e-01 1 1  ON 8
 uu_9                -9.277875e-02 1 1  ON 9
 ud_0                 4.114771e-01 1 1  ON 10
 ud_1                 1.584950e-01 1 1  ON 11
 ud_2                 6.083791e-02 1 1  ON 12
 ud_3                 2.572251e-03 1 1  ON 13
 ud_4                -5.709144e-02 1 1  ON 14
 ud_5                -1.014825e-01 1 1  ON 15
 ud_6                -1.286730e-01 1 1  ON 16
 ud_7                -1.435212e-01 1 1  ON 17
 ud_8                -1.424494e-01 1 1  ON 18
 ud_9                -1.344587e-01 1 1  ON 19
 eO_0                -7.046006e-01 1 1  ON 20
 eO_1                -4.137382e-01 1 1  ON 21
 eO_2                -3.164957e-02 1 1  ON 22
 eO_3                 2.693443e-01 1 1  ON 23
 eO_4                 4.916520e-01 1 1  ON 24
 eO_5                 4.595798e-01 1 1  ON 25
 eO_6                 2.360340e-01 1 1  ON 26
 eO_7                -5.591082e-02 1 1  ON 27
 eO_8                -1.959350e-01 1 1  ON 28
 eO_9                -5.769799e-02 1 1  ON 29
eH1_0                -2.100743e-01 1 1  ON 30
eH1_1                -1.274750e-01 1 1  ON 31
eH1_2                -8.836501e-02 1 1  ON 32
eH1_3                -3.739518e-02 1 1  ON 33
eH1_4                 1.166177e-02 1 1  ON 34
eH1_5                 4.473967e-02 1 1  ON 35
eH1_6                 9.476917e-02 1 1  ON 36
eH1_7                 1.381829e-01 1 1  ON 37
eH1_8                 1.457070e-01 1 1  ON 38
eH1_9                 3.284910e-02 1 1  ON 39
eH2_0                -2.089553e-01 1 1  ON 40
eH2_1                -1.265314e-01 1 1  ON 41
eH2_2                -8.738868e-02 1 1  ON 42
eH2_3                -3.641260e-02 1 1  ON 43
eH2_4                 1.296444e-02 1 1  ON 44
eH2_5                 4.795682e-02 1 1  ON 45
eH2_6                 1.006136e-01 1 1  ON 46
eH2_7                 1.495997e-01 1 1  ON 47
eH2_8                 1.537572e-01 1 1  ON 48
eH2_9                 1.293761e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8545
    reference variance = 0.296848
====================================================
  Execution time = 2.5279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2910e-01
  Total weights = 2.0000e+06
  Execution time = 2.9495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329080020143
                                         uncertainty =       0.003631259233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329080020143
                                         uncertainty =       0.003631259233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405681497
  error estimate for blocks of size 2^( 2) =       0.000418309411
  error estimate for blocks of size 2^( 3) =       0.000431893822
  error estimate for blocks of size 2^( 4) =       0.000444939654
  error estimate for blocks of size 2^( 5) =       0.000455819039
  error estimate for blocks of size 2^( 6) =       0.000463265423
  error estimate for blocks of size 2^( 7) =       0.000470763624

      target function =                  N/A
              le_mean =     -16.908867598966
             les_mean =     286.238958269005
             stat err =       0.000458696935
             autocorr =       1.278442723715
              std dev =       0.573720275236
             le_variance =       0.329154954217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328858987836
                                         uncertainty =       0.003629944897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328858987836
                                         uncertainty =       0.003629944897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545291
  error estimate for blocks of size 2^( 2) =       0.000418153155
  error estimate for blocks of size 2^( 3) =       0.000431719454
  error estimate for blocks of size 2^( 4) =       0.000444758167
  error estimate for blocks of size 2^( 5) =       0.000455631178
  error estimate for blocks of size 2^( 6) =       0.000463073327
  error estimate for blocks of size 2^( 7) =       0.000470567085

      target function =                  N/A
              le_mean =     -16.908870696815
             les_mean =     286.238842043695
             stat err =       0.000458507439
             autocorr =       1.278244835816
              std dev =       0.573527651089
             le_variance =       0.328933966564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328962944021
                                         uncertainty =       0.003630558369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328962944021
                                         uncertainty =       0.003630558369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405609355
  error estimate for blocks of size 2^( 2) =       0.000418227070
  error estimate for blocks of size 2^( 3) =       0.000431802286
  error estimate for blocks of size 2^( 4) =       0.000444844546
  error estimate for blocks of size 2^( 5) =       0.000455720739
  error estimate for blocks of size 2^( 6) =       0.000463165009
  error estimate for blocks of size 2^( 7) =       0.000470660946

      target function =                  N/A
              le_mean =     -16.908869067180
             les_mean =     286.238890864411
             stat err =       0.000458597810
             autocorr =       1.278344851356
              std dev =       0.573618251001
             le_variance =       0.329037897881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329065080536
                                         uncertainty =       0.003631170089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329065080536
                                         uncertainty =       0.003631170089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405672292
  error estimate for blocks of size 2^( 2) =       0.000418298921
  error estimate for blocks of size 2^( 3) =       0.000431882175
  error estimate for blocks of size 2^( 4) =       0.000444927558
  error estimate for blocks of size 2^( 5) =       0.000455806544
  error estimate for blocks of size 2^( 6) =       0.000463252662
  error estimate for blocks of size 2^( 7) =       0.000470750579

      target function =                  N/A
              le_mean =     -16.908867767168
             les_mean =     286.238949019989
             stat err =       0.000458684336
             autocorr =       1.278430509507
              std dev =       0.573707257225
             le_variance =       0.329140016993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908867598966        initial
     9.7656e+00     9.7656e+01             4.9421e-04       -16.908870696815  <--
     3.9062e+01     3.9062e+02             1.2569e-04       -16.908869067180
     1.5625e+02     1.5625e+03             3.1557e-05       -16.908867767168

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.0086e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.026371e-01 1 1  ON 0
 uu_1                 1.394300e-01 1 1  ON 1
 uu_2                 4.162584e-02 1 1  ON 2
 uu_3                -1.936361e-02 1 1  ON 3
 uu_4                -6.330747e-02 1 1  ON 4
 uu_5                -9.588356e-02 1 1  ON 5
 uu_6                -1.205550e-01 1 1  ON 6
 uu_7                -1.310408e-01 1 1  ON 7
 uu_8                -1.203306e-01 1 1  ON 8
 uu_9                -9.279038e-02 1 1  ON 9
 ud_0                 4.115302e-01 1 1  ON 10
 ud_1                 1.586838e-01 1 1  ON 11
 ud_2                 6.072962e-02 1 1  ON 12
 ud_3                 2.411518e-03 1 1  ON 13
 ud_4                -5.703029e-02 1 1  ON 14
 ud_5                -1.014609e-01 1 1  ON 15
 ud_6                -1.286742e-01 1 1  ON 16
 ud_7                -1.435411e-01 1 1  ON 17
 ud_8                -1.424812e-01 1 1  ON 18
 ud_9                -1.344650e-01 1 1  ON 19
 eO_0                -7.049691e-01 1 1  ON 20
 eO_1                -4.137671e-01 1 1  ON 21
 eO_2                -3.138691e-02 1 1  ON 22
 eO_3                 2.695306e-01 1 1  ON 23
 eO_4                 4.916581e-01 1 1  ON 24
 eO_5                 4.595438e-01 1 1  ON 25
 eO_6                 2.360321e-01 1 1  ON 26
 eO_7                -5.590177e-02 1 1  ON 27
 eO_8                -1.959511e-01 1 1  ON 28
 eO_9                -5.770969e-02 1 1  ON 29
eH1_0                -2.102416e-01 1 1  ON 30
eH1_1                -1.274516e-01 1 1  ON 31
eH1_2                -8.834077e-02 1 1  ON 32
eH1_3                -3.740317e-02 1 1  ON 33
eH1_4                 1.173618e-02 1 1  ON 34
eH1_5                 4.474983e-02 1 1  ON 35
eH1_6                 9.477651e-02 1 1  ON 36
eH1_7                 1.381903e-01 1 1  ON 37
eH1_8                 1.457218e-01 1 1  ON 38
eH1_9                 3.286233e-02 1 1  ON 39
eH2_0                -2.091267e-01 1 1  ON 40
eH2_1                -1.265107e-01 1 1  ON 41
eH2_2                -8.735717e-02 1 1  ON 42
eH2_3                -3.641384e-02 1 1  ON 43
eH2_4                 1.305241e-02 1 1  ON 44
eH2_5                 4.796969e-02 1 1  ON 45
eH2_6                 1.006060e-01 1 1  ON 46
eH2_7                 1.495945e-01 1 1  ON 47
eH2_8                 1.537751e-01 1 1  ON 48
eH2_9                 1.295321e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0045
    reference variance = 0.488349
====================================================
  Execution time = 2.7920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326622111596
                                         uncertainty =       0.003462529323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326622111596
                                         uncertainty =       0.003462529323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404118336
  error estimate for blocks of size 2^( 2) =       0.000416829780
  error estimate for blocks of size 2^( 3) =       0.000430249093
  error estimate for blocks of size 2^( 4) =       0.000442357886
  error estimate for blocks of size 2^( 5) =       0.000453799668
  error estimate for blocks of size 2^( 6) =       0.000460965849
  error estimate for blocks of size 2^( 7) =       0.000464829557

      target function =                  N/A
              le_mean =     -16.909239515848
             les_mean =     286.249004099282
             stat err =       0.000455488240
             autocorr =       1.270390466097
              std dev =       0.571509630970
             le_variance =       0.326623258291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690923951585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909239515848       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909268220319       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909291552135       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909300739230       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909306511628       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909308043386       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909309435241       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909309613266       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909309464280       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909309501633       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909309499929       residual = 9.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.796483e-03

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909239515848       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909247141718       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909253730752       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909256231632       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909257611348       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909258026714       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909258358485       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909258427002       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909258389538       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909258388211       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909258390951       residual = 6.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.765922e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909239515848       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241452662       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909243154385       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909243794928       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909244134638       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909244240893       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909244322295       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909244341458       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909244332419       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909244331712       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.211484e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4530e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.025801e-01 1 1  ON 0
 uu_1                 1.393367e-01 1 1  ON 1
 uu_2                 4.165456e-02 1 1  ON 2
 uu_3                -1.929583e-02 1 1  ON 3
 uu_4                -6.328247e-02 1 1  ON 4
 uu_5                -9.589578e-02 1 1  ON 5
 uu_6                -1.205566e-01 1 1  ON 6
 uu_7                -1.310348e-01 1 1  ON 7
 uu_8                -1.203329e-01 1 1  ON 8
 uu_9                -9.278173e-02 1 1  ON 9
 ud_0                 4.116022e-01 1 1  ON 10
 ud_1                 1.589243e-01 1 1  ON 11
 ud_2                 6.058453e-02 1 1  ON 12
 ud_3                 2.198929e-03 1 1  ON 13
 ud_4                -5.696831e-02 1 1  ON 14
 ud_5                -1.014335e-01 1 1  ON 15
 ud_6                -1.286773e-01 1 1  ON 16
 ud_7                -1.435791e-01 1 1  ON 17
 ud_8                -1.424989e-01 1 1  ON 18
 ud_9                -1.344570e-01 1 1  ON 19
 eO_0                -7.054457e-01 1 1  ON 20
 eO_1                -4.138165e-01 1 1  ON 21
 eO_2                -3.104044e-02 1 1  ON 22
 eO_3                 2.697576e-01 1 1  ON 23
 eO_4                 4.916697e-01 1 1  ON 24
 eO_5                 4.595049e-01 1 1  ON 25
 eO_6                 2.360293e-01 1 1  ON 26
 eO_7                -5.589637e-02 1 1  ON 27
 eO_8                -1.959638e-01 1 1  ON 28
 eO_9                -5.771894e-02 1 1  ON 29
eH1_0                -2.104666e-01 1 1  ON 30
eH1_1                -1.274196e-01 1 1  ON 31
eH1_2                -8.830979e-02 1 1  ON 32
eH1_3                -3.742931e-02 1 1  ON 33
eH1_4                 1.183044e-02 1 1  ON 34
eH1_5                 4.476241e-02 1 1  ON 35
eH1_6                 9.478790e-02 1 1  ON 36
eH1_7                 1.382048e-01 1 1  ON 37
eH1_8                 1.457510e-01 1 1  ON 38
eH1_9                 3.288631e-02 1 1  ON 39
eH2_0                -2.093508e-01 1 1  ON 40
eH2_1                -1.264861e-01 1 1  ON 41
eH2_2                -8.732050e-02 1 1  ON 42
eH2_3                -3.641622e-02 1 1  ON 43
eH2_4                 1.316444e-02 1 1  ON 44
eH2_5                 4.798544e-02 1 1  ON 45
eH2_6                 1.006112e-01 1 1  ON 46
eH2_7                 1.495881e-01 1 1  ON 47
eH2_8                 1.537911e-01 1 1  ON 48
eH2_9                 1.297417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8314
    reference variance = 0.173651
====================================================
  Execution time = 2.5362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3223e-01
  Total weights = 2.0000e+06
  Execution time = 2.9502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454625732
                                         uncertainty =       0.003509346802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454625732
                                         uncertainty =       0.003509346802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407692493
  error estimate for blocks of size 2^( 2) =       0.000420160385
  error estimate for blocks of size 2^( 3) =       0.000433562803
  error estimate for blocks of size 2^( 4) =       0.000445966848
  error estimate for blocks of size 2^( 5) =       0.000456491648
  error estimate for blocks of size 2^( 6) =       0.000464735380
  error estimate for blocks of size 2^( 7) =       0.000468041475

      target function =                  N/A
              le_mean =     -16.909210174744
             les_mean =     286.253814905812
             stat err =       0.000458808838
             autocorr =       1.266479368887
              std dev =       0.576564253454
             le_variance =       0.332426338361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331829302885
                                         uncertainty =       0.003513798349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331829302885
                                         uncertainty =       0.003513798349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407308675
  error estimate for blocks of size 2^( 2) =       0.000419704406
  error estimate for blocks of size 2^( 3) =       0.000433047057
  error estimate for blocks of size 2^( 4) =       0.000445401080
  error estimate for blocks of size 2^( 5) =       0.000455911884
  error estimate for blocks of size 2^( 6) =       0.000464112424
  error estimate for blocks of size 2^( 7) =       0.000467437224

      target function =                  N/A
              le_mean =     -16.909209079526
             les_mean =     286.253152242932
             stat err =       0.000458215653
             autocorr =       1.265588504769
              std dev =       0.576021452468
             le_variance =       0.331800713704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067719220
                                         uncertainty =       0.003511542952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067719220
                                         uncertainty =       0.003511542952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407455077
  error estimate for blocks of size 2^( 2) =       0.000419884110
  error estimate for blocks of size 2^( 3) =       0.000433254486
  error estimate for blocks of size 2^( 4) =       0.000445631497
  error estimate for blocks of size 2^( 5) =       0.000456149406
  error estimate for blocks of size 2^( 6) =       0.000464370163
  error estimate for blocks of size 2^( 7) =       0.000467687508

      target function =                  N/A
              le_mean =     -16.909207616250
             les_mean =     286.253341323466
             stat err =       0.000458459644
             autocorr =       1.266026386127
              std dev =       0.576228496369
             le_variance =       0.332039280027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332402081239
                                         uncertainty =       0.003509616493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332402081239
                                         uncertainty =       0.003509616493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407660260
  error estimate for blocks of size 2^( 2) =       0.000420123126
  error estimate for blocks of size 2^( 3) =       0.000433521419
  error estimate for blocks of size 2^( 4) =       0.000445921988
  error estimate for blocks of size 2^( 5) =       0.000456445930
  error estimate for blocks of size 2^( 6) =       0.000464686747
  error estimate for blocks of size 2^( 7) =       0.000467994314

      target function =                  N/A
              le_mean =     -16.909209588950
             les_mean =     286.253742531846
             stat err =       0.000458762245
             autocorr =       1.266422400691
              std dev =       0.576518668377
             le_variance =       0.332373774987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909210174744        initial  <--
     2.4414e+00     2.4414e+01             1.7965e-03       -16.909209079526
     9.7656e+00     9.7656e+01             4.7659e-04       -16.909207616250
     3.9062e+01     3.9062e+02             1.2115e-04       -16.909209588950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2167
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.026371e-01 1 1  ON 0
 uu_1                 1.394300e-01 1 1  ON 1
 uu_2                 4.162584e-02 1 1  ON 2
 uu_3                -1.936361e-02 1 1  ON 3
 uu_4                -6.330747e-02 1 1  ON 4
 uu_5                -9.588356e-02 1 1  ON 5
 uu_6                -1.205550e-01 1 1  ON 6
 uu_7                -1.310408e-01 1 1  ON 7
 uu_8                -1.203306e-01 1 1  ON 8
 uu_9                -9.279038e-02 1 1  ON 9
 ud_0                 4.115302e-01 1 1  ON 10
 ud_1                 1.586838e-01 1 1  ON 11
 ud_2                 6.072962e-02 1 1  ON 12
 ud_3                 2.411518e-03 1 1  ON 13
 ud_4                -5.703029e-02 1 1  ON 14
 ud_5                -1.014609e-01 1 1  ON 15
 ud_6                -1.286742e-01 1 1  ON 16
 ud_7                -1.435411e-01 1 1  ON 17
 ud_8                -1.424812e-01 1 1  ON 18
 ud_9                -1.344650e-01 1 1  ON 19
 eO_0                -7.049691e-01 1 1  ON 20
 eO_1                -4.137671e-01 1 1  ON 21
 eO_2                -3.138691e-02 1 1  ON 22
 eO_3                 2.695306e-01 1 1  ON 23
 eO_4                 4.916581e-01 1 1  ON 24
 eO_5                 4.595438e-01 1 1  ON 25
 eO_6                 2.360321e-01 1 1  ON 26
 eO_7                -5.590177e-02 1 1  ON 27
 eO_8                -1.959511e-01 1 1  ON 28
 eO_9                -5.770969e-02 1 1  ON 29
eH1_0                -2.102416e-01 1 1  ON 30
eH1_1                -1.274516e-01 1 1  ON 31
eH1_2                -8.834077e-02 1 1  ON 32
eH1_3                -3.740317e-02 1 1  ON 33
eH1_4                 1.173618e-02 1 1  ON 34
eH1_5                 4.474983e-02 1 1  ON 35
eH1_6                 9.477651e-02 1 1  ON 36
eH1_7                 1.381903e-01 1 1  ON 37
eH1_8                 1.457218e-01 1 1  ON 38
eH1_9                 3.286233e-02 1 1  ON 39
eH2_0                -2.091267e-01 1 1  ON 40
eH2_1                -1.265107e-01 1 1  ON 41
eH2_2                -8.735717e-02 1 1  ON 42
eH2_3                -3.641384e-02 1 1  ON 43
eH2_4                 1.305241e-02 1 1  ON 44
eH2_5                 4.796969e-02 1 1  ON 45
eH2_6                 1.006060e-01 1 1  ON 46
eH2_7                 1.495945e-01 1 1  ON 47
eH2_8                 1.537751e-01 1 1  ON 48
eH2_9                 1.295321e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.439696
====================================================
  Execution time = 2.5682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3567e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335679927909
                                         uncertainty =       0.005519461039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335679927909
                                         uncertainty =       0.005519461039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409678198
  error estimate for blocks of size 2^( 2) =       0.000422398266
  error estimate for blocks of size 2^( 3) =       0.000435769773
  error estimate for blocks of size 2^( 4) =       0.000447942843
  error estimate for blocks of size 2^( 5) =       0.000458213034
  error estimate for blocks of size 2^( 6) =       0.000467504283
  error estimate for blocks of size 2^( 7) =       0.000471922875

      target function =                  N/A
              le_mean =     -16.907899959213
             les_mean =     286.212753315338
             stat err =       0.000461395759
             autocorr =       1.268415354659
              std dev =       0.579372464337
             le_variance =       0.335672452431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690789995921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907899959213       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907902973586       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907906255543       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907906994834       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907907356463       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907907715672       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907907770228       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907907736326       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907907759617       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907907766592       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907907764531       residual = 5.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.945637e-04

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907899959213       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907900717641       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907901549066       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907901733880       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907901823690       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907901914078       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907901927520       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907901918948       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907901924539       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907901926349       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.898862e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907899959213       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907900149124       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907900357675       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907900403878       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907900426292       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907900448926       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907900452274       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907900450125       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907900451507       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907900451965       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.226695e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2291e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.026323e-01 1 1  ON 0
 uu_1                 1.394210e-01 1 1  ON 1
 uu_2                 4.162923e-02 1 1  ON 2
 uu_3                -1.935755e-02 1 1  ON 3
 uu_4                -6.330581e-02 1 1  ON 4
 uu_5                -9.588517e-02 1 1  ON 5
 uu_6                -1.205559e-01 1 1  ON 6
 uu_7                -1.310399e-01 1 1  ON 7
 uu_8                -1.203307e-01 1 1  ON 8
 uu_9                -9.278952e-02 1 1  ON 9
 ud_0                 4.115379e-01 1 1  ON 10
 ud_1                 1.587086e-01 1 1  ON 11
 ud_2                 6.071427e-02 1 1  ON 12
 ud_3                 2.389577e-03 1 1  ON 13
 ud_4                -5.702337e-02 1 1  ON 14
 ud_5                -1.014581e-01 1 1  ON 15
 ud_6                -1.286743e-01 1 1  ON 16
 ud_7                -1.435438e-01 1 1  ON 17
 ud_8                -1.424840e-01 1 1  ON 18
 ud_9                -1.344647e-01 1 1  ON 19
 eO_0                -7.050181e-01 1 1  ON 20
 eO_1                -4.137721e-01 1 1  ON 21
 eO_2                -3.135164e-02 1 1  ON 22
 eO_3                 2.695550e-01 1 1  ON 23
 eO_4                 4.916595e-01 1 1  ON 24
 eO_5                 4.595386e-01 1 1  ON 25
 eO_6                 2.360320e-01 1 1  ON 26
 eO_7                -5.590024e-02 1 1  ON 27
 eO_8                -1.959530e-01 1 1  ON 28
 eO_9                -5.771097e-02 1 1  ON 29
eH1_0                -2.102645e-01 1 1  ON 30
eH1_1                -1.274485e-01 1 1  ON 31
eH1_2                -8.833829e-02 1 1  ON 32
eH1_3                -3.740493e-02 1 1  ON 33
eH1_4                 1.174644e-02 1 1  ON 34
eH1_5                 4.475075e-02 1 1  ON 35
eH1_6                 9.477790e-02 1 1  ON 36
eH1_7                 1.381923e-01 1 1  ON 37
eH1_8                 1.457246e-01 1 1  ON 38
eH1_9                 3.286408e-02 1 1  ON 39
eH2_0                -2.091498e-01 1 1  ON 40
eH2_1                -1.265082e-01 1 1  ON 41
eH2_2                -8.735424e-02 1 1  ON 42
eH2_3                -3.641391e-02 1 1  ON 43
eH2_4                 1.306292e-02 1 1  ON 44
eH2_5                 4.797162e-02 1 1  ON 45
eH2_6                 1.006072e-01 1 1  ON 46
eH2_7                 1.495941e-01 1 1  ON 47
eH2_8                 1.537767e-01 1 1  ON 48
eH2_9                 1.295575e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9462
    reference variance = 0.210967
====================================================
  Execution time = 2.5216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2923e-01
  Total weights = 2.0000e+06
  Execution time = 2.9475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329181509297
                                         uncertainty =       0.004501697509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329181509297
                                         uncertainty =       0.004501697509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405738665
  error estimate for blocks of size 2^( 2) =       0.000418555577
  error estimate for blocks of size 2^( 3) =       0.000431677589
  error estimate for blocks of size 2^( 4) =       0.000444113417
  error estimate for blocks of size 2^( 5) =       0.000456229633
  error estimate for blocks of size 2^( 6) =       0.000464645180
  error estimate for blocks of size 2^( 7) =       0.000470212864

      target function =                  N/A
              le_mean =     -16.909051940902
             les_mean =     286.245285104683
             stat err =       0.000458800274
             autocorr =       1.278658422576
              std dev =       0.573801123365
             le_variance =       0.329247729175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329104252114
                                         uncertainty =       0.004502070749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329104252114
                                         uncertainty =       0.004502070749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405691078
  error estimate for blocks of size 2^( 2) =       0.000418498724
  error estimate for blocks of size 2^( 3) =       0.000431613722
  error estimate for blocks of size 2^( 4) =       0.000444045197
  error estimate for blocks of size 2^( 5) =       0.000456158665
  error estimate for blocks of size 2^( 6) =       0.000464574037
  error estimate for blocks of size 2^( 7) =       0.000470141680

      target function =                  N/A
              le_mean =     -16.909053520870
             les_mean =     286.245261308274
             stat err =       0.000458729895
             autocorr =       1.278566066263
              std dev =       0.573733824350
             le_variance =       0.329170501203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329141891394
                                         uncertainty =       0.004501878722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329141891394
                                         uncertainty =       0.004501878722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405714263
  error estimate for blocks of size 2^( 2) =       0.000418526500
  error estimate for blocks of size 2^( 3) =       0.000431644981
  error estimate for blocks of size 2^( 4) =       0.000444078621
  error estimate for blocks of size 2^( 5) =       0.000456193457
  error estimate for blocks of size 2^( 6) =       0.000464608926
  error estimate for blocks of size 2^( 7) =       0.000470176589

      target function =                  N/A
              le_mean =     -16.909052716021
             les_mean =     286.245271714331
             stat err =       0.000458764398
             autocorr =       1.278612260537
              std dev =       0.573766612614
             le_variance =       0.329208125750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176513459
                                         uncertainty =       0.004501719961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176513459
                                         uncertainty =       0.004501719961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405735588
  error estimate for blocks of size 2^( 2) =       0.000418551913
  error estimate for blocks of size 2^( 3) =       0.000431673483
  error estimate for blocks of size 2^( 4) =       0.000444109037
  error estimate for blocks of size 2^( 5) =       0.000456225080
  error estimate for blocks of size 2^( 6) =       0.000464640618
  error estimate for blocks of size 2^( 7) =       0.000470208299

      target function =                  N/A
              le_mean =     -16.909052035403
             les_mean =     286.245283306496
             stat err =       0.000458795759
             autocorr =       1.278652651798
              std dev =       0.573796771644
             le_variance =       0.329242735149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909051940902        initial
     2.4414e+01     2.4414e+02             1.9456e-04       -16.909053520870  <--
     9.7656e+01     9.7656e+02             4.8989e-05       -16.909052716021
     3.9062e+02     3.9062e+03             1.2267e-05       -16.909052035403

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.0067e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.026183e-01 1 1  ON 0
 uu_1                 1.393943e-01 1 1  ON 1
 uu_2                 4.163891e-02 1 1  ON 2
 uu_3                -1.933953e-02 1 1  ON 3
 uu_4                -6.330079e-02 1 1  ON 4
 uu_5                -9.589031e-02 1 1  ON 5
 uu_6                -1.205588e-01 1 1  ON 6
 uu_7                -1.310375e-01 1 1  ON 7
 uu_8                -1.203312e-01 1 1  ON 8
 uu_9                -9.278698e-02 1 1  ON 9
 ud_0                 4.115618e-01 1 1  ON 10
 ud_1                 1.587816e-01 1 1  ON 11
 ud_2                 6.066914e-02 1 1  ON 12
 ud_3                 2.324287e-03 1 1  ON 13
 ud_4                -5.700342e-02 1 1  ON 14
 ud_5                -1.014500e-01 1 1  ON 15
 ud_6                -1.286745e-01 1 1  ON 16
 ud_7                -1.435517e-01 1 1  ON 17
 ud_8                -1.424929e-01 1 1  ON 18
 ud_9                -1.344637e-01 1 1  ON 19
 eO_0                -7.051637e-01 1 1  ON 20
 eO_1                -4.137882e-01 1 1  ON 21
 eO_2                -3.124689e-02 1 1  ON 22
 eO_3                 2.696276e-01 1 1  ON 23
 eO_4                 4.916645e-01 1 1  ON 24
 eO_5                 4.595236e-01 1 1  ON 25
 eO_6                 2.360319e-01 1 1  ON 26
 eO_7                -5.589555e-02 1 1  ON 27
 eO_8                -1.959590e-01 1 1  ON 28
 eO_9                -5.771491e-02 1 1  ON 29
eH1_0                -2.103331e-01 1 1  ON 30
eH1_1                -1.274398e-01 1 1  ON 31
eH1_2                -8.833075e-02 1 1  ON 32
eH1_3                -3.741032e-02 1 1  ON 33
eH1_4                 1.177697e-02 1 1  ON 34
eH1_5                 4.475347e-02 1 1  ON 35
eH1_6                 9.478217e-02 1 1  ON 36
eH1_7                 1.381983e-01 1 1  ON 37
eH1_8                 1.457333e-01 1 1  ON 38
eH1_9                 3.286941e-02 1 1  ON 39
eH2_0                -2.092190e-01 1 1  ON 40
eH2_1                -1.265014e-01 1 1  ON 41
eH2_2                -8.734536e-02 1 1  ON 42
eH2_3                -3.641409e-02 1 1  ON 43
eH2_4                 1.309432e-02 1 1  ON 44
eH2_5                 4.797730e-02 1 1  ON 45
eH2_6                 1.006106e-01 1 1  ON 46
eH2_7                 1.495927e-01 1 1  ON 47
eH2_8                 1.537815e-01 1 1  ON 48
eH2_9                 1.296355e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8797
    reference variance = 0.156703
====================================================
  Execution time = 2.5937e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328065895451
                                         uncertainty =       0.003359686578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328065895451
                                         uncertainty =       0.003359686578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169897
  error estimate for blocks of size 2^( 2) =       0.000417442483
  error estimate for blocks of size 2^( 3) =       0.000430447789
  error estimate for blocks of size 2^( 4) =       0.000441982691
  error estimate for blocks of size 2^( 5) =       0.000451688596
  error estimate for blocks of size 2^( 6) =       0.000458425555
  error estimate for blocks of size 2^( 7) =       0.000462575883

      target function =                  N/A
              le_mean =     -16.908474207776
             les_mean =     286.224825161063
             stat err =       0.000453668181
             autocorr =       1.253725038554
              std dev =       0.572996762814
             le_variance =       0.328325290196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690847420778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908474207776       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908486249132       residual = 9.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908499599300       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908503521682       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908505884393       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908506360613       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908506788510       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908506845996       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908506867057       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908506894256       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908506890106       residual = 6.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 7.475023e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908474207776       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908477292233       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908480801972       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908481832025       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908482402375       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908482521537       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908482618182       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908482634684       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908482638452       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908482645271       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.918104e-04

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908474207776       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908474983666       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908475872507       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908476133460       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908476274555       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908476304388       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908476327855       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908476332112       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908476332956       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908476334655       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.826872e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2513e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.026005e-01 1 1  ON 0
 uu_1                 1.393610e-01 1 1  ON 1
 uu_2                 4.164978e-02 1 1  ON 2
 uu_3                -1.931073e-02 1 1  ON 3
 uu_4                -6.329152e-02 1 1  ON 4
 uu_5                -9.589260e-02 1 1  ON 5
 uu_6                -1.205601e-01 1 1  ON 6
 uu_7                -1.310353e-01 1 1  ON 7
 uu_8                -1.203397e-01 1 1  ON 8
 uu_9                -9.278855e-02 1 1  ON 9
 ud_0                 4.115872e-01 1 1  ON 10
 ud_1                 1.588784e-01 1 1  ON 11
 ud_2                 6.061197e-02 1 1  ON 12
 ud_3                 2.240687e-03 1 1  ON 13
 ud_4                -5.697251e-02 1 1  ON 14
 ud_5                -1.014345e-01 1 1  ON 15
 ud_6                -1.286787e-01 1 1  ON 16
 ud_7                -1.435596e-01 1 1  ON 17
 ud_8                -1.425025e-01 1 1  ON 18
 ud_9                -1.344687e-01 1 1  ON 19
 eO_0                -7.053555e-01 1 1  ON 20
 eO_1                -4.138032e-01 1 1  ON 21
 eO_2                -3.111135e-02 1 1  ON 22
 eO_3                 2.697243e-01 1 1  ON 23
 eO_4                 4.916704e-01 1 1  ON 24
 eO_5                 4.595028e-01 1 1  ON 25
 eO_6                 2.360324e-01 1 1  ON 26
 eO_7                -5.589143e-02 1 1  ON 27
 eO_8                -1.959682e-01 1 1  ON 28
 eO_9                -5.772038e-02 1 1  ON 29
eH1_0                -2.104245e-01 1 1  ON 30
eH1_1                -1.274304e-01 1 1  ON 31
eH1_2                -8.831665e-02 1 1  ON 32
eH1_3                -3.741641e-02 1 1  ON 33
eH1_4                 1.181916e-02 1 1  ON 34
eH1_5                 4.475838e-02 1 1  ON 35
eH1_6                 9.478902e-02 1 1  ON 36
eH1_7                 1.382016e-01 1 1  ON 37
eH1_8                 1.457410e-01 1 1  ON 38
eH1_9                 3.287699e-02 1 1  ON 39
eH2_0                -2.093088e-01 1 1  ON 40
eH2_1                -1.264931e-01 1 1  ON 41
eH2_2                -8.733061e-02 1 1  ON 42
eH2_3                -3.641810e-02 1 1  ON 43
eH2_4                 1.313654e-02 1 1  ON 44
eH2_5                 4.797959e-02 1 1  ON 45
eH2_6                 1.006153e-01 1 1  ON 46
eH2_7                 1.495963e-01 1 1  ON 47
eH2_8                 1.537920e-01 1 1  ON 48
eH2_9                 1.297106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0078
    reference variance = 1.63553
====================================================
  Execution time = 2.5139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2873e-01
  Total weights = 2.0000e+06
  Execution time = 2.9417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328410323605
                                         uncertainty =       0.004564805015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328410323605
                                         uncertainty =       0.004564805015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405471081
  error estimate for blocks of size 2^( 2) =       0.000418159623
  error estimate for blocks of size 2^( 3) =       0.000431675282
  error estimate for blocks of size 2^( 4) =       0.000444511119
  error estimate for blocks of size 2^( 5) =       0.000456633635
  error estimate for blocks of size 2^( 6) =       0.000464783289
  error estimate for blocks of size 2^( 7) =       0.000471407725

      target function =                  N/A
              le_mean =     -16.908461360302
             les_mean =     286.224879003405
             stat err =       0.000459333942
             autocorr =       1.283326927454
              std dev =       0.573422701836
             le_variance =       0.328813594981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328111826144
                                         uncertainty =       0.004562576033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328111826144
                                         uncertainty =       0.004562576033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405287179
  error estimate for blocks of size 2^( 2) =       0.000417943934
  error estimate for blocks of size 2^( 3) =       0.000431436638
  error estimate for blocks of size 2^( 4) =       0.000444262456
  error estimate for blocks of size 2^( 5) =       0.000456377156
  error estimate for blocks of size 2^( 6) =       0.000464521125
  error estimate for blocks of size 2^( 7) =       0.000471153542

      target function =                  N/A
              le_mean =     -16.908464215242
             les_mean =     286.224677348453
             stat err =       0.000459078570
             autocorr =       1.283063970343
              std dev =       0.573162624922
             le_variance =       0.328515394608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328247056525
                                         uncertainty =       0.004563615965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328247056525
                                         uncertainty =       0.004563615965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405370491
  error estimate for blocks of size 2^( 2) =       0.000418042654
  error estimate for blocks of size 2^( 3) =       0.000431546500
  error estimate for blocks of size 2^( 4) =       0.000444377302
  error estimate for blocks of size 2^( 5) =       0.000456495891
  error estimate for blocks of size 2^( 6) =       0.000464642757
  error estimate for blocks of size 2^( 7) =       0.000471271483

      target function =                  N/A
              le_mean =     -16.908462554244
             les_mean =     286.224756253090
             stat err =       0.000459196858
             autocorr =       1.283197648661
              std dev =       0.573280445470
             le_variance =       0.328650469158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328389237614
                                         uncertainty =       0.004564653415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328389237614
                                         uncertainty =       0.004564653415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405458091
  error estimate for blocks of size 2^( 2) =       0.000418144559
  error estimate for blocks of size 2^( 3) =       0.000431658722
  error estimate for blocks of size 2^( 4) =       0.000444493926
  error estimate for blocks of size 2^( 5) =       0.000456615951
  error estimate for blocks of size 2^( 6) =       0.000464765259
  error estimate for blocks of size 2^( 7) =       0.000471390240

      target function =                  N/A
              le_mean =     -16.908461473141
             les_mean =     286.224861750695
             stat err =       0.000459316344
             autocorr =       1.283310823524
              std dev =       0.573404330642
             le_variance =       0.328792526399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908461360302        initial
     6.1035e+00     6.1035e+01             7.4750e-04       -16.908464215242  <--
     2.4414e+01     2.4414e+02             1.9181e-04       -16.908462554244
     9.7656e+01     9.7656e+02             4.8269e-05       -16.908461473141

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.0048e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.025511e-01 1 1  ON 0
 uu_1                 1.392698e-01 1 1  ON 1
 uu_2                 4.167816e-02 1 1  ON 2
 uu_3                -1.922831e-02 1 1  ON 3
 uu_4                -6.326373e-02 1 1  ON 4
 uu_5                -9.590017e-02 1 1  ON 5
 uu_6                -1.205654e-01 1 1  ON 6
 uu_7                -1.310299e-01 1 1  ON 7
 uu_8                -1.203662e-01 1 1  ON 8
 uu_9                -9.279372e-02 1 1  ON 9
 ud_0                 4.116752e-01 1 1  ON 10
 ud_1                 1.591492e-01 1 1  ON 11
 ud_2                 6.045234e-02 1 1  ON 12
 ud_3                 1.998815e-03 1 1  ON 13
 ud_4                -5.689167e-02 1 1  ON 14
 ud_5                -1.013890e-01 1 1  ON 15
 ud_6                -1.286904e-01 1 1  ON 16
 ud_7                -1.435833e-01 1 1  ON 17
 ud_8                -1.425320e-01 1 1  ON 18
 ud_9                -1.344842e-01 1 1  ON 19
 eO_0                -7.059112e-01 1 1  ON 20
 eO_1                -4.138545e-01 1 1  ON 21
 eO_2                -3.071984e-02 1 1  ON 22
 eO_3                 2.700099e-01 1 1  ON 23
 eO_4                 4.916930e-01 1 1  ON 24
 eO_5                 4.594433e-01 1 1  ON 25
 eO_6                 2.360336e-01 1 1  ON 26
 eO_7                -5.587920e-02 1 1  ON 27
 eO_8                -1.959963e-01 1 1  ON 28
 eO_9                -5.773712e-02 1 1  ON 29
eH1_0                -2.106941e-01 1 1  ON 30
eH1_1                -1.274052e-01 1 1  ON 31
eH1_2                -8.827436e-02 1 1  ON 32
eH1_3                -3.743439e-02 1 1  ON 33
eH1_4                 1.194182e-02 1 1  ON 34
eH1_5                 4.477375e-02 1 1  ON 35
eH1_6                 9.481010e-02 1 1  ON 36
eH1_7                 1.382116e-01 1 1  ON 37
eH1_8                 1.457646e-01 1 1  ON 38
eH1_9                 3.290004e-02 1 1  ON 39
eH2_0                -2.095736e-01 1 1  ON 40
eH2_1                -1.264712e-01 1 1  ON 41
eH2_2                -8.728633e-02 1 1  ON 42
eH2_3                -3.642947e-02 1 1  ON 43
eH2_4                 1.325939e-02 1 1  ON 44
eH2_5                 4.798701e-02 1 1  ON 45
eH2_6                 1.006299e-01 1 1  ON 46
eH2_7                 1.496070e-01 1 1  ON 47
eH2_8                 1.538239e-01 1 1  ON 48
eH2_9                 1.299393e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.302464
====================================================
  Execution time = 2.5904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3219e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332117521869
                                         uncertainty =       0.005255121117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332117521869
                                         uncertainty =       0.005255121117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407546323
  error estimate for blocks of size 2^( 2) =       0.000420978850
  error estimate for blocks of size 2^( 3) =       0.000434133728
  error estimate for blocks of size 2^( 4) =       0.000447477823
  error estimate for blocks of size 2^( 5) =       0.000459162536
  error estimate for blocks of size 2^( 6) =       0.000468415416
  error estimate for blocks of size 2^( 7) =       0.000472469244

      target function =                  N/A
              le_mean =     -16.908784132683
             les_mean =     286.239168689722
             stat err =       0.000461881255
             autocorr =       1.284418985737
              std dev =       0.576357536719
             le_variance =       0.332188010132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690878413268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908784132683       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908825716438       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908864096002       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908877660581       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908886990645       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908887359628       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908886954602       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908886976982       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908887139012       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908887195115       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908887291824       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.626729e-03

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908784132683       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908795544585       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908807015231       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908810970623       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908813298814       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908813445952       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908813161710       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908813291297       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908813245592       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908813261454       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908813274344       residual = 7.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 7.166792e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908784132683       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908787057106       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908790069863       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908791107394       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908791683727       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908791727301       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908791646931       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908791678059       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908791669160       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908791671291       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.837324e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2607e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.024801e-01 1 1  ON 0
 uu_1                 1.391300e-01 1 1  ON 1
 uu_2                 4.173985e-02 1 1  ON 2
 uu_3                -1.912716e-02 1 1  ON 3
 uu_4                -6.322839e-02 1 1  ON 4
 uu_5                -9.592206e-02 1 1  ON 5
 uu_6                -1.205756e-01 1 1  ON 6
 uu_7                -1.310260e-01 1 1  ON 7
 uu_8                -1.203664e-01 1 1  ON 8
 uu_9                -9.278853e-02 1 1  ON 9
 ud_0                 4.118079e-01 1 1  ON 10
 ud_1                 1.594891e-01 1 1  ON 11
 ud_2                 6.025049e-02 1 1  ON 12
 ud_3                 1.675524e-03 1 1  ON 13
 ud_4                -5.681801e-02 1 1  ON 14
 ud_5                -1.013231e-01 1 1  ON 15
 ud_6                -1.287040e-01 1 1  ON 16
 ud_7                -1.436270e-01 1 1  ON 17
 ud_8                -1.425577e-01 1 1  ON 18
 ud_9                -1.344829e-01 1 1  ON 19
 eO_0                -7.066278e-01 1 1  ON 20
 eO_1                -4.139400e-01 1 1  ON 21
 eO_2                -3.022490e-02 1 1  ON 22
 eO_3                 2.703833e-01 1 1  ON 23
 eO_4                 4.917289e-01 1 1  ON 24
 eO_5                 4.593742e-01 1 1  ON 25
 eO_6                 2.360275e-01 1 1  ON 26
 eO_7                -5.586091e-02 1 1  ON 27
 eO_8                -1.960176e-01 1 1  ON 28
 eO_9                -5.775774e-02 1 1  ON 29
eH1_0                -2.110269e-01 1 1  ON 30
eH1_1                -1.273897e-01 1 1  ON 31
eH1_2                -8.824006e-02 1 1  ON 32
eH1_3                -3.744689e-02 1 1  ON 33
eH1_4                 1.208298e-02 1 1  ON 34
eH1_5                 4.479600e-02 1 1  ON 35
eH1_6                 9.483851e-02 1 1  ON 36
eH1_7                 1.382331e-01 1 1  ON 37
eH1_8                 1.458110e-01 1 1  ON 38
eH1_9                 3.293595e-02 1 1  ON 39
eH2_0                -2.099239e-01 1 1  ON 40
eH2_1                -1.264641e-01 1 1  ON 41
eH2_2                -8.723554e-02 1 1  ON 42
eH2_3                -3.645755e-02 1 1  ON 43
eH2_4                 1.343224e-02 1 1  ON 44
eH2_5                 4.802071e-02 1 1  ON 45
eH2_6                 1.006518e-01 1 1  ON 46
eH2_7                 1.496157e-01 1 1  ON 47
eH2_8                 1.538682e-01 1 1  ON 48
eH2_9                 1.303222e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.189972
====================================================
  Execution time = 2.5374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2909e-01
  Total weights = 2.0000e+06
  Execution time = 2.9526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328340857008
                                         uncertainty =       0.004404368499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328340857008
                                         uncertainty =       0.004404368499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405800707
  error estimate for blocks of size 2^( 2) =       0.000418618688
  error estimate for blocks of size 2^( 3) =       0.000432011510
  error estimate for blocks of size 2^( 4) =       0.000444687762
  error estimate for blocks of size 2^( 5) =       0.000457775533
  error estimate for blocks of size 2^( 6) =       0.000465930881
  error estimate for blocks of size 2^( 7) =       0.000471369147

      target function =                  N/A
              le_mean =     -16.909140728715
             les_mean =     286.248388445989
             stat err =       0.000459940830
             autocorr =       1.284630804867
              std dev =       0.573888863088
             le_variance =       0.329348427177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608700331
                                         uncertainty =       0.004398409478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608700331
                                         uncertainty =       0.004398409478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405347159
  error estimate for blocks of size 2^( 2) =       0.000418063606
  error estimate for blocks of size 2^( 3) =       0.000431365309
  error estimate for blocks of size 2^( 4) =       0.000443981988
  error estimate for blocks of size 2^( 5) =       0.000457021981
  error estimate for blocks of size 2^( 6) =       0.000465148009
  error estimate for blocks of size 2^( 7) =       0.000470614280

      target function =                  N/A
              le_mean =     -16.909136663647
             les_mean =     286.247515183678
             stat err =       0.000459191564
             autocorr =       1.283315785404
              std dev =       0.573247449277
             le_variance =       0.328612638103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327835339585
                                         uncertainty =       0.004399434548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327835339585
                                         uncertainty =       0.004399434548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405487764
  error estimate for blocks of size 2^( 2) =       0.000418248932
  error estimate for blocks of size 2^( 3) =       0.000431591123
  error estimate for blocks of size 2^( 4) =       0.000444234337
  error estimate for blocks of size 2^( 5) =       0.000457296166
  error estimate for blocks of size 2^( 6) =       0.000465436757
  error estimate for blocks of size 2^( 7) =       0.000470893477

      target function =                  N/A
              le_mean =     -16.909135176159
             les_mean =     286.247692895100
             stat err =       0.000459465184
             autocorr =       1.283954723070
              std dev =       0.573446295569
             le_variance =       0.328840653902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328268844112
                                         uncertainty =       0.004403662681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328268844112
                                         uncertainty =       0.004403662681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405756154
  error estimate for blocks of size 2^( 2) =       0.000418566647
  error estimate for blocks of size 2^( 3) =       0.000431952838
  error estimate for blocks of size 2^( 4) =       0.000444624789
  error estimate for blocks of size 2^( 5) =       0.000457709264
  error estimate for blocks of size 2^( 6) =       0.000465862795
  error estimate for blocks of size 2^( 7) =       0.000471303578

      target function =                  N/A
              le_mean =     -16.909139474566
             les_mean =     286.248273719033
             stat err =       0.000459875106
             autocorr =       1.284545733788
              std dev =       0.573825856293
             le_variance =       0.329276113351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909140728715        initial  <--
     1.5259e+00     1.5259e+01             2.6267e-03       -16.909136663647
     6.1035e+00     6.1035e+01             7.1668e-04       -16.909135176159
     2.4414e+01     2.4414e+02             1.8373e-04       -16.909139474566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1966
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.025511e-01 1 1  ON 0
 uu_1                 1.392698e-01 1 1  ON 1
 uu_2                 4.167816e-02 1 1  ON 2
 uu_3                -1.922831e-02 1 1  ON 3
 uu_4                -6.326373e-02 1 1  ON 4
 uu_5                -9.590017e-02 1 1  ON 5
 uu_6                -1.205654e-01 1 1  ON 6
 uu_7                -1.310299e-01 1 1  ON 7
 uu_8                -1.203662e-01 1 1  ON 8
 uu_9                -9.279372e-02 1 1  ON 9
 ud_0                 4.116752e-01 1 1  ON 10
 ud_1                 1.591492e-01 1 1  ON 11
 ud_2                 6.045234e-02 1 1  ON 12
 ud_3                 1.998815e-03 1 1  ON 13
 ud_4                -5.689167e-02 1 1  ON 14
 ud_5                -1.013890e-01 1 1  ON 15
 ud_6                -1.286904e-01 1 1  ON 16
 ud_7                -1.435833e-01 1 1  ON 17
 ud_8                -1.425320e-01 1 1  ON 18
 ud_9                -1.344842e-01 1 1  ON 19
 eO_0                -7.059112e-01 1 1  ON 20
 eO_1                -4.138545e-01 1 1  ON 21
 eO_2                -3.071984e-02 1 1  ON 22
 eO_3                 2.700099e-01 1 1  ON 23
 eO_4                 4.916930e-01 1 1  ON 24
 eO_5                 4.594433e-01 1 1  ON 25
 eO_6                 2.360336e-01 1 1  ON 26
 eO_7                -5.587920e-02 1 1  ON 27
 eO_8                -1.959963e-01 1 1  ON 28
 eO_9                -5.773712e-02 1 1  ON 29
eH1_0                -2.106941e-01 1 1  ON 30
eH1_1                -1.274052e-01 1 1  ON 31
eH1_2                -8.827436e-02 1 1  ON 32
eH1_3                -3.743439e-02 1 1  ON 33
eH1_4                 1.194182e-02 1 1  ON 34
eH1_5                 4.477375e-02 1 1  ON 35
eH1_6                 9.481010e-02 1 1  ON 36
eH1_7                 1.382116e-01 1 1  ON 37
eH1_8                 1.457646e-01 1 1  ON 38
eH1_9                 3.290004e-02 1 1  ON 39
eH2_0                -2.095736e-01 1 1  ON 40
eH2_1                -1.264712e-01 1 1  ON 41
eH2_2                -8.728633e-02 1 1  ON 42
eH2_3                -3.642947e-02 1 1  ON 43
eH2_4                 1.325939e-02 1 1  ON 44
eH2_5                 4.798701e-02 1 1  ON 45
eH2_6                 1.006299e-01 1 1  ON 46
eH2_7                 1.496070e-01 1 1  ON 47
eH2_8                 1.538239e-01 1 1  ON 48
eH2_9                 1.299393e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9335
    reference variance = 0.158143
====================================================
  Execution time = 2.5515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328969119956
                                         uncertainty =       0.003525634179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328969119956
                                         uncertainty =       0.003525634179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405531311
  error estimate for blocks of size 2^( 2) =       0.000418446052
  error estimate for blocks of size 2^( 3) =       0.000432174908
  error estimate for blocks of size 2^( 4) =       0.000444650794
  error estimate for blocks of size 2^( 5) =       0.000457250856
  error estimate for blocks of size 2^( 6) =       0.000466040065
  error estimate for blocks of size 2^( 7) =       0.000472492663

      target function =                  N/A
              le_mean =     -16.908689504809
             les_mean =     286.232691894581
             stat err =       0.000460108595
             autocorr =       1.287276696339
              std dev =       0.573507880504
             le_variance =       0.328911289000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690868950481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908689504809       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908693795639       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908699149438       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908701076335       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908701911693       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908702377396       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908702405114       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908702426027       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908702440065       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908702444305       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908702442934       residual = 7.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.915201e-04

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908689504809       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908690588445       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908691954067       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908692440164       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908692650383       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908692767151       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908692773518       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908692778703       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908692782286       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908692783295       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.366295e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908689504809       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908689776410       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908690119553       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908690241357       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908690294014       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908690323217       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908690324776       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908690326068       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908690326969       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908690327218       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.846196e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2775e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.025441e-01 1 1  ON 0
 uu_1                 1.392553e-01 1 1  ON 1
 uu_2                 4.168510e-02 1 1  ON 2
 uu_3                -1.921774e-02 1 1  ON 3
 uu_4                -6.326153e-02 1 1  ON 4
 uu_5                -9.590204e-02 1 1  ON 5
 uu_6                -1.205666e-01 1 1  ON 6
 uu_7                -1.310304e-01 1 1  ON 7
 uu_8                -1.203682e-01 1 1  ON 8
 uu_9                -9.279253e-02 1 1  ON 9
 ud_0                 4.116864e-01 1 1  ON 10
 ud_1                 1.591836e-01 1 1  ON 11
 ud_2                 6.043008e-02 1 1  ON 12
 ud_3                 1.964500e-03 1 1  ON 13
 ud_4                -5.688213e-02 1 1  ON 14
 ud_5                -1.013849e-01 1 1  ON 15
 ud_6                -1.286908e-01 1 1  ON 16
 ud_7                -1.435869e-01 1 1  ON 17
 ud_8                -1.425345e-01 1 1  ON 18
 ud_9                -1.344833e-01 1 1  ON 19
 eO_0                -7.059848e-01 1 1  ON 20
 eO_1                -4.138632e-01 1 1  ON 21
 eO_2                -3.066783e-02 1 1  ON 22
 eO_3                 2.700475e-01 1 1  ON 23
 eO_4                 4.916957e-01 1 1  ON 24
 eO_5                 4.594355e-01 1 1  ON 25
 eO_6                 2.360333e-01 1 1  ON 26
 eO_7                -5.587693e-02 1 1  ON 27
 eO_8                -1.959987e-01 1 1  ON 28
 eO_9                -5.773868e-02 1 1  ON 29
eH1_0                -2.107288e-01 1 1  ON 30
eH1_1                -1.274016e-01 1 1  ON 31
eH1_2                -8.826927e-02 1 1  ON 32
eH1_3                -3.743828e-02 1 1  ON 33
eH1_4                 1.195753e-02 1 1  ON 34
eH1_5                 4.477580e-02 1 1  ON 35
eH1_6                 9.481058e-02 1 1  ON 36
eH1_7                 1.382141e-01 1 1  ON 37
eH1_8                 1.457696e-01 1 1  ON 38
eH1_9                 3.290362e-02 1 1  ON 39
eH2_0                -2.096110e-01 1 1  ON 40
eH2_1                -1.264674e-01 1 1  ON 41
eH2_2                -8.728196e-02 1 1  ON 42
eH2_3                -3.642991e-02 1 1  ON 43
eH2_4                 1.327593e-02 1 1  ON 44
eH2_5                 4.798886e-02 1 1  ON 45
eH2_6                 1.006321e-01 1 1  ON 46
eH2_7                 1.496072e-01 1 1  ON 47
eH2_8                 1.538278e-01 1 1  ON 48
eH2_9                 1.299822e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8437
    reference variance = 0.187246
====================================================
  Execution time = 2.5076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2904e-01
  Total weights = 2.0000e+06
  Execution time = 2.9457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329161824937
                                         uncertainty =       0.004120034667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329161824937
                                         uncertainty =       0.004120034667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405626690
  error estimate for blocks of size 2^( 2) =       0.000418456649
  error estimate for blocks of size 2^( 3) =       0.000431959615
  error estimate for blocks of size 2^( 4) =       0.000444763224
  error estimate for blocks of size 2^( 5) =       0.000455143458
  error estimate for blocks of size 2^( 6) =       0.000465768956
  error estimate for blocks of size 2^( 7) =       0.000471080393

      target function =                  N/A
              le_mean =     -16.908604381356
             les_mean =     286.229967983954
             stat err =       0.000459189008
             autocorr =       1.281533370845
              std dev =       0.573642766251
             le_variance =       0.329066023272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329052564113
                                         uncertainty =       0.004120105182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329052564113
                                         uncertainty =       0.004120105182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405559366
  error estimate for blocks of size 2^( 2) =       0.000418376926
  error estimate for blocks of size 2^( 3) =       0.000431870057
  error estimate for blocks of size 2^( 4) =       0.000444666832
  error estimate for blocks of size 2^( 5) =       0.000455044480
  error estimate for blocks of size 2^( 6) =       0.000465667376
  error estimate for blocks of size 2^( 7) =       0.000470980173

      target function =                  N/A
              le_mean =     -16.908605200583
             les_mean =     286.229886463234
             stat err =       0.000459089715
             autocorr =       1.281404535183
              std dev =       0.573547555605
             le_variance =       0.328956798540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329105048593
                                         uncertainty =       0.004120063742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329105048593
                                         uncertainty =       0.004120063742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405591707
  error estimate for blocks of size 2^( 2) =       0.000418415389
  error estimate for blocks of size 2^( 3) =       0.000431913392
  error estimate for blocks of size 2^( 4) =       0.000444713570
  error estimate for blocks of size 2^( 5) =       0.000455092510
  error estimate for blocks of size 2^( 6) =       0.000465716729
  error estimate for blocks of size 2^( 7) =       0.000471028834

      target function =                  N/A
              le_mean =     -16.908604744655
             les_mean =     286.229923511866
             stat err =       0.000459137911
             autocorr =       1.281469205833
              std dev =       0.573593292664
             le_variance =       0.329009265389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154630872
                                         uncertainty =       0.004120038035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154630872
                                         uncertainty =       0.004120038035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405622257
  error estimate for blocks of size 2^( 2) =       0.000418451428
  error estimate for blocks of size 2^( 3) =       0.000431953771
  error estimate for blocks of size 2^( 4) =       0.000444756950
  error estimate for blocks of size 2^( 5) =       0.000455137022
  error estimate for blocks of size 2^( 6) =       0.000465762361
  error estimate for blocks of size 2^( 7) =       0.000471073882

      target function =                  N/A
              le_mean =     -16.908604421115
             les_mean =     286.229962136733
             stat err =       0.000459182554
             autocorr =       1.281525352429
              std dev =       0.573636497727
             le_variance =       0.329058831524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908604381356        initial
     1.5259e+01     1.5259e+02             2.9152e-04       -16.908605200583  <--
     6.1035e+01     6.1035e+02             7.3663e-05       -16.908604744655
     2.4414e+02     2.4414e+03             1.8462e-05       -16.908604421115

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.9943e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.025240e-01 1 1  ON 0
 uu_1                 1.392133e-01 1 1  ON 1
 uu_2                 4.170480e-02 1 1  ON 2
 uu_3                -1.918654e-02 1 1  ON 3
 uu_4                -6.325476e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278904e-02 1 1  ON 9
 ud_0                 4.117217e-01 1 1  ON 10
 ud_1                 1.592840e-01 1 1  ON 11
 ud_2                 6.036518e-02 1 1  ON 12
 ud_3                 1.862970e-03 1 1  ON 13
 ud_4                -5.685547e-02 1 1  ON 14
 ud_5                -1.013732e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435973e-01 1 1  ON 17
 ud_8                -1.425424e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062027e-01 1 1  ON 20
 eO_1                -4.138910e-01 1 1  ON 21
 eO_2                -3.051417e-02 1 1  ON 22
 eO_3                 2.701594e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594127e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587006e-02 1 1  ON 27
 eO_8                -1.960061e-01 1 1  ON 28
 eO_9                -5.774349e-02 1 1  ON 29
eH1_0                -2.108322e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825394e-02 1 1  ON 32
eH1_3                -3.745001e-02 1 1  ON 33
eH1_4                 1.200405e-02 1 1  ON 34
eH1_5                 4.478195e-02 1 1  ON 35
eH1_6                 9.481218e-02 1 1  ON 36
eH1_7                 1.382216e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291458e-02 1 1  ON 39
eH2_0                -2.097228e-01 1 1  ON 40
eH2_1                -1.264573e-01 1 1  ON 41
eH2_2                -8.726880e-02 1 1  ON 42
eH2_3                -3.643107e-02 1 1  ON 43
eH2_4                 1.332513e-02 1 1  ON 44
eH2_5                 4.799432e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9497
    reference variance = 0.509378
====================================================
  Execution time = 2.5477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318997465612
                                         uncertainty =       0.003084485304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318997465612
                                         uncertainty =       0.003084485304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399359419
  error estimate for blocks of size 2^( 2) =       0.000412049544
  error estimate for blocks of size 2^( 3) =       0.000425368023
  error estimate for blocks of size 2^( 4) =       0.000438493207
  error estimate for blocks of size 2^( 5) =       0.000449448308
  error estimate for blocks of size 2^( 6) =       0.000456094199
  error estimate for blocks of size 2^( 7) =       0.000461263655

      target function =                  N/A
              le_mean =     -16.909134242494
             les_mean =     286.237796561774
             stat err =       0.000451324842
             autocorr =       1.277175606844
              std dev =       0.564779506166
             le_variance =       0.318975890585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690913424249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909134242494       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909146351801       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909160635052       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909165800959       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909170735426       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909171746812       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909172400235       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909172130058       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909172404408       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909172350228       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909172347741       residual = 8.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.071407e-03

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909134242494       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909137392150       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909141227918       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909142567308       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909143747851       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909144012585       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909144211174       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909144115101       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909144184467       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909144177838       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.782928e-04

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909134242494       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909135037944       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909136014968       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909136353315       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909136644274       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909136711144       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909136762912       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909136737720       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909136754600       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909136753251       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.026214e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2130e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.024994e-01 1 1  ON 0
 uu_1                 1.391619e-01 1 1  ON 1
 uu_2                 4.173005e-02 1 1  ON 2
 uu_3                -1.914153e-02 1 1  ON 3
 uu_4                -6.324424e-02 1 1  ON 4
 uu_5                -9.590933e-02 1 1  ON 5
 uu_6                -1.205720e-01 1 1  ON 6
 uu_7                -1.310350e-01 1 1  ON 7
 uu_8                -1.203818e-01 1 1  ON 8
 uu_9                -9.278963e-02 1 1  ON 9
 ud_0                 4.117779e-01 1 1  ON 10
 ud_1                 1.594244e-01 1 1  ON 11
 ud_2                 6.028312e-02 1 1  ON 12
 ud_3                 1.731478e-03 1 1  ON 13
 ud_4                -5.682156e-02 1 1  ON 14
 ud_5                -1.013498e-01 1 1  ON 15
 ud_6                -1.286965e-01 1 1  ON 16
 ud_7                -1.436136e-01 1 1  ON 17
 ud_8                -1.425596e-01 1 1  ON 18
 ud_9                -1.344812e-01 1 1  ON 19
 eO_0                -7.064810e-01 1 1  ON 20
 eO_1                -4.139279e-01 1 1  ON 21
 eO_2                -3.031307e-02 1 1  ON 22
 eO_3                 2.703061e-01 1 1  ON 23
 eO_4                 4.917210e-01 1 1  ON 24
 eO_5                 4.593837e-01 1 1  ON 25
 eO_6                 2.360295e-01 1 1  ON 26
 eO_7                -5.586695e-02 1 1  ON 27
 eO_8                -1.960174e-01 1 1  ON 28
 eO_9                -5.775069e-02 1 1  ON 29
eH1_0                -2.109685e-01 1 1  ON 30
eH1_1                -1.273858e-01 1 1  ON 31
eH1_2                -8.823465e-02 1 1  ON 32
eH1_3                -3.745980e-02 1 1  ON 33
eH1_4                 1.207533e-02 1 1  ON 34
eH1_5                 4.479111e-02 1 1  ON 35
eH1_6                 9.482120e-02 1 1  ON 36
eH1_7                 1.382286e-01 1 1  ON 37
eH1_8                 1.457985e-01 1 1  ON 38
eH1_9                 3.292491e-02 1 1  ON 39
eH2_0                -2.098563e-01 1 1  ON 40
eH2_1                -1.264515e-01 1 1  ON 41
eH2_2                -8.724494e-02 1 1  ON 42
eH2_3                -3.643383e-02 1 1  ON 43
eH2_4                 1.339087e-02 1 1  ON 44
eH2_5                 4.800641e-02 1 1  ON 45
eH2_6                 1.006446e-01 1 1  ON 46
eH2_7                 1.496055e-01 1 1  ON 47
eH2_8                 1.538519e-01 1 1  ON 48
eH2_9                 1.302522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.246392
====================================================
  Execution time = 2.4960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3210e-01
  Total weights = 2.0000e+06
  Execution time = 2.9386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332223069599
                                         uncertainty =       0.004484268555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332223069599
                                         uncertainty =       0.004484268555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407557587
  error estimate for blocks of size 2^( 2) =       0.000420370806
  error estimate for blocks of size 2^( 3) =       0.000433666096
  error estimate for blocks of size 2^( 4) =       0.000446285746
  error estimate for blocks of size 2^( 5) =       0.000456631556
  error estimate for blocks of size 2^( 6) =       0.000465286061
  error estimate for blocks of size 2^( 7) =       0.000468516398

      target function =                  N/A
              le_mean =     -16.909389995269
             les_mean =     286.259676219495
             stat err =       0.000459179940
             autocorr =       1.269368887444
              std dev =       0.576373467022
             le_variance =       0.332206373487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331872522066
                                         uncertainty =       0.004485445356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331872522066
                                         uncertainty =       0.004485445356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407342403
  error estimate for blocks of size 2^( 2) =       0.000420114302
  error estimate for blocks of size 2^( 3) =       0.000433373219
  error estimate for blocks of size 2^( 4) =       0.000445969767
  error estimate for blocks of size 2^( 5) =       0.000456317634
  error estimate for blocks of size 2^( 6) =       0.000464967576
  error estimate for blocks of size 2^( 7) =       0.000468213304

      target function =                  N/A
              le_mean =     -16.909383154741
             les_mean =     286.259094175196
             stat err =       0.000458867070
             autocorr =       1.268979311123
              std dev =       0.576069151485
             le_variance =       0.331855667293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332020234878
                                         uncertainty =       0.004484782277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332020234878
                                         uncertainty =       0.004484782277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407433094
  error estimate for blocks of size 2^( 2) =       0.000420224676
  error estimate for blocks of size 2^( 3) =       0.000433501005
  error estimate for blocks of size 2^( 4) =       0.000446108827
  error estimate for blocks of size 2^( 5) =       0.000456456093
  error estimate for blocks of size 2^( 6) =       0.000465108114
  error estimate for blocks of size 2^( 7) =       0.000468346679

      target function =                  N/A
              le_mean =     -16.909385700471
             les_mean =     286.259328052920
             stat err =       0.000459004928
             autocorr =       1.269176709248
              std dev =       0.576197406835
             le_variance =       0.332003451644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332196300551
                                         uncertainty =       0.004484329467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332196300551
                                         uncertainty =       0.004484329467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407541159
  error estimate for blocks of size 2^( 2) =       0.000420351618
  error estimate for blocks of size 2^( 3) =       0.000433644495
  error estimate for blocks of size 2^( 4) =       0.000446262650
  error estimate for blocks of size 2^( 5) =       0.000456608655
  error estimate for blocks of size 2^( 6) =       0.000465262842
  error estimate for blocks of size 2^( 7) =       0.000468494222

      target function =                  N/A
              le_mean =     -16.909389364557
             les_mean =     286.259628109372
             stat err =       0.000459157092
             autocorr =       1.269344894581
              std dev =       0.576350234912
             le_variance =       0.332179593283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909389995269        initial  <--
     3.8147e+00     3.8147e+01             1.0714e-03       -16.909383154741
     1.5259e+01     1.5259e+02             2.7829e-04       -16.909385700471
     6.1035e+01     6.1035e+02             7.0262e-05       -16.909389364557

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7504
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.025240e-01 1 1  ON 0
 uu_1                 1.392133e-01 1 1  ON 1
 uu_2                 4.170480e-02 1 1  ON 2
 uu_3                -1.918654e-02 1 1  ON 3
 uu_4                -6.325476e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278904e-02 1 1  ON 9
 ud_0                 4.117217e-01 1 1  ON 10
 ud_1                 1.592840e-01 1 1  ON 11
 ud_2                 6.036518e-02 1 1  ON 12
 ud_3                 1.862970e-03 1 1  ON 13
 ud_4                -5.685547e-02 1 1  ON 14
 ud_5                -1.013732e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435973e-01 1 1  ON 17
 ud_8                -1.425424e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062027e-01 1 1  ON 20
 eO_1                -4.138910e-01 1 1  ON 21
 eO_2                -3.051417e-02 1 1  ON 22
 eO_3                 2.701594e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594127e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587006e-02 1 1  ON 27
 eO_8                -1.960061e-01 1 1  ON 28
 eO_9                -5.774349e-02 1 1  ON 29
eH1_0                -2.108322e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825394e-02 1 1  ON 32
eH1_3                -3.745001e-02 1 1  ON 33
eH1_4                 1.200405e-02 1 1  ON 34
eH1_5                 4.478195e-02 1 1  ON 35
eH1_6                 9.481218e-02 1 1  ON 36
eH1_7                 1.382216e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291458e-02 1 1  ON 39
eH2_0                -2.097228e-01 1 1  ON 40
eH2_1                -1.264573e-01 1 1  ON 41
eH2_2                -8.726880e-02 1 1  ON 42
eH2_3                -3.643107e-02 1 1  ON 43
eH2_4                 1.332513e-02 1 1  ON 44
eH2_5                 4.799432e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.307725
====================================================
  Execution time = 2.5687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329005634131
                                         uncertainty =       0.003797134923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329005634131
                                         uncertainty =       0.003797134923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405572474
  error estimate for blocks of size 2^( 2) =       0.000418040906
  error estimate for blocks of size 2^( 3) =       0.000430659852
  error estimate for blocks of size 2^( 4) =       0.000442497118
  error estimate for blocks of size 2^( 5) =       0.000452949554
  error estimate for blocks of size 2^( 6) =       0.000460906785
  error estimate for blocks of size 2^( 7) =       0.000466893436

      target function =                  N/A
              le_mean =     -16.909307442011
             les_mean =     286.253656066666
             stat err =       0.000455811723
             autocorr =       1.263089248380
              std dev =       0.573566092721
             le_variance =       0.328978062719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690930744201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909307442011       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909309290923       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909311417958       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909312343241       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909312615013       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909312668364       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909312685085       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909312675727       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909312678949       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909312677427       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.152190e-04

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909307442011       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909307906148       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909308442143       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909308674559       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909308743065       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909308756018       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909308760358       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909308758006       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909308758795       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909308758408       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.892244e-05

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909307442011       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909307558165       residual = 8.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909307692431       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909307750603       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909307767768       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909307770980       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909307772074       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909307771486       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909307771683       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909307771588       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 7.238019e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2253e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.025218e-01 1 1  ON 0
 uu_1                 1.392078e-01 1 1  ON 1
 uu_2                 4.170671e-02 1 1  ON 2
 uu_3                -1.918226e-02 1 1  ON 3
 uu_4                -6.325396e-02 1 1  ON 4
 uu_5                -9.590906e-02 1 1  ON 5
 uu_6                -1.205704e-01 1 1  ON 6
 uu_7                -1.310317e-01 1 1  ON 7
 uu_8                -1.203746e-01 1 1  ON 8
 uu_9                -9.278904e-02 1 1  ON 9
 ud_0                 4.117272e-01 1 1  ON 10
 ud_1                 1.592985e-01 1 1  ON 11
 ud_2                 6.035720e-02 1 1  ON 12
 ud_3                 1.850027e-03 1 1  ON 13
 ud_4                -5.685152e-02 1 1  ON 14
 ud_5                -1.013708e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435995e-01 1 1  ON 17
 ud_8                -1.425452e-01 1 1  ON 18
 ud_9                -1.344814e-01 1 1  ON 19
 eO_0                -7.062316e-01 1 1  ON 20
 eO_1                -4.138940e-01 1 1  ON 21
 eO_2                -3.049319e-02 1 1  ON 22
 eO_3                 2.701742e-01 1 1  ON 23
 eO_4                 4.917062e-01 1 1  ON 24
 eO_5                 4.594096e-01 1 1  ON 25
 eO_6                 2.360323e-01 1 1  ON 26
 eO_7                -5.586951e-02 1 1  ON 27
 eO_8                -1.960073e-01 1 1  ON 28
 eO_9                -5.774440e-02 1 1  ON 29
eH1_0                -2.108463e-01 1 1  ON 30
eH1_1                -1.273911e-01 1 1  ON 31
eH1_2                -8.825203e-02 1 1  ON 32
eH1_3                -3.745014e-02 1 1  ON 33
eH1_4                 1.200987e-02 1 1  ON 34
eH1_5                 4.478315e-02 1 1  ON 35
eH1_6                 9.481329e-02 1 1  ON 36
eH1_7                 1.382227e-01 1 1  ON 37
eH1_8                 1.457862e-01 1 1  ON 38
eH1_9                 3.291572e-02 1 1  ON 39
eH2_0                -2.097365e-01 1 1  ON 40
eH2_1                -1.264551e-01 1 1  ON 41
eH2_2                -8.726648e-02 1 1  ON 42
eH2_3                -3.643163e-02 1 1  ON 43
eH2_4                 1.333241e-02 1 1  ON 44
eH2_5                 4.799508e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496071e-01 1 1  ON 47
eH2_8                 1.538408e-01 1 1  ON 48
eH2_9                 1.301271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.278786
====================================================
  Execution time = 2.5155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.0000e+06
  Execution time = 2.9511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337903942161
                                         uncertainty =       0.005338940096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337903942161
                                         uncertainty =       0.005338940096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411038880
  error estimate for blocks of size 2^( 2) =       0.000423549108
  error estimate for blocks of size 2^( 3) =       0.000436119458
  error estimate for blocks of size 2^( 4) =       0.000448805953
  error estimate for blocks of size 2^( 5) =       0.000459878416
  error estimate for blocks of size 2^( 6) =       0.000467291669
  error estimate for blocks of size 2^( 7) =       0.000471051619

      target function =                  N/A
              le_mean =     -16.908570940210
             les_mean =     286.237676992553
             stat err =       0.000461756914
             autocorr =       1.262004802759
              std dev =       0.581296758468
             le_variance =       0.337905921405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337864323073
                                         uncertainty =       0.005339745724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337864323073
                                         uncertainty =       0.005339745724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014772
  error estimate for blocks of size 2^( 2) =       0.000423520866
  error estimate for blocks of size 2^( 3) =       0.000436087369
  error estimate for blocks of size 2^( 4) =       0.000448771671
  error estimate for blocks of size 2^( 5) =       0.000459842194
  error estimate for blocks of size 2^( 6) =       0.000467255056
  error estimate for blocks of size 2^( 7) =       0.000471012913

      target function =                  N/A
              le_mean =     -16.908570688348
             les_mean =     286.237628839740
             stat err =       0.000461720458
             autocorr =       1.261953563693
              std dev =       0.581262665069
             le_variance =       0.337866285803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883797317
                                         uncertainty =       0.005339341480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883797317
                                         uncertainty =       0.005339341480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411026622
  error estimate for blocks of size 2^( 2) =       0.000423534775
  error estimate for blocks of size 2^( 3) =       0.000436103193
  error estimate for blocks of size 2^( 4) =       0.000448788589
  error estimate for blocks of size 2^( 5) =       0.000459860078
  error estimate for blocks of size 2^( 6) =       0.000467273137
  error estimate for blocks of size 2^( 7) =       0.000471032033

      target function =                  N/A
              le_mean =     -16.908570805943
             les_mean =     286.237652298865
             stat err =       0.000461738459
             autocorr =       1.261979193665
              std dev =       0.581279423543
             le_variance =       0.337885768235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901409278
                                         uncertainty =       0.005338990215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901409278
                                         uncertainty =       0.005338990215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411037339
  error estimate for blocks of size 2^( 2) =       0.000423547307
  error estimate for blocks of size 2^( 3) =       0.000436117415
  error estimate for blocks of size 2^( 4) =       0.000448803772
  error estimate for blocks of size 2^( 5) =       0.000459876114
  error estimate for blocks of size 2^( 6) =       0.000467289342
  error estimate for blocks of size 2^( 7) =       0.000471049161

      target function =                  N/A
              le_mean =     -16.908570922530
             les_mean =     286.237673860746
             stat err =       0.000461754597
             autocorr =       1.262001600979
              std dev =       0.581294578918
             le_variance =       0.337903387480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908570940210        initial  <--
     3.8147e+01     3.8147e+02             1.1522e-04       -16.908570688348
     1.5259e+02     1.5259e+03             2.8922e-05       -16.908570805943
     6.1035e+02     6.1035e+03             7.2380e-06       -16.908570922530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9958
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.025240e-01 1 1  ON 0
 uu_1                 1.392133e-01 1 1  ON 1
 uu_2                 4.170480e-02 1 1  ON 2
 uu_3                -1.918654e-02 1 1  ON 3
 uu_4                -6.325476e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278904e-02 1 1  ON 9
 ud_0                 4.117217e-01 1 1  ON 10
 ud_1                 1.592840e-01 1 1  ON 11
 ud_2                 6.036518e-02 1 1  ON 12
 ud_3                 1.862970e-03 1 1  ON 13
 ud_4                -5.685547e-02 1 1  ON 14
 ud_5                -1.013732e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435973e-01 1 1  ON 17
 ud_8                -1.425424e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062027e-01 1 1  ON 20
 eO_1                -4.138910e-01 1 1  ON 21
 eO_2                -3.051417e-02 1 1  ON 22
 eO_3                 2.701594e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594127e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587006e-02 1 1  ON 27
 eO_8                -1.960061e-01 1 1  ON 28
 eO_9                -5.774349e-02 1 1  ON 29
eH1_0                -2.108322e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825394e-02 1 1  ON 32
eH1_3                -3.745001e-02 1 1  ON 33
eH1_4                 1.200405e-02 1 1  ON 34
eH1_5                 4.478195e-02 1 1  ON 35
eH1_6                 9.481218e-02 1 1  ON 36
eH1_7                 1.382216e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291458e-02 1 1  ON 39
eH2_0                -2.097228e-01 1 1  ON 40
eH2_1                -1.264573e-01 1 1  ON 41
eH2_2                -8.726880e-02 1 1  ON 42
eH2_3                -3.643107e-02 1 1  ON 43
eH2_4                 1.332513e-02 1 1  ON 44
eH2_5                 4.799432e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9524
    reference variance = 0.474351
====================================================
  Execution time = 2.5710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3509e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335109643811
                                         uncertainty =       0.005375993041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335109643811
                                         uncertainty =       0.005375993041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409322511
  error estimate for blocks of size 2^( 2) =       0.000421761295
  error estimate for blocks of size 2^( 3) =       0.000434635526
  error estimate for blocks of size 2^( 4) =       0.000446519830
  error estimate for blocks of size 2^( 5) =       0.000456182422
  error estimate for blocks of size 2^( 6) =       0.000463688280
  error estimate for blocks of size 2^( 7) =       0.000467748634

      target function =                  N/A
              le_mean =     -16.908457276160
             les_mean =     286.231017127917
             stat err =       0.000458534791
             autocorr =       1.254912159831
              std dev =       0.578869446203
             le_variance =       0.335089835747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690845727616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908457276160       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908457496042       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908457685217       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908457758749       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908457790054       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908457806079       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908457810343       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908457811522       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908457810485       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908457810436       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.143354e-05

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908457276160       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908457331153       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908457378488       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908457396878       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908457404700       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908457408710       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908457409773       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908457410070       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908457409812       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908457409790       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.859556e-06

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908457276160       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908457289909       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908457301746       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908457306344       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908457308299       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908457309301       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908457309563       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908457309636       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908457309579       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908457309571       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 7.149622e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2337e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.025238e-01 1 1  ON 0
 uu_1                 1.392128e-01 1 1  ON 1
 uu_2                 4.170505e-02 1 1  ON 2
 uu_3                -1.918612e-02 1 1  ON 3
 uu_4                -6.325464e-02 1 1  ON 4
 uu_5                -9.590817e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310319e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278914e-02 1 1  ON 9
 ud_0                 4.117223e-01 1 1  ON 10
 ud_1                 1.592855e-01 1 1  ON 11
 ud_2                 6.036440e-02 1 1  ON 12
 ud_3                 1.861647e-03 1 1  ON 13
 ud_4                -5.685505e-02 1 1  ON 14
 ud_5                -1.013729e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435975e-01 1 1  ON 17
 ud_8                -1.425426e-01 1 1  ON 18
 ud_9                -1.344808e-01 1 1  ON 19
 eO_0                -7.062055e-01 1 1  ON 20
 eO_1                -4.138913e-01 1 1  ON 21
 eO_2                -3.051203e-02 1 1  ON 22
 eO_3                 2.701608e-01 1 1  ON 23
 eO_4                 4.917050e-01 1 1  ON 24
 eO_5                 4.594124e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586998e-02 1 1  ON 27
 eO_8                -1.960063e-01 1 1  ON 28
 eO_9                -5.774361e-02 1 1  ON 29
eH1_0                -2.108337e-01 1 1  ON 30
eH1_1                -1.273914e-01 1 1  ON 31
eH1_2                -8.825373e-02 1 1  ON 32
eH1_3                -3.745011e-02 1 1  ON 33
eH1_4                 1.200475e-02 1 1  ON 34
eH1_5                 4.478207e-02 1 1  ON 35
eH1_6                 9.481222e-02 1 1  ON 36
eH1_7                 1.382217e-01 1 1  ON 37
eH1_8                 1.457847e-01 1 1  ON 38
eH1_9                 3.291467e-02 1 1  ON 39
eH2_0                -2.097242e-01 1 1  ON 40
eH2_1                -1.264571e-01 1 1  ON 41
eH2_2                -8.726854e-02 1 1  ON 42
eH2_3                -3.643109e-02 1 1  ON 43
eH2_4                 1.332583e-02 1 1  ON 44
eH2_5                 4.799442e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538399e-01 1 1  ON 48
eH2_9                 1.301147e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8805
    reference variance = 0.405385
====================================================
  Execution time = 2.5270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3912e-01
  Total weights = 2.0000e+06
  Execution time = 2.9504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220827082
                                         uncertainty =       0.006751688116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220827082
                                         uncertainty =       0.006751688116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778833
  error estimate for blocks of size 2^( 2) =       0.000424445013
  error estimate for blocks of size 2^( 3) =       0.000438004609
  error estimate for blocks of size 2^( 4) =       0.000450731381
  error estimate for blocks of size 2^( 5) =       0.000462977644
  error estimate for blocks of size 2^( 6) =       0.000473447875
  error estimate for blocks of size 2^( 7) =       0.000479241996

      target function =                  N/A
              le_mean =     -16.909014704240
             les_mean =     286.253901712995
             stat err =       0.000466599724
             autocorr =       1.283987861863
              std dev =       0.582343210102
             le_variance =       0.339123614352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339216424829
                                         uncertainty =       0.006751556469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339216424829
                                         uncertainty =       0.006751556469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411776160
  error estimate for blocks of size 2^( 2) =       0.000424441861
  error estimate for blocks of size 2^( 3) =       0.000438001062
  error estimate for blocks of size 2^( 4) =       0.000450727658
  error estimate for blocks of size 2^( 5) =       0.000462973900
  error estimate for blocks of size 2^( 6) =       0.000473444144
  error estimate for blocks of size 2^( 7) =       0.000479238461

      target function =                  N/A
              le_mean =     -16.909014682403
             les_mean =     286.253896572316
             stat err =       0.000466596041
             autocorr =       1.283984258130
              std dev =       0.582339430376
             le_variance =       0.339119212171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339218622506
                                         uncertainty =       0.006751622218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339218622506
                                         uncertainty =       0.006751622218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411777494
  error estimate for blocks of size 2^( 2) =       0.000424443435
  error estimate for blocks of size 2^( 3) =       0.000438002833
  error estimate for blocks of size 2^( 4) =       0.000450729517
  error estimate for blocks of size 2^( 5) =       0.000462975770
  error estimate for blocks of size 2^( 6) =       0.000473446007
  error estimate for blocks of size 2^( 7) =       0.000479240226

      target function =                  N/A
              le_mean =     -16.909014693233
             les_mean =     286.253899136232
             stat err =       0.000466597880
             autocorr =       1.283986060584
              std dev =       0.582341317281
             le_variance =       0.339121409813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220551362
                                         uncertainty =       0.006751679876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220551362
                                         uncertainty =       0.006751679876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778665
  error estimate for blocks of size 2^( 2) =       0.000424444816
  error estimate for blocks of size 2^( 3) =       0.000438004387
  error estimate for blocks of size 2^( 4) =       0.000450731148
  error estimate for blocks of size 2^( 5) =       0.000462977409
  error estimate for blocks of size 2^( 6) =       0.000473447641
  error estimate for blocks of size 2^( 7) =       0.000479241774

      target function =                  N/A
              le_mean =     -16.909014702855
             les_mean =     286.253901390446
             stat err =       0.000466599493
             autocorr =       1.283987636714
              std dev =       0.582342973373
             le_variance =       0.339123338636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909014704240        initial  <--
     3.8147e+02     3.8147e+03             1.1434e-05       -16.909014682403
     1.5259e+03     1.5259e+04             2.8596e-06       -16.909014693233
     6.1035e+03     6.1035e+04             7.1496e-07       -16.909014702855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1079
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.025240e-01 1 1  ON 0
 uu_1                 1.392133e-01 1 1  ON 1
 uu_2                 4.170480e-02 1 1  ON 2
 uu_3                -1.918654e-02 1 1  ON 3
 uu_4                -6.325476e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278904e-02 1 1  ON 9
 ud_0                 4.117217e-01 1 1  ON 10
 ud_1                 1.592840e-01 1 1  ON 11
 ud_2                 6.036518e-02 1 1  ON 12
 ud_3                 1.862970e-03 1 1  ON 13
 ud_4                -5.685547e-02 1 1  ON 14
 ud_5                -1.013732e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435973e-01 1 1  ON 17
 ud_8                -1.425424e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062027e-01 1 1  ON 20
 eO_1                -4.138910e-01 1 1  ON 21
 eO_2                -3.051417e-02 1 1  ON 22
 eO_3                 2.701594e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594127e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587006e-02 1 1  ON 27
 eO_8                -1.960061e-01 1 1  ON 28
 eO_9                -5.774349e-02 1 1  ON 29
eH1_0                -2.108322e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825394e-02 1 1  ON 32
eH1_3                -3.745001e-02 1 1  ON 33
eH1_4                 1.200405e-02 1 1  ON 34
eH1_5                 4.478195e-02 1 1  ON 35
eH1_6                 9.481218e-02 1 1  ON 36
eH1_7                 1.382216e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291458e-02 1 1  ON 39
eH2_0                -2.097228e-01 1 1  ON 40
eH2_1                -1.264573e-01 1 1  ON 41
eH2_2                -8.726880e-02 1 1  ON 42
eH2_3                -3.643107e-02 1 1  ON 43
eH2_4                 1.332513e-02 1 1  ON 44
eH2_5                 4.799432e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9114
    reference variance = 0.140775
====================================================
  Execution time = 2.5627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2129e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321289970770
                                         uncertainty =       0.002796444229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321289970770
                                         uncertainty =       0.002796444229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400803405
  error estimate for blocks of size 2^( 2) =       0.000413467365
  error estimate for blocks of size 2^( 3) =       0.000426430073
  error estimate for blocks of size 2^( 4) =       0.000438432587
  error estimate for blocks of size 2^( 5) =       0.000448666639
  error estimate for blocks of size 2^( 6) =       0.000456834647
  error estimate for blocks of size 2^( 7) =       0.000461940075

      target function =                  N/A
              le_mean =     -16.908778953582
             les_mean =     286.228092278806
             stat err =       0.000451468487
             autocorr =       1.268796813170
              std dev =       0.566821610685
             le_variance =       0.321286738340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690877895358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908778953582       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908778971046       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908778990083       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908778996330       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908778997963       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908778998902       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908778998885       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908778999026       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908778999234       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908778999253       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.190759e-06

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908778953582       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908778957948       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908778962708       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908778964267       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908778964677       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908778964907       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908778964911       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908778964960       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908778965014       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908778965014       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.977018e-07

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908778953582       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908778954674       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908778955864       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908778956232       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908778956356       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908778956393       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908778956415       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908778956431       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908778956522       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908778956434       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 7.442622e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2336e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.025240e-01 1 1  ON 0
 uu_1                 1.392133e-01 1 1  ON 1
 uu_2                 4.170482e-02 1 1  ON 2
 uu_3                -1.918649e-02 1 1  ON 3
 uu_4                -6.325476e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278905e-02 1 1  ON 9
 ud_0                 4.117218e-01 1 1  ON 10
 ud_1                 1.592842e-01 1 1  ON 11
 ud_2                 6.036510e-02 1 1  ON 12
 ud_3                 1.862842e-03 1 1  ON 13
 ud_4                -5.685543e-02 1 1  ON 14
 ud_5                -1.013732e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435974e-01 1 1  ON 17
 ud_8                -1.425424e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062030e-01 1 1  ON 20
 eO_1                -4.138910e-01 1 1  ON 21
 eO_2                -3.051396e-02 1 1  ON 22
 eO_3                 2.701595e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594127e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587005e-02 1 1  ON 27
 eO_8                -1.960061e-01 1 1  ON 28
 eO_9                -5.774350e-02 1 1  ON 29
eH1_0                -2.108323e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825392e-02 1 1  ON 32
eH1_3                -3.745003e-02 1 1  ON 33
eH1_4                 1.200412e-02 1 1  ON 34
eH1_5                 4.478196e-02 1 1  ON 35
eH1_6                 9.481220e-02 1 1  ON 36
eH1_7                 1.382216e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291459e-02 1 1  ON 39
eH2_0                -2.097229e-01 1 1  ON 40
eH2_1                -1.264573e-01 1 1  ON 41
eH2_2                -8.726878e-02 1 1  ON 42
eH2_3                -3.643108e-02 1 1  ON 43
eH2_4                 1.332519e-02 1 1  ON 44
eH2_5                 4.799433e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301137e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.863
    reference variance = 0.325037
====================================================
  Execution time = 2.7325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.0000e+06
  Execution time = 2.9523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731097969
                                         uncertainty =       0.005170491178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731097969
                                         uncertainty =       0.005170491178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937218
  error estimate for blocks of size 2^( 2) =       0.000424227989
  error estimate for blocks of size 2^( 3) =       0.000437093585
  error estimate for blocks of size 2^( 4) =       0.000449703156
  error estimate for blocks of size 2^( 5) =       0.000461447471
  error estimate for blocks of size 2^( 6) =       0.000469688155
  error estimate for blocks of size 2^( 7) =       0.000475168702

      target function =                  N/A
              le_mean =     -16.908991303677
             les_mean =     286.251725533064
             stat err =       0.000464001871
             autocorr =       1.274936370292
              std dev =       0.581152986822
             le_variance =       0.337738794092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730653354
                                         uncertainty =       0.005170497923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730653354
                                         uncertainty =       0.005170497923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410936947
  error estimate for blocks of size 2^( 2) =       0.000424227669
  error estimate for blocks of size 2^( 3) =       0.000437093226
  error estimate for blocks of size 2^( 4) =       0.000449702779
  error estimate for blocks of size 2^( 5) =       0.000461447085
  error estimate for blocks of size 2^( 6) =       0.000469687742
  error estimate for blocks of size 2^( 7) =       0.000475168274

      target function =                  N/A
              le_mean =     -16.908991304986
             les_mean =     286.251725132438
             stat err =       0.000464001470
             autocorr =       1.274935846847
              std dev =       0.581152604059
             le_variance =       0.337738349205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730875625
                                         uncertainty =       0.005170494551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730875625
                                         uncertainty =       0.005170494551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937083
  error estimate for blocks of size 2^( 2) =       0.000424227829
  error estimate for blocks of size 2^( 3) =       0.000437093406
  error estimate for blocks of size 2^( 4) =       0.000449702967
  error estimate for blocks of size 2^( 5) =       0.000461447278
  error estimate for blocks of size 2^( 6) =       0.000469687948
  error estimate for blocks of size 2^( 7) =       0.000475168488

      target function =                  N/A
              le_mean =     -16.908991304331
             les_mean =     286.251725332685
             stat err =       0.000464001670
             autocorr =       1.274936108558
              std dev =       0.581152795410
             le_variance =       0.337738571613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731070174
                                         uncertainty =       0.005170491600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731070174
                                         uncertainty =       0.005170491600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937201
  error estimate for blocks of size 2^( 2) =       0.000424227969
  error estimate for blocks of size 2^( 3) =       0.000437093563
  error estimate for blocks of size 2^( 4) =       0.000449703132
  error estimate for blocks of size 2^( 5) =       0.000461447447
  error estimate for blocks of size 2^( 6) =       0.000469688129
  error estimate for blocks of size 2^( 7) =       0.000475168675

      target function =                  N/A
              le_mean =     -16.908991303759
             les_mean =     286.251725508012
             stat err =       0.000464001846
             autocorr =       1.274936337564
              std dev =       0.581152962894
             le_variance =       0.337738766281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908991303677        initial
     3.8147e+03     3.8147e+04             1.1908e-06       -16.908991304986  <--
     1.5259e+04     1.5259e+05             2.9770e-07       -16.908991304331
     6.1035e+04     6.1035e+05             7.4426e-08       -16.908991303759

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 4.2216e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.025239e-01 1 1  ON 0
 uu_1                 1.392131e-01 1 1  ON 1
 uu_2                 4.170488e-02 1 1  ON 2
 uu_3                -1.918637e-02 1 1  ON 3
 uu_4                -6.325474e-02 1 1  ON 4
 uu_5                -9.590814e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310319e-01 1 1  ON 7
 uu_8                -1.203744e-01 1 1  ON 8
 uu_9                -9.278906e-02 1 1  ON 9
 ud_0                 4.117219e-01 1 1  ON 10
 ud_1                 1.592846e-01 1 1  ON 11
 ud_2                 6.036487e-02 1 1  ON 12
 ud_3                 1.862460e-03 1 1  ON 13
 ud_4                -5.685530e-02 1 1  ON 14
 ud_5                -1.013731e-01 1 1  ON 15
 ud_6                -1.286920e-01 1 1  ON 16
 ud_7                -1.435974e-01 1 1  ON 17
 ud_8                -1.425425e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062039e-01 1 1  ON 20
 eO_1                -4.138911e-01 1 1  ON 21
 eO_2                -3.051332e-02 1 1  ON 22
 eO_3                 2.701600e-01 1 1  ON 23
 eO_4                 4.917049e-01 1 1  ON 24
 eO_5                 4.594126e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587003e-02 1 1  ON 27
 eO_8                -1.960062e-01 1 1  ON 28
 eO_9                -5.774353e-02 1 1  ON 29
eH1_0                -2.108328e-01 1 1  ON 30
eH1_1                -1.273915e-01 1 1  ON 31
eH1_2                -8.825387e-02 1 1  ON 32
eH1_3                -3.745007e-02 1 1  ON 33
eH1_4                 1.200432e-02 1 1  ON 34
eH1_5                 4.478198e-02 1 1  ON 35
eH1_6                 9.481223e-02 1 1  ON 36
eH1_7                 1.382217e-01 1 1  ON 37
eH1_8                 1.457846e-01 1 1  ON 38
eH1_9                 3.291462e-02 1 1  ON 39
eH2_0                -2.097233e-01 1 1  ON 40
eH2_1                -1.264572e-01 1 1  ON 41
eH2_2                -8.726871e-02 1 1  ON 42
eH2_3                -3.643110e-02 1 1  ON 43
eH2_4                 1.332539e-02 1 1  ON 44
eH2_5                 4.799437e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538398e-01 1 1  ON 48
eH2_9                 1.301142e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.225815
====================================================
  Execution time = 2.5600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329835774687
                                         uncertainty =       0.004858893709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329835774687
                                         uncertainty =       0.004858893709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406018022
  error estimate for blocks of size 2^( 2) =       0.000418817020
  error estimate for blocks of size 2^( 3) =       0.000432214695
  error estimate for blocks of size 2^( 4) =       0.000444388655
  error estimate for blocks of size 2^( 5) =       0.000456003462
  error estimate for blocks of size 2^( 6) =       0.000465276845
  error estimate for blocks of size 2^( 7) =       0.000472113635

      target function =                  N/A
              le_mean =     -16.909039334314
             les_mean =     286.245312312369
             stat err =       0.000459445649
             autocorr =       1.280494346391
              std dev =       0.574196192805
             le_variance =       0.329701267832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690903933431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909039334314       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909039401571       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909039475391       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909039498248       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909039521054       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909039525759       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909039528005       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909039527922       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909039527624       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909039527745       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.754322e-06

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909039334314       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909039351131       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909039369592       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909039375308       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909039381009       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909039382187       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909039382749       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909039382732       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909039382638       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909039382682       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.188776e-06

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909039334314       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909039338519       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909039343134       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909039344564       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909039345989       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909039346285       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909039346420       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909039346421       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909039346406       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909039346384       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.972062e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2399e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.025237e-01 1 1  ON 0
 uu_1                 1.392129e-01 1 1  ON 1
 uu_2                 4.170496e-02 1 1  ON 2
 uu_3                -1.918621e-02 1 1  ON 3
 uu_4                -6.325470e-02 1 1  ON 4
 uu_5                -9.590816e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310319e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278903e-02 1 1  ON 9
 ud_0                 4.117221e-01 1 1  ON 10
 ud_1                 1.592852e-01 1 1  ON 11
 ud_2                 6.036451e-02 1 1  ON 12
 ud_3                 1.861926e-03 1 1  ON 13
 ud_4                -5.685515e-02 1 1  ON 14
 ud_5                -1.013730e-01 1 1  ON 15
 ud_6                -1.286921e-01 1 1  ON 16
 ud_7                -1.435975e-01 1 1  ON 17
 ud_8                -1.425425e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062051e-01 1 1  ON 20
 eO_1                -4.138912e-01 1 1  ON 21
 eO_2                -3.051248e-02 1 1  ON 22
 eO_3                 2.701606e-01 1 1  ON 23
 eO_4                 4.917050e-01 1 1  ON 24
 eO_5                 4.594125e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.587001e-02 1 1  ON 27
 eO_8                -1.960062e-01 1 1  ON 28
 eO_9                -5.774355e-02 1 1  ON 29
eH1_0                -2.108333e-01 1 1  ON 30
eH1_1                -1.273914e-01 1 1  ON 31
eH1_2                -8.825378e-02 1 1  ON 32
eH1_3                -3.745012e-02 1 1  ON 33
eH1_4                 1.200455e-02 1 1  ON 34
eH1_5                 4.478203e-02 1 1  ON 35
eH1_6                 9.481225e-02 1 1  ON 36
eH1_7                 1.382217e-01 1 1  ON 37
eH1_8                 1.457847e-01 1 1  ON 38
eH1_9                 3.291468e-02 1 1  ON 39
eH2_0                -2.097239e-01 1 1  ON 40
eH2_1                -1.264572e-01 1 1  ON 41
eH2_2                -8.726862e-02 1 1  ON 42
eH2_3                -3.643111e-02 1 1  ON 43
eH2_4                 1.332567e-02 1 1  ON 44
eH2_5                 4.799438e-02 1 1  ON 45
eH2_6                 1.006386e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538399e-01 1 1  ON 48
eH2_9                 1.301148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9852
    reference variance = 0.440049
====================================================
  Execution time = 2.5088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3235e-01
  Total weights = 2.0000e+06
  Execution time = 2.9486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332421006330
                                         uncertainty =       0.004898331421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332421006330
                                         uncertainty =       0.004898331421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407646327
  error estimate for blocks of size 2^( 2) =       0.000420217993
  error estimate for blocks of size 2^( 3) =       0.000433130106
  error estimate for blocks of size 2^( 4) =       0.000445152664
  error estimate for blocks of size 2^( 5) =       0.000454675867
  error estimate for blocks of size 2^( 6) =       0.000462071146
  error estimate for blocks of size 2^( 7) =       0.000467325592

      target function =                  N/A
              le_mean =     -16.908657944447
             les_mean =     286.235064372575
             stat err =       0.000457306317
             autocorr =       1.258482942466
              std dev =       0.576498964810
             le_variance =       0.332351056427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332419350810
                                         uncertainty =       0.004898321499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332419350810
                                         uncertainty =       0.004898321499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407645311
  error estimate for blocks of size 2^( 2) =       0.000420216786
  error estimate for blocks of size 2^( 3) =       0.000433128718
  error estimate for blocks of size 2^( 4) =       0.000445151196
  error estimate for blocks of size 2^( 5) =       0.000454674345
  error estimate for blocks of size 2^( 6) =       0.000462069588
  error estimate for blocks of size 2^( 7) =       0.000467324046

      target function =                  N/A
              le_mean =     -16.908657953765
             les_mean =     286.235063030659
             stat err =       0.000457304794
             autocorr =       1.258480833428
              std dev =       0.576497527659
             le_variance =       0.332349399397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420178030
                                         uncertainty =       0.004898326454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420178030
                                         uncertainty =       0.004898326454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407645819
  error estimate for blocks of size 2^( 2) =       0.000420217389
  error estimate for blocks of size 2^( 3) =       0.000433129412
  error estimate for blocks of size 2^( 4) =       0.000445151930
  error estimate for blocks of size 2^( 5) =       0.000454675106
  error estimate for blocks of size 2^( 6) =       0.000462070367
  error estimate for blocks of size 2^( 7) =       0.000467324819

      target function =                  N/A
              le_mean =     -16.908657949094
             les_mean =     286.235063700661
             stat err =       0.000457305555
             autocorr =       1.258481887927
              std dev =       0.576498245766
             le_variance =       0.332350227372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420902769
                                         uncertainty =       0.004898330800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420902769
                                         uncertainty =       0.004898330800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407646264
  error estimate for blocks of size 2^( 2) =       0.000420217918
  error estimate for blocks of size 2^( 3) =       0.000433130019
  error estimate for blocks of size 2^( 4) =       0.000445152572
  error estimate for blocks of size 2^( 5) =       0.000454675772
  error estimate for blocks of size 2^( 6) =       0.000462071049
  error estimate for blocks of size 2^( 7) =       0.000467325495

      target function =                  N/A
              le_mean =     -16.908657945027
             les_mean =     286.235064288515
             stat err =       0.000457306222
             autocorr =       1.258482810642
              std dev =       0.576498874909
             le_variance =       0.332350952772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908657944447        initial
     9.5367e+02     9.5367e+03             4.7543e-06       -16.908657953765  <--
     3.8147e+03     3.8147e+04             1.1888e-06       -16.908657949094
     1.5259e+04     1.5259e+05             2.9721e-07       -16.908657945027

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 3.9983e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.025233e-01 1 1  ON 0
 uu_1                 1.392123e-01 1 1  ON 1
 uu_2                 4.170520e-02 1 1  ON 2
 uu_3                -1.918573e-02 1 1  ON 3
 uu_4                -6.325458e-02 1 1  ON 4
 uu_5                -9.590821e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278894e-02 1 1  ON 9
 ud_0                 4.117226e-01 1 1  ON 10
 ud_1                 1.592868e-01 1 1  ON 11
 ud_2                 6.036345e-02 1 1  ON 12
 ud_3                 1.860326e-03 1 1  ON 13
 ud_4                -5.685469e-02 1 1  ON 14
 ud_5                -1.013728e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435976e-01 1 1  ON 17
 ud_8                -1.425426e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062086e-01 1 1  ON 20
 eO_1                -4.138916e-01 1 1  ON 21
 eO_2                -3.050998e-02 1 1  ON 22
 eO_3                 2.701623e-01 1 1  ON 23
 eO_4                 4.917051e-01 1 1  ON 24
 eO_5                 4.594122e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586995e-02 1 1  ON 27
 eO_8                -1.960063e-01 1 1  ON 28
 eO_9                -5.774361e-02 1 1  ON 29
eH1_0                -2.108350e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825350e-02 1 1  ON 32
eH1_3                -3.745028e-02 1 1  ON 33
eH1_4                 1.200522e-02 1 1  ON 34
eH1_5                 4.478220e-02 1 1  ON 35
eH1_6                 9.481231e-02 1 1  ON 36
eH1_7                 1.382218e-01 1 1  ON 37
eH1_8                 1.457849e-01 1 1  ON 38
eH1_9                 3.291485e-02 1 1  ON 39
eH2_0                -2.097257e-01 1 1  ON 40
eH2_1                -1.264570e-01 1 1  ON 41
eH2_2                -8.726833e-02 1 1  ON 42
eH2_3                -3.643115e-02 1 1  ON 43
eH2_4                 1.332650e-02 1 1  ON 44
eH2_5                 4.799443e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538401e-01 1 1  ON 48
eH2_9                 1.301167e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.319735
====================================================
  Execution time = 2.5468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2818e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328211058077
                                         uncertainty =       0.003894450730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328211058077
                                         uncertainty =       0.003894450730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405080993
  error estimate for blocks of size 2^( 2) =       0.000418014535
  error estimate for blocks of size 2^( 3) =       0.000431827700
  error estimate for blocks of size 2^( 4) =       0.000445857870
  error estimate for blocks of size 2^( 5) =       0.000458201680
  error estimate for blocks of size 2^( 6) =       0.000470153802
  error estimate for blocks of size 2^( 7) =       0.000480299928

      target function =                  N/A
              le_mean =     -16.908874563472
             les_mean =     286.238220060238
             stat err =       0.000463628320
             autocorr =       1.309954412137
              std dev =       0.572871033558
             le_variance =       0.328181221090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690887456347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908874563472       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908874797258       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908875098831       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908875197378       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908875265821       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908875285583       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908875293340       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908875297125       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908875301831       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908875302002       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.901592e-05

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908874563472       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908874621956       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908874697445       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908874722101       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908874739205       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908874744147       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908874746076       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908874747019       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908874748195       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908874748240       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.757070e-06

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908874563472       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908874578096       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908874596974       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908874603139       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908874607415       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908874608646       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908874609133       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908874609369       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908874609670       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908874609681       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.189461e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2101e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.025227e-01 1 1  ON 0
 uu_1                 1.392115e-01 1 1  ON 1
 uu_2                 4.170554e-02 1 1  ON 2
 uu_3                -1.918515e-02 1 1  ON 3
 uu_4                -6.325438e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278887e-02 1 1  ON 9
 ud_0                 4.117235e-01 1 1  ON 10
 ud_1                 1.592890e-01 1 1  ON 11
 ud_2                 6.036207e-02 1 1  ON 12
 ud_3                 1.858183e-03 1 1  ON 13
 ud_4                -5.685417e-02 1 1  ON 14
 ud_5                -1.013725e-01 1 1  ON 15
 ud_6                -1.286923e-01 1 1  ON 16
 ud_7                -1.435978e-01 1 1  ON 17
 ud_8                -1.425428e-01 1 1  ON 18
 ud_9                -1.344804e-01 1 1  ON 19
 eO_0                -7.062134e-01 1 1  ON 20
 eO_1                -4.138920e-01 1 1  ON 21
 eO_2                -3.050663e-02 1 1  ON 22
 eO_3                 2.701647e-01 1 1  ON 23
 eO_4                 4.917053e-01 1 1  ON 24
 eO_5                 4.594118e-01 1 1  ON 25
 eO_6                 2.360326e-01 1 1  ON 26
 eO_7                -5.586987e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774371e-02 1 1  ON 29
eH1_0                -2.108371e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825317e-02 1 1  ON 32
eH1_3                -3.745048e-02 1 1  ON 33
eH1_4                 1.200635e-02 1 1  ON 34
eH1_5                 4.478230e-02 1 1  ON 35
eH1_6                 9.481243e-02 1 1  ON 36
eH1_7                 1.382220e-01 1 1  ON 37
eH1_8                 1.457851e-01 1 1  ON 38
eH1_9                 3.291502e-02 1 1  ON 39
eH2_0                -2.097281e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726801e-02 1 1  ON 42
eH2_3                -3.643123e-02 1 1  ON 43
eH2_4                 1.332768e-02 1 1  ON 44
eH2_5                 4.799464e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538404e-01 1 1  ON 48
eH2_9                 1.301198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.346914
====================================================
  Execution time = 2.5178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2477e-01
  Total weights = 2.0000e+06
  Execution time = 2.9447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798484084
                                         uncertainty =       0.003231863278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798484084
                                         uncertainty =       0.003231863278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402973932
  error estimate for blocks of size 2^( 2) =       0.000415871405
  error estimate for blocks of size 2^( 3) =       0.000429165565
  error estimate for blocks of size 2^( 4) =       0.000442442661
  error estimate for blocks of size 2^( 5) =       0.000452982399
  error estimate for blocks of size 2^( 6) =       0.000462094078
  error estimate for blocks of size 2^( 7) =       0.000469251347

      target function =                  N/A
              le_mean =     -16.908994651163
             les_mean =     286.238875930143
             stat err =       0.000456692621
             autocorr =       1.284381625130
              std dev =       0.569891199680
             le_variance =       0.324775979473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324791798701
                                         uncertainty =       0.003231801188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324791798701
                                         uncertainty =       0.003231801188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402969784
  error estimate for blocks of size 2^( 2) =       0.000415866498
  error estimate for blocks of size 2^( 3) =       0.000429159977
  error estimate for blocks of size 2^( 4) =       0.000442436662
  error estimate for blocks of size 2^( 5) =       0.000452976109
  error estimate for blocks of size 2^( 6) =       0.000462087543
  error estimate for blocks of size 2^( 7) =       0.000469245001

      target function =                  N/A
              le_mean =     -16.908994604349
             les_mean =     286.238867660980
             stat err =       0.000456686329
             autocorr =       1.284372673900
              std dev =       0.569885333622
             le_variance =       0.324769293477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324795132831
                                         uncertainty =       0.003231832168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324795132831
                                         uncertainty =       0.003231832168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402971853
  error estimate for blocks of size 2^( 2) =       0.000415868946
  error estimate for blocks of size 2^( 3) =       0.000429162765
  error estimate for blocks of size 2^( 4) =       0.000442439655
  error estimate for blocks of size 2^( 5) =       0.000452979248
  error estimate for blocks of size 2^( 6) =       0.000462090804
  error estimate for blocks of size 2^( 7) =       0.000469248168

      target function =                  N/A
              le_mean =     -16.908994627524
             les_mean =     286.238871779158
             stat err =       0.000456689469
             autocorr =       1.284377149161
              std dev =       0.569888259149
             le_variance =       0.324772627916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798064805
                                         uncertainty =       0.003231859387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798064805
                                         uncertainty =       0.003231859387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402973672
  error estimate for blocks of size 2^( 2) =       0.000415871097
  error estimate for blocks of size 2^( 3) =       0.000429165215
  error estimate for blocks of size 2^( 4) =       0.000442442285
  error estimate for blocks of size 2^( 5) =       0.000452982005
  error estimate for blocks of size 2^( 6) =       0.000462093668
  error estimate for blocks of size 2^( 7) =       0.000469250949

      target function =                  N/A
              le_mean =     -16.908994648185
             les_mean =     286.238875410109
             stat err =       0.000456692227
             autocorr =       1.284381065589
              std dev =       0.569890831789
             le_variance =       0.324775560157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908994651163        initial  <--
     2.3842e+02     2.3842e+03             1.9016e-05       -16.908994604349
     9.5367e+02     9.5367e+03             4.7571e-06       -16.908994627524
     3.8147e+03     3.8147e+04             1.1895e-06       -16.908994648185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0161
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.025233e-01 1 1  ON 0
 uu_1                 1.392123e-01 1 1  ON 1
 uu_2                 4.170520e-02 1 1  ON 2
 uu_3                -1.918573e-02 1 1  ON 3
 uu_4                -6.325458e-02 1 1  ON 4
 uu_5                -9.590821e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278894e-02 1 1  ON 9
 ud_0                 4.117226e-01 1 1  ON 10
 ud_1                 1.592868e-01 1 1  ON 11
 ud_2                 6.036345e-02 1 1  ON 12
 ud_3                 1.860326e-03 1 1  ON 13
 ud_4                -5.685469e-02 1 1  ON 14
 ud_5                -1.013728e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435976e-01 1 1  ON 17
 ud_8                -1.425426e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062086e-01 1 1  ON 20
 eO_1                -4.138916e-01 1 1  ON 21
 eO_2                -3.050998e-02 1 1  ON 22
 eO_3                 2.701623e-01 1 1  ON 23
 eO_4                 4.917051e-01 1 1  ON 24
 eO_5                 4.594122e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586995e-02 1 1  ON 27
 eO_8                -1.960063e-01 1 1  ON 28
 eO_9                -5.774361e-02 1 1  ON 29
eH1_0                -2.108350e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825350e-02 1 1  ON 32
eH1_3                -3.745028e-02 1 1  ON 33
eH1_4                 1.200522e-02 1 1  ON 34
eH1_5                 4.478220e-02 1 1  ON 35
eH1_6                 9.481231e-02 1 1  ON 36
eH1_7                 1.382218e-01 1 1  ON 37
eH1_8                 1.457849e-01 1 1  ON 38
eH1_9                 3.291485e-02 1 1  ON 39
eH2_0                -2.097257e-01 1 1  ON 40
eH2_1                -1.264570e-01 1 1  ON 41
eH2_2                -8.726833e-02 1 1  ON 42
eH2_3                -3.643115e-02 1 1  ON 43
eH2_4                 1.332650e-02 1 1  ON 44
eH2_5                 4.799443e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496078e-01 1 1  ON 47
eH2_8                 1.538401e-01 1 1  ON 48
eH2_9                 1.301167e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9305
    reference variance = 0.387122
====================================================
  Execution time = 2.5652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2665e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326534050360
                                         uncertainty =       0.003372201840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326534050360
                                         uncertainty =       0.003372201840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404132371
  error estimate for blocks of size 2^( 2) =       0.000417022914
  error estimate for blocks of size 2^( 3) =       0.000430322382
  error estimate for blocks of size 2^( 4) =       0.000442401741
  error estimate for blocks of size 2^( 5) =       0.000452513177
  error estimate for blocks of size 2^( 6) =       0.000459404917
  error estimate for blocks of size 2^( 7) =       0.000464162797

      target function =                  N/A
              le_mean =     -16.909184365101
             les_mean =     286.247161676465
             stat err =       0.000454620658
             autocorr =       1.265467671255
              std dev =       0.571529480276
             le_variance =       0.326645946824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690918436510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909184365101       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909184394489       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909184426492       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909184439032       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909184444195       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909184445305       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909184445464       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909184445348       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909184445694       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909184445725       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.910785e-06

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909184365101       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909184372448       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909184380450       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909184383588       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909184384876       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909184385121       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909184385200       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909184385161       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909184385243       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909184385288       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.777279e-07

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909184365101       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909184366938       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909184368938       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909184369722       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909184370040       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909184370109       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909184370135       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909184370090       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909184370157       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909184370150       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.194340e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2263e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.025232e-01 1 1  ON 0
 uu_1                 1.392123e-01 1 1  ON 1
 uu_2                 4.170524e-02 1 1  ON 2
 uu_3                -1.918565e-02 1 1  ON 3
 uu_4                -6.325457e-02 1 1  ON 4
 uu_5                -9.590822e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278895e-02 1 1  ON 9
 ud_0                 4.117227e-01 1 1  ON 10
 ud_1                 1.592870e-01 1 1  ON 11
 ud_2                 6.036331e-02 1 1  ON 12
 ud_3                 1.860115e-03 1 1  ON 13
 ud_4                -5.685462e-02 1 1  ON 14
 ud_5                -1.013727e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435976e-01 1 1  ON 17
 ud_8                -1.425426e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062091e-01 1 1  ON 20
 eO_1                -4.138916e-01 1 1  ON 21
 eO_2                -3.050965e-02 1 1  ON 22
 eO_3                 2.701625e-01 1 1  ON 23
 eO_4                 4.917051e-01 1 1  ON 24
 eO_5                 4.594121e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586994e-02 1 1  ON 27
 eO_8                -1.960063e-01 1 1  ON 28
 eO_9                -5.774362e-02 1 1  ON 29
eH1_0                -2.108352e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825346e-02 1 1  ON 32
eH1_3                -3.745030e-02 1 1  ON 33
eH1_4                 1.200532e-02 1 1  ON 34
eH1_5                 4.478222e-02 1 1  ON 35
eH1_6                 9.481232e-02 1 1  ON 36
eH1_7                 1.382218e-01 1 1  ON 37
eH1_8                 1.457849e-01 1 1  ON 38
eH1_9                 3.291487e-02 1 1  ON 39
eH2_0                -2.097259e-01 1 1  ON 40
eH2_1                -1.264570e-01 1 1  ON 41
eH2_2                -8.726829e-02 1 1  ON 42
eH2_3                -3.643116e-02 1 1  ON 43
eH2_4                 1.332661e-02 1 1  ON 44
eH2_5                 4.799445e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538401e-01 1 1  ON 48
eH2_9                 1.301169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.277143
====================================================
  Execution time = 2.5088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4552e-01
  Total weights = 2.0000e+06
  Execution time = 2.9342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596057864
                                         uncertainty =       0.008440170256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596057864
                                         uncertainty =       0.008440170256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415642486
  error estimate for blocks of size 2^( 2) =       0.000428234350
  error estimate for blocks of size 2^( 3) =       0.000440969812
  error estimate for blocks of size 2^( 4) =       0.000452782891
  error estimate for blocks of size 2^( 5) =       0.000462404413
  error estimate for blocks of size 2^( 6) =       0.000470063086
  error estimate for blocks of size 2^( 7) =       0.000475254920

      target function =                  N/A
              le_mean =     -16.909342987019
             les_mean =     286.271397432178
             stat err =       0.000465126327
             autocorr =       1.252281537224
              std dev =       0.587807240762
             le_variance =       0.345517352292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345595278985
                                         uncertainty =       0.008440144479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345595278985
                                         uncertainty =       0.008440144479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415642018
  error estimate for blocks of size 2^( 2) =       0.000428233806
  error estimate for blocks of size 2^( 3) =       0.000440969206
  error estimate for blocks of size 2^( 4) =       0.000452782246
  error estimate for blocks of size 2^( 5) =       0.000462403747
  error estimate for blocks of size 2^( 6) =       0.000470062421
  error estimate for blocks of size 2^( 7) =       0.000475254274

      target function =                  N/A
              le_mean =     -16.909342995758
             les_mean =     286.271396949315
             stat err =       0.000465125672
             autocorr =       1.252280828559
              std dev =       0.587806578643
             le_variance =       0.345516573896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345595668327
                                         uncertainty =       0.008440157364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345595668327
                                         uncertainty =       0.008440157364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415642252
  error estimate for blocks of size 2^( 2) =       0.000428234078
  error estimate for blocks of size 2^( 3) =       0.000440969509
  error estimate for blocks of size 2^( 4) =       0.000452782568
  error estimate for blocks of size 2^( 5) =       0.000462404080
  error estimate for blocks of size 2^( 6) =       0.000470062753
  error estimate for blocks of size 2^( 7) =       0.000475254597

      target function =                  N/A
              le_mean =     -16.909342991386
             les_mean =     286.271397190584
             stat err =       0.000465126000
             autocorr =       1.252281182903
              std dev =       0.587806909619
             le_variance =       0.345516962996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596009168
                                         uncertainty =       0.008440168645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596009168
                                         uncertainty =       0.008440168645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415642457
  error estimate for blocks of size 2^( 2) =       0.000428234316
  error estimate for blocks of size 2^( 3) =       0.000440969774
  error estimate for blocks of size 2^( 4) =       0.000452782851
  error estimate for blocks of size 2^( 5) =       0.000462404372
  error estimate for blocks of size 2^( 6) =       0.000470063044
  error estimate for blocks of size 2^( 7) =       0.000475254880

      target function =                  N/A
              le_mean =     -16.909342987565
             les_mean =     286.271397401967
             stat err =       0.000465126287
             autocorr =       1.252281492937
              std dev =       0.587807199365
             le_variance =       0.345517303626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909342987019        initial
     2.3842e+03     2.3842e+04             1.9108e-06       -16.909342995758  <--
     9.5367e+03     9.5367e+04             4.7773e-07       -16.909342991386
     3.8147e+04     3.8147e+05             1.1943e-07       -16.909342987565

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 3.9871e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170536e-02 1 1  ON 2
 uu_3                -1.918542e-02 1 1  ON 3
 uu_4                -6.325453e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036291e-02 1 1  ON 12
 ud_3                 1.859482e-03 1 1  ON 13
 ud_4                -5.685441e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062105e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050863e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586991e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774366e-02 1 1  ON 29
eH1_0                -2.108358e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825335e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200562e-02 1 1  ON 34
eH1_5                 4.478227e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291494e-02 1 1  ON 39
eH2_0                -2.097266e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726820e-02 1 1  ON 42
eH2_3                -3.643118e-02 1 1  ON 43
eH2_4                 1.332696e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.204712
====================================================
  Execution time = 2.5675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3017e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330225820205
                                         uncertainty =       0.004605911470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330225820205
                                         uncertainty =       0.004605911470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406303659
  error estimate for blocks of size 2^( 2) =       0.000419013289
  error estimate for blocks of size 2^( 3) =       0.000431965172
  error estimate for blocks of size 2^( 4) =       0.000444195060
  error estimate for blocks of size 2^( 5) =       0.000454536842
  error estimate for blocks of size 2^( 6) =       0.000462431697
  error estimate for blocks of size 2^( 7) =       0.000465942997

      target function =                  N/A
              le_mean =     -16.908544371003
             les_mean =     286.229037907496
             stat err =       0.000456776649
             autocorr =       1.263881398038
              std dev =       0.574600144810
             le_variance =       0.330165326416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690854437100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908544371003       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908544480232       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908544585720       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908544616207       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908544632804       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908544643962       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908544645521       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908544645348       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908544645620       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908544645869       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 7.390367e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908544371003       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908544398317       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908544424703       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908544432326       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908544436474       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908544439268       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908544439655       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908544439608       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908544439678       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908544439733       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.848061e-06

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908544371003       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908544377832       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908544384429       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908544386334       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908544387372       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908544388070       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908544388162       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908544388151       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908544388173       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908544388201       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.620446e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2305e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.025229e-01 1 1  ON 0
 uu_1                 1.392117e-01 1 1  ON 1
 uu_2                 4.170547e-02 1 1  ON 2
 uu_3                -1.918518e-02 1 1  ON 3
 uu_4                -6.325448e-02 1 1  ON 4
 uu_5                -9.590830e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203746e-01 1 1  ON 8
 uu_9                -9.278899e-02 1 1  ON 9
 ud_0                 4.117233e-01 1 1  ON 10
 ud_1                 1.592886e-01 1 1  ON 11
 ud_2                 6.036242e-02 1 1  ON 12
 ud_3                 1.858631e-03 1 1  ON 13
 ud_4                -5.685416e-02 1 1  ON 14
 ud_5                -1.013725e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435978e-01 1 1  ON 17
 ud_8                -1.425429e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062124e-01 1 1  ON 20
 eO_1                -4.138920e-01 1 1  ON 21
 eO_2                -3.050726e-02 1 1  ON 22
 eO_3                 2.701642e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594118e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586988e-02 1 1  ON 27
 eO_8                -1.960065e-01 1 1  ON 28
 eO_9                -5.774372e-02 1 1  ON 29
eH1_0                -2.108367e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825323e-02 1 1  ON 32
eH1_3                -3.745045e-02 1 1  ON 33
eH1_4                 1.200606e-02 1 1  ON 34
eH1_5                 4.478234e-02 1 1  ON 35
eH1_6                 9.481241e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457851e-01 1 1  ON 38
eH1_9                 3.291502e-02 1 1  ON 39
eH2_0                -2.097275e-01 1 1  ON 40
eH2_1                -1.264568e-01 1 1  ON 41
eH2_2                -8.726804e-02 1 1  ON 42
eH2_3                -3.643123e-02 1 1  ON 43
eH2_4                 1.332742e-02 1 1  ON 44
eH2_5                 4.799455e-02 1 1  ON 45
eH2_6                 1.006388e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538403e-01 1 1  ON 48
eH2_9                 1.301181e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9528
    reference variance = 0.289157
====================================================
  Execution time = 2.7433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.0000e+06
  Execution time = 2.9586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591123911
                                         uncertainty =       0.006037168991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334591123911
                                         uncertainty =       0.006037168991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066181
  error estimate for blocks of size 2^( 2) =       0.000421641931
  error estimate for blocks of size 2^( 3) =       0.000434784144
  error estimate for blocks of size 2^( 4) =       0.000445722261
  error estimate for blocks of size 2^( 5) =       0.000455576577
  error estimate for blocks of size 2^( 6) =       0.000462368296
  error estimate for blocks of size 2^( 7) =       0.000467004268

      target function =                  N/A
              le_mean =     -16.908390193382
             les_mean =     286.228329044792
             stat err =       0.000457667850
             autocorr =       1.251738641825
              std dev =       0.578506940719
             le_variance =       0.334670280460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334588474128
                                         uncertainty =       0.006037165521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334588474128
                                         uncertainty =       0.006037165521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409064562
  error estimate for blocks of size 2^( 2) =       0.000421640011
  error estimate for blocks of size 2^( 3) =       0.000434781999
  error estimate for blocks of size 2^( 4) =       0.000445720021
  error estimate for blocks of size 2^( 5) =       0.000455574253
  error estimate for blocks of size 2^( 6) =       0.000462365911
  error estimate for blocks of size 2^( 7) =       0.000467001907

      target function =                  N/A
              le_mean =     -16.908390148927
             les_mean =     286.228324892823
             stat err =       0.000457665523
             autocorr =       1.251735817697
              std dev =       0.578504651517
             le_variance =       0.334667631827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334589797639
                                         uncertainty =       0.006037167248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334589797639
                                         uncertainty =       0.006037167248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065371
  error estimate for blocks of size 2^( 2) =       0.000421640970
  error estimate for blocks of size 2^( 3) =       0.000434783071
  error estimate for blocks of size 2^( 4) =       0.000445721140
  error estimate for blocks of size 2^( 5) =       0.000455575414
  error estimate for blocks of size 2^( 6) =       0.000462367102
  error estimate for blocks of size 2^( 7) =       0.000467003087

      target function =                  N/A
              le_mean =     -16.908390171113
             les_mean =     286.228326966035
             stat err =       0.000457666686
             autocorr =       1.251737229941
              std dev =       0.578505794926
             le_variance =       0.334668954763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334590958067
                                         uncertainty =       0.006037168773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334590958067
                                         uncertainty =       0.006037168773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066079
  error estimate for blocks of size 2^( 2) =       0.000421641811
  error estimate for blocks of size 2^( 3) =       0.000434784009
  error estimate for blocks of size 2^( 4) =       0.000445722121
  error estimate for blocks of size 2^( 5) =       0.000455576431
  error estimate for blocks of size 2^( 6) =       0.000462368147
  error estimate for blocks of size 2^( 7) =       0.000467004120

      target function =                  N/A
              le_mean =     -16.908390190595
             les_mean =     286.228328784759
             stat err =       0.000457667705
             autocorr =       1.251738465343
              std dev =       0.578506797443
             le_variance =       0.334670114688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908390193382        initial  <--
     5.9605e+02     5.9605e+03             7.3904e-06       -16.908390148927
     2.3842e+03     2.3842e+04             1.8481e-06       -16.908390171113
     9.5367e+03     9.5367e+04             4.6204e-07       -16.908390190595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2848
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170536e-02 1 1  ON 2
 uu_3                -1.918542e-02 1 1  ON 3
 uu_4                -6.325453e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036291e-02 1 1  ON 12
 ud_3                 1.859482e-03 1 1  ON 13
 ud_4                -5.685441e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062105e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050863e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586991e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774366e-02 1 1  ON 29
eH1_0                -2.108358e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825335e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200562e-02 1 1  ON 34
eH1_5                 4.478227e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291494e-02 1 1  ON 39
eH2_0                -2.097266e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726820e-02 1 1  ON 42
eH2_3                -3.643118e-02 1 1  ON 43
eH2_4                 1.332696e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.316731
====================================================
  Execution time = 2.5849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330728141850
                                         uncertainty =       0.004273634411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330728141850
                                         uncertainty =       0.004273634411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406862914
  error estimate for blocks of size 2^( 2) =       0.000419323834
  error estimate for blocks of size 2^( 3) =       0.000432244603
  error estimate for blocks of size 2^( 4) =       0.000443331436
  error estimate for blocks of size 2^( 5) =       0.000453258855
  error estimate for blocks of size 2^( 6) =       0.000458408681
  error estimate for blocks of size 2^( 7) =       0.000461690596

      target function =                  N/A
              le_mean =     -16.908701609490
             les_mean =     286.235264814935
             stat err =       0.000454172392
             autocorr =       1.246078065240
              std dev =       0.575391051127
             le_variance =       0.331074861717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690870160949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908701609490       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908701619939       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908701633309       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908701636877       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908701638693       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908701639411       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908701639292       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908701639426       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908701639456       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908701639476       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 7.368129e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908701609490       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908701612102       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908701615445       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908701616337       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908701616777       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908701616961       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908701616941       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908701616955       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908701617003       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908701616970       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.842081e-07

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908701609490       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908701610143       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908701610978       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908701611160       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908701611363       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908701611424       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908701611394       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908701611350       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908701611347       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908701611365       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 4.605232e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202294 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2410e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170538e-02 1 1  ON 2
 uu_3                -1.918539e-02 1 1  ON 3
 uu_4                -6.325452e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592878e-01 1 1  ON 11
 ud_2                 6.036286e-02 1 1  ON 12
 ud_3                 1.859400e-03 1 1  ON 13
 ud_4                -5.685438e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062107e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050850e-02 1 1  ON 22
 eO_3                 2.701634e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774367e-02 1 1  ON 29
eH1_0                -2.108359e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825334e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200567e-02 1 1  ON 34
eH1_5                 4.478228e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291495e-02 1 1  ON 39
eH2_0                -2.097267e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726818e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332701e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9528
    reference variance = 0.253549
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.0000e+06
  Execution time = 2.9550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522313236
                                         uncertainty =       0.009676753253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522313236
                                         uncertainty =       0.009676753253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411483923
  error estimate for blocks of size 2^( 2) =       0.000424398228
  error estimate for blocks of size 2^( 3) =       0.000437904228
  error estimate for blocks of size 2^( 4) =       0.000450929781
  error estimate for blocks of size 2^( 5) =       0.000462821754
  error estimate for blocks of size 2^( 6) =       0.000470000112
  error estimate for blocks of size 2^( 7) =       0.000476582012

      target function =                  N/A
              le_mean =     -16.908879112197
             les_mean =     286.248830699922
             stat err =       0.000465083415
             autocorr =       1.277485446805
              std dev =       0.581926145100
             le_variance =       0.338638038351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522071819
                                         uncertainty =       0.009676765004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522071819
                                         uncertainty =       0.009676765004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411483777
  error estimate for blocks of size 2^( 2) =       0.000424398051
  error estimate for blocks of size 2^( 3) =       0.000437904026
  error estimate for blocks of size 2^( 4) =       0.000450929563
  error estimate for blocks of size 2^( 5) =       0.000462821528
  error estimate for blocks of size 2^( 6) =       0.000469999885
  error estimate for blocks of size 2^( 7) =       0.000476581787

      target function =                  N/A
              le_mean =     -16.908879111407
             les_mean =     286.248830431985
             stat err =       0.000465083191
             autocorr =       1.277485124854
              std dev =       0.581925937840
             le_variance =       0.338637797131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522192515
                                         uncertainty =       0.009676759129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522192515
                                         uncertainty =       0.009676759129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411483850
  error estimate for blocks of size 2^( 2) =       0.000424398140
  error estimate for blocks of size 2^( 3) =       0.000437904127
  error estimate for blocks of size 2^( 4) =       0.000450929672
  error estimate for blocks of size 2^( 5) =       0.000462821641
  error estimate for blocks of size 2^( 6) =       0.000469999999
  error estimate for blocks of size 2^( 7) =       0.000476581900

      target function =                  N/A
              le_mean =     -16.908879111802
             les_mean =     286.248830565931
             stat err =       0.000465083303
             autocorr =       1.277485285836
              std dev =       0.581926041459
             le_variance =       0.338637917728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522298145
                                         uncertainty =       0.009676753987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522298145
                                         uncertainty =       0.009676753987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411483914
  error estimate for blocks of size 2^( 2) =       0.000424398217
  error estimate for blocks of size 2^( 3) =       0.000437904216
  error estimate for blocks of size 2^( 4) =       0.000450929768
  error estimate for blocks of size 2^( 5) =       0.000462821740
  error estimate for blocks of size 2^( 6) =       0.000470000098
  error estimate for blocks of size 2^( 7) =       0.000476581998

      target function =                  N/A
              le_mean =     -16.908879112147
             les_mean =     286.248830683172
             stat err =       0.000465083401
             autocorr =       1.277485426680
              std dev =       0.581926132145
             le_variance =       0.338638023273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908879112197        initial  <--
     5.9605e+03     5.9605e+04             7.3681e-07       -16.908879111407
     2.3842e+04     2.3842e+05             1.8421e-07       -16.908879111802
     9.5367e+04     9.5367e+05             4.6052e-08       -16.908879112147

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3781
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170536e-02 1 1  ON 2
 uu_3                -1.918542e-02 1 1  ON 3
 uu_4                -6.325453e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036291e-02 1 1  ON 12
 ud_3                 1.859482e-03 1 1  ON 13
 ud_4                -5.685441e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062105e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050863e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586991e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774366e-02 1 1  ON 29
eH1_0                -2.108358e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825335e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200562e-02 1 1  ON 34
eH1_5                 4.478227e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291494e-02 1 1  ON 39
eH2_0                -2.097266e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726820e-02 1 1  ON 42
eH2_3                -3.643118e-02 1 1  ON 43
eH2_4                 1.332696e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.289052
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324968282169
                                         uncertainty =       0.003443810902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324968282169
                                         uncertainty =       0.003443810902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403096121
  error estimate for blocks of size 2^( 2) =       0.000416026461
  error estimate for blocks of size 2^( 3) =       0.000429322335
  error estimate for blocks of size 2^( 4) =       0.000442112258
  error estimate for blocks of size 2^( 5) =       0.000453471933
  error estimate for blocks of size 2^( 6) =       0.000461825747
  error estimate for blocks of size 2^( 7) =       0.000465677863

      target function =                  N/A
              le_mean =     -16.908906917695
             les_mean =     286.236105955094
             stat err =       0.000455771950
             autocorr =       1.278432929607
              std dev =       0.570064001945
             le_variance =       0.324972966314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690890691769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908906917695       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908906918577       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908906919564       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908906919910       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908906920060       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908906920024       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908906920068       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908906920127       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908906920121       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908906920124       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 7.616275e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908906917695       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908906917915       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908906918162       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908906918218       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908906918301       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908906918291       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908906918445       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908906918198       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908906918763       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908906918371       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.904074e-08

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908906917695       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908906917750       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908906917812       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908906917146       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908906917454       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908906918089       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908906917791       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908906918477       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908906918096       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908906917725       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 4.760187e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2419e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170536e-02 1 1  ON 2
 uu_3                -1.918542e-02 1 1  ON 3
 uu_4                -6.325453e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036291e-02 1 1  ON 12
 ud_3                 1.859474e-03 1 1  ON 13
 ud_4                -5.685441e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062106e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050862e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774366e-02 1 1  ON 29
eH1_0                -2.108359e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825335e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200563e-02 1 1  ON 34
eH1_5                 4.478227e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291494e-02 1 1  ON 39
eH2_0                -2.097266e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726820e-02 1 1  ON 42
eH2_3                -3.643118e-02 1 1  ON 43
eH2_4                 1.332696e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.301419
====================================================
  Execution time = 2.5074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4097e-01
  Total weights = 2.0000e+06
  Execution time = 2.9463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034870114
                                         uncertainty =       0.011952918445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034870114
                                         uncertainty =       0.011952918445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412901207
  error estimate for blocks of size 2^( 2) =       0.000425393628
  error estimate for blocks of size 2^( 3) =       0.000437801195
  error estimate for blocks of size 2^( 4) =       0.000449753184
  error estimate for blocks of size 2^( 5) =       0.000460193142
  error estimate for blocks of size 2^( 6) =       0.000467912063
  error estimate for blocks of size 2^( 7) =       0.000472926396

      target function =                  N/A
              le_mean =     -16.908823870358
             les_mean =     286.249299321060
             stat err =       0.000462696196
             autocorr =       1.255739497602
              std dev =       0.583930486237
             le_variance =       0.340974812757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034843532
                                         uncertainty =       0.011952919277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034843532
                                         uncertainty =       0.011952919277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412901190
  error estimate for blocks of size 2^( 2) =       0.000425393609
  error estimate for blocks of size 2^( 3) =       0.000437801173
  error estimate for blocks of size 2^( 4) =       0.000449753161
  error estimate for blocks of size 2^( 5) =       0.000460193118
  error estimate for blocks of size 2^( 6) =       0.000467912039
  error estimate for blocks of size 2^( 7) =       0.000472926372

      target function =                  N/A
              le_mean =     -16.908823870592
             les_mean =     286.249299302415
             stat err =       0.000462696172
             autocorr =       1.255739465751
              std dev =       0.583930463486
             le_variance =       0.340974786187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034856823
                                         uncertainty =       0.011952918861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034856823
                                         uncertainty =       0.011952918861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412901199
  error estimate for blocks of size 2^( 2) =       0.000425393618
  error estimate for blocks of size 2^( 3) =       0.000437801184
  error estimate for blocks of size 2^( 4) =       0.000449753173
  error estimate for blocks of size 2^( 5) =       0.000460193130
  error estimate for blocks of size 2^( 6) =       0.000467912051
  error estimate for blocks of size 2^( 7) =       0.000472926384

      target function =                  N/A
              le_mean =     -16.908823870475
             les_mean =     286.249299311737
             stat err =       0.000462696184
             autocorr =       1.255739481671
              std dev =       0.583930474861
             le_variance =       0.340974799472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034868452
                                         uncertainty =       0.011952918497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341034868452
                                         uncertainty =       0.011952918497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412901206
  error estimate for blocks of size 2^( 2) =       0.000425393627
  error estimate for blocks of size 2^( 3) =       0.000437801194
  error estimate for blocks of size 2^( 4) =       0.000449753183
  error estimate for blocks of size 2^( 5) =       0.000460193141
  error estimate for blocks of size 2^( 6) =       0.000467912061
  error estimate for blocks of size 2^( 7) =       0.000472926394

      target function =                  N/A
              le_mean =     -16.908823870373
             les_mean =     286.249299319895
             stat err =       0.000462696195
             autocorr =       1.255739495606
              std dev =       0.583930484815
             le_variance =       0.340974811096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908823870358        initial
     5.9605e+04     5.9605e+05             7.6163e-08       -16.908823870592  <--
     2.3842e+05     2.3842e+06             1.9041e-08       -16.908823870475
     9.5367e+05     9.5367e+06             4.7602e-09       -16.908823870373

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.9934e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170537e-02 1 1  ON 2
 uu_3                -1.918541e-02 1 1  ON 3
 uu_4                -6.325452e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036289e-02 1 1  ON 12
 ud_3                 1.859450e-03 1 1  ON 13
 ud_4                -5.685440e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062106e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050858e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774367e-02 1 1  ON 29
eH1_0                -2.108359e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825335e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200564e-02 1 1  ON 34
eH1_5                 4.478227e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291495e-02 1 1  ON 39
eH2_0                -2.097267e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726819e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332698e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8317
    reference variance = 0.314966
====================================================
  Execution time = 2.5657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3433e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334363180094
                                         uncertainty =       0.005039356233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334363180094
                                         uncertainty =       0.005039356233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408856650
  error estimate for blocks of size 2^( 2) =       0.000421552977
  error estimate for blocks of size 2^( 3) =       0.000435023468
  error estimate for blocks of size 2^( 4) =       0.000448142740
  error estimate for blocks of size 2^( 5) =       0.000460118358
  error estimate for blocks of size 2^( 6) =       0.000469382288
  error estimate for blocks of size 2^( 7) =       0.000475179076

      target function =                  N/A
              le_mean =     -16.907949923948
             les_mean =     286.213097984262
             stat err =       0.000463205616
             autocorr =       1.283528450202
              std dev =       0.578210619658
             le_variance =       0.334327520685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690794992395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907949923948       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907949928592       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907949934119       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907949935275       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907949936208       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907949936531       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907949936716       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907949936703       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907949936687       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907949936693       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.926424e-07

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907949923948       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907949925109       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907949926491       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907949926788       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907949926989       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907949927055       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907949927134       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907949927202       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907949927143       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907949927054       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 7.316132e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907949923948       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907949924238       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907949924584       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907949924621       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907949924776       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907949924905       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907949924890       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907949924954       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907949924732       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907949924632       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.829037e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2266e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170537e-02 1 1  ON 2
 uu_3                -1.918540e-02 1 1  ON 3
 uu_4                -6.325452e-02 1 1  ON 4
 uu_5                -9.590827e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592877e-01 1 1  ON 11
 ud_2                 6.036287e-02 1 1  ON 12
 ud_3                 1.859415e-03 1 1  ON 13
 ud_4                -5.685439e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062107e-01 1 1  ON 20
 eO_1                -4.138917e-01 1 1  ON 21
 eO_2                -3.050852e-02 1 1  ON 22
 eO_3                 2.701633e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594120e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774367e-02 1 1  ON 29
eH1_0                -2.108359e-01 1 1  ON 30
eH1_1                -1.273913e-01 1 1  ON 31
eH1_2                -8.825334e-02 1 1  ON 32
eH1_3                -3.745037e-02 1 1  ON 33
eH1_4                 1.200566e-02 1 1  ON 34
eH1_5                 4.478228e-02 1 1  ON 35
eH1_6                 9.481236e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291495e-02 1 1  ON 39
eH2_0                -2.097267e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726819e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332699e-02 1 1  ON 44
eH2_5                 4.799449e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8976
    reference variance = 0.212203
====================================================
  Execution time = 2.5280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3138e-01
  Total weights = 2.0000e+06
  Execution time = 2.9453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479874614
                                         uncertainty =       0.004708735841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479874614
                                         uncertainty =       0.004708735841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049691
  error estimate for blocks of size 2^( 2) =       0.000420118386
  error estimate for blocks of size 2^( 3) =       0.000433605788
  error estimate for blocks of size 2^( 4) =       0.000446582316
  error estimate for blocks of size 2^( 5) =       0.000457781475
  error estimate for blocks of size 2^( 6) =       0.000465870571
  error estimate for blocks of size 2^( 7) =       0.000470920103

      target function =                  N/A
              le_mean =     -16.907963922731
             les_mean =     286.210622748798
             stat err =       0.000460288616
             autocorr =       1.278691002096
              std dev =       0.575655193767
             le_variance =       0.331378902111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479767367
                                         uncertainty =       0.004708734497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479767367
                                         uncertainty =       0.004708734497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049625
  error estimate for blocks of size 2^( 2) =       0.000420118307
  error estimate for blocks of size 2^( 3) =       0.000433605699
  error estimate for blocks of size 2^( 4) =       0.000446582220
  error estimate for blocks of size 2^( 5) =       0.000457781374
  error estimate for blocks of size 2^( 6) =       0.000465870471
  error estimate for blocks of size 2^( 7) =       0.000470920003

      target function =                  N/A
              le_mean =     -16.907963922886
             les_mean =     286.210622646781
             stat err =       0.000460288517
             autocorr =       1.278690864611
              std dev =       0.575655100600
             le_variance =       0.331378794847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479820988
                                         uncertainty =       0.004708735169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479820988
                                         uncertainty =       0.004708735169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049658
  error estimate for blocks of size 2^( 2) =       0.000420118346
  error estimate for blocks of size 2^( 3) =       0.000433605744
  error estimate for blocks of size 2^( 4) =       0.000446582268
  error estimate for blocks of size 2^( 5) =       0.000457781424
  error estimate for blocks of size 2^( 6) =       0.000465870521
  error estimate for blocks of size 2^( 7) =       0.000470920053

      target function =                  N/A
              le_mean =     -16.907963922809
             les_mean =     286.210622697786
             stat err =       0.000460288567
             autocorr =       1.278690933357
              std dev =       0.575655147182
             le_variance =       0.331378848477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479867911
                                         uncertainty =       0.004708735757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331479867911
                                         uncertainty =       0.004708735757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049687
  error estimate for blocks of size 2^( 2) =       0.000420118381
  error estimate for blocks of size 2^( 3) =       0.000433605783
  error estimate for blocks of size 2^( 4) =       0.000446582310
  error estimate for blocks of size 2^( 5) =       0.000457781469
  error estimate for blocks of size 2^( 6) =       0.000465870565
  error estimate for blocks of size 2^( 7) =       0.000470920097

      target function =                  N/A
              le_mean =     -16.907963922741
             les_mean =     286.210622742421
             stat err =       0.000460288610
             autocorr =       1.278690993499
              std dev =       0.575655187944
             le_variance =       0.331378895407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907963922731        initial
     1.4901e+04     1.4901e+05             2.9264e-07       -16.907963922886  <--
     5.9605e+04     5.9605e+05             7.3161e-08       -16.907963922809
     2.3842e+05     2.3842e+06             1.8290e-08       -16.907963922741

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 4.0116e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918537e-02 1 1  ON 3
 uu_4                -6.325452e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592878e-01 1 1  ON 11
 ud_2                 6.036280e-02 1 1  ON 12
 ud_3                 1.859312e-03 1 1  ON 13
 ud_4                -5.685436e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062109e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050836e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108360e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825333e-02 1 1  ON 32
eH1_3                -3.745038e-02 1 1  ON 33
eH1_4                 1.200570e-02 1 1  ON 34
eH1_5                 4.478228e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097268e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726817e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332705e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9265
    reference variance = 0.346911
====================================================
  Execution time = 2.5603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2622e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326130252731
                                         uncertainty =       0.004422203725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326130252731
                                         uncertainty =       0.004422203725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403866087
  error estimate for blocks of size 2^( 2) =       0.000416576144
  error estimate for blocks of size 2^( 3) =       0.000429335739
  error estimate for blocks of size 2^( 4) =       0.000441299930
  error estimate for blocks of size 2^( 5) =       0.000452253615
  error estimate for blocks of size 2^( 6) =       0.000460556881
  error estimate for blocks of size 2^( 7) =       0.000464579970

      target function =                  N/A
              le_mean =     -16.909116953500
             les_mean =     286.244451616684
             stat err =       0.000454672599
             autocorr =       1.267426521597
              std dev =       0.571152897774
             le_variance =       0.326215632635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690911695350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909116953500       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909116971865       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909116991534       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909117000124       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909117003058       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909117004071       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909117004532       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909117005008       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909117004963       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909117004929       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.204696e-06

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909116953500       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909116958092       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909116963009       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909116965157       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909116965890       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909116966135       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909116966253       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909116966384       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909116966369       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909116966380       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 3.011865e-07

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909116953500       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909116954648       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909116955878       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909116956456       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909116956576       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909116956682       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909116956659       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909116956734       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909116956775       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909116956690       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 7.529742e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2263e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.025230e-01 1 1  ON 0
 uu_1                 1.392119e-01 1 1  ON 1
 uu_2                 4.170540e-02 1 1  ON 2
 uu_3                -1.918533e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117231e-01 1 1  ON 10
 ud_1                 1.592880e-01 1 1  ON 11
 ud_2                 6.036272e-02 1 1  ON 12
 ud_3                 1.859177e-03 1 1  ON 13
 ud_4                -5.685432e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062112e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050814e-02 1 1  ON 22
 eO_3                 2.701636e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108362e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825330e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200577e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481238e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291497e-02 1 1  ON 39
eH2_0                -2.097270e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726815e-02 1 1  ON 42
eH2_3                -3.643120e-02 1 1  ON 43
eH2_4                 1.332711e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.247102
====================================================
  Execution time = 2.7294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2530e-01
  Total weights = 2.0000e+06
  Execution time = 2.9472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353478615
                                         uncertainty =       0.003758750251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353478615
                                         uncertainty =       0.003758750251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403296024
  error estimate for blocks of size 2^( 2) =       0.000415810503
  error estimate for blocks of size 2^( 3) =       0.000428567207
  error estimate for blocks of size 2^( 4) =       0.000440741964
  error estimate for blocks of size 2^( 5) =       0.000451708043
  error estimate for blocks of size 2^( 6) =       0.000461164791
  error estimate for blocks of size 2^( 7) =       0.000465090410

      target function =                  N/A
              le_mean =     -16.908534114540
             les_mean =     286.223821106462
             stat err =       0.000454676302
             autocorr =       1.271032796770
              std dev =       0.570346707316
             le_variance =       0.325295366547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353053083
                                         uncertainty =       0.003758751895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353053083
                                         uncertainty =       0.003758751895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403295761
  error estimate for blocks of size 2^( 2) =       0.000415810193
  error estimate for blocks of size 2^( 3) =       0.000428566864
  error estimate for blocks of size 2^( 4) =       0.000440741592
  error estimate for blocks of size 2^( 5) =       0.000451707657
  error estimate for blocks of size 2^( 6) =       0.000461164394
  error estimate for blocks of size 2^( 7) =       0.000465090032

      target function =                  N/A
              le_mean =     -16.908534106842
             les_mean =     286.223820420520
             stat err =       0.000454675919
             autocorr =       1.271032316763
              std dev =       0.570346334208
             le_variance =       0.325294940944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353265814
                                         uncertainty =       0.003758751073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353265814
                                         uncertainty =       0.003758751073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403295892
  error estimate for blocks of size 2^( 2) =       0.000415810348
  error estimate for blocks of size 2^( 3) =       0.000428567035
  error estimate for blocks of size 2^( 4) =       0.000440741778
  error estimate for blocks of size 2^( 5) =       0.000451707850
  error estimate for blocks of size 2^( 6) =       0.000461164592
  error estimate for blocks of size 2^( 7) =       0.000465090221

      target function =                  N/A
              le_mean =     -16.908534110690
             les_mean =     286.223820763418
             stat err =       0.000454676111
             autocorr =       1.271032556773
              std dev =       0.570346520731
             le_variance =       0.325295153710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353452013
                                         uncertainty =       0.003758750354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325353452013
                                         uncertainty =       0.003758750354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403296008
  error estimate for blocks of size 2^( 2) =       0.000415810484
  error estimate for blocks of size 2^( 3) =       0.000428567185
  error estimate for blocks of size 2^( 4) =       0.000440741941
  error estimate for blocks of size 2^( 5) =       0.000451708019
  error estimate for blocks of size 2^( 6) =       0.000461164766
  error estimate for blocks of size 2^( 7) =       0.000465090387

      target function =                  N/A
              le_mean =     -16.908534114059
             les_mean =     286.223821063577
             stat err =       0.000454676278
             autocorr =       1.271032766780
              std dev =       0.570346683992
             le_variance =       0.325295339941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908534114540        initial  <--
     3.7253e+03     3.7253e+04             1.2047e-06       -16.908534106842
     1.4901e+04     1.4901e+05             3.0119e-07       -16.908534110690
     5.9605e+04     5.9605e+05             7.5297e-08       -16.908534114059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1616
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918537e-02 1 1  ON 3
 uu_4                -6.325452e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592878e-01 1 1  ON 11
 ud_2                 6.036280e-02 1 1  ON 12
 ud_3                 1.859312e-03 1 1  ON 13
 ud_4                -5.685436e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062109e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050836e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108360e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825333e-02 1 1  ON 32
eH1_3                -3.745038e-02 1 1  ON 33
eH1_4                 1.200570e-02 1 1  ON 34
eH1_5                 4.478228e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097268e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726817e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332705e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.904
    reference variance = 0.241683
====================================================
  Execution time = 2.5607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329322438650
                                         uncertainty =       0.007247254289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329322438650
                                         uncertainty =       0.007247254289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405805091
  error estimate for blocks of size 2^( 2) =       0.000418458253
  error estimate for blocks of size 2^( 3) =       0.000431292760
  error estimate for blocks of size 2^( 4) =       0.000443574189
  error estimate for blocks of size 2^( 5) =       0.000454074372
  error estimate for blocks of size 2^( 6) =       0.000460325391
  error estimate for blocks of size 2^( 7) =       0.000464875967

      target function =                  N/A
              le_mean =     -16.908585125134
             les_mean =     286.229606313127
             stat err =       0.000455712480
             autocorr =       1.261092263433
              std dev =       0.573895063501
             le_variance =       0.329355543911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690858512513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908585125134       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908585126759       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908585128359       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908585129112       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908585129371       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908585129456       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908585129451       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908585129540       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908585129120       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908585128999       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.210820e-07

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908585125134       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908585125540       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908585125940       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908585126190       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908585126185       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908585125479       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908585126220       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908585126242       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908585126240       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908585126166       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 3.027064e-08

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908585125134       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908585125235       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908585125335       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908585125382       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908585125400       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908585125405       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908585125990       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908585125139       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908585124704       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908585124767       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 7.567668e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2285e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918536e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036280e-02 1 1  ON 12
 ud_3                 1.859299e-03 1 1  ON 13
 ud_4                -5.685435e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062109e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050834e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586990e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108360e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745038e-02 1 1  ON 33
eH1_4                 1.200571e-02 1 1  ON 34
eH1_5                 4.478228e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097268e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332705e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.871
    reference variance = 0.228297
====================================================
  Execution time = 2.5053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3140e-01
  Total weights = 2.0000e+06
  Execution time = 2.9633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453149345
                                         uncertainty =       0.004500575103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453149345
                                         uncertainty =       0.004500575103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407064986
  error estimate for blocks of size 2^( 2) =       0.000419969787
  error estimate for blocks of size 2^( 3) =       0.000433568416
  error estimate for blocks of size 2^( 4) =       0.000446692933
  error estimate for blocks of size 2^( 5) =       0.000459193411
  error estimate for blocks of size 2^( 6) =       0.000467604961
  error estimate for blocks of size 2^( 7) =       0.000476022726

      target function =                  N/A
              le_mean =     -16.908486081309
             les_mean =     286.228305202198
             stat err =       0.000462378508
             autocorr =       1.290231919483
              std dev =       0.575676824332
             le_variance =       0.331403806073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453107516
                                         uncertainty =       0.004500575359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453107516
                                         uncertainty =       0.004500575359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407064961
  error estimate for blocks of size 2^( 2) =       0.000419969757
  error estimate for blocks of size 2^( 3) =       0.000433568381
  error estimate for blocks of size 2^( 4) =       0.000446692896
  error estimate for blocks of size 2^( 5) =       0.000459193373
  error estimate for blocks of size 2^( 6) =       0.000467604924
  error estimate for blocks of size 2^( 7) =       0.000476022689

      target function =                  N/A
              le_mean =     -16.908486081522
             les_mean =     286.228305167494
             stat err =       0.000462378470
             autocorr =       1.290231873665
              std dev =       0.575676787952
             le_variance =       0.331403764187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453128430
                                         uncertainty =       0.004500575231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453128430
                                         uncertainty =       0.004500575231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407064973
  error estimate for blocks of size 2^( 2) =       0.000419969772
  error estimate for blocks of size 2^( 3) =       0.000433568398
  error estimate for blocks of size 2^( 4) =       0.000446692914
  error estimate for blocks of size 2^( 5) =       0.000459193392
  error estimate for blocks of size 2^( 6) =       0.000467604942
  error estimate for blocks of size 2^( 7) =       0.000476022708

      target function =                  N/A
              le_mean =     -16.908486081415
             les_mean =     286.228305184845
             stat err =       0.000462378489
             autocorr =       1.290231896562
              std dev =       0.575676806142
             le_variance =       0.331403785130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453146730
                                         uncertainty =       0.004500575119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453146730
                                         uncertainty =       0.004500575119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407064985
  error estimate for blocks of size 2^( 2) =       0.000419969785
  error estimate for blocks of size 2^( 3) =       0.000433568413
  error estimate for blocks of size 2^( 4) =       0.000446692931
  error estimate for blocks of size 2^( 5) =       0.000459193409
  error estimate for blocks of size 2^( 6) =       0.000467604958
  error estimate for blocks of size 2^( 7) =       0.000476022724

      target function =                  N/A
              le_mean =     -16.908486081322
             les_mean =     286.228305200029
             stat err =       0.000462378505
             autocorr =       1.290231916609
              std dev =       0.575676822058
             le_variance =       0.331403803455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908486081309        initial
     3.7253e+04     3.7253e+05             1.2108e-07       -16.908486081522  <--
     1.4901e+05     1.4901e+06             3.0271e-08       -16.908486081415
     5.9605e+05     5.9605e+06             7.5677e-09       -16.908486081322

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 3.9883e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.170321
====================================================
  Execution time = 2.5809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331328953987
                                         uncertainty =       0.004038354207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331328953987
                                         uncertainty =       0.004038354207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407068025
  error estimate for blocks of size 2^( 2) =       0.000419719677
  error estimate for blocks of size 2^( 3) =       0.000432735801
  error estimate for blocks of size 2^( 4) =       0.000445411066
  error estimate for blocks of size 2^( 5) =       0.000456042743
  error estimate for blocks of size 2^( 6) =       0.000464677167
  error estimate for blocks of size 2^( 7) =       0.000470512754

      target function =                  N/A
              le_mean =     -16.908332383035
             les_mean =     286.223112563894
             stat err =       0.000459160932
             autocorr =       1.272318604109
              std dev =       0.575681122160
             le_variance =       0.331408754412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690833238303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908332383035       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908332391225       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908332399076       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908332401967       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908332402657       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908332403296       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908332403536       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908332403460       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908332403540       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908332403495       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 4.779458e-07

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908332383035       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908332385082       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908332387045       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908332387766       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908332387942       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908332388116       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908332388152       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908332388175       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908332388165       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908332388045       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.194884e-07

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908332383035       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908332383547       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908332384037       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908332384218       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908332384316       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908332384345       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908332384484       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908332384097       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908332384240       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908332384345       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.987222e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2408e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392119e-01 1 1  ON 1
 uu_2                 4.170540e-02 1 1  ON 2
 uu_3                -1.918533e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117231e-01 1 1  ON 10
 ud_1                 1.592880e-01 1 1  ON 11
 ud_2                 6.036274e-02 1 1  ON 12
 ud_3                 1.859205e-03 1 1  ON 13
 ud_4                -5.685433e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062111e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050818e-02 1 1  ON 22
 eO_3                 2.701636e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825331e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200576e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481238e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291497e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726815e-02 1 1  ON 42
eH2_3                -3.643120e-02 1 1  ON 43
eH2_4                 1.332711e-02 1 1  ON 44
eH2_5                 4.799451e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8785
    reference variance = 0.266931
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3139e-01
  Total weights = 2.0000e+06
  Execution time = 2.9532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363363296
                                         uncertainty =       0.004186375909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363363296
                                         uncertainty =       0.004186375909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407059586
  error estimate for blocks of size 2^( 2) =       0.000419783750
  error estimate for blocks of size 2^( 3) =       0.000433627119
  error estimate for blocks of size 2^( 4) =       0.000446225869
  error estimate for blocks of size 2^( 5) =       0.000456971715
  error estimate for blocks of size 2^( 6) =       0.000465266979
  error estimate for blocks of size 2^( 7) =       0.000471092056

      target function =                  N/A
              le_mean =     -16.909258793678
             les_mean =     286.254427799556
             stat err =       0.000459889155
             autocorr =       1.276410482990
              std dev =       0.575669187703
             le_variance =       0.331395013670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363214646
                                         uncertainty =       0.004186382156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363214646
                                         uncertainty =       0.004186382156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407059495
  error estimate for blocks of size 2^( 2) =       0.000419783637
  error estimate for blocks of size 2^( 3) =       0.000433626988
  error estimate for blocks of size 2^( 4) =       0.000446225725
  error estimate for blocks of size 2^( 5) =       0.000456971567
  error estimate for blocks of size 2^( 6) =       0.000465266838
  error estimate for blocks of size 2^( 7) =       0.000471091907

      target function =                  N/A
              le_mean =     -16.909258790711
             les_mean =     286.254427550408
             stat err =       0.000459889009
             autocorr =       1.276410248377
              std dev =       0.575669058454
             le_variance =       0.331394864861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363288966
                                         uncertainty =       0.004186379033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363288966
                                         uncertainty =       0.004186379033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407059541
  error estimate for blocks of size 2^( 2) =       0.000419783694
  error estimate for blocks of size 2^( 3) =       0.000433627054
  error estimate for blocks of size 2^( 4) =       0.000446225797
  error estimate for blocks of size 2^( 5) =       0.000456971641
  error estimate for blocks of size 2^( 6) =       0.000465266909
  error estimate for blocks of size 2^( 7) =       0.000471091982

      target function =                  N/A
              le_mean =     -16.909258792195
             les_mean =     286.254427674970
             stat err =       0.000459889082
             autocorr =       1.276410365675
              std dev =       0.575669123074
             le_variance =       0.331394939261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363354005
                                         uncertainty =       0.004186376300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331363354005
                                         uncertainty =       0.004186376300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407059581
  error estimate for blocks of size 2^( 2) =       0.000419783743
  error estimate for blocks of size 2^( 3) =       0.000433627111
  error estimate for blocks of size 2^( 4) =       0.000446225860
  error estimate for blocks of size 2^( 5) =       0.000456971705
  error estimate for blocks of size 2^( 6) =       0.000465266971
  error estimate for blocks of size 2^( 7) =       0.000471092047

      target function =                  N/A
              le_mean =     -16.909258793493
             les_mean =     286.254427783982
             stat err =       0.000459889146
             autocorr =       1.276410468317
              std dev =       0.575669179624
             le_variance =       0.331395004369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909258793678        initial  <--
     9.3132e+03     9.3132e+04             4.7795e-07       -16.909258790711
     3.7253e+04     3.7253e+05             1.1949e-07       -16.909258792195
     1.4901e+05     1.4901e+06             2.9872e-08       -16.909258793493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0610
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9003
    reference variance = 0.160628
====================================================
  Execution time = 2.5754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328130821883
                                         uncertainty =       0.004827623067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328130821883
                                         uncertainty =       0.004827623067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404965983
  error estimate for blocks of size 2^( 2) =       0.000417429378
  error estimate for blocks of size 2^( 3) =       0.000430187808
  error estimate for blocks of size 2^( 4) =       0.000441754470
  error estimate for blocks of size 2^( 5) =       0.000451618010
  error estimate for blocks of size 2^( 6) =       0.000458833428
  error estimate for blocks of size 2^( 7) =       0.000462133429

      target function =                  N/A
              le_mean =     -16.910071687130
             les_mean =     286.278519195377
             stat err =       0.000453584834
             autocorr =       1.254526852903
              std dev =       0.572708386099
             le_variance =       0.327994895508


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691007168713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071687130       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071687919       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071688764       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071688985       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071689176       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071689138       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071689215       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910071689005       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910071689153       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910071689193       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 4.849942e-08

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071687130       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071687327       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071687538       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071687730       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071687523       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071687635       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071687589       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910071687534       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910071687482       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910071687564       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.212488e-08

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910071687130       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910071687179       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910071687232       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910071687246       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910071687253       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910071688161       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910071687226       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910071687037       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910071687030       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910071685339       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.031221e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2375e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859254e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050826e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.16986
====================================================
  Execution time = 2.4943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2394e-01
  Total weights = 2.0000e+06
  Execution time = 2.9550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027787746
                                         uncertainty =       0.002522547627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027787746
                                         uncertainty =       0.002522547627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402456708
  error estimate for blocks of size 2^( 2) =       0.000415318880
  error estimate for blocks of size 2^( 3) =       0.000428647105
  error estimate for blocks of size 2^( 4) =       0.000441799216
  error estimate for blocks of size 2^( 5) =       0.000452973233
  error estimate for blocks of size 2^( 6) =       0.000461778434
  error estimate for blocks of size 2^( 7) =       0.000465281384

      target function =                  N/A
              le_mean =     -16.908205977773
             les_mean =     286.211372027843
             stat err =       0.000455458067
             autocorr =       1.280732578566
              std dev =       0.569159734185
             le_variance =       0.323942803018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027769333
                                         uncertainty =       0.002522547611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027769333
                                         uncertainty =       0.002522547611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402456696
  error estimate for blocks of size 2^( 2) =       0.000415318867
  error estimate for blocks of size 2^( 3) =       0.000428647090
  error estimate for blocks of size 2^( 4) =       0.000441799200
  error estimate for blocks of size 2^( 5) =       0.000452973217
  error estimate for blocks of size 2^( 6) =       0.000461778418
  error estimate for blocks of size 2^( 7) =       0.000465281367

      target function =                  N/A
              le_mean =     -16.908205977703
             les_mean =     286.211372007046
             stat err =       0.000455458050
             autocorr =       1.280732558653
              std dev =       0.569159718003
             le_variance =       0.323942784597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027778540
                                         uncertainty =       0.002522547619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027778540
                                         uncertainty =       0.002522547619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402456702
  error estimate for blocks of size 2^( 2) =       0.000415318874
  error estimate for blocks of size 2^( 3) =       0.000428647097
  error estimate for blocks of size 2^( 4) =       0.000441799208
  error estimate for blocks of size 2^( 5) =       0.000452973225
  error estimate for blocks of size 2^( 6) =       0.000461778426
  error estimate for blocks of size 2^( 7) =       0.000465281376

      target function =                  N/A
              le_mean =     -16.908205977738
             les_mean =     286.211372017444
             stat err =       0.000455458059
             autocorr =       1.280732568607
              std dev =       0.569159726094
             le_variance =       0.323942793808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027786595
                                         uncertainty =       0.002522547626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027786595
                                         uncertainty =       0.002522547626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402456707
  error estimate for blocks of size 2^( 2) =       0.000415318879
  error estimate for blocks of size 2^( 3) =       0.000428647104
  error estimate for blocks of size 2^( 4) =       0.000441799215
  error estimate for blocks of size 2^( 5) =       0.000452973232
  error estimate for blocks of size 2^( 6) =       0.000461778433
  error estimate for blocks of size 2^( 7) =       0.000465281383

      target function =                  N/A
              le_mean =     -16.908205977769
             les_mean =     286.211372026543
             stat err =       0.000455458066
             autocorr =       1.280732577315
              std dev =       0.569159733174
             le_variance =       0.323942801867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908205977773        initial  <--
     9.3132e+04     9.3132e+05             4.8499e-08       -16.908205977703
     3.7253e+05     3.7253e+06             1.2125e-08       -16.908205977738
     1.4901e+06     1.4901e+07             3.0312e-09       -16.908205977769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7812
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.226981
====================================================
  Execution time = 2.5644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382840279
                                         uncertainty =       0.005981628810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382840279
                                         uncertainty =       0.005981628810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407719706
  error estimate for blocks of size 2^( 2) =       0.000420162517
  error estimate for blocks of size 2^( 3) =       0.000432607240
  error estimate for blocks of size 2^( 4) =       0.000445148152
  error estimate for blocks of size 2^( 5) =       0.000456350483
  error estimate for blocks of size 2^( 6) =       0.000463287260
  error estimate for blocks of size 2^( 7) =       0.000466845861

      target function =                  N/A
              le_mean =     -16.909219525466
             les_mean =     286.254175512305
             stat err =       0.000457907939
             autocorr =       1.261342242465
              std dev =       0.576602738567
             le_variance =       0.332470718123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690921952547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909219525466       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909219525530       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909219525621       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909219525650       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909219525661       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909219526210       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909219525336       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909219525730       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909219525317       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909219524919       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 4.728859e-09

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909219525466       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909219525482       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909219525505       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909219525879       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909219524968       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909219527844       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909219524667       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909219522991       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909219527752       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909219524285       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.182215e-09

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909219525466       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909219525470       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909219525476       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909219527425       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909219526211       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909219527219       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909219528564       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909219519202       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909219536742       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909219526780       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.955536e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2334e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859258e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8532
    reference variance = 0.65626
====================================================
  Execution time = 2.5057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2961e-01
  Total weights = 2.0000e+06
  Execution time = 2.9538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657309521
                                         uncertainty =       0.005208780556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657309521
                                         uncertainty =       0.005208780556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964993
  error estimate for blocks of size 2^( 2) =       0.000418827299
  error estimate for blocks of size 2^( 3) =       0.000431549200
  error estimate for blocks of size 2^( 4) =       0.000443730630
  error estimate for blocks of size 2^( 5) =       0.000453765115
  error estimate for blocks of size 2^( 6) =       0.000459113506
  error estimate for blocks of size 2^( 7) =       0.000463219844

      target function =                  N/A
              le_mean =     -16.909047032872
             les_mean =     286.245486545508
             stat err =       0.000454957274
             autocorr =       1.255926013052
              std dev =       0.574121198380
             le_variance =       0.329615150430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657307843
                                         uncertainty =       0.005208780572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657307843
                                         uncertainty =       0.005208780572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964992
  error estimate for blocks of size 2^( 2) =       0.000418827298
  error estimate for blocks of size 2^( 3) =       0.000431549199
  error estimate for blocks of size 2^( 4) =       0.000443730629
  error estimate for blocks of size 2^( 5) =       0.000453765113
  error estimate for blocks of size 2^( 6) =       0.000459113504
  error estimate for blocks of size 2^( 7) =       0.000463219843

      target function =                  N/A
              le_mean =     -16.909047032855
             les_mean =     286.245486543253
             stat err =       0.000454957272
             autocorr =       1.255926011055
              std dev =       0.574121196918
             le_variance =       0.329615148751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657308682
                                         uncertainty =       0.005208780564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657308682
                                         uncertainty =       0.005208780564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964992
  error estimate for blocks of size 2^( 2) =       0.000418827299
  error estimate for blocks of size 2^( 3) =       0.000431549199
  error estimate for blocks of size 2^( 4) =       0.000443730629
  error estimate for blocks of size 2^( 5) =       0.000453765114
  error estimate for blocks of size 2^( 6) =       0.000459113505
  error estimate for blocks of size 2^( 7) =       0.000463219843

      target function =                  N/A
              le_mean =     -16.909047032864
             les_mean =     286.245486544380
             stat err =       0.000454957273
             autocorr =       1.255926012055
              std dev =       0.574121197649
             le_variance =       0.329615149590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657309416
                                         uncertainty =       0.005208780557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329657309416
                                         uncertainty =       0.005208780557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964993
  error estimate for blocks of size 2^( 2) =       0.000418827299
  error estimate for blocks of size 2^( 3) =       0.000431549200
  error estimate for blocks of size 2^( 4) =       0.000443730630
  error estimate for blocks of size 2^( 5) =       0.000453765115
  error estimate for blocks of size 2^( 6) =       0.000459113506
  error estimate for blocks of size 2^( 7) =       0.000463219844

      target function =                  N/A
              le_mean =     -16.909047032871
             les_mean =     286.245486545367
             stat err =       0.000454957274
             autocorr =       1.255926012928
              std dev =       0.574121198289
             le_variance =       0.329615150324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909047032872        initial  <--
     9.3132e+05     9.3132e+06             4.7289e-09       -16.909047032855
     3.7253e+06     3.7253e+07             1.1822e-09       -16.909047032864
     1.4901e+07     1.4901e+08             2.9555e-10       -16.909047032871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7347
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9739
    reference variance = 0.189916
====================================================
  Execution time = 2.5883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2807e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328171049835
                                         uncertainty =       0.003494872242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328171049835
                                         uncertainty =       0.003494872242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405009539
  error estimate for blocks of size 2^( 2) =       0.000417968806
  error estimate for blocks of size 2^( 3) =       0.000431198599
  error estimate for blocks of size 2^( 4) =       0.000444242097
  error estimate for blocks of size 2^( 5) =       0.000455475266
  error estimate for blocks of size 2^( 6) =       0.000464312678
  error estimate for blocks of size 2^( 7) =       0.000469564889

      target function =                  N/A
              le_mean =     -16.909447562671
             les_mean =     286.257482164153
             stat err =       0.000458398733
             autocorr =       1.281021185735
              std dev =       0.572769983040
             le_variance =       0.328065453472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690944756267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909447562671       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909447562677       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909447562684       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909447562687       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909447564701       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909447563795       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909447567383       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909447564619       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909447558245       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909447562098       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 4.896807e-10

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909447562671       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909447562672       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909447562674       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909447558990       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909447558152       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909447564979       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909447514333       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909447554858       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909447552382       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909447554679       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.224206e-10

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909447562671       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909447562671       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909447562672       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909447457470       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909447562672       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909447524662       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909447589007       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909447651514       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909447538334       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909447646542       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 3.060488e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2506e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8593
    reference variance = 0.210573
====================================================
  Execution time = 2.5138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.0000e+06
  Execution time = 2.9561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492126
                                         uncertainty =       0.007084509473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492126
                                         uncertainty =       0.007084509473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918481
  error estimate for blocks of size 2^( 2) =       0.000424155808
  error estimate for blocks of size 2^( 3) =       0.000437031142
  error estimate for blocks of size 2^( 4) =       0.000449000240
  error estimate for blocks of size 2^( 5) =       0.000459159407
  error estimate for blocks of size 2^( 6) =       0.000466254637
  error estimate for blocks of size 2^( 7) =       0.000468327662

      target function =                  N/A
              le_mean =     -16.909394149041
             les_mean =     286.266963987718
             stat err =       0.000460685487
             autocorr =       1.250796065566
              std dev =       0.582540702255
             le_variance =       0.339353669783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481491953
                                         uncertainty =       0.007084509471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481491953
                                         uncertainty =       0.007084509471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918481
  error estimate for blocks of size 2^( 2) =       0.000424155808
  error estimate for blocks of size 2^( 3) =       0.000437031142
  error estimate for blocks of size 2^( 4) =       0.000449000240
  error estimate for blocks of size 2^( 5) =       0.000459159407
  error estimate for blocks of size 2^( 6) =       0.000466254637
  error estimate for blocks of size 2^( 7) =       0.000468327662

      target function =                  N/A
              le_mean =     -16.909394149038
             les_mean =     286.266963987463
             stat err =       0.000460685486
             autocorr =       1.250796065330
              std dev =       0.582540702106
             le_variance =       0.339353669610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492039
                                         uncertainty =       0.007084509472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492039
                                         uncertainty =       0.007084509472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918481
  error estimate for blocks of size 2^( 2) =       0.000424155808
  error estimate for blocks of size 2^( 3) =       0.000437031142
  error estimate for blocks of size 2^( 4) =       0.000449000240
  error estimate for blocks of size 2^( 5) =       0.000459159407
  error estimate for blocks of size 2^( 6) =       0.000466254637
  error estimate for blocks of size 2^( 7) =       0.000468327662

      target function =                  N/A
              le_mean =     -16.909394149039
             les_mean =     286.266963987590
             stat err =       0.000460685486
             autocorr =       1.250796065454
              std dev =       0.582540702180
             le_variance =       0.339353669697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492115
                                         uncertainty =       0.007084509473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339481492115
                                         uncertainty =       0.007084509473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918481
  error estimate for blocks of size 2^( 2) =       0.000424155808
  error estimate for blocks of size 2^( 3) =       0.000437031142
  error estimate for blocks of size 2^( 4) =       0.000449000240
  error estimate for blocks of size 2^( 5) =       0.000459159407
  error estimate for blocks of size 2^( 6) =       0.000466254637
  error estimate for blocks of size 2^( 7) =       0.000468327662

      target function =                  N/A
              le_mean =     -16.909394149041
             les_mean =     286.266963987702
             stat err =       0.000460685487
             autocorr =       1.250796065554
              std dev =       0.582540702245
             le_variance =       0.339353669773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909394149041        initial  <--
     9.3132e+06     9.3132e+07             4.8968e-10       -16.909394149038
     3.7253e+07     3.7253e+08             1.2242e-10       -16.909394149039
     1.4901e+08     1.4901e+09             3.0605e-11       -16.909394149041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9630
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9948
    reference variance = 0.464146
====================================================
  Execution time = 2.5407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324790152556
                                         uncertainty =       0.003528600780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324790152556
                                         uncertainty =       0.003528600780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402893593
  error estimate for blocks of size 2^( 2) =       0.000415568170
  error estimate for blocks of size 2^( 3) =       0.000428601072
  error estimate for blocks of size 2^( 4) =       0.000440945706
  error estimate for blocks of size 2^( 5) =       0.000451386464
  error estimate for blocks of size 2^( 6) =       0.000458362880
  error estimate for blocks of size 2^( 7) =       0.000461970897

      target function =                  N/A
              le_mean =     -16.909368709979
             les_mean =     286.251396502789
             stat err =       0.000453166486
             autocorr =       1.265129102337
              std dev =       0.569777583875
             le_variance =       0.324646495086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690936870998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909368709979       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909368709980       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909368709981       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909368709981       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909368745514       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909368744188       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909368782760       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909368705651       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909368701386       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909368625939       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 4.869411e-11

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909368709979       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909368709979       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909368709980       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909368709980       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909368603479       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909368213904       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909368681938       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909368659728       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909368743624       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909368874087       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.217376e-11

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909368709979       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909368709979       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909368709979       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909368527242       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909369190054       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909368446466       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909368093533       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909369082872       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909369274198       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909371562209       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 3.042546e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2024e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8521
    reference variance = 0.178161
====================================================
  Execution time = 2.5104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2776e-01
  Total weights = 2.0000e+06
  Execution time = 2.9828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468080
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468080
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404822234
  error estimate for blocks of size 2^( 2) =       0.000417321767
  error estimate for blocks of size 2^( 3) =       0.000430188696
  error estimate for blocks of size 2^( 4) =       0.000442688816
  error estimate for blocks of size 2^( 5) =       0.000453413060
  error estimate for blocks of size 2^( 6) =       0.000459615546
  error estimate for blocks of size 2^( 7) =       0.000463934572

      target function =                  N/A
              le_mean =     -16.908965737423
             les_mean =     286.240884227470
             stat err =       0.000454912998
             autocorr =       1.262780825209
              std dev =       0.572505093431
             le_variance =       0.327762082005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468062
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468062
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404822234
  error estimate for blocks of size 2^( 2) =       0.000417321767
  error estimate for blocks of size 2^( 3) =       0.000430188696
  error estimate for blocks of size 2^( 4) =       0.000442688816
  error estimate for blocks of size 2^( 5) =       0.000453413060
  error estimate for blocks of size 2^( 6) =       0.000459615546
  error estimate for blocks of size 2^( 7) =       0.000463934572

      target function =                  N/A
              le_mean =     -16.908965737423
             les_mean =     286.240884227460
             stat err =       0.000454912998
             autocorr =       1.262780825194
              std dev =       0.572505093415
             le_variance =       0.327762081986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468071
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468071
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404822234
  error estimate for blocks of size 2^( 2) =       0.000417321767
  error estimate for blocks of size 2^( 3) =       0.000430188696
  error estimate for blocks of size 2^( 4) =       0.000442688816
  error estimate for blocks of size 2^( 5) =       0.000453413060
  error estimate for blocks of size 2^( 6) =       0.000459615546
  error estimate for blocks of size 2^( 7) =       0.000463934572

      target function =                  N/A
              le_mean =     -16.908965737423
             les_mean =     286.240884227465
             stat err =       0.000454912998
             autocorr =       1.262780825199
              std dev =       0.572505093423
             le_variance =       0.327762081995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468079
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327728468079
                                         uncertainty =       0.003592189586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404822234
  error estimate for blocks of size 2^( 2) =       0.000417321767
  error estimate for blocks of size 2^( 3) =       0.000430188696
  error estimate for blocks of size 2^( 4) =       0.000442688816
  error estimate for blocks of size 2^( 5) =       0.000453413060
  error estimate for blocks of size 2^( 6) =       0.000459615546
  error estimate for blocks of size 2^( 7) =       0.000463934572

      target function =                  N/A
              le_mean =     -16.908965737423
             les_mean =     286.240884227470
             stat err =       0.000454912998
             autocorr =       1.262780825217
              std dev =       0.572505093430
             le_variance =       0.327762082003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908965737423        initial
     9.3132e+07     9.3132e+08             4.8694e-11       -16.908965737423  <--
     3.7253e+08     3.7253e+09             1.2174e-11       -16.908965737423
     1.4901e+09     1.4901e+10             3.0425e-12       -16.908965737423

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 3.9974e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8957
    reference variance = 0.167333
====================================================
  Execution time = 2.5476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334196376630
                                         uncertainty =       0.006774191308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334196376630
                                         uncertainty =       0.006774191308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408734512
  error estimate for blocks of size 2^( 2) =       0.000421007511
  error estimate for blocks of size 2^( 3) =       0.000434197516
  error estimate for blocks of size 2^( 4) =       0.000446557857
  error estimate for blocks of size 2^( 5) =       0.000457872044
  error estimate for blocks of size 2^( 6) =       0.000463997095
  error estimate for blocks of size 2^( 7) =       0.000468829428

      target function =                  N/A
              le_mean =     -16.909241109445
             les_mean =     286.256562533645
             stat err =       0.000459314106
             autocorr =       1.262806900836
              std dev =       0.578037890929
             le_variance =       0.334127803349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690924110945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241109445       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241109448       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241109451       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241109451       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241118276       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241115893       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241108819       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241112660       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909241107064       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909241140897       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.918924e-10

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241109445       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241109446       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241109447       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241109447       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241161557       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241121694       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241135561       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241237025       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909241132375       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909241188393       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 4.797232e-11

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241109445       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241109446       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241109446       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241109446       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241109446       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241155468       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241041577       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241048539       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909241118159       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909241282523       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.199333e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2033e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8939
    reference variance = 0.176459
====================================================
  Execution time = 2.4871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4135e-01
  Total weights = 2.0000e+06
  Execution time = 2.9472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033218
                                         uncertainty =       0.010193173524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033218
                                         uncertainty =       0.010193173524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413129772
  error estimate for blocks of size 2^( 2) =       0.000425790192
  error estimate for blocks of size 2^( 3) =       0.000439211074
  error estimate for blocks of size 2^( 4) =       0.000452181231
  error estimate for blocks of size 2^( 5) =       0.000463457960
  error estimate for blocks of size 2^( 6) =       0.000470701327
  error estimate for blocks of size 2^( 7) =       0.000474492507

      target function =                  N/A
              le_mean =     -16.909190454675
             les_mean =     286.262074078463
             stat err =       0.000465208256
             autocorr =       1.268007555141
              std dev =       0.584253726278
             le_variance =       0.341352416669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033139
                                         uncertainty =       0.010193173520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033139
                                         uncertainty =       0.010193173520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413129772
  error estimate for blocks of size 2^( 2) =       0.000425790192
  error estimate for blocks of size 2^( 3) =       0.000439211074
  error estimate for blocks of size 2^( 4) =       0.000452181231
  error estimate for blocks of size 2^( 5) =       0.000463457960
  error estimate for blocks of size 2^( 6) =       0.000470701326
  error estimate for blocks of size 2^( 7) =       0.000474492507

      target function =                  N/A
              le_mean =     -16.909190454675
             les_mean =     286.262074078371
             stat err =       0.000465208256
             autocorr =       1.268007555063
              std dev =       0.584253726210
             le_variance =       0.341352416591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033178
                                         uncertainty =       0.010193173522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033178
                                         uncertainty =       0.010193173522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413129772
  error estimate for blocks of size 2^( 2) =       0.000425790192
  error estimate for blocks of size 2^( 3) =       0.000439211074
  error estimate for blocks of size 2^( 4) =       0.000452181231
  error estimate for blocks of size 2^( 5) =       0.000463457960
  error estimate for blocks of size 2^( 6) =       0.000470701326
  error estimate for blocks of size 2^( 7) =       0.000474492507

      target function =                  N/A
              le_mean =     -16.909190454675
             les_mean =     286.262074078417
             stat err =       0.000465208256
             autocorr =       1.268007555102
              std dev =       0.584253726244
             le_variance =       0.341352416630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033213
                                         uncertainty =       0.010193173524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446033213
                                         uncertainty =       0.010193173524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413129772
  error estimate for blocks of size 2^( 2) =       0.000425790192
  error estimate for blocks of size 2^( 3) =       0.000439211074
  error estimate for blocks of size 2^( 4) =       0.000452181231
  error estimate for blocks of size 2^( 5) =       0.000463457960
  error estimate for blocks of size 2^( 6) =       0.000470701327
  error estimate for blocks of size 2^( 7) =       0.000474492507

      target function =                  N/A
              le_mean =     -16.909190454675
             les_mean =     286.262074078457
             stat err =       0.000465208256
             autocorr =       1.268007555139
              std dev =       0.584253726273
             le_variance =       0.341352416664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909190454675        initial  <--
     2.3283e+07     2.3283e+08             1.9189e-10       -16.909190454675
     9.3132e+07     9.3132e+08             4.7972e-11       -16.909190454675
     3.7253e+08     3.7253e+09             1.1993e-11       -16.909190454675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.6508
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.928
    reference variance = 0.154534
====================================================
  Execution time = 2.5492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2498e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325111546552
                                         uncertainty =       0.003733599492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325111546552
                                         uncertainty =       0.003733599492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403103353
  error estimate for blocks of size 2^( 2) =       0.000416248921
  error estimate for blocks of size 2^( 3) =       0.000429995716
  error estimate for blocks of size 2^( 4) =       0.000443060259
  error estimate for blocks of size 2^( 5) =       0.000453978182
  error estimate for blocks of size 2^( 6) =       0.000463634287
  error estimate for blocks of size 2^( 7) =       0.000467995407

      target function =                  N/A
              le_mean =     -16.909335760425
             les_mean =     286.250620323338
             stat err =       0.000457167034
             autocorr =       1.286225129483
              std dev =       0.570074229419
             le_variance =       0.324984627047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690933576042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335760425       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335760425       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909335760425       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909335760426       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909335760426       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909335708614       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909335807266       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909335754785       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909335755075       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909335754080       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.921592e-11

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335760425       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335760425       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909335760425       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909335678688       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909335593760       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909335976708       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909335536764       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909336457199       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909336566045       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909335458708       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 4.803336e-12

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335760425       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335760425       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909335760425       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909335760425       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909336035229       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909336375176       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909333572847       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909335488375       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909340848413       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909337546928       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 1.200698e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2123e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.40361
====================================================
  Execution time = 2.5097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2788e-01
  Total weights = 2.0000e+06
  Execution time = 2.9412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156235
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156235
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404893202
  error estimate for blocks of size 2^( 2) =       0.000417592425
  error estimate for blocks of size 2^( 3) =       0.000430845711
  error estimate for blocks of size 2^( 4) =       0.000443279862
  error estimate for blocks of size 2^( 5) =       0.000453584096
  error estimate for blocks of size 2^( 6) =       0.000461680221
  error estimate for blocks of size 2^( 7) =       0.000469632349

      target function =                  N/A
              le_mean =     -16.908949539289
             les_mean =     286.240451368135
             stat err =       0.000457044132
             autocorr =       1.274193263904
              std dev =       0.572605457417
             le_variance =       0.327877009864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156228
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156228
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404893202
  error estimate for blocks of size 2^( 2) =       0.000417592425
  error estimate for blocks of size 2^( 3) =       0.000430845711
  error estimate for blocks of size 2^( 4) =       0.000443279862
  error estimate for blocks of size 2^( 5) =       0.000453584096
  error estimate for blocks of size 2^( 6) =       0.000461680221
  error estimate for blocks of size 2^( 7) =       0.000469632349

      target function =                  N/A
              le_mean =     -16.908949539289
             les_mean =     286.240451368130
             stat err =       0.000457044132
             autocorr =       1.274193263900
              std dev =       0.572605457411
             le_variance =       0.327877009857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156232
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156232
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404893202
  error estimate for blocks of size 2^( 2) =       0.000417592425
  error estimate for blocks of size 2^( 3) =       0.000430845711
  error estimate for blocks of size 2^( 4) =       0.000443279862
  error estimate for blocks of size 2^( 5) =       0.000453584096
  error estimate for blocks of size 2^( 6) =       0.000461680221
  error estimate for blocks of size 2^( 7) =       0.000469632349

      target function =                  N/A
              le_mean =     -16.908949539289
             les_mean =     286.240451368133
             stat err =       0.000457044132
             autocorr =       1.274193263902
              std dev =       0.572605457414
             le_variance =       0.327877009861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156235
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327935156235
                                         uncertainty =       0.003668550321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404893202
  error estimate for blocks of size 2^( 2) =       0.000417592425
  error estimate for blocks of size 2^( 3) =       0.000430845711
  error estimate for blocks of size 2^( 4) =       0.000443279862
  error estimate for blocks of size 2^( 5) =       0.000453584096
  error estimate for blocks of size 2^( 6) =       0.000461680221
  error estimate for blocks of size 2^( 7) =       0.000469632349

      target function =                  N/A
              le_mean =     -16.908949539289
             les_mean =     286.240451368135
             stat err =       0.000457044132
             autocorr =       1.274193263910
              std dev =       0.572605457417
             le_variance =       0.327877009864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908949539289        initial
     2.3283e+08     2.3283e+09             1.9216e-11       -16.908949539289  <--
     9.3132e+08     9.3132e+09             4.8033e-12       -16.908949539289
     3.7253e+09     3.7253e+10             1.2007e-12       -16.908949539289

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 4.3227e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8879
    reference variance = 0.151934
====================================================
  Execution time = 2.5930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3076e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330785019138
                                         uncertainty =       0.008622566767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330785019138
                                         uncertainty =       0.008622566767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406669322
  error estimate for blocks of size 2^( 2) =       0.000419890572
  error estimate for blocks of size 2^( 3) =       0.000434092926
  error estimate for blocks of size 2^( 4) =       0.000447198860
  error estimate for blocks of size 2^( 5) =       0.000459077980
  error estimate for blocks of size 2^( 6) =       0.000468039207
  error estimate for blocks of size 2^( 7) =       0.000473150559

      target function =                  N/A
              le_mean =     -16.908705005497
             les_mean =     286.235064672200
             stat err =       0.000461866652
             autocorr =       1.289883206446
              std dev =       0.575117270343
             le_variance =       0.330759874647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690870500550e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705005497       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705005499       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705005500       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705005500       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908705005015       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908704997547       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908705014292       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908705000360       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908704989614       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908704982429       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 7.746170e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705005497       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705005498       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705005498       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705005498       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908704945447       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908705020548       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908705042077       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908704968416       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908705061750       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908704808174       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.936537e-11

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908705005497       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908705005497       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908705005498       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908705005498       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908705013940       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908705712963       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908706014487       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908706181846       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908705082850       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908705266205       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 4.840462e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2544e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9531
    reference variance = 0.29741
====================================================
  Execution time = 2.5009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.2422e-01
  Total weights = 2.0000e+06
  Execution time = 2.9554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350129
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350129
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402630344
  error estimate for blocks of size 2^( 2) =       0.000415907667
  error estimate for blocks of size 2^( 3) =       0.000429236557
  error estimate for blocks of size 2^( 4) =       0.000442114727
  error estimate for blocks of size 2^( 5) =       0.000453371693
  error estimate for blocks of size 2^( 6) =       0.000459440861
  error estimate for blocks of size 2^( 7) =       0.000462389935

      target function =                  N/A
              le_mean =     -16.908391188309
             les_mean =     286.217914802360
             stat err =       0.000454329304
             autocorr =       1.273293418861
              std dev =       0.569405292906
             le_variance =       0.324222387590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350104
                                         uncertainty =       0.005233987831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350104
                                         uncertainty =       0.005233987831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402630344
  error estimate for blocks of size 2^( 2) =       0.000415907667
  error estimate for blocks of size 2^( 3) =       0.000429236557
  error estimate for blocks of size 2^( 4) =       0.000442114727
  error estimate for blocks of size 2^( 5) =       0.000453371693
  error estimate for blocks of size 2^( 6) =       0.000459440860
  error estimate for blocks of size 2^( 7) =       0.000462389935

      target function =                  N/A
              le_mean =     -16.908391188309
             les_mean =     286.217914802338
             stat err =       0.000454329304
             autocorr =       1.273293418832
              std dev =       0.569405292884
             le_variance =       0.324222387564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350116
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350116
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402630344
  error estimate for blocks of size 2^( 2) =       0.000415907667
  error estimate for blocks of size 2^( 3) =       0.000429236557
  error estimate for blocks of size 2^( 4) =       0.000442114727
  error estimate for blocks of size 2^( 5) =       0.000453371693
  error estimate for blocks of size 2^( 6) =       0.000459440860
  error estimate for blocks of size 2^( 7) =       0.000462389935

      target function =                  N/A
              le_mean =     -16.908391188309
             les_mean =     286.217914802349
             stat err =       0.000454329304
             autocorr =       1.273293418855
              std dev =       0.569405292895
             le_variance =       0.324222387577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350127
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324284350127
                                         uncertainty =       0.005233987830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402630344
  error estimate for blocks of size 2^( 2) =       0.000415907667
  error estimate for blocks of size 2^( 3) =       0.000429236557
  error estimate for blocks of size 2^( 4) =       0.000442114727
  error estimate for blocks of size 2^( 5) =       0.000453371693
  error estimate for blocks of size 2^( 6) =       0.000459440861
  error estimate for blocks of size 2^( 7) =       0.000462389935

      target function =                  N/A
              le_mean =     -16.908391188309
             les_mean =     286.217914802359
             stat err =       0.000454329304
             autocorr =       1.273293418856
              std dev =       0.569405292905
             le_variance =       0.324222387588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908391188309        initial
     5.8208e+07     5.8208e+08             7.7462e-11       -16.908391188309  <--
     2.3283e+08     2.3283e+09             1.9365e-11       -16.908391188309
     9.3132e+08     9.3132e+09             4.8405e-12       -16.908391188309

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 3.9881e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.319438
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2456e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324368322332
                                         uncertainty =       0.003123452292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324368322332
                                         uncertainty =       0.003123452292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839551
  error estimate for blocks of size 2^( 2) =       0.000416021235
  error estimate for blocks of size 2^( 3) =       0.000429414615
  error estimate for blocks of size 2^( 4) =       0.000443140828
  error estimate for blocks of size 2^( 5) =       0.000455343907
  error estimate for blocks of size 2^( 6) =       0.000465723733
  error estimate for blocks of size 2^( 7) =       0.000472396892

      target function =                  N/A
              le_mean =     -16.908761056945
             les_mean =     286.230759726299
             stat err =       0.000459151340
             autocorr =       1.299114727268
              std dev =       0.569701156495
             le_variance =       0.324559407711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690876105695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908761056945       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908761056950       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908761056956       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908761066852       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908761059917       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908761049726       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908761041226       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908761082520       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908761057427       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908761049949       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 3.058430e-10

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908761056945       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908761056946       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908761056948       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908761068046       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908761054666       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908761024713       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908761019017       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908761076633       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908761069921       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908761073089       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 7.646077e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908761056945       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908761056946       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908761056946       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908761056301       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908761067301       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908761036140       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908761158476       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908761058801       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908761327515       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908761078726       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.911469e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1990e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9229
    reference variance = 0.21925
====================================================
  Execution time = 2.4900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3190e-01
  Total weights = 2.0000e+06
  Execution time = 2.9506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628611
                                         uncertainty =       0.005218968444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628611
                                         uncertainty =       0.005218968444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407368887
  error estimate for blocks of size 2^( 2) =       0.000420074838
  error estimate for blocks of size 2^( 3) =       0.000433335735
  error estimate for blocks of size 2^( 4) =       0.000445228522
  error estimate for blocks of size 2^( 5) =       0.000456930088
  error estimate for blocks of size 2^( 6) =       0.000464619367
  error estimate for blocks of size 2^( 7) =       0.000471177387

      target function =                  N/A
              le_mean =     -16.908820475531
             les_mean =     286.240108527338
             stat err =       0.000459488841
             autocorr =       1.272255171980
              std dev =       0.576106604331
             le_variance =       0.331898819554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628503
                                         uncertainty =       0.005218968446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628503
                                         uncertainty =       0.005218968446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407368887
  error estimate for blocks of size 2^( 2) =       0.000420074838
  error estimate for blocks of size 2^( 3) =       0.000433335735
  error estimate for blocks of size 2^( 4) =       0.000445228522
  error estimate for blocks of size 2^( 5) =       0.000456930088
  error estimate for blocks of size 2^( 6) =       0.000464619367
  error estimate for blocks of size 2^( 7) =       0.000471177387

      target function =                  N/A
              le_mean =     -16.908820475532
             les_mean =     286.240108527253
             stat err =       0.000459488841
             autocorr =       1.272255171883
              std dev =       0.576106604237
             le_variance =       0.331898819446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628557
                                         uncertainty =       0.005218968445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628557
                                         uncertainty =       0.005218968445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407368887
  error estimate for blocks of size 2^( 2) =       0.000420074838
  error estimate for blocks of size 2^( 3) =       0.000433335735
  error estimate for blocks of size 2^( 4) =       0.000445228522
  error estimate for blocks of size 2^( 5) =       0.000456930088
  error estimate for blocks of size 2^( 6) =       0.000464619367
  error estimate for blocks of size 2^( 7) =       0.000471177387

      target function =                  N/A
              le_mean =     -16.908820475531
             les_mean =     286.240108527295
             stat err =       0.000459488841
             autocorr =       1.272255171939
              std dev =       0.576106604284
             le_variance =       0.331898819500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628605
                                         uncertainty =       0.005218968444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057628605
                                         uncertainty =       0.005218968444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407368887
  error estimate for blocks of size 2^( 2) =       0.000420074838
  error estimate for blocks of size 2^( 3) =       0.000433335735
  error estimate for blocks of size 2^( 4) =       0.000445228522
  error estimate for blocks of size 2^( 5) =       0.000456930088
  error estimate for blocks of size 2^( 6) =       0.000464619367
  error estimate for blocks of size 2^( 7) =       0.000471177387

      target function =                  N/A
              le_mean =     -16.908820475531
             les_mean =     286.240108527333
             stat err =       0.000459488841
             autocorr =       1.272255171976
              std dev =       0.576106604326
             le_variance =       0.331898819548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908820475531        initial
     1.4552e+07     1.4552e+08             3.0584e-10       -16.908820475532  <--
     5.8208e+07     5.8208e+08             7.6461e-11       -16.908820475531
     2.3283e+08     2.3283e+09             1.9115e-11       -16.908820475531

*****************************************************************************
Applying the update for shift_i =   1.4552e+07     and shift_s =   1.4552e+08
*****************************************************************************

  Execution time = 3.9669e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859259e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8932
    reference variance = 0.204278
====================================================
  Execution time = 2.5379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.5476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354869476709
                                         uncertainty =       0.026063497608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354869476709
                                         uncertainty =       0.026063497608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421165097
  error estimate for blocks of size 2^( 2) =       0.000433562856
  error estimate for blocks of size 2^( 3) =       0.000446667290
  error estimate for blocks of size 2^( 4) =       0.000459215218
  error estimate for blocks of size 2^( 5) =       0.000471060761
  error estimate for blocks of size 2^( 6) =       0.000480306747
  error estimate for blocks of size 2^( 7) =       0.000487133434

      target function =                  N/A
              le_mean =     -16.908042096274
             les_mean =     286.236647429532
             stat err =       0.000474429040
             autocorr =       1.268930347147
              std dev =       0.595617391903
             le_variance =       0.354760077537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690804209627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908042096274       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908042096289       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908042096305       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908042097035       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908042096306       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908042099462       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908042097360       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908042097111       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908042096832       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908042102223       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.249208e-09

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908042096274       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908042096278       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908042096282       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908042095921       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908042096986       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908042106474       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908042101689       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908042093814       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908042090853       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908042105555       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 3.123020e-10

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908042096274       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908042096275       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908042096276       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908042096329       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908042057169       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908042122008       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908042128601       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908042088862       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908042101079       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908042075473       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 7.807553e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2059e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859258e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.200159
====================================================
  Execution time = 2.5019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2213e-01
  Total weights = 2.0000e+06
  Execution time = 2.9586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114858
                                         uncertainty =       0.002690078277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114858
                                         uncertainty =       0.002690078277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401331802
  error estimate for blocks of size 2^( 2) =       0.000414686562
  error estimate for blocks of size 2^( 3) =       0.000428054170
  error estimate for blocks of size 2^( 4) =       0.000441177312
  error estimate for blocks of size 2^( 5) =       0.000451963135
  error estimate for blocks of size 2^( 6) =       0.000460393990
  error estimate for blocks of size 2^( 7) =       0.000465310394

      target function =                  N/A
              le_mean =     -16.908972435089
             les_mean =     286.235483080785
             stat err =       0.000454711208
             autocorr =       1.283701847729
              std dev =       0.567568877993
             le_variance =       0.322134431266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114411
                                         uncertainty =       0.002690078275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114411
                                         uncertainty =       0.002690078275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401331802
  error estimate for blocks of size 2^( 2) =       0.000414686562
  error estimate for blocks of size 2^( 3) =       0.000428054169
  error estimate for blocks of size 2^( 4) =       0.000441177311
  error estimate for blocks of size 2^( 5) =       0.000451963134
  error estimate for blocks of size 2^( 6) =       0.000460393989
  error estimate for blocks of size 2^( 7) =       0.000465310394

      target function =                  N/A
              le_mean =     -16.908972435091
             les_mean =     286.235483080416
             stat err =       0.000454711207
             autocorr =       1.283701847175
              std dev =       0.567568877598
             le_variance =       0.322134430818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114635
                                         uncertainty =       0.002690078276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114635
                                         uncertainty =       0.002690078276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401331802
  error estimate for blocks of size 2^( 2) =       0.000414686562
  error estimate for blocks of size 2^( 3) =       0.000428054169
  error estimate for blocks of size 2^( 4) =       0.000441177312
  error estimate for blocks of size 2^( 5) =       0.000451963135
  error estimate for blocks of size 2^( 6) =       0.000460393989
  error estimate for blocks of size 2^( 7) =       0.000465310394

      target function =                  N/A
              le_mean =     -16.908972435090
             les_mean =     286.235483080600
             stat err =       0.000454711207
             autocorr =       1.283701847459
              std dev =       0.567568877796
             le_variance =       0.322134431042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114831
                                         uncertainty =       0.002690078277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322188114831
                                         uncertainty =       0.002690078277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401331802
  error estimate for blocks of size 2^( 2) =       0.000414686562
  error estimate for blocks of size 2^( 3) =       0.000428054170
  error estimate for blocks of size 2^( 4) =       0.000441177312
  error estimate for blocks of size 2^( 5) =       0.000451963135
  error estimate for blocks of size 2^( 6) =       0.000460393990
  error estimate for blocks of size 2^( 7) =       0.000465310394

      target function =                  N/A
              le_mean =     -16.908972435089
             les_mean =     286.235483080762
             stat err =       0.000454711208
             autocorr =       1.283701847703
              std dev =       0.567568877968
             le_variance =       0.322134431238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908972435089        initial
     3.6380e+06     3.6380e+07             1.2492e-09       -16.908972435091  <--
     1.4552e+07     1.4552e+08             3.1230e-10       -16.908972435090
     5.8208e+07     5.8208e+08             7.8076e-11       -16.908972435089

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 3.9888e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859258e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.339353
====================================================
  Execution time = 2.5522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2950e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329596733387
                                         uncertainty =       0.003119281554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329596733387
                                         uncertainty =       0.003119281554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405893468
  error estimate for blocks of size 2^( 2) =       0.000418520495
  error estimate for blocks of size 2^( 3) =       0.000431484174
  error estimate for blocks of size 2^( 4) =       0.000443686526
  error estimate for blocks of size 2^( 5) =       0.000453047167
  error estimate for blocks of size 2^( 6) =       0.000460495748
  error estimate for blocks of size 2^( 7) =       0.000461475952

      target function =                  N/A
              le_mean =     -16.908853733520
             les_mean =     286.238833432249
             stat err =       0.000454676348
             autocorr =       1.254817598346
              std dev =       0.574020047929
             le_variance =       0.329499015424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690885373352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908853733520       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908853733588       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908853733679       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908853733610       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908853733757       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908853733680       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908853734214       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908853732720       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908853733840       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908853732743       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.993565e-09

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908853733520       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908853733537       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908853733560       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908853733567       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908853734088       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908853734453       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908853732875       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908853731538       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908853730922       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908853731681       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.248392e-09

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908853733520       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908853733524       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908853733530       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908853729547       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908853738690       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908853738483       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908853722923       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908853739384       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908853721605       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908853718205       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 3.120980e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2216e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859258e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8807
    reference variance = 0.256598
====================================================
  Execution time = 2.5257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3472e-01
  Total weights = 2.0000e+06
  Execution time = 2.9615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731915601
                                         uncertainty =       0.005490608539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731915601
                                         uncertainty =       0.005490608539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409095227
  error estimate for blocks of size 2^( 2) =       0.000421880335
  error estimate for blocks of size 2^( 3) =       0.000435352653
  error estimate for blocks of size 2^( 4) =       0.000447908866
  error estimate for blocks of size 2^( 5) =       0.000460138203
  error estimate for blocks of size 2^( 6) =       0.000467988144
  error estimate for blocks of size 2^( 7) =       0.000472745511

      target function =                  N/A
              le_mean =     -16.909370143019
             les_mean =     286.261516275812
             stat err =       0.000462195181
             autocorr =       1.276444690633
              std dev =       0.578548018364
             le_variance =       0.334717809553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731913788
                                         uncertainty =       0.005490608548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731913788
                                         uncertainty =       0.005490608548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409095226
  error estimate for blocks of size 2^( 2) =       0.000421880334
  error estimate for blocks of size 2^( 3) =       0.000435352651
  error estimate for blocks of size 2^( 4) =       0.000447908865
  error estimate for blocks of size 2^( 5) =       0.000460138202
  error estimate for blocks of size 2^( 6) =       0.000467988143
  error estimate for blocks of size 2^( 7) =       0.000472745509

      target function =                  N/A
              le_mean =     -16.909370143038
             les_mean =     286.261516274659
             stat err =       0.000462195180
             autocorr =       1.276444689262
              std dev =       0.578548016801
             le_variance =       0.334717807744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731914695
                                         uncertainty =       0.005490608543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731914695
                                         uncertainty =       0.005490608543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409095226
  error estimate for blocks of size 2^( 2) =       0.000421880334
  error estimate for blocks of size 2^( 3) =       0.000435352652
  error estimate for blocks of size 2^( 4) =       0.000447908865
  error estimate for blocks of size 2^( 5) =       0.000460138203
  error estimate for blocks of size 2^( 6) =       0.000467988143
  error estimate for blocks of size 2^( 7) =       0.000472745510

      target function =                  N/A
              le_mean =     -16.909370143029
             les_mean =     286.261516275235
             stat err =       0.000462195180
             autocorr =       1.276444689954
              std dev =       0.578548017582
             le_variance =       0.334717808648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731915488
                                         uncertainty =       0.005490608540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334731915488
                                         uncertainty =       0.005490608540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409095227
  error estimate for blocks of size 2^( 2) =       0.000421880335
  error estimate for blocks of size 2^( 3) =       0.000435352653
  error estimate for blocks of size 2^( 4) =       0.000447908866
  error estimate for blocks of size 2^( 5) =       0.000460138203
  error estimate for blocks of size 2^( 6) =       0.000467988144
  error estimate for blocks of size 2^( 7) =       0.000472745511

      target function =                  N/A
              le_mean =     -16.909370143020
             les_mean =     286.261516275740
             stat err =       0.000462195181
             autocorr =       1.276444690551
              std dev =       0.578548018266
             le_variance =       0.334717809439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909370143019        initial
     9.0949e+05     9.0949e+06             4.9936e-09       -16.909370143038  <--
     3.6380e+06     3.6380e+07             1.2484e-09       -16.909370143029
     1.4552e+07     1.4552e+08             3.1210e-10       -16.909370143020

*****************************************************************************
Applying the update for shift_i =   9.0949e+05     and shift_s =   9.0949e+06
*****************************************************************************

  Execution time = 4.0108e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859256e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050827e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.201041
====================================================
  Execution time = 2.7781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329137221317
                                         uncertainty =       0.003791589672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329137221317
                                         uncertainty =       0.003791589672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405655099
  error estimate for blocks of size 2^( 2) =       0.000418302916
  error estimate for blocks of size 2^( 3) =       0.000431282667
  error estimate for blocks of size 2^( 4) =       0.000443403614
  error estimate for blocks of size 2^( 5) =       0.000454020436
  error estimate for blocks of size 2^( 6) =       0.000461777158
  error estimate for blocks of size 2^( 7) =       0.000466706419

      target function =                  N/A
              le_mean =     -16.909248400932
             les_mean =     286.251793438454
             stat err =       0.000456476907
             autocorr =       1.266262496415
              std dev =       0.573682942563
             le_variance =       0.329112118587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690924840093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909248400932       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909248401245       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909248401551       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909248401643       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909248401715       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909248401816       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909248401678       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909248401865       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909248401333       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909248401585       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.955656e-08

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909248400932       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909248401010       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909248401087       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909248401110       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909248401128       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909248401767       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909248401141       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909248400710       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909248401371       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909248401245       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.889142e-09

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909248400932       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909248400952       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909248400971       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909248400976       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909248400981       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909248401720       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909248400933       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909248400140       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909248402841       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909248400297       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.222286e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4466e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392120e-01 1 1  ON 1
 uu_2                 4.170539e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117230e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859254e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062110e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050826e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200573e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643119e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9829
    reference variance = 0.378578
====================================================
  Execution time = 2.5205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2857e-01
  Total weights = 2.0000e+06
  Execution time = 2.9524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544308712
                                         uncertainty =       0.005429400362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544308712
                                         uncertainty =       0.005429400362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405322665
  error estimate for blocks of size 2^( 2) =       0.000417929710
  error estimate for blocks of size 2^( 3) =       0.000431237056
  error estimate for blocks of size 2^( 4) =       0.000443793967
  error estimate for blocks of size 2^( 5) =       0.000455959894
  error estimate for blocks of size 2^( 6) =       0.000466265429
  error estimate for blocks of size 2^( 7) =       0.000472609180

      target function =                  N/A
              le_mean =     -16.908900310980
             les_mean =     286.239482488282
             stat err =       0.000459657118
             autocorr =       1.286074713845
              std dev =       0.573212810318
             le_variance =       0.328572925913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544301804
                                         uncertainty =       0.005429400310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544301804
                                         uncertainty =       0.005429400310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405322661
  error estimate for blocks of size 2^( 2) =       0.000417929705
  error estimate for blocks of size 2^( 3) =       0.000431237050
  error estimate for blocks of size 2^( 4) =       0.000443793961
  error estimate for blocks of size 2^( 5) =       0.000455959887
  error estimate for blocks of size 2^( 6) =       0.000466265423
  error estimate for blocks of size 2^( 7) =       0.000472609174

      target function =                  N/A
              le_mean =     -16.908900311042
             les_mean =     286.239482483486
             stat err =       0.000459657111
             autocorr =       1.286074705250
              std dev =       0.573212804292
             le_variance =       0.328572919005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544305258
                                         uncertainty =       0.005429400336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544305258
                                         uncertainty =       0.005429400336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405322663
  error estimate for blocks of size 2^( 2) =       0.000417929707
  error estimate for blocks of size 2^( 3) =       0.000431237053
  error estimate for blocks of size 2^( 4) =       0.000443793964
  error estimate for blocks of size 2^( 5) =       0.000455959891
  error estimate for blocks of size 2^( 6) =       0.000466265426
  error estimate for blocks of size 2^( 7) =       0.000472609177

      target function =                  N/A
              le_mean =     -16.908900311011
             les_mean =     286.239482485884
             stat err =       0.000459657114
             autocorr =       1.286074709539
              std dev =       0.573212807305
             le_variance =       0.328572922459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544308280
                                         uncertainty =       0.005429400358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328544308280
                                         uncertainty =       0.005429400358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405322665
  error estimate for blocks of size 2^( 2) =       0.000417929709
  error estimate for blocks of size 2^( 3) =       0.000431237056
  error estimate for blocks of size 2^( 4) =       0.000443793967
  error estimate for blocks of size 2^( 5) =       0.000455959894
  error estimate for blocks of size 2^( 6) =       0.000466265429
  error estimate for blocks of size 2^( 7) =       0.000472609180

      target function =                  N/A
              le_mean =     -16.908900310984
             les_mean =     286.239482487983
             stat err =       0.000459657117
             autocorr =       1.286074713304
              std dev =       0.573212809941
             le_variance =       0.328572925481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908900310980        initial
     2.2737e+05     2.2737e+06             1.9557e-08       -16.908900311042  <--
     9.0949e+05     9.0949e+06             4.8891e-09       -16.908900311011
     3.6380e+06     3.6380e+07             1.2223e-09       -16.908900310984

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 4.0038e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392119e-01 1 1  ON 1
 uu_2                 4.170540e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117231e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859247e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062111e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050825e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200574e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643120e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.299538
====================================================
  Execution time = 2.5611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332288694084
                                         uncertainty =       0.004918167050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332288694084
                                         uncertainty =       0.004918167050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407590055
  error estimate for blocks of size 2^( 2) =       0.000420195396
  error estimate for blocks of size 2^( 3) =       0.000433563078
  error estimate for blocks of size 2^( 4) =       0.000446276552
  error estimate for blocks of size 2^( 5) =       0.000456878059
  error estimate for blocks of size 2^( 6) =       0.000464242190
  error estimate for blocks of size 2^( 7) =       0.000467517183

      target function =                  N/A
              le_mean =     -16.909050509369
             les_mean =     286.248248267742
             stat err =       0.000458728496
             autocorr =       1.266672322188
              std dev =       0.576419383324
             le_variance =       0.332259305471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690905050937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909050509369       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909050510558       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909050511835       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909050512329       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909050512552       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909050512684       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909050512718       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909050512692       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909050512656       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909050512667       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+04 is 7.840709e-08

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909050509369       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909050509666       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909050509986       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909050510109       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909050510168       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909050510190       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909050510385       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909050510161       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909050510093       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909050510389       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.960183e-08

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909050509369       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909050509444       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909050509523       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909050510335       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909050509538       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909050509701       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909050509584       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909050509539       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909050509763       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909050508249       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.900460e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2265e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392119e-01 1 1  ON 1
 uu_2                 4.170540e-02 1 1  ON 2
 uu_3                -1.918534e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117231e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036276e-02 1 1  ON 12
 ud_3                 1.859238e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062111e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050824e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200574e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726815e-02 1 1  ON 42
eH2_3                -3.643120e-02 1 1  ON 43
eH2_4                 1.332709e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.163134
====================================================
  Execution time = 2.5138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3857e-01
  Total weights = 2.0000e+06
  Execution time = 2.9569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640978338
                                         uncertainty =       0.006824826095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640978338
                                         uncertainty =       0.006824826095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441643
  error estimate for blocks of size 2^( 2) =       0.000423635291
  error estimate for blocks of size 2^( 3) =       0.000437016274
  error estimate for blocks of size 2^( 4) =       0.000449550581
  error estimate for blocks of size 2^( 5) =       0.000460899412
  error estimate for blocks of size 2^( 6) =       0.000467504277
  error estimate for blocks of size 2^( 7) =       0.000472685777

      target function =                  N/A
              le_mean =     -16.908817118736
             les_mean =     286.246664637272
             stat err =       0.000462660012
             autocorr =       1.264466817597
              std dev =       0.581866352087
             le_variance =       0.338568451691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640949789
                                         uncertainty =       0.006824825231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640949789
                                         uncertainty =       0.006824825231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441626
  error estimate for blocks of size 2^( 2) =       0.000423635270
  error estimate for blocks of size 2^( 3) =       0.000437016251
  error estimate for blocks of size 2^( 4) =       0.000449550557
  error estimate for blocks of size 2^( 5) =       0.000460899386
  error estimate for blocks of size 2^( 6) =       0.000467504251
  error estimate for blocks of size 2^( 7) =       0.000472685751

      target function =                  N/A
              le_mean =     -16.908817118308
             les_mean =     286.246664594266
             stat err =       0.000462659986
             autocorr =       1.264466785584
              std dev =       0.581866327571
             le_variance =       0.338568423161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640964064
                                         uncertainty =       0.006824825663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640964064
                                         uncertainty =       0.006824825663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441635
  error estimate for blocks of size 2^( 2) =       0.000423635280
  error estimate for blocks of size 2^( 3) =       0.000437016263
  error estimate for blocks of size 2^( 4) =       0.000449550569
  error estimate for blocks of size 2^( 5) =       0.000460899399
  error estimate for blocks of size 2^( 6) =       0.000467504264
  error estimate for blocks of size 2^( 7) =       0.000472685764

      target function =                  N/A
              le_mean =     -16.908817118522
             les_mean =     286.246664615769
             stat err =       0.000462659999
             autocorr =       1.264466801594
              std dev =       0.581866339829
             le_variance =       0.338568437426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640976554
                                         uncertainty =       0.006824826041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640976554
                                         uncertainty =       0.006824826041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441642
  error estimate for blocks of size 2^( 2) =       0.000423635289
  error estimate for blocks of size 2^( 3) =       0.000437016273
  error estimate for blocks of size 2^( 4) =       0.000449550579
  error estimate for blocks of size 2^( 5) =       0.000460899410
  error estimate for blocks of size 2^( 6) =       0.000467504275
  error estimate for blocks of size 2^( 7) =       0.000472685776

      target function =                  N/A
              le_mean =     -16.908817118709
             les_mean =     286.246664634584
             stat err =       0.000462660010
             autocorr =       1.264466815598
              std dev =       0.581866350555
             le_variance =       0.338568449908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908817118736        initial  <--
     5.6843e+04     5.6843e+05             7.8407e-08       -16.908817118308
     2.2737e+05     2.2737e+06             1.9602e-08       -16.908817118522
     9.0949e+05     9.0949e+06             4.9005e-09       -16.908817118709

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0144
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.025231e-01 1 1  ON 0
 uu_1                 1.392119e-01 1 1  ON 1
 uu_2                 4.170540e-02 1 1  ON 2
 uu_3                -1.918535e-02 1 1  ON 3
 uu_4                -6.325451e-02 1 1  ON 4
 uu_5                -9.590828e-02 1 1  ON 5
 uu_6                -1.205705e-01 1 1  ON 6
 uu_7                -1.310320e-01 1 1  ON 7
 uu_8                -1.203745e-01 1 1  ON 8
 uu_9                -9.278897e-02 1 1  ON 9
 ud_0                 4.117231e-01 1 1  ON 10
 ud_1                 1.592879e-01 1 1  ON 11
 ud_2                 6.036277e-02 1 1  ON 12
 ud_3                 1.859247e-03 1 1  ON 13
 ud_4                -5.685434e-02 1 1  ON 14
 ud_5                -1.013726e-01 1 1  ON 15
 ud_6                -1.286922e-01 1 1  ON 16
 ud_7                -1.435977e-01 1 1  ON 17
 ud_8                -1.425427e-01 1 1  ON 18
 ud_9                -1.344806e-01 1 1  ON 19
 eO_0                -7.062111e-01 1 1  ON 20
 eO_1                -4.138918e-01 1 1  ON 21
 eO_2                -3.050825e-02 1 1  ON 22
 eO_3                 2.701635e-01 1 1  ON 23
 eO_4                 4.917052e-01 1 1  ON 24
 eO_5                 4.594119e-01 1 1  ON 25
 eO_6                 2.360327e-01 1 1  ON 26
 eO_7                -5.586989e-02 1 1  ON 27
 eO_8                -1.960064e-01 1 1  ON 28
 eO_9                -5.774368e-02 1 1  ON 29
eH1_0                -2.108361e-01 1 1  ON 30
eH1_1                -1.273912e-01 1 1  ON 31
eH1_2                -8.825332e-02 1 1  ON 32
eH1_3                -3.745039e-02 1 1  ON 33
eH1_4                 1.200574e-02 1 1  ON 34
eH1_5                 4.478229e-02 1 1  ON 35
eH1_6                 9.481237e-02 1 1  ON 36
eH1_7                 1.382219e-01 1 1  ON 37
eH1_8                 1.457850e-01 1 1  ON 38
eH1_9                 3.291496e-02 1 1  ON 39
eH2_0                -2.097269e-01 1 1  ON 40
eH2_1                -1.264569e-01 1 1  ON 41
eH2_2                -8.726816e-02 1 1  ON 42
eH2_3                -3.643120e-02 1 1  ON 43
eH2_4                 1.332708e-02 1 1  ON 44
eH2_5                 4.799450e-02 1 1  ON 45
eH2_6                 1.006387e-01 1 1  ON 46
eH2_7                 1.496079e-01 1 1  ON 47
eH2_8                 1.538402e-01 1 1  ON 48
eH2_9                 1.301177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2286e+01 secs
  Total Execution time = 2.9161e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
