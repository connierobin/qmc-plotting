Rank =    0  Free Memory = 75255 MB
Rank =    1  Free Memory = 75255 MB
Rank =    2  Free Memory = 75255 MB
Rank =    3  Free Memory = 75255 MB
Rank =    4  Free Memory = 75255 MB
Rank =    5  Free Memory = 75255 MB
Rank =    6  Free Memory = 75255 MB
Rank =    7  Free Memory = 75255 MB
Rank =    8  Free Memory = 75254 MB
Rank =    9  Free Memory = 75254 MB
Rank =   10  Free Memory = 75254 MB
Rank =   11  Free Memory = 75253 MB
Rank =   12  Free Memory = 75253 MB
Rank =   13  Free Memory = 75253 MB
Rank =   14  Free Memory = 75253 MB
Rank =   15  Free Memory = 75239 MB
Rank =   16  Free Memory = 75239 MB
Rank =   17  Free Memory = 75239 MB
Rank =   18  Free Memory = 75239 MB
Rank =   19  Free Memory = 75239 MB
Rank =   20  Free Memory = 75239 MB
Rank =   21  Free Memory = 75239 MB
Rank =   22  Free Memory = 75239 MB
Rank =   23  Free Memory = 75238 MB
Rank =   24  Free Memory = 75238 MB
Rank =   25  Free Memory = 75238 MB
Rank =   26  Free Memory = 75238 MB
Rank =   27  Free Memory = 75238 MB
Rank =   28  Free Memory = 75238 MB
Rank =   29  Free Memory = 75238 MB
Rank =   30  Free Memory = 75238 MB
Rank =   31  Free Memory = 75238 MB
Rank =   32  Free Memory = 69571 MB
Rank =   33  Free Memory = 69571 MB
Rank =   34  Free Memory = 69571 MB
Rank =   35  Free Memory = 69571 MB
Rank =   36  Free Memory = 69571 MB
Rank =   37  Free Memory = 69571 MB
Rank =   38  Free Memory = 69571 MB
Rank =   39  Free Memory = 69571 MB
Rank =   40  Free Memory = 69571 MB
Rank =   41  Free Memory = 69571 MB
Rank =   42  Free Memory = 69571 MB
Rank =   43  Free Memory = 69570 MB
Rank =   44  Free Memory = 69570 MB
Rank =   45  Free Memory = 69570 MB
Rank =   46  Free Memory = 69570 MB
Rank =   47  Free Memory = 69570 MB
Rank =   48  Free Memory = 69570 MB
Rank =   49  Free Memory = 69570 MB
Rank =   50  Free Memory = 69570 MB
Rank =   51  Free Memory = 69570 MB
Rank =   52  Free Memory = 69570 MB
Rank =   53  Free Memory = 69570 MB
Rank =   54  Free Memory = 69570 MB
Rank =   55  Free Memory = 69570 MB
Rank =   56  Free Memory = 69570 MB
Rank =   57  Free Memory = 69570 MB
Rank =   58  Free Memory = 69570 MB
Rank =   59  Free Memory = 69570 MB
Rank =   60  Free Memory = 69570 MB
Rank =   61  Free Memory = 69570 MB
Rank =   62  Free Memory = 69570 MB
Rank =   63  Free Memory = 69570 MB
Rank =   64  Free Memory = 78157 MB
Rank =   65  Free Memory = 78157 MB
Rank =   66  Free Memory = 78157 MB
Rank =   67  Free Memory = 78157 MB
Rank =   68  Free Memory = 78157 MB
Rank =   69  Free Memory = 78157 MB
Rank =   70  Free Memory = 78157 MB
Rank =   71  Free Memory = 78157 MB
Rank =   72  Free Memory = 78157 MB
Rank =   73  Free Memory = 78157 MB
Rank =   74  Free Memory = 78157 MB
Rank =   75  Free Memory = 78157 MB
Rank =   76  Free Memory = 78157 MB
Rank =   77  Free Memory = 78157 MB
Rank =   78  Free Memory = 78157 MB
Rank =   79  Free Memory = 78157 MB
Rank =   80  Free Memory = 78157 MB
Rank =   81  Free Memory = 78157 MB
Rank =   82  Free Memory = 78157 MB
Rank =   83  Free Memory = 78157 MB
Rank =   84  Free Memory = 78157 MB
Rank =   85  Free Memory = 78157 MB
Rank =   86  Free Memory = 78157 MB
Rank =   87  Free Memory = 78157 MB
Rank =   88  Free Memory = 78157 MB
Rank =   89  Free Memory = 78157 MB
Rank =   90  Free Memory = 78157 MB
Rank =   91  Free Memory = 78157 MB
Rank =   92  Free Memory = 78157 MB
Rank =   93  Free Memory = 78157 MB
Rank =   94  Free Memory = 78157 MB
Rank =   95  Free Memory = 78157 MB
Rank =   96  Free Memory = 88652 MB
Rank =   97  Free Memory = 88652 MB
Rank =   98  Free Memory = 88652 MB
Rank =   99  Free Memory = 88652 MB
Rank =  100  Free Memory = 88652 MB
Rank =  101  Free Memory = 88652 MB
Rank =  102  Free Memory = 88652 MB
Rank =  103  Free Memory = 88652 MB
Rank =  104  Free Memory = 88652 MB
Rank =  105  Free Memory = 88652 MB
Rank =  106  Free Memory = 88652 MB
Rank =  107  Free Memory = 88652 MB
Rank =  108  Free Memory = 88652 MB
Rank =  109  Free Memory = 88652 MB
Rank =  110  Free Memory = 88652 MB
Rank =  111  Free Memory = 88652 MB
Rank =  112  Free Memory = 88652 MB
Rank =  113  Free Memory = 88652 MB
Rank =  114  Free Memory = 88652 MB
Rank =  115  Free Memory = 88652 MB
Rank =  116  Free Memory = 88652 MB
Rank =  117  Free Memory = 88652 MB
Rank =  118  Free Memory = 88652 MB
Rank =  119  Free Memory = 88652 MB
Rank =  120  Free Memory = 88652 MB
Rank =  121  Free Memory = 88652 MB
Rank =  122  Free Memory = 88652 MB
Rank =  123  Free Memory = 88652 MB
Rank =  124  Free Memory = 88652 MB
Rank =  125  Free Memory = 88652 MB
Rank =  126  Free Memory = 88652 MB
Rank =  127  Free Memory = 88652 MB
  Input file(s): opt_h2o_1b1_gvptt_277dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_277dets_run001f.xml

  Project = H2O
  date    = 2023-05-12 09:25:49 PDT
  host    = n0027.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 141

  Range of prime numbers to use as seeds over processors and threads = 823-1741


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.082931e-01    1         1  ON     0
     uu_1                 1.425284e-01    1         1  ON     1
     uu_2                 4.384802e-02    1         1  ON     2
     uu_3                -1.971487e-02    1         1  ON     3
     uu_4                -6.883763e-02    1         1  ON     4
     uu_5                -1.039250e-01    1         1  ON     5
     uu_6                -1.304306e-01    1         1  ON     6
     uu_7                -1.427852e-01    1         1  ON     7
     uu_8                -1.341349e-01    1         1  ON     8
     uu_9                -1.064379e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.382216e-01    1         1  ON     0
     ud_1                 1.805404e-01    1         1  ON     1
     ud_2                 6.627707e-02    1         1  ON     2
     ud_3                -2.937955e-03    1         1  ON     3
     ud_4                -5.896497e-02    1         1  ON     4
     ud_5                -1.020673e-01    1         1  ON     5
     ud_6                -1.322142e-01    1         1  ON     6
     ud_7                -1.522240e-01    1         1  ON     7
     ud_8                -1.562185e-01    1         1  ON     8
     ud_9                -1.478752e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.603879e-01    1         1  ON     0
     eO_1                -4.435497e-01    1         1  ON     1
     eO_2                -2.476257e-02    1         1  ON     2
     eO_3                 3.023262e-01    1         1  ON     3
     eO_4                 5.303561e-01    1         1  ON     4
     eO_5                 4.927296e-01    1         1  ON     5
     eO_6                 2.640639e-01    1         1  ON     6
     eO_7                -4.057136e-02    1         1  ON     7
     eO_8                -2.285136e-01    1         1  ON     8
     eO_9                -9.032931e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.542037e-01    1         1  ON     0
     eH1_1                -1.504170e-01    1         1  ON     1
     eH1_2                -1.054758e-01    1         1  ON     2
     eH1_3                -5.332200e-02    1         1  ON     3
     eH1_4                -1.854860e-03    1         1  ON     4
     eH1_5                 3.355772e-02    1         1  ON     5
     eH1_6                 9.692389e-02    1         1  ON     6
     eH1_7                 1.565973e-01    1         1  ON     7
     eH1_8                 1.898948e-01    1         1  ON     8
     eH1_9                 8.545936e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.478345e-01    1         1  ON     0
     eH2_1                -1.443391e-01    1         1  ON     1
     eH2_2                -9.967375e-02    1         1  ON     2
     eH2_3                -4.743523e-02    1         1  ON     3
     eH2_4                 3.772618e-03    1         1  ON     4
     eH2_5                 3.875896e-02    1         1  ON     5
     eH2_6                 1.009219e-01    1         1  ON     6
     eH2_7                 1.585011e-01    1         1  ON     7
     eH2_8                 1.906394e-01    1         1  ON     8
     eH2_9                 6.358449e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 277 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 4.332220e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 70 unique up determinants.
Found 70 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.6165e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.19799
====================================================
  Execution time = 4.1575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3025e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0641e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330252255334
                                         uncertainty =       0.003476332756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330252255334
                                         uncertainty =       0.003476332756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406353847
  error estimate for blocks of size 2^( 2) =       0.000417700913
  error estimate for blocks of size 2^( 3) =       0.000430302483
  error estimate for blocks of size 2^( 4) =       0.000442442196
  error estimate for blocks of size 2^( 5) =       0.000453935203
  error estimate for blocks of size 2^( 6) =       0.000462691906
  error estimate for blocks of size 2^( 7) =       0.000469151680

      target function =                  N/A
              le_mean =     -16.911356153058
             les_mean =     286.324213668040
             stat err =       0.000457055246
             autocorr =       1.265111039338
              std dev =       0.574671121252
             le_variance =       0.330246897602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691135615306e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911356153058       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911360832117       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911365658862       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911365038653       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911364765116       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911364613482       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911364670472       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911364394232       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911365034125       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911365024518       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.452701e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911356153058       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911357933647       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911360297629       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911360430767       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911360232167       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911360164286       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911360028811       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911360141096       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911360181791       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.079727e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911356153058       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911356665042       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911357420431       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911357513682       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911357508970       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911357512694       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911357430276       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911357459516       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.477069e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2426e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.081506e-01                 1 1 ON  0
uu_1  1.424284e-01                 1 1 ON  1
uu_2  4.398474e-02                 1 1 ON  2
uu_3  -1.964751e-02                1 1 ON  3
uu_4  -6.885996e-02                1 1 ON  4
uu_5  -1.039228e-01                1 1 ON  5
uu_6  -1.304095e-01                1 1 ON  6
uu_7  -1.427246e-01                1 1 ON  7
uu_8  -1.342102e-01                1 1 ON  8
uu_9  -1.065500e-01                1 1 ON  9
ud_0  4.384211e-01                 1 1 ON  10
ud_1  1.807484e-01                 1 1 ON  11
ud_2  6.620211e-02                 1 1 ON  12
ud_3  -3.062662e-03                1 1 ON  13
ud_4  -5.901412e-02                1 1 ON  14
ud_5  -1.020138e-01                1 1 ON  15
ud_6  -1.322959e-01                1 1 ON  16
ud_7  -1.522496e-01                1 1 ON  17
ud_8  -1.562074e-01                1 1 ON  18
ud_9  -1.478945e-01                1 1 ON  19
eO_0  -7.603241e-01                1 1 ON  20
eO_1  -4.435190e-01                1 1 ON  21
eO_2  -2.483725e-02                1 1 ON  22
eO_3  3.023328e-01                 1 1 ON  23
eO_4  5.304020e-01                 1 1 ON  24
eO_5  4.928199e-01                 1 1 ON  25
eO_6  2.641074e-01                 1 1 ON  26
eO_7  -4.051057e-02                1 1 ON  27
eO_8  -2.286064e-01                1 1 ON  28
eO_9  -9.046717e-02                1 1 ON  29
eH1_0 -2.544083e-01                1 1 ON  30
eH1_1 -1.504787e-01                1 1 ON  31
eH1_2 -1.055070e-01                1 1 ON  32
eH1_3 -5.339720e-02                1 1 ON  33
eH1_4 -1.838412e-03                1 1 ON  34
eH1_5 3.360764e-02                 1 1 ON  35
eH1_6 9.695826e-02                 1 1 ON  36
eH1_7 1.565968e-01                 1 1 ON  37
eH1_8 1.899863e-01                 1 1 ON  38
eH1_9 8.559918e-02                 1 1 ON  39
eH2_0 -2.480114e-01                1 1 ON  40
eH2_1 -1.444147e-01                1 1 ON  41
eH2_2 -9.968697e-02                1 1 ON  42
eH2_3 -4.748941e-02                1 1 ON  43
eH2_4 3.747697e-03                 1 1 ON  44
eH2_5 3.877807e-02                 1 1 ON  45
eH2_6 1.009158e-01                 1 1 ON  46
eH2_7 1.585371e-01                 1 1 ON  47
eH2_8 1.907478e-01                 1 1 ON  48
eH2_9 6.376756e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.241323
====================================================
  Execution time = 4.0297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3630e-01
  Total weights = 2.0000e+06
  Execution time = 4.6621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336146458535
                                         uncertainty =       0.004661354769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336146458535
                                         uncertainty =       0.004661354769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410044191
  error estimate for blocks of size 2^( 2) =       0.000422177247
  error estimate for blocks of size 2^( 3) =       0.000434159306
  error estimate for blocks of size 2^( 4) =       0.000445521620
  error estimate for blocks of size 2^( 5) =       0.000456371256
  error estimate for blocks of size 2^( 6) =       0.000465681176
  error estimate for blocks of size 2^( 7) =       0.000472000482

      target function =                  N/A
              le_mean =     -16.910568727594
             les_mean =     286.303606999411
             stat err =       0.000459893634
             autocorr =       1.257921291403
              std dev =       0.579890055848
             le_variance =       0.336272476872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336243078125
                                         uncertainty =       0.004665213409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336243078125
                                         uncertainty =       0.004665213409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410103066
  error estimate for blocks of size 2^( 2) =       0.000422221124
  error estimate for blocks of size 2^( 3) =       0.000434187533
  error estimate for blocks of size 2^( 4) =       0.000445542046
  error estimate for blocks of size 2^( 5) =       0.000456390992
  error estimate for blocks of size 2^( 6) =       0.000465705886
  error estimate for blocks of size 2^( 7) =       0.000472030357

      target function =                  N/A
              le_mean =     -16.910574361950
             les_mean =     286.303894132841
             stat err =       0.000459917320
             autocorr =       1.257689681508
              std dev =       0.579973318327
             le_variance =       0.336369049972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336216723814
                                         uncertainty =       0.004664378402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336216723814
                                         uncertainty =       0.004664378402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410087039
  error estimate for blocks of size 2^( 2) =       0.000422207670
  error estimate for blocks of size 2^( 3) =       0.000434177262
  error estimate for blocks of size 2^( 4) =       0.000445533452
  error estimate for blocks of size 2^( 5) =       0.000456381886
  error estimate for blocks of size 2^( 6) =       0.000465698442
  error estimate for blocks of size 2^( 7) =       0.000472022446

      target function =                  N/A
              le_mean =     -16.910572814449
             les_mean =     286.303815504236
             stat err =       0.000459909056
             autocorr =       1.257742787451
              std dev =       0.579950652758
             le_variance =       0.336342759634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336153704498
                                         uncertainty =       0.004661779655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336153704498
                                         uncertainty =       0.004661779655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410048614
  error estimate for blocks of size 2^( 2) =       0.000422179687
  error estimate for blocks of size 2^( 3) =       0.000434159824
  error estimate for blocks of size 2^( 4) =       0.000445521226
  error estimate for blocks of size 2^( 5) =       0.000456370616
  error estimate for blocks of size 2^( 6) =       0.000465681754
  error estimate for blocks of size 2^( 7) =       0.000472001816

      target function =                  N/A
              le_mean =     -16.910569080402
             les_mean =     286.303626186543
             stat err =       0.000459893853
             autocorr =       1.257895353582
              std dev =       0.579896311093
             le_variance =       0.336279731619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910568727594        initial
     2.5000e-01     2.5000e+00             7.4527e-04       -16.910574361950  <--
     1.0000e+00     1.0000e+01             2.0797e-04       -16.910572814449
     4.0000e+00     4.0000e+01             6.4771e-05       -16.910569080402

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3702e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.078923e-01 1 1  ON 0
 uu_1                 1.423202e-01 1 1  ON 1
 uu_2                 4.412818e-02 1 1  ON 2
 uu_3                -1.952052e-02 1 1  ON 3
 uu_4                -6.887174e-02 1 1  ON 4
 uu_5                -1.039305e-01 1 1  ON 5
 uu_6                -1.303843e-01 1 1  ON 6
 uu_7                -1.425930e-01 1 1  ON 7
 uu_8                -1.344062e-01 1 1  ON 8
 uu_9                -1.068641e-01 1 1  ON 9
 ud_0                 4.387976e-01 1 1  ON 10
 ud_1                 1.810572e-01 1 1  ON 11
 ud_2                 6.619809e-02 1 1  ON 12
 ud_3                -3.226150e-03 1 1  ON 13
 ud_4                -5.911118e-02 1 1  ON 14
 ud_5                -1.019656e-01 1 1  ON 15
 ud_6                -1.324140e-01 1 1  ON 16
 ud_7                -1.523173e-01 1 1  ON 17
 ud_8                -1.561737e-01 1 1  ON 18
 ud_9                -1.479366e-01 1 1  ON 19
 eO_0                -7.601790e-01 1 1  ON 20
 eO_1                -4.434195e-01 1 1  ON 21
 eO_2                -2.491435e-02 1 1  ON 22
 eO_3                 3.022219e-01 1 1  ON 23
 eO_4                 5.305037e-01 1 1  ON 24
 eO_5                 4.931000e-01 1 1  ON 25
 eO_6                 2.642520e-01 1 1  ON 26
 eO_7                -4.033470e-02 1 1  ON 27
 eO_8                -2.288668e-01 1 1  ON 28
 eO_9                -9.086147e-02 1 1  ON 29
eH1_0                -2.549490e-01 1 1  ON 30
eH1_1                -1.506660e-01 1 1  ON 31
eH1_2                -1.056350e-01 1 1  ON 32
eH1_3                -5.354441e-02 1 1  ON 33
eH1_4                -1.848869e-03 1 1  ON 34
eH1_5                 3.372559e-02 1 1  ON 35
eH1_6                 9.706323e-02 1 1  ON 36
eH1_7                 1.566032e-01 1 1  ON 37
eH1_8                 1.902498e-01 1 1  ON 38
eH1_9                 8.600154e-02 1 1  ON 39
eH2_0                -2.484839e-01 1 1  ON 40
eH2_1                -1.446135e-01 1 1  ON 41
eH2_2                -9.978700e-02 1 1  ON 42
eH2_3                -4.761332e-02 1 1  ON 43
eH2_4                 3.668005e-03 1 1  ON 44
eH2_5                 3.880662e-02 1 1  ON 45
eH2_6                 1.009018e-01 1 1  ON 46
eH2_7                 1.586432e-01 1 1  ON 47
eH2_8                 1.910611e-01 1 1  ON 48
eH2_9                 6.429522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1614e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.865
    reference variance = 0.37715
====================================================
  Execution time = 4.1076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0717e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323138817441
                                         uncertainty =       0.003012408952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323138817441
                                         uncertainty =       0.003012408952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401935479
  error estimate for blocks of size 2^( 2) =       0.000414087686
  error estimate for blocks of size 2^( 3) =       0.000426082078
  error estimate for blocks of size 2^( 4) =       0.000437063578
  error estimate for blocks of size 2^( 5) =       0.000447749765
  error estimate for blocks of size 2^( 6) =       0.000456161855
  error estimate for blocks of size 2^( 7) =       0.000462212047

      target function =                  N/A
              le_mean =     -16.910078912648
             les_mean =     286.273872928858
             stat err =       0.000450796811
             autocorr =       1.257908303746
              std dev =       0.568422605487
             le_variance =       0.323104258429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691007891265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910078912648       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910078157991       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910082153962       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084134471       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910082199741       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084981537       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910085870818       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910089015473       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910087894316       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910087211375       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910086822093       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910087348295       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910087410567       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.161032e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910078912648       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910078478843       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910081493833       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910082042298       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910081394254       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910082255315       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910081816204       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910082519867       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910082739324       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910082393676       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.932954e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910078912648       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910078752018       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910080112186       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910080219150       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910080199688       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910080206286       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910079968103       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910080128879       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910080191112       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.081557e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1806e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.077888e-01 1 1  ON 0
 uu_1                 1.425450e-01 1 1  ON 1
 uu_2                 4.437385e-02 1 1  ON 2
 uu_3                -1.919321e-02 1 1  ON 3
 uu_4                -6.871709e-02 1 1  ON 4
 uu_5                -1.040726e-01 1 1  ON 5
 uu_6                -1.305159e-01 1 1  ON 6
 uu_7                -1.431737e-01 1 1  ON 7
 uu_8                -1.349493e-01 1 1  ON 8
 uu_9                -1.071181e-01 1 1  ON 9
 ud_0                 4.392966e-01 1 1  ON 10
 ud_1                 1.811913e-01 1 1  ON 11
 ud_2                 6.607808e-02 1 1  ON 12
 ud_3                -3.473720e-03 1 1  ON 13
 ud_4                -5.922406e-02 1 1  ON 14
 ud_5                -1.020941e-01 1 1  ON 15
 ud_6                -1.322923e-01 1 1  ON 16
 ud_7                -1.521615e-01 1 1  ON 17
 ud_8                -1.561899e-01 1 1  ON 18
 ud_9                -1.480120e-01 1 1  ON 19
 eO_0                -7.604161e-01 1 1  ON 20
 eO_1                -4.431969e-01 1 1  ON 21
 eO_2                -2.476469e-02 1 1  ON 22
 eO_3                 3.021972e-01 1 1  ON 23
 eO_4                 5.307719e-01 1 1  ON 24
 eO_5                 4.934026e-01 1 1  ON 25
 eO_6                 2.646324e-01 1 1  ON 26
 eO_7                -4.046422e-02 1 1  ON 27
 eO_8                -2.292749e-01 1 1  ON 28
 eO_9                -9.131800e-02 1 1  ON 29
eH1_0                -2.552710e-01 1 1  ON 30
eH1_1                -1.512320e-01 1 1  ON 31
eH1_2                -1.057563e-01 1 1  ON 32
eH1_3                -5.386059e-02 1 1  ON 33
eH1_4                -2.037744e-03 1 1  ON 34
eH1_5                 3.358905e-02 1 1  ON 35
eH1_6                 9.734288e-02 1 1  ON 36
eH1_7                 1.569099e-01 1 1  ON 37
eH1_8                 1.905439e-01 1 1  ON 38
eH1_9                 8.662647e-02 1 1  ON 39
eH2_0                -2.488844e-01 1 1  ON 40
eH2_1                -1.449142e-01 1 1  ON 41
eH2_2                -9.984150e-02 1 1  ON 42
eH2_3                -4.778030e-02 1 1  ON 43
eH2_4                 3.709563e-03 1 1  ON 44
eH2_5                 3.864560e-02 1 1  ON 45
eH2_6                 1.007916e-01 1 1  ON 46
eH2_7                 1.585940e-01 1 1  ON 47
eH2_8                 1.914328e-01 1 1  ON 48
eH2_9                 6.508852e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.187459
====================================================
  Execution time = 4.0138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3219e-01
  Total weights = 2.0000e+06
  Execution time = 4.6617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331884490511
                                         uncertainty =       0.004288982359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331884490511
                                         uncertainty =       0.004288982359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407355843
  error estimate for blocks of size 2^( 2) =       0.000419332062
  error estimate for blocks of size 2^( 3) =       0.000431448770
  error estimate for blocks of size 2^( 4) =       0.000441878228
  error estimate for blocks of size 2^( 5) =       0.000452347794
  error estimate for blocks of size 2^( 6) =       0.000461915868
  error estimate for blocks of size 2^( 7) =       0.000468531268

      target function =                  N/A
              le_mean =     -16.910169351660
             les_mean =     286.285704902053
             stat err =       0.000456168290
             autocorr =       1.254013707347
              std dev =       0.576088158343
             le_variance =       0.331877566183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332435626952
                                         uncertainty =       0.004290396526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332435626952
                                         uncertainty =       0.004290396526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693685
  error estimate for blocks of size 2^( 2) =       0.000419643328
  error estimate for blocks of size 2^( 3) =       0.000431733299
  error estimate for blocks of size 2^( 4) =       0.000442144571
  error estimate for blocks of size 2^( 5) =       0.000452604697
  error estimate for blocks of size 2^( 6) =       0.000462155909
  error estimate for blocks of size 2^( 7) =       0.000468763447

      target function =                  N/A
              le_mean =     -16.910171847210
             les_mean =     286.286340018278
             stat err =       0.000456417156
             autocorr =       1.253302628460
              std dev =       0.576565939261
             le_variance =       0.332428282316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332513257631
                                         uncertainty =       0.004289799288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332513257631
                                         uncertainty =       0.004289799288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407741196
  error estimate for blocks of size 2^( 2) =       0.000419687192
  error estimate for blocks of size 2^( 3) =       0.000431774824
  error estimate for blocks of size 2^( 4) =       0.000442185940
  error estimate for blocks of size 2^( 5) =       0.000452647194
  error estimate for blocks of size 2^( 6) =       0.000462195607
  error estimate for blocks of size 2^( 7) =       0.000468803711

      target function =                  N/A
              le_mean =     -16.910173930864
             les_mean =     286.286487970833
             stat err =       0.000456458113
             autocorr =       1.253235466180
              std dev =       0.576633128619
             le_variance =       0.332505765021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332021332246
                                         uncertainty =       0.004289138477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332021332246
                                         uncertainty =       0.004289138477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407439727
  error estimate for blocks of size 2^( 2) =       0.000419409349
  error estimate for blocks of size 2^( 3) =       0.000431519810
  error estimate for blocks of size 2^( 4) =       0.000441945402
  error estimate for blocks of size 2^( 5) =       0.000452412864
  error estimate for blocks of size 2^( 6) =       0.000461976617
  error estimate for blocks of size 2^( 7) =       0.000468590322

      target function =                  N/A
              le_mean =     -16.910169665433
             les_mean =     286.285852209670
             stat err =       0.000456231301
             autocorr =       1.253843729165
              std dev =       0.576206787477
             le_variance =       0.332014261934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910169351660        initial
     6.2500e-02     6.2500e-01             3.1610e-03       -16.910171847210
     2.5000e-01     2.5000e+00             7.9330e-04       -16.910173930864  <--
     1.0000e+00     1.0000e+01             2.0816e-04       -16.910169665433

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3492e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.077888e-01 1 1  ON 0
 uu_1                 1.425450e-01 1 1  ON 1
 uu_2                 4.437385e-02 1 1  ON 2
 uu_3                -1.919321e-02 1 1  ON 3
 uu_4                -6.871709e-02 1 1  ON 4
 uu_5                -1.040726e-01 1 1  ON 5
 uu_6                -1.305159e-01 1 1  ON 6
 uu_7                -1.431737e-01 1 1  ON 7
 uu_8                -1.349493e-01 1 1  ON 8
 uu_9                -1.071181e-01 1 1  ON 9
 ud_0                 4.392966e-01 1 1  ON 10
 ud_1                 1.811913e-01 1 1  ON 11
 ud_2                 6.607808e-02 1 1  ON 12
 ud_3                -3.473720e-03 1 1  ON 13
 ud_4                -5.922406e-02 1 1  ON 14
 ud_5                -1.020941e-01 1 1  ON 15
 ud_6                -1.322923e-01 1 1  ON 16
 ud_7                -1.521615e-01 1 1  ON 17
 ud_8                -1.561899e-01 1 1  ON 18
 ud_9                -1.480120e-01 1 1  ON 19
 eO_0                -7.604161e-01 1 1  ON 20
 eO_1                -4.431969e-01 1 1  ON 21
 eO_2                -2.476469e-02 1 1  ON 22
 eO_3                 3.021972e-01 1 1  ON 23
 eO_4                 5.307719e-01 1 1  ON 24
 eO_5                 4.934026e-01 1 1  ON 25
 eO_6                 2.646324e-01 1 1  ON 26
 eO_7                -4.046422e-02 1 1  ON 27
 eO_8                -2.292749e-01 1 1  ON 28
 eO_9                -9.131800e-02 1 1  ON 29
eH1_0                -2.552710e-01 1 1  ON 30
eH1_1                -1.512320e-01 1 1  ON 31
eH1_2                -1.057563e-01 1 1  ON 32
eH1_3                -5.386059e-02 1 1  ON 33
eH1_4                -2.037744e-03 1 1  ON 34
eH1_5                 3.358905e-02 1 1  ON 35
eH1_6                 9.734288e-02 1 1  ON 36
eH1_7                 1.569099e-01 1 1  ON 37
eH1_8                 1.905439e-01 1 1  ON 38
eH1_9                 8.662647e-02 1 1  ON 39
eH2_0                -2.488844e-01 1 1  ON 40
eH2_1                -1.449142e-01 1 1  ON 41
eH2_2                -9.984150e-02 1 1  ON 42
eH2_3                -4.778030e-02 1 1  ON 43
eH2_4                 3.709563e-03 1 1  ON 44
eH2_5                 3.864560e-02 1 1  ON 45
eH2_6                 1.007916e-01 1 1  ON 46
eH2_7                 1.585940e-01 1 1  ON 47
eH2_8                 1.914328e-01 1 1  ON 48
eH2_9                 6.508852e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1531e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9404
    reference variance = 0.234578
====================================================
  Execution time = 4.3293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0645e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242351872
                                         uncertainty =       0.007407901454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242351872
                                         uncertainty =       0.007407901454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413040804
  error estimate for blocks of size 2^( 2) =       0.000425020000
  error estimate for blocks of size 2^( 3) =       0.000436949048
  error estimate for blocks of size 2^( 4) =       0.000449375492
  error estimate for blocks of size 2^( 5) =       0.000459865067
  error estimate for blocks of size 2^( 6) =       0.000467211652
  error estimate for blocks of size 2^( 7) =       0.000471348059

      target function =                  N/A
              le_mean =     -16.910892157522
             les_mean =     286.319478804470
             stat err =       0.000461950068
             autocorr =       1.250846896469
              std dev =       0.584127907008
             le_variance =       0.341205411746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691089215752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910892157522       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910892672322       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910893559215       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910895530029       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910899098966       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910898590147       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910899017405       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910897803801       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910897583387       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910897765708       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910898132226       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910898284828       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910898403361       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.398244e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910892157522       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910892468040       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910892777851       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910893675312       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910895379307       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910895009205       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910895123751       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910894704469       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910894624122       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910894728134       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.582447e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910892157522       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910892277539       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910892339681       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910892587693       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910893223140       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910893127017       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910893104217       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910893036857       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.089387e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3950e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.077825e-01 1 1  ON 0
 uu_1                 1.426178e-01 1 1  ON 1
 uu_2                 4.446542e-02 1 1  ON 2
 uu_3                -1.911376e-02 1 1  ON 3
 uu_4                -6.862840e-02 1 1  ON 4
 uu_5                -1.042371e-01 1 1  ON 5
 uu_6                -1.308487e-01 1 1  ON 6
 uu_7                -1.431791e-01 1 1  ON 7
 uu_8                -1.349582e-01 1 1  ON 8
 uu_9                -1.073020e-01 1 1  ON 9
 ud_0                 4.395092e-01 1 1  ON 10
 ud_1                 1.813601e-01 1 1  ON 11
 ud_2                 6.627317e-02 1 1  ON 12
 ud_3                -3.364059e-03 1 1  ON 13
 ud_4                -5.920071e-02 1 1  ON 14
 ud_5                -1.019205e-01 1 1  ON 15
 ud_6                -1.322221e-01 1 1  ON 16
 ud_7                -1.521922e-01 1 1  ON 17
 ud_8                -1.562720e-01 1 1  ON 18
 ud_9                -1.483049e-01 1 1  ON 19
 eO_0                -7.603167e-01 1 1  ON 20
 eO_1                -4.430452e-01 1 1  ON 21
 eO_2                -2.477417e-02 1 1  ON 22
 eO_3                 3.023440e-01 1 1  ON 23
 eO_4                 5.309928e-01 1 1  ON 24
 eO_5                 4.935053e-01 1 1  ON 25
 eO_6                 2.647785e-01 1 1  ON 26
 eO_7                -4.020762e-02 1 1  ON 27
 eO_8                -2.296882e-01 1 1  ON 28
 eO_9                -9.191560e-02 1 1  ON 29
eH1_0                -2.554243e-01 1 1  ON 30
eH1_1                -1.515661e-01 1 1  ON 31
eH1_2                -1.061761e-01 1 1  ON 32
eH1_3                -5.380879e-02 1 1  ON 33
eH1_4                -1.962249e-03 1 1  ON 34
eH1_5                 3.360135e-02 1 1  ON 35
eH1_6                 9.733157e-02 1 1  ON 36
eH1_7                 1.570578e-01 1 1  ON 37
eH1_8                 1.907532e-01 1 1  ON 38
eH1_9                 8.703631e-02 1 1  ON 39
eH2_0                -2.495061e-01 1 1  ON 40
eH2_1                -1.454169e-01 1 1  ON 41
eH2_2                -1.001353e-01 1 1  ON 42
eH2_3                -4.788371e-02 1 1  ON 43
eH2_4                 3.589792e-03 1 1  ON 44
eH2_5                 3.893819e-02 1 1  ON 45
eH2_6                 1.007777e-01 1 1  ON 46
eH2_7                 1.585766e-01 1 1  ON 47
eH2_8                 1.918562e-01 1 1  ON 48
eH2_9                 6.594676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.470751
====================================================
  Execution time = 4.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3329e-01
  Total weights = 2.0000e+06
  Execution time = 4.6524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333141848220
                                         uncertainty =       0.004234065397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333141848220
                                         uncertainty =       0.004234065397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408214057
  error estimate for blocks of size 2^( 2) =       0.000419828358
  error estimate for blocks of size 2^( 3) =       0.000432282810
  error estimate for blocks of size 2^( 4) =       0.000443848413
  error estimate for blocks of size 2^( 5) =       0.000455374367
  error estimate for blocks of size 2^( 6) =       0.000464021189
  error estimate for blocks of size 2^( 7) =       0.000468311122

      target function =                  N/A
              le_mean =     -16.909899984723
             les_mean =     286.277994758618
             stat err =       0.000457888773
             autocorr =       1.258183772398
              std dev =       0.577301855109
             le_variance =       0.333277431912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333178620284
                                         uncertainty =       0.004234424555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333178620284
                                         uncertainty =       0.004234424555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408236552
  error estimate for blocks of size 2^( 2) =       0.000419847266
  error estimate for blocks of size 2^( 3) =       0.000432293016
  error estimate for blocks of size 2^( 4) =       0.000443857290
  error estimate for blocks of size 2^( 5) =       0.000455383473
  error estimate for blocks of size 2^( 6) =       0.000464041012
  error estimate for blocks of size 2^( 7) =       0.000468322347

      target function =                  N/A
              le_mean =     -16.909899902765
             les_mean =     286.278028719610
             stat err =       0.000457901030
             autocorr =       1.258112470074
              std dev =       0.577333668472
             le_variance =       0.333314164751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333177334576
                                         uncertainty =       0.004234395497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333177334576
                                         uncertainty =       0.004234395497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235777
  error estimate for blocks of size 2^( 2) =       0.000419847288
  error estimate for blocks of size 2^( 3) =       0.000432294904
  error estimate for blocks of size 2^( 4) =       0.000443862461
  error estimate for blocks of size 2^( 5) =       0.000455389855
  error estimate for blocks of size 2^( 6) =       0.000464046852
  error estimate for blocks of size 2^( 7) =       0.000468327217

      target function =                  N/A
              le_mean =     -16.909900811290
             les_mean =     286.278058180640
             stat err =       0.000457906596
             autocorr =       1.258147831150
              std dev =       0.577332572801
             le_variance =       0.333312899617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333137738175
                                         uncertainty =       0.004234081517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333137738175
                                         uncertainty =       0.004234081517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408211539
  error estimate for blocks of size 2^( 2) =       0.000419825652
  error estimate for blocks of size 2^( 3) =       0.000432279162
  error estimate for blocks of size 2^( 4) =       0.000443845435
  error estimate for blocks of size 2^( 5) =       0.000455372098
  error estimate for blocks of size 2^( 6) =       0.000464020574
  error estimate for blocks of size 2^( 7) =       0.000468308809

      target function =                  N/A
              le_mean =     -16.909900088196
             les_mean =     286.277994147706
             stat err =       0.000457886729
             autocorr =       1.258188058991
              std dev =       0.577298295141
             le_variance =       0.333273321573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909899984723        initial
     6.2500e-02     6.2500e-01             3.3982e-03       -16.909899902765
     2.5000e-01     2.5000e+00             8.5824e-04       -16.909900811290  <--
     1.0000e+00     1.0000e+01             2.0894e-04       -16.909900088196

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3500e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.077825e-01 1 1  ON 0
 uu_1                 1.426178e-01 1 1  ON 1
 uu_2                 4.446542e-02 1 1  ON 2
 uu_3                -1.911376e-02 1 1  ON 3
 uu_4                -6.862840e-02 1 1  ON 4
 uu_5                -1.042371e-01 1 1  ON 5
 uu_6                -1.308487e-01 1 1  ON 6
 uu_7                -1.431791e-01 1 1  ON 7
 uu_8                -1.349582e-01 1 1  ON 8
 uu_9                -1.073020e-01 1 1  ON 9
 ud_0                 4.395092e-01 1 1  ON 10
 ud_1                 1.813601e-01 1 1  ON 11
 ud_2                 6.627317e-02 1 1  ON 12
 ud_3                -3.364059e-03 1 1  ON 13
 ud_4                -5.920071e-02 1 1  ON 14
 ud_5                -1.019205e-01 1 1  ON 15
 ud_6                -1.322221e-01 1 1  ON 16
 ud_7                -1.521922e-01 1 1  ON 17
 ud_8                -1.562720e-01 1 1  ON 18
 ud_9                -1.483049e-01 1 1  ON 19
 eO_0                -7.603167e-01 1 1  ON 20
 eO_1                -4.430452e-01 1 1  ON 21
 eO_2                -2.477417e-02 1 1  ON 22
 eO_3                 3.023440e-01 1 1  ON 23
 eO_4                 5.309928e-01 1 1  ON 24
 eO_5                 4.935053e-01 1 1  ON 25
 eO_6                 2.647785e-01 1 1  ON 26
 eO_7                -4.020762e-02 1 1  ON 27
 eO_8                -2.296882e-01 1 1  ON 28
 eO_9                -9.191560e-02 1 1  ON 29
eH1_0                -2.554243e-01 1 1  ON 30
eH1_1                -1.515661e-01 1 1  ON 31
eH1_2                -1.061761e-01 1 1  ON 32
eH1_3                -5.380879e-02 1 1  ON 33
eH1_4                -1.962249e-03 1 1  ON 34
eH1_5                 3.360135e-02 1 1  ON 35
eH1_6                 9.733157e-02 1 1  ON 36
eH1_7                 1.570578e-01 1 1  ON 37
eH1_8                 1.907532e-01 1 1  ON 38
eH1_9                 8.703631e-02 1 1  ON 39
eH2_0                -2.495061e-01 1 1  ON 40
eH2_1                -1.454169e-01 1 1  ON 41
eH2_2                -1.001353e-01 1 1  ON 42
eH2_3                -4.788371e-02 1 1  ON 43
eH2_4                 3.589792e-03 1 1  ON 44
eH2_5                 3.893819e-02 1 1  ON 45
eH2_6                 1.007777e-01 1 1  ON 46
eH2_7                 1.585766e-01 1 1  ON 47
eH2_8                 1.918562e-01 1 1  ON 48
eH2_9                 6.594676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1746e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.17675
====================================================
  Execution time = 4.1218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0799e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332758246355
                                         uncertainty =       0.004490888403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332758246355
                                         uncertainty =       0.004490888403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407886281
  error estimate for blocks of size 2^( 2) =       0.000419379534
  error estimate for blocks of size 2^( 3) =       0.000431635097
  error estimate for blocks of size 2^( 4) =       0.000442836009
  error estimate for blocks of size 2^( 5) =       0.000453150508
  error estimate for blocks of size 2^( 6) =       0.000459942079
  error estimate for blocks of size 2^( 7) =       0.000466465704

      target function =                  N/A
              le_mean =     -16.910494893699
             les_mean =     286.297579820515
             stat err =       0.000455598575
             autocorr =       1.247632031903
              std dev =       0.576838311028
             le_variance =       0.332742437070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691049489370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910494893699       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910498671922       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910500709062       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910502404406       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910502923008       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910502776869       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910503365310       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910504986672       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910505731745       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910505944486       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910506222926       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910505856869       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910505800463       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.476415e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910494893699       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910497405720       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910498247555       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910499192819       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910499203829       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910499027831       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910498933446       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910499347912       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910499411831       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910499503933       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.611635e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910494893699       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910495966970       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910496187565       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910496499924       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910496445827       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910496393011       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910496324819       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910496412269       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910496431547       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.195760e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2029e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.077530e-01 1 1  ON 0
 uu_1                 1.427665e-01 1 1  ON 1
 uu_2                 4.464216e-02 1 1  ON 2
 uu_3                -1.886411e-02 1 1  ON 3
 uu_4                -6.859476e-02 1 1  ON 4
 uu_5                -1.043078e-01 1 1  ON 5
 uu_6                -1.310828e-01 1 1  ON 6
 uu_7                -1.436981e-01 1 1  ON 7
 uu_8                -1.353800e-01 1 1  ON 8
 uu_9                -1.075803e-01 1 1  ON 9
 ud_0                 4.394325e-01 1 1  ON 10
 ud_1                 1.813602e-01 1 1  ON 11
 ud_2                 6.620724e-02 1 1  ON 12
 ud_3                -3.364458e-03 1 1  ON 13
 ud_4                -5.917121e-02 1 1  ON 14
 ud_5                -1.019748e-01 1 1  ON 15
 ud_6                -1.320804e-01 1 1  ON 16
 ud_7                -1.521468e-01 1 1  ON 17
 ud_8                -1.559713e-01 1 1  ON 18
 ud_9                -1.483486e-01 1 1  ON 19
 eO_0                -7.602753e-01 1 1  ON 20
 eO_1                -4.430588e-01 1 1  ON 21
 eO_2                -2.505817e-02 1 1  ON 22
 eO_3                 3.024107e-01 1 1  ON 23
 eO_4                 5.311381e-01 1 1  ON 24
 eO_5                 4.937930e-01 1 1  ON 25
 eO_6                 2.654774e-01 1 1  ON 26
 eO_7                -4.022313e-02 1 1  ON 27
 eO_8                -2.300480e-01 1 1  ON 28
 eO_9                -9.239967e-02 1 1  ON 29
eH1_0                -2.559213e-01 1 1  ON 30
eH1_1                -1.515342e-01 1 1  ON 31
eH1_2                -1.063256e-01 1 1  ON 32
eH1_3                -5.424690e-02 1 1  ON 33
eH1_4                -1.888145e-03 1 1  ON 34
eH1_5                 3.378573e-02 1 1  ON 35
eH1_6                 9.709140e-02 1 1  ON 36
eH1_7                 1.567498e-01 1 1  ON 37
eH1_8                 1.911517e-01 1 1  ON 38
eH1_9                 8.783653e-02 1 1  ON 39
eH2_0                -2.500323e-01 1 1  ON 40
eH2_1                -1.454882e-01 1 1  ON 41
eH2_2                -1.003062e-01 1 1  ON 42
eH2_3                -4.793458e-02 1 1  ON 43
eH2_4                 3.403604e-03 1 1  ON 44
eH2_5                 3.848654e-02 1 1  ON 45
eH2_6                 1.010507e-01 1 1  ON 46
eH2_7                 1.584933e-01 1 1  ON 47
eH2_8                 1.921030e-01 1 1  ON 48
eH2_9                 6.680793e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.163715
====================================================
  Execution time = 4.0101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3937e-01
  Total weights = 2.0000e+06
  Execution time = 4.6345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339429636849
                                         uncertainty =       0.007857547217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339429636849
                                         uncertainty =       0.007857547217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411997111
  error estimate for blocks of size 2^( 2) =       0.000423394391
  error estimate for blocks of size 2^( 3) =       0.000435903530
  error estimate for blocks of size 2^( 4) =       0.000447746283
  error estimate for blocks of size 2^( 5) =       0.000456814622
  error estimate for blocks of size 2^( 6) =       0.000463807673
  error estimate for blocks of size 2^( 7) =       0.000472173195

      target function =                  N/A
              le_mean =     -16.911274803981
             les_mean =     286.330698564437
             stat err =       0.000460135443
             autocorr =       1.247334784417
              std dev =       0.582651901573
             le_variance =       0.339483238406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339283266531
                                         uncertainty =       0.007844059407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339283266531
                                         uncertainty =       0.007844059407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411908171
  error estimate for blocks of size 2^( 2) =       0.000423310015
  error estimate for blocks of size 2^( 3) =       0.000435820105
  error estimate for blocks of size 2^( 4) =       0.000447663673
  error estimate for blocks of size 2^( 5) =       0.000456729158
  error estimate for blocks of size 2^( 6) =       0.000463738631
  error estimate for blocks of size 2^( 7) =       0.000472113674

      target function =                  N/A
              le_mean =     -16.911277860341
             les_mean =     286.330655383004
             stat err =       0.000460061284
             autocorr =       1.247471291365
              std dev =       0.582526122184
             le_variance =       0.339336683026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339202718471
                                         uncertainty =       0.007848848612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339202718471
                                         uncertainty =       0.007848848612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411859271
  error estimate for blocks of size 2^( 2) =       0.000423264225
  error estimate for blocks of size 2^( 3) =       0.000435779661
  error estimate for blocks of size 2^( 4) =       0.000447627714
  error estimate for blocks of size 2^( 5) =       0.000456695511
  error estimate for blocks of size 2^( 6) =       0.000463708394
  error estimate for blocks of size 2^( 7) =       0.000472081689

      target function =                  N/A
              le_mean =     -16.911278057724
             les_mean =     286.330581494655
             stat err =       0.000460028327
             autocorr =       1.247588767855
              std dev =       0.582456967181
             le_variance =       0.339256118618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339385684560
                                         uncertainty =       0.007856146303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339385684560
                                         uncertainty =       0.007856146303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970411
  error estimate for blocks of size 2^( 2) =       0.000423368909
  error estimate for blocks of size 2^( 3) =       0.000435879260
  error estimate for blocks of size 2^( 4) =       0.000447722974
  error estimate for blocks of size 2^( 5) =       0.000456791352
  error estimate for blocks of size 2^( 6) =       0.000463788181
  error estimate for blocks of size 2^( 7) =       0.000472155789

      target function =                  N/A
              le_mean =     -16.911275207339
             les_mean =     286.330668207838
             stat err =       0.000460114574
             autocorr =       1.247383311491
              std dev =       0.582614142624
             le_variance =       0.339439239186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911274803981        initial
     6.2500e-02     6.2500e-01             3.4764e-03       -16.911277860341
     2.5000e-01     2.5000e+00             8.6116e-04       -16.911278057724  <--
     1.0000e+00     1.0000e+01             2.1958e-04       -16.911275207339

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3331e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.077530e-01 1 1  ON 0
 uu_1                 1.427665e-01 1 1  ON 1
 uu_2                 4.464216e-02 1 1  ON 2
 uu_3                -1.886411e-02 1 1  ON 3
 uu_4                -6.859476e-02 1 1  ON 4
 uu_5                -1.043078e-01 1 1  ON 5
 uu_6                -1.310828e-01 1 1  ON 6
 uu_7                -1.436981e-01 1 1  ON 7
 uu_8                -1.353800e-01 1 1  ON 8
 uu_9                -1.075803e-01 1 1  ON 9
 ud_0                 4.394325e-01 1 1  ON 10
 ud_1                 1.813602e-01 1 1  ON 11
 ud_2                 6.620724e-02 1 1  ON 12
 ud_3                -3.364458e-03 1 1  ON 13
 ud_4                -5.917121e-02 1 1  ON 14
 ud_5                -1.019748e-01 1 1  ON 15
 ud_6                -1.320804e-01 1 1  ON 16
 ud_7                -1.521468e-01 1 1  ON 17
 ud_8                -1.559713e-01 1 1  ON 18
 ud_9                -1.483486e-01 1 1  ON 19
 eO_0                -7.602753e-01 1 1  ON 20
 eO_1                -4.430588e-01 1 1  ON 21
 eO_2                -2.505817e-02 1 1  ON 22
 eO_3                 3.024107e-01 1 1  ON 23
 eO_4                 5.311381e-01 1 1  ON 24
 eO_5                 4.937930e-01 1 1  ON 25
 eO_6                 2.654774e-01 1 1  ON 26
 eO_7                -4.022313e-02 1 1  ON 27
 eO_8                -2.300480e-01 1 1  ON 28
 eO_9                -9.239967e-02 1 1  ON 29
eH1_0                -2.559213e-01 1 1  ON 30
eH1_1                -1.515342e-01 1 1  ON 31
eH1_2                -1.063256e-01 1 1  ON 32
eH1_3                -5.424690e-02 1 1  ON 33
eH1_4                -1.888145e-03 1 1  ON 34
eH1_5                 3.378573e-02 1 1  ON 35
eH1_6                 9.709140e-02 1 1  ON 36
eH1_7                 1.567498e-01 1 1  ON 37
eH1_8                 1.911517e-01 1 1  ON 38
eH1_9                 8.783653e-02 1 1  ON 39
eH2_0                -2.500323e-01 1 1  ON 40
eH2_1                -1.454882e-01 1 1  ON 41
eH2_2                -1.003062e-01 1 1  ON 42
eH2_3                -4.793458e-02 1 1  ON 43
eH2_4                 3.403604e-03 1 1  ON 44
eH2_5                 3.848654e-02 1 1  ON 45
eH2_6                 1.010507e-01 1 1  ON 46
eH2_7                 1.584933e-01 1 1  ON 47
eH2_8                 1.921030e-01 1 1  ON 48
eH2_9                 6.680793e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1537e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.157817
====================================================
  Execution time = 4.0691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3187e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0754e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331951526913
                                         uncertainty =       0.004272097209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331951526913
                                         uncertainty =       0.004272097209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407350214
  error estimate for blocks of size 2^( 2) =       0.000419027239
  error estimate for blocks of size 2^( 3) =       0.000430726237
  error estimate for blocks of size 2^( 4) =       0.000442371932
  error estimate for blocks of size 2^( 5) =       0.000451890583
  error estimate for blocks of size 2^( 6) =       0.000458897029
  error estimate for blocks of size 2^( 7) =       0.000461750909

      target function =                  N/A
              le_mean =     -16.909755130836
             les_mean =     286.271686812127
             stat err =       0.000453727613
             autocorr =       1.240664983013
              std dev =       0.576080196866
             le_variance =       0.331868393221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690975513084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909755130836       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909755759082       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909756669177       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909755885515       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909757638965       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909760047231       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909761436421       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909760413089       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909760369271       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909760856931       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909760343889       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909760320991       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909760808403       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.336091e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909755130836       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909755518686       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909756028371       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909755457884       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909756361353       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909756969582       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909756998731       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909756964142       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909756978630       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909756944183       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.419953e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909755130836       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909755284101       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909755490978       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909755286589       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909755404675       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909755548823       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909755549341       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909755613553       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.309366e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1457e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.080219e-01 1 1  ON 0
 uu_1                 1.427449e-01 1 1  ON 1
 uu_2                 4.468921e-02 1 1  ON 2
 uu_3                -1.892136e-02 1 1  ON 3
 uu_4                -6.864519e-02 1 1  ON 4
 uu_5                -1.044289e-01 1 1  ON 5
 uu_6                -1.310798e-01 1 1  ON 6
 uu_7                -1.438979e-01 1 1  ON 7
 uu_8                -1.358622e-01 1 1  ON 8
 uu_9                -1.076704e-01 1 1  ON 9
 ud_0                 4.397125e-01 1 1  ON 10
 ud_1                 1.811788e-01 1 1  ON 11
 ud_2                 6.606477e-02 1 1  ON 12
 ud_3                -3.545218e-03 1 1  ON 13
 ud_4                -5.922618e-02 1 1  ON 14
 ud_5                -1.021522e-01 1 1  ON 15
 ud_6                -1.322099e-01 1 1  ON 16
 ud_7                -1.522088e-01 1 1  ON 17
 ud_8                -1.558462e-01 1 1  ON 18
 ud_9                -1.480227e-01 1 1  ON 19
 eO_0                -7.600388e-01 1 1  ON 20
 eO_1                -4.431695e-01 1 1  ON 21
 eO_2                -2.503332e-02 1 1  ON 22
 eO_3                 3.022993e-01 1 1  ON 23
 eO_4                 5.314177e-01 1 1  ON 24
 eO_5                 4.941032e-01 1 1  ON 25
 eO_6                 2.657071e-01 1 1  ON 26
 eO_7                -4.026231e-02 1 1  ON 27
 eO_8                -2.303894e-01 1 1  ON 28
 eO_9                -9.283096e-02 1 1  ON 29
eH1_0                -2.567027e-01 1 1  ON 30
eH1_1                -1.516649e-01 1 1  ON 31
eH1_2                -1.065528e-01 1 1  ON 32
eH1_3                -5.428700e-02 1 1  ON 33
eH1_4                -1.802522e-03 1 1  ON 34
eH1_5                 3.366766e-02 1 1  ON 35
eH1_6                 9.662071e-02 1 1  ON 36
eH1_7                 1.567403e-01 1 1  ON 37
eH1_8                 1.917695e-01 1 1  ON 38
eH1_9                 8.867853e-02 1 1  ON 39
eH2_0                -2.502891e-01 1 1  ON 40
eH2_1                -1.458195e-01 1 1  ON 41
eH2_2                -1.005209e-01 1 1  ON 42
eH2_3                -4.809494e-02 1 1  ON 43
eH2_4                 3.320972e-03 1 1  ON 44
eH2_5                 3.796317e-02 1 1  ON 45
eH2_6                 1.009084e-01 1 1  ON 46
eH2_7                 1.589174e-01 1 1  ON 47
eH2_8                 1.925062e-01 1 1  ON 48
eH2_9                 6.759833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9402
    reference variance = 0.213119
====================================================
  Execution time = 4.2312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4605e-01
  Total weights = 2.0000e+06
  Execution time = 4.6291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345766166924
                                         uncertainty =       0.010289642144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345766166924
                                         uncertainty =       0.010289642144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739944
  error estimate for blocks of size 2^( 2) =       0.000427649689
  error estimate for blocks of size 2^( 3) =       0.000438875905
  error estimate for blocks of size 2^( 4) =       0.000450482903
  error estimate for blocks of size 2^( 5) =       0.000460440245
  error estimate for blocks of size 2^( 6) =       0.000467508132
  error estimate for blocks of size 2^( 7) =       0.000472842265

      target function =                  N/A
              le_mean =     -16.911239895426
             les_mean =     286.335714029538
             stat err =       0.000462818386
             autocorr =       1.239303572388
              std dev =       0.587945066921
             le_variance =       0.345679401717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346305079100
                                         uncertainty =       0.010297577228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346305079100
                                         uncertainty =       0.010297577228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416063965
  error estimate for blocks of size 2^( 2) =       0.000427963717
  error estimate for blocks of size 2^( 3) =       0.000439172030
  error estimate for blocks of size 2^( 4) =       0.000450761479
  error estimate for blocks of size 2^( 5) =       0.000460707844
  error estimate for blocks of size 2^( 6) =       0.000467766969
  error estimate for blocks of size 2^( 7) =       0.000473085595

      target function =                  N/A
              le_mean =     -16.911244708854
             les_mean =     286.336415875302
             stat err =       0.000463080472
             autocorr =       1.238775842576
              std dev =       0.588403301892
             le_variance =       0.346218445677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346515930837
                                         uncertainty =       0.010301069827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346515930837
                                         uncertainty =       0.010301069827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416190652
  error estimate for blocks of size 2^( 2) =       0.000428083541
  error estimate for blocks of size 2^( 3) =       0.000439284714
  error estimate for blocks of size 2^( 4) =       0.000450871530
  error estimate for blocks of size 2^( 5) =       0.000460816689
  error estimate for blocks of size 2^( 6) =       0.000467874715
  error estimate for blocks of size 2^( 7) =       0.000473191815

      target function =                  N/A
              le_mean =     -16.911246540860
             les_mean =     286.336688709535
             stat err =       0.000463188687
             autocorr =       1.238600484183
              std dev =       0.588582464060
             le_variance =       0.346429316999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345949138496
                                         uncertainty =       0.010292595113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345949138496
                                         uncertainty =       0.010292595113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415849973
  error estimate for blocks of size 2^( 2) =       0.000427755344
  error estimate for blocks of size 2^( 3) =       0.000438975449
  error estimate for blocks of size 2^( 4) =       0.000450577721
  error estimate for blocks of size 2^( 5) =       0.000460532222
  error estimate for blocks of size 2^( 6) =       0.000467598010
  error estimate for blocks of size 2^( 7) =       0.000472928042

      target function =                  N/A
              le_mean =     -16.911241163107
             les_mean =     286.335939904223
             stat err =       0.000462908999
             autocorr =       1.239132908322
              std dev =       0.588100671984
             le_variance =       0.345862400388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911239895426        initial
     6.2500e-02     6.2500e-01             3.3361e-03       -16.911244708854
     2.5000e-01     2.5000e+00             8.4200e-04       -16.911246540860  <--
     1.0000e+00     1.0000e+01             2.3094e-04       -16.911241163107

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.5522e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.080219e-01 1 1  ON 0
 uu_1                 1.427449e-01 1 1  ON 1
 uu_2                 4.468921e-02 1 1  ON 2
 uu_3                -1.892136e-02 1 1  ON 3
 uu_4                -6.864519e-02 1 1  ON 4
 uu_5                -1.044289e-01 1 1  ON 5
 uu_6                -1.310798e-01 1 1  ON 6
 uu_7                -1.438979e-01 1 1  ON 7
 uu_8                -1.358622e-01 1 1  ON 8
 uu_9                -1.076704e-01 1 1  ON 9
 ud_0                 4.397125e-01 1 1  ON 10
 ud_1                 1.811788e-01 1 1  ON 11
 ud_2                 6.606477e-02 1 1  ON 12
 ud_3                -3.545218e-03 1 1  ON 13
 ud_4                -5.922618e-02 1 1  ON 14
 ud_5                -1.021522e-01 1 1  ON 15
 ud_6                -1.322099e-01 1 1  ON 16
 ud_7                -1.522088e-01 1 1  ON 17
 ud_8                -1.558462e-01 1 1  ON 18
 ud_9                -1.480227e-01 1 1  ON 19
 eO_0                -7.600388e-01 1 1  ON 20
 eO_1                -4.431695e-01 1 1  ON 21
 eO_2                -2.503332e-02 1 1  ON 22
 eO_3                 3.022993e-01 1 1  ON 23
 eO_4                 5.314177e-01 1 1  ON 24
 eO_5                 4.941032e-01 1 1  ON 25
 eO_6                 2.657071e-01 1 1  ON 26
 eO_7                -4.026231e-02 1 1  ON 27
 eO_8                -2.303894e-01 1 1  ON 28
 eO_9                -9.283096e-02 1 1  ON 29
eH1_0                -2.567027e-01 1 1  ON 30
eH1_1                -1.516649e-01 1 1  ON 31
eH1_2                -1.065528e-01 1 1  ON 32
eH1_3                -5.428700e-02 1 1  ON 33
eH1_4                -1.802522e-03 1 1  ON 34
eH1_5                 3.366766e-02 1 1  ON 35
eH1_6                 9.662071e-02 1 1  ON 36
eH1_7                 1.567403e-01 1 1  ON 37
eH1_8                 1.917695e-01 1 1  ON 38
eH1_9                 8.867853e-02 1 1  ON 39
eH2_0                -2.502891e-01 1 1  ON 40
eH2_1                -1.458195e-01 1 1  ON 41
eH2_2                -1.005209e-01 1 1  ON 42
eH2_3                -4.809494e-02 1 1  ON 43
eH2_4                 3.320972e-03 1 1  ON 44
eH2_5                 3.796317e-02 1 1  ON 45
eH2_6                 1.009084e-01 1 1  ON 46
eH2_7                 1.589174e-01 1 1  ON 47
eH2_8                 1.925062e-01 1 1  ON 48
eH2_9                 6.759833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8524
    reference variance = 0.205466
====================================================
  Execution time = 4.0814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0709e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332646913484
                                         uncertainty =       0.004656377888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332646913484
                                         uncertainty =       0.004656377888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407783353
  error estimate for blocks of size 2^( 2) =       0.000419780737
  error estimate for blocks of size 2^( 3) =       0.000431778309
  error estimate for blocks of size 2^( 4) =       0.000443109495
  error estimate for blocks of size 2^( 5) =       0.000454401835
  error estimate for blocks of size 2^( 6) =       0.000461862117
  error estimate for blocks of size 2^( 7) =       0.000469033482

      target function =                  N/A
              le_mean =     -16.911031156049
             les_mean =     286.315549120171
             stat err =       0.000457101732
             autocorr =       1.256512315770
              std dev =       0.576692747992
             le_variance =       0.332574525587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691103115605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031156049       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031446107       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911033267615       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911034737403       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911034897231       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911034159403       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911035100912       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911033451631       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911033863669       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911034971650       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911035009592       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911035917887       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911035782233       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.668533e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031156049       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031320394       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032239507       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911032594195       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911033044094       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911032655053       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911032652716       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911032614106       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911032377372       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911032660709       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.166460e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911031156049       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911031216169       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911031546905       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911031562305       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911031774922       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911031700525       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911031653137       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911031614143       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911031640357       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.313936e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1538e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.080662e-01 1 1  ON 0
 uu_1                 1.426654e-01 1 1  ON 1
 uu_2                 4.453913e-02 1 1  ON 2
 uu_3                -1.900261e-02 1 1  ON 3
 uu_4                -6.864753e-02 1 1  ON 4
 uu_5                -1.044593e-01 1 1  ON 5
 uu_6                -1.315253e-01 1 1  ON 6
 uu_7                -1.439469e-01 1 1  ON 7
 uu_8                -1.356939e-01 1 1  ON 8
 uu_9                -1.075883e-01 1 1  ON 9
 ud_0                 4.393611e-01 1 1  ON 10
 ud_1                 1.810361e-01 1 1  ON 11
 ud_2                 6.607829e-02 1 1  ON 12
 ud_3                -3.532575e-03 1 1  ON 13
 ud_4                -5.921396e-02 1 1  ON 14
 ud_5                -1.020912e-01 1 1  ON 15
 ud_6                -1.322730e-01 1 1  ON 16
 ud_7                -1.523244e-01 1 1  ON 17
 ud_8                -1.556077e-01 1 1  ON 18
 ud_9                -1.478202e-01 1 1  ON 19
 eO_0                -7.599766e-01 1 1  ON 20
 eO_1                -4.429781e-01 1 1  ON 21
 eO_2                -2.508292e-02 1 1  ON 22
 eO_3                 3.022060e-01 1 1  ON 23
 eO_4                 5.313516e-01 1 1  ON 24
 eO_5                 4.942691e-01 1 1  ON 25
 eO_6                 2.660072e-01 1 1  ON 26
 eO_7                -4.005861e-02 1 1  ON 27
 eO_8                -2.307421e-01 1 1  ON 28
 eO_9                -9.315867e-02 1 1  ON 29
eH1_0                -2.567923e-01 1 1  ON 30
eH1_1                -1.521864e-01 1 1  ON 31
eH1_2                -1.068586e-01 1 1  ON 32
eH1_3                -5.441822e-02 1 1  ON 33
eH1_4                -2.381975e-03 1 1  ON 34
eH1_5                 3.325711e-02 1 1  ON 35
eH1_6                 9.681592e-02 1 1  ON 36
eH1_7                 1.571803e-01 1 1  ON 37
eH1_8                 1.923855e-01 1 1  ON 38
eH1_9                 8.932002e-02 1 1  ON 39
eH2_0                -2.507246e-01 1 1  ON 40
eH2_1                -1.461257e-01 1 1  ON 41
eH2_2                -1.007432e-01 1 1  ON 42
eH2_3                -4.839217e-02 1 1  ON 43
eH2_4                 3.164801e-03 1 1  ON 44
eH2_5                 3.763042e-02 1 1  ON 45
eH2_6                 1.007221e-01 1 1  ON 46
eH2_7                 1.591638e-01 1 1  ON 47
eH2_8                 1.931902e-01 1 1  ON 48
eH2_9                 6.851498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.357082
====================================================
  Execution time = 3.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3376e-01
  Total weights = 2.0000e+06
  Execution time = 4.6322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333959980067
                                         uncertainty =       0.006085054136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333959980067
                                         uncertainty =       0.006085054136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408638585
  error estimate for blocks of size 2^( 2) =       0.000420719119
  error estimate for blocks of size 2^( 3) =       0.000432020106
  error estimate for blocks of size 2^( 4) =       0.000442940429
  error estimate for blocks of size 2^( 5) =       0.000452723142
  error estimate for blocks of size 2^( 6) =       0.000460338776
  error estimate for blocks of size 2^( 7) =       0.000465010997

      target function =                  N/A
              le_mean =     -16.909839558934
             les_mean =     286.276644728081
             stat err =       0.000455253336
             autocorr =       1.241159313360
              std dev =       0.577902228907
             le_variance =       0.333970986176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333644355806
                                         uncertainty =       0.006072786618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333644355806
                                         uncertainty =       0.006072786618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408445438
  error estimate for blocks of size 2^( 2) =       0.000420544558
  error estimate for blocks of size 2^( 3) =       0.000431862406
  error estimate for blocks of size 2^( 4) =       0.000442790890
  error estimate for blocks of size 2^( 5) =       0.000452571147
  error estimate for blocks of size 2^( 6) =       0.000460187185
  error estimate for blocks of size 2^( 7) =       0.000464844379

      target function =                  N/A
              le_mean =     -16.909840338064
             les_mean =     286.276355443070
             stat err =       0.000455098400
             autocorr =       1.241487978717
              std dev =       0.577629077431
             le_variance =       0.333655351094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333553485121
                                         uncertainty =       0.006069096740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333553485121
                                         uncertainty =       0.006069096740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408389792
  error estimate for blocks of size 2^( 2) =       0.000420491164
  error estimate for blocks of size 2^( 3) =       0.000431811344
  error estimate for blocks of size 2^( 4) =       0.000442744079
  error estimate for blocks of size 2^( 5) =       0.000452528448
  error estimate for blocks of size 2^( 6) =       0.000460150942
  error estimate for blocks of size 2^( 7) =       0.000464810502

      target function =                  N/A
              le_mean =     -16.909840002469
             les_mean =     286.276253187045
             stat err =       0.000455058493
             autocorr =       1.241608542177
              std dev =       0.577550382849
             le_variance =       0.333564444729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333865077166
                                         uncertainty =       0.006081364020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333865077166
                                         uncertainty =       0.006081364020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408580509
  error estimate for blocks of size 2^( 2) =       0.000420665351
  error estimate for blocks of size 2^( 3) =       0.000431970235
  error estimate for blocks of size 2^( 4) =       0.000442893007
  error estimate for blocks of size 2^( 5) =       0.000452676390
  error estimate for blocks of size 2^( 6) =       0.000460293914
  error estimate for blocks of size 2^( 7) =       0.000464963902

      target function =                  N/A
              le_mean =     -16.909839217881
             les_mean =     286.276538272294
             stat err =       0.000455206803
             autocorr =       1.241258393573
              std dev =       0.577820097138
             le_variance =       0.333876064657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909839558934        initial
     6.2500e-02     6.2500e-01             3.6685e-03       -16.909840338064  <--
     2.5000e-01     2.5000e+00             9.1665e-04       -16.909840002469
     1.0000e+00     1.0000e+01             2.3139e-04       -16.909839217881

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 6.3210e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.079579e-01 1 1  ON 0
 uu_1                 1.425128e-01 1 1  ON 1
 uu_2                 4.435377e-02 1 1  ON 2
 uu_3                -1.914075e-02 1 1  ON 3
 uu_4                -6.874992e-02 1 1  ON 4
 uu_5                -1.046469e-01 1 1  ON 5
 uu_6                -1.320056e-01 1 1  ON 6
 uu_7                -1.443670e-01 1 1  ON 7
 uu_8                -1.357126e-01 1 1  ON 8
 uu_9                -1.074514e-01 1 1  ON 9
 ud_0                 4.390931e-01 1 1  ON 10
 ud_1                 1.808980e-01 1 1  ON 11
 ud_2                 6.600929e-02 1 1  ON 12
 ud_3                -3.539975e-03 1 1  ON 13
 ud_4                -5.921268e-02 1 1  ON 14
 ud_5                -1.020725e-01 1 1  ON 15
 ud_6                -1.324997e-01 1 1  ON 16
 ud_7                -1.525996e-01 1 1  ON 17
 ud_8                -1.554871e-01 1 1  ON 18
 ud_9                -1.473855e-01 1 1  ON 19
 eO_0                -7.597697e-01 1 1  ON 20
 eO_1                -4.427447e-01 1 1  ON 21
 eO_2                -2.501723e-02 1 1  ON 22
 eO_3                 3.021657e-01 1 1  ON 23
 eO_4                 5.314360e-01 1 1  ON 24
 eO_5                 4.946782e-01 1 1  ON 25
 eO_6                 2.668183e-01 1 1  ON 26
 eO_7                -3.958166e-02 1 1  ON 27
 eO_8                -2.318872e-01 1 1  ON 28
 eO_9                -9.415900e-02 1 1  ON 29
eH1_0                -2.575623e-01 1 1  ON 30
eH1_1                -1.532002e-01 1 1  ON 31
eH1_2                -1.077901e-01 1 1  ON 32
eH1_3                -5.523655e-02 1 1  ON 33
eH1_4                -3.512236e-03 1 1  ON 34
eH1_5                 3.226259e-02 1 1  ON 35
eH1_6                 9.703622e-02 1 1  ON 36
eH1_7                 1.583606e-01 1 1  ON 37
eH1_8                 1.942466e-01 1 1  ON 38
eH1_9                 9.126989e-02 1 1  ON 39
eH2_0                -2.517036e-01 1 1  ON 40
eH2_1                -1.470556e-01 1 1  ON 41
eH2_2                -1.015771e-01 1 1  ON 42
eH2_3                -4.928039e-02 1 1  ON 43
eH2_4                 2.450831e-03 1 1  ON 44
eH2_5                 3.687525e-02 1 1  ON 45
eH2_6                 1.001981e-01 1 1  ON 46
eH2_7                 1.597848e-01 1 1  ON 47
eH2_8                 1.951641e-01 1 1  ON 48
eH2_9                 7.126686e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1476e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.184039
====================================================
  Execution time = 4.0678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0851e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340073561595
                                         uncertainty =       0.010369394831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340073561595
                                         uncertainty =       0.010369394831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412374185
  error estimate for blocks of size 2^( 2) =       0.000424302506
  error estimate for blocks of size 2^( 3) =       0.000436329658
  error estimate for blocks of size 2^( 4) =       0.000448217725
  error estimate for blocks of size 2^( 5) =       0.000457584320
  error estimate for blocks of size 2^( 6) =       0.000466392378
  error estimate for blocks of size 2^( 7) =       0.000471633302

      target function =                  N/A
              le_mean =     -16.911198479348
             les_mean =     286.328738774078
             stat err =       0.000460956931
             autocorr =       1.249504314429
              std dev =       0.583185164615
             le_variance =       0.340104936227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691119847935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911198479348       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911201692062       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911203606519       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911200516657       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911201675971       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911201471894       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911206471057       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911204001607       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911207199570       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911208231129       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911209975838       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911210459495       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911210810058       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911211085461       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911210779926       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911210749730       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911210750787       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.569517e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911198479348       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911201086273       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911202791390       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911200390809       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911200922833       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911201496524       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911204206733       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911202297768       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911203875055       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911204057972       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911204094987       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911203970214       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911203883689       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.021004e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911198479348       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911199965420       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911201178972       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911199787722       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911199889174       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911200701780       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911200701167       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911201170430       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911200896507       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911201173970       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.968120e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1543e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.078772e-01 1 1  ON 0
 uu_1                 1.422750e-01 1 1  ON 1
 uu_2                 4.442081e-02 1 1  ON 2
 uu_3                -1.908004e-02 1 1  ON 3
 uu_4                -6.898097e-02 1 1  ON 4
 uu_5                -1.049621e-01 1 1  ON 5
 uu_6                -1.322811e-01 1 1  ON 6
 uu_7                -1.442082e-01 1 1  ON 7
 uu_8                -1.366126e-01 1 1  ON 8
 uu_9                -1.088197e-01 1 1  ON 9
 ud_0                 4.396986e-01 1 1  ON 10
 ud_1                 1.812616e-01 1 1  ON 11
 ud_2                 6.625700e-02 1 1  ON 12
 ud_3                -3.606342e-03 1 1  ON 13
 ud_4                -5.909290e-02 1 1  ON 14
 ud_5                -1.017627e-01 1 1  ON 15
 ud_6                -1.319396e-01 1 1  ON 16
 ud_7                -1.524949e-01 1 1  ON 17
 ud_8                -1.556314e-01 1 1  ON 18
 ud_9                -1.476680e-01 1 1  ON 19
 eO_0                -7.594033e-01 1 1  ON 20
 eO_1                -4.422237e-01 1 1  ON 21
 eO_2                -2.452257e-02 1 1  ON 22
 eO_3                 3.021785e-01 1 1  ON 23
 eO_4                 5.322869e-01 1 1  ON 24
 eO_5                 4.952225e-01 1 1  ON 25
 eO_6                 2.674789e-01 1 1  ON 26
 eO_7                -3.886504e-02 1 1  ON 27
 eO_8                -2.334655e-01 1 1  ON 28
 eO_9                -9.636127e-02 1 1  ON 29
eH1_0                -2.591325e-01 1 1  ON 30
eH1_1                -1.536410e-01 1 1  ON 31
eH1_2                -1.080451e-01 1 1  ON 32
eH1_3                -5.575024e-02 1 1  ON 33
eH1_4                -3.626823e-03 1 1  ON 34
eH1_5                 3.112983e-02 1 1  ON 35
eH1_6                 9.650678e-02 1 1  ON 36
eH1_7                 1.595053e-01 1 1  ON 37
eH1_8                 1.951859e-01 1 1  ON 38
eH1_9                 9.336301e-02 1 1  ON 39
eH2_0                -2.533848e-01 1 1  ON 40
eH2_1                -1.479156e-01 1 1  ON 41
eH2_2                -1.025176e-01 1 1  ON 42
eH2_3                -4.967852e-02 1 1  ON 43
eH2_4                 1.756245e-03 1 1  ON 44
eH2_5                 3.572468e-02 1 1  ON 45
eH2_6                 9.952202e-02 1 1  ON 46
eH2_7                 1.595744e-01 1 1  ON 47
eH2_8                 1.973714e-01 1 1  ON 48
eH2_9                 7.528787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.369317
====================================================
  Execution time = 4.0296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4804e-01
  Total weights = 2.0000e+06
  Execution time = 4.6386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348071484278
                                         uncertainty =       0.018409968435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348071484278
                                         uncertainty =       0.018409968435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417093881
  error estimate for blocks of size 2^( 2) =       0.000429456441
  error estimate for blocks of size 2^( 3) =       0.000442130833
  error estimate for blocks of size 2^( 4) =       0.000453536029
  error estimate for blocks of size 2^( 5) =       0.000463987086
  error estimate for blocks of size 2^( 6) =       0.000471306100
  error estimate for blocks of size 2^( 7) =       0.000478356719

      target function =                  N/A
              le_mean =     -16.910364811826
             les_mean =     286.308372505971
             stat err =       0.000466796484
             autocorr =       1.252528207129
              std dev =       0.589859823095
             le_variance =       0.347934610901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348241230252
                                         uncertainty =       0.018410507942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348241230252
                                         uncertainty =       0.018410507942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417195398
  error estimate for blocks of size 2^( 2) =       0.000429541972
  error estimate for blocks of size 2^( 3) =       0.000442196621
  error estimate for blocks of size 2^( 4) =       0.000453588186
  error estimate for blocks of size 2^( 5) =       0.000464024967
  error estimate for blocks of size 2^( 6) =       0.000471336285
  error estimate for blocks of size 2^( 7) =       0.000478385279

      target function =                  N/A
              le_mean =     -16.910361826785
             les_mean =     286.308440939047
             stat err =       0.000466833679
             autocorr =       1.252118239602
              std dev =       0.590003390081
             le_variance =       0.348104000307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348302008677
                                         uncertainty =       0.018410841480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348302008677
                                         uncertainty =       0.018410841480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417231697
  error estimate for blocks of size 2^( 2) =       0.000429577038
  error estimate for blocks of size 2^( 3) =       0.000442230260
  error estimate for blocks of size 2^( 4) =       0.000453633548
  error estimate for blocks of size 2^( 5) =       0.000464079671
  error estimate for blocks of size 2^( 6) =       0.000471403237
  error estimate for blocks of size 2^( 7) =       0.000478458721

      target function =                  N/A
              le_mean =     -16.910361520678
             les_mean =     286.308491164250
             stat err =       0.000466893794
             autocorr =       1.252222821391
              std dev =       0.590054724826
             le_variance =       0.348164578289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348129680514
                                         uncertainty =       0.018410173470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348129680514
                                         uncertainty =       0.018410173470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417128649
  error estimate for blocks of size 2^( 2) =       0.000429487329
  error estimate for blocks of size 2^( 3) =       0.000442156079
  error estimate for blocks of size 2^( 4) =       0.000453561185
  error estimate for blocks of size 2^( 5) =       0.000464011105
  error estimate for blocks of size 2^( 6) =       0.000471332700
  error estimate for blocks of size 2^( 7) =       0.000478384521

      target function =                  N/A
              le_mean =     -16.910361612599
             les_mean =     286.308322315012
             stat err =       0.000466822378
             autocorr =       1.252458354339
              std dev =       0.589908993105
             le_variance =       0.347992620146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910364811826        initial  <--
     1.5625e-02     1.5625e-01             1.5695e-02       -16.910361826785
     6.2500e-02     6.2500e-01             4.0210e-03       -16.910361520678
     2.5000e-01     2.5000e+00             9.9681e-04       -16.910361612599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6161
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.079579e-01 1 1  ON 0
 uu_1                 1.425128e-01 1 1  ON 1
 uu_2                 4.435377e-02 1 1  ON 2
 uu_3                -1.914075e-02 1 1  ON 3
 uu_4                -6.874992e-02 1 1  ON 4
 uu_5                -1.046469e-01 1 1  ON 5
 uu_6                -1.320056e-01 1 1  ON 6
 uu_7                -1.443670e-01 1 1  ON 7
 uu_8                -1.357126e-01 1 1  ON 8
 uu_9                -1.074514e-01 1 1  ON 9
 ud_0                 4.390931e-01 1 1  ON 10
 ud_1                 1.808980e-01 1 1  ON 11
 ud_2                 6.600929e-02 1 1  ON 12
 ud_3                -3.539975e-03 1 1  ON 13
 ud_4                -5.921268e-02 1 1  ON 14
 ud_5                -1.020725e-01 1 1  ON 15
 ud_6                -1.324997e-01 1 1  ON 16
 ud_7                -1.525996e-01 1 1  ON 17
 ud_8                -1.554871e-01 1 1  ON 18
 ud_9                -1.473855e-01 1 1  ON 19
 eO_0                -7.597697e-01 1 1  ON 20
 eO_1                -4.427447e-01 1 1  ON 21
 eO_2                -2.501723e-02 1 1  ON 22
 eO_3                 3.021657e-01 1 1  ON 23
 eO_4                 5.314360e-01 1 1  ON 24
 eO_5                 4.946782e-01 1 1  ON 25
 eO_6                 2.668183e-01 1 1  ON 26
 eO_7                -3.958166e-02 1 1  ON 27
 eO_8                -2.318872e-01 1 1  ON 28
 eO_9                -9.415900e-02 1 1  ON 29
eH1_0                -2.575623e-01 1 1  ON 30
eH1_1                -1.532002e-01 1 1  ON 31
eH1_2                -1.077901e-01 1 1  ON 32
eH1_3                -5.523655e-02 1 1  ON 33
eH1_4                -3.512236e-03 1 1  ON 34
eH1_5                 3.226259e-02 1 1  ON 35
eH1_6                 9.703622e-02 1 1  ON 36
eH1_7                 1.583606e-01 1 1  ON 37
eH1_8                 1.942466e-01 1 1  ON 38
eH1_9                 9.126989e-02 1 1  ON 39
eH2_0                -2.517036e-01 1 1  ON 40
eH2_1                -1.470556e-01 1 1  ON 41
eH2_2                -1.015771e-01 1 1  ON 42
eH2_3                -4.928039e-02 1 1  ON 43
eH2_4                 2.450831e-03 1 1  ON 44
eH2_5                 3.687525e-02 1 1  ON 45
eH2_6                 1.001981e-01 1 1  ON 46
eH2_7                 1.597848e-01 1 1  ON 47
eH2_8                 1.951641e-01 1 1  ON 48
eH2_9                 7.126686e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1517e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.280737
====================================================
  Execution time = 4.4168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0836e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327034604976
                                         uncertainty =       0.004605979919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327034604976
                                         uncertainty =       0.004605979919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404319317
  error estimate for blocks of size 2^( 2) =       0.000416046986
  error estimate for blocks of size 2^( 3) =       0.000428581365
  error estimate for blocks of size 2^( 4) =       0.000439761150
  error estimate for blocks of size 2^( 5) =       0.000449684366
  error estimate for blocks of size 2^( 6) =       0.000457413553
  error estimate for blocks of size 2^( 7) =       0.000462562822

      target function =                  N/A
              le_mean =     -16.909990293845
             les_mean =     286.274719794630
             stat err =       0.000452355473
             autocorr =       1.251730158459
              std dev =       0.571793861614
             le_variance =       0.326948220179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690999029384e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909990293845       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909992245463       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909992625928       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909992373270       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909992509428       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909992252861       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909991990040       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909992423074       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909992852887       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909992756441       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909992873205       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.295477e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909990293845       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909991129845       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909991197376       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909991222985       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909991054578       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909991159770       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909991143727       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909991204414       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909991250691       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.246350e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909990293845       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909990548215       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909990560186       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909990568859       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909990516027       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909990553620       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909990563099       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909990566904       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.096825e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5016e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.080374e-01 1 1  ON 0
 uu_1                 1.425748e-01 1 1  ON 1
 uu_2                 4.439091e-02 1 1  ON 2
 uu_3                -1.918950e-02 1 1  ON 3
 uu_4                -6.880971e-02 1 1  ON 4
 uu_5                -1.047074e-01 1 1  ON 5
 uu_6                -1.320210e-01 1 1  ON 6
 uu_7                -1.444245e-01 1 1  ON 7
 uu_8                -1.357003e-01 1 1  ON 8
 uu_9                -1.076147e-01 1 1  ON 9
 ud_0                 4.391489e-01 1 1  ON 10
 ud_1                 1.809885e-01 1 1  ON 11
 ud_2                 6.594989e-02 1 1  ON 12
 ud_3                -3.565836e-03 1 1  ON 13
 ud_4                -5.923991e-02 1 1  ON 14
 ud_5                -1.020380e-01 1 1  ON 15
 ud_6                -1.324108e-01 1 1  ON 16
 ud_7                -1.526681e-01 1 1  ON 17
 ud_8                -1.555780e-01 1 1  ON 18
 ud_9                -1.473387e-01 1 1  ON 19
 eO_0                -7.598579e-01 1 1  ON 20
 eO_1                -4.428106e-01 1 1  ON 21
 eO_2                -2.486802e-02 1 1  ON 22
 eO_3                 3.022223e-01 1 1  ON 23
 eO_4                 5.315366e-01 1 1  ON 24
 eO_5                 4.948563e-01 1 1  ON 25
 eO_6                 2.668765e-01 1 1  ON 26
 eO_7                -3.958858e-02 1 1  ON 27
 eO_8                -2.320712e-01 1 1  ON 28
 eO_9                -9.433485e-02 1 1  ON 29
eH1_0                -2.578505e-01 1 1  ON 30
eH1_1                -1.532383e-01 1 1  ON 31
eH1_2                -1.078524e-01 1 1  ON 32
eH1_3                -5.541003e-02 1 1  ON 33
eH1_4                -3.690836e-03 1 1  ON 34
eH1_5                 3.211961e-02 1 1  ON 35
eH1_6                 9.702819e-02 1 1  ON 36
eH1_7                 1.585941e-01 1 1  ON 37
eH1_8                 1.945252e-01 1 1  ON 38
eH1_9                 9.159452e-02 1 1  ON 39
eH2_0                -2.518268e-01 1 1  ON 40
eH2_1                -1.469485e-01 1 1  ON 41
eH2_2                -1.015948e-01 1 1  ON 42
eH2_3                -4.929995e-02 1 1  ON 43
eH2_4                 2.242864e-03 1 1  ON 44
eH2_5                 3.673160e-02 1 1  ON 45
eH2_6                 1.002688e-01 1 1  ON 46
eH2_7                 1.597806e-01 1 1  ON 47
eH2_8                 1.951798e-01 1 1  ON 48
eH2_9                 7.152818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.434003
====================================================
  Execution time = 4.0872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4199e-01
  Total weights = 2.0000e+06
  Execution time = 4.6463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341906192338
                                         uncertainty =       0.010632980265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341906192338
                                         uncertainty =       0.010632980265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413465509
  error estimate for blocks of size 2^( 2) =       0.000424980827
  error estimate for blocks of size 2^( 3) =       0.000437278224
  error estimate for blocks of size 2^( 4) =       0.000449222405
  error estimate for blocks of size 2^( 5) =       0.000460724968
  error estimate for blocks of size 2^( 6) =       0.000468910553
  error estimate for blocks of size 2^( 7) =       0.000474837775

      target function =                  N/A
              le_mean =     -16.910080106161
             les_mean =     286.292716479970
             stat err =       0.000463423925
             autocorr =       1.256256520709
              std dev =       0.584728530293
             le_variance =       0.341907454138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342133787022
                                         uncertainty =       0.010650590098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342133787022
                                         uncertainty =       0.010650590098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413603028
  error estimate for blocks of size 2^( 2) =       0.000425108391
  error estimate for blocks of size 2^( 3) =       0.000437395079
  error estimate for blocks of size 2^( 4) =       0.000449333567
  error estimate for blocks of size 2^( 5) =       0.000460828584
  error estimate for blocks of size 2^( 6) =       0.000469014208
  error estimate for blocks of size 2^( 7) =       0.000474931071

      target function =                  N/A
              le_mean =     -16.910080285542
             les_mean =     286.292950021155
             stat err =       0.000463526858
             autocorr =       1.255979029021
              std dev =       0.584923010950
             le_variance =       0.342134928739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342077279937
                                         uncertainty =       0.010651442142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342077279937
                                         uncertainty =       0.010651442142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413568884
  error estimate for blocks of size 2^( 2) =       0.000425076149
  error estimate for blocks of size 2^( 3) =       0.000437364312
  error estimate for blocks of size 2^( 4) =       0.000449303711
  error estimate for blocks of size 2^( 5) =       0.000460800573
  error estimate for blocks of size 2^( 6) =       0.000468987075
  error estimate for blocks of size 2^( 7) =       0.000474908761

      target function =                  N/A
              le_mean =     -16.910079890614
             les_mean =     286.292880178844
             stat err =       0.000463500030
             autocorr =       1.256041019082
              std dev =       0.584874724144
             le_variance =       0.342078442943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930345634
                                         uncertainty =       0.010636329425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930345634
                                         uncertainty =       0.010636329425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413480104
  error estimate for blocks of size 2^( 2) =       0.000424994147
  error estimate for blocks of size 2^( 3) =       0.000437290008
  error estimate for blocks of size 2^( 4) =       0.000449233361
  error estimate for blocks of size 2^( 5) =       0.000460735067
  error estimate for blocks of size 2^( 6) =       0.000468920919
  error estimate for blocks of size 2^( 7) =       0.000474847712

      target function =                  N/A
              le_mean =     -16.910079938225
             les_mean =     286.292734939471
             stat err =       0.000463434265
             autocorr =       1.256223887640
              std dev =       0.584749171256
             le_variance =       0.341931593285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910080106161        initial
     1.5625e-01     1.5625e+00             1.2955e-03       -16.910080285542  <--
     6.2500e-01     6.2500e+00             3.2464e-04       -16.910079890614
     2.5000e+00     2.5000e+01             8.0968e-05       -16.910079938225

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.4185e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081897e-01 1 1  ON 0
 uu_1                 1.426957e-01 1 1  ON 1
 uu_2                 4.443507e-02 1 1  ON 2
 uu_3                -1.924394e-02 1 1  ON 3
 uu_4                -6.892224e-02 1 1  ON 4
 uu_5                -1.048488e-01 1 1  ON 5
 uu_6                -1.320932e-01 1 1  ON 6
 uu_7                -1.445582e-01 1 1  ON 7
 uu_8                -1.356733e-01 1 1  ON 8
 uu_9                -1.080811e-01 1 1  ON 9
 ud_0                 4.392672e-01 1 1  ON 10
 ud_1                 1.810969e-01 1 1  ON 11
 ud_2                 6.592471e-02 1 1  ON 12
 ud_3                -3.600874e-03 1 1  ON 13
 ud_4                -5.927268e-02 1 1  ON 14
 ud_5                -1.019809e-01 1 1  ON 15
 ud_6                -1.323128e-01 1 1  ON 16
 ud_7                -1.527353e-01 1 1  ON 17
 ud_8                -1.557816e-01 1 1  ON 18
 ud_9                -1.472178e-01 1 1  ON 19
 eO_0                -7.600501e-01 1 1  ON 20
 eO_1                -4.428730e-01 1 1  ON 21
 eO_2                -2.460726e-02 1 1  ON 22
 eO_3                 3.023894e-01 1 1  ON 23
 eO_4                 5.318069e-01 1 1  ON 24
 eO_5                 4.953400e-01 1 1  ON 25
 eO_6                 2.670917e-01 1 1  ON 26
 eO_7                -3.959237e-02 1 1  ON 27
 eO_8                -2.326198e-01 1 1  ON 28
 eO_9                -9.485989e-02 1 1  ON 29
eH1_0                -2.585653e-01 1 1  ON 30
eH1_1                -1.535167e-01 1 1  ON 31
eH1_2                -1.081768e-01 1 1  ON 32
eH1_3                -5.582862e-02 1 1  ON 33
eH1_4                -4.172540e-03 1 1  ON 34
eH1_5                 3.173949e-02 1 1  ON 35
eH1_6                 9.697696e-02 1 1  ON 36
eH1_7                 1.592732e-01 1 1  ON 37
eH1_8                 1.953585e-01 1 1  ON 38
eH1_9                 9.256537e-02 1 1  ON 39
eH2_0                -2.520901e-01 1 1  ON 40
eH2_1                -1.468680e-01 1 1  ON 41
eH2_2                -1.016891e-01 1 1  ON 42
eH2_3                -4.939209e-02 1 1  ON 43
eH2_4                 1.833843e-03 1 1  ON 44
eH2_5                 3.633849e-02 1 1  ON 45
eH2_6                 1.004041e-01 1 1  ON 46
eH2_7                 1.597915e-01 1 1  ON 47
eH2_8                 1.952441e-01 1 1  ON 48
eH2_9                 7.230584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1921e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9598
    reference variance = 0.171239
====================================================
  Execution time = 4.1495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0697e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341332862641
                                         uncertainty =       0.013169240720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341332862641
                                         uncertainty =       0.013169240720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413073846
  error estimate for blocks of size 2^( 2) =       0.000424386495
  error estimate for blocks of size 2^( 3) =       0.000435865888
  error estimate for blocks of size 2^( 4) =       0.000446081389
  error estimate for blocks of size 2^( 5) =       0.000457106139
  error estimate for blocks of size 2^( 6) =       0.000463178656
  error estimate for blocks of size 2^( 7) =       0.000467906563

      target function =                  N/A
              le_mean =     -16.911627113712
             les_mean =     286.344391466966
             stat err =       0.000458568187
             autocorr =       1.232402152969
              std dev =       0.584174635168
             le_variance =       0.341260004374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691162711371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911627113712       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911628345997       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911631270717       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911633106718       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911631461917       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911632916375       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911631707050       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911631375776       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911631998511       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911633878937       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911633513777       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911634053511       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911633650902       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911634036035       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.119706e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911627113712       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911627910476       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911629397091       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911630284703       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911629620973       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911630124935       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911628942536       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911629129606       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911629866141       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911629798930       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911629892697       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.276398e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911627113712       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911627443812       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911627986759       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911628226521       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911628249372       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911628313688       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911628002608       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911627946922       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911628143699       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.176081e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2206e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.080426e-01 1 1  ON 0
 uu_1                 1.425853e-01 1 1  ON 1
 uu_2                 4.441710e-02 1 1  ON 2
 uu_3                -1.906181e-02 1 1  ON 3
 uu_4                -6.892502e-02 1 1  ON 4
 uu_5                -1.048242e-01 1 1  ON 5
 uu_6                -1.317052e-01 1 1  ON 6
 uu_7                -1.445130e-01 1 1  ON 7
 uu_8                -1.364076e-01 1 1  ON 8
 uu_9                -1.084311e-01 1 1  ON 9
 ud_0                 4.397989e-01 1 1  ON 10
 ud_1                 1.815490e-01 1 1  ON 11
 ud_2                 6.635136e-02 1 1  ON 12
 ud_3                -3.300687e-03 1 1  ON 13
 ud_4                -5.903790e-02 1 1  ON 14
 ud_5                -1.019074e-01 1 1  ON 15
 ud_6                -1.322687e-01 1 1  ON 16
 ud_7                -1.531729e-01 1 1  ON 17
 ud_8                -1.566557e-01 1 1  ON 18
 ud_9                -1.477324e-01 1 1  ON 19
 eO_0                -7.601314e-01 1 1  ON 20
 eO_1                -4.424822e-01 1 1  ON 21
 eO_2                -2.441688e-02 1 1  ON 22
 eO_3                 3.024480e-01 1 1  ON 23
 eO_4                 5.321371e-01 1 1  ON 24
 eO_5                 4.959066e-01 1 1  ON 25
 eO_6                 2.676677e-01 1 1  ON 26
 eO_7                -3.972593e-02 1 1  ON 27
 eO_8                -2.335234e-01 1 1  ON 28
 eO_9                -9.572005e-02 1 1  ON 29
eH1_0                -2.587371e-01 1 1  ON 30
eH1_1                -1.539275e-01 1 1  ON 31
eH1_2                -1.085002e-01 1 1  ON 32
eH1_3                -5.616733e-02 1 1  ON 33
eH1_4                -4.194181e-03 1 1  ON 34
eH1_5                 3.186077e-02 1 1  ON 35
eH1_6                 9.660532e-02 1 1  ON 36
eH1_7                 1.596423e-01 1 1  ON 37
eH1_8                 1.957230e-01 1 1  ON 38
eH1_9                 9.332364e-02 1 1  ON 39
eH2_0                -2.527664e-01 1 1  ON 40
eH2_1                -1.471740e-01 1 1  ON 41
eH2_2                -1.019111e-01 1 1  ON 42
eH2_3                -4.992267e-02 1 1  ON 43
eH2_4                 1.804920e-03 1 1  ON 44
eH2_5                 3.660987e-02 1 1  ON 45
eH2_6                 9.987464e-02 1 1  ON 46
eH2_7                 1.597757e-01 1 1  ON 47
eH2_8                 1.957138e-01 1 1  ON 48
eH2_9                 7.358224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.285904
====================================================
  Execution time = 4.0759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 4.6380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595511654
                                         uncertainty =       0.008300162287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595511654
                                         uncertainty =       0.008300162287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412020523
  error estimate for blocks of size 2^( 2) =       0.000423712996
  error estimate for blocks of size 2^( 3) =       0.000435593560
  error estimate for blocks of size 2^( 4) =       0.000448072740
  error estimate for blocks of size 2^( 5) =       0.000457777421
  error estimate for blocks of size 2^( 6) =       0.000466640946
  error estimate for blocks of size 2^( 7) =       0.000474981775

      target function =                  N/A
              le_mean =     -16.911337850212
             les_mean =     286.332869536292
             stat err =       0.000461868221
             autocorr =       1.256604078557
              std dev =       0.582685011001
             le_variance =       0.339521822045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339681123711
                                         uncertainty =       0.008300627302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339681123711
                                         uncertainty =       0.008300627302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412072437
  error estimate for blocks of size 2^( 2) =       0.000423754683
  error estimate for blocks of size 2^( 3) =       0.000435622718
  error estimate for blocks of size 2^( 4) =       0.000448086392
  error estimate for blocks of size 2^( 5) =       0.000457783965
  error estimate for blocks of size 2^( 6) =       0.000466641738
  error estimate for blocks of size 2^( 7) =       0.000474995884

      target function =                  N/A
              le_mean =     -16.911337374915
             les_mean =     286.332939024662
             stat err =       0.000461876995
             autocorr =       1.256335208537
              std dev =       0.582758428737
             le_variance =       0.339607386264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339628227891
                                         uncertainty =       0.008299909025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339628227891
                                         uncertainty =       0.008299909025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412040386
  error estimate for blocks of size 2^( 2) =       0.000423724517
  error estimate for blocks of size 2^( 3) =       0.000435597050
  error estimate for blocks of size 2^( 4) =       0.000448067865
  error estimate for blocks of size 2^( 5) =       0.000457768872
  error estimate for blocks of size 2^( 6) =       0.000466630444
  error estimate for blocks of size 2^( 7) =       0.000474979726

      target function =                  N/A
              le_mean =     -16.911338871982
             les_mean =     286.332936832056
             stat err =       0.000461861727
             autocorr =       1.256447595785
              std dev =       0.582713101651
             le_variance =       0.339554558836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339598283878
                                         uncertainty =       0.008300111200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339598283878
                                         uncertainty =       0.008300111200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412022211
  error estimate for blocks of size 2^( 2) =       0.000423713228
  error estimate for blocks of size 2^( 3) =       0.000435592922
  error estimate for blocks of size 2^( 4) =       0.000448071485
  error estimate for blocks of size 2^( 5) =       0.000457775971
  error estimate for blocks of size 2^( 6) =       0.000466638946
  error estimate for blocks of size 2^( 7) =       0.000474981140

      target function =                  N/A
              le_mean =     -16.911337697654
             les_mean =     286.332867158651
             stat err =       0.000461866885
             autocorr =       1.256586516405
              std dev =       0.582687398458
             le_variance =       0.339524604321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911337850212        initial
     3.9062e-02     3.9062e-01             5.1197e-03       -16.911337374915
     1.5625e-01     1.5625e+00             1.2764e-03       -16.911338871982  <--
     6.2500e-01     6.2500e+00             3.1761e-04       -16.911337697654

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.4061e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.080426e-01 1 1  ON 0
 uu_1                 1.425853e-01 1 1  ON 1
 uu_2                 4.441710e-02 1 1  ON 2
 uu_3                -1.906181e-02 1 1  ON 3
 uu_4                -6.892502e-02 1 1  ON 4
 uu_5                -1.048242e-01 1 1  ON 5
 uu_6                -1.317052e-01 1 1  ON 6
 uu_7                -1.445130e-01 1 1  ON 7
 uu_8                -1.364076e-01 1 1  ON 8
 uu_9                -1.084311e-01 1 1  ON 9
 ud_0                 4.397989e-01 1 1  ON 10
 ud_1                 1.815490e-01 1 1  ON 11
 ud_2                 6.635136e-02 1 1  ON 12
 ud_3                -3.300687e-03 1 1  ON 13
 ud_4                -5.903790e-02 1 1  ON 14
 ud_5                -1.019074e-01 1 1  ON 15
 ud_6                -1.322687e-01 1 1  ON 16
 ud_7                -1.531729e-01 1 1  ON 17
 ud_8                -1.566557e-01 1 1  ON 18
 ud_9                -1.477324e-01 1 1  ON 19
 eO_0                -7.601314e-01 1 1  ON 20
 eO_1                -4.424822e-01 1 1  ON 21
 eO_2                -2.441688e-02 1 1  ON 22
 eO_3                 3.024480e-01 1 1  ON 23
 eO_4                 5.321371e-01 1 1  ON 24
 eO_5                 4.959066e-01 1 1  ON 25
 eO_6                 2.676677e-01 1 1  ON 26
 eO_7                -3.972593e-02 1 1  ON 27
 eO_8                -2.335234e-01 1 1  ON 28
 eO_9                -9.572005e-02 1 1  ON 29
eH1_0                -2.587371e-01 1 1  ON 30
eH1_1                -1.539275e-01 1 1  ON 31
eH1_2                -1.085002e-01 1 1  ON 32
eH1_3                -5.616733e-02 1 1  ON 33
eH1_4                -4.194181e-03 1 1  ON 34
eH1_5                 3.186077e-02 1 1  ON 35
eH1_6                 9.660532e-02 1 1  ON 36
eH1_7                 1.596423e-01 1 1  ON 37
eH1_8                 1.957230e-01 1 1  ON 38
eH1_9                 9.332364e-02 1 1  ON 39
eH2_0                -2.527664e-01 1 1  ON 40
eH2_1                -1.471740e-01 1 1  ON 41
eH2_2                -1.019111e-01 1 1  ON 42
eH2_3                -4.992267e-02 1 1  ON 43
eH2_4                 1.804920e-03 1 1  ON 44
eH2_5                 3.660987e-02 1 1  ON 45
eH2_6                 9.987464e-02 1 1  ON 46
eH2_7                 1.597757e-01 1 1  ON 47
eH2_8                 1.957138e-01 1 1  ON 48
eH2_9                 7.358224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1627e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.348171
====================================================
  Execution time = 4.1499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2578e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0933e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325388883668
                                         uncertainty =       0.002844246058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325388883668
                                         uncertainty =       0.002844246058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403598807
  error estimate for blocks of size 2^( 2) =       0.000415613001
  error estimate for blocks of size 2^( 3) =       0.000428275191
  error estimate for blocks of size 2^( 4) =       0.000440176501
  error estimate for blocks of size 2^( 5) =       0.000451246581
  error estimate for blocks of size 2^( 6) =       0.000460526503
  error estimate for blocks of size 2^( 7) =       0.000464528245

      target function =                  N/A
              le_mean =     -16.909931527699
             les_mean =     286.271568102636
             stat err =       0.000454119457
             autocorr =       1.266019727373
              std dev =       0.570774906654
             le_variance =       0.325783994066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690993152770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909931527699       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909931633715       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909934639612       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909933357556       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909934016456       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909937963375       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909936139803       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909935852514       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909936698258       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909937527018       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909938475054       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909938377050       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909940081489       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909940449209       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.327882e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909931527699       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909931601680       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909933256517       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909932317165       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909931835302       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909933577781       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909932754311       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909932448833       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909932944590       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909933185488       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909933241338       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.332734e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909931527699       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909931561194       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909932142797       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909931648569       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909931423328       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909931297208       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909931603243       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909931437645       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909931558798       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.322783e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2446e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.078236e-01 1 1  ON 0
 uu_1                 1.425418e-01 1 1  ON 1
 uu_2                 4.451960e-02 1 1  ON 2
 uu_3                -1.911931e-02 1 1  ON 3
 uu_4                -6.925768e-02 1 1  ON 4
 uu_5                -1.052081e-01 1 1  ON 5
 uu_6                -1.320147e-01 1 1  ON 6
 uu_7                -1.449038e-01 1 1  ON 7
 uu_8                -1.359333e-01 1 1  ON 8
 uu_9                -1.082659e-01 1 1  ON 9
 ud_0                 4.399249e-01 1 1  ON 10
 ud_1                 1.813962e-01 1 1  ON 11
 ud_2                 6.642312e-02 1 1  ON 12
 ud_3                -3.253307e-03 1 1  ON 13
 ud_4                -5.898679e-02 1 1  ON 14
 ud_5                -1.021531e-01 1 1  ON 15
 ud_6                -1.321148e-01 1 1  ON 16
 ud_7                -1.528036e-01 1 1  ON 17
 ud_8                -1.563822e-01 1 1  ON 18
 ud_9                -1.474494e-01 1 1  ON 19
 eO_0                -7.597672e-01 1 1  ON 20
 eO_1                -4.427599e-01 1 1  ON 21
 eO_2                -2.444994e-02 1 1  ON 22
 eO_3                 3.026499e-01 1 1  ON 23
 eO_4                 5.324400e-01 1 1  ON 24
 eO_5                 4.961041e-01 1 1  ON 25
 eO_6                 2.679399e-01 1 1  ON 26
 eO_7                -3.957927e-02 1 1  ON 27
 eO_8                -2.338112e-01 1 1  ON 28
 eO_9                -9.644096e-02 1 1  ON 29
eH1_0                -2.595512e-01 1 1  ON 30
eH1_1                -1.546562e-01 1 1  ON 31
eH1_2                -1.087890e-01 1 1  ON 32
eH1_3                -5.662014e-02 1 1  ON 33
eH1_4                -4.840640e-03 1 1  ON 34
eH1_5                 3.174324e-02 1 1  ON 35
eH1_6                 9.670587e-02 1 1  ON 36
eH1_7                 1.599651e-01 1 1  ON 37
eH1_8                 1.966952e-01 1 1  ON 38
eH1_9                 9.465637e-02 1 1  ON 39
eH2_0                -2.531116e-01 1 1  ON 40
eH2_1                -1.480582e-01 1 1  ON 41
eH2_2                -1.022958e-01 1 1  ON 42
eH2_3                -5.003092e-02 1 1  ON 43
eH2_4                 1.402276e-03 1 1  ON 44
eH2_5                 3.637806e-02 1 1  ON 45
eH2_6                 1.002609e-01 1 1  ON 46
eH2_7                 1.599879e-01 1 1  ON 47
eH2_8                 1.962142e-01 1 1  ON 48
eH2_9                 7.476794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.267987
====================================================
  Execution time = 4.0528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4704e-01
  Total weights = 2.0000e+06
  Execution time = 4.6560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347196253187
                                         uncertainty =       0.011186913776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347196253187
                                         uncertainty =       0.011186913776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416584531
  error estimate for blocks of size 2^( 2) =       0.000428271934
  error estimate for blocks of size 2^( 3) =       0.000440084048
  error estimate for blocks of size 2^( 4) =       0.000451432753
  error estimate for blocks of size 2^( 5) =       0.000461145997
  error estimate for blocks of size 2^( 6) =       0.000467197639
  error estimate for blocks of size 2^( 7) =       0.000470668168

      target function =                  N/A
              le_mean =     -16.911143964498
             les_mean =     286.333875357503
             stat err =       0.000462611139
             autocorr =       1.233178354107
              std dev =       0.589139493740
             le_variance =       0.347085343084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347183842523
                                         uncertainty =       0.011186879559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347183842523
                                         uncertainty =       0.011186879559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416576898
  error estimate for blocks of size 2^( 2) =       0.000428275179
  error estimate for blocks of size 2^( 3) =       0.000440095197
  error estimate for blocks of size 2^( 4) =       0.000451450028
  error estimate for blocks of size 2^( 5) =       0.000461154243
  error estimate for blocks of size 2^( 6) =       0.000467187924
  error estimate for blocks of size 2^( 7) =       0.000470657216

      target function =                  N/A
              le_mean =     -16.911148812012
             les_mean =     286.334026591961
             stat err =       0.000462612353
             autocorr =       1.233230019195
              std dev =       0.589128698564
             le_variance =       0.347072623471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347122500544
                                         uncertainty =       0.011188749211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347122500544
                                         uncertainty =       0.011188749211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416539997
  error estimate for blocks of size 2^( 2) =       0.000428239149
  error estimate for blocks of size 2^( 3) =       0.000440059515
  error estimate for blocks of size 2^( 4) =       0.000451420334
  error estimate for blocks of size 2^( 5) =       0.000461126476
  error estimate for blocks of size 2^( 6) =       0.000467163947
  error estimate for blocks of size 2^( 7) =       0.000470651299

      target function =                  N/A
              le_mean =     -16.911150448536
             les_mean =     286.334020457603
             stat err =       0.000462590514
             autocorr =       1.233332075495
              std dev =       0.589076512935
             le_variance =       0.347011138092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347184350387
                                         uncertainty =       0.011188062085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347184350387
                                         uncertainty =       0.011188062085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416577306
  error estimate for blocks of size 2^( 2) =       0.000428266611
  error estimate for blocks of size 2^( 3) =       0.000440079439
  error estimate for blocks of size 2^( 4) =       0.000451430907
  error estimate for blocks of size 2^( 5) =       0.000461142331
  error estimate for blocks of size 2^( 6) =       0.000467191606
  error estimate for blocks of size 2^( 7) =       0.000470668778

      target function =                  N/A
              le_mean =     -16.911144666507
             les_mean =     286.333887061537
             stat err =       0.000462608405
             autocorr =       1.233206555263
              std dev =       0.589129275740
             le_variance =       0.347073303533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911143964498        initial
     3.9062e-02     3.9062e-01             5.3279e-03       -16.911148812012
     1.5625e-01     1.5625e+00             1.3327e-03       -16.911150448536  <--
     6.2500e-01     6.2500e+00             3.3228e-04       -16.911144666507

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.7869e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.078236e-01 1 1  ON 0
 uu_1                 1.425418e-01 1 1  ON 1
 uu_2                 4.451960e-02 1 1  ON 2
 uu_3                -1.911931e-02 1 1  ON 3
 uu_4                -6.925768e-02 1 1  ON 4
 uu_5                -1.052081e-01 1 1  ON 5
 uu_6                -1.320147e-01 1 1  ON 6
 uu_7                -1.449038e-01 1 1  ON 7
 uu_8                -1.359333e-01 1 1  ON 8
 uu_9                -1.082659e-01 1 1  ON 9
 ud_0                 4.399249e-01 1 1  ON 10
 ud_1                 1.813962e-01 1 1  ON 11
 ud_2                 6.642312e-02 1 1  ON 12
 ud_3                -3.253307e-03 1 1  ON 13
 ud_4                -5.898679e-02 1 1  ON 14
 ud_5                -1.021531e-01 1 1  ON 15
 ud_6                -1.321148e-01 1 1  ON 16
 ud_7                -1.528036e-01 1 1  ON 17
 ud_8                -1.563822e-01 1 1  ON 18
 ud_9                -1.474494e-01 1 1  ON 19
 eO_0                -7.597672e-01 1 1  ON 20
 eO_1                -4.427599e-01 1 1  ON 21
 eO_2                -2.444994e-02 1 1  ON 22
 eO_3                 3.026499e-01 1 1  ON 23
 eO_4                 5.324400e-01 1 1  ON 24
 eO_5                 4.961041e-01 1 1  ON 25
 eO_6                 2.679399e-01 1 1  ON 26
 eO_7                -3.957927e-02 1 1  ON 27
 eO_8                -2.338112e-01 1 1  ON 28
 eO_9                -9.644096e-02 1 1  ON 29
eH1_0                -2.595512e-01 1 1  ON 30
eH1_1                -1.546562e-01 1 1  ON 31
eH1_2                -1.087890e-01 1 1  ON 32
eH1_3                -5.662014e-02 1 1  ON 33
eH1_4                -4.840640e-03 1 1  ON 34
eH1_5                 3.174324e-02 1 1  ON 35
eH1_6                 9.670587e-02 1 1  ON 36
eH1_7                 1.599651e-01 1 1  ON 37
eH1_8                 1.966952e-01 1 1  ON 38
eH1_9                 9.465637e-02 1 1  ON 39
eH2_0                -2.531116e-01 1 1  ON 40
eH2_1                -1.480582e-01 1 1  ON 41
eH2_2                -1.022958e-01 1 1  ON 42
eH2_3                -5.003092e-02 1 1  ON 43
eH2_4                 1.402276e-03 1 1  ON 44
eH2_5                 3.637806e-02 1 1  ON 45
eH2_6                 1.002609e-01 1 1  ON 46
eH2_7                 1.599879e-01 1 1  ON 47
eH2_8                 1.962142e-01 1 1  ON 48
eH2_9                 7.476794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2032e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8493
    reference variance = 0.27581
====================================================
  Execution time = 4.1469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5030e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0950e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350358645017
                                         uncertainty =       0.019966353597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350358645017
                                         uncertainty =       0.019966353597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418507010
  error estimate for blocks of size 2^( 2) =       0.000429547730
  error estimate for blocks of size 2^( 3) =       0.000442002804
  error estimate for blocks of size 2^( 4) =       0.000453573762
  error estimate for blocks of size 2^( 5) =       0.000463613247
  error estimate for blocks of size 2^( 6) =       0.000469447526
  error estimate for blocks of size 2^( 7) =       0.000471947431

      target function =                  N/A
              le_mean =     -16.911339668768
             les_mean =     286.343705452834
             stat err =       0.000464645491
             autocorr =       1.232644892294
              std dev =       0.591858290086
             le_variance =       0.350296235544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691133966877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911339668768       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911343362932       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911342447312       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911341954674       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911342042083       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911342238987       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911341349927       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911343468135       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911342722949       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911342457673       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911343269173       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911345130387       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911346160504       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911346086029       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911345692194       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.252924e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911339668768       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911342111979       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911341431484       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911341385422       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911341305961       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911341029749       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911341285614       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911341857945       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911341858750       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911341882143       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911341643607       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911341895674       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.117765e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911339668768       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911340706437       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911340602572       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911340469463       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911340246558       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911340342114       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911340324240       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911340455174       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911340546984       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.992909e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2432e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.080323e-01 1 1  ON 0
 uu_1                 1.423351e-01 1 1  ON 1
 uu_2                 4.450825e-02 1 1  ON 2
 uu_3                -1.907964e-02 1 1  ON 3
 uu_4                -6.888216e-02 1 1  ON 4
 uu_5                -1.049885e-01 1 1  ON 5
 uu_6                -1.320258e-01 1 1  ON 6
 uu_7                -1.449004e-01 1 1  ON 7
 uu_8                -1.363835e-01 1 1  ON 8
 uu_9                -1.088125e-01 1 1  ON 9
 ud_0                 4.401889e-01 1 1  ON 10
 ud_1                 1.820414e-01 1 1  ON 11
 ud_2                 6.683248e-02 1 1  ON 12
 ud_3                -2.832845e-03 1 1  ON 13
 ud_4                -5.869233e-02 1 1  ON 14
 ud_5                -1.015287e-01 1 1  ON 15
 ud_6                -1.321402e-01 1 1  ON 16
 ud_7                -1.526170e-01 1 1  ON 17
 ud_8                -1.570747e-01 1 1  ON 18
 ud_9                -1.485672e-01 1 1  ON 19
 eO_0                -7.594075e-01 1 1  ON 20
 eO_1                -4.423211e-01 1 1  ON 21
 eO_2                -2.457817e-02 1 1  ON 22
 eO_3                 3.025940e-01 1 1  ON 23
 eO_4                 5.328541e-01 1 1  ON 24
 eO_5                 4.967110e-01 1 1  ON 25
 eO_6                 2.683811e-01 1 1  ON 26
 eO_7                -3.932052e-02 1 1  ON 27
 eO_8                -2.348205e-01 1 1  ON 28
 eO_9                -9.754277e-02 1 1  ON 29
eH1_0                -2.600120e-01 1 1  ON 30
eH1_1                -1.549158e-01 1 1  ON 31
eH1_2                -1.090171e-01 1 1  ON 32
eH1_3                -5.676720e-02 1 1  ON 33
eH1_4                -4.830135e-03 1 1  ON 34
eH1_5                 3.110156e-02 1 1  ON 35
eH1_6                 9.711032e-02 1 1  ON 36
eH1_7                 1.598094e-01 1 1  ON 37
eH1_8                 1.972743e-01 1 1  ON 38
eH1_9                 9.562677e-02 1 1  ON 39
eH2_0                -2.532753e-01 1 1  ON 40
eH2_1                -1.484823e-01 1 1  ON 41
eH2_2                -1.027358e-01 1 1  ON 42
eH2_3                -5.018409e-02 1 1  ON 43
eH2_4                 1.508041e-03 1 1  ON 44
eH2_5                 3.688229e-02 1 1  ON 45
eH2_6                 9.970293e-02 1 1  ON 46
eH2_7                 1.597428e-01 1 1  ON 47
eH2_8                 1.967456e-01 1 1  ON 48
eH2_9                 7.579517e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8607
    reference variance = 0.485111
====================================================
  Execution time = 4.0403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.0000e+06
  Execution time = 4.6526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332428490964
                                         uncertainty =       0.004001624949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332428490964
                                         uncertainty =       0.004001624949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407624376
  error estimate for blocks of size 2^( 2) =       0.000419632438
  error estimate for blocks of size 2^( 3) =       0.000432606375
  error estimate for blocks of size 2^( 4) =       0.000445257403
  error estimate for blocks of size 2^( 5) =       0.000457247594
  error estimate for blocks of size 2^( 6) =       0.000466779227
  error estimate for blocks of size 2^( 7) =       0.000472132282

      target function =                  N/A
              le_mean =     -16.910075238981
             les_mean =     286.282959685999
             stat err =       0.000460354127
             autocorr =       1.275451023695
              std dev =       0.576467921184
             le_variance =       0.332315264154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236630043
                                         uncertainty =       0.003999697439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236630043
                                         uncertainty =       0.003999697439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407506897
  error estimate for blocks of size 2^( 2) =       0.000419513382
  error estimate for blocks of size 2^( 3) =       0.000432473046
  error estimate for blocks of size 2^( 4) =       0.000445114182
  error estimate for blocks of size 2^( 5) =       0.000457093813
  error estimate for blocks of size 2^( 6) =       0.000466629973
  error estimate for blocks of size 2^( 7) =       0.000471984213

      target function =                  N/A
              le_mean =     -16.910073836210
             les_mean =     286.282720722058
             stat err =       0.000460205545
             autocorr =       1.275362865000
              std dev =       0.576301780359
             le_variance =       0.332123742045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332124368683
                                         uncertainty =       0.003998743872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332124368683
                                         uncertainty =       0.003998743872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407438193
  error estimate for blocks of size 2^( 2) =       0.000419452270
  error estimate for blocks of size 2^( 3) =       0.000432417007
  error estimate for blocks of size 2^( 4) =       0.000445061392
  error estimate for blocks of size 2^( 5) =       0.000457042446
  error estimate for blocks of size 2^( 6) =       0.000466571660
  error estimate for blocks of size 2^( 7) =       0.000471933181

      target function =                  N/A
              le_mean =     -16.910070770400
             les_mean =     286.282505056840
             stat err =       0.000460152170
             autocorr =       1.275497093901
              std dev =       0.576204618967
             le_variance =       0.332011762919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332347320213
                                         uncertainty =       0.004000962147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332347320213
                                         uncertainty =       0.004000962147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407574703
  error estimate for blocks of size 2^( 2) =       0.000419584819
  error estimate for blocks of size 2^( 3) =       0.000432557173
  error estimate for blocks of size 2^( 4) =       0.000445207104
  error estimate for blocks of size 2^( 5) =       0.000457195201
  error estimate for blocks of size 2^( 6) =       0.000466725021
  error estimate for blocks of size 2^( 7) =       0.000472080774

      target function =                  N/A
              le_mean =     -16.910073081458
             les_mean =     286.282805731904
             stat err =       0.000460302025
             autocorr =       1.275473173679
              std dev =       0.576397673281
             le_variance =       0.332234277764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910075238981        initial  <--
     3.9062e-02     3.9062e-01             4.2529e-03       -16.910073836210
     1.5625e-01     1.5625e+00             1.1178e-03       -16.910070770400
     6.2500e-01     6.2500e+00             2.9929e-04       -16.910073081458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7076
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.078236e-01 1 1  ON 0
 uu_1                 1.425418e-01 1 1  ON 1
 uu_2                 4.451960e-02 1 1  ON 2
 uu_3                -1.911931e-02 1 1  ON 3
 uu_4                -6.925768e-02 1 1  ON 4
 uu_5                -1.052081e-01 1 1  ON 5
 uu_6                -1.320147e-01 1 1  ON 6
 uu_7                -1.449038e-01 1 1  ON 7
 uu_8                -1.359333e-01 1 1  ON 8
 uu_9                -1.082659e-01 1 1  ON 9
 ud_0                 4.399249e-01 1 1  ON 10
 ud_1                 1.813962e-01 1 1  ON 11
 ud_2                 6.642312e-02 1 1  ON 12
 ud_3                -3.253307e-03 1 1  ON 13
 ud_4                -5.898679e-02 1 1  ON 14
 ud_5                -1.021531e-01 1 1  ON 15
 ud_6                -1.321148e-01 1 1  ON 16
 ud_7                -1.528036e-01 1 1  ON 17
 ud_8                -1.563822e-01 1 1  ON 18
 ud_9                -1.474494e-01 1 1  ON 19
 eO_0                -7.597672e-01 1 1  ON 20
 eO_1                -4.427599e-01 1 1  ON 21
 eO_2                -2.444994e-02 1 1  ON 22
 eO_3                 3.026499e-01 1 1  ON 23
 eO_4                 5.324400e-01 1 1  ON 24
 eO_5                 4.961041e-01 1 1  ON 25
 eO_6                 2.679399e-01 1 1  ON 26
 eO_7                -3.957927e-02 1 1  ON 27
 eO_8                -2.338112e-01 1 1  ON 28
 eO_9                -9.644096e-02 1 1  ON 29
eH1_0                -2.595512e-01 1 1  ON 30
eH1_1                -1.546562e-01 1 1  ON 31
eH1_2                -1.087890e-01 1 1  ON 32
eH1_3                -5.662014e-02 1 1  ON 33
eH1_4                -4.840640e-03 1 1  ON 34
eH1_5                 3.174324e-02 1 1  ON 35
eH1_6                 9.670587e-02 1 1  ON 36
eH1_7                 1.599651e-01 1 1  ON 37
eH1_8                 1.966952e-01 1 1  ON 38
eH1_9                 9.465637e-02 1 1  ON 39
eH2_0                -2.531116e-01 1 1  ON 40
eH2_1                -1.480582e-01 1 1  ON 41
eH2_2                -1.022958e-01 1 1  ON 42
eH2_3                -5.003092e-02 1 1  ON 43
eH2_4                 1.402276e-03 1 1  ON 44
eH2_5                 3.637806e-02 1 1  ON 45
eH2_6                 1.002609e-01 1 1  ON 46
eH2_7                 1.599879e-01 1 1  ON 47
eH2_8                 1.962142e-01 1 1  ON 48
eH2_9                 7.476794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1615e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.178125
====================================================
  Execution time = 4.1575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0754e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150617291
                                         uncertainty =       0.003756625024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328150617291
                                         uncertainty =       0.003756625024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405076072
  error estimate for blocks of size 2^( 2) =       0.000416689778
  error estimate for blocks of size 2^( 3) =       0.000428896089
  error estimate for blocks of size 2^( 4) =       0.000440378664
  error estimate for blocks of size 2^( 5) =       0.000449946691
  error estimate for blocks of size 2^( 6) =       0.000458263609
  error estimate for blocks of size 2^( 7) =       0.000463861314

      target function =                  N/A
              le_mean =     -16.911344720236
             les_mean =     286.321753330043
             stat err =       0.000453112570
             autocorr =       1.251235451674
              std dev =       0.572864074157
             le_variance =       0.328173247460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691134472024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911344720236       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911345243627       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911345101139       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911344982702       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911345349210       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911345216701       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911346045889       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911345812095       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911345666687       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.780944e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911344720236       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911344884734       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911344841037       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911344817177       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911344873387       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911344675568       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911344971522       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911344939133       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.423699e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911344720236       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911344764186       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911344753047       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911344748108       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911344760444       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911344694328       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911344773749       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.439892e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2340e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.078085e-01 1 1  ON 0
 uu_1                 1.425614e-01 1 1  ON 1
 uu_2                 4.451017e-02 1 1  ON 2
 uu_3                -1.915022e-02 1 1  ON 3
 uu_4                -6.916191e-02 1 1  ON 4
 uu_5                -1.051733e-01 1 1  ON 5
 uu_6                -1.321026e-01 1 1  ON 6
 uu_7                -1.449336e-01 1 1  ON 7
 uu_8                -1.359613e-01 1 1  ON 8
 uu_9                -1.083054e-01 1 1  ON 9
 ud_0                 4.399424e-01 1 1  ON 10
 ud_1                 1.814351e-01 1 1  ON 11
 ud_2                 6.645428e-02 1 1  ON 12
 ud_3                -3.245571e-03 1 1  ON 13
 ud_4                -5.896926e-02 1 1  ON 14
 ud_5                -1.021320e-01 1 1  ON 15
 ud_6                -1.321060e-01 1 1  ON 16
 ud_7                -1.527641e-01 1 1  ON 17
 ud_8                -1.564207e-01 1 1  ON 18
 ud_9                -1.475238e-01 1 1  ON 19
 eO_0                -7.598270e-01 1 1  ON 20
 eO_1                -4.426971e-01 1 1  ON 21
 eO_2                -2.440264e-02 1 1  ON 22
 eO_3                 3.026821e-01 1 1  ON 23
 eO_4                 5.324105e-01 1 1  ON 24
 eO_5                 4.961268e-01 1 1  ON 25
 eO_6                 2.679806e-01 1 1  ON 26
 eO_7                -3.954325e-02 1 1  ON 27
 eO_8                -2.338582e-01 1 1  ON 28
 eO_9                -9.653309e-02 1 1  ON 29
eH1_0                -2.596218e-01 1 1  ON 30
eH1_1                -1.546968e-01 1 1  ON 31
eH1_2                -1.088006e-01 1 1  ON 32
eH1_3                -5.660562e-02 1 1  ON 33
eH1_4                -4.860973e-03 1 1  ON 34
eH1_5                 3.174348e-02 1 1  ON 35
eH1_6                 9.668525e-02 1 1  ON 36
eH1_7                 1.599598e-01 1 1  ON 37
eH1_8                 1.967431e-01 1 1  ON 38
eH1_9                 9.474519e-02 1 1  ON 39
eH2_0                -2.531518e-01 1 1  ON 40
eH2_1                -1.480664e-01 1 1  ON 41
eH2_2                -1.023262e-01 1 1  ON 42
eH2_3                -5.004084e-02 1 1  ON 43
eH2_4                 1.370567e-03 1 1  ON 44
eH2_5                 3.631506e-02 1 1  ON 45
eH2_6                 1.002138e-01 1 1  ON 46
eH2_7                 1.599956e-01 1 1  ON 47
eH2_8                 1.962715e-01 1 1  ON 48
eH2_9                 7.491031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.92
    reference variance = 0.630698
====================================================
  Execution time = 4.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2852e-01
  Total weights = 2.0000e+06
  Execution time = 4.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328494681871
                                         uncertainty =       0.003080471171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328494681871
                                         uncertainty =       0.003080471171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405290946
  error estimate for blocks of size 2^( 2) =       0.000417040783
  error estimate for blocks of size 2^( 3) =       0.000429666164
  error estimate for blocks of size 2^( 4) =       0.000441873403
  error estimate for blocks of size 2^( 5) =       0.000453699188
  error estimate for blocks of size 2^( 6) =       0.000461736986
  error estimate for blocks of size 2^( 7) =       0.000468546587

      target function =                  N/A
              le_mean =     -16.910334293875
             les_mean =     286.287927267612
             stat err =       0.000456464041
             autocorr =       1.268467483728
              std dev =       0.573167952058
             le_variance =       0.328521501267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328504083468
                                         uncertainty =       0.003080673419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328504083468
                                         uncertainty =       0.003080673419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405296793
  error estimate for blocks of size 2^( 2) =       0.000417044512
  error estimate for blocks of size 2^( 3) =       0.000429666825
  error estimate for blocks of size 2^( 4) =       0.000441873928
  error estimate for blocks of size 2^( 5) =       0.000453702985
  error estimate for blocks of size 2^( 6) =       0.000461745445
  error estimate for blocks of size 2^( 7) =       0.000468553289

      target function =                  N/A
              le_mean =     -16.910333930570
             les_mean =     286.287924460538
             stat err =       0.000456468912
             autocorr =       1.268457949131
              std dev =       0.573176221966
             le_variance =       0.328530981428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328487442510
                                         uncertainty =       0.003080503311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328487442510
                                         uncertainty =       0.003080503311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405286509
  error estimate for blocks of size 2^( 2) =       0.000417035350
  error estimate for blocks of size 2^( 3) =       0.000429659016
  error estimate for blocks of size 2^( 4) =       0.000441866488
  error estimate for blocks of size 2^( 5) =       0.000453694702
  error estimate for blocks of size 2^( 6) =       0.000461735310
  error estimate for blocks of size 2^( 7) =       0.000468544134

      target function =                  N/A
              le_mean =     -16.910333932912
             les_mean =     286.287907867485
             stat err =       0.000456460158
             autocorr =       1.268473672699
              std dev =       0.573161678016
             le_variance =       0.328514309146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328491903883
                                         uncertainty =       0.003080461926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328491903883
                                         uncertainty =       0.003080461926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405289236
  error estimate for blocks of size 2^( 2) =       0.000417038990
  error estimate for blocks of size 2^( 3) =       0.000429664177
  error estimate for blocks of size 2^( 4) =       0.000441871496
  error estimate for blocks of size 2^( 5) =       0.000453697660
  error estimate for blocks of size 2^( 6) =       0.000461735848
  error estimate for blocks of size 2^( 7) =       0.000468545445

      target function =                  N/A
              le_mean =     -16.910334221908
             les_mean =     286.287922061716
             stat err =       0.000456462612
             autocorr =       1.268470243593
              std dev =       0.573165533967
             le_variance =       0.328518729328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910334293875        initial  <--
     3.9062e-01     3.9062e+00             5.7809e-04       -16.910333930570
     1.5625e+00     1.5625e+01             1.4237e-04       -16.910333932912
     6.2500e+00     6.2500e+01             3.4399e-05       -16.910334221908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3920
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.078236e-01 1 1  ON 0
 uu_1                 1.425418e-01 1 1  ON 1
 uu_2                 4.451960e-02 1 1  ON 2
 uu_3                -1.911931e-02 1 1  ON 3
 uu_4                -6.925768e-02 1 1  ON 4
 uu_5                -1.052081e-01 1 1  ON 5
 uu_6                -1.320147e-01 1 1  ON 6
 uu_7                -1.449038e-01 1 1  ON 7
 uu_8                -1.359333e-01 1 1  ON 8
 uu_9                -1.082659e-01 1 1  ON 9
 ud_0                 4.399249e-01 1 1  ON 10
 ud_1                 1.813962e-01 1 1  ON 11
 ud_2                 6.642312e-02 1 1  ON 12
 ud_3                -3.253307e-03 1 1  ON 13
 ud_4                -5.898679e-02 1 1  ON 14
 ud_5                -1.021531e-01 1 1  ON 15
 ud_6                -1.321148e-01 1 1  ON 16
 ud_7                -1.528036e-01 1 1  ON 17
 ud_8                -1.563822e-01 1 1  ON 18
 ud_9                -1.474494e-01 1 1  ON 19
 eO_0                -7.597672e-01 1 1  ON 20
 eO_1                -4.427599e-01 1 1  ON 21
 eO_2                -2.444994e-02 1 1  ON 22
 eO_3                 3.026499e-01 1 1  ON 23
 eO_4                 5.324400e-01 1 1  ON 24
 eO_5                 4.961041e-01 1 1  ON 25
 eO_6                 2.679399e-01 1 1  ON 26
 eO_7                -3.957927e-02 1 1  ON 27
 eO_8                -2.338112e-01 1 1  ON 28
 eO_9                -9.644096e-02 1 1  ON 29
eH1_0                -2.595512e-01 1 1  ON 30
eH1_1                -1.546562e-01 1 1  ON 31
eH1_2                -1.087890e-01 1 1  ON 32
eH1_3                -5.662014e-02 1 1  ON 33
eH1_4                -4.840640e-03 1 1  ON 34
eH1_5                 3.174324e-02 1 1  ON 35
eH1_6                 9.670587e-02 1 1  ON 36
eH1_7                 1.599651e-01 1 1  ON 37
eH1_8                 1.966952e-01 1 1  ON 38
eH1_9                 9.465637e-02 1 1  ON 39
eH2_0                -2.531116e-01 1 1  ON 40
eH2_1                -1.480582e-01 1 1  ON 41
eH2_2                -1.022958e-01 1 1  ON 42
eH2_3                -5.003092e-02 1 1  ON 43
eH2_4                 1.402276e-03 1 1  ON 44
eH2_5                 3.637806e-02 1 1  ON 45
eH2_6                 1.002609e-01 1 1  ON 46
eH2_7                 1.599879e-01 1 1  ON 47
eH2_8                 1.962142e-01 1 1  ON 48
eH2_9                 7.476794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1574e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8532
    reference variance = 0.227772
====================================================
  Execution time = 4.1354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3197e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0737e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331975040560
                                         uncertainty =       0.004256773197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331975040560
                                         uncertainty =       0.004256773197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407413973
  error estimate for blocks of size 2^( 2) =       0.000419024654
  error estimate for blocks of size 2^( 3) =       0.000431760340
  error estimate for blocks of size 2^( 4) =       0.000443291882
  error estimate for blocks of size 2^( 5) =       0.000453133234
  error estimate for blocks of size 2^( 6) =       0.000460490809
  error estimate for blocks of size 2^( 7) =       0.000466995084

      target function =                  N/A
              le_mean =     -16.912085690486
             les_mean =     286.350614527574
             stat err =       0.000455977752
             autocorr =       1.252608822420
              std dev =       0.576170366495
             le_variance =       0.331972291227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691208569049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912085690486       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912085678960       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912085707854       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912085756021       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912085744758       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912085716454       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912085698939       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912085716584       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.441216e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912085690486       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912085687432       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912085695521       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912085708436       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912085705455       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912085700000       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912085693194       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912085697272       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.112905e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912085690486       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912085689711       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912085691792       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912085695080       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912085694324       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912085693070       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912085691211       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912085692201       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.784036e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253881 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5628e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.078267e-01 1 1  ON 0
 uu_1                 1.425421e-01 1 1  ON 1
 uu_2                 4.452088e-02 1 1  ON 2
 uu_3                -1.911917e-02 1 1  ON 3
 uu_4                -6.925528e-02 1 1  ON 4
 uu_5                -1.052136e-01 1 1  ON 5
 uu_6                -1.320174e-01 1 1  ON 6
 uu_7                -1.449019e-01 1 1  ON 7
 uu_8                -1.359414e-01 1 1  ON 8
 uu_9                -1.082713e-01 1 1  ON 9
 ud_0                 4.399144e-01 1 1  ON 10
 ud_1                 1.814052e-01 1 1  ON 11
 ud_2                 6.642257e-02 1 1  ON 12
 ud_3                -3.253557e-03 1 1  ON 13
 ud_4                -5.897914e-02 1 1  ON 14
 ud_5                -1.021502e-01 1 1  ON 15
 ud_6                -1.321125e-01 1 1  ON 16
 ud_7                -1.527976e-01 1 1  ON 17
 ud_8                -1.563881e-01 1 1  ON 18
 ud_9                -1.474516e-01 1 1  ON 19
 eO_0                -7.597767e-01 1 1  ON 20
 eO_1                -4.427493e-01 1 1  ON 21
 eO_2                -2.444980e-02 1 1  ON 22
 eO_3                 3.026537e-01 1 1  ON 23
 eO_4                 5.324435e-01 1 1  ON 24
 eO_5                 4.961059e-01 1 1  ON 25
 eO_6                 2.679448e-01 1 1  ON 26
 eO_7                -3.957686e-02 1 1  ON 27
 eO_8                -2.338187e-01 1 1  ON 28
 eO_9                -9.644969e-02 1 1  ON 29
eH1_0                -2.595573e-01 1 1  ON 30
eH1_1                -1.546556e-01 1 1  ON 31
eH1_2                -1.087955e-01 1 1  ON 32
eH1_3                -5.661868e-02 1 1  ON 33
eH1_4                -4.845803e-03 1 1  ON 34
eH1_5                 3.173764e-02 1 1  ON 35
eH1_6                 9.670947e-02 1 1  ON 36
eH1_7                 1.599694e-01 1 1  ON 37
eH1_8                 1.966990e-01 1 1  ON 38
eH1_9                 9.466566e-02 1 1  ON 39
eH2_0                -2.531152e-01 1 1  ON 40
eH2_1                -1.480651e-01 1 1  ON 41
eH2_2                -1.023032e-01 1 1  ON 42
eH2_3                -5.002987e-02 1 1  ON 43
eH2_4                 1.398825e-03 1 1  ON 44
eH2_5                 3.638255e-02 1 1  ON 45
eH2_6                 1.002576e-01 1 1  ON 46
eH2_7                 1.599886e-01 1 1  ON 47
eH2_8                 1.962215e-01 1 1  ON 48
eH2_9                 7.477907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.17535
====================================================
  Execution time = 4.0170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3262e-01
  Total weights = 2.0000e+06
  Execution time = 4.6351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332379716002
                                         uncertainty =       0.003268983074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332379716002
                                         uncertainty =       0.003268983074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407815797
  error estimate for blocks of size 2^( 2) =       0.000419938606
  error estimate for blocks of size 2^( 3) =       0.000432129065
  error estimate for blocks of size 2^( 4) =       0.000444155092
  error estimate for blocks of size 2^( 5) =       0.000455845509
  error estimate for blocks of size 2^( 6) =       0.000463840680
  error estimate for blocks of size 2^( 7) =       0.000468098688

      target function =                  N/A
              le_mean =     -16.910209776694
             les_mean =     286.287821974673
             stat err =       0.000457984992
             autocorr =       1.261172242885
              std dev =       0.576738631602
             le_variance =       0.332627449182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332352118313
                                         uncertainty =       0.003268641380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332352118313
                                         uncertainty =       0.003268641380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407798870
  error estimate for blocks of size 2^( 2) =       0.000419922442
  error estimate for blocks of size 2^( 3) =       0.000432113549
  error estimate for blocks of size 2^( 4) =       0.000444139234
  error estimate for blocks of size 2^( 5) =       0.000455829764
  error estimate for blocks of size 2^( 6) =       0.000463825772
  error estimate for blocks of size 2^( 7) =       0.000468082996

      target function =                  N/A
              le_mean =     -16.910209850487
             les_mean =     286.287796858157
             stat err =       0.000457969442
             autocorr =       1.261191293895
              std dev =       0.576714692843
             le_variance =       0.332599836941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364105585
                                         uncertainty =       0.003268791341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364105585
                                         uncertainty =       0.003268791341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407806223
  error estimate for blocks of size 2^( 2) =       0.000419929462
  error estimate for blocks of size 2^( 3) =       0.000432120289
  error estimate for blocks of size 2^( 4) =       0.000444146145
  error estimate for blocks of size 2^( 5) =       0.000455836635
  error estimate for blocks of size 2^( 6) =       0.000463832273
  error estimate for blocks of size 2^( 7) =       0.000468089870

      target function =                  N/A
              le_mean =     -16.910209814847
             les_mean =     286.287807646186
             stat err =       0.000457976231
             autocorr =       1.261183210039
              std dev =       0.576725090800
             le_variance =       0.332611830358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332377697647
                                         uncertainty =       0.003268958369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332377697647
                                         uncertainty =       0.003268958369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407814559
  error estimate for blocks of size 2^( 2) =       0.000419937424
  error estimate for blocks of size 2^( 3) =       0.000432127930
  error estimate for blocks of size 2^( 4) =       0.000444153936
  error estimate for blocks of size 2^( 5) =       0.000455844362
  error estimate for blocks of size 2^( 6) =       0.000463839593
  error estimate for blocks of size 2^( 7) =       0.000468097550

      target function =                  N/A
              le_mean =     -16.910209781245
             les_mean =     286.287820109149
             stat err =       0.000457983860
             autocorr =       1.261173666238
              std dev =       0.576736880851
             le_variance =       0.332625429734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910209776694        initial
     3.9062e+00     3.9062e+01             4.4412e-05       -16.910209850487  <--
     1.5625e+01     1.5625e+02             1.1129e-05       -16.910209814847
     6.2500e+01     6.2500e+02             2.7840e-06       -16.910209781245

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 6.3462e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452457e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924889e-02 1 1  ON 4
 uu_5                -1.052292e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359655e-01 1 1  ON 8
 uu_9                -1.082875e-01 1 1  ON 9
 ud_0                 4.398875e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253957e-03 1 1  ON 13
 ud_4                -5.895827e-02 1 1  ON 14
 ud_5                -1.021407e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527805e-01 1 1  ON 17
 ud_8                -1.564059e-01 1 1  ON 18
 ud_9                -1.474582e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444910e-02 1 1  ON 22
 eO_3                 3.026646e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679590e-01 1 1  ON 26
 eO_7                -3.956972e-02 1 1  ON 27
 eO_8                -2.338412e-01 1 1  ON 28
 eO_9                -9.647583e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088138e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860623e-03 1 1  ON 34
eH1_5                 3.172072e-02 1 1  ON 35
eH1_6                 9.672011e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967100e-01 1 1  ON 38
eH1_9                 9.469345e-02 1 1  ON 39
eH2_0                -2.531263e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002783e-02 1 1  ON 43
eH2_4                 1.388871e-03 1 1  ON 44
eH2_5                 3.639565e-02 1 1  ON 45
eH2_6                 1.002479e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962435e-01 1 1  ON 48
eH2_9                 7.481235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1910e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9698
    reference variance = 0.328288
====================================================
  Execution time = 4.0694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3589e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0732e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336011035816
                                         uncertainty =       0.004324785679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336011035816
                                         uncertainty =       0.004324785679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409808056
  error estimate for blocks of size 2^( 2) =       0.000421509669
  error estimate for blocks of size 2^( 3) =       0.000433457272
  error estimate for blocks of size 2^( 4) =       0.000444394189
  error estimate for blocks of size 2^( 5) =       0.000453975086
  error estimate for blocks of size 2^( 6) =       0.000463022993
  error estimate for blocks of size 2^( 7) =       0.000469591092

      target function =                  N/A
              le_mean =     -16.911427265899
             les_mean =     286.332257287790
             stat err =       0.000457745840
             autocorr =       1.247635802884
              std dev =       0.579556111119
             le_variance =       0.335885285935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691142726590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911427265899       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911427979091       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911428616041       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911428776018       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911428419594       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911428737075       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911428828734       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911428817978       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911428763176       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.613452e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911427265899       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911427467815       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911427677173       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911427764917       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911427652943       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911427719818       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911427725989       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911427760176       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.286285e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911427265899       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911427318107       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911427374809       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911427400331       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911427371365       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911427387846       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911427387041       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911427397107       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.569042e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1438e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.078231e-01 1 1  ON 0
 uu_1                 1.425496e-01 1 1  ON 1
 uu_2                 4.449438e-02 1 1  ON 2
 uu_3                -1.912156e-02 1 1  ON 3
 uu_4                -6.921973e-02 1 1  ON 4
 uu_5                -1.052318e-01 1 1  ON 5
 uu_6                -1.320418e-01 1 1  ON 6
 uu_7                -1.449090e-01 1 1  ON 7
 uu_8                -1.359762e-01 1 1  ON 8
 uu_9                -1.082934e-01 1 1  ON 9
 ud_0                 4.398345e-01 1 1  ON 10
 ud_1                 1.814736e-01 1 1  ON 11
 ud_2                 6.642477e-02 1 1  ON 12
 ud_3                -3.249793e-03 1 1  ON 13
 ud_4                -5.895536e-02 1 1  ON 14
 ud_5                -1.021444e-01 1 1  ON 15
 ud_6                -1.321143e-01 1 1  ON 16
 ud_7                -1.527740e-01 1 1  ON 17
 ud_8                -1.564219e-01 1 1  ON 18
 ud_9                -1.474517e-01 1 1  ON 19
 eO_0                -7.598397e-01 1 1  ON 20
 eO_1                -4.426978e-01 1 1  ON 21
 eO_2                -2.443791e-02 1 1  ON 22
 eO_3                 3.026760e-01 1 1  ON 23
 eO_4                 5.324863e-01 1 1  ON 24
 eO_5                 4.961425e-01 1 1  ON 25
 eO_6                 2.679483e-01 1 1  ON 26
 eO_7                -3.957508e-02 1 1  ON 27
 eO_8                -2.338676e-01 1 1  ON 28
 eO_9                -9.650093e-02 1 1  ON 29
eH1_0                -2.595859e-01 1 1  ON 30
eH1_1                -1.546493e-01 1 1  ON 31
eH1_2                -1.088479e-01 1 1  ON 32
eH1_3                -5.662148e-02 1 1  ON 33
eH1_4                -4.886912e-03 1 1  ON 34
eH1_5                 3.168131e-02 1 1  ON 35
eH1_6                 9.669443e-02 1 1  ON 36
eH1_7                 1.599927e-01 1 1  ON 37
eH1_8                 1.967566e-01 1 1  ON 38
eH1_9                 9.475632e-02 1 1  ON 39
eH2_0                -2.531452e-01 1 1  ON 40
eH2_1                -1.480941e-01 1 1  ON 41
eH2_2                -1.023467e-01 1 1  ON 42
eH2_3                -5.002807e-02 1 1  ON 43
eH2_4                 1.377194e-03 1 1  ON 44
eH2_5                 3.637800e-02 1 1  ON 45
eH2_6                 1.002562e-01 1 1  ON 46
eH2_7                 1.600074e-01 1 1  ON 47
eH2_8                 1.962643e-01 1 1  ON 48
eH2_9                 7.484613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9441
    reference variance = 0.258046
====================================================
  Execution time = 4.0137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3331e-01
  Total weights = 2.0000e+06
  Execution time = 4.6512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427581952
                                         uncertainty =       0.004530416886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427581952
                                         uncertainty =       0.004530416886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408258832
  error estimate for blocks of size 2^( 2) =       0.000419893100
  error estimate for blocks of size 2^( 3) =       0.000432370120
  error estimate for blocks of size 2^( 4) =       0.000444044101
  error estimate for blocks of size 2^( 5) =       0.000453797445
  error estimate for blocks of size 2^( 6) =       0.000461354727
  error estimate for blocks of size 2^( 7) =       0.000465547735

      target function =                  N/A
              le_mean =     -16.910303762349
             les_mean =     286.291723716566
             stat err =       0.000456186002
             autocorr =       1.248569528011
              std dev =       0.577365177613
             le_variance =       0.333350548320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333329724477
                                         uncertainty =       0.004527980277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333329724477
                                         uncertainty =       0.004527980277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408198910
  error estimate for blocks of size 2^( 2) =       0.000419835746
  error estimate for blocks of size 2^( 3) =       0.000432312385
  error estimate for blocks of size 2^( 4) =       0.000443985245
  error estimate for blocks of size 2^( 5) =       0.000453736885
  error estimate for blocks of size 2^( 6) =       0.000461294337
  error estimate for blocks of size 2^( 7) =       0.000465484784

      target function =                  N/A
              le_mean =     -16.910302384427
             les_mean =     286.291579266685
             stat err =       0.000456125313
             autocorr =       1.248603841954
              std dev =       0.577280434926
             le_variance =       0.333252700549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333347486097
                                         uncertainty =       0.004528607396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333347486097
                                         uncertainty =       0.004528607396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408209789
  error estimate for blocks of size 2^( 2) =       0.000419846100
  error estimate for blocks of size 2^( 3) =       0.000432323221
  error estimate for blocks of size 2^( 4) =       0.000443996836
  error estimate for blocks of size 2^( 5) =       0.000453749325
  error estimate for blocks of size 2^( 6) =       0.000461306940
  error estimate for blocks of size 2^( 7) =       0.000465498210

      target function =                  N/A
              le_mean =     -16.910302843989
             les_mean =     286.291612572552
             stat err =       0.000456137828
             autocorr =       1.248605805753
              std dev =       0.577295819971
             le_variance =       0.333270463756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333416336276
                                         uncertainty =       0.004530166004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333416336276
                                         uncertainty =       0.004530166004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408251947
  error estimate for blocks of size 2^( 2) =       0.000419886494
  error estimate for blocks of size 2^( 3) =       0.000432363530
  error estimate for blocks of size 2^( 4) =       0.000444037469
  error estimate for blocks of size 2^( 5) =       0.000453790699
  error estimate for blocks of size 2^( 6) =       0.000461348036
  error estimate for blocks of size 2^( 7) =       0.000465540806

      target function =                  N/A
              le_mean =     -16.910303631643
             les_mean =     286.291708052145
             stat err =       0.000456179253
             autocorr =       1.248574697511
              std dev =       0.577355440324
             le_variance =       0.333339304472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910303762349        initial  <--
     9.7656e-01     9.7656e+00             2.6135e-04       -16.910302384427
     3.9062e+00     3.9062e+01             6.2863e-05       -16.910302843989
     1.5625e+01     1.5625e+02             1.5690e-05       -16.910303631643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5139
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452457e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924889e-02 1 1  ON 4
 uu_5                -1.052292e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359655e-01 1 1  ON 8
 uu_9                -1.082875e-01 1 1  ON 9
 ud_0                 4.398875e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253957e-03 1 1  ON 13
 ud_4                -5.895827e-02 1 1  ON 14
 ud_5                -1.021407e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527805e-01 1 1  ON 17
 ud_8                -1.564059e-01 1 1  ON 18
 ud_9                -1.474582e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444910e-02 1 1  ON 22
 eO_3                 3.026646e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679590e-01 1 1  ON 26
 eO_7                -3.956972e-02 1 1  ON 27
 eO_8                -2.338412e-01 1 1  ON 28
 eO_9                -9.647583e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088138e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860623e-03 1 1  ON 34
eH1_5                 3.172072e-02 1 1  ON 35
eH1_6                 9.672011e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967100e-01 1 1  ON 38
eH1_9                 9.469345e-02 1 1  ON 39
eH2_0                -2.531263e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002783e-02 1 1  ON 43
eH2_4                 1.388871e-03 1 1  ON 44
eH2_5                 3.639565e-02 1 1  ON 45
eH2_6                 1.002479e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962435e-01 1 1  ON 48
eH2_9                 7.481235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1496e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.444524
====================================================
  Execution time = 4.1107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0725e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327061009492
                                         uncertainty =       0.003214248703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327061009492
                                         uncertainty =       0.003214248703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404363211
  error estimate for blocks of size 2^( 2) =       0.000416147919
  error estimate for blocks of size 2^( 3) =       0.000427955784
  error estimate for blocks of size 2^( 4) =       0.000439313235
  error estimate for blocks of size 2^( 5) =       0.000450074421
  error estimate for blocks of size 2^( 6) =       0.000458347740
  error estimate for blocks of size 2^( 7) =       0.000463751583

      target function =                  N/A
              le_mean =     -16.910558718732
             les_mean =     286.294015229722
             stat err =       0.000452871745
             autocorr =       1.254316618466
              std dev =       0.571855937754
             le_variance =       0.327019213544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691055871873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910558718732       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910558743797       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910558756678       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910558826956       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910558826729       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910558850343       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910558835528       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910558833018       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.037359e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910558718732       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910558725097       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910558728440       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910558746098       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910558746447       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910558752303       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910558748524       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910558748132       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.094623e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910558718732       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910558720330       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910558721173       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910558725593       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910558725707       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910558727156       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910558726203       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910558726141       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.273796e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1844e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078348e-01 1 1  ON 0
 uu_1                 1.425436e-01 1 1  ON 1
 uu_2                 4.452290e-02 1 1  ON 2
 uu_3                -1.912028e-02 1 1  ON 3
 uu_4                -6.924610e-02 1 1  ON 4
 uu_5                -1.052318e-01 1 1  ON 5
 uu_6                -1.320269e-01 1 1  ON 6
 uu_7                -1.448956e-01 1 1  ON 7
 uu_8                -1.359632e-01 1 1  ON 8
 uu_9                -1.082877e-01 1 1  ON 9
 ud_0                 4.398880e-01 1 1  ON 10
 ud_1                 1.814308e-01 1 1  ON 11
 ud_2                 6.642252e-02 1 1  ON 12
 ud_3                -3.254340e-03 1 1  ON 13
 ud_4                -5.895934e-02 1 1  ON 14
 ud_5                -1.021371e-01 1 1  ON 15
 ud_6                -1.321082e-01 1 1  ON 16
 ud_7                -1.527787e-01 1 1  ON 17
 ud_8                -1.564069e-01 1 1  ON 18
 ud_9                -1.474592e-01 1 1  ON 19
 eO_0                -7.598037e-01 1 1  ON 20
 eO_1                -4.427203e-01 1 1  ON 21
 eO_2                -2.444822e-02 1 1  ON 22
 eO_3                 3.026659e-01 1 1  ON 23
 eO_4                 5.324575e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679595e-01 1 1  ON 26
 eO_7                -3.956766e-02 1 1  ON 27
 eO_8                -2.338427e-01 1 1  ON 28
 eO_9                -9.647944e-02 1 1  ON 29
eH1_0                -2.595767e-01 1 1  ON 30
eH1_1                -1.546519e-01 1 1  ON 31
eH1_2                -1.088166e-01 1 1  ON 32
eH1_3                -5.661856e-02 1 1  ON 33
eH1_4                -4.862779e-03 1 1  ON 34
eH1_5                 3.171899e-02 1 1  ON 35
eH1_6                 9.672095e-02 1 1  ON 36
eH1_7                 1.599828e-01 1 1  ON 37
eH1_8                 1.967131e-01 1 1  ON 38
eH1_9                 9.469781e-02 1 1  ON 39
eH2_0                -2.531271e-01 1 1  ON 40
eH2_1                -1.480847e-01 1 1  ON 41
eH2_2                -1.023276e-01 1 1  ON 42
eH2_3                -5.002936e-02 1 1  ON 43
eH2_4                 1.386076e-03 1 1  ON 44
eH2_5                 3.639329e-02 1 1  ON 45
eH2_6                 1.002477e-01 1 1  ON 46
eH2_7                 1.599922e-01 1 1  ON 47
eH2_8                 1.962469e-01 1 1  ON 48
eH2_9                 7.481745e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9597
    reference variance = 0.166637
====================================================
  Execution time = 4.0098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4646e-01
  Total weights = 2.0000e+06
  Execution time = 4.6248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346613973877
                                         uncertainty =       0.013808629578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346613973877
                                         uncertainty =       0.013808629578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416208652
  error estimate for blocks of size 2^( 2) =       0.000428052585
  error estimate for blocks of size 2^( 3) =       0.000440575379
  error estimate for blocks of size 2^( 4) =       0.000452663613
  error estimate for blocks of size 2^( 5) =       0.000463891223
  error estimate for blocks of size 2^( 6) =       0.000471393374
  error estimate for blocks of size 2^( 7) =       0.000477407696

      target function =                  N/A
              le_mean =     -16.909402112733
             les_mean =     286.274338920872
             stat err =       0.000466338976
             autocorr =       1.255397392348
              std dev =       0.588607920431
             le_variance =       0.346459283994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346616345363
                                         uncertainty =       0.013808572028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346616345363
                                         uncertainty =       0.013808572028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416210078
  error estimate for blocks of size 2^( 2) =       0.000428053873
  error estimate for blocks of size 2^( 3) =       0.000440576530
  error estimate for blocks of size 2^( 4) =       0.000452664612
  error estimate for blocks of size 2^( 5) =       0.000463892006
  error estimate for blocks of size 2^( 6) =       0.000471393818
  error estimate for blocks of size 2^( 7) =       0.000477407712

      target function =                  N/A
              le_mean =     -16.909401976021
             les_mean =     286.274336672108
             stat err =       0.000466339537
             autocorr =       1.255391807056
              std dev =       0.588609937638
             le_variance =       0.346461658686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346615123212
                                         uncertainty =       0.013808595858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346615123212
                                         uncertainty =       0.013808595858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416209343
  error estimate for blocks of size 2^( 2) =       0.000428053207
  error estimate for blocks of size 2^( 3) =       0.000440575932
  error estimate for blocks of size 2^( 4) =       0.000452664090
  error estimate for blocks of size 2^( 5) =       0.000463891590
  error estimate for blocks of size 2^( 6) =       0.000471393569
  error estimate for blocks of size 2^( 7) =       0.000477407671

      target function =                  N/A
              le_mean =     -16.909402043419
             les_mean =     286.274337727764
             stat err =       0.000466339230
             autocorr =       1.255394587252
              std dev =       0.588608898189
             le_variance =       0.346460435027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346614115973
                                         uncertainty =       0.013808625189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346614115973
                                         uncertainty =       0.013808625189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416208737
  error estimate for blocks of size 2^( 2) =       0.000428052661
  error estimate for blocks of size 2^( 3) =       0.000440575447
  error estimate for blocks of size 2^( 4) =       0.000452663672
  error estimate for blocks of size 2^( 5) =       0.000463891268
  error estimate for blocks of size 2^( 6) =       0.000471393397
  error estimate for blocks of size 2^( 7) =       0.000477407692

      target function =                  N/A
              le_mean =     -16.909402104015
             les_mean =     286.274338768337
             stat err =       0.000466339007
             autocorr =       1.255397041508
              std dev =       0.588608041319
             le_variance =       0.346459426305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909402112733        initial  <--
     9.7656e+00     9.7656e+01             2.0374e-05       -16.909401976021
     3.9062e+01     3.9062e+02             5.0946e-06       -16.909402043419
     1.5625e+02     1.5625e+03             1.2738e-06       -16.909402104015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.7115
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452457e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924889e-02 1 1  ON 4
 uu_5                -1.052292e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359655e-01 1 1  ON 8
 uu_9                -1.082875e-01 1 1  ON 9
 ud_0                 4.398875e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253957e-03 1 1  ON 13
 ud_4                -5.895827e-02 1 1  ON 14
 ud_5                -1.021407e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527805e-01 1 1  ON 17
 ud_8                -1.564059e-01 1 1  ON 18
 ud_9                -1.474582e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444910e-02 1 1  ON 22
 eO_3                 3.026646e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679590e-01 1 1  ON 26
 eO_7                -3.956972e-02 1 1  ON 27
 eO_8                -2.338412e-01 1 1  ON 28
 eO_9                -9.647583e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088138e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860623e-03 1 1  ON 34
eH1_5                 3.172072e-02 1 1  ON 35
eH1_6                 9.672011e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967100e-01 1 1  ON 38
eH1_9                 9.469345e-02 1 1  ON 39
eH2_0                -2.531263e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002783e-02 1 1  ON 43
eH2_4                 1.388871e-03 1 1  ON 44
eH2_5                 3.639565e-02 1 1  ON 45
eH2_6                 1.002479e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962435e-01 1 1  ON 48
eH2_9                 7.481235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1856e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.404707
====================================================
  Execution time = 4.1663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0877e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322755806980
                                         uncertainty =       0.003221503750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322755806980
                                         uncertainty =       0.003221503750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401812758
  error estimate for blocks of size 2^( 2) =       0.000413448321
  error estimate for blocks of size 2^( 3) =       0.000425068963
  error estimate for blocks of size 2^( 4) =       0.000436287247
  error estimate for blocks of size 2^( 5) =       0.000446117134
  error estimate for blocks of size 2^( 6) =       0.000452698138
  error estimate for blocks of size 2^( 7) =       0.000456169134

      target function =                  N/A
              le_mean =     -16.911388186958
             les_mean =     286.317957234289
             stat err =       0.000447817913
             autocorr =       1.242096902905
              std dev =       0.568249052590
             le_variance =       0.322906985770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691138818696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911388186958       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911388190497       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911388189892       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911388191926       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911388197517       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911388197677       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911388195564       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911388195901       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.988657e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911388186958       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911388187843       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911388187691       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911388188199       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911388189598       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911388189640       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911388189114       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911388189198       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.984341e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911388186958       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911388187179       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911388187141       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911388187268       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911388187618       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911388187629       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911388187497       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911388187514       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.246882e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2554e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452439e-02 1 1  ON 2
 uu_3                -1.911863e-02 1 1  ON 3
 uu_4                -6.924845e-02 1 1  ON 4
 uu_5                -1.052291e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082877e-01 1 1  ON 9
 ud_0                 4.398877e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642183e-02 1 1  ON 12
 ud_3                -3.253918e-03 1 1  ON 13
 ud_4                -5.895837e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321062e-01 1 1  ON 16
 ud_7                -1.527804e-01 1 1  ON 17
 ud_8                -1.564062e-01 1 1  ON 18
 ud_9                -1.474584e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444869e-02 1 1  ON 22
 eO_3                 3.026648e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961117e-01 1 1  ON 25
 eO_6                 2.679589e-01 1 1  ON 26
 eO_7                -3.956975e-02 1 1  ON 27
 eO_8                -2.338415e-01 1 1  ON 28
 eO_9                -9.647613e-02 1 1  ON 29
eH1_0                -2.595756e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661583e-02 1 1  ON 33
eH1_4                -4.860748e-03 1 1  ON 34
eH1_5                 3.172058e-02 1 1  ON 35
eH1_6                 9.672022e-02 1 1  ON 36
eH1_7                 1.599824e-01 1 1  ON 37
eH1_8                 1.967104e-01 1 1  ON 38
eH1_9                 9.469391e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480855e-01 1 1  ON 41
eH2_2                -1.023245e-01 1 1  ON 42
eH2_3                -5.002790e-02 1 1  ON 43
eH2_4                 1.388839e-03 1 1  ON 44
eH2_5                 3.639545e-02 1 1  ON 45
eH2_6                 1.002478e-01 1 1  ON 46
eH2_7                 1.599905e-01 1 1  ON 47
eH2_8                 1.962437e-01 1 1  ON 48
eH2_9                 7.481282e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8608
    reference variance = 0.178746
====================================================
  Execution time = 4.0237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3462e-01
  Total weights = 2.0000e+06
  Execution time = 4.6082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434314203
                                         uncertainty =       0.004959972950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434314203
                                         uncertainty =       0.004959972950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032518
  error estimate for blocks of size 2^( 2) =       0.000420849667
  error estimate for blocks of size 2^( 3) =       0.000432559042
  error estimate for blocks of size 2^( 4) =       0.000444775117
  error estimate for blocks of size 2^( 5) =       0.000455572783
  error estimate for blocks of size 2^( 6) =       0.000464244043
  error estimate for blocks of size 2^( 7) =       0.000471160839

      target function =                  N/A
              le_mean =     -16.911054682511
             les_mean =     286.318385509304
             stat err =       0.000458938196
             autocorr =       1.258904355240
              std dev =       0.578459334545
             le_variance =       0.334615201723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434321230
                                         uncertainty =       0.004959959773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434321230
                                         uncertainty =       0.004959959773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032523
  error estimate for blocks of size 2^( 2) =       0.000420849671
  error estimate for blocks of size 2^( 3) =       0.000432559031
  error estimate for blocks of size 2^( 4) =       0.000444775098
  error estimate for blocks of size 2^( 5) =       0.000455572752
  error estimate for blocks of size 2^( 6) =       0.000464244026
  error estimate for blocks of size 2^( 7) =       0.000471160841

      target function =                  N/A
              le_mean =     -16.911054675688
             les_mean =     286.318385286130
             stat err =       0.000458938179
             autocorr =       1.258904236829
              std dev =       0.578459341116
             le_variance =       0.334615209324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434316515
                                         uncertainty =       0.004959966342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434316515
                                         uncertainty =       0.004959966342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032520
  error estimate for blocks of size 2^( 2) =       0.000420849668
  error estimate for blocks of size 2^( 3) =       0.000432559036
  error estimate for blocks of size 2^( 4) =       0.000444775107
  error estimate for blocks of size 2^( 5) =       0.000455572767
  error estimate for blocks of size 2^( 6) =       0.000464244034
  error estimate for blocks of size 2^( 7) =       0.000471160840

      target function =                  N/A
              le_mean =     -16.911054679092
             les_mean =     286.318385396255
             stat err =       0.000458938187
             autocorr =       1.258904296875
              std dev =       0.578459336790
             le_variance =       0.334615204320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434314452
                                         uncertainty =       0.004959972123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334434314452
                                         uncertainty =       0.004959972123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032518
  error estimate for blocks of size 2^( 2) =       0.000420849667
  error estimate for blocks of size 2^( 3) =       0.000432559041
  error estimate for blocks of size 2^( 4) =       0.000444775116
  error estimate for blocks of size 2^( 5) =       0.000455572781
  error estimate for blocks of size 2^( 6) =       0.000464244042
  error estimate for blocks of size 2^( 7) =       0.000471160839

      target function =                  N/A
              le_mean =     -16.911054682083
             les_mean =     286.318385495114
             stat err =       0.000458938194
             autocorr =       1.258904347975
              std dev =       0.578459334791
             le_variance =       0.334615202007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911054682511        initial  <--
     9.7656e+01     9.7656e+02             1.9887e-06       -16.911054675688
     3.9062e+02     3.9062e+03             4.9843e-07       -16.911054679092
     1.5625e+03     1.5625e+04             1.2469e-07       -16.911054682083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4053
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452457e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924889e-02 1 1  ON 4
 uu_5                -1.052292e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359655e-01 1 1  ON 8
 uu_9                -1.082875e-01 1 1  ON 9
 ud_0                 4.398875e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253957e-03 1 1  ON 13
 ud_4                -5.895827e-02 1 1  ON 14
 ud_5                -1.021407e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527805e-01 1 1  ON 17
 ud_8                -1.564059e-01 1 1  ON 18
 ud_9                -1.474582e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444910e-02 1 1  ON 22
 eO_3                 3.026646e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679590e-01 1 1  ON 26
 eO_7                -3.956972e-02 1 1  ON 27
 eO_8                -2.338412e-01 1 1  ON 28
 eO_9                -9.647583e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088138e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860623e-03 1 1  ON 34
eH1_5                 3.172072e-02 1 1  ON 35
eH1_6                 9.672011e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967100e-01 1 1  ON 38
eH1_9                 9.469345e-02 1 1  ON 39
eH2_0                -2.531263e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002783e-02 1 1  ON 43
eH2_4                 1.388871e-03 1 1  ON 44
eH2_5                 3.639565e-02 1 1  ON 45
eH2_6                 1.002479e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962435e-01 1 1  ON 48
eH2_9                 7.481235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1597e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.223696
====================================================
  Execution time = 4.1667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0838e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324175319366
                                         uncertainty =       0.002591818718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324175319366
                                         uncertainty =       0.002591818718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402735510
  error estimate for blocks of size 2^( 2) =       0.000414481453
  error estimate for blocks of size 2^( 3) =       0.000427020537
  error estimate for blocks of size 2^( 4) =       0.000439269432
  error estimate for blocks of size 2^( 5) =       0.000448420634
  error estimate for blocks of size 2^( 6) =       0.000456010072
  error estimate for blocks of size 2^( 7) =       0.000460321865

      target function =                  N/A
              le_mean =     -16.910115376804
             les_mean =     286.276393676697
             stat err =       0.000451005501
             autocorr =       1.254075922675
              std dev =       0.569554020323
             le_variance =       0.324391782066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691011537680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910115376804       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910115377841       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910115377941       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910115378107       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910115378108       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910115378252       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910115378114       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910115378043       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.363039e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910115376804       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910115377063       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910115377088       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910115377130       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910115377130       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910115377161       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910115377132       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910115377115       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.907663e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910115376804       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910115376869       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910115376875       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910115376886       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910115376882       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910115376902       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910115376883       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910115376881       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.476920e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2516e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078364e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452456e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924887e-02 1 1  ON 4
 uu_5                -1.052292e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359655e-01 1 1  ON 8
 uu_9                -1.082876e-01 1 1  ON 9
 ud_0                 4.398875e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253956e-03 1 1  ON 13
 ud_4                -5.895827e-02 1 1  ON 14
 ud_5                -1.021407e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527805e-01 1 1  ON 17
 ud_8                -1.564059e-01 1 1  ON 18
 ud_9                -1.474582e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444907e-02 1 1  ON 22
 eO_3                 3.026647e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679590e-01 1 1  ON 26
 eO_7                -3.956970e-02 1 1  ON 27
 eO_8                -2.338412e-01 1 1  ON 28
 eO_9                -9.647586e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088139e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860633e-03 1 1  ON 34
eH1_5                 3.172072e-02 1 1  ON 35
eH1_6                 9.672014e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967100e-01 1 1  ON 38
eH1_9                 9.469348e-02 1 1  ON 39
eH2_0                -2.531263e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002785e-02 1 1  ON 43
eH2_4                 1.388842e-03 1 1  ON 44
eH2_5                 3.639564e-02 1 1  ON 45
eH2_6                 1.002479e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962435e-01 1 1  ON 48
eH2_9                 7.481241e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.200928
====================================================
  Execution time = 4.1102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2757e-01
  Total weights = 2.0000e+06
  Execution time = 4.6246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608470142
                                         uncertainty =       0.003082111282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608470142
                                         uncertainty =       0.003082111282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404706029
  error estimate for blocks of size 2^( 2) =       0.000416501571
  error estimate for blocks of size 2^( 3) =       0.000428984200
  error estimate for blocks of size 2^( 4) =       0.000440605219
  error estimate for blocks of size 2^( 5) =       0.000451634525
  error estimate for blocks of size 2^( 6) =       0.000459910357
  error estimate for blocks of size 2^( 7) =       0.000464001357

      target function =                  N/A
              le_mean =     -16.910248798886
             les_mean =     286.284088215771
             stat err =       0.000454037865
             autocorr =       1.258649469581
              std dev =       0.572340754569
             le_variance =       0.327573939341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608539752
                                         uncertainty =       0.003082112269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608539752
                                         uncertainty =       0.003082112269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404706072
  error estimate for blocks of size 2^( 2) =       0.000416501612
  error estimate for blocks of size 2^( 3) =       0.000428984239
  error estimate for blocks of size 2^( 4) =       0.000440605255
  error estimate for blocks of size 2^( 5) =       0.000451634560
  error estimate for blocks of size 2^( 6) =       0.000459910389
  error estimate for blocks of size 2^( 7) =       0.000464001391

      target function =                  N/A
              le_mean =     -16.910248799478
             les_mean =     286.284088305362
             stat err =       0.000454037899
             autocorr =       1.258649391815
              std dev =       0.572340815343
             le_variance =       0.327574008907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608504953
                                         uncertainty =       0.003082111776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608504953
                                         uncertainty =       0.003082111776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404706050
  error estimate for blocks of size 2^( 2) =       0.000416501591
  error estimate for blocks of size 2^( 3) =       0.000428984219
  error estimate for blocks of size 2^( 4) =       0.000440605237
  error estimate for blocks of size 2^( 5) =       0.000451634543
  error estimate for blocks of size 2^( 6) =       0.000459910373
  error estimate for blocks of size 2^( 7) =       0.000464001374

      target function =                  N/A
              le_mean =     -16.910248799182
             les_mean =     286.284088260575
             stat err =       0.000454037882
             autocorr =       1.258649430682
              std dev =       0.572340784962
             le_variance =       0.327573974131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608474494
                                         uncertainty =       0.003082111344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327608474494
                                         uncertainty =       0.003082111344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404706031
  error estimate for blocks of size 2^( 2) =       0.000416501573
  error estimate for blocks of size 2^( 3) =       0.000428984202
  error estimate for blocks of size 2^( 4) =       0.000440605221
  error estimate for blocks of size 2^( 5) =       0.000451634527
  error estimate for blocks of size 2^( 6) =       0.000459910359
  error estimate for blocks of size 2^( 7) =       0.000464001359

      target function =                  N/A
              le_mean =     -16.910248798923
             les_mean =     286.284088221372
             stat err =       0.000454037867
             autocorr =       1.258649464707
              std dev =       0.572340758369
             le_variance =       0.327573943690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910248798886        initial
     9.7656e+02     9.7656e+03             2.3630e-07       -16.910248799478  <--
     3.9062e+03     3.9062e+04             5.9077e-08       -16.910248799182
     1.5625e+04     1.5625e+05             1.4769e-08       -16.910248798923

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 6.4320e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078366e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452452e-02 1 1  ON 2
 uu_3                -1.911851e-02 1 1  ON 3
 uu_4                -6.924880e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320261e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359656e-01 1 1  ON 8
 uu_9                -1.082876e-01 1 1  ON 9
 ud_0                 4.398876e-01 1 1  ON 10
 ud_1                 1.814290e-01 1 1  ON 11
 ud_2                 6.642166e-02 1 1  ON 12
 ud_3                -3.253951e-03 1 1  ON 13
 ud_4                -5.895826e-02 1 1  ON 14
 ud_5                -1.021406e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527804e-01 1 1  ON 17
 ud_8                -1.564060e-01 1 1  ON 18
 ud_9                -1.474583e-01 1 1  ON 19
 eO_0                -7.598021e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444899e-02 1 1  ON 22
 eO_3                 3.026647e-01 1 1  ON 23
 eO_4                 5.324544e-01 1 1  ON 24
 eO_5                 4.961115e-01 1 1  ON 25
 eO_6                 2.679591e-01 1 1  ON 26
 eO_7                -3.956966e-02 1 1  ON 27
 eO_8                -2.338413e-01 1 1  ON 28
 eO_9                -9.647598e-02 1 1  ON 29
eH1_0                -2.595755e-01 1 1  ON 30
eH1_1                -1.546543e-01 1 1  ON 31
eH1_2                -1.088140e-01 1 1  ON 32
eH1_3                -5.661543e-02 1 1  ON 33
eH1_4                -4.860664e-03 1 1  ON 34
eH1_5                 3.172070e-02 1 1  ON 35
eH1_6                 9.672021e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967101e-01 1 1  ON 38
eH1_9                 9.469355e-02 1 1  ON 39
eH2_0                -2.531264e-01 1 1  ON 40
eH2_1                -1.480857e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002789e-02 1 1  ON 43
eH2_4                 1.388754e-03 1 1  ON 44
eH2_5                 3.639560e-02 1 1  ON 45
eH2_6                 1.002478e-01 1 1  ON 46
eH2_7                 1.599906e-01 1 1  ON 47
eH2_8                 1.962436e-01 1 1  ON 48
eH2_9                 7.481259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1684e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9581
    reference variance = 0.200339
====================================================
  Execution time = 4.2292e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0838e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340061861970
                                         uncertainty =       0.009250507437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340061861970
                                         uncertainty =       0.009250507437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412334046
  error estimate for blocks of size 2^( 2) =       0.000423652245
  error estimate for blocks of size 2^( 3) =       0.000434970817
  error estimate for blocks of size 2^( 4) =       0.000446170277
  error estimate for blocks of size 2^( 5) =       0.000456553128
  error estimate for blocks of size 2^( 6) =       0.000463606336
  error estimate for blocks of size 2^( 7) =       0.000466065875

      target function =                  N/A
              le_mean =     -16.911448020789
             les_mean =     286.337112720961
             stat err =       0.000458098904
             autocorr =       1.234298254446
              std dev =       0.583128400217
             le_variance =       0.340038731139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691144802079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911448020789       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911448019983       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911448020219       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911448020086       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911448019968       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911448021552       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911448021892       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911448021557       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 7.557615e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911448020789       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911448020587       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911448020646       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911448020613       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911448020583       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911448020981       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911448021059       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911448020968       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 1.890615e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911448020789       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911448020738       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911448020753       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911448020745       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911448020740       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911448020835       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911448020857       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911448020835       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 4.727296e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3141e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078366e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452444e-02 1 1  ON 2
 uu_3                -1.911851e-02 1 1  ON 3
 uu_4                -6.924869e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320262e-01 1 1  ON 6
 uu_7                -1.448971e-01 1 1  ON 7
 uu_8                -1.359656e-01 1 1  ON 8
 uu_9                -1.082877e-01 1 1  ON 9
 ud_0                 4.398874e-01 1 1  ON 10
 ud_1                 1.814291e-01 1 1  ON 11
 ud_2                 6.642176e-02 1 1  ON 12
 ud_3                -3.253861e-03 1 1  ON 13
 ud_4                -5.895820e-02 1 1  ON 14
 ud_5                -1.021406e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527804e-01 1 1  ON 17
 ud_8                -1.564061e-01 1 1  ON 18
 ud_9                -1.474584e-01 1 1  ON 19
 eO_0                -7.598022e-01 1 1  ON 20
 eO_1                -4.427202e-01 1 1  ON 21
 eO_2                -2.444889e-02 1 1  ON 22
 eO_3                 3.026646e-01 1 1  ON 23
 eO_4                 5.324545e-01 1 1  ON 24
 eO_5                 4.961116e-01 1 1  ON 25
 eO_6                 2.679591e-01 1 1  ON 26
 eO_7                -3.956957e-02 1 1  ON 27
 eO_8                -2.338414e-01 1 1  ON 28
 eO_9                -9.647614e-02 1 1  ON 29
eH1_0                -2.595755e-01 1 1  ON 30
eH1_1                -1.546544e-01 1 1  ON 31
eH1_2                -1.088140e-01 1 1  ON 32
eH1_3                -5.661542e-02 1 1  ON 33
eH1_4                -4.860850e-03 1 1  ON 34
eH1_5                 3.172069e-02 1 1  ON 35
eH1_6                 9.672017e-02 1 1  ON 36
eH1_7                 1.599822e-01 1 1  ON 37
eH1_8                 1.967102e-01 1 1  ON 38
eH1_9                 9.469374e-02 1 1  ON 39
eH2_0                -2.531264e-01 1 1  ON 40
eH2_1                -1.480856e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002808e-02 1 1  ON 43
eH2_4                 1.388723e-03 1 1  ON 44
eH2_5                 3.639547e-02 1 1  ON 45
eH2_6                 1.002477e-01 1 1  ON 46
eH2_7                 1.599907e-01 1 1  ON 47
eH2_8                 1.962437e-01 1 1  ON 48
eH2_9                 7.481277e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.196102
====================================================
  Execution time = 4.3484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3021e-01
  Total weights = 2.0000e+06
  Execution time = 4.6224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274901474
                                         uncertainty =       0.003342436363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274901474
                                         uncertainty =       0.003342436363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406331701
  error estimate for blocks of size 2^( 2) =       0.000418493553
  error estimate for blocks of size 2^( 3) =       0.000430964255
  error estimate for blocks of size 2^( 4) =       0.000442836868
  error estimate for blocks of size 2^( 5) =       0.000453168958
  error estimate for blocks of size 2^( 6) =       0.000461755515
  error estimate for blocks of size 2^( 7) =       0.000466813060

      target function =                  N/A
              le_mean =     -16.910688073090
             les_mean =     286.301581843367
             stat err =       0.000456143600
             autocorr =       1.260206626136
              std dev =       0.574639802952
             le_variance =       0.330210903137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274338498
                                         uncertainty =       0.003342434048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274338498
                                         uncertainty =       0.003342434048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406331355
  error estimate for blocks of size 2^( 2) =       0.000418493220
  error estimate for blocks of size 2^( 3) =       0.000430963936
  error estimate for blocks of size 2^( 4) =       0.000442836549
  error estimate for blocks of size 2^( 5) =       0.000453168646
  error estimate for blocks of size 2^( 6) =       0.000461755225
  error estimate for blocks of size 2^( 7) =       0.000466812778

      target function =                  N/A
              le_mean =     -16.910688073316
             les_mean =     286.301581288439
             stat err =       0.000456143300
             autocorr =       1.260207111738
              std dev =       0.574639313455
             le_variance =       0.330210340568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274619548
                                         uncertainty =       0.003342435204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274619548
                                         uncertainty =       0.003342435204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406331528
  error estimate for blocks of size 2^( 2) =       0.000418493386
  error estimate for blocks of size 2^( 3) =       0.000430964095
  error estimate for blocks of size 2^( 4) =       0.000442836708
  error estimate for blocks of size 2^( 5) =       0.000453168802
  error estimate for blocks of size 2^( 6) =       0.000461755369
  error estimate for blocks of size 2^( 7) =       0.000466812919

      target function =                  N/A
              le_mean =     -16.910688073203
             les_mean =     286.301581565496
             stat err =       0.000456143450
             autocorr =       1.260206869313
              std dev =       0.574639557823
             le_variance =       0.330210621415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274866219
                                         uncertainty =       0.003342436218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330274866219
                                         uncertainty =       0.003342436218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406331680
  error estimate for blocks of size 2^( 2) =       0.000418493532
  error estimate for blocks of size 2^( 3) =       0.000430964235
  error estimate for blocks of size 2^( 4) =       0.000442836848
  error estimate for blocks of size 2^( 5) =       0.000453168939
  error estimate for blocks of size 2^( 6) =       0.000461755496
  error estimate for blocks of size 2^( 7) =       0.000466813043

      target function =                  N/A
              le_mean =     -16.910688073104
             les_mean =     286.301581808618
             stat err =       0.000456143581
             autocorr =       1.260206656542
              std dev =       0.574639772299
             le_variance =       0.330210867908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910688073090        initial
     2.4414e+02     2.4414e+03             7.5576e-07       -16.910688073316  <--
     9.7656e+02     9.7656e+03             1.8906e-07       -16.910688073203
     3.9062e+03     3.9062e+04             4.7273e-08       -16.910688073104

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 6.6727e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469429e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388632e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1988e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.177399
====================================================
  Execution time = 4.1806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0777e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327170058851
                                         uncertainty =       0.003400017395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327170058851
                                         uncertainty =       0.003400017395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404401386
  error estimate for blocks of size 2^( 2) =       0.000416068693
  error estimate for blocks of size 2^( 3) =       0.000427808642
  error estimate for blocks of size 2^( 4) =       0.000439378780
  error estimate for blocks of size 2^( 5) =       0.000449365829
  error estimate for blocks of size 2^( 6) =       0.000456358423
  error estimate for blocks of size 2^( 7) =       0.000459563075

      target function =                  N/A
              le_mean =     -16.911357332263
             les_mean =     286.321087618024
             stat err =       0.000451166527
             autocorr =       1.244653518340
              std dev =       0.571909924807
             le_variance =       0.327080962093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691135733226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911357332263       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911357336257       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911357344901       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911357335993       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911357328958       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911357328063       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911357327476       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.221641e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911357332263       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911357333263       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911357335433       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911357333203       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911357331437       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911357331204       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911357331050       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.060499e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911357332263       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911357332513       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911357333056       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911357332498       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911357332056       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911357331998       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911357331958       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.015526e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2594e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078372e-01 1 1  ON 0
 uu_1                 1.425433e-01 1 1  ON 1
 uu_2                 4.452401e-02 1 1  ON 2
 uu_3                -1.911860e-02 1 1  ON 3
 uu_4                -6.924817e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320262e-01 1 1  ON 6
 uu_7                -1.448973e-01 1 1  ON 7
 uu_8                -1.359660e-01 1 1  ON 8
 uu_9                -1.082882e-01 1 1  ON 9
 ud_0                 4.398866e-01 1 1  ON 10
 ud_1                 1.814299e-01 1 1  ON 11
 ud_2                 6.642201e-02 1 1  ON 12
 ud_3                -3.252973e-03 1 1  ON 13
 ud_4                -5.895820e-02 1 1  ON 14
 ud_5                -1.021398e-01 1 1  ON 15
 ud_6                -1.321059e-01 1 1  ON 16
 ud_7                -1.527804e-01 1 1  ON 17
 ud_8                -1.564069e-01 1 1  ON 18
 ud_9                -1.474588e-01 1 1  ON 19
 eO_0                -7.598023e-01 1 1  ON 20
 eO_1                -4.427196e-01 1 1  ON 21
 eO_2                -2.444873e-02 1 1  ON 22
 eO_3                 3.026645e-01 1 1  ON 23
 eO_4                 5.324542e-01 1 1  ON 24
 eO_5                 4.961125e-01 1 1  ON 25
 eO_6                 2.679596e-01 1 1  ON 26
 eO_7                -3.956917e-02 1 1  ON 27
 eO_8                -2.338422e-01 1 1  ON 28
 eO_9                -9.647705e-02 1 1  ON 29
eH1_0                -2.595756e-01 1 1  ON 30
eH1_1                -1.546546e-01 1 1  ON 31
eH1_2                -1.088144e-01 1 1  ON 32
eH1_3                -5.661570e-02 1 1  ON 33
eH1_4                -4.861331e-03 1 1  ON 34
eH1_5                 3.172050e-02 1 1  ON 35
eH1_6                 9.672027e-02 1 1  ON 36
eH1_7                 1.599820e-01 1 1  ON 37
eH1_8                 1.967109e-01 1 1  ON 38
eH1_9                 9.469481e-02 1 1  ON 39
eH2_0                -2.531266e-01 1 1  ON 40
eH2_1                -1.480855e-01 1 1  ON 41
eH2_2                -1.023247e-01 1 1  ON 42
eH2_3                -5.002905e-02 1 1  ON 43
eH2_4                 1.388962e-03 1 1  ON 44
eH2_5                 3.639488e-02 1 1  ON 45
eH2_6                 1.002468e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962445e-01 1 1  ON 48
eH2_9                 7.481413e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.180931
====================================================
  Execution time = 4.0795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3910e-01
  Total weights = 2.0000e+06
  Execution time = 4.6628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339113092045
                                         uncertainty =       0.005285631515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339113092045
                                         uncertainty =       0.005285631515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411766274
  error estimate for blocks of size 2^( 2) =       0.000423368817
  error estimate for blocks of size 2^( 3) =       0.000434695910
  error estimate for blocks of size 2^( 4) =       0.000446445536
  error estimate for blocks of size 2^( 5) =       0.000455109399
  error estimate for blocks of size 2^( 6) =       0.000463897654
  error estimate for blocks of size 2^( 7) =       0.000468445413

      target function =                  N/A
              le_mean =     -16.911019117352
             les_mean =     286.321670346388
             stat err =       0.000458474501
             autocorr =       1.239734900621
              std dev =       0.582325448937
             le_variance =       0.339102928480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339112023682
                                         uncertainty =       0.005285625126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339112023682
                                         uncertainty =       0.005285625126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411765626
  error estimate for blocks of size 2^( 2) =       0.000423368201
  error estimate for blocks of size 2^( 3) =       0.000434695336
  error estimate for blocks of size 2^( 4) =       0.000446444980
  error estimate for blocks of size 2^( 5) =       0.000455108850
  error estimate for blocks of size 2^( 6) =       0.000463897201
  error estimate for blocks of size 2^( 7) =       0.000468445005

      target function =                  N/A
              le_mean =     -16.911019110208
             les_mean =     286.321669037772
             stat err =       0.000458474009
             autocorr =       1.239736143027
              std dev =       0.582324532800
             le_variance =       0.339101861501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339112556492
                                         uncertainty =       0.005285628295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339112556492
                                         uncertainty =       0.005285628295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411765949
  error estimate for blocks of size 2^( 2) =       0.000423368508
  error estimate for blocks of size 2^( 3) =       0.000434695622
  error estimate for blocks of size 2^( 4) =       0.000446445257
  error estimate for blocks of size 2^( 5) =       0.000455109124
  error estimate for blocks of size 2^( 6) =       0.000463897427
  error estimate for blocks of size 2^( 7) =       0.000468445209

      target function =                  N/A
              le_mean =     -16.911019113750
             les_mean =     286.321669689694
             stat err =       0.000458474254
             autocorr =       1.239735523798
              std dev =       0.582324989694
             le_variance =       0.339102393622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339113025051
                                         uncertainty =       0.005285631112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339113025051
                                         uncertainty =       0.005285631112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411766233
  error estimate for blocks of size 2^( 2) =       0.000423368779
  error estimate for blocks of size 2^( 3) =       0.000434695874
  error estimate for blocks of size 2^( 4) =       0.000446445501
  error estimate for blocks of size 2^( 5) =       0.000455109364
  error estimate for blocks of size 2^( 6) =       0.000463897626
  error estimate for blocks of size 2^( 7) =       0.000468445388

      target function =                  N/A
              le_mean =     -16.911019116901
             les_mean =     286.321670264199
             stat err =       0.000458474470
             autocorr =       1.239734978577
              std dev =       0.582325391489
             le_variance =       0.339102861573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911019117352        initial  <--
     6.1035e+01     6.1035e+02             3.2216e-06       -16.911019110208
     2.4414e+02     2.4414e+03             8.0605e-07       -16.911019113750
     9.7656e+02     9.7656e+03             2.0155e-07       -16.911019116901

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1106
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469429e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388632e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9162
    reference variance = 0.614047
====================================================
  Execution time = 4.1080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0898e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340644158760
                                         uncertainty =       0.010272433390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340644158760
                                         uncertainty =       0.010272433390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412639769
  error estimate for blocks of size 2^( 2) =       0.000423722081
  error estimate for blocks of size 2^( 3) =       0.000435490602
  error estimate for blocks of size 2^( 4) =       0.000446747050
  error estimate for blocks of size 2^( 5) =       0.000456776822
  error estimate for blocks of size 2^( 6) =       0.000464328828
  error estimate for blocks of size 2^( 7) =       0.000467731013

      target function =                  N/A
              le_mean =     -16.911524240187
             les_mean =     286.340195113339
             stat err =       0.000458895928
             autocorr =       1.236762323552
              std dev =       0.583560757049
             le_variance =       0.340543157167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691152424019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911524240187       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911524239882       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911524240406       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911524240531       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911524238062       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911524238456       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911524238622       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911524238671       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.513036e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911524240187       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911524240111       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911524240242       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911524240272       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911524239656       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911524239756       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911524239795       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911524239802       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.129146e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911524240187       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911524240168       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911524240201       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911524240207       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911524240059       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911524240070       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911524240090       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911524240091       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.823419e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1989e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452417e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924835e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082879e-01 1 1  ON 9
 ud_0                 4.398869e-01 1 1  ON 10
 ud_1                 1.814296e-01 1 1  ON 11
 ud_2                 6.642208e-02 1 1  ON 12
 ud_3                -3.253531e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021403e-01 1 1  ON 15
 ud_6                -1.321057e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956927e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647666e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088142e-01 1 1  ON 32
eH1_3                -5.661537e-02 1 1  ON 33
eH1_4                -4.861412e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672001e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469436e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480855e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002869e-02 1 1  ON 43
eH2_4                 1.388649e-03 1 1  ON 44
eH2_5                 3.639510e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8833
    reference variance = 0.184311
====================================================
  Execution time = 4.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3115e-01
  Total weights = 2.0000e+06
  Execution time = 4.6298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073253884
                                         uncertainty =       0.003505753558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073253884
                                         uncertainty =       0.003505753558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406911971
  error estimate for blocks of size 2^( 2) =       0.000418336865
  error estimate for blocks of size 2^( 3) =       0.000430566764
  error estimate for blocks of size 2^( 4) =       0.000441657375
  error estimate for blocks of size 2^( 5) =       0.000452572173
  error estimate for blocks of size 2^( 6) =       0.000457843931
  error estimate for blocks of size 2^( 7) =       0.000461010175

      target function =                  N/A
              le_mean =     -16.910874753185
             les_mean =     286.308839457357
             stat err =       0.000453270913
             autocorr =       1.240837094137
              std dev =       0.575460428731
             le_variance =       0.331154705035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331072786917
                                         uncertainty =       0.003505750431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331072786917
                                         uncertainty =       0.003505750431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406911685
  error estimate for blocks of size 2^( 2) =       0.000418336589
  error estimate for blocks of size 2^( 3) =       0.000430566496
  error estimate for blocks of size 2^( 4) =       0.000441657107
  error estimate for blocks of size 2^( 5) =       0.000452571907
  error estimate for blocks of size 2^( 6) =       0.000457843673
  error estimate for blocks of size 2^( 7) =       0.000461009906

      target function =                  N/A
              le_mean =     -16.910874751509
             les_mean =     286.308838933694
             stat err =       0.000453270648
             autocorr =       1.240837390099
              std dev =       0.575460022991
             le_variance =       0.331154238060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073020253
                                         uncertainty =       0.003505751993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073020253
                                         uncertainty =       0.003505751993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406911828
  error estimate for blocks of size 2^( 2) =       0.000418336727
  error estimate for blocks of size 2^( 3) =       0.000430566630
  error estimate for blocks of size 2^( 4) =       0.000441657241
  error estimate for blocks of size 2^( 5) =       0.000452572040
  error estimate for blocks of size 2^( 6) =       0.000457843802
  error estimate for blocks of size 2^( 7) =       0.000461010040

      target function =                  N/A
              le_mean =     -16.910874752346
             les_mean =     286.308839195359
             stat err =       0.000453270781
             autocorr =       1.240837242218
              std dev =       0.575460225733
             le_variance =       0.331154471401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073224675
                                         uncertainty =       0.003505753362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073224675
                                         uncertainty =       0.003505753362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406911954
  error estimate for blocks of size 2^( 2) =       0.000418336848
  error estimate for blocks of size 2^( 3) =       0.000430566747
  error estimate for blocks of size 2^( 4) =       0.000441657358
  error estimate for blocks of size 2^( 5) =       0.000452572156
  error estimate for blocks of size 2^( 6) =       0.000457843915
  error estimate for blocks of size 2^( 7) =       0.000461010158

      target function =                  N/A
              le_mean =     -16.910874753080
             les_mean =     286.308839424602
             stat err =       0.000453270897
             autocorr =       1.240837112656
              std dev =       0.575460403352
             le_variance =       0.331154675826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910874753185        initial  <--
     6.1035e+02     6.1035e+03             4.5130e-07       -16.910874751509
     2.4414e+03     2.4414e+04             1.1291e-07       -16.910874752346
     9.7656e+03     9.7656e+04             2.8234e-08       -16.910874753080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3134
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469429e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388632e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1531e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9704
    reference variance = 0.229379
====================================================
  Execution time = 4.3739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4951e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0740e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349657582761
                                         uncertainty =       0.014932168966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349657582761
                                         uncertainty =       0.014932168966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418034507
  error estimate for blocks of size 2^( 2) =       0.000428809414
  error estimate for blocks of size 2^( 3) =       0.000440542567
  error estimate for blocks of size 2^( 4) =       0.000451980796
  error estimate for blocks of size 2^( 5) =       0.000461241595
  error estimate for blocks of size 2^( 6) =       0.000469000452
  error estimate for blocks of size 2^( 7) =       0.000475559973

      target function =                  N/A
              le_mean =     -16.910871069229
             les_mean =     286.327065843558
             stat err =       0.000464445704
             autocorr =       1.234370787666
              std dev =       0.591190069457
             le_variance =       0.349505698224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691087106923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910871069229       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910871069398       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910871069343       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910871069340       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910871069290       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910871069335       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910871069336       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910871069352       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.196292e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910871069229       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910871069271       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910871069258       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910871069251       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910871069245       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910871069265       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910871069257       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910871069252       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 7.990912e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910871069229       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910871069240       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910871069236       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910871069222       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910871069233       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910871069208       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910871069241       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910871069215       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 1.997739e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4491e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911853e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448973e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088142e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861417e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388628e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8317
    reference variance = 0.32124
====================================================
  Execution time = 4.0230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3538e-01
  Total weights = 2.0000e+06
  Execution time = 4.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420254448
                                         uncertainty =       0.004919588392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420254448
                                         uncertainty =       0.004919588392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409497810
  error estimate for blocks of size 2^( 2) =       0.000420948592
  error estimate for blocks of size 2^( 3) =       0.000433696547
  error estimate for blocks of size 2^( 4) =       0.000444655050
  error estimate for blocks of size 2^( 5) =       0.000455950674
  error estimate for blocks of size 2^( 6) =       0.000464471586
  error estimate for blocks of size 2^( 7) =       0.000469620472

      target function =                  N/A
              le_mean =     -16.910811055260
             les_mean =     286.310907292053
             stat err =       0.000458674446
             autocorr =       1.254601845637
              std dev =       0.579117356890
             le_variance =       0.335376913051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420270818
                                         uncertainty =       0.004919588509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420270818
                                         uncertainty =       0.004919588509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409497820
  error estimate for blocks of size 2^( 2) =       0.000420948602
  error estimate for blocks of size 2^( 3) =       0.000433696555
  error estimate for blocks of size 2^( 4) =       0.000444655059
  error estimate for blocks of size 2^( 5) =       0.000455950682
  error estimate for blocks of size 2^( 6) =       0.000464471593
  error estimate for blocks of size 2^( 7) =       0.000469620479

      target function =                  N/A
              le_mean =     -16.910811055041
             les_mean =     286.310907301023
             stat err =       0.000458674453
             autocorr =       1.254601825421
              std dev =       0.579117371014
             le_variance =       0.335376929411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420262633
                                         uncertainty =       0.004919588451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420262633
                                         uncertainty =       0.004919588451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409497815
  error estimate for blocks of size 2^( 2) =       0.000420948597
  error estimate for blocks of size 2^( 3) =       0.000433696551
  error estimate for blocks of size 2^( 4) =       0.000444655055
  error estimate for blocks of size 2^( 5) =       0.000455950678
  error estimate for blocks of size 2^( 6) =       0.000464471589
  error estimate for blocks of size 2^( 7) =       0.000469620476

      target function =                  N/A
              le_mean =     -16.910811055150
             les_mean =     286.310907296538
             stat err =       0.000458674449
             autocorr =       1.254601835530
              std dev =       0.579117363952
             le_variance =       0.335376921231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420255471
                                         uncertainty =       0.004919588400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335420255471
                                         uncertainty =       0.004919588400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409497811
  error estimate for blocks of size 2^( 2) =       0.000420948593
  error estimate for blocks of size 2^( 3) =       0.000433696547
  error estimate for blocks of size 2^( 4) =       0.000444655051
  error estimate for blocks of size 2^( 5) =       0.000455950674
  error estimate for blocks of size 2^( 6) =       0.000464471586
  error estimate for blocks of size 2^( 7) =       0.000469620473

      target function =                  N/A
              le_mean =     -16.910811055246
             les_mean =     286.310907292613
             stat err =       0.000458674446
             autocorr =       1.254601844378
              std dev =       0.579117357772
             le_variance =       0.335376914073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910811055260        initial  <--
     6.1035e+03     6.1035e+04             3.1963e-08       -16.910811055041
     2.4414e+04     2.4414e+05             7.9909e-09       -16.910811055150
     9.7656e+04     9.7656e+05             1.9977e-09       -16.910811055246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4795
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469429e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388632e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1798e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.224325
====================================================
  Execution time = 4.1265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2868e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0767e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328731691878
                                         uncertainty =       0.004326925383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328731691878
                                         uncertainty =       0.004326925383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405386736
  error estimate for blocks of size 2^( 2) =       0.000417352735
  error estimate for blocks of size 2^( 3) =       0.000429602598
  error estimate for blocks of size 2^( 4) =       0.000442062079
  error estimate for blocks of size 2^( 5) =       0.000451431619
  error estimate for blocks of size 2^( 6) =       0.000459228760
  error estimate for blocks of size 2^( 7) =       0.000464230539

      target function =                  N/A
              le_mean =     -16.910294499525
             les_mean =     286.286736707226
             stat err =       0.000454238249
             autocorr =       1.255533583773
              std dev =       0.573303419575
             le_variance =       0.328676810896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691029449953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910294499525       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910294499523       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910294499517       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910294499512       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910294499523       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910294499527       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910294499508       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910294499527       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.142526e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910294499525       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910294499525       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910294499523       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910294499524       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910294499575       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910294499572       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910294499563       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910294499589       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 7.856319e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910294499525       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910294499525       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910294499525       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910294499440       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910294499208       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910294499820       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910294498470       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910294498878       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.964079e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2043e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253592e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469429e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388631e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9835
    reference variance = 0.281395
====================================================
  Execution time = 4.0297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4775e-01
  Total weights = 2.0000e+06
  Execution time = 4.6290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737312076
                                         uncertainty =       0.018868213567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737312076
                                         uncertainty =       0.018868213567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416985767
  error estimate for blocks of size 2^( 2) =       0.000428164025
  error estimate for blocks of size 2^( 3) =       0.000439955434
  error estimate for blocks of size 2^( 4) =       0.000451211406
  error estimate for blocks of size 2^( 5) =       0.000461050639
  error estimate for blocks of size 2^( 6) =       0.000467760052
  error estimate for blocks of size 2^( 7) =       0.000474596818

      target function =                  N/A
              le_mean =     -16.911411721390
             les_mean =     286.343600496112
             stat err =       0.000463654729
             autocorr =       1.236365631805
              std dev =       0.589706926904
             le_variance =       0.347754259639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737311752
                                         uncertainty =       0.018868213666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737311752
                                         uncertainty =       0.018868213666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416985767
  error estimate for blocks of size 2^( 2) =       0.000428164025
  error estimate for blocks of size 2^( 3) =       0.000439955434
  error estimate for blocks of size 2^( 4) =       0.000451211405
  error estimate for blocks of size 2^( 5) =       0.000461050638
  error estimate for blocks of size 2^( 6) =       0.000467760052
  error estimate for blocks of size 2^( 7) =       0.000474596818

      target function =                  N/A
              le_mean =     -16.911411721390
             les_mean =     286.343600495806
             stat err =       0.000463654728
             autocorr =       1.236365631687
              std dev =       0.589706926629
             le_variance =       0.347754259314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737311914
                                         uncertainty =       0.018868213617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737311914
                                         uncertainty =       0.018868213617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416985767
  error estimate for blocks of size 2^( 2) =       0.000428164025
  error estimate for blocks of size 2^( 3) =       0.000439955434
  error estimate for blocks of size 2^( 4) =       0.000451211405
  error estimate for blocks of size 2^( 5) =       0.000461050638
  error estimate for blocks of size 2^( 6) =       0.000467760052
  error estimate for blocks of size 2^( 7) =       0.000474596818

      target function =                  N/A
              le_mean =     -16.911411721390
             les_mean =     286.343600495959
             stat err =       0.000463654729
             autocorr =       1.236365631744
              std dev =       0.589706926767
             le_variance =       0.347754259477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737312056
                                         uncertainty =       0.018868213574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737312056
                                         uncertainty =       0.018868213574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416985767
  error estimate for blocks of size 2^( 2) =       0.000428164025
  error estimate for blocks of size 2^( 3) =       0.000439955434
  error estimate for blocks of size 2^( 4) =       0.000451211406
  error estimate for blocks of size 2^( 5) =       0.000461050639
  error estimate for blocks of size 2^( 6) =       0.000467760052
  error estimate for blocks of size 2^( 7) =       0.000474596818

      target function =                  N/A
              le_mean =     -16.911411721390
             les_mean =     286.343600496093
             stat err =       0.000463654729
             autocorr =       1.236365631805
              std dev =       0.589706926887
             le_variance =       0.347754259619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911411721390        initial
     6.1035e+04     6.1035e+05             3.1425e-09       -16.911411721390  <--
     2.4414e+05     2.4414e+06             7.8563e-10       -16.911411721390
     9.7656e+05     9.7656e+06             1.9641e-10       -16.911411721390

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 6.3537e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1559e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.394403
====================================================
  Execution time = 4.1475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3020e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0974e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330228908139
                                         uncertainty =       0.003906270375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330228908139
                                         uncertainty =       0.003906270375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406322337
  error estimate for blocks of size 2^( 2) =       0.000417921301
  error estimate for blocks of size 2^( 3) =       0.000430612954
  error estimate for blocks of size 2^( 4) =       0.000441724683
  error estimate for blocks of size 2^( 5) =       0.000451252732
  error estimate for blocks of size 2^( 6) =       0.000458340019
  error estimate for blocks of size 2^( 7) =       0.000464500275

      target function =                  N/A
              le_mean =     -16.910830256309
             les_mean =     286.306375475210
             stat err =       0.000453954428
             autocorr =       1.248196951643
              std dev =       0.574626559274
             le_variance =       0.330195682623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691083025631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910830256309       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910830256336       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910830256279       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910830256297       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910830256311       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910830256288       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910830256315       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910830256306       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.540136e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910830256309       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910830256315       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910830256301       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910830256308       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910830256298       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910830256306       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910830256259       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910830256345       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.850343e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910830256309       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910830256310       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910830256307       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910830256308       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910830256309       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910830256363       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910830256186       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910830256182       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.625858e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2462e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861411e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002864e-02 1 1  ON 43
eH2_4                 1.388629e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.0338
    reference variance = 0.638219
====================================================
  Execution time = 4.3018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2980e-01
  Total weights = 2.0000e+06
  Execution time = 4.6153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787416562
                                         uncertainty =       0.006394687549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787416562
                                         uncertainty =       0.006394687549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406081525
  error estimate for blocks of size 2^( 2) =       0.000417904358
  error estimate for blocks of size 2^( 3) =       0.000430487839
  error estimate for blocks of size 2^( 4) =       0.000443203468
  error estimate for blocks of size 2^( 5) =       0.000454393457
  error estimate for blocks of size 2^( 6) =       0.000461522465
  error estimate for blocks of size 2^( 7) =       0.000466478650

      target function =                  N/A
              le_mean =     -16.910240017914
             les_mean =     286.286021707726
             stat err =       0.000456399510
             autocorr =       1.263176035371
              std dev =       0.574285999461
             le_variance =       0.329804409177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787413056
                                         uncertainty =       0.006394687277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787413056
                                         uncertainty =       0.006394687277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406081522
  error estimate for blocks of size 2^( 2) =       0.000417904356
  error estimate for blocks of size 2^( 3) =       0.000430487837
  error estimate for blocks of size 2^( 4) =       0.000443203466
  error estimate for blocks of size 2^( 5) =       0.000454393455
  error estimate for blocks of size 2^( 6) =       0.000461522464
  error estimate for blocks of size 2^( 7) =       0.000466478648

      target function =                  N/A
              le_mean =     -16.910240017794
             les_mean =     286.286021700176
             stat err =       0.000456399508
             autocorr =       1.263176037570
              std dev =       0.574285996415
             le_variance =       0.329804405678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787414809
                                         uncertainty =       0.006394687413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787414809
                                         uncertainty =       0.006394687413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406081523
  error estimate for blocks of size 2^( 2) =       0.000417904357
  error estimate for blocks of size 2^( 3) =       0.000430487838
  error estimate for blocks of size 2^( 4) =       0.000443203467
  error estimate for blocks of size 2^( 5) =       0.000454393456
  error estimate for blocks of size 2^( 6) =       0.000461522465
  error estimate for blocks of size 2^( 7) =       0.000466478649

      target function =                  N/A
              le_mean =     -16.910240017854
             les_mean =     286.286021703950
             stat err =       0.000456399509
             autocorr =       1.263176036468
              std dev =       0.574285997938
             le_variance =       0.329804407428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787416343
                                         uncertainty =       0.006394687532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329787416343
                                         uncertainty =       0.006394687532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406081524
  error estimate for blocks of size 2^( 2) =       0.000417904358
  error estimate for blocks of size 2^( 3) =       0.000430487839
  error estimate for blocks of size 2^( 4) =       0.000443203468
  error estimate for blocks of size 2^( 5) =       0.000454393457
  error estimate for blocks of size 2^( 6) =       0.000461522465
  error estimate for blocks of size 2^( 7) =       0.000466478650

      target function =                  N/A
              le_mean =     -16.910240017906
             les_mean =     286.286021707254
             stat err =       0.000456399510
             autocorr =       1.263176035504
              std dev =       0.574285999271
             le_variance =       0.329804408958


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910240017914        initial  <--
     1.5259e+04     1.5259e+05             1.5401e-08       -16.910240017794
     6.1035e+04     6.1035e+05             3.8503e-09       -16.910240017854
     2.4414e+05     2.4414e+06             9.6259e-10       -16.910240017906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.3107
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1878e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.178481
====================================================
  Execution time = 4.0933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0737e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330973191336
                                         uncertainty =       0.004013426238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330973191336
                                         uncertainty =       0.004013426238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812782
  error estimate for blocks of size 2^( 2) =       0.000418848604
  error estimate for blocks of size 2^( 3) =       0.000431730378
  error estimate for blocks of size 2^( 4) =       0.000443389416
  error estimate for blocks of size 2^( 5) =       0.000454039140
  error estimate for blocks of size 2^( 6) =       0.000462860056
  error estimate for blocks of size 2^( 7) =       0.000470045256

      target function =                  N/A
              le_mean =     -16.910682582810
             les_mean =     286.302178529841
             stat err =       0.000457583467
             autocorr =       1.265177527245
              std dev =       0.575320153294
             le_variance =       0.330993278786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691068258281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910682582810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910682582812       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910682582816       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910682582817       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910682582840       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910682582868       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910682582794       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910682582746       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.440426e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910682582810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910682582810       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910682582812       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910682582812       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910682582813       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910682583125       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910682582867       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910682582450       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.601067e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910682582810       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910682582810       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910682582810       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910682582810       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910682582103       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910682586679       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910682583797       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910682582745       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.002715e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1681e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861410e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9528
    reference variance = 0.249895
====================================================
  Execution time = 4.0054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3356e-01
  Total weights = 2.0000e+06
  Execution time = 4.6220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237331
                                         uncertainty =       0.004753599825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237331
                                         uncertainty =       0.004753599825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384836
  error estimate for blocks of size 2^( 2) =       0.000420203558
  error estimate for blocks of size 2^( 3) =       0.000432245165
  error estimate for blocks of size 2^( 4) =       0.000443828047
  error estimate for blocks of size 2^( 5) =       0.000454463317
  error estimate for blocks of size 2^( 6) =       0.000462188446
  error estimate for blocks of size 2^( 7) =       0.000468984762

      target function =                  N/A
              le_mean =     -16.910327616644
             les_mean =     286.292736284447
             stat err =       0.000457366143
             autocorr =       1.254263571194
              std dev =       0.577543374134
             le_variance =       0.333556349006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237127
                                         uncertainty =       0.004753599822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237127
                                         uncertainty =       0.004753599822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384836
  error estimate for blocks of size 2^( 2) =       0.000420203558
  error estimate for blocks of size 2^( 3) =       0.000432245165
  error estimate for blocks of size 2^( 4) =       0.000443828047
  error estimate for blocks of size 2^( 5) =       0.000454463317
  error estimate for blocks of size 2^( 6) =       0.000462188446
  error estimate for blocks of size 2^( 7) =       0.000468984761

      target function =                  N/A
              le_mean =     -16.910327616638
             les_mean =     286.292736284057
             stat err =       0.000457366143
             autocorr =       1.254263571115
              std dev =       0.577543373958
             le_variance =       0.333556348802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237229
                                         uncertainty =       0.004753599824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237229
                                         uncertainty =       0.004753599824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384836
  error estimate for blocks of size 2^( 2) =       0.000420203558
  error estimate for blocks of size 2^( 3) =       0.000432245165
  error estimate for blocks of size 2^( 4) =       0.000443828047
  error estimate for blocks of size 2^( 5) =       0.000454463317
  error estimate for blocks of size 2^( 6) =       0.000462188446
  error estimate for blocks of size 2^( 7) =       0.000468984761

      target function =                  N/A
              le_mean =     -16.910327616641
             les_mean =     286.292736284252
             stat err =       0.000457366143
             autocorr =       1.254263571150
              std dev =       0.577543374046
             le_variance =       0.333556348904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237319
                                         uncertainty =       0.004753599825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333635237319
                                         uncertainty =       0.004753599825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384836
  error estimate for blocks of size 2^( 2) =       0.000420203558
  error estimate for blocks of size 2^( 3) =       0.000432245165
  error estimate for blocks of size 2^( 4) =       0.000443828047
  error estimate for blocks of size 2^( 5) =       0.000454463317
  error estimate for blocks of size 2^( 6) =       0.000462188446
  error estimate for blocks of size 2^( 7) =       0.000468984762

      target function =                  N/A
              le_mean =     -16.910327616643
             les_mean =     286.292736284422
             stat err =       0.000457366143
             autocorr =       1.254263571177
              std dev =       0.577543374123
             le_variance =       0.333556348994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910327616644        initial  <--
     1.5259e+05     1.5259e+06             1.4404e-09       -16.910327616638
     6.1035e+05     6.1035e+06             3.6011e-10       -16.910327616641
     2.4414e+06     2.4414e+07             9.0027e-11       -16.910327616643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3903
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1508e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8736
    reference variance = 0.320414
====================================================
  Execution time = 4.1253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3132e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1062e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400354079
                                         uncertainty =       0.003437467589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400354079
                                         uncertainty =       0.003437467589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407010760
  error estimate for blocks of size 2^( 2) =       0.000419101136
  error estimate for blocks of size 2^( 3) =       0.000431260011
  error estimate for blocks of size 2^( 4) =       0.000443547428
  error estimate for blocks of size 2^( 5) =       0.000454556034
  error estimate for blocks of size 2^( 6) =       0.000463967884
  error estimate for blocks of size 2^( 7) =       0.000469260841

      target function =                  N/A
              le_mean =     -16.911321684109
             les_mean =     286.324116455067
             stat err =       0.000457833047
             autocorr =       1.265326179674
              std dev =       0.575600136642
             le_variance =       0.331315517302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132168411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321684109       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321684109       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321684109       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321684106       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321683789       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321683926       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911321684751       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.283662e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321684109       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321684109       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321684109       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321683725       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321684109       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321682507       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911321683764       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.209150e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321684109       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321684109       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321684109       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321684109       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321684109       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321682323       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911321673922       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 8.022881e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2347e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8493
    reference variance = 0.279134
====================================================
  Execution time = 4.0121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3163e-01
  Total weights = 2.0000e+06
  Execution time = 4.6374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870291
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870291
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407203221
  error estimate for blocks of size 2^( 2) =       0.000418707391
  error estimate for blocks of size 2^( 3) =       0.000430070599
  error estimate for blocks of size 2^( 4) =       0.000441284165
  error estimate for blocks of size 2^( 5) =       0.000451227956
  error estimate for blocks of size 2^( 6) =       0.000459561513
  error estimate for blocks of size 2^( 7) =       0.000464810341

      target function =                  N/A
              le_mean =     -16.910620911866
             les_mean =     286.300728385339
             stat err =       0.000454220994
             autocorr =       1.244262456205
              std dev =       0.575872317730
             le_variance =       0.331628926328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870241
                                         uncertainty =       0.004690017600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870241
                                         uncertainty =       0.004690017600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407203221
  error estimate for blocks of size 2^( 2) =       0.000418707391
  error estimate for blocks of size 2^( 3) =       0.000430070599
  error estimate for blocks of size 2^( 4) =       0.000441284165
  error estimate for blocks of size 2^( 5) =       0.000451227956
  error estimate for blocks of size 2^( 6) =       0.000459561513
  error estimate for blocks of size 2^( 7) =       0.000464810341

      target function =                  N/A
              le_mean =     -16.910620911865
             les_mean =     286.300728385278
             stat err =       0.000454220994
             autocorr =       1.244262456256
              std dev =       0.575872317687
             le_variance =       0.331628926278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870266
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870266
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407203221
  error estimate for blocks of size 2^( 2) =       0.000418707391
  error estimate for blocks of size 2^( 3) =       0.000430070599
  error estimate for blocks of size 2^( 4) =       0.000441284165
  error estimate for blocks of size 2^( 5) =       0.000451227956
  error estimate for blocks of size 2^( 6) =       0.000459561513
  error estimate for blocks of size 2^( 7) =       0.000464810341

      target function =                  N/A
              le_mean =     -16.910620911865
             les_mean =     286.300728385308
             stat err =       0.000454220994
             autocorr =       1.244262456226
              std dev =       0.575872317708
             le_variance =       0.331628926303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870288
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331691870288
                                         uncertainty =       0.004690017599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407203221
  error estimate for blocks of size 2^( 2) =       0.000418707391
  error estimate for blocks of size 2^( 3) =       0.000430070599
  error estimate for blocks of size 2^( 4) =       0.000441284165
  error estimate for blocks of size 2^( 5) =       0.000451227956
  error estimate for blocks of size 2^( 6) =       0.000459561513
  error estimate for blocks of size 2^( 7) =       0.000464810341

      target function =                  N/A
              le_mean =     -16.910620911866
             les_mean =     286.300728385335
             stat err =       0.000454220994
             autocorr =       1.244262456206
              std dev =       0.575872317727
             le_variance =       0.331628926324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910620911866        initial  <--
     1.5259e+06     1.5259e+07             1.2837e-10       -16.910620911865
     6.1035e+06     6.1035e+07             3.2092e-11       -16.910620911865
     2.4414e+07     2.4414e+08             8.0229e-12       -16.910620911866

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3693
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1572e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.220347
====================================================
  Execution time = 4.3059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4709e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0672e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346982478130
                                         uncertainty =       0.017228273761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346982478130
                                         uncertainty =       0.017228273761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416588753
  error estimate for blocks of size 2^( 2) =       0.000428254542
  error estimate for blocks of size 2^( 3) =       0.000440576786
  error estimate for blocks of size 2^( 4) =       0.000452702538
  error estimate for blocks of size 2^( 5) =       0.000463638280
  error estimate for blocks of size 2^( 6) =       0.000470981345
  error estimate for blocks of size 2^( 7) =       0.000477066361

      target function =                  N/A
              le_mean =     -16.910580507472
             les_mean =     286.314825304570
             stat err =       0.000466097131
             autocorr =       1.251808158058
              std dev =       0.589145464583
             le_variance =       0.347092378439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691058050747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910580507472       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910580507472       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910580507472       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910580507475       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910580514365       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910580506102       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910580506915       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910580498897       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.452575e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910580507472       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910580507472       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910580507472       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910580507472       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910580496132       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910580496632       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910580493613       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910580424096       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.631493e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910580507472       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910580507472       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910580507472       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910580529546       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910580446624       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910580450973       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910580351134       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910580264608       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 9.078898e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3743e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.199187
====================================================
  Execution time = 4.0098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 4.6366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289245
                                         uncertainty =       0.005347580988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289245
                                         uncertainty =       0.005347580988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205727
  error estimate for blocks of size 2^( 2) =       0.000422678704
  error estimate for blocks of size 2^( 3) =       0.000434517797
  error estimate for blocks of size 2^( 4) =       0.000446098185
  error estimate for blocks of size 2^( 5) =       0.000454937171
  error estimate for blocks of size 2^( 6) =       0.000463339066
  error estimate for blocks of size 2^( 7) =       0.000469474526

      target function =                  N/A
              le_mean =     -16.910890144423
             les_mean =     286.316385607612
             stat err =       0.000458462237
             autocorr =       1.243050661067
              std dev =       0.581532716158
             le_variance =       0.338180299963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289241
                                         uncertainty =       0.005347580987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289241
                                         uncertainty =       0.005347580987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205727
  error estimate for blocks of size 2^( 2) =       0.000422678704
  error estimate for blocks of size 2^( 3) =       0.000434517797
  error estimate for blocks of size 2^( 4) =       0.000446098185
  error estimate for blocks of size 2^( 5) =       0.000454937171
  error estimate for blocks of size 2^( 6) =       0.000463339066
  error estimate for blocks of size 2^( 7) =       0.000469474526

      target function =                  N/A
              le_mean =     -16.910890144423
             les_mean =     286.316385607608
             stat err =       0.000458462237
             autocorr =       1.243050661058
              std dev =       0.581532716155
             le_variance =       0.338180299959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289243
                                         uncertainty =       0.005347580987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289243
                                         uncertainty =       0.005347580987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205727
  error estimate for blocks of size 2^( 2) =       0.000422678704
  error estimate for blocks of size 2^( 3) =       0.000434517797
  error estimate for blocks of size 2^( 4) =       0.000446098185
  error estimate for blocks of size 2^( 5) =       0.000454937171
  error estimate for blocks of size 2^( 6) =       0.000463339066
  error estimate for blocks of size 2^( 7) =       0.000469474526

      target function =                  N/A
              le_mean =     -16.910890144423
             les_mean =     286.316385607610
             stat err =       0.000458462237
             autocorr =       1.243050661057
              std dev =       0.581532716157
             le_variance =       0.338180299961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289245
                                         uncertainty =       0.005347580988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149289245
                                         uncertainty =       0.005347580988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205727
  error estimate for blocks of size 2^( 2) =       0.000422678704
  error estimate for blocks of size 2^( 3) =       0.000434517797
  error estimate for blocks of size 2^( 4) =       0.000446098185
  error estimate for blocks of size 2^( 5) =       0.000454937171
  error estimate for blocks of size 2^( 6) =       0.000463339066
  error estimate for blocks of size 2^( 7) =       0.000469474526

      target function =                  N/A
              le_mean =     -16.910890144423
             les_mean =     286.316385607612
             stat err =       0.000458462237
             autocorr =       1.243050661062
              std dev =       0.581532716158
             le_variance =       0.338180299962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910890144423        initial
     1.5259e+07     1.5259e+08             1.4526e-11       -16.910890144423
     6.1035e+07     6.1035e+08             3.6315e-12       -16.910890144423
     2.4414e+08     2.4414e+09             9.0789e-13       -16.910890144423  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+08     and shift_s =   2.4414e+09
*****************************************************************************

  Execution time = 6.3308e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1706e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.24788
====================================================
  Execution time = 4.1369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0827e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335087069291
                                         uncertainty =       0.006094098966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335087069291
                                         uncertainty =       0.006094098966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409396104
  error estimate for blocks of size 2^( 2) =       0.000420652159
  error estimate for blocks of size 2^( 3) =       0.000432673176
  error estimate for blocks of size 2^( 4) =       0.000442847886
  error estimate for blocks of size 2^( 5) =       0.000451069054
  error estimate for blocks of size 2^( 6) =       0.000456056168
  error estimate for blocks of size 2^( 7) =       0.000460238432

      target function =                  N/A
              le_mean =     -16.910440368066
             les_mean =     286.298203613628
             stat err =       0.000452552885
             autocorr =       1.221943894292
              std dev =       0.578973522130
             le_variance =       0.335210339328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044036807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910440368066       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910440368066       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910440368066       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910440374248       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910440365633       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910440387133       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910440404604       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910440435139       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.962615e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910440368066       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910440368066       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910440368066       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910440368066       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910440242797       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910440448107       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910440457750       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910440640840       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 9.906494e-13

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910440368066       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910440368066       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910440368066       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910439959672       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910440648805       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910440360970       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910444324470       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910439712466       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 2.468509e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2207e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.827917
====================================================
  Execution time = 3.9962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3168e-01
  Total weights = 2.0000e+06
  Execution time = 4.6689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407235621
  error estimate for blocks of size 2^( 2) =       0.000419217061
  error estimate for blocks of size 2^( 3) =       0.000431336942
  error estimate for blocks of size 2^( 4) =       0.000443544528
  error estimate for blocks of size 2^( 5) =       0.000454504367
  error estimate for blocks of size 2^( 6) =       0.000463016662
  error estimate for blocks of size 2^( 7) =       0.000466390333

      target function =                  N/A
              le_mean =     -16.910939632171
             les_mean =     286.311560779417
             stat err =       0.000456863972
             autocorr =       1.258584286616
              std dev =       0.575918138549
             le_variance =       0.331681702310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312489
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312489
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407235621
  error estimate for blocks of size 2^( 2) =       0.000419217061
  error estimate for blocks of size 2^( 3) =       0.000431336942
  error estimate for blocks of size 2^( 4) =       0.000443544528
  error estimate for blocks of size 2^( 5) =       0.000454504367
  error estimate for blocks of size 2^( 6) =       0.000463016662
  error estimate for blocks of size 2^( 7) =       0.000466390333

      target function =                  N/A
              le_mean =     -16.910939632171
             les_mean =     286.311560779418
             stat err =       0.000456863972
             autocorr =       1.258584286613
              std dev =       0.575918138550
             le_variance =       0.331681702311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407235621
  error estimate for blocks of size 2^( 2) =       0.000419217061
  error estimate for blocks of size 2^( 3) =       0.000431336942
  error estimate for blocks of size 2^( 4) =       0.000443544528
  error estimate for blocks of size 2^( 5) =       0.000454504367
  error estimate for blocks of size 2^( 6) =       0.000463016662
  error estimate for blocks of size 2^( 7) =       0.000466390333

      target function =                  N/A
              le_mean =     -16.910939632171
             les_mean =     286.311560779418
             stat err =       0.000456863972
             autocorr =       1.258584286618
              std dev =       0.575918138550
             le_variance =       0.331681702310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331622312488
                                         uncertainty =       0.004445925396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407235621
  error estimate for blocks of size 2^( 2) =       0.000419217061
  error estimate for blocks of size 2^( 3) =       0.000431336942
  error estimate for blocks of size 2^( 4) =       0.000443544528
  error estimate for blocks of size 2^( 5) =       0.000454504367
  error estimate for blocks of size 2^( 6) =       0.000463016662
  error estimate for blocks of size 2^( 7) =       0.000466390333

      target function =                  N/A
              le_mean =     -16.910939632171
             les_mean =     286.311560779417
             stat err =       0.000456863972
             autocorr =       1.258584286617
              std dev =       0.575918138550
             le_variance =       0.331681702310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910939632171        initial
     6.1035e+07     6.1035e+08             3.9626e-12       -16.910939632171
     2.4414e+08     2.4414e+09             9.9065e-13       -16.910939632171  <--
     9.7656e+08     9.7656e+09             2.4685e-13       -16.910939632171

*****************************************************************************
Applying the update for shift_i =   2.4414e+08     and shift_s =   2.4414e+09
*****************************************************************************

  Execution time = 6.3188e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1540e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9258
    reference variance = 0.319844
====================================================
  Execution time = 4.1681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3350e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0813e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566111601
                                         uncertainty =       0.003819549580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566111601
                                         uncertainty =       0.003819549580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408352640
  error estimate for blocks of size 2^( 2) =       0.000419736432
  error estimate for blocks of size 2^( 3) =       0.000431400056
  error estimate for blocks of size 2^( 4) =       0.000443090271
  error estimate for blocks of size 2^( 5) =       0.000454358036
  error estimate for blocks of size 2^( 6) =       0.000462255110
  error estimate for blocks of size 2^( 7) =       0.000467625170

      target function =                  N/A
              le_mean =     -16.910274875410
             les_mean =     286.290899952465
             stat err =       0.000456832147
             autocorr =       1.251533786779
              std dev =       0.577497841805
             le_variance =       0.333503757290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691027487541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910274875410       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910274875410       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910274875410       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910274875410       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910274882045       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910274875410       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910274875636       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910274925812       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.424622e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910274875410       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910274875410       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910274875410       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910274875410       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910274831673       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910274807665       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910274873606       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910274886629       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 8.561571e-13

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910274875410       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910274875410       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910274875410       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910275120063       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910274887121       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910274969030       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910274875410       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910275709222       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 2.140582e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2506e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8607
    reference variance = 0.248904
====================================================
  Execution time = 4.0556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2831e-01
  Total weights = 2.0000e+06
  Execution time = 4.6360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405159468
  error estimate for blocks of size 2^( 2) =       0.000417032802
  error estimate for blocks of size 2^( 3) =       0.000429454639
  error estimate for blocks of size 2^( 4) =       0.000441419510
  error estimate for blocks of size 2^( 5) =       0.000452764466
  error estimate for blocks of size 2^( 6) =       0.000460736415
  error estimate for blocks of size 2^( 7) =       0.000466133266

      target function =                  N/A
              le_mean =     -16.911292524280
             les_mean =     286.320123066626
             stat err =       0.000455263415
             autocorr =       1.262622482590
              std dev =       0.572982014553
             le_variance =       0.328308389001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405159468
  error estimate for blocks of size 2^( 2) =       0.000417032802
  error estimate for blocks of size 2^( 3) =       0.000429454639
  error estimate for blocks of size 2^( 4) =       0.000441419510
  error estimate for blocks of size 2^( 5) =       0.000452764466
  error estimate for blocks of size 2^( 6) =       0.000460736415
  error estimate for blocks of size 2^( 7) =       0.000466133266

      target function =                  N/A
              le_mean =     -16.911292524280
             les_mean =     286.320123066626
             stat err =       0.000455263415
             autocorr =       1.262622482592
              std dev =       0.572982014553
             le_variance =       0.328308389001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405159468
  error estimate for blocks of size 2^( 2) =       0.000417032802
  error estimate for blocks of size 2^( 3) =       0.000429454639
  error estimate for blocks of size 2^( 4) =       0.000441419510
  error estimate for blocks of size 2^( 5) =       0.000452764466
  error estimate for blocks of size 2^( 6) =       0.000460736415
  error estimate for blocks of size 2^( 7) =       0.000466133266

      target function =                  N/A
              le_mean =     -16.911292524280
             les_mean =     286.320123066626
             stat err =       0.000455263415
             autocorr =       1.262622482586
              std dev =       0.572982014553
             le_variance =       0.328308389001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284120371
                                         uncertainty =       0.002864445175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405159468
  error estimate for blocks of size 2^( 2) =       0.000417032802
  error estimate for blocks of size 2^( 3) =       0.000429454639
  error estimate for blocks of size 2^( 4) =       0.000441419510
  error estimate for blocks of size 2^( 5) =       0.000452764466
  error estimate for blocks of size 2^( 6) =       0.000460736415
  error estimate for blocks of size 2^( 7) =       0.000466133266

      target function =                  N/A
              le_mean =     -16.911292524280
             les_mean =     286.320123066626
             stat err =       0.000455263415
             autocorr =       1.262622482582
              std dev =       0.572982014553
             le_variance =       0.328308389001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911292524280        initial  <--
     6.1035e+07     6.1035e+08             3.4246e-12       -16.911292524280
     2.4414e+08     2.4414e+09             8.5616e-13       -16.911292524280
     9.7656e+08     9.7656e+09             2.1406e-13       -16.911292524280

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2860
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1680e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9072
    reference variance = 0.213499
====================================================
  Execution time = 4.1580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0835e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325823341935
                                         uncertainty =       0.003155068841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325823341935
                                         uncertainty =       0.003155068841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403610102
  error estimate for blocks of size 2^( 2) =       0.000415007316
  error estimate for blocks of size 2^( 3) =       0.000426901890
  error estimate for blocks of size 2^( 4) =       0.000439451729
  error estimate for blocks of size 2^( 5) =       0.000448717096
  error estimate for blocks of size 2^( 6) =       0.000457810065
  error estimate for blocks of size 2^( 7) =       0.000463140158

      target function =                  N/A
              le_mean =     -16.910747715969
             les_mean =     286.299190379103
             stat err =       0.000452279762
             autocorr =       1.255712606485
              std dev =       0.570790880135
             le_variance =       0.325802228846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691074771597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910747715969       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910747715969       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910747715969       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910748202191       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910747214453       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910747445977       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910747426175       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910747774204       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 3.726647e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910747715969       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910747715969       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910747715969       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910748835960       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910746622766       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910750017684       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910750066302       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910765054529       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910762175806       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910746173043       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 9.455230e-14

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910747715969       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910747715969       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910747715969       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910747715969       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910750767204       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910749758510       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910753461330       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910747683548       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 2.316980e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2427e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.176652
====================================================
  Execution time = 4.0244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.0000e+06
  Execution time = 4.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410375361
  error estimate for blocks of size 2^( 2) =       0.000421974684
  error estimate for blocks of size 2^( 3) =       0.000434106615
  error estimate for blocks of size 2^( 4) =       0.000445540770
  error estimate for blocks of size 2^( 5) =       0.000456499770
  error estimate for blocks of size 2^( 6) =       0.000464156501
  error estimate for blocks of size 2^( 7) =       0.000466149916

      target function =                  N/A
              le_mean =     -16.910180995283
             les_mean =     286.291036998407
             stat err =       0.000458086739
             autocorr =       1.246042583874
              std dev =       0.580358400983
             le_variance =       0.336815873592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491487
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491487
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410375361
  error estimate for blocks of size 2^( 2) =       0.000421974684
  error estimate for blocks of size 2^( 3) =       0.000434106615
  error estimate for blocks of size 2^( 4) =       0.000445540770
  error estimate for blocks of size 2^( 5) =       0.000456499770
  error estimate for blocks of size 2^( 6) =       0.000464156501
  error estimate for blocks of size 2^( 7) =       0.000466149916

      target function =                  N/A
              le_mean =     -16.910180995283
             les_mean =     286.291036998407
             stat err =       0.000458086739
             autocorr =       1.246042583881
              std dev =       0.580358400983
             le_variance =       0.336815873592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410375361
  error estimate for blocks of size 2^( 2) =       0.000421974684
  error estimate for blocks of size 2^( 3) =       0.000434106615
  error estimate for blocks of size 2^( 4) =       0.000445540770
  error estimate for blocks of size 2^( 5) =       0.000456499770
  error estimate for blocks of size 2^( 6) =       0.000464156501
  error estimate for blocks of size 2^( 7) =       0.000466149916

      target function =                  N/A
              le_mean =     -16.910180995283
             les_mean =     286.291036998407
             stat err =       0.000458086739
             autocorr =       1.246042583875
              std dev =       0.580358400983
             le_variance =       0.336815873592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843491486
                                         uncertainty =       0.005111741113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410375361
  error estimate for blocks of size 2^( 2) =       0.000421974684
  error estimate for blocks of size 2^( 3) =       0.000434106615
  error estimate for blocks of size 2^( 4) =       0.000445540770
  error estimate for blocks of size 2^( 5) =       0.000456499770
  error estimate for blocks of size 2^( 6) =       0.000464156501
  error estimate for blocks of size 2^( 7) =       0.000466149916

      target function =                  N/A
              le_mean =     -16.910180995283
             les_mean =     286.291036998407
             stat err =       0.000458086739
             autocorr =       1.246042583877
              std dev =       0.580358400983
             le_variance =       0.336815873592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910180995283        initial  <--
     6.1035e+08     6.1035e+09             3.7266e-13       -16.910180995283
     2.4414e+09     2.4414e+10             9.4552e-14       -16.910180995283
     9.7656e+09     9.7656e+10             2.3170e-14       -16.910180995283

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6871
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1612e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9537
    reference variance = 0.434574
====================================================
  Execution time = 4.1244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0858e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335934779841
                                         uncertainty =       0.005442793239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335934779841
                                         uncertainty =       0.005442793239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409790802
  error estimate for blocks of size 2^( 2) =       0.000420976773
  error estimate for blocks of size 2^( 3) =       0.000433186105
  error estimate for blocks of size 2^( 4) =       0.000444324407
  error estimate for blocks of size 2^( 5) =       0.000454951294
  error estimate for blocks of size 2^( 6) =       0.000462706044
  error estimate for blocks of size 2^( 7) =       0.000468134882

      target function =                  N/A
              le_mean =     -16.910801130959
             les_mean =     286.311051725750
             stat err =       0.000457529157
             autocorr =       1.246559860367
              std dev =       0.579531709936
             le_variance =       0.335857002821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691080113096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801130959       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801130959       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910801130959       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910804574629       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910801130959       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910801157048       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910797556276       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910806454930       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 3.401053e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801130959       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801130959       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910801130959       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910797601424       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910808639873       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910812643443       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910790447632       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910795640726       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 8.523315e-15

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801130959       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801130959       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910801130959       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910759577827       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910798703263       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910746711182       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910762137130       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910677861275       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910949697643       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910458502985       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911467531020       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.912357056856       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909972210987       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909679698329       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905918128706       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.914552889038       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.896835096054       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908959096954       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.914175708860       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911322772993       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907504363560       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.912514244644       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.914568910989       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.912002938190       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.913892679192       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904870706102       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.896783202965       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.924553109666       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905832272320       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.902614732600       residual = 8.91e-03           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.904871659775       residual = 4.68e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.913584706213       residual = 2.03e-03           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.904747049325       residual = 4.87e-03           smallest_sin_value = 9.94e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.46e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 2.033831e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2130e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8516
    reference variance = 1.01416
====================================================
  Execution time = 3.9937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2872e-01
  Total weights = 2.0000e+06
  Execution time = 4.7514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405412483
  error estimate for blocks of size 2^( 2) =       0.000417071741
  error estimate for blocks of size 2^( 3) =       0.000429373707
  error estimate for blocks of size 2^( 4) =       0.000440661909
  error estimate for blocks of size 2^( 5) =       0.000451209642
  error estimate for blocks of size 2^( 6) =       0.000460395582
  error estimate for blocks of size 2^( 7) =       0.000464561505

      target function =                  N/A
              le_mean =     -16.910919129151
             les_mean =     286.307904190357
             stat err =       0.000454207159
             autocorr =       1.255202276654
              std dev =       0.573339831192
             le_variance =       0.328718562031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405412483
  error estimate for blocks of size 2^( 2) =       0.000417071741
  error estimate for blocks of size 2^( 3) =       0.000429373707
  error estimate for blocks of size 2^( 4) =       0.000440661909
  error estimate for blocks of size 2^( 5) =       0.000451209642
  error estimate for blocks of size 2^( 6) =       0.000460395582
  error estimate for blocks of size 2^( 7) =       0.000464561505

      target function =                  N/A
              le_mean =     -16.910919129151
             les_mean =     286.307904190356
             stat err =       0.000454207159
             autocorr =       1.255202276652
              std dev =       0.573339831192
             le_variance =       0.328718562031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405412483
  error estimate for blocks of size 2^( 2) =       0.000417071741
  error estimate for blocks of size 2^( 3) =       0.000429373707
  error estimate for blocks of size 2^( 4) =       0.000440661909
  error estimate for blocks of size 2^( 5) =       0.000451209642
  error estimate for blocks of size 2^( 6) =       0.000460395582
  error estimate for blocks of size 2^( 7) =       0.000464561505

      target function =                  N/A
              le_mean =     -16.910919129151
             les_mean =     286.307904190357
             stat err =       0.000454207159
             autocorr =       1.255202276652
              std dev =       0.573339831192
             le_variance =       0.328718562031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328747242278
                                         uncertainty =       0.006441289846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405412483
  error estimate for blocks of size 2^( 2) =       0.000417071741
  error estimate for blocks of size 2^( 3) =       0.000429373707
  error estimate for blocks of size 2^( 4) =       0.000440661909
  error estimate for blocks of size 2^( 5) =       0.000451209642
  error estimate for blocks of size 2^( 6) =       0.000460395582
  error estimate for blocks of size 2^( 7) =       0.000464561505

      target function =                  N/A
              le_mean =     -16.910919129151
             les_mean =     286.307904190357
             stat err =       0.000454207159
             autocorr =       1.255202276653
              std dev =       0.573339831192
             le_variance =       0.328718562031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910919129151        initial  <--
     6.1035e+09     6.1035e+10             3.4011e-14       -16.910919129151
     2.4414e+10     2.4414e+11             8.5233e-15       -16.910919129151
     9.7656e+10     9.7656e+11             2.0338e-15       -16.910919129151

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3516
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1549e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.403765
====================================================
  Execution time = 4.1502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0778e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329831888766
                                         uncertainty =       0.003350724693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329831888766
                                         uncertainty =       0.003350724693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406116861
  error estimate for blocks of size 2^( 2) =       0.000418121476
  error estimate for blocks of size 2^( 3) =       0.000429882698
  error estimate for blocks of size 2^( 4) =       0.000442106189
  error estimate for blocks of size 2^( 5) =       0.000451130385
  error estimate for blocks of size 2^( 6) =       0.000456910984
  error estimate for blocks of size 2^( 7) =       0.000461897774

      target function =                  N/A
              le_mean =     -16.910890058278
             les_mean =     286.308064208336
             stat err =       0.000453011333
             autocorr =       1.244274187520
              std dev =       0.574335973184
             le_variance =       0.329861810093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691089005828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910890058278       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910890058278       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910890058278       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910890058278       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910873009696       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910890382355       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910905141676       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910894203287       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 3.159899e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910890058278       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910890058278       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910890058278       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910892490345       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910885145630       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910876734754       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910819582381       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911529806287       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911630825490       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912283953559       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911005766396       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916609573394       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909881010407       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.917227210689       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.912525784654       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.919051059733       residual = 8.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910981932151       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.923564247639       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909424291973       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.896140680330       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.923773586147       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908119845857       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906862166268       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.894492818221       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.941952059903       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.882435967521       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.895933538991       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.912966089163       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.942554524033       residual = 1.30e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.895283688351       residual = 3.04e-02           smallest_sin_value = 9.93e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 7.332845e-16

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910890058278       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910890058278       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.36e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5040e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.213031
====================================================
  Execution time = 4.0173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2818e-01
  Total weights = 2.0000e+06
  Execution time = 4.6238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405080147
  error estimate for blocks of size 2^( 2) =       0.000416805907
  error estimate for blocks of size 2^( 3) =       0.000428807947
  error estimate for blocks of size 2^( 4) =       0.000440977474
  error estimate for blocks of size 2^( 5) =       0.000451370045
  error estimate for blocks of size 2^( 6) =       0.000460110955
  error estimate for blocks of size 2^( 7) =       0.000465670645

      target function =                  N/A
              le_mean =     -16.911413115604
             les_mean =     286.324073253910
             stat err =       0.000454532280
             autocorr =       1.259063239117
              std dev =       0.572869838085
             le_variance =       0.328179851387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405080147
  error estimate for blocks of size 2^( 2) =       0.000416805907
  error estimate for blocks of size 2^( 3) =       0.000428807947
  error estimate for blocks of size 2^( 4) =       0.000440977474
  error estimate for blocks of size 2^( 5) =       0.000451370045
  error estimate for blocks of size 2^( 6) =       0.000460110955
  error estimate for blocks of size 2^( 7) =       0.000465670645

      target function =                  N/A
              le_mean =     -16.911413115604
             les_mean =     286.324073253910
             stat err =       0.000454532280
             autocorr =       1.259063239118
              std dev =       0.572869838085
             le_variance =       0.328179851387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405080147
  error estimate for blocks of size 2^( 2) =       0.000416805907
  error estimate for blocks of size 2^( 3) =       0.000428807947
  error estimate for blocks of size 2^( 4) =       0.000440977474
  error estimate for blocks of size 2^( 5) =       0.000451370045
  error estimate for blocks of size 2^( 6) =       0.000460110955
  error estimate for blocks of size 2^( 7) =       0.000465670645

      target function =                  N/A
              le_mean =     -16.911413115604
             les_mean =     286.324073253910
             stat err =       0.000454532280
             autocorr =       1.259063239117
              std dev =       0.572869838085
             le_variance =       0.328179851387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328151250363
                                         uncertainty =       0.003707946367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405080147
  error estimate for blocks of size 2^( 2) =       0.000416805907
  error estimate for blocks of size 2^( 3) =       0.000428807947
  error estimate for blocks of size 2^( 4) =       0.000440977474
  error estimate for blocks of size 2^( 5) =       0.000451370045
  error estimate for blocks of size 2^( 6) =       0.000460110955
  error estimate for blocks of size 2^( 7) =       0.000465670645

      target function =                  N/A
              le_mean =     -16.911413115604
             les_mean =     286.324073253910
             stat err =       0.000454532280
             autocorr =       1.259063239117
              std dev =       0.572869838085
             le_variance =       0.328179851387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911413115604        initial
     6.1035e+10     6.1035e+11             3.1599e-15       -16.911413115604  <--
     2.4414e+11     2.4414e+12             7.3328e-16       -16.911413115604
     9.7656e+11     9.7656e+12             0.0000e+00       -16.911413115604

*****************************************************************************
Applying the update for shift_i =   6.1035e+10     and shift_s =   6.1035e+11
*****************************************************************************

  Execution time = 6.3485e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1853e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8372
    reference variance = 0.190628
====================================================
  Execution time = 4.0960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0667e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334962125385
                                         uncertainty =       0.004113233614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334962125385
                                         uncertainty =       0.004113233614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409147339
  error estimate for blocks of size 2^( 2) =       0.000420440610
  error estimate for blocks of size 2^( 3) =       0.000432526176
  error estimate for blocks of size 2^( 4) =       0.000443194473
  error estimate for blocks of size 2^( 5) =       0.000453962704
  error estimate for blocks of size 2^( 6) =       0.000460371727
  error estimate for blocks of size 2^( 7) =       0.000465310012

      target function =                  N/A
              le_mean =     -16.911184156705
             les_mean =     286.322952504307
             stat err =       0.000455709729
             autocorr =       1.240558188286
              std dev =       0.578621715574
             le_variance =       0.334803089734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691118415670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911184156705       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911184156705       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911184156705       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911173306217       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911183327919       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911175166154       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911183848696       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911169583321       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911174950031       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911168940016       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911185181346       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911244084811       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911256944872       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911196280827       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911181682721       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910946743738       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911533776277       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910818499821       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.911074040493       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911142706618       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910075594658       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.911129199255       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909856783401       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910931361697       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.911877071753       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.912615420738       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911578883267       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.911774267234       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.910340233899       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910494575014       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911763218067       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.911423431861       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.912292853770       residual = 1.34e-04           smallest_sin_value = 9.98e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.914699724108       residual = 1.75e-03           smallest_sin_value = 9.97e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 1.234458e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911184156705       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911184156705       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911184156705       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911184074066       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911193450616       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911200527503       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911196220965       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911185404402       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911185016101       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911118761083       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911317313534       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910878426602       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911106536085       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911138269506       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911078513030       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911157862396       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910890686823       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910683301657       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910473585165       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909860527604       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911342492921       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.916348787097       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909451381393       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908838760362       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.912958304791       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907996558986       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.912083578969       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.914959439322       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908948354235       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.902874444132       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904515008426       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.900073943894       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.910284048449       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.902716605722       residual = 8.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.906512186897       residual = 3.36e-03           smallest_sin_value = 9.96e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 2.763134e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911184156705       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911184156705       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911184156705       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911184310750       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911178886909       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911198455305       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911130475774       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911075917124       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.912399314537       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911226210353       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908635810187       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907337997330       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.901517955126       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903907728536       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.917205523641       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.916733405721       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.926688274567       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.889229217793       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905247153003       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.886299174311       residual = 7.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.924523860413       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.879610951546       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.889548502727       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.898006559503       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893707375456       residual = 4.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.917067448966       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.925447686594       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.928659740493       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.879630337609       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.942693580266       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.927310729403       residual = 4.10e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.924548523016       residual = 2.42e-02           smallest_sin_value = 9.92e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 7.025451e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1685e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8546
    reference variance = 0.126642
====================================================
  Execution time = 4.0241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3556e-01
  Total weights = 2.0000e+06
  Execution time = 4.6342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409608166
  error estimate for blocks of size 2^( 2) =       0.000421650721
  error estimate for blocks of size 2^( 3) =       0.000434197434
  error estimate for blocks of size 2^( 4) =       0.000445587013
  error estimate for blocks of size 2^( 5) =       0.000455802178
  error estimate for blocks of size 2^( 6) =       0.000464245040
  error estimate for blocks of size 2^( 7) =       0.000470202827

      target function =                  N/A
              le_mean =     -16.910861696064
             les_mean =     286.312800834887
             stat err =       0.000458959265
             autocorr =       1.255483673560
              std dev =       0.579273423590
             le_variance =       0.335557699277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409608166
  error estimate for blocks of size 2^( 2) =       0.000421650721
  error estimate for blocks of size 2^( 3) =       0.000434197434
  error estimate for blocks of size 2^( 4) =       0.000445587013
  error estimate for blocks of size 2^( 5) =       0.000455802178
  error estimate for blocks of size 2^( 6) =       0.000464245040
  error estimate for blocks of size 2^( 7) =       0.000470202827

      target function =                  N/A
              le_mean =     -16.910861696064
             les_mean =     286.312800834887
             stat err =       0.000458959265
             autocorr =       1.255483673568
              std dev =       0.579273423590
             le_variance =       0.335557699277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409608166
  error estimate for blocks of size 2^( 2) =       0.000421650721
  error estimate for blocks of size 2^( 3) =       0.000434197434
  error estimate for blocks of size 2^( 4) =       0.000445587013
  error estimate for blocks of size 2^( 5) =       0.000455802178
  error estimate for blocks of size 2^( 6) =       0.000464245040
  error estimate for blocks of size 2^( 7) =       0.000470202827

      target function =                  N/A
              le_mean =     -16.910861696064
             les_mean =     286.312800834887
             stat err =       0.000458959265
             autocorr =       1.255483673560
              std dev =       0.579273423590
             le_variance =       0.335557699277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335564949544
                                         uncertainty =       0.004653936804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409608166
  error estimate for blocks of size 2^( 2) =       0.000421650721
  error estimate for blocks of size 2^( 3) =       0.000434197434
  error estimate for blocks of size 2^( 4) =       0.000445587013
  error estimate for blocks of size 2^( 5) =       0.000455802178
  error estimate for blocks of size 2^( 6) =       0.000464245040
  error estimate for blocks of size 2^( 7) =       0.000470202827

      target function =                  N/A
              le_mean =     -16.910861696064
             les_mean =     286.312800834887
             stat err =       0.000458959265
             autocorr =       1.255483673565
              std dev =       0.579273423590
             le_variance =       0.335557699277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910861696064        initial  <--
     1.5259e+10     1.5259e+11             1.2345e-14       -16.910861696064
     6.1035e+10     6.1035e+11             2.7631e-15       -16.910861696064
     2.4414e+11     2.4414e+12             7.0255e-16       -16.910861696064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5377
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1523e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.354749
====================================================
  Execution time = 4.0876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0622e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072074372
                                         uncertainty =       0.004461079335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330072074372
                                         uncertainty =       0.004461079335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406317521
  error estimate for blocks of size 2^( 2) =       0.000417779382
  error estimate for blocks of size 2^( 3) =       0.000430642947
  error estimate for blocks of size 2^( 4) =       0.000442901986
  error estimate for blocks of size 2^( 5) =       0.000453936068
  error estimate for blocks of size 2^( 6) =       0.000461505532
  error estimate for blocks of size 2^( 7) =       0.000466263807

      target function =                  N/A
              le_mean =     -16.910639038175
             les_mean =     286.299900370021
             stat err =       0.000456151848
             autocorr =       1.260340167635
              std dev =       0.574619748768
             le_variance =       0.330187855674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691063903817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910639038175       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910639038175       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910639038175       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910639038175       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910651683119       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910631030679       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910889527052       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910680494487       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911193098348       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910391764885       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.912074222066       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.913112065162       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910636952832       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905499124947       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904280892054       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907389435544       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906628101802       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.925424367505       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908559372923       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.899094882536       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914444849149       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.895011241595       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905296435527       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.930203650167       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904177185850       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905949227966       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.899184900469       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.885357346954       residual = 8.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.928262536250       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.918693585829       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908848044009       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.936516501733       residual = 9.37e-02           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 1.208709e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910639038175       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910639038175       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910639038175       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910639038175       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910366415203       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910758149576       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913136845430       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911531671539       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910326556708       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.913989374316       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907595866948       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905584214009       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.894238006121       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913374969255       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.921491980501       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905506401890       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.871868595654       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.877178036454       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.953395401436       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.929562723071       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.954657632661       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.854017120754       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.927694194791       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.798060928359       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.866877974062       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.869166149026       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.955639381165       residual = 2.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.820384977002       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.924787824282       residual = 3.24e-02           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.918322477456       residual = 1.89e-02           smallest_sin_value = 9.91e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 2.150267e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910639038175       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910639038175       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1534e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.834
    reference variance = 0.241033
====================================================
  Execution time = 3.9782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.0000e+06
  Execution time = 4.6154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410973942
  error estimate for blocks of size 2^( 2) =       0.000422869765
  error estimate for blocks of size 2^( 3) =       0.000434638293
  error estimate for blocks of size 2^( 4) =       0.000446899227
  error estimate for blocks of size 2^( 5) =       0.000457502273
  error estimate for blocks of size 2^( 6) =       0.000465736186
  error estimate for blocks of size 2^( 7) =       0.000472355923

      target function =                  N/A
              le_mean =     -16.910954110389
             les_mean =     286.318167916049
             stat err =       0.000460623402
             autocorr =       1.256213413046
              std dev =       0.581204921924
             le_variance =       0.337799161269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410973942
  error estimate for blocks of size 2^( 2) =       0.000422869765
  error estimate for blocks of size 2^( 3) =       0.000434638293
  error estimate for blocks of size 2^( 4) =       0.000446899227
  error estimate for blocks of size 2^( 5) =       0.000457502273
  error estimate for blocks of size 2^( 6) =       0.000465736186
  error estimate for blocks of size 2^( 7) =       0.000472355923

      target function =                  N/A
              le_mean =     -16.910954110389
             les_mean =     286.318167916049
             stat err =       0.000460623402
             autocorr =       1.256213413046
              std dev =       0.581204921924
             le_variance =       0.337799161269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410973942
  error estimate for blocks of size 2^( 2) =       0.000422869765
  error estimate for blocks of size 2^( 3) =       0.000434638293
  error estimate for blocks of size 2^( 4) =       0.000446899227
  error estimate for blocks of size 2^( 5) =       0.000457502273
  error estimate for blocks of size 2^( 6) =       0.000465736186
  error estimate for blocks of size 2^( 7) =       0.000472355923

      target function =                  N/A
              le_mean =     -16.910954110389
             les_mean =     286.318167916049
             stat err =       0.000460623402
             autocorr =       1.256213413049
              std dev =       0.581204921924
             le_variance =       0.337799161269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337827343806
                                         uncertainty =       0.005424061605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410973942
  error estimate for blocks of size 2^( 2) =       0.000422869765
  error estimate for blocks of size 2^( 3) =       0.000434638293
  error estimate for blocks of size 2^( 4) =       0.000446899227
  error estimate for blocks of size 2^( 5) =       0.000457502273
  error estimate for blocks of size 2^( 6) =       0.000465736186
  error estimate for blocks of size 2^( 7) =       0.000472355923

      target function =                  N/A
              le_mean =     -16.910954110389
             les_mean =     286.318167916049
             stat err =       0.000460623402
             autocorr =       1.256213413046
              std dev =       0.581204921924
             le_variance =       0.337799161269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910954110389        initial  <--
     1.5259e+11     1.5259e+12             1.2087e-15       -16.910954110389
     6.1035e+11     6.1035e+12             2.1503e-16       -16.910954110389
     2.4414e+12     2.4414e+13             0.0000e+00       -16.910954110389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.9096
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1845e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.7802
    reference variance = 1.18559
====================================================
  Execution time = 4.2715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4583e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0723e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345790381981
                                         uncertainty =       0.006484423434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345790381981
                                         uncertainty =       0.006484423434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415833084
  error estimate for blocks of size 2^( 2) =       0.000427324105
  error estimate for blocks of size 2^( 3) =       0.000439660105
  error estimate for blocks of size 2^( 4) =       0.000450996032
  error estimate for blocks of size 2^( 5) =       0.000461144162
  error estimate for blocks of size 2^( 6) =       0.000469709649
  error estimate for blocks of size 2^( 7) =       0.000474227119

      target function =                  N/A
              le_mean =     -16.910955328965
             les_mean =     286.326244273603
             stat err =       0.000464019240
             autocorr =       1.245185051432
              std dev =       0.588076787733
             le_variance =       0.345834308270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691095532896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910955328965       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3452e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.197789
====================================================
  Execution time = 4.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3130e-01
  Total weights = 2.0000e+06
  Execution time = 4.6429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407002554
  error estimate for blocks of size 2^( 2) =       0.000418429556
  error estimate for blocks of size 2^( 3) =       0.000430708271
  error estimate for blocks of size 2^( 4) =       0.000441762607
  error estimate for blocks of size 2^( 5) =       0.000451247223
  error estimate for blocks of size 2^( 6) =       0.000460864205
  error estimate for blocks of size 2^( 7) =       0.000465573034

      target function =                  N/A
              le_mean =     -16.910521385668
             les_mean =     286.297035527497
             stat err =       0.000454861767
             autocorr =       1.249006215700
              std dev =       0.575588531868
             le_variance =       0.331302158018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407002554
  error estimate for blocks of size 2^( 2) =       0.000418429556
  error estimate for blocks of size 2^( 3) =       0.000430708271
  error estimate for blocks of size 2^( 4) =       0.000441762607
  error estimate for blocks of size 2^( 5) =       0.000451247223
  error estimate for blocks of size 2^( 6) =       0.000460864205
  error estimate for blocks of size 2^( 7) =       0.000465573034

      target function =                  N/A
              le_mean =     -16.910521385668
             les_mean =     286.297035527497
             stat err =       0.000454861767
             autocorr =       1.249006215700
              std dev =       0.575588531868
             le_variance =       0.331302158018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407002554
  error estimate for blocks of size 2^( 2) =       0.000418429556
  error estimate for blocks of size 2^( 3) =       0.000430708271
  error estimate for blocks of size 2^( 4) =       0.000441762607
  error estimate for blocks of size 2^( 5) =       0.000451247223
  error estimate for blocks of size 2^( 6) =       0.000460864205
  error estimate for blocks of size 2^( 7) =       0.000465573034

      target function =                  N/A
              le_mean =     -16.910521385668
             les_mean =     286.297035527497
             stat err =       0.000454861767
             autocorr =       1.249006215700
              std dev =       0.575588531868
             le_variance =       0.331302158018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340259507
                                         uncertainty =       0.005445678144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407002554
  error estimate for blocks of size 2^( 2) =       0.000418429556
  error estimate for blocks of size 2^( 3) =       0.000430708271
  error estimate for blocks of size 2^( 4) =       0.000441762607
  error estimate for blocks of size 2^( 5) =       0.000451247223
  error estimate for blocks of size 2^( 6) =       0.000460864205
  error estimate for blocks of size 2^( 7) =       0.000465573034

      target function =                  N/A
              le_mean =     -16.910521385668
             les_mean =     286.297035527497
             stat err =       0.000454861767
             autocorr =       1.249006215700
              std dev =       0.575588531868
             le_variance =       0.331302158018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910521385668        initial  <--
     1.5259e+12     1.5259e+13             0.0000e+00       -16.910521385668
     6.1035e+12     6.1035e+13             0.0000e+00       -16.910521385668
     2.4414e+13     2.4414e+14             0.0000e+00       -16.910521385668

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7895
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1726e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8903
    reference variance = 0.265857
====================================================
  Execution time = 4.0974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0717e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338663058270
                                         uncertainty =       0.007041472037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338663058270
                                         uncertainty =       0.007041472037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411454010
  error estimate for blocks of size 2^( 2) =       0.000423283999
  error estimate for blocks of size 2^( 3) =       0.000435725531
  error estimate for blocks of size 2^( 4) =       0.000446917495
  error estimate for blocks of size 2^( 5) =       0.000458138114
  error estimate for blocks of size 2^( 6) =       0.000465491029
  error estimate for blocks of size 2^( 7) =       0.000467723962

      target function =                  N/A
              le_mean =     -16.910228642148
             les_mean =     286.294421365631
             stat err =       0.000459567650
             autocorr =       1.247545233745
              std dev =       0.581883841673
             le_variance =       0.338588805200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691022864215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910228642148       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910228642148       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910228642148       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909245286756       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918131532436       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906988507982       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.899614120266       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.858245114330       residual = 3.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903215296156       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.941416217676       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.933634681291       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.628074438523       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.943932957876       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.297829572819       residual = 2.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.615360901576       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.341314418289       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.201403287663       residual = 2.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.412593298361       residual = 3.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -15.941564871867       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.531540150865       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.516175916892       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.103795312787       residual = 3.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.732299601334       residual = 7.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -18.957315258001       residual = 5.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -21.036571022336       residual = 2.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.524164011742       residual = 2.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.314392165595       residual = 2.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -18.801038226129       residual = 4.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.140645353206       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.964705006513       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.459860154004       residual = 6.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.100280138958       residual = 6.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -19.896443248732       residual = 1.14e+03           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -17.549740327197       residual = 5.60e+01           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -13.107569567263       residual = 1.92e+03           smallest_sin_value = 9.90e-01
davidson iteration   35 stopping due to small subspace S singular value of 8.71e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 3.126778e-18

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910228642148       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910228642148       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910228642148       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.721611173596       residual = 4.38e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923778446720       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.030167621964       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.811285682601       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.711663925544       residual = 5.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.670004693190       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.185368435554       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.025790195679       residual = 2.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.450111461625       residual = 3.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.970740421077       residual = 8.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -13.929181965036       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.352752998423       residual = 2.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -19.014609949579       residual = 6.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -14.835049410655       residual = 5.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -19.016897905820       residual = 5.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -18.230810339929       residual = 2.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.533457462419       residual = 6.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -19.489456568922       residual = 9.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -12.306421917937       residual = 2.78e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -19.167247682413       residual = 7.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.843196694801       residual = 1.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -10.145314551475       residual = 5.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.489125122082       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.609484002832       residual = 8.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =      -7.827894328082       residual = 1.15e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.284753888404       residual = 3.88e+03           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 7.816946e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910228642148       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910228642148       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910228642148       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -18.078975658384       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.983165547629       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.996411643729       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.712921326285       residual = 7.15e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -14.876981068580       residual = 5.03e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.088273555252       residual = 2.46e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.356234046964       residual = 3.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.549450212271       residual = 2.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -20.883803238352       residual = 2.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.528602604676       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -20.114361276634       residual = 1.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -23.291481656868       residual = 6.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   15 stopping due to too large eigenvalue change
davidson solver did not converge after         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 1.954237e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1733e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.265438
====================================================
  Execution time = 4.0398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3458e-01
  Total weights = 2.0000e+06
  Execution time = 4.6486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409008141
  error estimate for blocks of size 2^( 2) =       0.000420808979
  error estimate for blocks of size 2^( 3) =       0.000432822885
  error estimate for blocks of size 2^( 4) =       0.000443778601
  error estimate for blocks of size 2^( 5) =       0.000454430676
  error estimate for blocks of size 2^( 6) =       0.000463786374
  error estimate for blocks of size 2^( 7) =       0.000468788169

      target function =                  N/A
              le_mean =     -16.910788308383
             les_mean =     286.309336362146
             stat err =       0.000457695955
             autocorr =       1.252247705012
              std dev =       0.578424859846
             le_variance =       0.334575318488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409008141
  error estimate for blocks of size 2^( 2) =       0.000420808979
  error estimate for blocks of size 2^( 3) =       0.000432822885
  error estimate for blocks of size 2^( 4) =       0.000443778601
  error estimate for blocks of size 2^( 5) =       0.000454430676
  error estimate for blocks of size 2^( 6) =       0.000463786374
  error estimate for blocks of size 2^( 7) =       0.000468788169

      target function =                  N/A
              le_mean =     -16.910788308383
             les_mean =     286.309336362146
             stat err =       0.000457695955
             autocorr =       1.252247705012
              std dev =       0.578424859846
             le_variance =       0.334575318488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409008141
  error estimate for blocks of size 2^( 2) =       0.000420808979
  error estimate for blocks of size 2^( 3) =       0.000432822885
  error estimate for blocks of size 2^( 4) =       0.000443778601
  error estimate for blocks of size 2^( 5) =       0.000454430676
  error estimate for blocks of size 2^( 6) =       0.000463786374
  error estimate for blocks of size 2^( 7) =       0.000468788169

      target function =                  N/A
              le_mean =     -16.910788308383
             les_mean =     286.309336362146
             stat err =       0.000457695955
             autocorr =       1.252247705012
              std dev =       0.578424859846
             le_variance =       0.334575318488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334594692296
                                         uncertainty =       0.003694757508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409008141
  error estimate for blocks of size 2^( 2) =       0.000420808979
  error estimate for blocks of size 2^( 3) =       0.000432822885
  error estimate for blocks of size 2^( 4) =       0.000443778601
  error estimate for blocks of size 2^( 5) =       0.000454430676
  error estimate for blocks of size 2^( 6) =       0.000463786374
  error estimate for blocks of size 2^( 7) =       0.000468788169

      target function =                  N/A
              le_mean =     -16.910788308383
             les_mean =     286.309336362146
             stat err =       0.000457695955
             autocorr =       1.252247705012
              std dev =       0.578424859846
             le_variance =       0.334575318488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910788308383        initial  <--
     1.5259e+13     1.5259e+14             3.1268e-18       -16.910788308383
     6.1035e+13     6.1035e+14             7.8169e-19       -16.910788308383
     2.4414e+14     2.4414e+15             1.9542e-19       -16.910788308383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6785
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1542e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.215799
====================================================
  Execution time = 4.1105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0670e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335520615000
                                         uncertainty =       0.005696009839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335520615000
                                         uncertainty =       0.005696009839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409518361
  error estimate for blocks of size 2^( 2) =       0.000421187861
  error estimate for blocks of size 2^( 3) =       0.000433779634
  error estimate for blocks of size 2^( 4) =       0.000445378304
  error estimate for blocks of size 2^( 5) =       0.000456528723
  error estimate for blocks of size 2^( 6) =       0.000464622470
  error estimate for blocks of size 2^( 7) =       0.000470748455

      target function =                  N/A
              le_mean =     -16.911059146278
             les_mean =     286.319331856907
             stat err =       0.000459319488
             autocorr =       1.258006797468
              std dev =       0.579146419914
             le_variance =       0.335410575699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691105914628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.44e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.44e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911059146278       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.44e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1785e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.412934
====================================================
  Execution time = 4.2192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.0000e+06
  Execution time = 4.6713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413008330
  error estimate for blocks of size 2^( 2) =       0.000424523599
  error estimate for blocks of size 2^( 3) =       0.000436470662
  error estimate for blocks of size 2^( 4) =       0.000447743677
  error estimate for blocks of size 2^( 5) =       0.000458866866
  error estimate for blocks of size 2^( 6) =       0.000466294361
  error estimate for blocks of size 2^( 7) =       0.000475813713

      target function =                  N/A
              le_mean =     -16.910870422865
             les_mean =     286.318690049985
             stat err =       0.000462179654
             autocorr =       1.252287436822
              std dev =       0.584081981931
             le_variance =       0.341151761617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413008330
  error estimate for blocks of size 2^( 2) =       0.000424523599
  error estimate for blocks of size 2^( 3) =       0.000436470662
  error estimate for blocks of size 2^( 4) =       0.000447743677
  error estimate for blocks of size 2^( 5) =       0.000458866866
  error estimate for blocks of size 2^( 6) =       0.000466294361
  error estimate for blocks of size 2^( 7) =       0.000475813713

      target function =                  N/A
              le_mean =     -16.910870422865
             les_mean =     286.318690049985
             stat err =       0.000462179654
             autocorr =       1.252287436822
              std dev =       0.584081981931
             le_variance =       0.341151761617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413008330
  error estimate for blocks of size 2^( 2) =       0.000424523599
  error estimate for blocks of size 2^( 3) =       0.000436470662
  error estimate for blocks of size 2^( 4) =       0.000447743677
  error estimate for blocks of size 2^( 5) =       0.000458866866
  error estimate for blocks of size 2^( 6) =       0.000466294361
  error estimate for blocks of size 2^( 7) =       0.000475813713

      target function =                  N/A
              le_mean =     -16.910870422865
             les_mean =     286.318690049985
             stat err =       0.000462179654
             autocorr =       1.252287436822
              std dev =       0.584081981931
             le_variance =       0.341151761617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341242382066
                                         uncertainty =       0.008266851394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413008330
  error estimate for blocks of size 2^( 2) =       0.000424523599
  error estimate for blocks of size 2^( 3) =       0.000436470662
  error estimate for blocks of size 2^( 4) =       0.000447743677
  error estimate for blocks of size 2^( 5) =       0.000458866866
  error estimate for blocks of size 2^( 6) =       0.000466294361
  error estimate for blocks of size 2^( 7) =       0.000475813713

      target function =                  N/A
              le_mean =     -16.910870422865
             les_mean =     286.318690049985
             stat err =       0.000462179654
             autocorr =       1.252287436822
              std dev =       0.584081981931
             le_variance =       0.341151761617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910870422865        initial  <--
     1.5259e+14     1.5259e+15             0.0000e+00       -16.910870422865
     6.1035e+14     6.1035e+15             0.0000e+00       -16.910870422865
     2.4414e+15     2.4414e+16             0.0000e+00       -16.910870422865

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4582
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1725e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0161
    reference variance = 0.54902
====================================================
  Execution time = 4.1350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0677e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188426369
                                         uncertainty =       0.004735772092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188426369
                                         uncertainty =       0.004735772092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410576920
  error estimate for blocks of size 2^( 2) =       0.000421844705
  error estimate for blocks of size 2^( 3) =       0.000434561913
  error estimate for blocks of size 2^( 4) =       0.000446929492
  error estimate for blocks of size 2^( 5) =       0.000457634137
  error estimate for blocks of size 2^( 6) =       0.000465824521
  error estimate for blocks of size 2^( 7) =       0.000469698053

      target function =                  N/A
              le_mean =     -16.910817487839
             les_mean =     286.312894752897
             stat err =       0.000460021551
             autocorr =       1.255357121934
              std dev =       0.580643448645
             le_variance =       0.337146814454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691081748784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910817487839       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910817487839       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910817487839       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910817487839       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910817487839       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910817487839       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910817487838       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910817487839       residual = 1.70e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.235811735881       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.765417138655       residual = 2.22e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -25.029911533071       residual = 1.11e+04           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910817487839       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910817487839       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910817487839       residual = 6.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -25.472594952854       residual = 1.01e+04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.519180273009       residual = 1.67e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2038e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.220466
====================================================
  Execution time = 4.0560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3437e-01
  Total weights = 2.0000e+06
  Execution time = 4.6671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408883465
  error estimate for blocks of size 2^( 2) =       0.000420160863
  error estimate for blocks of size 2^( 3) =       0.000431944871
  error estimate for blocks of size 2^( 4) =       0.000442622774
  error estimate for blocks of size 2^( 5) =       0.000453662748
  error estimate for blocks of size 2^( 6) =       0.000460636955
  error estimate for blocks of size 2^( 7) =       0.000463936308

      target function =                  N/A
              le_mean =     -16.910543608410
             les_mean =     286.300856340808
             stat err =       0.000455214696
             autocorr =       1.239462673032
              std dev =       0.578248541767
             le_variance =       0.334371376055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408883465
  error estimate for blocks of size 2^( 2) =       0.000420160863
  error estimate for blocks of size 2^( 3) =       0.000431944871
  error estimate for blocks of size 2^( 4) =       0.000442622774
  error estimate for blocks of size 2^( 5) =       0.000453662748
  error estimate for blocks of size 2^( 6) =       0.000460636955
  error estimate for blocks of size 2^( 7) =       0.000463936308

      target function =                  N/A
              le_mean =     -16.910543608410
             les_mean =     286.300856340808
             stat err =       0.000455214696
             autocorr =       1.239462673032
              std dev =       0.578248541767
             le_variance =       0.334371376055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408883465
  error estimate for blocks of size 2^( 2) =       0.000420160863
  error estimate for blocks of size 2^( 3) =       0.000431944871
  error estimate for blocks of size 2^( 4) =       0.000442622774
  error estimate for blocks of size 2^( 5) =       0.000453662748
  error estimate for blocks of size 2^( 6) =       0.000460636955
  error estimate for blocks of size 2^( 7) =       0.000463936308

      target function =                  N/A
              le_mean =     -16.910543608410
             les_mean =     286.300856340808
             stat err =       0.000455214696
             autocorr =       1.239462673032
              std dev =       0.578248541767
             le_variance =       0.334371376055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334349115906
                                         uncertainty =       0.005677330093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408883465
  error estimate for blocks of size 2^( 2) =       0.000420160863
  error estimate for blocks of size 2^( 3) =       0.000431944871
  error estimate for blocks of size 2^( 4) =       0.000442622774
  error estimate for blocks of size 2^( 5) =       0.000453662748
  error estimate for blocks of size 2^( 6) =       0.000460636955
  error estimate for blocks of size 2^( 7) =       0.000463936308

      target function =                  N/A
              le_mean =     -16.910543608410
             les_mean =     286.300856340808
             stat err =       0.000455214696
             autocorr =       1.239462673032
              std dev =       0.578248541767
             le_variance =       0.334371376055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910543608410        initial  <--
     1.5259e+15     1.5259e+16             0.0000e+00       -16.910543608410
     6.1035e+15     6.1035e+16             0.0000e+00       -16.910543608410
     2.4414e+16     2.4414e+17             0.0000e+00       -16.910543608410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8724
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1592e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8747
    reference variance = 0.585754
====================================================
  Execution time = 4.1070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342456890744
                                         uncertainty =       0.010895748363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342456890744
                                         uncertainty =       0.010895748363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413795176
  error estimate for blocks of size 2^( 2) =       0.000425367884
  error estimate for blocks of size 2^( 3) =       0.000437041142
  error estimate for blocks of size 2^( 4) =       0.000447547520
  error estimate for blocks of size 2^( 5) =       0.000457803929
  error estimate for blocks of size 2^( 6) =       0.000466301774
  error estimate for blocks of size 2^( 7) =       0.000471649962

      target function =                  N/A
              le_mean =     -16.910936203597
             les_mean =     286.322216007082
             stat err =       0.000460825796
             autocorr =       1.240231383410
              std dev =       0.585194750644
             le_variance =       0.342452896181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691093620360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.56e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910936203597       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1872e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9627
    reference variance = 0.196538
====================================================
  Execution time = 4.0264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4582e-01
  Total weights = 2.0000e+06
  Execution time = 4.6329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415825022
  error estimate for blocks of size 2^( 2) =       0.000427369006
  error estimate for blocks of size 2^( 3) =       0.000439042863
  error estimate for blocks of size 2^( 4) =       0.000450435788
  error estimate for blocks of size 2^( 5) =       0.000460137761
  error estimate for blocks of size 2^( 6) =       0.000467038052
  error estimate for blocks of size 2^( 7) =       0.000472064101

      target function =                  N/A
              le_mean =     -16.911280059913
             les_mean =     286.337213989559
             stat err =       0.000462418926
             autocorr =       1.236659001123
              std dev =       0.588065385536
             le_variance =       0.345820897666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415825022
  error estimate for blocks of size 2^( 2) =       0.000427369006
  error estimate for blocks of size 2^( 3) =       0.000439042863
  error estimate for blocks of size 2^( 4) =       0.000450435788
  error estimate for blocks of size 2^( 5) =       0.000460137761
  error estimate for blocks of size 2^( 6) =       0.000467038052
  error estimate for blocks of size 2^( 7) =       0.000472064101

      target function =                  N/A
              le_mean =     -16.911280059913
             les_mean =     286.337213989559
             stat err =       0.000462418926
             autocorr =       1.236659001123
              std dev =       0.588065385536
             le_variance =       0.345820897666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415825022
  error estimate for blocks of size 2^( 2) =       0.000427369006
  error estimate for blocks of size 2^( 3) =       0.000439042863
  error estimate for blocks of size 2^( 4) =       0.000450435788
  error estimate for blocks of size 2^( 5) =       0.000460137761
  error estimate for blocks of size 2^( 6) =       0.000467038052
  error estimate for blocks of size 2^( 7) =       0.000472064101

      target function =                  N/A
              le_mean =     -16.911280059913
             les_mean =     286.337213989559
             stat err =       0.000462418926
             autocorr =       1.236659001123
              std dev =       0.588065385536
             le_variance =       0.345820897666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345888383253
                                         uncertainty =       0.008231023496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415825022
  error estimate for blocks of size 2^( 2) =       0.000427369006
  error estimate for blocks of size 2^( 3) =       0.000439042863
  error estimate for blocks of size 2^( 4) =       0.000450435788
  error estimate for blocks of size 2^( 5) =       0.000460137761
  error estimate for blocks of size 2^( 6) =       0.000467038052
  error estimate for blocks of size 2^( 7) =       0.000472064101

      target function =                  N/A
              le_mean =     -16.911280059913
             les_mean =     286.337213989559
             stat err =       0.000462418926
             autocorr =       1.236659001123
              std dev =       0.588065385536
             le_variance =       0.345820897666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911280059913        initial  <--
     1.5259e+16     1.5259e+17             0.0000e+00       -16.911280059913
     6.1035e+16     6.1035e+17             0.0000e+00       -16.911280059913
     2.4414e+17     2.4414e+18             0.0000e+00       -16.911280059913

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5179
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1540e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9226
    reference variance = 0.469163
====================================================
  Execution time = 4.2704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0758e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049565933
                                         uncertainty =       0.003755439148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049565933
                                         uncertainty =       0.003755439148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407504503
  error estimate for blocks of size 2^( 2) =       0.000419247124
  error estimate for blocks of size 2^( 3) =       0.000430972214
  error estimate for blocks of size 2^( 4) =       0.000443209047
  error estimate for blocks of size 2^( 5) =       0.000452902436
  error estimate for blocks of size 2^( 6) =       0.000461488184
  error estimate for blocks of size 2^( 7) =       0.000466418574

      target function =                  N/A
              le_mean =     -16.909692110895
             les_mean =     286.269806958972
             stat err =       0.000456004560
             autocorr =       1.252199562183
              std dev =       0.576298394735
             le_variance =       0.332119839774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690969211089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909692110895       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 2.510331e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909692110895       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 6.275826e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909692110895       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909692110895       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 1.568957e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3472e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.227032
====================================================
  Execution time = 4.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3068e-01
  Total weights = 2.0000e+06
  Execution time = 4.6251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406621658
  error estimate for blocks of size 2^( 2) =       0.000418514886
  error estimate for blocks of size 2^( 3) =       0.000430167376
  error estimate for blocks of size 2^( 4) =       0.000441990374
  error estimate for blocks of size 2^( 5) =       0.000451361993
  error estimate for blocks of size 2^( 6) =       0.000457388671
  error estimate for blocks of size 2^( 7) =       0.000462733462

      target function =                  N/A
              le_mean =     -16.911101706920
             les_mean =     286.316043122703
             stat err =       0.000453368625
             autocorr =       1.243145348502
              std dev =       0.575049864134
             le_variance =       0.330682346241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406621658
  error estimate for blocks of size 2^( 2) =       0.000418514886
  error estimate for blocks of size 2^( 3) =       0.000430167376
  error estimate for blocks of size 2^( 4) =       0.000441990374
  error estimate for blocks of size 2^( 5) =       0.000451361993
  error estimate for blocks of size 2^( 6) =       0.000457388671
  error estimate for blocks of size 2^( 7) =       0.000462733462

      target function =                  N/A
              le_mean =     -16.911101706920
             les_mean =     286.316043122703
             stat err =       0.000453368625
             autocorr =       1.243145348502
              std dev =       0.575049864134
             le_variance =       0.330682346241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406621658
  error estimate for blocks of size 2^( 2) =       0.000418514886
  error estimate for blocks of size 2^( 3) =       0.000430167376
  error estimate for blocks of size 2^( 4) =       0.000441990374
  error estimate for blocks of size 2^( 5) =       0.000451361993
  error estimate for blocks of size 2^( 6) =       0.000457388671
  error estimate for blocks of size 2^( 7) =       0.000462733462

      target function =                  N/A
              le_mean =     -16.911101706920
             les_mean =     286.316043122703
             stat err =       0.000453368625
             autocorr =       1.243145348502
              std dev =       0.575049864134
             le_variance =       0.330682346241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330739947456
                                         uncertainty =       0.003406371797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406621658
  error estimate for blocks of size 2^( 2) =       0.000418514886
  error estimate for blocks of size 2^( 3) =       0.000430167376
  error estimate for blocks of size 2^( 4) =       0.000441990374
  error estimate for blocks of size 2^( 5) =       0.000451361993
  error estimate for blocks of size 2^( 6) =       0.000457388671
  error estimate for blocks of size 2^( 7) =       0.000462733462

      target function =                  N/A
              le_mean =     -16.911101706920
             les_mean =     286.316043122703
             stat err =       0.000453368625
             autocorr =       1.243145348502
              std dev =       0.575049864134
             le_variance =       0.330682346241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911101706920        initial  <--
     1.5259e+17     1.5259e+18             2.5103e-22       -16.911101706920
     6.1035e+17     6.1035e+18             6.2758e-23       -16.911101706920
     2.4414e+18     2.4414e+19             1.5690e-23       -16.911101706920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7636
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1724e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9659
    reference variance = 0.291339
====================================================
  Execution time = 4.1032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0720e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335907025927
                                         uncertainty =       0.006255069436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335907025927
                                         uncertainty =       0.006255069436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409815608
  error estimate for blocks of size 2^( 2) =       0.000421639744
  error estimate for blocks of size 2^( 3) =       0.000434143201
  error estimate for blocks of size 2^( 4) =       0.000445766212
  error estimate for blocks of size 2^( 5) =       0.000455594840
  error estimate for blocks of size 2^( 6) =       0.000463221901
  error estimate for blocks of size 2^( 7) =       0.000466910313

      target function =                  N/A
              le_mean =     -16.909975809141
             les_mean =     286.283179363464
             stat err =       0.000457873317
             autocorr =       1.248284793742
              std dev =       0.579566791382
             le_variance =       0.335897665673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690997580914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909975809141       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909975809141       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909975809141       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909975809141       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 5.638678e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909975809141       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909975809141       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909975809141       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909975809141       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909975809103       residual = 6.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 1.409670e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909975809141       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909975809141       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909975809141       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909975809141       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 3.524174e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1763e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9216
    reference variance = 0.339514
====================================================
  Execution time = 4.0552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2474e-01
  Total weights = 2.0000e+06
  Execution time = 4.6372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402950757
  error estimate for blocks of size 2^( 2) =       0.000415151777
  error estimate for blocks of size 2^( 3) =       0.000427138861
  error estimate for blocks of size 2^( 4) =       0.000437700002
  error estimate for blocks of size 2^( 5) =       0.000447275658
  error estimate for blocks of size 2^( 6) =       0.000455174972
  error estimate for blocks of size 2^( 7) =       0.000458598357

      target function =                  N/A
              le_mean =     -16.910460983159
             les_mean =     286.288429125829
             stat err =       0.000449687247
             autocorr =       1.245423884994
              std dev =       0.569858425638
             le_variance =       0.324738625271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402950757
  error estimate for blocks of size 2^( 2) =       0.000415151777
  error estimate for blocks of size 2^( 3) =       0.000427138861
  error estimate for blocks of size 2^( 4) =       0.000437700002
  error estimate for blocks of size 2^( 5) =       0.000447275658
  error estimate for blocks of size 2^( 6) =       0.000455174972
  error estimate for blocks of size 2^( 7) =       0.000458598357

      target function =                  N/A
              le_mean =     -16.910460983159
             les_mean =     286.288429125829
             stat err =       0.000449687247
             autocorr =       1.245423884994
              std dev =       0.569858425638
             le_variance =       0.324738625271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402950757
  error estimate for blocks of size 2^( 2) =       0.000415151777
  error estimate for blocks of size 2^( 3) =       0.000427138861
  error estimate for blocks of size 2^( 4) =       0.000437700002
  error estimate for blocks of size 2^( 5) =       0.000447275658
  error estimate for blocks of size 2^( 6) =       0.000455174972
  error estimate for blocks of size 2^( 7) =       0.000458598357

      target function =                  N/A
              le_mean =     -16.910460983159
             les_mean =     286.288429125829
             stat err =       0.000449687247
             autocorr =       1.245423884994
              std dev =       0.569858425638
             le_variance =       0.324738625271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324804869197
                                         uncertainty =       0.003493530841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402950757
  error estimate for blocks of size 2^( 2) =       0.000415151777
  error estimate for blocks of size 2^( 3) =       0.000427138861
  error estimate for blocks of size 2^( 4) =       0.000437700002
  error estimate for blocks of size 2^( 5) =       0.000447275658
  error estimate for blocks of size 2^( 6) =       0.000455174972
  error estimate for blocks of size 2^( 7) =       0.000458598357

      target function =                  N/A
              le_mean =     -16.910460983159
             les_mean =     286.288429125829
             stat err =       0.000449687247
             autocorr =       1.245423884994
              std dev =       0.569858425638
             le_variance =       0.324738625271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910460983159        initial  <--
     1.5259e+18     1.5259e+19             5.6387e-23       -16.910460983159
     6.1035e+18     6.1035e+19             1.4097e-23       -16.910460983159
     2.4414e+19     2.4414e+20             3.5242e-24       -16.910460983159

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8265
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078367e-01 1 1  ON 0
 uu_1                 1.425434e-01 1 1  ON 1
 uu_2                 4.452419e-02 1 1  ON 2
 uu_3                -1.911852e-02 1 1  ON 3
 uu_4                -6.924837e-02 1 1  ON 4
 uu_5                -1.052293e-01 1 1  ON 5
 uu_6                -1.320263e-01 1 1  ON 6
 uu_7                -1.448972e-01 1 1  ON 7
 uu_8                -1.359658e-01 1 1  ON 8
 uu_9                -1.082878e-01 1 1  ON 9
 ud_0                 4.398870e-01 1 1  ON 10
 ud_1                 1.814295e-01 1 1  ON 11
 ud_2                 6.642205e-02 1 1  ON 12
 ud_3                -3.253591e-03 1 1  ON 13
 ud_4                -5.895802e-02 1 1  ON 14
 ud_5                -1.021404e-01 1 1  ON 15
 ud_6                -1.321058e-01 1 1  ON 16
 ud_7                -1.527802e-01 1 1  ON 17
 ud_8                -1.564066e-01 1 1  ON 18
 ud_9                -1.474587e-01 1 1  ON 19
 eO_0                -7.598025e-01 1 1  ON 20
 eO_1                -4.427200e-01 1 1  ON 21
 eO_2                -2.444857e-02 1 1  ON 22
 eO_3                 3.026644e-01 1 1  ON 23
 eO_4                 5.324548e-01 1 1  ON 24
 eO_5                 4.961119e-01 1 1  ON 25
 eO_6                 2.679592e-01 1 1  ON 26
 eO_7                -3.956929e-02 1 1  ON 27
 eO_8                -2.338418e-01 1 1  ON 28
 eO_9                -9.647660e-02 1 1  ON 29
eH1_0                -2.595754e-01 1 1  ON 30
eH1_1                -1.546545e-01 1 1  ON 31
eH1_2                -1.088141e-01 1 1  ON 32
eH1_3                -5.661541e-02 1 1  ON 33
eH1_4                -4.861409e-03 1 1  ON 34
eH1_5                 3.172065e-02 1 1  ON 35
eH1_6                 9.672006e-02 1 1  ON 36
eH1_7                 1.599821e-01 1 1  ON 37
eH1_8                 1.967106e-01 1 1  ON 38
eH1_9                 9.469430e-02 1 1  ON 39
eH2_0                -2.531265e-01 1 1  ON 40
eH2_1                -1.480854e-01 1 1  ON 41
eH2_2                -1.023244e-01 1 1  ON 42
eH2_3                -5.002865e-02 1 1  ON 43
eH2_4                 1.388630e-03 1 1  ON 44
eH2_5                 3.639509e-02 1 1  ON 45
eH2_6                 1.002474e-01 1 1  ON 46
eH2_7                 1.599911e-01 1 1  ON 47
eH2_8                 1.962441e-01 1 1  ON 48
eH2_9                 7.481333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1559e+02 secs
  Total Execution time = 4.6669e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
