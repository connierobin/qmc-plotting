Rank =    0  Free Memory = 83347 MB
Rank =    1  Free Memory = 83347 MB
Rank =    2  Free Memory = 83347 MB
Rank =    3  Free Memory = 83346 MB
Rank =    4  Free Memory = 83345 MB
Rank =    5  Free Memory = 83345 MB
Rank =    6  Free Memory = 83345 MB
Rank =    7  Free Memory = 83345 MB
Rank =    8  Free Memory = 83344 MB
Rank =    9  Free Memory = 83344 MB
Rank =   10  Free Memory = 83344 MB
Rank =   11  Free Memory = 83344 MB
Rank =   12  Free Memory = 83344 MB
Rank =   13  Free Memory = 83344 MB
Rank =   14  Free Memory = 83344 MB
Rank =   15  Free Memory = 83330 MB
Rank =   16  Free Memory = 83330 MB
Rank =   17  Free Memory = 83329 MB
Rank =   18  Free Memory = 83329 MB
Rank =   19  Free Memory = 83329 MB
Rank =   20  Free Memory = 83329 MB
Rank =   21  Free Memory = 83329 MB
Rank =   22  Free Memory = 83329 MB
Rank =   23  Free Memory = 83329 MB
Rank =   24  Free Memory = 83329 MB
Rank =   25  Free Memory = 83329 MB
Rank =   26  Free Memory = 83329 MB
Rank =   27  Free Memory = 83329 MB
Rank =   28  Free Memory = 83329 MB
Rank =   29  Free Memory = 83328 MB
Rank =   30  Free Memory = 83328 MB
Rank =   31  Free Memory = 83328 MB
Rank =   32  Free Memory = 85047 MB
Rank =   33  Free Memory = 85047 MB
Rank =   34  Free Memory = 85047 MB
Rank =   35  Free Memory = 85047 MB
Rank =   36  Free Memory = 85047 MB
Rank =   37  Free Memory = 85047 MB
Rank =   38  Free Memory = 85047 MB
Rank =   39  Free Memory = 85047 MB
Rank =   40  Free Memory = 85047 MB
Rank =   41  Free Memory = 85046 MB
Rank =   42  Free Memory = 85046 MB
Rank =   43  Free Memory = 85046 MB
Rank =   44  Free Memory = 85046 MB
Rank =   45  Free Memory = 85046 MB
Rank =   46  Free Memory = 85046 MB
Rank =   47  Free Memory = 85046 MB
Rank =   48  Free Memory = 85046 MB
Rank =   49  Free Memory = 85046 MB
Rank =   50  Free Memory = 85046 MB
Rank =   51  Free Memory = 85046 MB
Rank =   52  Free Memory = 85046 MB
Rank =   53  Free Memory = 85046 MB
Rank =   54  Free Memory = 85046 MB
Rank =   55  Free Memory = 85046 MB
Rank =   56  Free Memory = 85046 MB
Rank =   57  Free Memory = 85045 MB
Rank =   58  Free Memory = 85045 MB
Rank =   59  Free Memory = 85045 MB
Rank =   60  Free Memory = 85045 MB
Rank =   61  Free Memory = 85045 MB
Rank =   62  Free Memory = 85045 MB
Rank =   63  Free Memory = 85045 MB
Rank =   64  Free Memory = 78538 MB
Rank =   65  Free Memory = 78538 MB
Rank =   66  Free Memory = 78538 MB
Rank =   67  Free Memory = 78538 MB
Rank =   68  Free Memory = 78538 MB
Rank =   69  Free Memory = 78538 MB
Rank =   70  Free Memory = 78538 MB
Rank =   71  Free Memory = 78538 MB
Rank =   72  Free Memory = 78538 MB
Rank =   73  Free Memory = 78538 MB
Rank =   74  Free Memory = 78538 MB
Rank =   75  Free Memory = 78538 MB
Rank =   76  Free Memory = 78538 MB
Rank =   77  Free Memory = 78538 MB
Rank =   78  Free Memory = 78538 MB
Rank =   79  Free Memory = 78538 MB
Rank =   80  Free Memory = 78538 MB
Rank =   81  Free Memory = 78538 MB
Rank =   82  Free Memory = 78538 MB
Rank =   83  Free Memory = 78538 MB
Rank =   84  Free Memory = 78538 MB
Rank =   85  Free Memory = 78538 MB
Rank =   86  Free Memory = 78538 MB
Rank =   87  Free Memory = 78538 MB
Rank =   88  Free Memory = 78538 MB
Rank =   89  Free Memory = 78538 MB
Rank =   90  Free Memory = 78538 MB
Rank =   91  Free Memory = 78538 MB
Rank =   92  Free Memory = 78538 MB
Rank =   93  Free Memory = 78538 MB
Rank =   94  Free Memory = 78538 MB
Rank =   95  Free Memory = 78538 MB
Rank =   96  Free Memory = 74027 MB
Rank =   97  Free Memory = 74027 MB
Rank =   98  Free Memory = 74027 MB
Rank =   99  Free Memory = 74027 MB
Rank =  100  Free Memory = 74027 MB
Rank =  101  Free Memory = 74027 MB
Rank =  102  Free Memory = 74027 MB
Rank =  103  Free Memory = 74027 MB
Rank =  104  Free Memory = 74027 MB
Rank =  105  Free Memory = 74027 MB
Rank =  106  Free Memory = 74027 MB
Rank =  107  Free Memory = 74027 MB
Rank =  108  Free Memory = 74027 MB
Rank =  109  Free Memory = 74027 MB
Rank =  110  Free Memory = 74027 MB
Rank =  111  Free Memory = 74027 MB
Rank =  112  Free Memory = 74027 MB
Rank =  113  Free Memory = 74027 MB
Rank =  114  Free Memory = 74027 MB
Rank =  115  Free Memory = 74027 MB
Rank =  116  Free Memory = 74027 MB
Rank =  117  Free Memory = 74027 MB
Rank =  118  Free Memory = 74027 MB
Rank =  119  Free Memory = 74027 MB
Rank =  120  Free Memory = 74027 MB
Rank =  121  Free Memory = 74027 MB
Rank =  122  Free Memory = 74027 MB
Rank =  123  Free Memory = 74027 MB
Rank =  124  Free Memory = 74027 MB
Rank =  125  Free Memory = 74027 MB
Rank =  126  Free Memory = 74027 MB
Rank =  127  Free Memory = 74027 MB
  Input file(s): opt_h2o_1b1_gvptt_277dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_277dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 15:37:37 PDT
  host    = n0013.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 561

  Range of prime numbers to use as seeds over processors and threads = 4091-5189


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.085824e-01    1         1  ON     0
     uu_1                 1.422474e-01    1         1  ON     1
     uu_2                 4.267389e-02    1         1  ON     2
     uu_3                -2.075331e-02    1         1  ON     3
     uu_4                -6.908286e-02    1         1  ON     4
     uu_5                -1.036373e-01    1         1  ON     5
     uu_6                -1.293033e-01    1         1  ON     6
     uu_7                -1.401224e-01    1         1  ON     7
     uu_8                -1.303597e-01    1         1  ON     8
     uu_9                -1.002196e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.321204e-01    1         1  ON     0
     ud_1                 1.758308e-01    1         1  ON     1
     ud_2                 6.449071e-02    1         1  ON     2
     ud_3                -2.868395e-03    1         1  ON     3
     ud_4                -5.884645e-02    1         1  ON     4
     ud_5                -1.018528e-01    1         1  ON     5
     ud_6                -1.318430e-01    1         1  ON     6
     ud_7                -1.515537e-01    1         1  ON     7
     ud_8                -1.548359e-01    1         1  ON     8
     ud_9                -1.441984e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.551565e-01    1         1  ON     0
     eO_1                -4.406112e-01    1         1  ON     1
     eO_2                -2.620711e-02    1         1  ON     2
     eO_3                 2.963188e-01    1         1  ON     3
     eO_4                 5.235617e-01    1         1  ON     4
     eO_5                 4.855459e-01    1         1  ON     5
     eO_6                 2.577048e-01    1         1  ON     6
     eO_7                -4.294623e-02    1         1  ON     7
     eO_8                -2.201876e-01    1         1  ON     8
     eO_9                -7.889719e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.471407e-01    1         1  ON     0
     eH1_1                -1.452786e-01    1         1  ON     1
     eH1_2                -1.014765e-01    1         1  ON     2
     eH1_3                -4.945091e-02    1         1  ON     3
     eH1_4                 2.090504e-03    1         1  ON     4
     eH1_5                 3.699465e-02    1         1  ON     5
     eH1_6                 9.737243e-02    1         1  ON     6
     eH1_7                 1.534854e-01    1         1  ON     7
     eH1_8                 1.820516e-01    1         1  ON     8
     eH1_9                 7.070235e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.407627e-01    1         1  ON     0
     eH2_1                -1.388004e-01    1         1  ON     1
     eH2_2                -9.515704e-02    1         1  ON     2
     eH2_3                -4.345228e-02    1         1  ON     3
     eH2_4                 7.855128e-03    1         1  ON     4
     eH2_5                 4.185514e-02    1         1  ON     5
     eH2_6                 1.026545e-01    1         1  ON     6
     eH2_7                 1.565299e-01    1         1  ON     7
     eH2_8                 1.803130e-01    1         1  ON     8
     eH2_9                 4.625706e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 277 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.925834e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 70 unique up determinants.
Found 70 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.5990e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9634
    reference variance = 0.560482
====================================================
  Execution time = 2.4819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326198291307
                                         uncertainty =       0.003018552116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326198291307
                                         uncertainty =       0.003018552116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403825771
  error estimate for blocks of size 2^( 2) =       0.000415961031
  error estimate for blocks of size 2^( 3) =       0.000428978372
  error estimate for blocks of size 2^( 4) =       0.000441962330
  error estimate for blocks of size 2^( 5) =       0.000453441774
  error estimate for blocks of size 2^( 6) =       0.000462530664
  error estimate for blocks of size 2^( 7) =       0.000468682831

      target function =                  N/A
              le_mean =     -16.910172336006
             les_mean =     286.280078776436
             stat err =       0.000456654400
             autocorr =       1.278754666595
              std dev =       0.571095881707
             le_variance =       0.326150506102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691017233601e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910172336006       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910192159112       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910199476181       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910200959576       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910201198705       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910201187299       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910200518396       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910199702795       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910200866553       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910200876670       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910201299717       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.449125e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910172336006       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180227218       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910183902904       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910184837284       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910185351047       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910184981283       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910184754779       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910184693900       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910184794714       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.123448e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910172336006       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910174651722       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910175888212       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910176225794       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910176512363       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910176347981       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910176268374       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910176273152       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910176278239       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.460322e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1213e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.083741e-01                 1 1 ON  0
uu_1  1.420121e-01                 1 1 ON  1
uu_2  4.287497e-02                 1 1 ON  2
uu_3  -2.063711e-02                1 1 ON  3
uu_4  -6.903932e-02                1 1 ON  4
uu_5  -1.036268e-01                1 1 ON  5
uu_6  -1.293312e-01                1 1 ON  6
uu_7  -1.401566e-01                1 1 ON  7
uu_8  -1.304373e-01                1 1 ON  8
uu_9  -1.002606e-01                1 1 ON  9
ud_0  4.326328e-01                 1 1 ON  10
ud_1  1.761652e-01                 1 1 ON  11
ud_2  6.418655e-02                 1 1 ON  12
ud_3  -3.240683e-03                1 1 ON  13
ud_4  -5.895469e-02                1 1 ON  14
ud_5  -1.018456e-01                1 1 ON  15
ud_6  -1.318283e-01                1 1 ON  16
ud_7  -1.515113e-01                1 1 ON  17
ud_8  -1.548117e-01                1 1 ON  18
ud_9  -1.442648e-01                1 1 ON  19
eO_0  -7.556011e-01                1 1 ON  20
eO_1  -4.408192e-01                1 1 ON  21
eO_2  -2.606226e-02                1 1 ON  22
eO_3  2.966790e-01                 1 1 ON  23
eO_4  5.236822e-01                 1 1 ON  24
eO_5  4.856421e-01                 1 1 ON  25
eO_6  2.577820e-01                 1 1 ON  26
eO_7  -4.286001e-02                1 1 ON  27
eO_8  -2.202712e-01                1 1 ON  28
eO_9  -7.902223e-02                1 1 ON  29
eH1_0 -2.474375e-01                1 1 ON  30
eH1_1 -1.452640e-01                1 1 ON  31
eH1_2 -1.014278e-01                1 1 ON  32
eH1_3 -4.958697e-02                1 1 ON  33
eH1_4 2.056740e-03                 1 1 ON  34
eH1_5 3.688436e-02                 1 1 ON  35
eH1_6 9.745939e-02                 1 1 ON  36
eH1_7 1.535921e-01                 1 1 ON  37
eH1_8 1.821939e-01                 1 1 ON  38
eH1_9 7.086750e-02                 1 1 ON  39
eH2_0 -2.409728e-01                1 1 ON  40
eH2_1 -1.388421e-01                1 1 ON  41
eH2_2 -9.513504e-02                1 1 ON  42
eH2_3 -4.353911e-02                1 1 ON  43
eH2_4 7.809990e-03                 1 1 ON  44
eH2_5 4.178598e-02                 1 1 ON  45
eH2_6 1.026217e-01                 1 1 ON  46
eH2_7 1.565775e-01                 1 1 ON  47
eH2_8 1.804554e-01                 1 1 ON  48
eH2_9 4.648071e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.994
    reference variance = 0.263503
====================================================
  Execution time = 2.4179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3719e-01
  Total weights = 2.0000e+06
  Execution time = 2.7165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337021913412
                                         uncertainty =       0.005068182943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337021913412
                                         uncertainty =       0.005068182943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410450767
  error estimate for blocks of size 2^( 2) =       0.000422289423
  error estimate for blocks of size 2^( 3) =       0.000434986399
  error estimate for blocks of size 2^( 4) =       0.000447336551
  error estimate for blocks of size 2^( 5) =       0.000457677445
  error estimate for blocks of size 2^( 6) =       0.000466482271
  error estimate for blocks of size 2^( 7) =       0.000471740835

      target function =                  N/A
              le_mean =     -16.910130567520
             les_mean =     286.289455306850
             stat err =       0.000460809275
             autocorr =       1.260434496286
              std dev =       0.580465041795
             le_variance =       0.336939664746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337772153399
                                         uncertainty =       0.005090081395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337772153399
                                         uncertainty =       0.005090081395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907299
  error estimate for blocks of size 2^( 2) =       0.000422702696
  error estimate for blocks of size 2^( 3) =       0.000435365990
  error estimate for blocks of size 2^( 4) =       0.000447704545
  error estimate for blocks of size 2^( 5) =       0.000458038926
  error estimate for blocks of size 2^( 6) =       0.000466837610
  error estimate for blocks of size 2^( 7) =       0.000472088361

      target function =                  N/A
              le_mean =     -16.910134187389
             les_mean =     286.290327682781
             stat err =       0.000461167361
             autocorr =       1.259590607884
              std dev =       0.581110674599
             le_variance =       0.337689616133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549608013
                                         uncertainty =       0.005084677515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549608013
                                         uncertainty =       0.005084677515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410771928
  error estimate for blocks of size 2^( 2) =       0.000422575241
  error estimate for blocks of size 2^( 3) =       0.000435244290
  error estimate for blocks of size 2^( 4) =       0.000447586522
  error estimate for blocks of size 2^( 5) =       0.000457925646
  error estimate for blocks of size 2^( 6) =       0.000466730443
  error estimate for blocks of size 2^( 7) =       0.000471982049

      target function =                  N/A
              le_mean =     -16.910132749854
             les_mean =     286.290056602473
             stat err =       0.000461056165
             autocorr =       1.259813200123
              std dev =       0.580919231503
             le_variance =       0.337467153530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337092374300
                                         uncertainty =       0.005070508621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337092374300
                                         uncertainty =       0.005070508621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410493665
  error estimate for blocks of size 2^( 2) =       0.000422326629
  error estimate for blocks of size 2^( 3) =       0.000435019035
  error estimate for blocks of size 2^( 4) =       0.000447367945
  error estimate for blocks of size 2^( 5) =       0.000457708718
  error estimate for blocks of size 2^( 6) =       0.000466513901
  error estimate for blocks of size 2^( 7) =       0.000471771590

      target function =                  N/A
              le_mean =     -16.910130094923
             les_mean =     286.289509756146
             stat err =       0.000460840539
             autocorr =       1.260342070377
              std dev =       0.580525707803
             le_variance =       0.337010097421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910130567520        initial
     2.5000e-01     2.5000e+00             1.4491e-03       -16.910134187389  <--
     1.0000e+00     1.0000e+01             5.1234e-04       -16.910132749854
     4.0000e+00     4.0000e+01             1.4603e-04       -16.910130094923

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.7828e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.080453e-01 1 1  ON 0
 uu_1                 1.417634e-01 1 1  ON 1
 uu_2                 4.305396e-02 1 1  ON 2
 uu_3                -2.046793e-02 1 1  ON 3
 uu_4                -6.897977e-02 1 1  ON 4
 uu_5                -1.036613e-01 1 1  ON 5
 uu_6                -1.294275e-01 1 1  ON 6
 uu_7                -1.402678e-01 1 1  ON 7
 uu_8                -1.306627e-01 1 1  ON 8
 uu_9                -1.003826e-01 1 1  ON 9
 ud_0                 4.335273e-01 1 1  ON 10
 ud_1                 1.766171e-01 1 1  ON 11
 ud_2                 6.388395e-02 1 1  ON 12
 ud_3                -3.872915e-03 1 1  ON 13
 ud_4                -5.928001e-02 1 1  ON 14
 ud_5                -1.018705e-01 1 1  ON 15
 ud_6                -1.317474e-01 1 1  ON 16
 ud_7                -1.513655e-01 1 1  ON 17
 ud_8                -1.546929e-01 1 1  ON 18
 ud_9                -1.444265e-01 1 1  ON 19
 eO_0                -7.566056e-01 1 1  ON 20
 eO_1                -4.413402e-01 1 1  ON 21
 eO_2                -2.589233e-02 1 1  ON 22
 eO_3                 2.973885e-01 1 1  ON 23
 eO_4                 5.241359e-01 1 1  ON 24
 eO_5                 4.860017e-01 1 1  ON 25
 eO_6                 2.580328e-01 1 1  ON 26
 eO_7                -4.259442e-02 1 1  ON 27
 eO_8                -2.205117e-01 1 1  ON 28
 eO_9                -7.939403e-02 1 1  ON 29
eH1_0                -2.481398e-01 1 1  ON 30
eH1_1                -1.453616e-01 1 1  ON 31
eH1_2                -1.014463e-01 1 1  ON 32
eH1_3                -4.981814e-02 1 1  ON 33
eH1_4                 1.860128e-03 1 1  ON 34
eH1_5                 3.658477e-02 1 1  ON 35
eH1_6                 9.770557e-02 1 1  ON 36
eH1_7                 1.539165e-01 1 1  ON 37
eH1_8                 1.826298e-01 1 1  ON 38
eH1_9                 7.136749e-02 1 1  ON 39
eH2_0                -2.414930e-01 1 1  ON 40
eH2_1                -1.390007e-01 1 1  ON 41
eH2_2                -9.517510e-02 1 1  ON 42
eH2_3                -4.372124e-02 1 1  ON 43
eH2_4                 7.595806e-03 1 1  ON 44
eH2_5                 4.157426e-02 1 1  ON 45
eH2_6                 1.025426e-01 1 1  ON 46
eH2_7                 1.567267e-01 1 1  ON 47
eH2_8                 1.808863e-01 1 1  ON 48
eH2_9                 4.715383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6979e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8488
    reference variance = 0.942417
====================================================
  Execution time = 2.4589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337601461902
                                         uncertainty =       0.004979880328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337601461902
                                         uncertainty =       0.004979880328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410919163
  error estimate for blocks of size 2^( 2) =       0.000422403470
  error estimate for blocks of size 2^( 3) =       0.000434464954
  error estimate for blocks of size 2^( 4) =       0.000446587286
  error estimate for blocks of size 2^( 5) =       0.000457130619
  error estimate for blocks of size 2^( 6) =       0.000465338506
  error estimate for blocks of size 2^( 7) =       0.000469388452

      target function =                  N/A
              le_mean =     -16.910280004851
             les_mean =     286.295278791373
             stat err =       0.000459611216
             autocorr =       1.251032077481
              std dev =       0.581127453986
             le_variance =       0.337709117776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691028000485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910280004851       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910284525910       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910286519710       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910283399393       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910284480873       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910285991859       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910288216946       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910289308998       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910293004898       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910292089119       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910290945176       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910291684832       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910292066141       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910291803953       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.180058e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910280004851       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910282652232       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910284256536       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910282557725       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910283037220       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910283918399       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910283765810       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910284459827       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910285023338       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910285114046       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910284770589       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.049178e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910280004851       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910281000955       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910281812965       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910281355686       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910281659170       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910281577599       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910281556460       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910281593084       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910281755866       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.369983e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1003e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.075243e-01 1 1  ON 0
 uu_1                 1.418194e-01 1 1  ON 1
 uu_2                 4.324781e-02 1 1  ON 2
 uu_3                -2.026353e-02 1 1  ON 3
 uu_4                -6.893094e-02 1 1  ON 4
 uu_5                -1.037020e-01 1 1  ON 5
 uu_6                -1.292900e-01 1 1  ON 6
 uu_7                -1.406464e-01 1 1  ON 7
 uu_8                -1.311515e-01 1 1  ON 8
 uu_9                -1.004931e-01 1 1  ON 9
 ud_0                 4.343729e-01 1 1  ON 10
 ud_1                 1.771176e-01 1 1  ON 11
 ud_2                 6.386386e-02 1 1  ON 12
 ud_3                -4.353788e-03 1 1  ON 13
 ud_4                -5.958942e-02 1 1  ON 14
 ud_5                -1.021455e-01 1 1  ON 15
 ud_6                -1.317467e-01 1 1  ON 16
 ud_7                -1.511670e-01 1 1  ON 17
 ud_8                -1.548218e-01 1 1  ON 18
 ud_9                -1.442754e-01 1 1  ON 19
 eO_0                -7.576548e-01 1 1  ON 20
 eO_1                -4.418219e-01 1 1  ON 21
 eO_2                -2.559791e-02 1 1  ON 22
 eO_3                 2.980925e-01 1 1  ON 23
 eO_4                 5.249554e-01 1 1  ON 24
 eO_5                 4.865477e-01 1 1  ON 25
 eO_6                 2.581023e-01 1 1  ON 26
 eO_7                -4.248073e-02 1 1  ON 27
 eO_8                -2.209541e-01 1 1  ON 28
 eO_9                -7.986021e-02 1 1  ON 29
eH1_0                -2.488144e-01 1 1  ON 30
eH1_1                -1.456564e-01 1 1  ON 31
eH1_2                -1.015095e-01 1 1  ON 32
eH1_3                -4.983261e-02 1 1  ON 33
eH1_4                 1.407547e-03 1 1  ON 34
eH1_5                 3.648327e-02 1 1  ON 35
eH1_6                 9.777523e-02 1 1  ON 36
eH1_7                 1.539424e-01 1 1  ON 37
eH1_8                 1.832350e-01 1 1  ON 38
eH1_9                 7.216172e-02 1 1  ON 39
eH2_0                -2.421271e-01 1 1  ON 40
eH2_1                -1.393652e-01 1 1  ON 41
eH2_2                -9.539282e-02 1 1  ON 42
eH2_3                -4.391379e-02 1 1  ON 43
eH2_4                 7.305424e-03 1 1  ON 44
eH2_5                 4.156431e-02 1 1  ON 45
eH2_6                 1.028867e-01 1 1  ON 46
eH2_7                 1.570353e-01 1 1  ON 47
eH2_8                 1.813454e-01 1 1  ON 48
eH2_9                 4.785634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.148826
====================================================
  Execution time = 2.3785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2739e-01
  Total weights = 2.0000e+06
  Execution time = 2.7144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327085916426
                                         uncertainty =       0.002872987433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327085916426
                                         uncertainty =       0.002872987433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404389227
  error estimate for blocks of size 2^( 2) =       0.000416344359
  error estimate for blocks of size 2^( 3) =       0.000428942078
  error estimate for blocks of size 2^( 4) =       0.000440437178
  error estimate for blocks of size 2^( 5) =       0.000450091764
  error estimate for blocks of size 2^( 6) =       0.000457538116
  error estimate for blocks of size 2^( 7) =       0.000463634181

      target function =                  N/A
              le_mean =     -16.910037943616
             les_mean =     286.276444385262
             stat err =       0.000452925310
             autocorr =       1.254451932558
              std dev =       0.571892729685
             le_variance =       0.327061294267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327838742730
                                         uncertainty =       0.002876961076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327838742730
                                         uncertainty =       0.002876961076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404854253
  error estimate for blocks of size 2^( 2) =       0.000416776053
  error estimate for blocks of size 2^( 3) =       0.000429338845
  error estimate for blocks of size 2^( 4) =       0.000440795013
  error estimate for blocks of size 2^( 5) =       0.000450435195
  error estimate for blocks of size 2^( 6) =       0.000457876985
  error estimate for blocks of size 2^( 7) =       0.000463944456

      target function =                  N/A
              le_mean =     -16.910031028353
             les_mean =     286.276963147540
             stat err =       0.000453262912
             autocorr =       1.253438294273
              std dev =       0.572550374725
             le_variance =       0.327813931598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327772046319
                                         uncertainty =       0.002876382343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327772046319
                                         uncertainty =       0.002876382343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404813089
  error estimate for blocks of size 2^( 2) =       0.000416731589
  error estimate for blocks of size 2^( 3) =       0.000429294225
  error estimate for blocks of size 2^( 4) =       0.000440752709
  error estimate for blocks of size 2^( 5) =       0.000450403198
  error estimate for blocks of size 2^( 6) =       0.000457854654
  error estimate for blocks of size 2^( 7) =       0.000463921037

      target function =                  N/A
              le_mean =     -16.910030412155
             les_mean =     286.276875650116
             stat err =       0.000453232900
             autocorr =       1.253527199430
              std dev =       0.572492160632
             le_variance =       0.327747273985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327187141096
                                         uncertainty =       0.002873490364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327187141096
                                         uncertainty =       0.002873490364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404451799
  error estimate for blocks of size 2^( 2) =       0.000416399354
  error estimate for blocks of size 2^( 3) =       0.000428990137
  error estimate for blocks of size 2^( 4) =       0.000440478167
  error estimate for blocks of size 2^( 5) =       0.000450133314
  error estimate for blocks of size 2^( 6) =       0.000457581285
  error estimate for blocks of size 2^( 7) =       0.000463672259

      target function =                  N/A
              le_mean =     -16.910035042339
             les_mean =     286.276447485581
             stat err =       0.000452966256
             autocorr =       1.254290569653
              std dev =       0.571981219996
             le_variance =       0.327162516029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910037943616        initial  <--
     6.2500e-02     6.2500e-01             3.1801e-03       -16.910031028353
     2.5000e-01     2.5000e+00             1.0492e-03       -16.910030412155
     1.0000e+00     1.0000e+01             3.3700e-04       -16.910035042339

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.4297
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.080453e-01 1 1  ON 0
 uu_1                 1.417634e-01 1 1  ON 1
 uu_2                 4.305396e-02 1 1  ON 2
 uu_3                -2.046793e-02 1 1  ON 3
 uu_4                -6.897977e-02 1 1  ON 4
 uu_5                -1.036613e-01 1 1  ON 5
 uu_6                -1.294275e-01 1 1  ON 6
 uu_7                -1.402678e-01 1 1  ON 7
 uu_8                -1.306627e-01 1 1  ON 8
 uu_9                -1.003826e-01 1 1  ON 9
 ud_0                 4.335273e-01 1 1  ON 10
 ud_1                 1.766171e-01 1 1  ON 11
 ud_2                 6.388395e-02 1 1  ON 12
 ud_3                -3.872915e-03 1 1  ON 13
 ud_4                -5.928001e-02 1 1  ON 14
 ud_5                -1.018705e-01 1 1  ON 15
 ud_6                -1.317474e-01 1 1  ON 16
 ud_7                -1.513655e-01 1 1  ON 17
 ud_8                -1.546929e-01 1 1  ON 18
 ud_9                -1.444265e-01 1 1  ON 19
 eO_0                -7.566056e-01 1 1  ON 20
 eO_1                -4.413402e-01 1 1  ON 21
 eO_2                -2.589233e-02 1 1  ON 22
 eO_3                 2.973885e-01 1 1  ON 23
 eO_4                 5.241359e-01 1 1  ON 24
 eO_5                 4.860017e-01 1 1  ON 25
 eO_6                 2.580328e-01 1 1  ON 26
 eO_7                -4.259442e-02 1 1  ON 27
 eO_8                -2.205117e-01 1 1  ON 28
 eO_9                -7.939403e-02 1 1  ON 29
eH1_0                -2.481398e-01 1 1  ON 30
eH1_1                -1.453616e-01 1 1  ON 31
eH1_2                -1.014463e-01 1 1  ON 32
eH1_3                -4.981814e-02 1 1  ON 33
eH1_4                 1.860128e-03 1 1  ON 34
eH1_5                 3.658477e-02 1 1  ON 35
eH1_6                 9.770557e-02 1 1  ON 36
eH1_7                 1.539165e-01 1 1  ON 37
eH1_8                 1.826298e-01 1 1  ON 38
eH1_9                 7.136749e-02 1 1  ON 39
eH2_0                -2.414930e-01 1 1  ON 40
eH2_1                -1.390007e-01 1 1  ON 41
eH2_2                -9.517510e-02 1 1  ON 42
eH2_3                -4.372124e-02 1 1  ON 43
eH2_4                 7.595806e-03 1 1  ON 44
eH2_5                 4.157426e-02 1 1  ON 45
eH2_6                 1.025426e-01 1 1  ON 46
eH2_7                 1.567267e-01 1 1  ON 47
eH2_8                 1.808863e-01 1 1  ON 48
eH2_9                 4.715383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9458
    reference variance = 0.199164
====================================================
  Execution time = 2.4238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3164e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331687693644
                                         uncertainty =       0.003969514522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331687693644
                                         uncertainty =       0.003969514522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407207719
  error estimate for blocks of size 2^( 2) =       0.000418957846
  error estimate for blocks of size 2^( 3) =       0.000431076605
  error estimate for blocks of size 2^( 4) =       0.000442701539
  error estimate for blocks of size 2^( 5) =       0.000452382286
  error estimate for blocks of size 2^( 6) =       0.000459025324
  error estimate for blocks of size 2^( 7) =       0.000463500366

      target function =                  N/A
              le_mean =     -16.910502427910
             les_mean =     286.296728451822
             stat err =       0.000454402379
             autocorr =       1.245228890493
              std dev =       0.575878679308
             le_variance =       0.331636253282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691050242791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910502427910       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910503423691       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910504119336       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910505310561       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910506019490       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910507051971       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910507143138       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910506602294       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910506662241       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.340768e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910502427910       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910502731394       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910502965024       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910503255945       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910503604797       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910503738456       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910503822923       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910503722626       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910503734114       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.229175e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910502427910       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910502508177       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910502572228       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910502643802       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910502747343       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910502768620       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910502791112       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910502770386       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.140946e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0638e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.079756e-01 1 1  ON 0
 uu_1                 1.417514e-01 1 1  ON 1
 uu_2                 4.306853e-02 1 1  ON 2
 uu_3                -2.041268e-02 1 1  ON 3
 uu_4                -6.893786e-02 1 1  ON 4
 uu_5                -1.036161e-01 1 1  ON 5
 uu_6                -1.294352e-01 1 1  ON 6
 uu_7                -1.402888e-01 1 1  ON 7
 uu_8                -1.306997e-01 1 1  ON 8
 uu_9                -1.004273e-01 1 1  ON 9
 ud_0                 4.336502e-01 1 1  ON 10
 ud_1                 1.767226e-01 1 1  ON 11
 ud_2                 6.387455e-02 1 1  ON 12
 ud_3                -3.947291e-03 1 1  ON 13
 ud_4                -5.931220e-02 1 1  ON 14
 ud_5                -1.018707e-01 1 1  ON 15
 ud_6                -1.317414e-01 1 1  ON 16
 ud_7                -1.513677e-01 1 1  ON 17
 ud_8                -1.547592e-01 1 1  ON 18
 ud_9                -1.444721e-01 1 1  ON 19
 eO_0                -7.567259e-01 1 1  ON 20
 eO_1                -4.413883e-01 1 1  ON 21
 eO_2                -2.580608e-02 1 1  ON 22
 eO_3                 2.974917e-01 1 1  ON 23
 eO_4                 5.241852e-01 1 1  ON 24
 eO_5                 4.860416e-01 1 1  ON 25
 eO_6                 2.580452e-01 1 1  ON 26
 eO_7                -4.260137e-02 1 1  ON 27
 eO_8                -2.205628e-01 1 1  ON 28
 eO_9                -7.944791e-02 1 1  ON 29
eH1_0                -2.481829e-01 1 1  ON 30
eH1_1                -1.453827e-01 1 1  ON 31
eH1_2                -1.014375e-01 1 1  ON 32
eH1_3                -4.981008e-02 1 1  ON 33
eH1_4                 1.819794e-03 1 1  ON 34
eH1_5                 3.650887e-02 1 1  ON 35
eH1_6                 9.767957e-02 1 1  ON 36
eH1_7                 1.539357e-01 1 1  ON 37
eH1_8                 1.826889e-01 1 1  ON 38
eH1_9                 7.146024e-02 1 1  ON 39
eH2_0                -2.415184e-01 1 1  ON 40
eH2_1                -1.390413e-01 1 1  ON 41
eH2_2                -9.517904e-02 1 1  ON 42
eH2_3                -4.371423e-02 1 1  ON 43
eH2_4                 7.574903e-03 1 1  ON 44
eH2_5                 4.152702e-02 1 1  ON 45
eH2_6                 1.025663e-01 1 1  ON 46
eH2_7                 1.567338e-01 1 1  ON 47
eH2_8                 1.809163e-01 1 1  ON 48
eH2_9                 4.723168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8755
    reference variance = 0.31274
====================================================
  Execution time = 2.3750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3091e-01
  Total weights = 2.0000e+06
  Execution time = 2.7151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330882865628
                                         uncertainty =       0.003986070016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330882865628
                                         uncertainty =       0.003986070016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406736991
  error estimate for blocks of size 2^( 2) =       0.000418806265
  error estimate for blocks of size 2^( 3) =       0.000430435436
  error estimate for blocks of size 2^( 4) =       0.000442448333
  error estimate for blocks of size 2^( 5) =       0.000452981758
  error estimate for blocks of size 2^( 6) =       0.000460288098
  error estimate for blocks of size 2^( 7) =       0.000464136694

      target function =                  N/A
              le_mean =     -16.910338801426
             les_mean =     286.290428173836
             stat err =       0.000454963721
             autocorr =       1.251198429307
              std dev =       0.575212969478
             le_variance =       0.330869960255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331024261989
                                         uncertainty =       0.003988122586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331024261989
                                         uncertainty =       0.003988122586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406823945
  error estimate for blocks of size 2^( 2) =       0.000418883877
  error estimate for blocks of size 2^( 3) =       0.000430503176
  error estimate for blocks of size 2^( 4) =       0.000442512389
  error estimate for blocks of size 2^( 5) =       0.000453043883
  error estimate for blocks of size 2^( 6) =       0.000460345471
  error estimate for blocks of size 2^( 7) =       0.000464190291

      target function =                  N/A
              le_mean =     -16.910338804748
             les_mean =     286.290569770773
             stat err =       0.000455023008
             autocorr =       1.250989603568
              std dev =       0.575335940905
             le_variance =       0.331011444897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330960251958
                                         uncertainty =       0.003987173765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330960251958
                                         uncertainty =       0.003987173765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784588
  error estimate for blocks of size 2^( 2) =       0.000418848112
  error estimate for blocks of size 2^( 3) =       0.000430471247
  error estimate for blocks of size 2^( 4) =       0.000442482117
  error estimate for blocks of size 2^( 5) =       0.000453014505
  error estimate for blocks of size 2^( 6) =       0.000460317941
  error estimate for blocks of size 2^( 7) =       0.000464164524

      target function =                  N/A
              le_mean =     -16.910338623040
             les_mean =     286.290499582707
             stat err =       0.000454994772
             autocorr =       1.251076400642
              std dev =       0.575280281519
             le_variance =       0.330947402305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892087578
                                         uncertainty =       0.003986198746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892087578
                                         uncertainty =       0.003986198746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406742664
  error estimate for blocks of size 2^( 2) =       0.000418811188
  error estimate for blocks of size 2^( 3) =       0.000430439570
  error estimate for blocks of size 2^( 4) =       0.000442452225
  error estimate for blocks of size 2^( 5) =       0.000452985529
  error estimate for blocks of size 2^( 6) =       0.000460291496
  error estimate for blocks of size 2^( 7) =       0.000464139816

      target function =                  N/A
              le_mean =     -16.910338742727
             les_mean =     286.290435417527
             stat err =       0.000454967266
             autocorr =       1.251183031667
              std dev =       0.575220991600
             le_variance =       0.330879189177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910338801426        initial
     6.2500e-01     6.2500e+00             4.3408e-04       -16.910338804748  <--
     2.5000e+00     2.5000e+01             1.2292e-04       -16.910338623040
     1.0000e+01     1.0000e+02             3.1409e-05       -16.910338742727

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.7410e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.078193e-01 1 1  ON 0
 uu_1                 1.417448e-01 1 1  ON 1
 uu_2                 4.309795e-02 1 1  ON 2
 uu_3                -2.029351e-02 1 1  ON 3
 uu_4                -6.882733e-02 1 1  ON 4
 uu_5                -1.035066e-01 1 1  ON 5
 uu_6                -1.294409e-01 1 1  ON 6
 uu_7                -1.403426e-01 1 1  ON 7
 uu_8                -1.308111e-01 1 1  ON 8
 uu_9                -1.005609e-01 1 1  ON 9
 ud_0                 4.339613e-01 1 1  ON 10
 ud_1                 1.769633e-01 1 1  ON 11
 ud_2                 6.388160e-02 1 1  ON 12
 ud_3                -4.100013e-03 1 1  ON 13
 ud_4                -5.940499e-02 1 1  ON 14
 ud_5                -1.018725e-01 1 1  ON 15
 ud_6                -1.317293e-01 1 1  ON 16
 ud_7                -1.513634e-01 1 1  ON 17
 ud_8                -1.549409e-01 1 1  ON 18
 ud_9                -1.446053e-01 1 1  ON 19
 eO_0                -7.570341e-01 1 1  ON 20
 eO_1                -4.415150e-01 1 1  ON 21
 eO_2                -2.561082e-02 1 1  ON 22
 eO_3                 2.977769e-01 1 1  ON 23
 eO_4                 5.243360e-01 1 1  ON 24
 eO_5                 4.861614e-01 1 1  ON 25
 eO_6                 2.580842e-01 1 1  ON 26
 eO_7                -4.262062e-02 1 1  ON 27
 eO_8                -2.207115e-01 1 1  ON 28
 eO_9                -7.960401e-02 1 1  ON 29
eH1_0                -2.483015e-01 1 1  ON 30
eH1_1                -1.454368e-01 1 1  ON 31
eH1_2                -1.014180e-01 1 1  ON 32
eH1_3                -4.979906e-02 1 1  ON 33
eH1_4                 1.709647e-03 1 1  ON 34
eH1_5                 3.629135e-02 1 1  ON 35
eH1_6                 9.760132e-02 1 1  ON 36
eH1_7                 1.539914e-01 1 1  ON 37
eH1_8                 1.828605e-01 1 1  ON 38
eH1_9                 7.172785e-02 1 1  ON 39
eH2_0                -2.415967e-01 1 1  ON 40
eH2_1                -1.391431e-01 1 1  ON 41
eH2_2                -9.519078e-02 1 1  ON 42
eH2_3                -4.370340e-02 1 1  ON 43
eH2_4                 7.511126e-03 1 1  ON 44
eH2_5                 4.139190e-02 1 1  ON 45
eH2_6                 1.026343e-01 1 1  ON 46
eH2_7                 1.567571e-01 1 1  ON 47
eH2_8                 1.810033e-01 1 1  ON 48
eH2_9                 4.745562e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9643
    reference variance = 0.908768
====================================================
  Execution time = 2.4377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341360364539
                                         uncertainty =       0.008402604799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341360364539
                                         uncertainty =       0.008402604799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413165993
  error estimate for blocks of size 2^( 2) =       0.000424710945
  error estimate for blocks of size 2^( 3) =       0.000436985032
  error estimate for blocks of size 2^( 4) =       0.000448527836
  error estimate for blocks of size 2^( 5) =       0.000457991198
  error estimate for blocks of size 2^( 6) =       0.000465653880
  error estimate for blocks of size 2^( 7) =       0.000468697914

      target function =                  N/A
              le_mean =     -16.911033524002
             les_mean =     286.324466955367
             stat err =       0.000460217707
             autocorr =       1.240730651224
              std dev =       0.584304951322
             le_variance =       0.341412276140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691103352400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911033524002       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911030959229       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032186393       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911034462369       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911034898149       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911036688480       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911036684270       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911036415513       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911036614773       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911036859166       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911036811504       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911036709457       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.310428e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911033524002       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911032386259       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911032913493       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911033626842       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911034006302       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911034129920       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911034201725       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911034161368       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911034080690       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.594644e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911033524002       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911033171278       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911033327111       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911033422653       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911033543517       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911033586002       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911033601108       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911033599927       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.102545e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0755e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.076360e-01 1 1  ON 0
 uu_1                 1.417627e-01 1 1  ON 1
 uu_2                 4.314508e-02 1 1  ON 2
 uu_3                -2.016096e-02 1 1  ON 3
 uu_4                -6.868537e-02 1 1  ON 4
 uu_5                -1.034589e-01 1 1  ON 5
 uu_6                -1.294098e-01 1 1  ON 6
 uu_7                -1.404170e-01 1 1  ON 7
 uu_8                -1.309188e-01 1 1  ON 8
 uu_9                -1.007830e-01 1 1  ON 9
 ud_0                 4.342820e-01 1 1  ON 10
 ud_1                 1.773179e-01 1 1  ON 11
 ud_2                 6.390429e-02 1 1  ON 12
 ud_3                -4.265271e-03 1 1  ON 13
 ud_4                -5.951449e-02 1 1  ON 14
 ud_5                -1.018828e-01 1 1  ON 15
 ud_6                -1.317046e-01 1 1  ON 16
 ud_7                -1.513422e-01 1 1  ON 17
 ud_8                -1.550295e-01 1 1  ON 18
 ud_9                -1.447646e-01 1 1  ON 19
 eO_0                -7.573936e-01 1 1  ON 20
 eO_1                -4.416297e-01 1 1  ON 21
 eO_2                -2.547459e-02 1 1  ON 22
 eO_3                 2.980860e-01 1 1  ON 23
 eO_4                 5.245989e-01 1 1  ON 24
 eO_5                 4.862586e-01 1 1  ON 25
 eO_6                 2.582033e-01 1 1  ON 26
 eO_7                -4.253779e-02 1 1  ON 27
 eO_8                -2.209556e-01 1 1  ON 28
 eO_9                -7.984766e-02 1 1  ON 29
eH1_0                -2.486542e-01 1 1  ON 30
eH1_1                -1.455611e-01 1 1  ON 31
eH1_2                -1.014302e-01 1 1  ON 32
eH1_3                -4.981185e-02 1 1  ON 33
eH1_4                 1.539812e-03 1 1  ON 34
eH1_5                 3.628781e-02 1 1  ON 35
eH1_6                 9.776636e-02 1 1  ON 36
eH1_7                 1.541092e-01 1 1  ON 37
eH1_8                 1.830351e-01 1 1  ON 38
eH1_9                 7.195917e-02 1 1  ON 39
eH2_0                -2.417514e-01 1 1  ON 40
eH2_1                -1.392078e-01 1 1  ON 41
eH2_2                -9.538016e-02 1 1  ON 42
eH2_3                -4.373852e-02 1 1  ON 43
eH2_4                 7.496857e-03 1 1  ON 44
eH2_5                 4.138370e-02 1 1  ON 45
eH2_6                 1.025223e-01 1 1  ON 46
eH2_7                 1.568356e-01 1 1  ON 47
eH2_8                 1.812113e-01 1 1  ON 48
eH2_9                 4.777820e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.563619
====================================================
  Execution time = 2.4081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3243e-01
  Total weights = 2.0000e+06
  Execution time = 2.7178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332434051306
                                         uncertainty =       0.005875366481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332434051306
                                         uncertainty =       0.005875366481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407644148
  error estimate for blocks of size 2^( 2) =       0.000419030105
  error estimate for blocks of size 2^( 3) =       0.000431648880
  error estimate for blocks of size 2^( 4) =       0.000443334390
  error estimate for blocks of size 2^( 5) =       0.000453947532
  error estimate for blocks of size 2^( 6) =       0.000461211282
  error estimate for blocks of size 2^( 7) =       0.000465504128

      target function =                  N/A
              le_mean =     -16.910607388629
             les_mean =     286.300989588460
             stat err =       0.000455999333
             autocorr =       1.251313099750
              std dev =       0.576495882262
             le_variance =       0.332347502265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332759912264
                                         uncertainty =       0.005879679454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332759912264
                                         uncertainty =       0.005879679454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407843822
  error estimate for blocks of size 2^( 2) =       0.000419213458
  error estimate for blocks of size 2^( 3) =       0.000431817422
  error estimate for blocks of size 2^( 4) =       0.000443491116
  error estimate for blocks of size 2^( 5) =       0.000454092207
  error estimate for blocks of size 2^( 6) =       0.000461372538
  error estimate for blocks of size 2^( 7) =       0.000465647920

      target function =                  N/A
              le_mean =     -16.910609733957
             les_mean =     286.301394574634
             stat err =       0.000456150945
             autocorr =       1.250919553724
              std dev =       0.576778264831
             le_variance =       0.332673166781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332613580628
                                         uncertainty =       0.005877078018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332613580628
                                         uncertainty =       0.005877078018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407754148
  error estimate for blocks of size 2^( 2) =       0.000419127745
  error estimate for blocks of size 2^( 3) =       0.000431736731
  error estimate for blocks of size 2^( 4) =       0.000443414639
  error estimate for blocks of size 2^( 5) =       0.000454018892
  error estimate for blocks of size 2^( 6) =       0.000461298843
  error estimate for blocks of size 2^( 7) =       0.000465573590

      target function =                  N/A
              le_mean =     -16.910608950789
             les_mean =     286.301221811176
             stat err =       0.000456076491
             autocorr =       1.251061319885
              std dev =       0.576651446654
             le_variance =       0.332526890928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332449858624
                                         uncertainty =       0.005875356813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332449858624
                                         uncertainty =       0.005875356813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407653829
  error estimate for blocks of size 2^( 2) =       0.000419037945
  error estimate for blocks of size 2^( 3) =       0.000431655416
  error estimate for blocks of size 2^( 4) =       0.000443339910
  error estimate for blocks of size 2^( 5) =       0.000453951823
  error estimate for blocks of size 2^( 6) =       0.000461218234
  error estimate for blocks of size 2^( 7) =       0.000465508025

      target function =                  N/A
              le_mean =     -16.910607430920
             les_mean =     286.301006804589
             stat err =       0.000456004498
             autocorr =       1.251282014433
              std dev =       0.576509573282
             le_variance =       0.332363288086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910607388629        initial
     1.5625e-01     1.5625e+00             1.3104e-03       -16.910609733957  <--
     6.2500e-01     6.2500e+00             3.5946e-04       -16.910608950789
     2.5000e+00     2.5000e+01             1.1025e-04       -16.910607430920

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.7745e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.075710e-01 1 1  ON 0
 uu_1                 1.418495e-01 1 1  ON 1
 uu_2                 4.326458e-02 1 1  ON 2
 uu_3                -1.996782e-02 1 1  ON 3
 uu_4                -6.847255e-02 1 1  ON 4
 uu_5                -1.033537e-01 1 1  ON 5
 uu_6                -1.294278e-01 1 1  ON 6
 uu_7                -1.406189e-01 1 1  ON 7
 uu_8                -1.312098e-01 1 1  ON 8
 uu_9                -1.014328e-01 1 1  ON 9
 ud_0                 4.349746e-01 1 1  ON 10
 ud_1                 1.778690e-01 1 1  ON 11
 ud_2                 6.412427e-02 1 1  ON 12
 ud_3                -4.380923e-03 1 1  ON 13
 ud_4                -5.967563e-02 1 1  ON 14
 ud_5                -1.019398e-01 1 1  ON 15
 ud_6                -1.316440e-01 1 1  ON 16
 ud_7                -1.513013e-01 1 1  ON 17
 ud_8                -1.551889e-01 1 1  ON 18
 ud_9                -1.451917e-01 1 1  ON 19
 eO_0                -7.580264e-01 1 1  ON 20
 eO_1                -4.419296e-01 1 1  ON 21
 eO_2                -2.528929e-02 1 1  ON 22
 eO_3                 2.986548e-01 1 1  ON 23
 eO_4                 5.253280e-01 1 1  ON 24
 eO_5                 4.866830e-01 1 1  ON 25
 eO_6                 2.585761e-01 1 1  ON 26
 eO_7                -4.228585e-02 1 1  ON 27
 eO_8                -2.216745e-01 1 1  ON 28
 eO_9                -8.058842e-02 1 1  ON 29
eH1_0                -2.494578e-01 1 1  ON 30
eH1_1                -1.458968e-01 1 1  ON 31
eH1_2                -1.016494e-01 1 1  ON 32
eH1_3                -4.998371e-02 1 1  ON 33
eH1_4                 1.171784e-03 1 1  ON 34
eH1_5                 3.616462e-02 1 1  ON 35
eH1_6                 9.818705e-02 1 1  ON 36
eH1_7                 1.544838e-01 1 1  ON 37
eH1_8                 1.835828e-01 1 1  ON 38
eH1_9                 7.267602e-02 1 1  ON 39
eH2_0                -2.421988e-01 1 1  ON 40
eH2_1                -1.395036e-01 1 1  ON 41
eH2_2                -9.573233e-02 1 1  ON 42
eH2_3                -4.392782e-02 1 1  ON 43
eH2_4                 7.349447e-03 1 1  ON 44
eH2_5                 4.131257e-02 1 1  ON 45
eH2_6                 1.022700e-01 1 1  ON 46
eH2_7                 1.570764e-01 1 1  ON 47
eH2_8                 1.818292e-01 1 1  ON 48
eH2_9                 4.876605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.235944
====================================================
  Execution time = 2.4659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337778784848
                                         uncertainty =       0.003974842415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337778784848
                                         uncertainty =       0.003974842415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410995856
  error estimate for blocks of size 2^( 2) =       0.000422920881
  error estimate for blocks of size 2^( 3) =       0.000435338223
  error estimate for blocks of size 2^( 4) =       0.000446174594
  error estimate for blocks of size 2^( 5) =       0.000455528937
  error estimate for blocks of size 2^( 6) =       0.000463103529
  error estimate for blocks of size 2^( 7) =       0.000468136474

      target function =                  N/A
              le_mean =     -16.910040306070
             les_mean =     286.287298171460
             stat err =       0.000458235883
             autocorr =       1.243092091357
              std dev =       0.581235913766
             le_variance =       0.337835187451


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691004030607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910040306070       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910041788893       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910040183816       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910046646424       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910046911367       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910048038089       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910051626781       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910050412796       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910049142755       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910048336586       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910047808880       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910049740979       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910050625267       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910050214153       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910051066995       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.031840e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910040306070       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910041293713       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910040220963       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910044196462       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910044543118       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910044628235       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910045623499       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910044767343       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910044227977       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910044396447       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910044338499       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910044600819       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.294627e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910040306070       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910040728903       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910040271014       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910041353077       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910041801008       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910042098432       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910041936252       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910041972112       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910041736993       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.576831e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1033e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.076969e-01 1 1  ON 0
 uu_1                 1.420570e-01 1 1  ON 1
 uu_2                 4.345847e-02 1 1  ON 2
 uu_3                -1.976292e-02 1 1  ON 3
 uu_4                -6.846444e-02 1 1  ON 4
 uu_5                -1.034708e-01 1 1  ON 5
 uu_6                -1.293282e-01 1 1  ON 6
 uu_7                -1.407155e-01 1 1  ON 7
 uu_8                -1.315282e-01 1 1  ON 8
 uu_9                -1.023053e-01 1 1  ON 9
 ud_0                 4.360023e-01 1 1  ON 10
 ud_1                 1.786351e-01 1 1  ON 11
 ud_2                 6.450364e-02 1 1  ON 12
 ud_3                -4.212825e-03 1 1  ON 13
 ud_4                -5.959375e-02 1 1  ON 14
 ud_5                -1.019143e-01 1 1  ON 15
 ud_6                -1.315471e-01 1 1  ON 16
 ud_7                -1.518526e-01 1 1  ON 17
 ud_8                -1.557440e-01 1 1  ON 18
 ud_9                -1.456549e-01 1 1  ON 19
 eO_0                -7.588166e-01 1 1  ON 20
 eO_1                -4.424832e-01 1 1  ON 21
 eO_2                -2.517158e-02 1 1  ON 22
 eO_3                 2.991260e-01 1 1  ON 23
 eO_4                 5.262688e-01 1 1  ON 24
 eO_5                 4.876096e-01 1 1  ON 25
 eO_6                 2.593129e-01 1 1  ON 26
 eO_7                -4.218726e-02 1 1  ON 27
 eO_8                -2.224013e-01 1 1  ON 28
 eO_9                -8.158699e-02 1 1  ON 29
eH1_0                -2.502863e-01 1 1  ON 30
eH1_1                -1.463437e-01 1 1  ON 31
eH1_2                -1.020583e-01 1 1  ON 32
eH1_3                -5.000691e-02 1 1  ON 33
eH1_4                 8.229758e-04 1 1  ON 34
eH1_5                 3.593825e-02 1 1  ON 35
eH1_6                 9.817576e-02 1 1  ON 36
eH1_7                 1.549783e-01 1 1  ON 37
eH1_8                 1.841771e-01 1 1  ON 38
eH1_9                 7.376448e-02 1 1  ON 39
eH2_0                -2.429331e-01 1 1  ON 40
eH2_1                -1.403394e-01 1 1  ON 41
eH2_2                -9.585262e-02 1 1  ON 42
eH2_3                -4.439958e-02 1 1  ON 43
eH2_4                 7.379893e-03 1 1  ON 44
eH2_5                 4.158048e-02 1 1  ON 45
eH2_6                 1.022024e-01 1 1  ON 46
eH2_7                 1.568888e-01 1 1  ON 47
eH2_8                 1.827305e-01 1 1  ON 48
eH2_9                 5.006067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9473
    reference variance = 0.30082
====================================================
  Execution time = 2.3950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3777e-01
  Total weights = 2.0000e+06
  Execution time = 2.7256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395536716
                                         uncertainty =       0.004712261713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395536716
                                         uncertainty =       0.004712261713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724421
  error estimate for blocks of size 2^( 2) =       0.000422555735
  error estimate for blocks of size 2^( 3) =       0.000434499390
  error estimate for blocks of size 2^( 4) =       0.000446010879
  error estimate for blocks of size 2^( 5) =       0.000457047496
  error estimate for blocks of size 2^( 6) =       0.000465840179
  error estimate for blocks of size 2^( 7) =       0.000469726329

      target function =                  N/A
              le_mean =     -16.910684591423
             les_mean =     286.308642281584
             stat err =       0.000459656221
             autocorr =       1.252463944000
              std dev =       0.580852046302
             le_variance =       0.337389099693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154320029
                                         uncertainty =       0.004720630163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154320029
                                         uncertainty =       0.004720630163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411185903
  error estimate for blocks of size 2^( 2) =       0.000422987944
  error estimate for blocks of size 2^( 3) =       0.000434894159
  error estimate for blocks of size 2^( 4) =       0.000446369331
  error estimate for blocks of size 2^( 5) =       0.000457379058
  error estimate for blocks of size 2^( 6) =       0.000466159312
  error estimate for blocks of size 2^( 7) =       0.000470031884

      target function =                  N/A
              le_mean =     -16.910688020399
             les_mean =     286.309516848566
             stat err =       0.000459984896
             autocorr =       1.251441948176
              std dev =       0.581504681294
             le_variance =       0.338147694366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338162732860
                                         uncertainty =       0.004720312599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338162732860
                                         uncertainty =       0.004720312599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411190951
  error estimate for blocks of size 2^( 2) =       0.000422991736
  error estimate for blocks of size 2^( 3) =       0.000434903834
  error estimate for blocks of size 2^( 4) =       0.000446388957
  error estimate for blocks of size 2^( 5) =       0.000457406788
  error estimate for blocks of size 2^( 6) =       0.000466190659
  error estimate for blocks of size 2^( 7) =       0.000470069256

      target function =                  N/A
              le_mean =     -16.910691419598
             les_mean =     286.309640116362
             stat err =       0.000460013915
             autocorr =       1.251569122594
              std dev =       0.581511819819
             le_variance =       0.338155996589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546892321
                                         uncertainty =       0.004713804330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546892321
                                         uncertainty =       0.004713804330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410816494
  error estimate for blocks of size 2^( 2) =       0.000422641024
  error estimate for blocks of size 2^( 3) =       0.000434578683
  error estimate for blocks of size 2^( 4) =       0.000446085840
  error estimate for blocks of size 2^( 5) =       0.000457119769
  error estimate for blocks of size 2^( 6) =       0.000465911114
  error estimate for blocks of size 2^( 7) =       0.000469796499

      target function =                  N/A
              le_mean =     -16.910685751312
             les_mean =     286.308832793791
             stat err =       0.000459728306
             autocorr =       1.252295286156
              std dev =       0.580982256978
             le_variance =       0.337540382924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910684591423        initial
     3.9062e-02     3.9062e-01             5.0318e-03       -16.910688020399
     1.5625e-01     1.5625e+00             1.2946e-03       -16.910691419598  <--
     6.2500e-01     6.2500e+00             3.5768e-04       -16.910685751312

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.7589e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.076969e-01 1 1  ON 0
 uu_1                 1.420570e-01 1 1  ON 1
 uu_2                 4.345847e-02 1 1  ON 2
 uu_3                -1.976292e-02 1 1  ON 3
 uu_4                -6.846444e-02 1 1  ON 4
 uu_5                -1.034708e-01 1 1  ON 5
 uu_6                -1.293282e-01 1 1  ON 6
 uu_7                -1.407155e-01 1 1  ON 7
 uu_8                -1.315282e-01 1 1  ON 8
 uu_9                -1.023053e-01 1 1  ON 9
 ud_0                 4.360023e-01 1 1  ON 10
 ud_1                 1.786351e-01 1 1  ON 11
 ud_2                 6.450364e-02 1 1  ON 12
 ud_3                -4.212825e-03 1 1  ON 13
 ud_4                -5.959375e-02 1 1  ON 14
 ud_5                -1.019143e-01 1 1  ON 15
 ud_6                -1.315471e-01 1 1  ON 16
 ud_7                -1.518526e-01 1 1  ON 17
 ud_8                -1.557440e-01 1 1  ON 18
 ud_9                -1.456549e-01 1 1  ON 19
 eO_0                -7.588166e-01 1 1  ON 20
 eO_1                -4.424832e-01 1 1  ON 21
 eO_2                -2.517158e-02 1 1  ON 22
 eO_3                 2.991260e-01 1 1  ON 23
 eO_4                 5.262688e-01 1 1  ON 24
 eO_5                 4.876096e-01 1 1  ON 25
 eO_6                 2.593129e-01 1 1  ON 26
 eO_7                -4.218726e-02 1 1  ON 27
 eO_8                -2.224013e-01 1 1  ON 28
 eO_9                -8.158699e-02 1 1  ON 29
eH1_0                -2.502863e-01 1 1  ON 30
eH1_1                -1.463437e-01 1 1  ON 31
eH1_2                -1.020583e-01 1 1  ON 32
eH1_3                -5.000691e-02 1 1  ON 33
eH1_4                 8.229758e-04 1 1  ON 34
eH1_5                 3.593825e-02 1 1  ON 35
eH1_6                 9.817576e-02 1 1  ON 36
eH1_7                 1.549783e-01 1 1  ON 37
eH1_8                 1.841771e-01 1 1  ON 38
eH1_9                 7.376448e-02 1 1  ON 39
eH2_0                -2.429331e-01 1 1  ON 40
eH2_1                -1.403394e-01 1 1  ON 41
eH2_2                -9.585262e-02 1 1  ON 42
eH2_3                -4.439958e-02 1 1  ON 43
eH2_4                 7.379893e-03 1 1  ON 44
eH2_5                 4.158048e-02 1 1  ON 45
eH2_6                 1.022024e-01 1 1  ON 46
eH2_7                 1.568888e-01 1 1  ON 47
eH2_8                 1.827305e-01 1 1  ON 48
eH2_9                 5.006067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8622
    reference variance = 0.240148
====================================================
  Execution time = 2.4280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3236e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332456207189
                                         uncertainty =       0.003894308174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332456207189
                                         uncertainty =       0.003894308174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407654189
  error estimate for blocks of size 2^( 2) =       0.000419145296
  error estimate for blocks of size 2^( 3) =       0.000431313397
  error estimate for blocks of size 2^( 4) =       0.000441889786
  error estimate for blocks of size 2^( 5) =       0.000451561662
  error estimate for blocks of size 2^( 6) =       0.000458691228
  error estimate for blocks of size 2^( 7) =       0.000465459279

      target function =                  N/A
              le_mean =     -16.909806526499
             les_mean =     286.273920472746
             stat err =       0.000454400489
             autocorr =       1.242492457723
              std dev =       0.576510082562
             le_variance =       0.332363875296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690980652650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909806526499       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909810654452       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909810323948       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909808843012       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808689640       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909809321450       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909815241858       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909816357919       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909818452940       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909817886715       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909816153171       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909815951491       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909816954348       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909816590153       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909817101361       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.800455e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909806526499       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808590739       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808144169       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909807251030       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909807446502       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808337601       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909809738225       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909810474273       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909810132283       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909809999745       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909809616479       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909809622369       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.207121e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909806526499       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909807214637       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909807019988       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909806733479       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909806870940       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909807353814       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909807398761       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909807460917       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909807406814       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.543703e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0665e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.078168e-01 1 1  ON 0
 uu_1                 1.422074e-01 1 1  ON 1
 uu_2                 4.361648e-02 1 1  ON 2
 uu_3                -1.975658e-02 1 1  ON 3
 uu_4                -6.827243e-02 1 1  ON 4
 uu_5                -1.034297e-01 1 1  ON 5
 uu_6                -1.293103e-01 1 1  ON 6
 uu_7                -1.408807e-01 1 1  ON 7
 uu_8                -1.321184e-01 1 1  ON 8
 uu_9                -1.032674e-01 1 1  ON 9
 ud_0                 4.366062e-01 1 1  ON 10
 ud_1                 1.789501e-01 1 1  ON 11
 ud_2                 6.490390e-02 1 1  ON 12
 ud_3                -3.996313e-03 1 1  ON 13
 ud_4                -5.935133e-02 1 1  ON 14
 ud_5                -1.019863e-01 1 1  ON 15
 ud_6                -1.317476e-01 1 1  ON 16
 ud_7                -1.523052e-01 1 1  ON 17
 ud_8                -1.563191e-01 1 1  ON 18
 ud_9                -1.459510e-01 1 1  ON 19
 eO_0                -7.591318e-01 1 1  ON 20
 eO_1                -4.428269e-01 1 1  ON 21
 eO_2                -2.508931e-02 1 1  ON 22
 eO_3                 2.993451e-01 1 1  ON 23
 eO_4                 5.271495e-01 1 1  ON 24
 eO_5                 4.884785e-01 1 1  ON 25
 eO_6                 2.596058e-01 1 1  ON 26
 eO_7                -4.213054e-02 1 1  ON 27
 eO_8                -2.231494e-01 1 1  ON 28
 eO_9                -8.244448e-02 1 1  ON 29
eH1_0                -2.506738e-01 1 1  ON 30
eH1_1                -1.468439e-01 1 1  ON 31
eH1_2                -1.025454e-01 1 1  ON 32
eH1_3                -5.068081e-02 1 1  ON 33
eH1_4                 5.882140e-04 1 1  ON 34
eH1_5                 3.532689e-02 1 1  ON 35
eH1_6                 9.841137e-02 1 1  ON 36
eH1_7                 1.555960e-01 1 1  ON 37
eH1_8                 1.848267e-01 1 1  ON 38
eH1_9                 7.497160e-02 1 1  ON 39
eH2_0                -2.439639e-01 1 1  ON 40
eH2_1                -1.404448e-01 1 1  ON 41
eH2_2                -9.579935e-02 1 1  ON 42
eH2_3                -4.434800e-02 1 1  ON 43
eH2_4                 7.153697e-03 1 1  ON 44
eH2_5                 4.147909e-02 1 1  ON 45
eH2_6                 1.017482e-01 1 1  ON 46
eH2_7                 1.568447e-01 1 1  ON 47
eH2_8                 1.834062e-01 1 1  ON 48
eH2_9                 5.126036e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9644
    reference variance = 0.241543
====================================================
  Execution time = 2.4210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2775e-01
  Total weights = 2.0000e+06
  Execution time = 2.7118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327690294948
                                         uncertainty =       0.002596894795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327690294948
                                         uncertainty =       0.002596894795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404718113
  error estimate for blocks of size 2^( 2) =       0.000416762866
  error estimate for blocks of size 2^( 3) =       0.000429280732
  error estimate for blocks of size 2^( 4) =       0.000441508686
  error estimate for blocks of size 2^( 5) =       0.000451459583
  error estimate for blocks of size 2^( 6) =       0.000459905256
  error estimate for blocks of size 2^( 7) =       0.000465395057

      target function =                  N/A
              le_mean =     -16.910233689075
             les_mean =     286.283596757287
             stat err =       0.000454567146
             autocorr =       1.261510308194
              std dev =       0.572357844322
             le_variance =       0.327593501957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328036058172
                                         uncertainty =       0.002599329407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328036058172
                                         uncertainty =       0.002599329407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404931441
  error estimate for blocks of size 2^( 2) =       0.000416968997
  error estimate for blocks of size 2^( 3) =       0.000429469510
  error estimate for blocks of size 2^( 4) =       0.000441674109
  error estimate for blocks of size 2^( 5) =       0.000451605126
  error estimate for blocks of size 2^( 6) =       0.000460048995
  error estimate for blocks of size 2^( 7) =       0.000465534383

      target function =                  N/A
              le_mean =     -16.910233855831
             les_mean =     286.283947838779
             stat err =       0.000454715653
             autocorr =       1.261005009666
              std dev =       0.572659535710
             le_variance =       0.327938943840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328007684328
                                         uncertainty =       0.002599264462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328007684328
                                         uncertainty =       0.002599264462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404913894
  error estimate for blocks of size 2^( 2) =       0.000416954545
  error estimate for blocks of size 2^( 3) =       0.000429462063
  error estimate for blocks of size 2^( 4) =       0.000441676047
  error estimate for blocks of size 2^( 5) =       0.000451609302
  error estimate for blocks of size 2^( 6) =       0.000460062771
  error estimate for blocks of size 2^( 7) =       0.000465540103

      target function =                  N/A
              le_mean =     -16.910232177019
             les_mean =     286.283862639465
             stat err =       0.000454722056
             autocorr =       1.261149817170
              std dev =       0.572634720173
             le_variance =       0.327910522748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327753508978
                                         uncertainty =       0.002597464717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327753508978
                                         uncertainty =       0.002597464717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404757111
  error estimate for blocks of size 2^( 2) =       0.000416801457
  error estimate for blocks of size 2^( 3) =       0.000429317945
  error estimate for blocks of size 2^( 4) =       0.000441544394
  error estimate for blocks of size 2^( 5) =       0.000451491765
  error estimate for blocks of size 2^( 6) =       0.000459939855
  error estimate for blocks of size 2^( 7) =       0.000465425354

      target function =                  N/A
              le_mean =     -16.910232519385
             les_mean =     286.283620334098
             stat err =       0.000454600342
             autocorr =       1.261451451664
              std dev =       0.572412996232
             le_variance =       0.327656638255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910233689075        initial
     3.9062e-02     3.9062e-01             4.8005e-03       -16.910233855831  <--
     1.5625e-01     1.5625e+00             1.2071e-03       -16.910232177019
     6.2500e-01     6.2500e+00             3.5437e-04       -16.910232519385

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.7933e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.082764e-01 1 1  ON 0
 uu_1                 1.425928e-01 1 1  ON 1
 uu_2                 4.394612e-02 1 1  ON 2
 uu_3                -1.958345e-02 1 1  ON 3
 uu_4                -6.817247e-02 1 1  ON 4
 uu_5                -1.035748e-01 1 1  ON 5
 uu_6                -1.294475e-01 1 1  ON 6
 uu_7                -1.414945e-01 1 1  ON 7
 uu_8                -1.331232e-01 1 1  ON 8
 uu_9                -1.057135e-01 1 1  ON 9
 ud_0                 4.374762e-01 1 1  ON 10
 ud_1                 1.797572e-01 1 1  ON 11
 ud_2                 6.562272e-02 1 1  ON 12
 ud_3                -3.438437e-03 1 1  ON 13
 ud_4                -5.901555e-02 1 1  ON 14
 ud_5                -1.019816e-01 1 1  ON 15
 ud_6                -1.320238e-01 1 1  ON 16
 ud_7                -1.529463e-01 1 1  ON 17
 ud_8                -1.572201e-01 1 1  ON 18
 ud_9                -1.467884e-01 1 1  ON 19
 eO_0                -7.598678e-01 1 1  ON 20
 eO_1                -4.433401e-01 1 1  ON 21
 eO_2                -2.503290e-02 1 1  ON 22
 eO_3                 3.001813e-01 1 1  ON 23
 eO_4                 5.290731e-01 1 1  ON 24
 eO_5                 4.907078e-01 1 1  ON 25
 eO_6                 2.606266e-01 1 1  ON 26
 eO_7                -4.191592e-02 1 1  ON 27
 eO_8                -2.252487e-01 1 1  ON 28
 eO_9                -8.496646e-02 1 1  ON 29
eH1_0                -2.521839e-01 1 1  ON 30
eH1_1                -1.483921e-01 1 1  ON 31
eH1_2                -1.040205e-01 1 1  ON 32
eH1_3                -5.209949e-02 1 1  ON 33
eH1_4                -5.141690e-04 1 1  ON 34
eH1_5                 3.429147e-02 1 1  ON 35
eH1_6                 9.864060e-02 1 1  ON 36
eH1_7                 1.572775e-01 1 1  ON 37
eH1_8                 1.868607e-01 1 1  ON 38
eH1_9                 7.856493e-02 1 1  ON 39
eH2_0                -2.452990e-01 1 1  ON 40
eH2_1                -1.411559e-01 1 1  ON 41
eH2_2                -9.637990e-02 1 1  ON 42
eH2_3                -4.488293e-02 1 1  ON 43
eH2_4                 6.589457e-03 1 1  ON 44
eH2_5                 4.083145e-02 1 1  ON 45
eH2_6                 1.008561e-01 1 1  ON 46
eH2_7                 1.568254e-01 1 1  ON 47
eH2_8                 1.852653e-01 1 1  ON 48
eH2_9                 5.473224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9093
    reference variance = 0.213823
====================================================
  Execution time = 2.6729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3477e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821594170
                                         uncertainty =       0.006797690413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821594170
                                         uncertainty =       0.006797690413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409124865
  error estimate for blocks of size 2^( 2) =       0.000421092730
  error estimate for blocks of size 2^( 3) =       0.000432721660
  error estimate for blocks of size 2^( 4) =       0.000444213308
  error estimate for blocks of size 2^( 5) =       0.000453441737
  error estimate for blocks of size 2^( 6) =       0.000459844131
  error estimate for blocks of size 2^( 7) =       0.000463105316

      target function =                  N/A
              le_mean =     -16.910446614753
             les_mean =     286.297970852670
             stat err =       0.000455151123
             autocorr =       1.237654677403
              std dev =       0.578589932203
             le_variance =       0.334766309646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044661475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446614753       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910447860284       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910448097872       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910449310653       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910453023910       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910456923375       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910462020013       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910461920912       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910466858609       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910471417599       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910474990953       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910477991059       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910476511539       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910477637797       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910479703419       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910477737480       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910477357265       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910478005336       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910477737691       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910477598346       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910477949064       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910477433412       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.457649e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446614753       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910447726286       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910447865336       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910448482800       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910451683983       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910453638389       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910456659271       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910456318043       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910457961183       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910458912754       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910458864671       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910459098058       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910458519500       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910458667669       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910458900080       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.125067e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446614753       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910447391867       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910447397911       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910447384295       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910448928344       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910449249811       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910450331377       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910450817499       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910450666121       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910450679008       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910450594456       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.512629e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3086e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.084296e-01 1 1  ON 0
 uu_1                 1.422415e-01 1 1  ON 1
 uu_2                 4.378830e-02 1 1  ON 2
 uu_3                -1.975074e-02 1 1  ON 3
 uu_4                -6.866994e-02 1 1  ON 4
 uu_5                -1.035629e-01 1 1  ON 5
 uu_6                -1.298302e-01 1 1  ON 6
 uu_7                -1.424165e-01 1 1  ON 7
 uu_8                -1.339433e-01 1 1  ON 8
 uu_9                -1.062374e-01 1 1  ON 9
 ud_0                 4.382281e-01 1 1  ON 10
 ud_1                 1.803828e-01 1 1  ON 11
 ud_2                 6.615848e-02 1 1  ON 12
 ud_3                -3.245295e-03 1 1  ON 13
 ud_4                -5.908472e-02 1 1  ON 14
 ud_5                -1.020898e-01 1 1  ON 15
 ud_6                -1.322446e-01 1 1  ON 16
 ud_7                -1.519004e-01 1 1  ON 17
 ud_8                -1.557443e-01 1 1  ON 18
 ud_9                -1.481644e-01 1 1  ON 19
 eO_0                -7.603198e-01 1 1  ON 20
 eO_1                -4.435676e-01 1 1  ON 21
 eO_2                -2.463795e-02 1 1  ON 22
 eO_3                 3.019403e-01 1 1  ON 23
 eO_4                 5.298668e-01 1 1  ON 24
 eO_5                 4.919799e-01 1 1  ON 25
 eO_6                 2.632563e-01 1 1  ON 26
 eO_7                -4.117447e-02 1 1  ON 27
 eO_8                -2.273338e-01 1 1  ON 28
 eO_9                -8.883463e-02 1 1  ON 29
eH1_0                -2.533453e-01 1 1  ON 30
eH1_1                -1.495887e-01 1 1  ON 31
eH1_2                -1.046351e-01 1 1  ON 32
eH1_3                -5.310490e-02 1 1  ON 33
eH1_4                -1.183473e-03 1 1  ON 34
eH1_5                 3.378290e-02 1 1  ON 35
eH1_6                 9.715347e-02 1 1  ON 36
eH1_7                 1.568152e-01 1 1  ON 37
eH1_8                 1.883864e-01 1 1  ON 38
eH1_9                 8.320756e-02 1 1  ON 39
eH2_0                -2.472162e-01 1 1  ON 40
eH2_1                -1.432052e-01 1 1  ON 41
eH2_2                -9.844951e-02 1 1  ON 42
eH2_3                -4.693014e-02 1 1  ON 43
eH2_4                 4.547813e-03 1 1  ON 44
eH2_5                 3.931038e-02 1 1  ON 45
eH2_6                 1.008871e-01 1 1  ON 46
eH2_7                 1.583991e-01 1 1  ON 47
eH2_8                 1.890688e-01 1 1  ON 48
eH2_9                 6.085730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.325671
====================================================
  Execution time = 2.3846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2213e-01
  Total weights = 2.0000e+06
  Execution time = 2.7033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321995813928
                                         uncertainty =       0.002611001505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321995813928
                                         uncertainty =       0.002611001505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401208054
  error estimate for blocks of size 2^( 2) =       0.000413451129
  error estimate for blocks of size 2^( 3) =       0.000425916877
  error estimate for blocks of size 2^( 4) =       0.000438623377
  error estimate for blocks of size 2^( 5) =       0.000450538725
  error estimate for blocks of size 2^( 6) =       0.000459803732
  error estimate for blocks of size 2^( 7) =       0.000466827548

      target function =                  N/A
              le_mean =     -16.910617843425
             les_mean =     286.290931490891
             stat err =       0.000453948345
             autocorr =       1.280187520841
              std dev =       0.567393871563
             le_variance =       0.321935805487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322386538198
                                         uncertainty =       0.002615429276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322386538198
                                         uncertainty =       0.002615429276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401451515
  error estimate for blocks of size 2^( 2) =       0.000413689247
  error estimate for blocks of size 2^( 3) =       0.000426135409
  error estimate for blocks of size 2^( 4) =       0.000438808213
  error estimate for blocks of size 2^( 5) =       0.000450685901
  error estimate for blocks of size 2^( 6) =       0.000459901030
  error estimate for blocks of size 2^( 7) =       0.000466898462

      target function =                  N/A
              le_mean =     -16.910618613449
             les_mean =     286.291348365838
             stat err =       0.000454073402
             autocorr =       1.279339837264
              std dev =       0.567738176863
             le_variance =       0.322326637468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322399584756
                                         uncertainty =       0.002616572152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322399584756
                                         uncertainty =       0.002616572152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401459642
  error estimate for blocks of size 2^( 2) =       0.000413702006
  error estimate for blocks of size 2^( 3) =       0.000426159196
  error estimate for blocks of size 2^( 4) =       0.000438842048
  error estimate for blocks of size 2^( 5) =       0.000450728579
  error estimate for blocks of size 2^( 6) =       0.000459943611
  error estimate for blocks of size 2^( 7) =       0.000466956635

      target function =                  N/A
              le_mean =     -16.910619846793
             les_mean =     286.291403129777
             stat err =       0.000454117718
             autocorr =       1.279537764391
              std dev =       0.567749670366
             le_variance =       0.322339688201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322075248285
                                         uncertainty =       0.002612562499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322075248285
                                         uncertainty =       0.002612562499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401257563
  error estimate for blocks of size 2^( 2) =       0.000413500694
  error estimate for blocks of size 2^( 3) =       0.000425965166
  error estimate for blocks of size 2^( 4) =       0.000438666122
  error estimate for blocks of size 2^( 5) =       0.000450576699
  error estimate for blocks of size 2^( 6) =       0.000459829874
  error estimate for blocks of size 2^( 7) =       0.000466854386

      target function =                  N/A
              le_mean =     -16.910615889547
             les_mean =     286.290944865745
             stat err =       0.000453981770
             autocorr =       1.280060117778
              std dev =       0.567463886928
             le_variance =       0.322015262968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910617843425        initial
     9.7656e-03     9.7656e-02             2.4576e-02       -16.910618613449
     3.9062e-02     3.9062e-01             6.1251e-03       -16.910619846793  <--
     1.5625e-01     1.5625e+00             1.5126e-03       -16.910615889547

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.7438e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.084296e-01 1 1  ON 0
 uu_1                 1.422415e-01 1 1  ON 1
 uu_2                 4.378830e-02 1 1  ON 2
 uu_3                -1.975074e-02 1 1  ON 3
 uu_4                -6.866994e-02 1 1  ON 4
 uu_5                -1.035629e-01 1 1  ON 5
 uu_6                -1.298302e-01 1 1  ON 6
 uu_7                -1.424165e-01 1 1  ON 7
 uu_8                -1.339433e-01 1 1  ON 8
 uu_9                -1.062374e-01 1 1  ON 9
 ud_0                 4.382281e-01 1 1  ON 10
 ud_1                 1.803828e-01 1 1  ON 11
 ud_2                 6.615848e-02 1 1  ON 12
 ud_3                -3.245295e-03 1 1  ON 13
 ud_4                -5.908472e-02 1 1  ON 14
 ud_5                -1.020898e-01 1 1  ON 15
 ud_6                -1.322446e-01 1 1  ON 16
 ud_7                -1.519004e-01 1 1  ON 17
 ud_8                -1.557443e-01 1 1  ON 18
 ud_9                -1.481644e-01 1 1  ON 19
 eO_0                -7.603198e-01 1 1  ON 20
 eO_1                -4.435676e-01 1 1  ON 21
 eO_2                -2.463795e-02 1 1  ON 22
 eO_3                 3.019403e-01 1 1  ON 23
 eO_4                 5.298668e-01 1 1  ON 24
 eO_5                 4.919799e-01 1 1  ON 25
 eO_6                 2.632563e-01 1 1  ON 26
 eO_7                -4.117447e-02 1 1  ON 27
 eO_8                -2.273338e-01 1 1  ON 28
 eO_9                -8.883463e-02 1 1  ON 29
eH1_0                -2.533453e-01 1 1  ON 30
eH1_1                -1.495887e-01 1 1  ON 31
eH1_2                -1.046351e-01 1 1  ON 32
eH1_3                -5.310490e-02 1 1  ON 33
eH1_4                -1.183473e-03 1 1  ON 34
eH1_5                 3.378290e-02 1 1  ON 35
eH1_6                 9.715347e-02 1 1  ON 36
eH1_7                 1.568152e-01 1 1  ON 37
eH1_8                 1.883864e-01 1 1  ON 38
eH1_9                 8.320756e-02 1 1  ON 39
eH2_0                -2.472162e-01 1 1  ON 40
eH2_1                -1.432052e-01 1 1  ON 41
eH2_2                -9.844951e-02 1 1  ON 42
eH2_3                -4.693014e-02 1 1  ON 43
eH2_4                 4.547813e-03 1 1  ON 44
eH2_5                 3.931038e-02 1 1  ON 45
eH2_6                 1.008871e-01 1 1  ON 46
eH2_7                 1.583991e-01 1 1  ON 47
eH2_8                 1.890688e-01 1 1  ON 48
eH2_9                 6.085730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.249645
====================================================
  Execution time = 2.4346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3396e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334006324933
                                         uncertainty =       0.004264925107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334006324933
                                         uncertainty =       0.004264925107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408630429
  error estimate for blocks of size 2^( 2) =       0.000420462468
  error estimate for blocks of size 2^( 3) =       0.000432200645
  error estimate for blocks of size 2^( 4) =       0.000443418216
  error estimate for blocks of size 2^( 5) =       0.000452867160
  error estimate for blocks of size 2^( 6) =       0.000461181037
  error estimate for blocks of size 2^( 7) =       0.000465612034

      target function =                  N/A
              le_mean =     -16.910586950991
             les_mean =     286.301908514304
             stat err =       0.000455769612
             autocorr =       1.244025620216
              std dev =       0.577890694047
             le_variance =       0.333957654266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691058695099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586950991       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910589687519       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910592033897       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910593473182       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910593843890       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910593165329       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910594060847       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910591961745       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910593477662       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910596125007       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910602035357       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910603469469       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910604452034       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910606734120       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910604355968       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910604255802       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910605442399       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910605490454       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910606075978       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910606616330       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.964901e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586950991       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910589410802       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910591300153       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910592446369       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910592733804       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910592148477       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910592832428       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910591656662       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910592291518       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910592908648       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910594338604       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910594766415       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910594682558       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910595048430       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.138183e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586950991       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910588702394       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910589813658       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910590514409       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910590861034       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910590776876       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910590964988       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910590616785       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910590536406       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910590812739       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.288077e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0780e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.090277e-01 1 1  ON 0
 uu_1                 1.430900e-01 1 1  ON 1
 uu_2                 4.445271e-02 1 1  ON 2
 uu_3                -1.952517e-02 1 1  ON 3
 uu_4                -6.874684e-02 1 1  ON 4
 uu_5                -1.045356e-01 1 1  ON 5
 uu_6                -1.309940e-01 1 1  ON 6
 uu_7                -1.436572e-01 1 1  ON 7
 uu_8                -1.353272e-01 1 1  ON 8
 uu_9                -1.070502e-01 1 1  ON 9
 ud_0                 4.382891e-01 1 1  ON 10
 ud_1                 1.804600e-01 1 1  ON 11
 ud_2                 6.642588e-02 1 1  ON 12
 ud_3                -2.852974e-03 1 1  ON 13
 ud_4                -5.879474e-02 1 1  ON 14
 ud_5                -1.015667e-01 1 1  ON 15
 ud_6                -1.317037e-01 1 1  ON 16
 ud_7                -1.519039e-01 1 1  ON 17
 ud_8                -1.556674e-01 1 1  ON 18
 ud_9                -1.472219e-01 1 1  ON 19
 eO_0                -7.602685e-01 1 1  ON 20
 eO_1                -4.434125e-01 1 1  ON 21
 eO_2                -2.450370e-02 1 1  ON 22
 eO_3                 3.028981e-01 1 1  ON 23
 eO_4                 5.315262e-01 1 1  ON 24
 eO_5                 4.937597e-01 1 1  ON 25
 eO_6                 2.639704e-01 1 1  ON 26
 eO_7                -4.043434e-02 1 1  ON 27
 eO_8                -2.294184e-01 1 1  ON 28
 eO_9                -9.227785e-02 1 1  ON 29
eH1_0                -2.538722e-01 1 1  ON 30
eH1_1                -1.508231e-01 1 1  ON 31
eH1_2                -1.062418e-01 1 1  ON 32
eH1_3                -5.406857e-02 1 1  ON 33
eH1_4                -2.842312e-03 1 1  ON 34
eH1_5                 3.276982e-02 1 1  ON 35
eH1_6                 9.746566e-02 1 1  ON 36
eH1_7                 1.578011e-01 1 1  ON 37
eH1_8                 1.903574e-01 1 1  ON 38
eH1_9                 8.668545e-02 1 1  ON 39
eH2_0                -2.490111e-01 1 1  ON 40
eH2_1                -1.450463e-01 1 1  ON 41
eH2_2                -1.001251e-01 1 1  ON 42
eH2_3                -4.812532e-02 1 1  ON 43
eH2_4                 3.768584e-03 1 1  ON 44
eH2_5                 3.870056e-02 1 1  ON 45
eH2_6                 1.000062e-01 1 1  ON 46
eH2_7                 1.584129e-01 1 1  ON 47
eH2_8                 1.916325e-01 1 1  ON 48
eH2_9                 6.599549e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8034
    reference variance = 0.554475
====================================================
  Execution time = 2.3903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3178e-01
  Total weights = 2.0000e+06
  Execution time = 2.6996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331698163506
                                         uncertainty =       0.003344776410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331698163506
                                         uncertainty =       0.003344776410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407249401
  error estimate for blocks of size 2^( 2) =       0.000418402821
  error estimate for blocks of size 2^( 3) =       0.000430572254
  error estimate for blocks of size 2^( 4) =       0.000441952380
  error estimate for blocks of size 2^( 5) =       0.000452496672
  error estimate for blocks of size 2^( 6) =       0.000460603829
  error estimate for blocks of size 2^( 7) =       0.000465779094

      target function =                  N/A
              le_mean =     -16.910161290754
             les_mean =     286.285258861927
             stat err =       0.000455207994
             autocorr =       1.249392379806
              std dev =       0.575937625484
             le_variance =       0.331704148448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331929578850
                                         uncertainty =       0.003344205455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331929578850
                                         uncertainty =       0.003344205455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407391339
  error estimate for blocks of size 2^( 2) =       0.000418538647
  error estimate for blocks of size 2^( 3) =       0.000430686158
  error estimate for blocks of size 2^( 4) =       0.000442039641
  error estimate for blocks of size 2^( 5) =       0.000452562455
  error estimate for blocks of size 2^( 6) =       0.000460649951
  error estimate for blocks of size 2^( 7) =       0.000465822689

      target function =                  N/A
              le_mean =     -16.910156817610
             les_mean =     286.285338835602
             stat err =       0.000455268684
             autocorr =       1.248854875000
              std dev =       0.576138356143
             le_variance =       0.331935405419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331875175206
                                         uncertainty =       0.003344376357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331875175206
                                         uncertainty =       0.003344376357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407357938
  error estimate for blocks of size 2^( 2) =       0.000418508761
  error estimate for blocks of size 2^( 3) =       0.000430658200
  error estimate for blocks of size 2^( 4) =       0.000442021500
  error estimate for blocks of size 2^( 5) =       0.000452552190
  error estimate for blocks of size 2^( 6) =       0.000460638440
  error estimate for blocks of size 2^( 7) =       0.000465824438

      target function =                  N/A
              le_mean =     -16.910157484453
             les_mean =     286.285306962005
             stat err =       0.000455259142
             autocorr =       1.249007322928
              std dev =       0.576091120350
             le_variance =       0.331880978946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331710743498
                                         uncertainty =       0.003344343839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331710743498
                                         uncertainty =       0.003344343839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407257082
  error estimate for blocks of size 2^( 2) =       0.000418408759
  error estimate for blocks of size 2^( 3) =       0.000430572123
  error estimate for blocks of size 2^( 4) =       0.000441949335
  error estimate for blocks of size 2^( 5) =       0.000452491129
  error estimate for blocks of size 2^( 6) =       0.000460593106
  error estimate for blocks of size 2^( 7) =       0.000465772514

      target function =                  N/A
              le_mean =     -16.910158886015
             les_mean =     286.285190046030
             stat err =       0.000455201521
             autocorr =       1.249309718829
              std dev =       0.575948488672
             le_variance =       0.331716661604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910161290754        initial  <--
     9.7656e-03     9.7656e-02             1.9649e-02       -16.910156817610
     3.9062e-02     3.9062e-01             5.1382e-03       -16.910157484453
     1.5625e-01     1.5625e+00             1.2881e-03       -16.910158886015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4788
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.084296e-01 1 1  ON 0
 uu_1                 1.422415e-01 1 1  ON 1
 uu_2                 4.378830e-02 1 1  ON 2
 uu_3                -1.975074e-02 1 1  ON 3
 uu_4                -6.866994e-02 1 1  ON 4
 uu_5                -1.035629e-01 1 1  ON 5
 uu_6                -1.298302e-01 1 1  ON 6
 uu_7                -1.424165e-01 1 1  ON 7
 uu_8                -1.339433e-01 1 1  ON 8
 uu_9                -1.062374e-01 1 1  ON 9
 ud_0                 4.382281e-01 1 1  ON 10
 ud_1                 1.803828e-01 1 1  ON 11
 ud_2                 6.615848e-02 1 1  ON 12
 ud_3                -3.245295e-03 1 1  ON 13
 ud_4                -5.908472e-02 1 1  ON 14
 ud_5                -1.020898e-01 1 1  ON 15
 ud_6                -1.322446e-01 1 1  ON 16
 ud_7                -1.519004e-01 1 1  ON 17
 ud_8                -1.557443e-01 1 1  ON 18
 ud_9                -1.481644e-01 1 1  ON 19
 eO_0                -7.603198e-01 1 1  ON 20
 eO_1                -4.435676e-01 1 1  ON 21
 eO_2                -2.463795e-02 1 1  ON 22
 eO_3                 3.019403e-01 1 1  ON 23
 eO_4                 5.298668e-01 1 1  ON 24
 eO_5                 4.919799e-01 1 1  ON 25
 eO_6                 2.632563e-01 1 1  ON 26
 eO_7                -4.117447e-02 1 1  ON 27
 eO_8                -2.273338e-01 1 1  ON 28
 eO_9                -8.883463e-02 1 1  ON 29
eH1_0                -2.533453e-01 1 1  ON 30
eH1_1                -1.495887e-01 1 1  ON 31
eH1_2                -1.046351e-01 1 1  ON 32
eH1_3                -5.310490e-02 1 1  ON 33
eH1_4                -1.183473e-03 1 1  ON 34
eH1_5                 3.378290e-02 1 1  ON 35
eH1_6                 9.715347e-02 1 1  ON 36
eH1_7                 1.568152e-01 1 1  ON 37
eH1_8                 1.883864e-01 1 1  ON 38
eH1_9                 8.320756e-02 1 1  ON 39
eH2_0                -2.472162e-01 1 1  ON 40
eH2_1                -1.432052e-01 1 1  ON 41
eH2_2                -9.844951e-02 1 1  ON 42
eH2_3                -4.693014e-02 1 1  ON 43
eH2_4                 4.547813e-03 1 1  ON 44
eH2_5                 3.931038e-02 1 1  ON 45
eH2_6                 1.008871e-01 1 1  ON 46
eH2_7                 1.583991e-01 1 1  ON 47
eH2_8                 1.890688e-01 1 1  ON 48
eH2_9                 6.085730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.313272
====================================================
  Execution time = 2.4361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328405067476
                                         uncertainty =       0.003538797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328405067476
                                         uncertainty =       0.003538797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405173987
  error estimate for blocks of size 2^( 2) =       0.000416495970
  error estimate for blocks of size 2^( 3) =       0.000428367243
  error estimate for blocks of size 2^( 4) =       0.000439444382
  error estimate for blocks of size 2^( 5) =       0.000449009324
  error estimate for blocks of size 2^( 6) =       0.000455492324
  error estimate for blocks of size 2^( 7) =       0.000462687964

      target function =                  N/A
              le_mean =     -16.911186553736
             les_mean =     286.316562411191
             stat err =       0.000451658499
             autocorr =       1.242616918178
              std dev =       0.573002548083
             le_variance =       0.328331920110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691118655374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911186553736       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911189117569       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911189045590       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911187957844       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911188602077       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187731216       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911189712793       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911191373465       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911190996649       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911191025739       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911191109650       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911190631834       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.423006e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911186553736       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911187833060       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911187574219       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911187196354       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911187711246       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187740433       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911188018143       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911188244825       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911188126998       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.989108e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911186553736       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911186979603       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911186851012       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911186767962       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911186944418       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187014887       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911187122711       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911187107892       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.496496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0678e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.083816e-01 1 1  ON 0
 uu_1                 1.424458e-01 1 1  ON 1
 uu_2                 4.385050e-02 1 1  ON 2
 uu_3                -1.967994e-02 1 1  ON 3
 uu_4                -6.853487e-02 1 1  ON 4
 uu_5                -1.035372e-01 1 1  ON 5
 uu_6                -1.298493e-01 1 1  ON 6
 uu_7                -1.424149e-01 1 1  ON 7
 uu_8                -1.341787e-01 1 1  ON 8
 uu_9                -1.065884e-01 1 1  ON 9
 ud_0                 4.383302e-01 1 1  ON 10
 ud_1                 1.805355e-01 1 1  ON 11
 ud_2                 6.620893e-02 1 1  ON 12
 ud_3                -3.105568e-03 1 1  ON 13
 ud_4                -5.909233e-02 1 1  ON 14
 ud_5                -1.019636e-01 1 1  ON 15
 ud_6                -1.320669e-01 1 1  ON 16
 ud_7                -1.518724e-01 1 1  ON 17
 ud_8                -1.559147e-01 1 1  ON 18
 ud_9                -1.484567e-01 1 1  ON 19
 eO_0                -7.604774e-01 1 1  ON 20
 eO_1                -4.434746e-01 1 1  ON 21
 eO_2                -2.459145e-02 1 1  ON 22
 eO_3                 3.022295e-01 1 1  ON 23
 eO_4                 5.299177e-01 1 1  ON 24
 eO_5                 4.921184e-01 1 1  ON 25
 eO_6                 2.634722e-01 1 1  ON 26
 eO_7                -4.094496e-02 1 1  ON 27
 eO_8                -2.277733e-01 1 1  ON 28
 eO_9                -8.924331e-02 1 1  ON 29
eH1_0                -2.535977e-01 1 1  ON 30
eH1_1                -1.497592e-01 1 1  ON 31
eH1_2                -1.046735e-01 1 1  ON 32
eH1_3                -5.301785e-02 1 1  ON 33
eH1_4                -1.416145e-03 1 1  ON 34
eH1_5                 3.394016e-02 1 1  ON 35
eH1_6                 9.703353e-02 1 1  ON 36
eH1_7                 1.568431e-01 1 1  ON 37
eH1_8                 1.886394e-01 1 1  ON 38
eH1_9                 8.350079e-02 1 1  ON 39
eH2_0                -2.474503e-01 1 1  ON 40
eH2_1                -1.433928e-01 1 1  ON 41
eH2_2                -9.870547e-02 1 1  ON 42
eH2_3                -4.678508e-02 1 1  ON 43
eH2_4                 4.410585e-03 1 1  ON 44
eH2_5                 3.898244e-02 1 1  ON 45
eH2_6                 1.007367e-01 1 1  ON 46
eH2_7                 1.584385e-01 1 1  ON 47
eH2_8                 1.894903e-01 1 1  ON 48
eH2_9                 6.145621e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8632
    reference variance = 0.252218
====================================================
  Execution time = 2.3885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3715e-01
  Total weights = 2.0000e+06
  Execution time = 2.7065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337126070015
                                         uncertainty =       0.005476308873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337126070015
                                         uncertainty =       0.005476308873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410578706
  error estimate for blocks of size 2^( 2) =       0.000422413061
  error estimate for blocks of size 2^( 3) =       0.000434482291
  error estimate for blocks of size 2^( 4) =       0.000445913312
  error estimate for blocks of size 2^( 5) =       0.000456105071
  error estimate for blocks of size 2^( 6) =       0.000462883523
  error estimate for blocks of size 2^( 7) =       0.000466346219

      target function =                  N/A
              le_mean =     -16.910202631113
             les_mean =     286.292102604711
             stat err =       0.000457812031
             autocorr =       1.243316105779
              std dev =       0.580645974753
             le_variance =       0.337149747996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337130628816
                                         uncertainty =       0.005473559613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337130628816
                                         uncertainty =       0.005473559613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410581512
  error estimate for blocks of size 2^( 2) =       0.000422409682
  error estimate for blocks of size 2^( 3) =       0.000434471395
  error estimate for blocks of size 2^( 4) =       0.000445899032
  error estimate for blocks of size 2^( 5) =       0.000456084974
  error estimate for blocks of size 2^( 6) =       0.000462848550
  error estimate for blocks of size 2^( 7) =       0.000466323101

      target function =                  N/A
              le_mean =     -16.910200396446
             les_mean =     286.292031634977
             stat err =       0.000457788914
             autocorr =       1.243173559863
              std dev =       0.580649942373
             le_variance =       0.337154355578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337137429838
                                         uncertainty =       0.005473336258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337137429838
                                         uncertainty =       0.005473336258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410585630
  error estimate for blocks of size 2^( 2) =       0.000422413936
  error estimate for blocks of size 2^( 3) =       0.000434475970
  error estimate for blocks of size 2^( 4) =       0.000445905473
  error estimate for blocks of size 2^( 5) =       0.000456091869
  error estimate for blocks of size 2^( 6) =       0.000462854710
  error estimate for blocks of size 2^( 7) =       0.000466327662

      target function =                  N/A
              le_mean =     -16.910201004859
             les_mean =     286.292058976070
             stat err =       0.000457794928
             autocorr =       1.243181281273
              std dev =       0.580655767147
             le_variance =       0.337161119921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337121259792
                                         uncertainty =       0.005475668845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337121259792
                                         uncertainty =       0.005475668845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410575777
  error estimate for blocks of size 2^( 2) =       0.000422409079
  error estimate for blocks of size 2^( 3) =       0.000434477021
  error estimate for blocks of size 2^( 4) =       0.000445908054
  error estimate for blocks of size 2^( 5) =       0.000456098789
  error estimate for blocks of size 2^( 6) =       0.000462874238
  error estimate for blocks of size 2^( 7) =       0.000466338532

      target function =                  N/A
              le_mean =     -16.910202230599
             les_mean =     286.292084248465
             stat err =       0.000457804903
             autocorr =       1.243295131381
              std dev =       0.580641832173
             le_variance =       0.337144937270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910202631113        initial  <--
     9.7656e-02     9.7656e-01             2.4230e-03       -16.910200396446
     3.9062e-01     3.9062e+00             5.9891e-04       -16.910201004859
     1.5625e+00     1.5625e+01             1.4965e-04       -16.910202230599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4847
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.084296e-01 1 1  ON 0
 uu_1                 1.422415e-01 1 1  ON 1
 uu_2                 4.378830e-02 1 1  ON 2
 uu_3                -1.975074e-02 1 1  ON 3
 uu_4                -6.866994e-02 1 1  ON 4
 uu_5                -1.035629e-01 1 1  ON 5
 uu_6                -1.298302e-01 1 1  ON 6
 uu_7                -1.424165e-01 1 1  ON 7
 uu_8                -1.339433e-01 1 1  ON 8
 uu_9                -1.062374e-01 1 1  ON 9
 ud_0                 4.382281e-01 1 1  ON 10
 ud_1                 1.803828e-01 1 1  ON 11
 ud_2                 6.615848e-02 1 1  ON 12
 ud_3                -3.245295e-03 1 1  ON 13
 ud_4                -5.908472e-02 1 1  ON 14
 ud_5                -1.020898e-01 1 1  ON 15
 ud_6                -1.322446e-01 1 1  ON 16
 ud_7                -1.519004e-01 1 1  ON 17
 ud_8                -1.557443e-01 1 1  ON 18
 ud_9                -1.481644e-01 1 1  ON 19
 eO_0                -7.603198e-01 1 1  ON 20
 eO_1                -4.435676e-01 1 1  ON 21
 eO_2                -2.463795e-02 1 1  ON 22
 eO_3                 3.019403e-01 1 1  ON 23
 eO_4                 5.298668e-01 1 1  ON 24
 eO_5                 4.919799e-01 1 1  ON 25
 eO_6                 2.632563e-01 1 1  ON 26
 eO_7                -4.117447e-02 1 1  ON 27
 eO_8                -2.273338e-01 1 1  ON 28
 eO_9                -8.883463e-02 1 1  ON 29
eH1_0                -2.533453e-01 1 1  ON 30
eH1_1                -1.495887e-01 1 1  ON 31
eH1_2                -1.046351e-01 1 1  ON 32
eH1_3                -5.310490e-02 1 1  ON 33
eH1_4                -1.183473e-03 1 1  ON 34
eH1_5                 3.378290e-02 1 1  ON 35
eH1_6                 9.715347e-02 1 1  ON 36
eH1_7                 1.568152e-01 1 1  ON 37
eH1_8                 1.883864e-01 1 1  ON 38
eH1_9                 8.320756e-02 1 1  ON 39
eH2_0                -2.472162e-01 1 1  ON 40
eH2_1                -1.432052e-01 1 1  ON 41
eH2_2                -9.844951e-02 1 1  ON 42
eH2_3                -4.693014e-02 1 1  ON 43
eH2_4                 4.547813e-03 1 1  ON 44
eH2_5                 3.931038e-02 1 1  ON 45
eH2_6                 1.008871e-01 1 1  ON 46
eH2_7                 1.583991e-01 1 1  ON 47
eH2_8                 1.890688e-01 1 1  ON 48
eH2_9                 6.085730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.165166
====================================================
  Execution time = 2.4586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338062303733
                                         uncertainty =       0.004950344858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338062303733
                                         uncertainty =       0.004950344858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411109861
  error estimate for blocks of size 2^( 2) =       0.000422805086
  error estimate for blocks of size 2^( 3) =       0.000435123590
  error estimate for blocks of size 2^( 4) =       0.000446434093
  error estimate for blocks of size 2^( 5) =       0.000455791980
  error estimate for blocks of size 2^( 6) =       0.000462547806
  error estimate for blocks of size 2^( 7) =       0.000467524806

      target function =                  N/A
              le_mean =     -16.910987489265
             les_mean =     286.319520328533
             stat err =       0.000458074671
             autocorr =       1.241528717489
              std dev =       0.581397140927
             le_variance =       0.338022635478


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691098748926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910987489265       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910987722777       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910987881773       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910987521217       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910986869199       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910986929323       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910987237604       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910987336111       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910987335480       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.223218e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910987489265       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910987556164       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910987609045       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910987505905       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910987349135       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910987310691       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910987390496       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910987406771       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.196192e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910987489265       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910987506623       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910987520995       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910987494182       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910987456246       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910987443340       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910987462049       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910987464950       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.654925e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0850e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083955e-01 1 1  ON 0
 uu_1                 1.422723e-01 1 1  ON 1
 uu_2                 4.378289e-02 1 1  ON 2
 uu_3                -1.975949e-02 1 1  ON 3
 uu_4                -6.865232e-02 1 1  ON 4
 uu_5                -1.035501e-01 1 1  ON 5
 uu_6                -1.298445e-01 1 1  ON 6
 uu_7                -1.423875e-01 1 1  ON 7
 uu_8                -1.339498e-01 1 1  ON 8
 uu_9                -1.062643e-01 1 1  ON 9
 ud_0                 4.382426e-01 1 1  ON 10
 ud_1                 1.804008e-01 1 1  ON 11
 ud_2                 6.614976e-02 1 1  ON 12
 ud_3                -3.228118e-03 1 1  ON 13
 ud_4                -5.907725e-02 1 1  ON 14
 ud_5                -1.020831e-01 1 1  ON 15
 ud_6                -1.322515e-01 1 1  ON 16
 ud_7                -1.519180e-01 1 1  ON 17
 ud_8                -1.557451e-01 1 1  ON 18
 ud_9                -1.481681e-01 1 1  ON 19
 eO_0                -7.603817e-01 1 1  ON 20
 eO_1                -4.435266e-01 1 1  ON 21
 eO_2                -2.462430e-02 1 1  ON 22
 eO_3                 3.019413e-01 1 1  ON 23
 eO_4                 5.298984e-01 1 1  ON 24
 eO_5                 4.919834e-01 1 1  ON 25
 eO_6                 2.632696e-01 1 1  ON 26
 eO_7                -4.114226e-02 1 1  ON 27
 eO_8                -2.273618e-01 1 1  ON 28
 eO_9                -8.887531e-02 1 1  ON 29
eH1_0                -2.533666e-01 1 1  ON 30
eH1_1                -1.496004e-01 1 1  ON 31
eH1_2                -1.046624e-01 1 1  ON 32
eH1_3                -5.308315e-02 1 1  ON 33
eH1_4                -1.207178e-03 1 1  ON 34
eH1_5                 3.378967e-02 1 1  ON 35
eH1_6                 9.714782e-02 1 1  ON 36
eH1_7                 1.568252e-01 1 1  ON 37
eH1_8                 1.884058e-01 1 1  ON 38
eH1_9                 8.323770e-02 1 1  ON 39
eH2_0                -2.472304e-01 1 1  ON 40
eH2_1                -1.432300e-01 1 1  ON 41
eH2_2                -9.849365e-02 1 1  ON 42
eH2_3                -4.694435e-02 1 1  ON 43
eH2_4                 4.525559e-03 1 1  ON 44
eH2_5                 3.930951e-02 1 1  ON 45
eH2_6                 1.008902e-01 1 1  ON 46
eH2_7                 1.584168e-01 1 1  ON 47
eH2_8                 1.891063e-01 1 1  ON 48
eH2_9                 6.091228e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.944
    reference variance = 0.451449
====================================================
  Execution time = 2.3917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3362e-01
  Total weights = 2.0000e+06
  Execution time = 2.7019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333638121741
                                         uncertainty =       0.003413478671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333638121741
                                         uncertainty =       0.003413478671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408412861
  error estimate for blocks of size 2^( 2) =       0.000420049717
  error estimate for blocks of size 2^( 3) =       0.000432042969
  error estimate for blocks of size 2^( 4) =       0.000443196305
  error estimate for blocks of size 2^( 5) =       0.000453232552
  error estimate for blocks of size 2^( 6) =       0.000460262513
  error estimate for blocks of size 2^( 7) =       0.000466049774

      target function =                  N/A
              le_mean =     -16.910901501146
             les_mean =     286.312191544164
             stat err =       0.000455685286
             autocorr =       1.244890614604
              std dev =       0.577583006598
             le_variance =       0.333602129511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333713441368
                                         uncertainty =       0.003414369415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333713441368
                                         uncertainty =       0.003414369415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408458985
  error estimate for blocks of size 2^( 2) =       0.000420092246
  error estimate for blocks of size 2^( 3) =       0.000432080878
  error estimate for blocks of size 2^( 4) =       0.000443233082
  error estimate for blocks of size 2^( 5) =       0.000453265973
  error estimate for blocks of size 2^( 6) =       0.000460301658
  error estimate for blocks of size 2^( 7) =       0.000466086919

      target function =                  N/A
              le_mean =     -16.910901829362
             les_mean =     286.312278000014
             stat err =       0.000455721908
             autocorr =       1.244809535611
              std dev =       0.577648235972
             le_variance =       0.333677484521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333680226600
                                         uncertainty =       0.003413990788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333680226600
                                         uncertainty =       0.003413990788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408438650
  error estimate for blocks of size 2^( 2) =       0.000420073371
  error estimate for blocks of size 2^( 3) =       0.000432063805
  error estimate for blocks of size 2^( 4) =       0.000443216616
  error estimate for blocks of size 2^( 5) =       0.000453250815
  error estimate for blocks of size 2^( 6) =       0.000460284838
  error estimate for blocks of size 2^( 7) =       0.000466070942

      target function =                  N/A
              le_mean =     -16.910901694927
             les_mean =     286.312240231041
             stat err =       0.000455705803
             autocorr =       1.244845497347
              std dev =       0.577619478881
             le_variance =       0.333644262383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643582320
                                         uncertainty =       0.003413545613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333643582320
                                         uncertainty =       0.003413545613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408416206
  error estimate for blocks of size 2^( 2) =       0.000420052774
  error estimate for blocks of size 2^( 3) =       0.000432045646
  error estimate for blocks of size 2^( 4) =       0.000443198912
  error estimate for blocks of size 2^( 5) =       0.000453234885
  error estimate for blocks of size 2^( 6) =       0.000460265412
  error estimate for blocks of size 2^( 7) =       0.000466052517

      target function =                  N/A
              le_mean =     -16.910901522501
             les_mean =     286.312197730926
             stat err =       0.000455687931
             autocorr =       1.244884676522
              std dev =       0.577587737066
             le_variance =       0.333607594009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910901501146        initial
     9.7656e-01     9.7656e+00             2.2232e-04       -16.910901829362  <--
     3.9062e+00     3.9062e+01             6.1962e-05       -16.910901694927
     1.5625e+01     1.5625e+02             1.6549e-05       -16.910901522501

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.7500e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083300e-01 1 1  ON 0
 uu_1                 1.423398e-01 1 1  ON 1
 uu_2                 4.377309e-02 1 1  ON 2
 uu_3                -1.977874e-02 1 1  ON 3
 uu_4                -6.861934e-02 1 1  ON 4
 uu_5                -1.035147e-01 1 1  ON 5
 uu_6                -1.298800e-01 1 1  ON 6
 uu_7                -1.423101e-01 1 1  ON 7
 uu_8                -1.339698e-01 1 1  ON 8
 uu_9                -1.063446e-01 1 1  ON 9
 ud_0                 4.382925e-01 1 1  ON 10
 ud_1                 1.804477e-01 1 1  ON 11
 ud_2                 6.614083e-02 1 1  ON 12
 ud_3                -3.188074e-03 1 1  ON 13
 ud_4                -5.905356e-02 1 1  ON 14
 ud_5                -1.020691e-01 1 1  ON 15
 ud_6                -1.322685e-01 1 1  ON 16
 ud_7                -1.519703e-01 1 1  ON 17
 ud_8                -1.557502e-01 1 1  ON 18
 ud_9                -1.481799e-01 1 1  ON 19
 eO_0                -7.605138e-01 1 1  ON 20
 eO_1                -4.434518e-01 1 1  ON 21
 eO_2                -2.458859e-02 1 1  ON 22
 eO_3                 3.019460e-01 1 1  ON 23
 eO_4                 5.299907e-01 1 1  ON 24
 eO_5                 4.919987e-01 1 1  ON 25
 eO_6                 2.633092e-01 1 1  ON 26
 eO_7                -4.104648e-02 1 1  ON 27
 eO_8                -2.274466e-01 1 1  ON 28
 eO_9                -8.899900e-02 1 1  ON 29
eH1_0                -2.534286e-01 1 1  ON 30
eH1_1                -1.496386e-01 1 1  ON 31
eH1_2                -1.047293e-01 1 1  ON 32
eH1_3                -5.304257e-02 1 1  ON 33
eH1_4                -1.263284e-03 1 1  ON 34
eH1_5                 3.380346e-02 1 1  ON 35
eH1_6                 9.713099e-02 1 1  ON 36
eH1_7                 1.568554e-01 1 1  ON 37
eH1_8                 1.884641e-01 1 1  ON 38
eH1_9                 8.332945e-02 1 1  ON 39
eH2_0                -2.472773e-01 1 1  ON 40
eH2_1                -1.433130e-01 1 1  ON 41
eH2_2                -9.861042e-02 1 1  ON 42
eH2_3                -4.699434e-02 1 1  ON 43
eH2_4                 4.464652e-03 1 1  ON 44
eH2_5                 3.930101e-02 1 1  ON 45
eH2_6                 1.008995e-01 1 1  ON 46
eH2_7                 1.584705e-01 1 1  ON 47
eH2_8                 1.892198e-01 1 1  ON 48
eH2_9                 6.107963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9543
    reference variance = 0.269621
====================================================
  Execution time = 2.4430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339735168479
                                         uncertainty =       0.006477173139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339735168479
                                         uncertainty =       0.006477173139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412103843
  error estimate for blocks of size 2^( 2) =       0.000423823116
  error estimate for blocks of size 2^( 3) =       0.000436057040
  error estimate for blocks of size 2^( 4) =       0.000447078571
  error estimate for blocks of size 2^( 5) =       0.000456317183
  error estimate for blocks of size 2^( 6) =       0.000461313484
  error estimate for blocks of size 2^( 7) =       0.000464978757

      target function =                  N/A
              le_mean =     -16.909888505675
             les_mean =     286.283988260054
             stat err =       0.000457421999
             autocorr =       1.232028530904
              std dev =       0.582802844460
             le_variance =       0.339659155511


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690988850568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909888505675       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909888335097       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909887927731       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909888258519       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909888739192       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909889961872       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909889671213       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909889199342       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909889237490       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.090257e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909888505675       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909888437809       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909888236692       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909888266507       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909888417543       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909888715311       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909888835259       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909888717711       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.980878e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909888505675       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909888485765       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909888422878       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909888421947       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909888445484       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909888503359       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909888560620       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909888542722       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.016270e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0794e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083164e-01 1 1  ON 0
 uu_1                 1.424287e-01 1 1  ON 1
 uu_2                 4.382397e-02 1 1  ON 2
 uu_3                -1.981780e-02 1 1  ON 3
 uu_4                -6.865051e-02 1 1  ON 4
 uu_5                -1.035093e-01 1 1  ON 5
 uu_6                -1.298992e-01 1 1  ON 6
 uu_7                -1.423339e-01 1 1  ON 7
 uu_8                -1.339864e-01 1 1  ON 8
 uu_9                -1.063927e-01 1 1  ON 9
 ud_0                 4.383108e-01 1 1  ON 10
 ud_1                 1.804706e-01 1 1  ON 11
 ud_2                 6.616220e-02 1 1  ON 12
 ud_3                -3.113879e-03 1 1  ON 13
 ud_4                -5.904702e-02 1 1  ON 14
 ud_5                -1.020145e-01 1 1  ON 15
 ud_6                -1.322317e-01 1 1  ON 16
 ud_7                -1.520323e-01 1 1  ON 17
 ud_8                -1.557931e-01 1 1  ON 18
 ud_9                -1.481794e-01 1 1  ON 19
 eO_0                -7.604709e-01 1 1  ON 20
 eO_1                -4.435104e-01 1 1  ON 21
 eO_2                -2.465465e-02 1 1  ON 22
 eO_3                 3.020479e-01 1 1  ON 23
 eO_4                 5.300149e-01 1 1  ON 24
 eO_5                 4.921332e-01 1 1  ON 25
 eO_6                 2.633767e-01 1 1  ON 26
 eO_7                -4.104192e-02 1 1  ON 27
 eO_8                -2.275358e-01 1 1  ON 28
 eO_9                -8.912604e-02 1 1  ON 29
eH1_0                -2.535075e-01 1 1  ON 30
eH1_1                -1.496862e-01 1 1  ON 31
eH1_2                -1.048781e-01 1 1  ON 32
eH1_3                -5.309418e-02 1 1  ON 33
eH1_4                -1.327987e-03 1 1  ON 34
eH1_5                 3.378231e-02 1 1  ON 35
eH1_6                 9.712927e-02 1 1  ON 36
eH1_7                 1.569135e-01 1 1  ON 37
eH1_8                 1.886069e-01 1 1  ON 38
eH1_9                 8.352754e-02 1 1  ON 39
eH2_0                -2.473709e-01 1 1  ON 40
eH2_1                -1.433737e-01 1 1  ON 41
eH2_2                -9.869861e-02 1 1  ON 42
eH2_3                -4.690820e-02 1 1  ON 43
eH2_4                 4.493812e-03 1 1  ON 44
eH2_5                 3.925442e-02 1 1  ON 45
eH2_6                 1.008539e-01 1 1  ON 46
eH2_7                 1.584718e-01 1 1  ON 47
eH2_8                 1.892794e-01 1 1  ON 48
eH2_9                 6.123750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.191927
====================================================
  Execution time = 2.6076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3361e-01
  Total weights = 2.0000e+06
  Execution time = 2.7043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333690988776
                                         uncertainty =       0.005140567439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333690988776
                                         uncertainty =       0.005140567439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408411949
  error estimate for blocks of size 2^( 2) =       0.000420176561
  error estimate for blocks of size 2^( 3) =       0.000432529309
  error estimate for blocks of size 2^( 4) =       0.000444441630
  error estimate for blocks of size 2^( 5) =       0.000454913969
  error estimate for blocks of size 2^( 6) =       0.000462095270
  error estimate for blocks of size 2^( 7) =       0.000466436528

      target function =                  N/A
              le_mean =     -16.910611078023
             les_mean =     286.302367505131
             stat err =       0.000456971849
             autocorr =       1.251935674175
              std dev =       0.577581716968
             le_variance =       0.333600639776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730232966
                                         uncertainty =       0.005141108242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730232966
                                         uncertainty =       0.005141108242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408436005
  error estimate for blocks of size 2^( 2) =       0.000420198275
  error estimate for blocks of size 2^( 3) =       0.000432547084
  error estimate for blocks of size 2^( 4) =       0.000444456979
  error estimate for blocks of size 2^( 5) =       0.000454926985
  error estimate for blocks of size 2^( 6) =       0.000462106610
  error estimate for blocks of size 2^( 7) =       0.000466433429

      target function =                  N/A
              le_mean =     -16.910610527558
             les_mean =     286.302388188759
             stat err =       0.000456981001
             autocorr =       1.251838342148
              std dev =       0.577615738037
             le_variance =       0.333639940828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333707388429
                                         uncertainty =       0.005141084158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333707388429
                                         uncertainty =       0.005141084158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408422016
  error estimate for blocks of size 2^( 2) =       0.000420185025
  error estimate for blocks of size 2^( 3) =       0.000432535276
  error estimate for blocks of size 2^( 4) =       0.000444446540
  error estimate for blocks of size 2^( 5) =       0.000454917876
  error estimate for blocks of size 2^( 6) =       0.000462098147
  error estimate for blocks of size 2^( 7) =       0.000466428652

      target function =                  N/A
              le_mean =     -16.910610606047
             les_mean =     286.302367989556
             stat err =       0.000456972804
             autocorr =       1.251879184486
              std dev =       0.577595954806
             le_variance =       0.333617087008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333694987067
                                         uncertainty =       0.005140687799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333694987067
                                         uncertainty =       0.005140687799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408414401
  error estimate for blocks of size 2^( 2) =       0.000420178668
  error estimate for blocks of size 2^( 3) =       0.000432530977
  error estimate for blocks of size 2^( 4) =       0.000444443156
  error estimate for blocks of size 2^( 5) =       0.000454915375
  error estimate for blocks of size 2^( 6) =       0.000462096455
  error estimate for blocks of size 2^( 7) =       0.000466436170

      target function =                  N/A
              le_mean =     -16.910610954002
             les_mean =     286.302367315986
             stat err =       0.000456972789
             autocorr =       1.251925792155
              std dev =       0.577585184352
             le_variance =       0.333604645183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910611078023        initial  <--
     2.4414e-01     2.4414e+00             8.0903e-04       -16.910610527558
     9.7656e-01     9.7656e+00             1.9809e-04       -16.910610606047
     3.9062e+00     3.9062e+01             5.0163e-05       -16.910610954002

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.6350
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083300e-01 1 1  ON 0
 uu_1                 1.423398e-01 1 1  ON 1
 uu_2                 4.377309e-02 1 1  ON 2
 uu_3                -1.977874e-02 1 1  ON 3
 uu_4                -6.861934e-02 1 1  ON 4
 uu_5                -1.035147e-01 1 1  ON 5
 uu_6                -1.298800e-01 1 1  ON 6
 uu_7                -1.423101e-01 1 1  ON 7
 uu_8                -1.339698e-01 1 1  ON 8
 uu_9                -1.063446e-01 1 1  ON 9
 ud_0                 4.382925e-01 1 1  ON 10
 ud_1                 1.804477e-01 1 1  ON 11
 ud_2                 6.614083e-02 1 1  ON 12
 ud_3                -3.188074e-03 1 1  ON 13
 ud_4                -5.905356e-02 1 1  ON 14
 ud_5                -1.020691e-01 1 1  ON 15
 ud_6                -1.322685e-01 1 1  ON 16
 ud_7                -1.519703e-01 1 1  ON 17
 ud_8                -1.557502e-01 1 1  ON 18
 ud_9                -1.481799e-01 1 1  ON 19
 eO_0                -7.605138e-01 1 1  ON 20
 eO_1                -4.434518e-01 1 1  ON 21
 eO_2                -2.458859e-02 1 1  ON 22
 eO_3                 3.019460e-01 1 1  ON 23
 eO_4                 5.299907e-01 1 1  ON 24
 eO_5                 4.919987e-01 1 1  ON 25
 eO_6                 2.633092e-01 1 1  ON 26
 eO_7                -4.104648e-02 1 1  ON 27
 eO_8                -2.274466e-01 1 1  ON 28
 eO_9                -8.899900e-02 1 1  ON 29
eH1_0                -2.534286e-01 1 1  ON 30
eH1_1                -1.496386e-01 1 1  ON 31
eH1_2                -1.047293e-01 1 1  ON 32
eH1_3                -5.304257e-02 1 1  ON 33
eH1_4                -1.263284e-03 1 1  ON 34
eH1_5                 3.380346e-02 1 1  ON 35
eH1_6                 9.713099e-02 1 1  ON 36
eH1_7                 1.568554e-01 1 1  ON 37
eH1_8                 1.884641e-01 1 1  ON 38
eH1_9                 8.332945e-02 1 1  ON 39
eH2_0                -2.472773e-01 1 1  ON 40
eH2_1                -1.433130e-01 1 1  ON 41
eH2_2                -9.861042e-02 1 1  ON 42
eH2_3                -4.699434e-02 1 1  ON 43
eH2_4                 4.464652e-03 1 1  ON 44
eH2_5                 3.930101e-02 1 1  ON 45
eH2_6                 1.008995e-01 1 1  ON 46
eH2_7                 1.584705e-01 1 1  ON 47
eH2_8                 1.892198e-01 1 1  ON 48
eH2_9                 6.107963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9105
    reference variance = 0.189301
====================================================
  Execution time = 2.4204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3560e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335707814290
                                         uncertainty =       0.005409905443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335707814290
                                         uncertainty =       0.005409905443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409635661
  error estimate for blocks of size 2^( 2) =       0.000421079277
  error estimate for blocks of size 2^( 3) =       0.000432888394
  error estimate for blocks of size 2^( 4) =       0.000443834117
  error estimate for blocks of size 2^( 5) =       0.000452185918
  error estimate for blocks of size 2^( 6) =       0.000458115847
  error estimate for blocks of size 2^( 7) =       0.000464987572

      target function =                  N/A
              le_mean =     -16.910913548619
             les_mean =     286.314599630061
             stat err =       0.000454780864
             autocorr =       1.232562215608
              std dev =       0.579312306947
             le_variance =       0.335602748980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691091354862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910913548619       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910913843505       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910914059597       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910914154721       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910914150782       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910914161551       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910914230346       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910914237075       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.788447e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910913548619       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910913627166       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910913683738       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910913709675       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910913710237       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910913711915       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910913730876       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910913731197       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.960737e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910913548619       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910913568583       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910913582919       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910913589540       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910913589786       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910913590162       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910913595030       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910913595005       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.980458e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0609e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083198e-01 1 1  ON 0
 uu_1                 1.423592e-01 1 1  ON 1
 uu_2                 4.377252e-02 1 1  ON 2
 uu_3                -1.977250e-02 1 1  ON 3
 uu_4                -6.861850e-02 1 1  ON 4
 uu_5                -1.035235e-01 1 1  ON 5
 uu_6                -1.298868e-01 1 1  ON 6
 uu_7                -1.423193e-01 1 1  ON 7
 uu_8                -1.339804e-01 1 1  ON 8
 uu_9                -1.063486e-01 1 1  ON 9
 ud_0                 4.382842e-01 1 1  ON 10
 ud_1                 1.804506e-01 1 1  ON 11
 ud_2                 6.614331e-02 1 1  ON 12
 ud_3                -3.184608e-03 1 1  ON 13
 ud_4                -5.905867e-02 1 1  ON 14
 ud_5                -1.020592e-01 1 1  ON 15
 ud_6                -1.322578e-01 1 1  ON 16
 ud_7                -1.519609e-01 1 1  ON 17
 ud_8                -1.557522e-01 1 1  ON 18
 ud_9                -1.481855e-01 1 1  ON 19
 eO_0                -7.605182e-01 1 1  ON 20
 eO_1                -4.434458e-01 1 1  ON 21
 eO_2                -2.459190e-02 1 1  ON 22
 eO_3                 3.019601e-01 1 1  ON 23
 eO_4                 5.299834e-01 1 1  ON 24
 eO_5                 4.920044e-01 1 1  ON 25
 eO_6                 2.633147e-01 1 1  ON 26
 eO_7                -4.103348e-02 1 1  ON 27
 eO_8                -2.274568e-01 1 1  ON 28
 eO_9                -8.901445e-02 1 1  ON 29
eH1_0                -2.534394e-01 1 1  ON 30
eH1_1                -1.496495e-01 1 1  ON 31
eH1_2                -1.047441e-01 1 1  ON 32
eH1_3                -5.304593e-02 1 1  ON 33
eH1_4                -1.266251e-03 1 1  ON 34
eH1_5                 3.381073e-02 1 1  ON 35
eH1_6                 9.712978e-02 1 1  ON 36
eH1_7                 1.568594e-01 1 1  ON 37
eH1_8                 1.884753e-01 1 1  ON 38
eH1_9                 8.334906e-02 1 1  ON 39
eH2_0                -2.472873e-01 1 1  ON 40
eH2_1                -1.433283e-01 1 1  ON 41
eH2_2                -9.861910e-02 1 1  ON 42
eH2_3                -4.698578e-02 1 1  ON 43
eH2_4                 4.464332e-03 1 1  ON 44
eH2_5                 3.930913e-02 1 1  ON 45
eH2_6                 1.008983e-01 1 1  ON 46
eH2_7                 1.584657e-01 1 1  ON 47
eH2_8                 1.892287e-01 1 1  ON 48
eH2_9                 6.109503e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.284972
====================================================
  Execution time = 2.3831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3959e-01
  Total weights = 2.0000e+06
  Execution time = 2.7106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220278279
                                         uncertainty =       0.008724268418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220278279
                                         uncertainty =       0.008724268418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412065050
  error estimate for blocks of size 2^( 2) =       0.000423759334
  error estimate for blocks of size 2^( 3) =       0.000435888444
  error estimate for blocks of size 2^( 4) =       0.000446866582
  error estimate for blocks of size 2^( 5) =       0.000456789866
  error estimate for blocks of size 2^( 6) =       0.000465122904
  error estimate for blocks of size 2^( 7) =       0.000469356445

      target function =                  N/A
              le_mean =     -16.911192228243
             les_mean =     286.328017621811
             stat err =       0.000459533949
             autocorr =       1.243665655371
              std dev =       0.582747982427
             le_variance =       0.339595211023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339193314295
                                         uncertainty =       0.008726049207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339193314295
                                         uncertainty =       0.008726049207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412048683
  error estimate for blocks of size 2^( 2) =       0.000423743236
  error estimate for blocks of size 2^( 3) =       0.000435872397
  error estimate for blocks of size 2^( 4) =       0.000446850471
  error estimate for blocks of size 2^( 5) =       0.000456773914
  error estimate for blocks of size 2^( 6) =       0.000465105558
  error estimate for blocks of size 2^( 7) =       0.000469340891

      target function =                  N/A
              le_mean =     -16.911192101535
             les_mean =     286.327986359855
             stat err =       0.000459517708
             autocorr =       1.243676544146
              std dev =       0.582724836110
             le_variance =       0.339568234620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339205503821
                                         uncertainty =       0.008725236834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339205503821
                                         uncertainty =       0.008725236834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412056081
  error estimate for blocks of size 2^( 2) =       0.000423750523
  error estimate for blocks of size 2^( 3) =       0.000435879665
  error estimate for blocks of size 2^( 4) =       0.000446857764
  error estimate for blocks of size 2^( 5) =       0.000456781133
  error estimate for blocks of size 2^( 6) =       0.000465113372
  error estimate for blocks of size 2^( 7) =       0.000469347937

      target function =                  N/A
              le_mean =     -16.911192138830
             les_mean =     286.327999814063
             stat err =       0.000459525051
             autocorr =       1.243671636070
              std dev =       0.582735297917
             le_variance =       0.339580427438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339218386551
                                         uncertainty =       0.008724392451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339218386551
                                         uncertainty =       0.008724392451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412063902
  error estimate for blocks of size 2^( 2) =       0.000423758206
  error estimate for blocks of size 2^( 3) =       0.000435887320
  error estimate for blocks of size 2^( 4) =       0.000446865453
  error estimate for blocks of size 2^( 5) =       0.000456788747
  error estimate for blocks of size 2^( 6) =       0.000465121682
  error estimate for blocks of size 2^( 7) =       0.000469355355

      target function =                  N/A
              le_mean =     -16.911192215619
             les_mean =     286.328015301858
             stat err =       0.000459532809
             autocorr =       1.243666417880
              std dev =       0.582746358250
             le_variance =       0.339593318053


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911192228243        initial  <--
     2.4414e+00     2.4414e+01             7.7884e-05       -16.911192101535
     9.7656e+00     9.7656e+01             1.9607e-05       -16.911192138830
     3.9062e+01     3.9062e+02             4.9805e-06       -16.911192215619

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.4015
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083300e-01 1 1  ON 0
 uu_1                 1.423398e-01 1 1  ON 1
 uu_2                 4.377309e-02 1 1  ON 2
 uu_3                -1.977874e-02 1 1  ON 3
 uu_4                -6.861934e-02 1 1  ON 4
 uu_5                -1.035147e-01 1 1  ON 5
 uu_6                -1.298800e-01 1 1  ON 6
 uu_7                -1.423101e-01 1 1  ON 7
 uu_8                -1.339698e-01 1 1  ON 8
 uu_9                -1.063446e-01 1 1  ON 9
 ud_0                 4.382925e-01 1 1  ON 10
 ud_1                 1.804477e-01 1 1  ON 11
 ud_2                 6.614083e-02 1 1  ON 12
 ud_3                -3.188074e-03 1 1  ON 13
 ud_4                -5.905356e-02 1 1  ON 14
 ud_5                -1.020691e-01 1 1  ON 15
 ud_6                -1.322685e-01 1 1  ON 16
 ud_7                -1.519703e-01 1 1  ON 17
 ud_8                -1.557502e-01 1 1  ON 18
 ud_9                -1.481799e-01 1 1  ON 19
 eO_0                -7.605138e-01 1 1  ON 20
 eO_1                -4.434518e-01 1 1  ON 21
 eO_2                -2.458859e-02 1 1  ON 22
 eO_3                 3.019460e-01 1 1  ON 23
 eO_4                 5.299907e-01 1 1  ON 24
 eO_5                 4.919987e-01 1 1  ON 25
 eO_6                 2.633092e-01 1 1  ON 26
 eO_7                -4.104648e-02 1 1  ON 27
 eO_8                -2.274466e-01 1 1  ON 28
 eO_9                -8.899900e-02 1 1  ON 29
eH1_0                -2.534286e-01 1 1  ON 30
eH1_1                -1.496386e-01 1 1  ON 31
eH1_2                -1.047293e-01 1 1  ON 32
eH1_3                -5.304257e-02 1 1  ON 33
eH1_4                -1.263284e-03 1 1  ON 34
eH1_5                 3.380346e-02 1 1  ON 35
eH1_6                 9.713099e-02 1 1  ON 36
eH1_7                 1.568554e-01 1 1  ON 37
eH1_8                 1.884641e-01 1 1  ON 38
eH1_9                 8.332945e-02 1 1  ON 39
eH2_0                -2.472773e-01 1 1  ON 40
eH2_1                -1.433130e-01 1 1  ON 41
eH2_2                -9.861042e-02 1 1  ON 42
eH2_3                -4.699434e-02 1 1  ON 43
eH2_4                 4.464652e-03 1 1  ON 44
eH2_5                 3.930101e-02 1 1  ON 45
eH2_6                 1.008995e-01 1 1  ON 46
eH2_7                 1.584705e-01 1 1  ON 47
eH2_8                 1.892198e-01 1 1  ON 48
eH2_9                 6.107963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8487
    reference variance = 0.247773
====================================================
  Execution time = 2.4072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326934595857
                                         uncertainty =       0.003563268454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326934595857
                                         uncertainty =       0.003563268454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404268656
  error estimate for blocks of size 2^( 2) =       0.000416061872
  error estimate for blocks of size 2^( 3) =       0.000428422971
  error estimate for blocks of size 2^( 4) =       0.000441095888
  error estimate for blocks of size 2^( 5) =       0.000450804796
  error estimate for blocks of size 2^( 6) =       0.000458997130
  error estimate for blocks of size 2^( 7) =       0.000463596192

      target function =                  N/A
              le_mean =     -16.911167603720
             les_mean =     286.314455849819
             stat err =       0.000453623501
             autocorr =       1.259073119723
              std dev =       0.571722215895
             le_variance =       0.326866292147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691116760372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911167603720       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911167627824       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911167638071       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911167642740       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911167656772       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911167663693       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911167660858       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911167659639       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.191055e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911167603720       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911167609772       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911167612338       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911167613523       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911167617076       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911167618854       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911167618190       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911167617877       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.299898e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911167603720       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911167605235       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911167605876       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911167606174       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911167607065       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911167607512       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911167607349       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911167607270       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.751123e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0360e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083284e-01 1 1  ON 0
 uu_1                 1.423409e-01 1 1  ON 1
 uu_2                 4.377364e-02 1 1  ON 2
 uu_3                -1.977804e-02 1 1  ON 3
 uu_4                -6.861946e-02 1 1  ON 4
 uu_5                -1.035144e-01 1 1  ON 5
 uu_6                -1.298800e-01 1 1  ON 6
 uu_7                -1.423101e-01 1 1  ON 7
 uu_8                -1.339709e-01 1 1  ON 8
 uu_9                -1.063453e-01 1 1  ON 9
 ud_0                 4.382916e-01 1 1  ON 10
 ud_1                 1.804494e-01 1 1  ON 11
 ud_2                 6.614169e-02 1 1  ON 12
 ud_3                -3.186728e-03 1 1  ON 13
 ud_4                -5.905331e-02 1 1  ON 14
 ud_5                -1.020679e-01 1 1  ON 15
 ud_6                -1.322671e-01 1 1  ON 16
 ud_7                -1.519709e-01 1 1  ON 17
 ud_8                -1.557514e-01 1 1  ON 18
 ud_9                -1.481811e-01 1 1  ON 19
 eO_0                -7.605141e-01 1 1  ON 20
 eO_1                -4.434513e-01 1 1  ON 21
 eO_2                -2.458958e-02 1 1  ON 22
 eO_3                 3.019469e-01 1 1  ON 23
 eO_4                 5.299916e-01 1 1  ON 24
 eO_5                 4.919997e-01 1 1  ON 25
 eO_6                 2.633101e-01 1 1  ON 26
 eO_7                -4.104629e-02 1 1  ON 27
 eO_8                -2.274481e-01 1 1  ON 28
 eO_9                -8.900041e-02 1 1  ON 29
eH1_0                -2.534291e-01 1 1  ON 30
eH1_1                -1.496389e-01 1 1  ON 31
eH1_2                -1.047304e-01 1 1  ON 32
eH1_3                -5.304293e-02 1 1  ON 33
eH1_4                -1.263366e-03 1 1  ON 34
eH1_5                 3.380328e-02 1 1  ON 35
eH1_6                 9.713112e-02 1 1  ON 36
eH1_7                 1.568561e-01 1 1  ON 37
eH1_8                 1.884649e-01 1 1  ON 38
eH1_9                 8.333050e-02 1 1  ON 39
eH2_0                -2.472781e-01 1 1  ON 40
eH2_1                -1.433140e-01 1 1  ON 41
eH2_2                -9.861036e-02 1 1  ON 42
eH2_3                -4.699414e-02 1 1  ON 43
eH2_4                 4.463976e-03 1 1  ON 44
eH2_5                 3.930037e-02 1 1  ON 45
eH2_6                 1.008993e-01 1 1  ON 46
eH2_7                 1.584701e-01 1 1  ON 47
eH2_8                 1.892206e-01 1 1  ON 48
eH2_9                 6.108193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0041
    reference variance = 0.983856
====================================================
  Execution time = 2.3624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2749e-01
  Total weights = 2.0000e+06
  Execution time = 2.7062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327504543605
                                         uncertainty =       0.002938596010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327504543605
                                         uncertainty =       0.002938596010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404656034
  error estimate for blocks of size 2^( 2) =       0.000416650627
  error estimate for blocks of size 2^( 3) =       0.000429246299
  error estimate for blocks of size 2^( 4) =       0.000441511730
  error estimate for blocks of size 2^( 5) =       0.000451316028
  error estimate for blocks of size 2^( 6) =       0.000457745842
  error estimate for blocks of size 2^( 7) =       0.000463280790

      target function =                  N/A
              le_mean =     -16.910281609925
             les_mean =     286.285116974667
             stat err =       0.000453463598
             autocorr =       1.255777846066
              std dev =       0.572270051160
             le_variance =       0.327493011455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327497148349
                                         uncertainty =       0.002938532218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327497148349
                                         uncertainty =       0.002938532218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404651465
  error estimate for blocks of size 2^( 2) =       0.000416646205
  error estimate for blocks of size 2^( 3) =       0.000429241966
  error estimate for blocks of size 2^( 4) =       0.000441507410
  error estimate for blocks of size 2^( 5) =       0.000451311698
  error estimate for blocks of size 2^( 6) =       0.000457741709
  error estimate for blocks of size 2^( 7) =       0.000463276508

      target function =                  N/A
              le_mean =     -16.910281646242
             les_mean =     286.285110807928
             stat err =       0.000453459331
             autocorr =       1.255782573423
              std dev =       0.572263590002
             le_variance =       0.327485616442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327500799821
                                         uncertainty =       0.002938563687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327500799821
                                         uncertainty =       0.002938563687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404653721
  error estimate for blocks of size 2^( 2) =       0.000416648389
  error estimate for blocks of size 2^( 3) =       0.000429244106
  error estimate for blocks of size 2^( 4) =       0.000441509543
  error estimate for blocks of size 2^( 5) =       0.000451313836
  error estimate for blocks of size 2^( 6) =       0.000457743749
  error estimate for blocks of size 2^( 7) =       0.000463278621

      target function =                  N/A
              le_mean =     -16.910281628298
             les_mean =     286.285113852385
             stat err =       0.000453461438
             autocorr =       1.255780238436
              std dev =       0.572266780262
             le_variance =       0.327489267792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327504074127
                                         uncertainty =       0.002938591956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327504074127
                                         uncertainty =       0.002938591956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404655744
  error estimate for blocks of size 2^( 2) =       0.000416650347
  error estimate for blocks of size 2^( 3) =       0.000429246024
  error estimate for blocks of size 2^( 4) =       0.000441511456
  error estimate for blocks of size 2^( 5) =       0.000451315753
  error estimate for blocks of size 2^( 6) =       0.000457745580
  error estimate for blocks of size 2^( 7) =       0.000463280518

      target function =                  N/A
              le_mean =     -16.910281612224
             les_mean =     286.285116582976
             stat err =       0.000453463327
             autocorr =       1.255778146024
              std dev =       0.572269640984
             le_variance =       0.327492541992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910281609925        initial
     2.4414e+01     2.4414e+02             9.1911e-06       -16.910281646242  <--
     9.7656e+01     9.7656e+02             2.2999e-06       -16.910281628298
     3.9062e+02     3.9062e+03             5.7511e-07       -16.910281612224

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.7193e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083238e-01 1 1  ON 0
 uu_1                 1.423443e-01 1 1  ON 1
 uu_2                 4.377529e-02 1 1  ON 2
 uu_3                -1.977599e-02 1 1  ON 3
 uu_4                -6.861979e-02 1 1  ON 4
 uu_5                -1.035133e-01 1 1  ON 5
 uu_6                -1.298799e-01 1 1  ON 6
 uu_7                -1.423102e-01 1 1  ON 7
 uu_8                -1.339743e-01 1 1  ON 8
 uu_9                -1.063477e-01 1 1  ON 9
 ud_0                 4.382890e-01 1 1  ON 10
 ud_1                 1.804541e-01 1 1  ON 11
 ud_2                 6.614430e-02 1 1  ON 12
 ud_3                -3.182732e-03 1 1  ON 13
 ud_4                -5.905252e-02 1 1  ON 14
 ud_5                -1.020643e-01 1 1  ON 15
 ud_6                -1.322628e-01 1 1  ON 16
 ud_7                -1.519726e-01 1 1  ON 17
 ud_8                -1.557551e-01 1 1  ON 18
 ud_9                -1.481848e-01 1 1  ON 19
 eO_0                -7.605150e-01 1 1  ON 20
 eO_1                -4.434498e-01 1 1  ON 21
 eO_2                -2.459252e-02 1 1  ON 22
 eO_3                 3.019498e-01 1 1  ON 23
 eO_4                 5.299943e-01 1 1  ON 24
 eO_5                 4.920028e-01 1 1  ON 25
 eO_6                 2.633129e-01 1 1  ON 26
 eO_7                -4.104571e-02 1 1  ON 27
 eO_8                -2.274525e-01 1 1  ON 28
 eO_9                -8.900463e-02 1 1  ON 29
eH1_0                -2.534308e-01 1 1  ON 30
eH1_1                -1.496398e-01 1 1  ON 31
eH1_2                -1.047334e-01 1 1  ON 32
eH1_3                -5.304401e-02 1 1  ON 33
eH1_4                -1.263615e-03 1 1  ON 34
eH1_5                 3.380273e-02 1 1  ON 35
eH1_6                 9.713154e-02 1 1  ON 36
eH1_7                 1.568580e-01 1 1  ON 37
eH1_8                 1.884673e-01 1 1  ON 38
eH1_9                 8.333364e-02 1 1  ON 39
eH2_0                -2.472805e-01 1 1  ON 40
eH2_1                -1.433170e-01 1 1  ON 41
eH2_2                -9.861018e-02 1 1  ON 42
eH2_3                -4.699357e-02 1 1  ON 43
eH2_4                 4.461960e-03 1 1  ON 44
eH2_5                 3.929846e-02 1 1  ON 45
eH2_6                 1.008989e-01 1 1  ON 46
eH2_7                 1.584690e-01 1 1  ON 47
eH2_8                 1.892230e-01 1 1  ON 48
eH2_9                 6.108882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8551
    reference variance = 0.249848
====================================================
  Execution time = 2.4270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408590991
                                         uncertainty =       0.008417736225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408590991
                                         uncertainty =       0.008417736225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411887180
  error estimate for blocks of size 2^( 2) =       0.000423588741
  error estimate for blocks of size 2^( 3) =       0.000436247347
  error estimate for blocks of size 2^( 4) =       0.000448549550
  error estimate for blocks of size 2^( 5) =       0.000459889559
  error estimate for blocks of size 2^( 6) =       0.000468324983
  error estimate for blocks of size 2^( 7) =       0.000473308616

      target function =                  N/A
              le_mean =     -16.910659233201
             les_mean =     286.309697630533
             stat err =       0.000462518177
             autocorr =       1.260959274259
              std dev =       0.582496436666
             le_variance =       0.339302098729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691065923320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910659233201       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910659176484       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910659205850       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910659284647       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910659297681       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910659343069       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910659364239       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910659368575       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.792206e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910659233201       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910659218560       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910659225816       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910659245817       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910659249064       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910659260844       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910659265619       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910659267075       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.219887e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910659233201       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910659229511       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910659231319       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910659236337       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910659237149       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910659240123       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910659241283       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910659241668       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.063909e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0614e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083209e-01 1 1  ON 0
 uu_1                 1.423447e-01 1 1  ON 1
 uu_2                 4.377467e-02 1 1  ON 2
 uu_3                -1.977430e-02 1 1  ON 3
 uu_4                -6.862077e-02 1 1  ON 4
 uu_5                -1.035198e-01 1 1  ON 5
 uu_6                -1.298838e-01 1 1  ON 6
 uu_7                -1.423141e-01 1 1  ON 7
 uu_8                -1.339726e-01 1 1  ON 8
 uu_9                -1.063445e-01 1 1  ON 9
 ud_0                 4.382808e-01 1 1  ON 10
 ud_1                 1.804551e-01 1 1  ON 11
 ud_2                 6.614466e-02 1 1  ON 12
 ud_3                -3.182532e-03 1 1  ON 13
 ud_4                -5.905558e-02 1 1  ON 14
 ud_5                -1.020635e-01 1 1  ON 15
 ud_6                -1.322609e-01 1 1  ON 16
 ud_7                -1.519754e-01 1 1  ON 17
 ud_8                -1.557508e-01 1 1  ON 18
 ud_9                -1.481789e-01 1 1  ON 19
 eO_0                -7.605156e-01 1 1  ON 20
 eO_1                -4.434475e-01 1 1  ON 21
 eO_2                -2.459753e-02 1 1  ON 22
 eO_3                 3.019525e-01 1 1  ON 23
 eO_4                 5.299945e-01 1 1  ON 24
 eO_5                 4.920051e-01 1 1  ON 25
 eO_6                 2.633137e-01 1 1  ON 26
 eO_7                -4.104241e-02 1 1  ON 27
 eO_8                -2.274532e-01 1 1  ON 28
 eO_9                -8.900873e-02 1 1  ON 29
eH1_0                -2.534353e-01 1 1  ON 30
eH1_1                -1.496479e-01 1 1  ON 31
eH1_2                -1.047383e-01 1 1  ON 32
eH1_3                -5.304090e-02 1 1  ON 33
eH1_4                -1.266093e-03 1 1  ON 34
eH1_5                 3.380622e-02 1 1  ON 35
eH1_6                 9.713085e-02 1 1  ON 36
eH1_7                 1.568561e-01 1 1  ON 37
eH1_8                 1.884713e-01 1 1  ON 38
eH1_9                 8.334249e-02 1 1  ON 39
eH2_0                -2.472841e-01 1 1  ON 40
eH2_1                -1.433292e-01 1 1  ON 41
eH2_2                -9.861335e-02 1 1  ON 42
eH2_3                -4.699348e-02 1 1  ON 43
eH2_4                 4.459441e-03 1 1  ON 44
eH2_5                 3.929888e-02 1 1  ON 45
eH2_6                 1.009004e-01 1 1  ON 46
eH2_7                 1.584741e-01 1 1  ON 47
eH2_8                 1.892284e-01 1 1  ON 48
eH2_9                 6.109778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9539
    reference variance = 0.153377
====================================================
  Execution time = 2.3886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3437e-01
  Total weights = 2.0000e+06
  Execution time = 2.7250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334239730017
                                         uncertainty =       0.006019822229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334239730017
                                         uncertainty =       0.006019822229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408889164
  error estimate for blocks of size 2^( 2) =       0.000420667988
  error estimate for blocks of size 2^( 3) =       0.000432969654
  error estimate for blocks of size 2^( 4) =       0.000444632812
  error estimate for blocks of size 2^( 5) =       0.000453331904
  error estimate for blocks of size 2^( 6) =       0.000461843799
  error estimate for blocks of size 2^( 7) =       0.000467953183

      target function =                  N/A
              le_mean =     -16.909818384875
             les_mean =     286.276338338744
             stat err =       0.000456940424
             autocorr =       1.248843330362
              std dev =       0.578256600893
             le_variance =       0.334380696476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334210907742
                                         uncertainty =       0.006019279047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334210907742
                                         uncertainty =       0.006019279047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408871539
  error estimate for blocks of size 2^( 2) =       0.000420651113
  error estimate for blocks of size 2^( 3) =       0.000432953507
  error estimate for blocks of size 2^( 4) =       0.000444617259
  error estimate for blocks of size 2^( 5) =       0.000453316663
  error estimate for blocks of size 2^( 6) =       0.000461829407
  error estimate for blocks of size 2^( 7) =       0.000467938367

      target function =                  N/A
              le_mean =     -16.909818395477
             les_mean =     286.276309871303
             stat err =       0.000456925424
             autocorr =       1.248868999916
              std dev =       0.578231675435
             le_variance =       0.334351870477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224560980
                                         uncertainty =       0.006019538840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224560980
                                         uncertainty =       0.006019538840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408879888
  error estimate for blocks of size 2^( 2) =       0.000420659103
  error estimate for blocks of size 2^( 3) =       0.000432961151
  error estimate for blocks of size 2^( 4) =       0.000444624621
  error estimate for blocks of size 2^( 5) =       0.000453323880
  error estimate for blocks of size 2^( 6) =       0.000461836224
  error estimate for blocks of size 2^( 7) =       0.000467945390

      target function =                  N/A
              le_mean =     -16.909818390654
             les_mean =     286.276323362868
             stat err =       0.000456932529
             autocorr =       1.248856834801
              std dev =       0.578243482590
             le_variance =       0.334365525157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334237808439
                                         uncertainty =       0.006019786416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334237808439
                                         uncertainty =       0.006019786416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408887989
  error estimate for blocks of size 2^( 2) =       0.000420666862
  error estimate for blocks of size 2^( 3) =       0.000432968576
  error estimate for blocks of size 2^( 4) =       0.000444631774
  error estimate for blocks of size 2^( 5) =       0.000453330887
  error estimate for blocks of size 2^( 6) =       0.000461842839
  error estimate for blocks of size 2^( 7) =       0.000467952196

      target function =                  N/A
              le_mean =     -16.909818385531
             les_mean =     286.276336439039
             stat err =       0.000456939424
             autocorr =       1.248845040093
              std dev =       0.578254939105
             le_variance =       0.334378774599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909818384875        initial
     6.1035e+00     6.1035e+01             4.7922e-05       -16.909818395477  <--
     2.4414e+01     2.4414e+02             1.2199e-05       -16.909818390654
     9.7656e+01     9.7656e+02             3.0639e-06       -16.909818385531

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.7552e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083124e-01 1 1  ON 0
 uu_1                 1.423457e-01 1 1  ON 1
 uu_2                 4.377294e-02 1 1  ON 2
 uu_3                -1.976963e-02 1 1  ON 3
 uu_4                -6.862385e-02 1 1  ON 4
 uu_5                -1.035388e-01 1 1  ON 5
 uu_6                -1.298957e-01 1 1  ON 6
 uu_7                -1.423260e-01 1 1  ON 7
 uu_8                -1.339675e-01 1 1  ON 8
 uu_9                -1.063349e-01 1 1  ON 9
 ud_0                 4.382576e-01 1 1  ON 10
 ud_1                 1.804574e-01 1 1  ON 11
 ud_2                 6.614544e-02 1 1  ON 12
 ud_3                -3.182118e-03 1 1  ON 13
 ud_4                -5.906449e-02 1 1  ON 14
 ud_5                -1.020617e-01 1 1  ON 15
 ud_6                -1.322553e-01 1 1  ON 16
 ud_7                -1.519835e-01 1 1  ON 17
 ud_8                -1.557381e-01 1 1  ON 18
 ud_9                -1.481612e-01 1 1  ON 19
 eO_0                -7.605173e-01 1 1  ON 20
 eO_1                -4.434415e-01 1 1  ON 21
 eO_2                -2.461184e-02 1 1  ON 22
 eO_3                 3.019602e-01 1 1  ON 23
 eO_4                 5.299952e-01 1 1  ON 24
 eO_5                 4.920117e-01 1 1  ON 25
 eO_6                 2.633162e-01 1 1  ON 26
 eO_7                -4.103256e-02 1 1  ON 27
 eO_8                -2.274554e-01 1 1  ON 28
 eO_9                -8.902100e-02 1 1  ON 29
eH1_0                -2.534490e-01 1 1  ON 30
eH1_1                -1.496718e-01 1 1  ON 31
eH1_2                -1.047528e-01 1 1  ON 32
eH1_3                -5.303230e-02 1 1  ON 33
eH1_4                -1.273173e-03 1 1  ON 34
eH1_5                 3.381642e-02 1 1  ON 35
eH1_6                 9.712876e-02 1 1  ON 36
eH1_7                 1.568503e-01 1 1  ON 37
eH1_8                 1.884833e-01 1 1  ON 38
eH1_9                 8.336900e-02 1 1  ON 39
eH2_0                -2.472951e-01 1 1  ON 40
eH2_1                -1.433649e-01 1 1  ON 41
eH2_2                -9.862297e-02 1 1  ON 42
eH2_3                -4.699366e-02 1 1  ON 43
eH2_4                 4.452057e-03 1 1  ON 44
eH2_5                 3.929994e-02 1 1  ON 45
eH2_6                 1.009048e-01 1 1  ON 46
eH2_7                 1.584895e-01 1 1  ON 47
eH2_8                 1.892445e-01 1 1  ON 48
eH2_9                 6.112460e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9152
    reference variance = 0.204731
====================================================
  Execution time = 2.4351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329834444997
                                         uncertainty =       0.004793149470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329834444997
                                         uncertainty =       0.004793149470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406022408
  error estimate for blocks of size 2^( 2) =       0.000417982301
  error estimate for blocks of size 2^( 3) =       0.000430331683
  error estimate for blocks of size 2^( 4) =       0.000442421830
  error estimate for blocks of size 2^( 5) =       0.000453515277
  error estimate for blocks of size 2^( 6) =       0.000462448450
  error estimate for blocks of size 2^( 7) =       0.000466398143

      target function =                  N/A
              le_mean =     -16.910416982929
             les_mean =     286.291910763783
             stat err =       0.000456195925
             autocorr =       1.262416893083
              std dev =       0.574202396470
             le_variance =       0.329708392112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691041698293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910416982929       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910417100387       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910417459415       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910417475056       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910417560329       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910417332409       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910417379224       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910417398716       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.555212e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910416982929       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910417014182       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910417127662       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910417128888       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910417139536       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910417085969       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910417096001       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910417099048       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.907366e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910416982929       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910416990870       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910417020969       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910417021169       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910417022983       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910417009977       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910417012342       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910417012940       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.782786e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0704e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083141e-01 1 1  ON 0
 uu_1                 1.423483e-01 1 1  ON 1
 uu_2                 4.376725e-02 1 1  ON 2
 uu_3                -1.975860e-02 1 1  ON 3
 uu_4                -6.863537e-02 1 1  ON 4
 uu_5                -1.035355e-01 1 1  ON 5
 uu_6                -1.299032e-01 1 1  ON 6
 uu_7                -1.423360e-01 1 1  ON 7
 uu_8                -1.339614e-01 1 1  ON 8
 uu_9                -1.063402e-01 1 1  ON 9
 ud_0                 4.382718e-01 1 1  ON 10
 ud_1                 1.804585e-01 1 1  ON 11
 ud_2                 6.615556e-02 1 1  ON 12
 ud_3                -3.178333e-03 1 1  ON 13
 ud_4                -5.905571e-02 1 1  ON 14
 ud_5                -1.020680e-01 1 1  ON 15
 ud_6                -1.322537e-01 1 1  ON 16
 ud_7                -1.519993e-01 1 1  ON 17
 ud_8                -1.557410e-01 1 1  ON 18
 ud_9                -1.481640e-01 1 1  ON 19
 eO_0                -7.605115e-01 1 1  ON 20
 eO_1                -4.434476e-01 1 1  ON 21
 eO_2                -2.461553e-02 1 1  ON 22
 eO_3                 3.019592e-01 1 1  ON 23
 eO_4                 5.299997e-01 1 1  ON 24
 eO_5                 4.920385e-01 1 1  ON 25
 eO_6                 2.633257e-01 1 1  ON 26
 eO_7                -4.102881e-02 1 1  ON 27
 eO_8                -2.274658e-01 1 1  ON 28
 eO_9                -8.904390e-02 1 1  ON 29
eH1_0                -2.534467e-01 1 1  ON 30
eH1_1                -1.496776e-01 1 1  ON 31
eH1_2                -1.047748e-01 1 1  ON 32
eH1_3                -5.303590e-02 1 1  ON 33
eH1_4                -1.299945e-03 1 1  ON 34
eH1_5                 3.381319e-02 1 1  ON 35
eH1_6                 9.712438e-02 1 1  ON 36
eH1_7                 1.568576e-01 1 1  ON 37
eH1_8                 1.885092e-01 1 1  ON 38
eH1_9                 8.339995e-02 1 1  ON 39
eH2_0                -2.473052e-01 1 1  ON 40
eH2_1                -1.433779e-01 1 1  ON 41
eH2_2                -9.863494e-02 1 1  ON 42
eH2_3                -4.699624e-02 1 1  ON 43
eH2_4                 4.433304e-03 1 1  ON 44
eH2_5                 3.928383e-02 1 1  ON 45
eH2_6                 1.009149e-01 1 1  ON 46
eH2_7                 1.584915e-01 1 1  ON 47
eH2_8                 1.892619e-01 1 1  ON 48
eH2_9                 6.116368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8627
    reference variance = 0.327049
====================================================
  Execution time = 2.3951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3043e-01
  Total weights = 2.0000e+06
  Execution time = 2.7212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330223283188
                                         uncertainty =       0.003848021450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330223283188
                                         uncertainty =       0.003848021450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406461306
  error estimate for blocks of size 2^( 2) =       0.000418370209
  error estimate for blocks of size 2^( 3) =       0.000431148311
  error estimate for blocks of size 2^( 4) =       0.000443397254
  error estimate for blocks of size 2^( 5) =       0.000453217649
  error estimate for blocks of size 2^( 6) =       0.000462337462
  error estimate for blocks of size 2^( 7) =       0.000467482819

      target function =                  N/A
              le_mean =     -16.911003509906
             les_mean =     286.312461133445
             stat err =       0.000456608796
             autocorr =       1.261973193760
              std dev =       0.574823091585
             le_variance =       0.330421586620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330250531231
                                         uncertainty =       0.003848435708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330250531231
                                         uncertainty =       0.003848435708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406478083
  error estimate for blocks of size 2^( 2) =       0.000418386244
  error estimate for blocks of size 2^( 3) =       0.000431163327
  error estimate for blocks of size 2^( 4) =       0.000443411692
  error estimate for blocks of size 2^( 5) =       0.000453231511
  error estimate for blocks of size 2^( 6) =       0.000462349697
  error estimate for blocks of size 2^( 7) =       0.000467497779

      target function =                  N/A
              le_mean =     -16.911003827385
             les_mean =     286.312499148620
             stat err =       0.000456622670
             autocorr =       1.261945706407
              std dev =       0.574846817882
             le_variance =       0.330448864030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330240814605
                                         uncertainty =       0.003848308697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330240814605
                                         uncertainty =       0.003848308697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406472099
  error estimate for blocks of size 2^( 2) =       0.000418380507
  error estimate for blocks of size 2^( 3) =       0.000431157993
  error estimate for blocks of size 2^( 4) =       0.000443406614
  error estimate for blocks of size 2^( 5) =       0.000453226636
  error estimate for blocks of size 2^( 6) =       0.000462345478
  error estimate for blocks of size 2^( 7) =       0.000467492496

      target function =                  N/A
              le_mean =     -16.911003706195
             les_mean =     286.312485320695
             stat err =       0.000456617806
             autocorr =       1.261955975540
              std dev =       0.574838355514
             le_variance =       0.330439134970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330225627556
                                         uncertainty =       0.003848060755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330225627556
                                         uncertainty =       0.003848060755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406462749
  error estimate for blocks of size 2^( 2) =       0.000418371585
  error estimate for blocks of size 2^( 3) =       0.000431149606
  error estimate for blocks of size 2^( 4) =       0.000443398507
  error estimate for blocks of size 2^( 5) =       0.000453218852
  error estimate for blocks of size 2^( 6) =       0.000462338537
  error estimate for blocks of size 2^( 7) =       0.000467484115

      target function =                  N/A
              le_mean =     -16.911003535560
             les_mean =     286.312464347682
             stat err =       0.000456610003
             autocorr =       1.261970902639
              std dev =       0.574825132701
             le_variance =       0.330423933185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911003509906        initial
     1.5259e+00     1.5259e+01             1.5552e-04       -16.911003827385  <--
     6.1035e+00     6.1035e+01             3.9074e-05       -16.911003706195
     2.4414e+01     2.4414e+02             9.7828e-06       -16.911003535560

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.7589e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083174e-01 1 1  ON 0
 uu_1                 1.423529e-01 1 1  ON 1
 uu_2                 4.375632e-02 1 1  ON 2
 uu_3                -1.973493e-02 1 1  ON 3
 uu_4                -6.865927e-02 1 1  ON 4
 uu_5                -1.035317e-01 1 1  ON 5
 uu_6                -1.299233e-01 1 1  ON 6
 uu_7                -1.423640e-01 1 1  ON 7
 uu_8                -1.339439e-01 1 1  ON 8
 uu_9                -1.063560e-01 1 1  ON 9
 ud_0                 4.383072e-01 1 1  ON 10
 ud_1                 1.804668e-01 1 1  ON 11
 ud_2                 6.618326e-02 1 1  ON 12
 ud_3                -3.164162e-03 1 1  ON 13
 ud_4                -5.903240e-02 1 1  ON 14
 ud_5                -1.020830e-01 1 1  ON 15
 ud_6                -1.322500e-01 1 1  ON 16
 ud_7                -1.520438e-01 1 1  ON 17
 ud_8                -1.557501e-01 1 1  ON 18
 ud_9                -1.481726e-01 1 1  ON 19
 eO_0                -7.604964e-01 1 1  ON 20
 eO_1                -4.434667e-01 1 1  ON 21
 eO_2                -2.462588e-02 1 1  ON 22
 eO_3                 3.019590e-01 1 1  ON 23
 eO_4                 5.300124e-01 1 1  ON 24
 eO_5                 4.921172e-01 1 1  ON 25
 eO_6                 2.633550e-01 1 1  ON 26
 eO_7                -4.101757e-02 1 1  ON 27
 eO_8                -2.274970e-01 1 1  ON 28
 eO_9                -8.911217e-02 1 1  ON 29
eH1_0                -2.534414e-01 1 1  ON 30
eH1_1                -1.496970e-01 1 1  ON 31
eH1_2                -1.048354e-01 1 1  ON 32
eH1_3                -5.305118e-02 1 1  ON 33
eH1_4                -1.375555e-03 1 1  ON 34
eH1_5                 3.380244e-02 1 1  ON 35
eH1_6                 9.711138e-02 1 1  ON 36
eH1_7                 1.568799e-01 1 1  ON 37
eH1_8                 1.885864e-01 1 1  ON 38
eH1_9                 8.349221e-02 1 1  ON 39
eH2_0                -2.473364e-01 1 1  ON 40
eH2_1                -1.434153e-01 1 1  ON 41
eH2_2                -9.867025e-02 1 1  ON 42
eH2_3                -4.700668e-02 1 1  ON 43
eH2_4                 4.380082e-03 1 1  ON 44
eH2_5                 3.923537e-02 1 1  ON 45
eH2_6                 1.009440e-01 1 1  ON 46
eH2_7                 1.584978e-01 1 1  ON 47
eH2_8                 1.893137e-01 1 1  ON 48
eH2_9                 6.128012e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8737
    reference variance = 0.671103
====================================================
  Execution time = 2.6810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4252e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539683395
                                         uncertainty =       0.009716083283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539683395
                                         uncertainty =       0.009716083283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413834766
  error estimate for blocks of size 2^( 2) =       0.000425146743
  error estimate for blocks of size 2^( 3) =       0.000436484025
  error estimate for blocks of size 2^( 4) =       0.000448634365
  error estimate for blocks of size 2^( 5) =       0.000459359049
  error estimate for blocks of size 2^( 6) =       0.000466131025
  error estimate for blocks of size 2^( 7) =       0.000472581357

      target function =                  N/A
              le_mean =     -16.909602125891
             les_mean =     286.277162312433
             stat err =       0.000461676449
             autocorr =       1.244576210920
              std dev =       0.585250739220
             le_variance =       0.342518427758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690960212589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909602125891       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909602798823       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909602786330       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909603650296       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909602696622       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909603088689       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909603556302       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909603503064       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909603569166       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.096355e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909602125891       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909602351193       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909602339040       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909602684730       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909602354546       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909602412170       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909602570453       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909602586646       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.515248e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909602125891       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909602187436       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909602183764       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909602283761       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909602195428       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909602212566       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909602248916       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909602254748       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.827387e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3168e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083845e-01 1 1  ON 0
 uu_1                 1.423859e-01 1 1  ON 1
 uu_2                 4.375783e-02 1 1  ON 2
 uu_3                -1.975910e-02 1 1  ON 3
 uu_4                -6.867834e-02 1 1  ON 4
 uu_5                -1.036020e-01 1 1  ON 5
 uu_6                -1.300260e-01 1 1  ON 6
 uu_7                -1.424409e-01 1 1  ON 7
 uu_8                -1.339398e-01 1 1  ON 8
 uu_9                -1.062919e-01 1 1  ON 9
 ud_0                 4.383383e-01 1 1  ON 10
 ud_1                 1.804089e-01 1 1  ON 11
 ud_2                 6.617464e-02 1 1  ON 12
 ud_3                -3.219002e-03 1 1  ON 13
 ud_4                -5.907323e-02 1 1  ON 14
 ud_5                -1.020907e-01 1 1  ON 15
 ud_6                -1.321658e-01 1 1  ON 16
 ud_7                -1.521110e-01 1 1  ON 17
 ud_8                -1.557490e-01 1 1  ON 18
 ud_9                -1.480841e-01 1 1  ON 19
 eO_0                -7.604750e-01 1 1  ON 20
 eO_1                -4.434967e-01 1 1  ON 21
 eO_2                -2.465205e-02 1 1  ON 22
 eO_3                 3.020092e-01 1 1  ON 23
 eO_4                 5.300317e-01 1 1  ON 24
 eO_5                 4.921548e-01 1 1  ON 25
 eO_6                 2.633649e-01 1 1  ON 26
 eO_7                -4.100408e-02 1 1  ON 27
 eO_8                -2.275310e-01 1 1  ON 28
 eO_9                -8.916565e-02 1 1  ON 29
eH1_0                -2.534978e-01 1 1  ON 30
eH1_1                -1.497883e-01 1 1  ON 31
eH1_2                -1.048615e-01 1 1  ON 32
eH1_3                -5.306590e-02 1 1  ON 33
eH1_4                -1.390183e-03 1 1  ON 34
eH1_5                 3.377978e-02 1 1  ON 35
eH1_6                 9.712712e-02 1 1  ON 36
eH1_7                 1.568371e-01 1 1  ON 37
eH1_8                 1.886524e-01 1 1  ON 38
eH1_9                 8.364374e-02 1 1  ON 39
eH2_0                -2.473614e-01 1 1  ON 40
eH2_1                -1.435236e-01 1 1  ON 41
eH2_2                -9.871764e-02 1 1  ON 42
eH2_3                -4.695992e-02 1 1  ON 43
eH2_4                 4.366179e-03 1 1  ON 44
eH2_5                 3.916348e-02 1 1  ON 45
eH2_6                 1.008989e-01 1 1  ON 46
eH2_7                 1.584946e-01 1 1  ON 47
eH2_8                 1.894115e-01 1 1  ON 48
eH2_9                 6.142557e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.262698
====================================================
  Execution time = 2.3812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4103e-01
  Total weights = 2.0000e+06
  Execution time = 2.7013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341064258665
                                         uncertainty =       0.006186068542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341064258665
                                         uncertainty =       0.006186068542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412895149
  error estimate for blocks of size 2^( 2) =       0.000424494029
  error estimate for blocks of size 2^( 3) =       0.000435689209
  error estimate for blocks of size 2^( 4) =       0.000446009817
  error estimate for blocks of size 2^( 5) =       0.000454719051
  error estimate for blocks of size 2^( 6) =       0.000460648447
  error estimate for blocks of size 2^( 7) =       0.000465825532

      target function =                  N/A
              le_mean =     -16.910582394596
             les_mean =     286.308761562839
             stat err =       0.000456800712
             autocorr =       1.223979043043
              std dev =       0.583921920212
             le_variance =       0.340964808904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341215960927
                                         uncertainty =       0.006187482536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341215960927
                                         uncertainty =       0.006187482536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412986959
  error estimate for blocks of size 2^( 2) =       0.000424583617
  error estimate for blocks of size 2^( 3) =       0.000435776162
  error estimate for blocks of size 2^( 4) =       0.000446094769
  error estimate for blocks of size 2^( 5) =       0.000454800873
  error estimate for blocks of size 2^( 6) =       0.000460729759
  error estimate for blocks of size 2^( 7) =       0.000465911331

      target function =                  N/A
              le_mean =     -16.910584171021
             les_mean =     286.308973291474
             stat err =       0.000456884183
             autocorr =       1.223882064823
              std dev =       0.584051758699
             le_variance =       0.341116456839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341190149074
                                         uncertainty =       0.006187451047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341190149074
                                         uncertainty =       0.006187451047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412971353
  error estimate for blocks of size 2^( 2) =       0.000424568251
  error estimate for blocks of size 2^( 3) =       0.000435761326
  error estimate for blocks of size 2^( 4) =       0.000446079967
  error estimate for blocks of size 2^( 5) =       0.000454787117
  error estimate for blocks of size 2^( 6) =       0.000460716141
  error estimate for blocks of size 2^( 7) =       0.000465897580

      target function =                  N/A
              le_mean =     -16.910583658881
             les_mean =     286.308930190699
             stat err =       0.000456870201
             autocorr =       1.223899653732
              std dev =       0.584029688648
             le_variance =       0.341090677222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341083252320
                                         uncertainty =       0.006186292360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341083252320
                                         uncertainty =       0.006186292360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412906648
  error estimate for blocks of size 2^( 2) =       0.000424505214
  error estimate for blocks of size 2^( 3) =       0.000435700076
  error estimate for blocks of size 2^( 4) =       0.000446020375
  error estimate for blocks of size 2^( 5) =       0.000454729331
  error estimate for blocks of size 2^( 6) =       0.000460658679
  error estimate for blocks of size 2^( 7) =       0.000465836428

      target function =                  N/A
              le_mean =     -16.910582557921
             les_mean =     286.308786077954
             stat err =       0.000456811203
             autocorr =       1.223967093421
              std dev =       0.583938181826
             le_variance =       0.340983800194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910582394596        initial
     3.8147e-01     3.8147e+00             6.0964e-04       -16.910584171021  <--
     1.5259e+00     1.5259e+01             1.5152e-04       -16.910583658881
     6.1035e+00     6.1035e+01             3.8274e-05       -16.910582557921

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.7354e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.085348e-01 1 1  ON 0
 uu_1                 1.424469e-01 1 1  ON 1
 uu_2                 4.375731e-02 1 1  ON 2
 uu_3                -1.981497e-02 1 1  ON 3
 uu_4                -6.875103e-02 1 1  ON 4
 uu_5                -1.037691e-01 1 1  ON 5
 uu_6                -1.302704e-01 1 1  ON 6
 uu_7                -1.426621e-01 1 1  ON 7
 uu_8                -1.339481e-01 1 1  ON 8
 uu_9                -1.061075e-01 1 1  ON 9
 ud_0                 4.383207e-01 1 1  ON 10
 ud_1                 1.803094e-01 1 1  ON 11
 ud_2                 6.612125e-02 1 1  ON 12
 ud_3                -3.323968e-03 1 1  ON 13
 ud_4                -5.916252e-02 1 1  ON 14
 ud_5                -1.021031e-01 1 1  ON 15
 ud_6                -1.320055e-01 1 1  ON 16
 ud_7                -1.522458e-01 1 1  ON 17
 ud_8                -1.557471e-01 1 1  ON 18
 ud_9                -1.478308e-01 1 1  ON 19
 eO_0                -7.604872e-01 1 1  ON 20
 eO_1                -4.435194e-01 1 1  ON 21
 eO_2                -2.470132e-02 1 1  ON 22
 eO_3                 3.021068e-01 1 1  ON 23
 eO_4                 5.301037e-01 1 1  ON 24
 eO_5                 4.922791e-01 1 1  ON 25
 eO_6                 2.634083e-01 1 1  ON 26
 eO_7                -4.096045e-02 1 1  ON 27
 eO_8                -2.276392e-01 1 1  ON 28
 eO_9                -8.932910e-02 1 1  ON 29
eH1_0                -2.536791e-01 1 1  ON 30
eH1_1                -1.500129e-01 1 1  ON 31
eH1_2                -1.049610e-01 1 1  ON 32
eH1_3                -5.311389e-02 1 1  ON 33
eH1_4                -1.451112e-03 1 1  ON 34
eH1_5                 3.370433e-02 1 1  ON 35
eH1_6                 9.717228e-02 1 1  ON 36
eH1_7                 1.567155e-01 1 1  ON 37
eH1_8                 1.888537e-01 1 1  ON 38
eH1_9                 8.410185e-02 1 1  ON 39
eH2_0                -2.474642e-01 1 1  ON 40
eH2_1                -1.437738e-01 1 1  ON 41
eH2_2                -9.883953e-02 1 1  ON 42
eH2_3                -4.690636e-02 1 1  ON 43
eH2_4                 4.325452e-03 1 1  ON 44
eH2_5                 3.896302e-02 1 1  ON 45
eH2_6                 1.007637e-01 1 1  ON 46
eH2_7                 1.584825e-01 1 1  ON 47
eH2_8                 1.897056e-01 1 1  ON 48
eH2_9                 6.186563e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9894
    reference variance = 0.13877
====================================================
  Execution time = 2.4467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4571e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345282367802
                                         uncertainty =       0.007287116100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345282367802
                                         uncertainty =       0.007287116100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415760060
  error estimate for blocks of size 2^( 2) =       0.000427233376
  error estimate for blocks of size 2^( 3) =       0.000439546254
  error estimate for blocks of size 2^( 4) =       0.000451635526
  error estimate for blocks of size 2^( 5) =       0.000461836430
  error estimate for blocks of size 2^( 6) =       0.000471366896
  error estimate for blocks of size 2^( 7) =       0.000480340244

      target function =                  N/A
              le_mean =     -16.910703590040
             les_mean =     286.317608591872
             stat err =       0.000466294774
             autocorr =       1.257869433628
              std dev =       0.587973515161
             le_variance =       0.345712854531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691070359004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910703590040       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910703328098       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910703640461       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910701746007       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910703736042       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910701311462       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910704875141       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910706135340       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910705989396       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910705654617       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910705460462       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.367502e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910703590040       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910703468510       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910703364985       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910702071726       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910702905671       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910702917725       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910702911109       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910703459720       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910703369471       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.964307e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910703590040       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910703551388       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910703445112       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910702991584       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910703286666       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910703326061       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910703242092       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910703307146       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.485335e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0897e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083704e-01 1 1  ON 0
 uu_1                 1.425264e-01 1 1  ON 1
 uu_2                 4.381905e-02 1 1  ON 2
 uu_3                -1.969209e-02 1 1  ON 3
 uu_4                -6.882503e-02 1 1  ON 4
 uu_5                -1.038294e-01 1 1  ON 5
 uu_6                -1.302839e-01 1 1  ON 6
 uu_7                -1.428003e-01 1 1  ON 7
 uu_8                -1.340720e-01 1 1  ON 8
 uu_9                -1.061960e-01 1 1  ON 9
 ud_0                 4.380810e-01 1 1  ON 10
 ud_1                 1.802066e-01 1 1  ON 11
 ud_2                 6.590586e-02 1 1  ON 12
 ud_3                -3.301650e-03 1 1  ON 13
 ud_4                -5.912577e-02 1 1  ON 14
 ud_5                -1.019537e-01 1 1  ON 15
 ud_6                -1.319969e-01 1 1  ON 16
 ud_7                -1.522977e-01 1 1  ON 17
 ud_8                -1.556360e-01 1 1  ON 18
 ud_9                -1.475616e-01 1 1  ON 19
 eO_0                -7.605038e-01 1 1  ON 20
 eO_1                -4.433675e-01 1 1  ON 21
 eO_2                -2.473836e-02 1 1  ON 22
 eO_3                 3.020201e-01 1 1  ON 23
 eO_4                 5.300570e-01 1 1  ON 24
 eO_5                 4.924794e-01 1 1  ON 25
 eO_6                 2.636775e-01 1 1  ON 26
 eO_7                -4.092628e-02 1 1  ON 27
 eO_8                -2.278189e-01 1 1  ON 28
 eO_9                -8.959422e-02 1 1  ON 29
eH1_0                -2.538676e-01 1 1  ON 30
eH1_1                -1.499722e-01 1 1  ON 31
eH1_2                -1.050079e-01 1 1  ON 32
eH1_3                -5.314255e-02 1 1  ON 33
eH1_4                -1.612353e-03 1 1  ON 34
eH1_5                 3.368878e-02 1 1  ON 35
eH1_6                 9.692260e-02 1 1  ON 36
eH1_7                 1.566711e-01 1 1  ON 37
eH1_8                 1.890875e-01 1 1  ON 38
eH1_9                 8.448868e-02 1 1  ON 39
eH2_0                -2.477202e-01 1 1  ON 40
eH2_1                -1.439348e-01 1 1  ON 41
eH2_2                -9.916641e-02 1 1  ON 42
eH2_3                -4.713305e-02 1 1  ON 43
eH2_4                 4.104836e-03 1 1  ON 44
eH2_5                 3.883486e-02 1 1  ON 45
eH2_6                 1.007802e-01 1 1  ON 46
eH2_7                 1.586638e-01 1 1  ON 47
eH2_8                 1.901958e-01 1 1  ON 48
eH2_9                 6.246207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.95
    reference variance = 0.233965
====================================================
  Execution time = 2.3987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3516e-01
  Total weights = 2.0000e+06
  Execution time = 2.7075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335302136626
                                         uncertainty =       0.004027788763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335302136626
                                         uncertainty =       0.004027788763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409425262
  error estimate for blocks of size 2^( 2) =       0.000421480221
  error estimate for blocks of size 2^( 3) =       0.000433952410
  error estimate for blocks of size 2^( 4) =       0.000444834196
  error estimate for blocks of size 2^( 5) =       0.000454752280
  error estimate for blocks of size 2^( 6) =       0.000462398905
  error estimate for blocks of size 2^( 7) =       0.000466151232

      target function =                  N/A
              le_mean =     -16.910138650419
             les_mean =     286.288047098858
             stat err =       0.000457034153
             autocorr =       1.246086065254
              std dev =       0.579014758095
             le_variance =       0.335258090092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335117865811
                                         uncertainty =       0.004025636725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335117865811
                                         uncertainty =       0.004025636725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409312681
  error estimate for blocks of size 2^( 2) =       0.000421372037
  error estimate for blocks of size 2^( 3) =       0.000433854280
  error estimate for blocks of size 2^( 4) =       0.000444737261
  error estimate for blocks of size 2^( 5) =       0.000454655340
  error estimate for blocks of size 2^( 6) =       0.000462296458
  error estimate for blocks of size 2^( 7) =       0.000466038396

      target function =                  N/A
              le_mean =     -16.910139761050
             les_mean =     286.287900312138
             stat err =       0.000456931864
             autocorr =       1.246213608044
              std dev =       0.578855544539
             le_variance =       0.335073741444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335112244075
                                         uncertainty =       0.004025578535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335112244075
                                         uncertainty =       0.004025578535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409309244
  error estimate for blocks of size 2^( 2) =       0.000421366296
  error estimate for blocks of size 2^( 3) =       0.000433846820
  error estimate for blocks of size 2^( 4) =       0.000444729823
  error estimate for blocks of size 2^( 5) =       0.000454650912
  error estimate for blocks of size 2^( 6) =       0.000462295368
  error estimate for blocks of size 2^( 7) =       0.000466037837

      target function =                  N/A
              le_mean =     -16.910140237297
             les_mean =     286.287910791278
             stat err =       0.000456928485
             autocorr =       1.246216108368
              std dev =       0.578850683472
             le_variance =       0.335068113757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335267860914
                                         uncertainty =       0.004027332759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335267860914
                                         uncertainty =       0.004027332759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409404322
  error estimate for blocks of size 2^( 2) =       0.000421459234
  error estimate for blocks of size 2^( 3) =       0.000433932662
  error estimate for blocks of size 2^( 4) =       0.000444814534
  error estimate for blocks of size 2^( 5) =       0.000454733357
  error estimate for blocks of size 2^( 6) =       0.000462379767
  error estimate for blocks of size 2^( 7) =       0.000466130952

      target function =                  N/A
              le_mean =     -16.910138867961
             les_mean =     286.288020163366
             stat err =       0.000457014652
             autocorr =       1.246107192256
              std dev =       0.578985144250
             le_variance =       0.335223797263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910138650419        initial
     9.5367e-02     9.5367e-01             2.3675e-03       -16.910139761050
     3.8147e-01     3.8147e+00             5.9643e-04       -16.910140237297  <--
     1.5259e+00     1.5259e+01             1.4853e-04       -16.910138867961

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.7662e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083704e-01 1 1  ON 0
 uu_1                 1.425264e-01 1 1  ON 1
 uu_2                 4.381905e-02 1 1  ON 2
 uu_3                -1.969209e-02 1 1  ON 3
 uu_4                -6.882503e-02 1 1  ON 4
 uu_5                -1.038294e-01 1 1  ON 5
 uu_6                -1.302839e-01 1 1  ON 6
 uu_7                -1.428003e-01 1 1  ON 7
 uu_8                -1.340720e-01 1 1  ON 8
 uu_9                -1.061960e-01 1 1  ON 9
 ud_0                 4.380810e-01 1 1  ON 10
 ud_1                 1.802066e-01 1 1  ON 11
 ud_2                 6.590586e-02 1 1  ON 12
 ud_3                -3.301650e-03 1 1  ON 13
 ud_4                -5.912577e-02 1 1  ON 14
 ud_5                -1.019537e-01 1 1  ON 15
 ud_6                -1.319969e-01 1 1  ON 16
 ud_7                -1.522977e-01 1 1  ON 17
 ud_8                -1.556360e-01 1 1  ON 18
 ud_9                -1.475616e-01 1 1  ON 19
 eO_0                -7.605038e-01 1 1  ON 20
 eO_1                -4.433675e-01 1 1  ON 21
 eO_2                -2.473836e-02 1 1  ON 22
 eO_3                 3.020201e-01 1 1  ON 23
 eO_4                 5.300570e-01 1 1  ON 24
 eO_5                 4.924794e-01 1 1  ON 25
 eO_6                 2.636775e-01 1 1  ON 26
 eO_7                -4.092628e-02 1 1  ON 27
 eO_8                -2.278189e-01 1 1  ON 28
 eO_9                -8.959422e-02 1 1  ON 29
eH1_0                -2.538676e-01 1 1  ON 30
eH1_1                -1.499722e-01 1 1  ON 31
eH1_2                -1.050079e-01 1 1  ON 32
eH1_3                -5.314255e-02 1 1  ON 33
eH1_4                -1.612353e-03 1 1  ON 34
eH1_5                 3.368878e-02 1 1  ON 35
eH1_6                 9.692260e-02 1 1  ON 36
eH1_7                 1.566711e-01 1 1  ON 37
eH1_8                 1.890875e-01 1 1  ON 38
eH1_9                 8.448868e-02 1 1  ON 39
eH2_0                -2.477202e-01 1 1  ON 40
eH2_1                -1.439348e-01 1 1  ON 41
eH2_2                -9.916641e-02 1 1  ON 42
eH2_3                -4.713305e-02 1 1  ON 43
eH2_4                 4.104836e-03 1 1  ON 44
eH2_5                 3.883486e-02 1 1  ON 45
eH2_6                 1.007802e-01 1 1  ON 46
eH2_7                 1.586638e-01 1 1  ON 47
eH2_8                 1.901958e-01 1 1  ON 48
eH2_9                 6.246207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8565e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8807
    reference variance = 0.292988
====================================================
  Execution time = 2.4461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326263874701
                                         uncertainty =       0.003920716925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326263874701
                                         uncertainty =       0.003920716925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403874394
  error estimate for blocks of size 2^( 2) =       0.000416265058
  error estimate for blocks of size 2^( 3) =       0.000428466166
  error estimate for blocks of size 2^( 4) =       0.000440587662
  error estimate for blocks of size 2^( 5) =       0.000451341794
  error estimate for blocks of size 2^( 6) =       0.000460851017
  error estimate for blocks of size 2^( 7) =       0.000467183469

      target function =                  N/A
              le_mean =     -16.910397508064
             les_mean =     286.287772770445
             stat err =       0.000454990986
             autocorr =       1.269149973625
              std dev =       0.571164645985
             le_variance =       0.326229052824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691039750806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910397508064       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910398049719       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910397679363       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910397375219       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910397192555       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910396886373       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910397450425       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910398182392       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910398407987       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910398295786       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910398093723       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910398447684       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.344838e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910397508064       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910397783963       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910397580787       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910397362762       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910397245456       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910397063787       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910397176260       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910397511694       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910397484839       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.830790e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910397508064       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910397601193       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910397531535       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910397444679       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910397402151       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910397347067       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910397342807       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910397404113       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.428934e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0827e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083034e-01 1 1  ON 0
 uu_1                 1.424062e-01 1 1  ON 1
 uu_2                 4.378890e-02 1 1  ON 2
 uu_3                -1.978705e-02 1 1  ON 3
 uu_4                -6.873551e-02 1 1  ON 4
 uu_5                -1.039624e-01 1 1  ON 5
 uu_6                -1.303400e-01 1 1  ON 6
 uu_7                -1.425947e-01 1 1  ON 7
 uu_8                -1.340788e-01 1 1  ON 8
 uu_9                -1.063207e-01 1 1  ON 9
 ud_0                 4.381846e-01 1 1  ON 10
 ud_1                 1.803672e-01 1 1  ON 11
 ud_2                 6.601604e-02 1 1  ON 12
 ud_3                -3.143674e-03 1 1  ON 13
 ud_4                -5.912451e-02 1 1  ON 14
 ud_5                -1.021036e-01 1 1  ON 15
 ud_6                -1.321301e-01 1 1  ON 16
 ud_7                -1.522468e-01 1 1  ON 17
 ud_8                -1.557212e-01 1 1  ON 18
 ud_9                -1.476771e-01 1 1  ON 19
 eO_0                -7.605127e-01 1 1  ON 20
 eO_1                -4.435117e-01 1 1  ON 21
 eO_2                -2.474685e-02 1 1  ON 22
 eO_3                 3.022467e-01 1 1  ON 23
 eO_4                 5.302529e-01 1 1  ON 24
 eO_5                 4.925102e-01 1 1  ON 25
 eO_6                 2.638608e-01 1 1  ON 26
 eO_7                -4.068613e-02 1 1  ON 27
 eO_8                -2.281341e-01 1 1  ON 28
 eO_9                -8.994221e-02 1 1  ON 29
eH1_0                -2.542334e-01 1 1  ON 30
eH1_1                -1.500504e-01 1 1  ON 31
eH1_2                -1.052564e-01 1 1  ON 32
eH1_3                -5.319442e-02 1 1  ON 33
eH1_4                -1.733005e-03 1 1  ON 34
eH1_5                 3.353208e-02 1 1  ON 35
eH1_6                 9.695033e-02 1 1  ON 36
eH1_7                 1.565610e-01 1 1  ON 37
eH1_8                 1.895314e-01 1 1  ON 38
eH1_9                 8.507175e-02 1 1  ON 39
eH2_0                -2.477935e-01 1 1  ON 40
eH2_1                -1.442126e-01 1 1  ON 41
eH2_2                -9.938477e-02 1 1  ON 42
eH2_3                -4.729034e-02 1 1  ON 43
eH2_4                 3.834401e-03 1 1  ON 44
eH2_5                 3.894410e-02 1 1  ON 45
eH2_6                 1.009520e-01 1 1  ON 46
eH2_7                 1.585910e-01 1 1  ON 47
eH2_8                 1.903938e-01 1 1  ON 48
eH2_9                 6.300112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.307018
====================================================
  Execution time = 2.3874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3030e-01
  Total weights = 2.0000e+06
  Execution time = 2.7169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330306150466
                                         uncertainty =       0.006238438912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330306150466
                                         uncertainty =       0.006238438912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406400352
  error estimate for blocks of size 2^( 2) =       0.000418277535
  error estimate for blocks of size 2^( 3) =       0.000430470632
  error estimate for blocks of size 2^( 4) =       0.000441682811
  error estimate for blocks of size 2^( 5) =       0.000452064823
  error estimate for blocks of size 2^( 6) =       0.000459824998
  error estimate for blocks of size 2^( 7) =       0.000463867623

      target function =                  N/A
              le_mean =     -16.909480745108
             les_mean =     286.260861397019
             stat err =       0.000454360064
             autocorr =       1.249948592611
              std dev =       0.574736890237
             le_variance =       0.330322492999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330326989775
                                         uncertainty =       0.006238454635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330326989775
                                         uncertainty =       0.006238454635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406413103
  error estimate for blocks of size 2^( 2) =       0.000418294257
  error estimate for blocks of size 2^( 3) =       0.000430490724
  error estimate for blocks of size 2^( 4) =       0.000441698613
  error estimate for blocks of size 2^( 5) =       0.000452074128
  error estimate for blocks of size 2^( 6) =       0.000459815153
  error estimate for blocks of size 2^( 7) =       0.000463849661

      target function =                  N/A
              le_mean =     -16.909483290562
             les_mean =     286.260968208740
             stat err =       0.000454359389
             autocorr =       1.249866452343
              std dev =       0.574754921781
             le_variance =       0.330343220111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330259120227
                                         uncertainty =       0.006237950465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330259120227
                                         uncertainty =       0.006237950465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406371356
  error estimate for blocks of size 2^( 2) =       0.000418253270
  error estimate for blocks of size 2^( 3) =       0.000430451994
  error estimate for blocks of size 2^( 4) =       0.000441663574
  error estimate for blocks of size 2^( 5) =       0.000452042527
  error estimate for blocks of size 2^( 6) =       0.000459785125
  error estimate for blocks of size 2^( 7) =       0.000463820013

      target function =                  N/A
              le_mean =     -16.909483343793
             les_mean =     286.260902146182
             stat err =       0.000454327810
             autocorr =       1.249949500242
              std dev =       0.574695882456
             le_variance =       0.330275357312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330291468987
                                         uncertainty =       0.006238245129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330291468987
                                         uncertainty =       0.006238245129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406391306
  error estimate for blocks of size 2^( 2) =       0.000418269330
  error estimate for blocks of size 2^( 3) =       0.000430463579
  error estimate for blocks of size 2^( 4) =       0.000441675869
  error estimate for blocks of size 2^( 5) =       0.000452057717
  error estimate for blocks of size 2^( 6) =       0.000459814724
  error estimate for blocks of size 2^( 7) =       0.000463856094

      target function =                  N/A
              le_mean =     -16.909481054300
             les_mean =     286.260857147516
             stat err =       0.000454351101
             autocorr =       1.249954927696
              std dev =       0.574724096357
             le_variance =       0.330307786933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909480745108        initial
     9.5367e-02     9.5367e-01             2.3448e-03       -16.909483290562
     3.8147e-01     3.8147e+00             5.8308e-04       -16.909483343793  <--
     1.5259e+00     1.5259e+01             1.4289e-04       -16.909481054300

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.7513e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083034e-01 1 1  ON 0
 uu_1                 1.424062e-01 1 1  ON 1
 uu_2                 4.378890e-02 1 1  ON 2
 uu_3                -1.978705e-02 1 1  ON 3
 uu_4                -6.873551e-02 1 1  ON 4
 uu_5                -1.039624e-01 1 1  ON 5
 uu_6                -1.303400e-01 1 1  ON 6
 uu_7                -1.425947e-01 1 1  ON 7
 uu_8                -1.340788e-01 1 1  ON 8
 uu_9                -1.063207e-01 1 1  ON 9
 ud_0                 4.381846e-01 1 1  ON 10
 ud_1                 1.803672e-01 1 1  ON 11
 ud_2                 6.601604e-02 1 1  ON 12
 ud_3                -3.143674e-03 1 1  ON 13
 ud_4                -5.912451e-02 1 1  ON 14
 ud_5                -1.021036e-01 1 1  ON 15
 ud_6                -1.321301e-01 1 1  ON 16
 ud_7                -1.522468e-01 1 1  ON 17
 ud_8                -1.557212e-01 1 1  ON 18
 ud_9                -1.476771e-01 1 1  ON 19
 eO_0                -7.605127e-01 1 1  ON 20
 eO_1                -4.435117e-01 1 1  ON 21
 eO_2                -2.474685e-02 1 1  ON 22
 eO_3                 3.022467e-01 1 1  ON 23
 eO_4                 5.302529e-01 1 1  ON 24
 eO_5                 4.925102e-01 1 1  ON 25
 eO_6                 2.638608e-01 1 1  ON 26
 eO_7                -4.068613e-02 1 1  ON 27
 eO_8                -2.281341e-01 1 1  ON 28
 eO_9                -8.994221e-02 1 1  ON 29
eH1_0                -2.542334e-01 1 1  ON 30
eH1_1                -1.500504e-01 1 1  ON 31
eH1_2                -1.052564e-01 1 1  ON 32
eH1_3                -5.319442e-02 1 1  ON 33
eH1_4                -1.733005e-03 1 1  ON 34
eH1_5                 3.353208e-02 1 1  ON 35
eH1_6                 9.695033e-02 1 1  ON 36
eH1_7                 1.565610e-01 1 1  ON 37
eH1_8                 1.895314e-01 1 1  ON 38
eH1_9                 8.507175e-02 1 1  ON 39
eH2_0                -2.477935e-01 1 1  ON 40
eH2_1                -1.442126e-01 1 1  ON 41
eH2_2                -9.938477e-02 1 1  ON 42
eH2_3                -4.729034e-02 1 1  ON 43
eH2_4                 3.834401e-03 1 1  ON 44
eH2_5                 3.894410e-02 1 1  ON 45
eH2_6                 1.009520e-01 1 1  ON 46
eH2_7                 1.585910e-01 1 1  ON 47
eH2_8                 1.903938e-01 1 1  ON 48
eH2_9                 6.300112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9374
    reference variance = 0.689848
====================================================
  Execution time = 2.4250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330475271578
                                         uncertainty =       0.004121632214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330475271578
                                         uncertainty =       0.004121632214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406447726
  error estimate for blocks of size 2^( 2) =       0.000417700758
  error estimate for blocks of size 2^( 3) =       0.000429751452
  error estimate for blocks of size 2^( 4) =       0.000440713620
  error estimate for blocks of size 2^( 5) =       0.000450305176
  error estimate for blocks of size 2^( 6) =       0.000458523249
  error estimate for blocks of size 2^( 7) =       0.000460040487

      target function =                  N/A
              le_mean =     -16.910247114705
             les_mean =     286.286856823502
             stat err =       0.000452395633
             autocorr =       1.238874779006
              std dev =       0.574803886834
             le_variance =       0.330399508320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691024711470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910247114705       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910247978333       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910250858193       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910251553154       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910250209624       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910251703018       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910251253042       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910252522062       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910252895466       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910253016617       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910252778102       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910252850665       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.363539e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910247114705       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910247496169       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910248414461       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910248335781       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910247616358       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910248367210       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910248138233       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910248451592       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910248482225       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.833515e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910247114705       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910247232688       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910247399906       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910247260434       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910247060730       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910247296264       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910247281980       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910247337885       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.467508e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0596e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8859
    reference variance = 0.200089
====================================================
  Execution time = 2.3953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2913e-01
  Total weights = 2.0000e+06
  Execution time = 2.7311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329074706137
                                         uncertainty =       0.003387460631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329074706137
                                         uncertainty =       0.003387460631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405748312
  error estimate for blocks of size 2^( 2) =       0.000418437322
  error estimate for blocks of size 2^( 3) =       0.000431778009
  error estimate for blocks of size 2^( 4) =       0.000444077992
  error estimate for blocks of size 2^( 5) =       0.000455372133
  error estimate for blocks of size 2^( 6) =       0.000465532002
  error estimate for blocks of size 2^( 7) =       0.000471451735

      target function =                  N/A
              le_mean =     -16.910168989517
             les_mean =     286.283078474553
             stat err =       0.000459108465
             autocorr =       1.280315956507
              std dev =       0.573814765559
             le_variance =       0.329263385174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328912926466
                                         uncertainty =       0.003385134526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328912926466
                                         uncertainty =       0.003385134526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405648887
  error estimate for blocks of size 2^( 2) =       0.000418338821
  error estimate for blocks of size 2^( 3) =       0.000431674824
  error estimate for blocks of size 2^( 4) =       0.000443969117
  error estimate for blocks of size 2^( 5) =       0.000455256204
  error estimate for blocks of size 2^( 6) =       0.000465427154
  error estimate for blocks of size 2^( 7) =       0.000471346078

      target function =                  N/A
              le_mean =     -16.910168571246
             les_mean =     286.282902981949
             stat err =       0.000458999638
             autocorr =       1.280336451223
              std dev =       0.573674157120
             le_variance =       0.329102038548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328816820853
                                         uncertainty =       0.003383996541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328816820853
                                         uncertainty =       0.003383996541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405589719
  error estimate for blocks of size 2^( 2) =       0.000418282415
  error estimate for blocks of size 2^( 3) =       0.000431623075
  error estimate for blocks of size 2^( 4) =       0.000443924599
  error estimate for blocks of size 2^( 5) =       0.000455216101
  error estimate for blocks of size 2^( 6) =       0.000465390869
  error estimate for blocks of size 2^( 7) =       0.000471309197

      target function =                  N/A
              le_mean =     -16.910169514360
             les_mean =     286.282838880517
             stat err =       0.000458960191
             autocorr =       1.280489908126
              std dev =       0.573590481653
             le_variance =       0.329006040643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329013358970
                                         uncertainty =       0.003386667643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329013358970
                                         uncertainty =       0.003386667643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405710565
  error estimate for blocks of size 2^( 2) =       0.000418400692
  error estimate for blocks of size 2^( 3) =       0.000431741956
  error estimate for blocks of size 2^( 4) =       0.000444042901
  error estimate for blocks of size 2^( 5) =       0.000455337054
  error estimate for blocks of size 2^( 6) =       0.000465499884
  error estimate for blocks of size 2^( 7) =       0.000471419430

      target function =                  N/A
              le_mean =     -16.910168985804
             les_mean =     286.283017089256
             stat err =       0.000459074817
             autocorr =       1.280366507695
              std dev =       0.573761383681
             le_variance =       0.329202125404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910168989517        initial
     9.5367e-02     9.5367e-01             2.3635e-03       -16.910168571246
     3.8147e-01     3.8147e+00             5.8335e-04       -16.910169514360  <--
     1.5259e+00     1.5259e+01             1.4675e-04       -16.910168985804

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.7637e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9963
    reference variance = 0.322598
====================================================
  Execution time = 2.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3410e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334150054271
                                         uncertainty =       0.005407389801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334150054271
                                         uncertainty =       0.005407389801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408718354
  error estimate for blocks of size 2^( 2) =       0.000420457940
  error estimate for blocks of size 2^( 3) =       0.000433694337
  error estimate for blocks of size 2^( 4) =       0.000446770939
  error estimate for blocks of size 2^( 5) =       0.000458106942
  error estimate for blocks of size 2^( 6) =       0.000466708618
  error estimate for blocks of size 2^( 7) =       0.000472485300

      target function =                  N/A
              le_mean =     -16.909514903584
             les_mean =     286.265795493661
             stat err =       0.000461017950
             autocorr =       1.272293734232
              std dev =       0.578015039747
             le_variance =       0.334101386174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690951490358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514903584       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515859940       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909516493413       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909517562434       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909516465392       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909517339209       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909517676488       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909519032161       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909518204610       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909517877481       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909518138702       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909518452325       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909518376196       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.099008e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514903584       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515383140       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515427359       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515937295       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909515451257       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515868917       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909516048420       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909516005240       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909515919370       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909515822125       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.157650e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909514903584       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515063744       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515041230       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515172837       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909515071696       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515184987       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909515214184       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909515210783       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.310221e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1456e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.083422e-01 1 1  ON 0
 uu_1                 1.425534e-01 1 1  ON 1
 uu_2                 4.376504e-02 1 1  ON 2
 uu_3                -1.990243e-02 1 1  ON 3
 uu_4                -6.897349e-02 1 1  ON 4
 uu_5                -1.041262e-01 1 1  ON 5
 uu_6                -1.306398e-01 1 1  ON 6
 uu_7                -1.429051e-01 1 1  ON 7
 uu_8                -1.339651e-01 1 1  ON 8
 uu_9                -1.062883e-01 1 1  ON 9
 ud_0                 4.382541e-01 1 1  ON 10
 ud_1                 1.804578e-01 1 1  ON 11
 ud_2                 6.623521e-02 1 1  ON 12
 ud_3                -3.085427e-03 1 1  ON 13
 ud_4                -5.904267e-02 1 1  ON 14
 ud_5                -1.021137e-01 1 1  ON 15
 ud_6                -1.322079e-01 1 1  ON 16
 ud_7                -1.521944e-01 1 1  ON 17
 ud_8                -1.558426e-01 1 1  ON 18
 ud_9                -1.477753e-01 1 1  ON 19
 eO_0                -7.605019e-01 1 1  ON 20
 eO_1                -4.435866e-01 1 1  ON 21
 eO_2                -2.486858e-02 1 1  ON 22
 eO_3                 3.023678e-01 1 1  ON 23
 eO_4                 5.305641e-01 1 1  ON 24
 eO_5                 4.929617e-01 1 1  ON 25
 eO_6                 2.639921e-01 1 1  ON 26
 eO_7                -4.042969e-02 1 1  ON 27
 eO_8                -2.284467e-01 1 1  ON 28
 eO_9                -9.060505e-02 1 1  ON 29
eH1_0                -2.541670e-01 1 1  ON 30
eH1_1                -1.504644e-01 1 1  ON 31
eH1_2                -1.056057e-01 1 1  ON 32
eH1_3                -5.346054e-02 1 1  ON 33
eH1_4                -2.000218e-03 1 1  ON 34
eH1_5                 3.334019e-02 1 1  ON 35
eH1_6                 9.687005e-02 1 1  ON 36
eH1_7                 1.565381e-01 1 1  ON 37
eH1_8                 1.900754e-01 1 1  ON 38
eH1_9                 8.596937e-02 1 1  ON 39
eH2_0                -2.482635e-01 1 1  ON 40
eH2_1                -1.447818e-01 1 1  ON 41
eH2_2                -9.985773e-02 1 1  ON 42
eH2_3                -4.767591e-02 1 1  ON 43
eH2_4                 3.718030e-03 1 1  ON 44
eH2_5                 3.857006e-02 1 1  ON 45
eH2_6                 1.012727e-01 1 1  ON 46
eH2_7                 1.588136e-01 1 1  ON 47
eH2_8                 1.909281e-01 1 1  ON 48
eH2_9                 6.410024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.183652
====================================================
  Execution time = 2.4238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3321e-01
  Total weights = 2.0000e+06
  Execution time = 2.7039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333068614881
                                         uncertainty =       0.003726000999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333068614881
                                         uncertainty =       0.003726000999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408083470
  error estimate for blocks of size 2^( 2) =       0.000420579512
  error estimate for blocks of size 2^( 3) =       0.000432957292
  error estimate for blocks of size 2^( 4) =       0.000445761584
  error estimate for blocks of size 2^( 5) =       0.000457890116
  error estimate for blocks of size 2^( 6) =       0.000468870824
  error estimate for blocks of size 2^( 7) =       0.000472990770

      target function =                  N/A
              le_mean =     -16.910274375715
             les_mean =     286.290443532307
             stat err =       0.000461378324
             autocorr =       1.278251663349
              std dev =       0.577117177780
             le_variance =       0.333064236889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333376893135
                                         uncertainty =       0.003729018396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333376893135
                                         uncertainty =       0.003729018396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408272271
  error estimate for blocks of size 2^( 2) =       0.000420767611
  error estimate for blocks of size 2^( 3) =       0.000433143435
  error estimate for blocks of size 2^( 4) =       0.000445941876
  error estimate for blocks of size 2^( 5) =       0.000458052921
  error estimate for blocks of size 2^( 6) =       0.000469011436
  error estimate for blocks of size 2^( 7) =       0.000473133738

      target function =                  N/A
              le_mean =     -16.910271371496
             les_mean =     286.290650184810
             stat err =       0.000461534993
             autocorr =       1.277937161990
              std dev =       0.577384182216
             le_variance =       0.333372493873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333360873005
                                         uncertainty =       0.003728670139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333360873005
                                         uncertainty =       0.003728670139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408262449
  error estimate for blocks of size 2^( 2) =       0.000420755727
  error estimate for blocks of size 2^( 3) =       0.000433129260
  error estimate for blocks of size 2^( 4) =       0.000445928020
  error estimate for blocks of size 2^( 5) =       0.000458043170
  error estimate for blocks of size 2^( 6) =       0.000469008036
  error estimate for blocks of size 2^( 7) =       0.000473130693

      target function =                  N/A
              le_mean =     -16.910270914675
             les_mean =     286.290618695394
             stat err =       0.000461527480
             autocorr =       1.277957045734
              std dev =       0.577370292250
             le_variance =       0.333356454373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333122873251
                                         uncertainty =       0.003726480424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333122873251
                                         uncertainty =       0.003726480424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408116703
  error estimate for blocks of size 2^( 2) =       0.000420611973
  error estimate for blocks of size 2^( 3) =       0.000432988642
  error estimate for blocks of size 2^( 4) =       0.000445791855
  error estimate for blocks of size 2^( 5) =       0.000457918244
  error estimate for blocks of size 2^( 6) =       0.000468896711
  error estimate for blocks of size 2^( 7) =       0.000473017126

      target function =                  N/A
              le_mean =     -16.910273669524
             les_mean =     286.290473897448
             stat err =       0.000461405984
             autocorr =       1.278196743520
              std dev =       0.577164175779
             le_variance =       0.333118485803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910274375715        initial  <--
     9.5367e-02     9.5367e-01             2.0990e-03       -16.910271371496
     3.8147e-01     3.8147e+00             5.1577e-04       -16.910270914675
     1.5259e+00     1.5259e+01             1.3102e-04       -16.910273669524

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8146
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9277e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.346059
====================================================
  Execution time = 2.4472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325593361526
                                         uncertainty =       0.003026736510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325593361526
                                         uncertainty =       0.003026736510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403488539
  error estimate for blocks of size 2^( 2) =       0.000415224776
  error estimate for blocks of size 2^( 3) =       0.000427109730
  error estimate for blocks of size 2^( 4) =       0.000438254708
  error estimate for blocks of size 2^( 5) =       0.000448356835
  error estimate for blocks of size 2^( 6) =       0.000455606802
  error estimate for blocks of size 2^( 7) =       0.000460796563

      target function =                  N/A
              le_mean =     -16.910523908653
             les_mean =     286.291424704221
             stat err =       0.000450753727
             autocorr =       1.248004774107
              std dev =       0.570618963855
             le_variance =       0.325606001911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691052390865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910523908653       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910524093904       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910524069252       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910524124671       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910523876546       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910523816417       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910523878074       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910524008238       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.090627e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910523908653       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910523960788       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910523957371       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910523972775       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910523902822       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910523895477       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910523906305       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910523929895       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.290411e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910523908653       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910523922110       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910523921539       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910523925465       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910523907570       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910523906530       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910523909015       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910523914267       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.325050e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0827e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.083135e-01 1 1  ON 0
 uu_1                 1.425391e-01 1 1  ON 1
 uu_2                 4.383828e-02 1 1  ON 2
 uu_3                -1.972404e-02 1 1  ON 3
 uu_4                -6.884590e-02 1 1  ON 4
 uu_5                -1.039562e-01 1 1  ON 5
 uu_6                -1.304523e-01 1 1  ON 6
 uu_7                -1.427821e-01 1 1  ON 7
 uu_8                -1.341168e-01 1 1  ON 8
 uu_9                -1.064372e-01 1 1  ON 9
 ud_0                 4.382379e-01 1 1  ON 10
 ud_1                 1.805196e-01 1 1  ON 11
 ud_2                 6.628164e-02 1 1  ON 12
 ud_3                -2.929424e-03 1 1  ON 13
 ud_4                -5.895587e-02 1 1  ON 14
 ud_5                -1.020573e-01 1 1  ON 15
 ud_6                -1.322234e-01 1 1  ON 16
 ud_7                -1.522173e-01 1 1  ON 17
 ud_8                -1.562262e-01 1 1  ON 18
 ud_9                -1.478803e-01 1 1  ON 19
 eO_0                -7.604194e-01 1 1  ON 20
 eO_1                -4.435336e-01 1 1  ON 21
 eO_2                -2.474373e-02 1 1  ON 22
 eO_3                 3.023105e-01 1 1  ON 23
 eO_4                 5.303685e-01 1 1  ON 24
 eO_5                 4.927661e-01 1 1  ON 25
 eO_6                 2.640704e-01 1 1  ON 26
 eO_7                -4.055996e-02 1 1  ON 27
 eO_8                -2.285294e-01 1 1  ON 28
 eO_9                -9.036072e-02 1 1  ON 29
eH1_0                -2.542104e-01 1 1  ON 30
eH1_1                -1.504048e-01 1 1  ON 31
eH1_2                -1.054793e-01 1 1  ON 32
eH1_3                -5.335144e-02 1 1  ON 33
eH1_4                -1.900018e-03 1 1  ON 34
eH1_5                 3.353789e-02 1 1  ON 35
eH1_6                 9.693496e-02 1 1  ON 36
eH1_7                 1.565964e-01 1 1  ON 37
eH1_8                 1.899204e-01 1 1  ON 38
eH1_9                 8.550467e-02 1 1  ON 39
eH2_0                -2.478629e-01 1 1  ON 40
eH2_1                -1.443394e-01 1 1  ON 41
eH2_2                -9.967260e-02 1 1  ON 42
eH2_3                -4.745901e-02 1 1  ON 43
eH2_4                 3.734870e-03 1 1  ON 44
eH2_5                 3.873095e-02 1 1  ON 45
eH2_6                 1.009214e-01 1 1  ON 46
eH2_7                 1.585258e-01 1 1  ON 47
eH2_8                 1.906812e-01 1 1  ON 48
eH2_9                 6.363738e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.249053
====================================================
  Execution time = 2.4020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3486e-01
  Total weights = 2.0000e+06
  Execution time = 2.7174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679735531
                                         uncertainty =       0.007327385589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679735531
                                         uncertainty =       0.007327385589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409164270
  error estimate for blocks of size 2^( 2) =       0.000420897800
  error estimate for blocks of size 2^( 3) =       0.000433253240
  error estimate for blocks of size 2^( 4) =       0.000445393445
  error estimate for blocks of size 2^( 5) =       0.000455440711
  error estimate for blocks of size 2^( 6) =       0.000464753490
  error estimate for blocks of size 2^( 7) =       0.000468916337

      target function =                  N/A
              le_mean =     -16.910433713916
             les_mean =     286.297599025375
             stat err =       0.000458625996
             autocorr =       1.256382651376
              std dev =       0.578645660176
             le_variance =       0.334830800040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334760800384
                                         uncertainty =       0.007329270941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334760800384
                                         uncertainty =       0.007329270941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409213771
  error estimate for blocks of size 2^( 2) =       0.000420945684
  error estimate for blocks of size 2^( 3) =       0.000433300167
  error estimate for blocks of size 2^( 4) =       0.000445439576
  error estimate for blocks of size 2^( 5) =       0.000455485923
  error estimate for blocks of size 2^( 6) =       0.000464796520
  error estimate for blocks of size 2^( 7) =       0.000468958104

      target function =                  N/A
              le_mean =     -16.910433686778
             les_mean =     286.297679127835
             stat err =       0.000458670031
             autocorr =       1.256319928681
              std dev =       0.578715664532
             le_variance =       0.334911820374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733682029
                                         uncertainty =       0.007328332861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733682029
                                         uncertainty =       0.007328332861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409197219
  error estimate for blocks of size 2^( 2) =       0.000420929608
  error estimate for blocks of size 2^( 3) =       0.000433284285
  error estimate for blocks of size 2^( 4) =       0.000445423876
  error estimate for blocks of size 2^( 5) =       0.000455470533
  error estimate for blocks of size 2^( 6) =       0.000464781872
  error estimate for blocks of size 2^( 7) =       0.000468943787

      target function =                  N/A
              le_mean =     -16.910433682661
             les_mean =     286.297651895604
             stat err =       0.000458655017
             autocorr =       1.256339316755
              std dev =       0.578692256181
             le_variance =       0.334884727364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334687087785
                                         uncertainty =       0.007327502147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334687087785
                                         uncertainty =       0.007327502147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409168761
  error estimate for blocks of size 2^( 2) =       0.000420902132
  error estimate for blocks of size 2^( 3) =       0.000433257463
  error estimate for blocks of size 2^( 4) =       0.000445397581
  error estimate for blocks of size 2^( 5) =       0.000455444764
  error estimate for blocks of size 2^( 6) =       0.000464757347
  error estimate for blocks of size 2^( 7) =       0.000468920064

      target function =                  N/A
              le_mean =     -16.910433707162
             les_mean =     286.297606147031
             stat err =       0.000458629939
             autocorr =       1.256376674539
              std dev =       0.578652011266
             le_variance =       0.334838150142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910433713916        initial  <--
     9.5367e-01     9.5367e+00             2.0906e-04       -16.910433686778
     3.8147e+00     3.8147e+01             5.2904e-05       -16.910433682661
     1.5259e+01     1.5259e+02             1.3251e-05       -16.910433707162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.6336
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8952
    reference variance = 0.256033
====================================================
  Execution time = 2.4447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341438891926
                                         uncertainty =       0.007442912583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341438891926
                                         uncertainty =       0.007442912583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413158317
  error estimate for blocks of size 2^( 2) =       0.000425206116
  error estimate for blocks of size 2^( 3) =       0.000437144102
  error estimate for blocks of size 2^( 4) =       0.000449212936
  error estimate for blocks of size 2^( 5) =       0.000459072562
  error estimate for blocks of size 2^( 6) =       0.000467367360
  error estimate for blocks of size 2^( 7) =       0.000471944061

      target function =                  N/A
              le_mean =     -16.910317621167
             les_mean =     286.300241468644
             stat err =       0.000461899230
             autocorr =       1.249860307970
              std dev =       0.584294095974
             le_variance =       0.341399590590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031762117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317621167       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910317645024       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910317653093       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910317630500       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910317642031       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910317672240       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910317685308       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910317683221       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.220998e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317621167       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910317627220       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910317629361       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910317623365       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910317626245       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910317633518       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910317636872       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910317636440       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.584553e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910317621167       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910317622686       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910317623229       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910317621708       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910317622428       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910317624227       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910317625071       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910317624969       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.398148e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0856e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.082951e-01 1 1  ON 0
 uu_1                 1.425299e-01 1 1  ON 1
 uu_2                 4.384579e-02 1 1  ON 2
 uu_3                -1.971522e-02 1 1  ON 3
 uu_4                -6.883896e-02 1 1  ON 4
 uu_5                -1.039244e-01 1 1  ON 5
 uu_6                -1.304290e-01 1 1  ON 6
 uu_7                -1.427851e-01 1 1  ON 7
 uu_8                -1.341340e-01 1 1  ON 8
 uu_9                -1.064401e-01 1 1  ON 9
 ud_0                 4.382245e-01 1 1  ON 10
 ud_1                 1.805430e-01 1 1  ON 11
 ud_2                 6.627887e-02 1 1  ON 12
 ud_3                -2.936824e-03 1 1  ON 13
 ud_4                -5.896530e-02 1 1  ON 14
 ud_5                -1.020666e-01 1 1  ON 15
 ud_6                -1.322145e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562227e-01 1 1  ON 18
 ud_9                -1.478789e-01 1 1  ON 19
 eO_0                -7.603894e-01 1 1  ON 20
 eO_1                -4.435499e-01 1 1  ON 21
 eO_2                -2.476120e-02 1 1  ON 22
 eO_3                 3.023303e-01 1 1  ON 23
 eO_4                 5.303577e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640660e-01 1 1  ON 26
 eO_7                -4.056955e-02 1 1  ON 27
 eO_8                -2.285173e-01 1 1  ON 28
 eO_9                -9.033403e-02 1 1  ON 29
eH1_0                -2.542093e-01 1 1  ON 30
eH1_1                -1.504173e-01 1 1  ON 31
eH1_2                -1.054745e-01 1 1  ON 32
eH1_3                -5.332008e-02 1 1  ON 33
eH1_4                -1.854235e-03 1 1  ON 34
eH1_5                 3.355467e-02 1 1  ON 35
eH1_6                 9.692288e-02 1 1  ON 36
eH1_7                 1.565951e-01 1 1  ON 37
eH1_8                 1.898968e-01 1 1  ON 38
eH1_9                 8.546486e-02 1 1  ON 39
eH2_0                -2.478381e-01 1 1  ON 40
eH2_1                -1.443443e-01 1 1  ON 41
eH2_2                -9.967416e-02 1 1  ON 42
eH2_3                -4.743571e-02 1 1  ON 43
eH2_4                 3.769905e-03 1 1  ON 44
eH2_5                 3.875798e-02 1 1  ON 45
eH2_6                 1.009238e-01 1 1  ON 46
eH2_7                 1.585052e-01 1 1  ON 47
eH2_8                 1.906425e-01 1 1  ON 48
eH2_9                 6.358916e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.135437
====================================================
  Execution time = 2.3907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3344e-01
  Total weights = 2.0000e+06
  Execution time = 2.7133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333467304011
                                         uncertainty =       0.004843518770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333467304011
                                         uncertainty =       0.004843518770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408314030
  error estimate for blocks of size 2^( 2) =       0.000420545369
  error estimate for blocks of size 2^( 3) =       0.000433341374
  error estimate for blocks of size 2^( 4) =       0.000445537108
  error estimate for blocks of size 2^( 5) =       0.000456660011
  error estimate for blocks of size 2^( 6) =       0.000466009142
  error estimate for blocks of size 2^( 7) =       0.000474117202

      target function =                  N/A
              le_mean =     -16.910388195874
             les_mean =     286.294669462564
             stat err =       0.000460580866
             autocorr =       1.272398587033
              std dev =       0.577443238876
             le_variance =       0.333440694124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333473072996
                                         uncertainty =       0.004843631993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333473072996
                                         uncertainty =       0.004843631993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408317559
  error estimate for blocks of size 2^( 2) =       0.000420548709
  error estimate for blocks of size 2^( 3) =       0.000433344458
  error estimate for blocks of size 2^( 4) =       0.000445540022
  error estimate for blocks of size 2^( 5) =       0.000456662800
  error estimate for blocks of size 2^( 6) =       0.000466011697
  error estimate for blocks of size 2^( 7) =       0.000474120183

      target function =                  N/A
              le_mean =     -16.910388104506
             les_mean =     286.294672135858
             stat err =       0.000460583675
             autocorr =       1.272392116707
              std dev =       0.577448229334
             le_variance =       0.333446457561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333470245418
                                         uncertainty =       0.004843576486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333470245418
                                         uncertainty =       0.004843576486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408315829
  error estimate for blocks of size 2^( 2) =       0.000420547072
  error estimate for blocks of size 2^( 3) =       0.000433342947
  error estimate for blocks of size 2^( 4) =       0.000445538594
  error estimate for blocks of size 2^( 5) =       0.000456661432
  error estimate for blocks of size 2^( 6) =       0.000466010443
  error estimate for blocks of size 2^( 7) =       0.000474118718

      target function =                  N/A
              le_mean =     -16.910388149099
             les_mean =     286.294670819182
             stat err =       0.000460582297
             autocorr =       1.272395280232
              std dev =       0.577445783357
             le_variance =       0.333443632717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333467673527
                                         uncertainty =       0.004843526021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333467673527
                                         uncertainty =       0.004843526021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408314256
  error estimate for blocks of size 2^( 2) =       0.000420545583
  error estimate for blocks of size 2^( 3) =       0.000433341572
  error estimate for blocks of size 2^( 4) =       0.000445537295
  error estimate for blocks of size 2^( 5) =       0.000456660190
  error estimate for blocks of size 2^( 6) =       0.000466009306
  error estimate for blocks of size 2^( 7) =       0.000474117392

      target function =                  N/A
              le_mean =     -16.910388189972
             les_mean =     286.294669632099
             stat err =       0.000460581046
             autocorr =       1.272398171191
              std dev =       0.577443558529
             le_variance =       0.333441063287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910388195874        initial  <--
     9.5367e+00     9.5367e+01             2.2210e-05       -16.910388104506
     3.8147e+01     3.8147e+02             5.5846e-06       -16.910388149099
     1.5259e+02     1.5259e+03             1.3981e-06       -16.910388189972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5040
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.218891
====================================================
  Execution time = 2.4388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3351e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333392563717
                                         uncertainty =       0.003287636168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333392563717
                                         uncertainty =       0.003287636168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408358210
  error estimate for blocks of size 2^( 2) =       0.000420014529
  error estimate for blocks of size 2^( 3) =       0.000431787634
  error estimate for blocks of size 2^( 4) =       0.000444647063
  error estimate for blocks of size 2^( 5) =       0.000454062618
  error estimate for blocks of size 2^( 6) =       0.000461504661
  error estimate for blocks of size 2^( 7) =       0.000464777090

      target function =                  N/A
              le_mean =     -16.910654114663
             les_mean =     286.303735273801
             stat err =       0.000456247858
             autocorr =       1.248300357967
              std dev =       0.577505718398
             le_variance =       0.333512854782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691065411466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910654114663       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910654119824       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910654113778       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910654114101       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910654110740       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910654113943       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910654115210       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910654115526       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.736254e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910654114663       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910654115955       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910654114439       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910654114520       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910654113680       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910654114480       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910654114798       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.550845e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910654114663       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910654114986       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910654114607       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910654114627       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910654114418       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910654114617       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910654114697       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.637880e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0811e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.082929e-01 1 1  ON 0
 uu_1                 1.425285e-01 1 1  ON 1
 uu_2                 4.384818e-02 1 1  ON 2
 uu_3                -1.971492e-02 1 1  ON 3
 uu_4                -6.883761e-02 1 1  ON 4
 uu_5                -1.039253e-01 1 1  ON 5
 uu_6                -1.304305e-01 1 1  ON 6
 uu_7                -1.427857e-01 1 1  ON 7
 uu_8                -1.341350e-01 1 1  ON 8
 uu_9                -1.064377e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627693e-02 1 1  ON 12
 ud_3                -2.937755e-03 1 1  ON 13
 ud_4                -5.896516e-02 1 1  ON 14
 ud_5                -1.020672e-01 1 1  ON 15
 ud_6                -1.322145e-01 1 1  ON 16
 ud_7                -1.522241e-01 1 1  ON 17
 ud_8                -1.562184e-01 1 1  ON 18
 ud_9                -1.478749e-01 1 1  ON 19
 eO_0                -7.603882e-01 1 1  ON 20
 eO_1                -4.435494e-01 1 1  ON 21
 eO_2                -2.476272e-02 1 1  ON 22
 eO_3                 3.023263e-01 1 1  ON 23
 eO_4                 5.303562e-01 1 1  ON 24
 eO_5                 4.927297e-01 1 1  ON 25
 eO_6                 2.640640e-01 1 1  ON 26
 eO_7                -4.057135e-02 1 1  ON 27
 eO_8                -2.285137e-01 1 1  ON 28
 eO_9                -9.032947e-02 1 1  ON 29
eH1_0                -2.542040e-01 1 1  ON 30
eH1_1                -1.504172e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332228e-02 1 1  ON 33
eH1_4                -1.854725e-03 1 1  ON 34
eH1_5                 3.355774e-02 1 1  ON 35
eH1_6                 9.692370e-02 1 1  ON 36
eH1_7                 1.565974e-01 1 1  ON 37
eH1_8                 1.898950e-01 1 1  ON 38
eH1_9                 8.545972e-02 1 1  ON 39
eH2_0                -2.478348e-01 1 1  ON 40
eH2_1                -1.443394e-01 1 1  ON 41
eH2_2                -9.967394e-02 1 1  ON 42
eH2_3                -4.743530e-02 1 1  ON 43
eH2_4                 3.772540e-03 1 1  ON 44
eH2_5                 3.875866e-02 1 1  ON 45
eH2_6                 1.009217e-01 1 1  ON 46
eH2_7                 1.585013e-01 1 1  ON 47
eH2_8                 1.906398e-01 1 1  ON 48
eH2_9                 6.358513e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8315
    reference variance = 0.323281
====================================================
  Execution time = 2.3922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2722e-01
  Total weights = 2.0000e+06
  Execution time = 2.7199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199299258
                                         uncertainty =       0.003587434064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199299258
                                         uncertainty =       0.003587434064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404489445
  error estimate for blocks of size 2^( 2) =       0.000416729846
  error estimate for blocks of size 2^( 3) =       0.000428731229
  error estimate for blocks of size 2^( 4) =       0.000439890150
  error estimate for blocks of size 2^( 5) =       0.000449874291
  error estimate for blocks of size 2^( 6) =       0.000456575370
  error estimate for blocks of size 2^( 7) =       0.000460225379

      target function =                  N/A
              le_mean =     -16.910886647657
             les_mean =     286.305310467855
             stat err =       0.000451641298
             autocorr =       1.246731428187
              std dev =       0.572034458359
             le_variance =       0.327223421551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199060311
                                         uncertainty =       0.003587429587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199060311
                                         uncertainty =       0.003587429587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404489297
  error estimate for blocks of size 2^( 2) =       0.000416729688
  error estimate for blocks of size 2^( 3) =       0.000428731089
  error estimate for blocks of size 2^( 4) =       0.000439890003
  error estimate for blocks of size 2^( 5) =       0.000449874155
  error estimate for blocks of size 2^( 6) =       0.000456575211
  error estimate for blocks of size 2^( 7) =       0.000460225211

      target function =                  N/A
              le_mean =     -16.910886635745
             les_mean =     286.305309826246
             stat err =       0.000451641145
             autocorr =       1.246731494074
              std dev =       0.572034249716
             le_variance =       0.327223182848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199181373
                                         uncertainty =       0.003587431557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199181373
                                         uncertainty =       0.003587431557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404489372
  error estimate for blocks of size 2^( 2) =       0.000416729767
  error estimate for blocks of size 2^( 3) =       0.000428731160
  error estimate for blocks of size 2^( 4) =       0.000439890077
  error estimate for blocks of size 2^( 5) =       0.000449874223
  error estimate for blocks of size 2^( 6) =       0.000456575291
  error estimate for blocks of size 2^( 7) =       0.000460225295

      target function =                  N/A
              le_mean =     -16.910886641374
             les_mean =     286.305310137606
             stat err =       0.000451641221
             autocorr =       1.246731454848
              std dev =       0.572034355443
             le_variance =       0.327223303807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199284508
                                         uncertainty =       0.003587433750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327199284508
                                         uncertainty =       0.003587433750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404489435
  error estimate for blocks of size 2^( 2) =       0.000416729836
  error estimate for blocks of size 2^( 3) =       0.000428731220
  error estimate for blocks of size 2^( 4) =       0.000439890141
  error estimate for blocks of size 2^( 5) =       0.000449874283
  error estimate for blocks of size 2^( 6) =       0.000456575360
  error estimate for blocks of size 2^( 7) =       0.000460225369

      target function =                  N/A
              le_mean =     -16.910886646871
             les_mean =     286.305310426524
             stat err =       0.000451641288
             autocorr =       1.246731431521
              std dev =       0.572034445482
             le_variance =       0.327223406818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910886647657        initial  <--
     9.5367e+01     9.5367e+02             2.7363e-06       -16.910886635745
     3.8147e+02     3.8147e+03             6.5508e-07       -16.910886641374
     1.5259e+03     1.5259e+04             1.6379e-07       -16.910886646871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5673
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.279262
====================================================
  Execution time = 2.4486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2876e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328692762944
                                         uncertainty =       0.003219575270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328692762944
                                         uncertainty =       0.003219575270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405437446
  error estimate for blocks of size 2^( 2) =       0.000417369351
  error estimate for blocks of size 2^( 3) =       0.000429700767
  error estimate for blocks of size 2^( 4) =       0.000441429287
  error estimate for blocks of size 2^( 5) =       0.000451611233
  error estimate for blocks of size 2^( 6) =       0.000458738006
  error estimate for blocks of size 2^( 7) =       0.000462750667

      target function =                  N/A
              le_mean =     -16.910263301339
             les_mean =     286.285763800855
             stat err =       0.000453632298
             autocorr =       1.251872856264
              std dev =       0.573375134278
             le_variance =       0.328759044609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691026330134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910263301339       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910263302352       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910263302524       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910263302650       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910263302444       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910263302534       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910263302675       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910263302731       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.022688e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910263301339       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910263301593       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910263301635       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910263301667       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910263301615       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910263301639       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910263301676       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910263301686       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.056786e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910263301339       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910263301403       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910263301413       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910263301421       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910263301414       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910263301405       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910263301422       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910263301417       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.264201e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0802e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425285e-01 1 1  ON 1
 uu_2                 4.384803e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304307e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627708e-02 1 1  ON 12
 ud_3                -2.937961e-03 1 1  ON 13
 ud_4                -5.896499e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057135e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032933e-02 1 1  ON 29
eH1_0                -2.542038e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332201e-02 1 1  ON 33
eH1_4                -1.854870e-03 1 1  ON 34
eH1_5                 3.355773e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545939e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743526e-02 1 1  ON 43
eH2_4                 3.772587e-03 1 1  ON 44
eH2_5                 3.875892e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358452e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8397
    reference variance = 0.120742
====================================================
  Execution time = 2.5990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3512e-01
  Total weights = 2.0000e+06
  Execution time = 2.6911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221669998
                                         uncertainty =       0.004677185239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221669998
                                         uncertainty =       0.004677185239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409341954
  error estimate for blocks of size 2^( 2) =       0.000420796112
  error estimate for blocks of size 2^( 3) =       0.000432910830
  error estimate for blocks of size 2^( 4) =       0.000444718835
  error estimate for blocks of size 2^( 5) =       0.000454472349
  error estimate for blocks of size 2^( 6) =       0.000462367800
  error estimate for blocks of size 2^( 7) =       0.000468769443

      target function =                  N/A
              le_mean =     -16.910523738615
             les_mean =     286.300934616683
             stat err =       0.000457582107
             autocorr =       1.249584275068
              std dev =       0.578896942468
             le_variance =       0.335121669999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221695280
                                         uncertainty =       0.004677184983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221695280
                                         uncertainty =       0.004677184983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409341969
  error estimate for blocks of size 2^( 2) =       0.000420796125
  error estimate for blocks of size 2^( 3) =       0.000432910841
  error estimate for blocks of size 2^( 4) =       0.000444718845
  error estimate for blocks of size 2^( 5) =       0.000454472358
  error estimate for blocks of size 2^( 6) =       0.000462367809
  error estimate for blocks of size 2^( 7) =       0.000468769449

      target function =                  N/A
              le_mean =     -16.910523737619
             les_mean =     286.300934608314
             stat err =       0.000457582115
             autocorr =       1.249584227105
              std dev =       0.578896964316
             le_variance =       0.335121695294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221682638
                                         uncertainty =       0.004677185111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221682638
                                         uncertainty =       0.004677185111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409341961
  error estimate for blocks of size 2^( 2) =       0.000420796118
  error estimate for blocks of size 2^( 3) =       0.000432910835
  error estimate for blocks of size 2^( 4) =       0.000444718840
  error estimate for blocks of size 2^( 5) =       0.000454472354
  error estimate for blocks of size 2^( 6) =       0.000462367805
  error estimate for blocks of size 2^( 7) =       0.000468769446

      target function =                  N/A
              le_mean =     -16.910523738117
             les_mean =     286.300934612493
             stat err =       0.000457582111
             autocorr =       1.249584251086
              std dev =       0.578896953391
             le_variance =       0.335121682645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221671578
                                         uncertainty =       0.004677185223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335221671578
                                         uncertainty =       0.004677185223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409341955
  error estimate for blocks of size 2^( 2) =       0.000420796113
  error estimate for blocks of size 2^( 3) =       0.000432910830
  error estimate for blocks of size 2^( 4) =       0.000444718835
  error estimate for blocks of size 2^( 5) =       0.000454472350
  error estimate for blocks of size 2^( 6) =       0.000462367801
  error estimate for blocks of size 2^( 7) =       0.000468769444

      target function =                  N/A
              le_mean =     -16.910523738552
             les_mean =     286.300934616159
             stat err =       0.000457582107
             autocorr =       1.249584272070
              std dev =       0.578896943833
             le_variance =       0.335121671580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910523738615        initial  <--
     9.5367e+02     9.5367e+03             2.0227e-07       -16.910523737619
     3.8147e+03     3.8147e+04             5.0568e-08       -16.910523738117
     1.5259e+04     1.5259e+05             1.2642e-08       -16.910523738552

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4896
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937953e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854858e-03 1 1  ON 34
eH1_5                 3.355771e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772613e-03 1 1  ON 44
eH2_5                 3.875897e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0304e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9471
    reference variance = 0.183183
====================================================
  Execution time = 2.4535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3441e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334458733769
                                         uncertainty =       0.003944899848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334458733769
                                         uncertainty =       0.003944899848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408904486
  error estimate for blocks of size 2^( 2) =       0.000420433596
  error estimate for blocks of size 2^( 3) =       0.000432246416
  error estimate for blocks of size 2^( 4) =       0.000443661108
  error estimate for blocks of size 2^( 5) =       0.000454589301
  error estimate for blocks of size 2^( 6) =       0.000463088518
  error estimate for blocks of size 2^( 7) =       0.000466572578

      target function =                  N/A
              le_mean =     -16.910592228432
             les_mean =     286.302535106663
             stat err =       0.000456977876
             autocorr =       1.248954449144
              std dev =       0.578278270017
             le_variance =       0.334405757574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691059222843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910592228432       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910592228401       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910592228411       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910592228389       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910592228408       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910592228392       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910592228420       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910592228432       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.816612e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910592228432       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910592228424       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910592228426       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910592228421       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910592228431       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910592228422       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910592228442       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910592228427       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 4.541542e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910592228432       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910592228430       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910592228430       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910592228452       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910592228374       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910592228569       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910592228516       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910592228671       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.135386e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0829e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883764e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064378e-01 1 1  ON 9
 ud_0                 4.382215e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937954e-03 1 1  ON 13
 ud_4                -5.896498e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303560e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032930e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332199e-02 1 1  ON 33
eH1_4                -1.854859e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898947e-01 1 1  ON 38
eH1_9                 8.545935e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772614e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9538
    reference variance = 0.426039
====================================================
  Execution time = 2.3929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3445e-01
  Total weights = 2.0000e+06
  Execution time = 2.7186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496416449
                                         uncertainty =       0.003583587176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496416449
                                         uncertainty =       0.003583587176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408934034
  error estimate for blocks of size 2^( 2) =       0.000420986960
  error estimate for blocks of size 2^( 3) =       0.000433644042
  error estimate for blocks of size 2^( 4) =       0.000446699173
  error estimate for blocks of size 2^( 5) =       0.000457958549
  error estimate for blocks of size 2^( 6) =       0.000469936135
  error estimate for blocks of size 2^( 7) =       0.000476364993

      target function =                  N/A
              le_mean =     -16.909970463049
             les_mean =     286.281554982199
             stat err =       0.000462739713
             autocorr =       1.280462993985
              std dev =       0.578320056910
             le_variance =       0.334454088224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496427440
                                         uncertainty =       0.003583587382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496427440
                                         uncertainty =       0.003583587382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408934041
  error estimate for blocks of size 2^( 2) =       0.000420986966
  error estimate for blocks of size 2^( 3) =       0.000433644047
  error estimate for blocks of size 2^( 4) =       0.000446699179
  error estimate for blocks of size 2^( 5) =       0.000457958554
  error estimate for blocks of size 2^( 6) =       0.000469936140
  error estimate for blocks of size 2^( 7) =       0.000476364998

      target function =                  N/A
              le_mean =     -16.909970463172
             les_mean =     286.281554997354
             stat err =       0.000462739718
             autocorr =       1.280462980588
              std dev =       0.578320066414
             le_variance =       0.334454099217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496421945
                                         uncertainty =       0.003583587279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496421945
                                         uncertainty =       0.003583587279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408934037
  error estimate for blocks of size 2^( 2) =       0.000420986963
  error estimate for blocks of size 2^( 3) =       0.000433644044
  error estimate for blocks of size 2^( 4) =       0.000446699176
  error estimate for blocks of size 2^( 5) =       0.000457958551
  error estimate for blocks of size 2^( 6) =       0.000469936137
  error estimate for blocks of size 2^( 7) =       0.000476364996

      target function =                  N/A
              le_mean =     -16.909970463111
             les_mean =     286.281554989776
             stat err =       0.000462739715
             autocorr =       1.280462987284
              std dev =       0.578320061662
             le_variance =       0.334454093721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496417136
                                         uncertainty =       0.003583587189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334496417136
                                         uncertainty =       0.003583587189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408934034
  error estimate for blocks of size 2^( 2) =       0.000420986960
  error estimate for blocks of size 2^( 3) =       0.000433644042
  error estimate for blocks of size 2^( 4) =       0.000446699174
  error estimate for blocks of size 2^( 5) =       0.000457958549
  error estimate for blocks of size 2^( 6) =       0.000469936135
  error estimate for blocks of size 2^( 7) =       0.000476364994

      target function =                  N/A
              le_mean =     -16.909970463057
             les_mean =     286.281554983146
             stat err =       0.000462739713
             autocorr =       1.280462993147
              std dev =       0.578320057504
             le_variance =       0.334454088911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909970463049        initial
     9.5367e+03     9.5367e+04             1.8166e-08       -16.909970463172  <--
     3.8147e+04     3.8147e+05             4.5415e-09       -16.909970463111
     1.5259e+05     1.5259e+06             1.1354e-09       -16.909970463057

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 3.7567e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.177972
====================================================
  Execution time = 2.4543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330772966914
                                         uncertainty =       0.004324184038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330772966914
                                         uncertainty =       0.004324184038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406620564
  error estimate for blocks of size 2^( 2) =       0.000417982789
  error estimate for blocks of size 2^( 3) =       0.000430399228
  error estimate for blocks of size 2^( 4) =       0.000442140791
  error estimate for blocks of size 2^( 5) =       0.000452212475
  error estimate for blocks of size 2^( 6) =       0.000458592756
  error estimate for blocks of size 2^( 7) =       0.000462335214

      target function =                  N/A
              le_mean =     -16.910226717132
             les_mean =     286.286448026229
             stat err =       0.000453820309
             autocorr =       1.245630335693
              std dev =       0.575048316888
             le_variance =       0.330680566755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691022671713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910226717132       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910226717148       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910226717295       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910226717527       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910226717569       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910226717543       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910226717506       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910226717489       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.445807e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910226717132       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910226717136       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910226717173       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910226717231       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910226717241       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910226717286       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910226717210       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910226717202       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.111466e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910226717132       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910226717133       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910226717142       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910226717155       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910226717159       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910226717158       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910226717166       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910226717167       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.278674e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0958e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971486e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937957e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476258e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057135e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032932e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054759e-01 1 1  ON 32
eH1_3                -5.332201e-02 1 1  ON 33
eH1_4                -1.854868e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545938e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967376e-02 1 1  ON 42
eH2_3                -4.743524e-02 1 1  ON 43
eH2_4                 3.772609e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.118461
====================================================
  Execution time = 2.4231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3656e-01
  Total weights = 2.0000e+06
  Execution time = 2.7017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280636549
                                         uncertainty =       0.004502993469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280636549
                                         uncertainty =       0.004502993469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410220978
  error estimate for blocks of size 2^( 2) =       0.000422119759
  error estimate for blocks of size 2^( 3) =       0.000434486649
  error estimate for blocks of size 2^( 4) =       0.000446210785
  error estimate for blocks of size 2^( 5) =       0.000456764748
  error estimate for blocks of size 2^( 6) =       0.000466185977
  error estimate for blocks of size 2^( 7) =       0.000473243729

      target function =                  N/A
              le_mean =     -16.910619855638
             les_mean =     286.305626235474
             stat err =       0.000460601310
             autocorr =       1.260708280252
              std dev =       0.580140070900
             le_variance =       0.336562501864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280654694
                                         uncertainty =       0.004502992517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280654694
                                         uncertainty =       0.004502992517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410220989
  error estimate for blocks of size 2^( 2) =       0.000422119770
  error estimate for blocks of size 2^( 3) =       0.000434486659
  error estimate for blocks of size 2^( 4) =       0.000446210794
  error estimate for blocks of size 2^( 5) =       0.000456764756
  error estimate for blocks of size 2^( 6) =       0.000466185983
  error estimate for blocks of size 2^( 7) =       0.000473243734

      target function =                  N/A
              le_mean =     -16.910619855528
             les_mean =     286.305626249918
             stat err =       0.000460601317
             autocorr =       1.260708252339
              std dev =       0.580140086538
             le_variance =       0.336562520008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280645623
                                         uncertainty =       0.004502992993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280645623
                                         uncertainty =       0.004502992993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410220984
  error estimate for blocks of size 2^( 2) =       0.000422119765
  error estimate for blocks of size 2^( 3) =       0.000434486654
  error estimate for blocks of size 2^( 4) =       0.000446210790
  error estimate for blocks of size 2^( 5) =       0.000456764752
  error estimate for blocks of size 2^( 6) =       0.000466185980
  error estimate for blocks of size 2^( 7) =       0.000473243732

      target function =                  N/A
              le_mean =     -16.910619855583
             les_mean =     286.305626242697
             stat err =       0.000460601313
             autocorr =       1.260708266288
              std dev =       0.580140078720
             le_variance =       0.336562510937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280637683
                                         uncertainty =       0.004502993410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336280637683
                                         uncertainty =       0.004502993410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410220979
  error estimate for blocks of size 2^( 2) =       0.000422119760
  error estimate for blocks of size 2^( 3) =       0.000434486650
  error estimate for blocks of size 2^( 4) =       0.000446210786
  error estimate for blocks of size 2^( 5) =       0.000456764749
  error estimate for blocks of size 2^( 6) =       0.000466185977
  error estimate for blocks of size 2^( 7) =       0.000473243729

      target function =                  N/A
              le_mean =     -16.910619855631
             les_mean =     286.305626236377
             stat err =       0.000460601310
             autocorr =       1.260708278508
              std dev =       0.580140071878
             le_variance =       0.336562502998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910619855638        initial  <--
     2.3842e+03     2.3842e+04             8.4458e-08       -16.910619855528
     9.5367e+03     9.5367e+04             2.1115e-08       -16.910619855583
     3.8147e+04     3.8147e+05             5.2787e-09       -16.910619855631

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8244
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9324
    reference variance = 0.312308
====================================================
  Execution time = 2.4806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3052e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330597860072
                                         uncertainty =       0.003402004258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330597860072
                                         uncertainty =       0.003402004258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406522365
  error estimate for blocks of size 2^( 2) =       0.000418118492
  error estimate for blocks of size 2^( 3) =       0.000431221881
  error estimate for blocks of size 2^( 4) =       0.000442937863
  error estimate for blocks of size 2^( 5) =       0.000452483678
  error estimate for blocks of size 2^( 6) =       0.000461867381
  error estimate for blocks of size 2^( 7) =       0.000465969831

      target function =                  N/A
              le_mean =     -16.910655072166
             les_mean =     286.300775670639
             stat err =       0.000455814688
             autocorr =       1.257209763410
              std dev =       0.574909441685
             le_variance =       0.330520866138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691065507217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910655072166       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910655072191       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910655072191       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910655072191       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910655072195       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910655072209       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910655072214       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910655072213       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.701243e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910655072166       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910655072172       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910655072172       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910655072172       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910655072158       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910655072162       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910655072191       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910655072151       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.175312e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910655072166       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910655072167       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910655072167       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910655072166       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910655072201       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910655072308       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910655071761       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910655071916       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.438280e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1155e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384803e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937954e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545937e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772619e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8502
    reference variance = 0.376117
====================================================
  Execution time = 2.4204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.0000e+06
  Execution time = 2.7034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267342
                                         uncertainty =       0.006121876122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267342
                                         uncertainty =       0.006121876122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411947074
  error estimate for blocks of size 2^( 2) =       0.000423818331
  error estimate for blocks of size 2^( 3) =       0.000435409996
  error estimate for blocks of size 2^( 4) =       0.000446979751
  error estimate for blocks of size 2^( 5) =       0.000458551579
  error estimate for blocks of size 2^( 6) =       0.000465080722
  error estimate for blocks of size 2^( 7) =       0.000468666852

      target function =                  N/A
              le_mean =     -16.910332677399
             les_mean =     286.298751874819
             stat err =       0.000459819726
             autocorr =       1.245926293161
              std dev =       0.582581139603
             le_variance =       0.339400784221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410268144
                                         uncertainty =       0.006121876154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410268144
                                         uncertainty =       0.006121876154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411947075
  error estimate for blocks of size 2^( 2) =       0.000423818331
  error estimate for blocks of size 2^( 3) =       0.000435409996
  error estimate for blocks of size 2^( 4) =       0.000446979751
  error estimate for blocks of size 2^( 5) =       0.000458551579
  error estimate for blocks of size 2^( 6) =       0.000465080723
  error estimate for blocks of size 2^( 7) =       0.000468666852

      target function =                  N/A
              le_mean =     -16.910332677385
             les_mean =     286.298751875163
             stat err =       0.000459819726
             autocorr =       1.245926291997
              std dev =       0.582581140292
             le_variance =       0.339400785024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267743
                                         uncertainty =       0.006121876138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267743
                                         uncertainty =       0.006121876138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411947075
  error estimate for blocks of size 2^( 2) =       0.000423818331
  error estimate for blocks of size 2^( 3) =       0.000435409996
  error estimate for blocks of size 2^( 4) =       0.000446979751
  error estimate for blocks of size 2^( 5) =       0.000458551579
  error estimate for blocks of size 2^( 6) =       0.000465080723
  error estimate for blocks of size 2^( 7) =       0.000468666852

      target function =                  N/A
              le_mean =     -16.910332677392
             les_mean =     286.298751874991
             stat err =       0.000459819726
             autocorr =       1.245926292593
              std dev =       0.582581139947
             le_variance =       0.339400784622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267392
                                         uncertainty =       0.006121876124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410267392
                                         uncertainty =       0.006121876124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411947074
  error estimate for blocks of size 2^( 2) =       0.000423818331
  error estimate for blocks of size 2^( 3) =       0.000435409996
  error estimate for blocks of size 2^( 4) =       0.000446979751
  error estimate for blocks of size 2^( 5) =       0.000458551579
  error estimate for blocks of size 2^( 6) =       0.000465080722
  error estimate for blocks of size 2^( 7) =       0.000468666852

      target function =                  N/A
              le_mean =     -16.910332677398
             les_mean =     286.298751874840
             stat err =       0.000459819726
             autocorr =       1.245926293099
              std dev =       0.582581139646
             le_variance =       0.339400784271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910332677399        initial  <--
     2.3842e+04     2.3842e+05             8.7012e-09       -16.910332677385
     9.5367e+04     9.5367e+05             2.1753e-09       -16.910332677392
     3.8147e+05     3.8147e+06             5.4383e-10       -16.910332677398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.7966
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9922
    reference variance = 0.271552
====================================================
  Execution time = 2.4511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091237048
                                         uncertainty =       0.004430549141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091237048
                                         uncertainty =       0.004430549141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409330682
  error estimate for blocks of size 2^( 2) =       0.000420945175
  error estimate for blocks of size 2^( 3) =       0.000433099663
  error estimate for blocks of size 2^( 4) =       0.000444439744
  error estimate for blocks of size 2^( 5) =       0.000453973525
  error estimate for blocks of size 2^( 6) =       0.000460898471
  error estimate for blocks of size 2^( 7) =       0.000468074835

      target function =                  N/A
              le_mean =     -16.911125375091
             les_mean =     286.321264498189
             stat err =       0.000456846644
             autocorr =       1.245639237989
              std dev =       0.578881001336
             le_variance =       0.335103213708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691112537509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911125375091       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911125375094       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911125375095       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911125375095       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911125375190       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911125374951       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911125375045       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911125375063       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.577696e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911125375091       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911125375091       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911125375092       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911125375043       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911125375389       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911125375092       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911125374971       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911125375250       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.894425e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911125375091       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911125375091       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911125375091       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911125375091       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911125374139       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911125374842       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911125380355       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911125375395       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 4.736065e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0897e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8948
    reference variance = 0.375747
====================================================
  Execution time = 2.4278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2961e-01
  Total weights = 2.0000e+06
  Execution time = 2.7357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948292
                                         uncertainty =       0.003759411420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948292
                                         uncertainty =       0.003759411420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964725
  error estimate for blocks of size 2^( 2) =       0.000417905133
  error estimate for blocks of size 2^( 3) =       0.000430010858
  error estimate for blocks of size 2^( 4) =       0.000441774069
  error estimate for blocks of size 2^( 5) =       0.000452124757
  error estimate for blocks of size 2^( 6) =       0.000460892543
  error estimate for blocks of size 2^( 7) =       0.000467714387

      target function =                  N/A
              le_mean =     -16.910829843111
             les_mean =     286.305780532994
             stat err =       0.000455626439
             autocorr =       1.259624903145
              std dev =       0.574120819302
             le_variance =       0.329614715156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948465
                                         uncertainty =       0.003759411424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948465
                                         uncertainty =       0.003759411424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964725
  error estimate for blocks of size 2^( 2) =       0.000417905133
  error estimate for blocks of size 2^( 3) =       0.000430010858
  error estimate for blocks of size 2^( 4) =       0.000441774069
  error estimate for blocks of size 2^( 5) =       0.000452124757
  error estimate for blocks of size 2^( 6) =       0.000460892543
  error estimate for blocks of size 2^( 7) =       0.000467714387

      target function =                  N/A
              le_mean =     -16.910829843106
             les_mean =     286.305780533023
             stat err =       0.000455626439
             autocorr =       1.259624902832
              std dev =       0.574120819453
             le_variance =       0.329614715330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948378
                                         uncertainty =       0.003759411422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948378
                                         uncertainty =       0.003759411422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964725
  error estimate for blocks of size 2^( 2) =       0.000417905133
  error estimate for blocks of size 2^( 3) =       0.000430010858
  error estimate for blocks of size 2^( 4) =       0.000441774069
  error estimate for blocks of size 2^( 5) =       0.000452124757
  error estimate for blocks of size 2^( 6) =       0.000460892543
  error estimate for blocks of size 2^( 7) =       0.000467714387

      target function =                  N/A
              le_mean =     -16.910829843109
             les_mean =     286.305780533008
             stat err =       0.000455626439
             autocorr =       1.259624902990
              std dev =       0.574120819378
             le_variance =       0.329614715243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948303
                                         uncertainty =       0.003759411420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329728948303
                                         uncertainty =       0.003759411420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964725
  error estimate for blocks of size 2^( 2) =       0.000417905133
  error estimate for blocks of size 2^( 3) =       0.000430010858
  error estimate for blocks of size 2^( 4) =       0.000441774069
  error estimate for blocks of size 2^( 5) =       0.000452124757
  error estimate for blocks of size 2^( 6) =       0.000460892543
  error estimate for blocks of size 2^( 7) =       0.000467714387

      target function =                  N/A
              le_mean =     -16.910829843110
             les_mean =     286.305780532995
             stat err =       0.000455626439
             autocorr =       1.259624903125
              std dev =       0.574120819312
             le_variance =       0.329614715167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910829843111        initial  <--
     2.3842e+05     2.3842e+06             7.5777e-10       -16.910829843106
     9.5367e+05     9.5367e+06             1.8944e-10       -16.910829843109
     3.8147e+06     3.8147e+07             4.7361e-11       -16.910829843110

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.0598
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8626
    reference variance = 0.177531
====================================================
  Execution time = 2.6895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348404672903
                                         uncertainty =       0.015724468901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348404672903
                                         uncertainty =       0.015724468901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417400666
  error estimate for blocks of size 2^( 2) =       0.000428672816
  error estimate for blocks of size 2^( 3) =       0.000440035020
  error estimate for blocks of size 2^( 4) =       0.000451172570
  error estimate for blocks of size 2^( 5) =       0.000459386918
  error estimate for blocks of size 2^( 6) =       0.000466018208
  error estimate for blocks of size 2^( 7) =       0.000468786485

      target function =                  N/A
              le_mean =     -16.910367915366
             les_mean =     286.308989491101
             stat err =       0.000461341045
             autocorr =       1.221625007554
              std dev =       0.590293683079
             le_variance =       0.348446632283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691036791537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910367915366       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910367915366       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910367915366       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910367915366       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910367916217       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910367914316       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910367916626       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910367914350       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 9.851676e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910367915366       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910367915366       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910367915366       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910367915366       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910367916380       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910367914949       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910367916839       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910367925210       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.462921e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910367915366       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910367915366       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910367915366       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910367915366       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910367939419       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910367910229       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910367915396       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910367923017       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 6.157296e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3229e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.379244
====================================================
  Execution time = 2.4246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2883e-01
  Total weights = 2.0000e+06
  Execution time = 2.6925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005808
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005808
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405481751
  error estimate for blocks of size 2^( 2) =       0.000417353983
  error estimate for blocks of size 2^( 3) =       0.000429658687
  error estimate for blocks of size 2^( 4) =       0.000440699892
  error estimate for blocks of size 2^( 5) =       0.000451052223
  error estimate for blocks of size 2^( 6) =       0.000458459321
  error estimate for blocks of size 2^( 7) =       0.000463578316

      target function =                  N/A
              le_mean =     -16.909691179253
             les_mean =     286.266486514330
             stat err =       0.000453447438
             autocorr =       1.250579422748
              std dev =       0.573437791768
             le_variance =       0.328830901027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005812
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005812
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405481751
  error estimate for blocks of size 2^( 2) =       0.000417353983
  error estimate for blocks of size 2^( 3) =       0.000429658687
  error estimate for blocks of size 2^( 4) =       0.000440699892
  error estimate for blocks of size 2^( 5) =       0.000451052223
  error estimate for blocks of size 2^( 6) =       0.000458459321
  error estimate for blocks of size 2^( 7) =       0.000463578316

      target function =                  N/A
              le_mean =     -16.909691179253
             les_mean =     286.266486514325
             stat err =       0.000453447438
             autocorr =       1.250579422737
              std dev =       0.573437791771
             le_variance =       0.328830901032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005810
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005810
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405481751
  error estimate for blocks of size 2^( 2) =       0.000417353983
  error estimate for blocks of size 2^( 3) =       0.000429658687
  error estimate for blocks of size 2^( 4) =       0.000440699892
  error estimate for blocks of size 2^( 5) =       0.000451052223
  error estimate for blocks of size 2^( 6) =       0.000458459321
  error estimate for blocks of size 2^( 7) =       0.000463578316

      target function =                  N/A
              le_mean =     -16.909691179253
             les_mean =     286.266486514327
             stat err =       0.000453447438
             autocorr =       1.250579422738
              std dev =       0.573437791770
             le_variance =       0.328830901030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005809
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328832005809
                                         uncertainty =       0.003999124413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405481751
  error estimate for blocks of size 2^( 2) =       0.000417353983
  error estimate for blocks of size 2^( 3) =       0.000429658687
  error estimate for blocks of size 2^( 4) =       0.000440699892
  error estimate for blocks of size 2^( 5) =       0.000451052223
  error estimate for blocks of size 2^( 6) =       0.000458459321
  error estimate for blocks of size 2^( 7) =       0.000463578316

      target function =                  N/A
              le_mean =     -16.909691179253
             les_mean =     286.266486514329
             stat err =       0.000453447438
             autocorr =       1.250579422740
              std dev =       0.573437791768
             le_variance =       0.328830901028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909691179253        initial  <--
     2.3842e+06     2.3842e+07             9.8517e-11       -16.909691179253
     9.5367e+06     9.5367e+07             2.4629e-11       -16.909691179253
     3.8147e+07     3.8147e+08             6.1573e-12       -16.909691179253

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.7970
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1033e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.173815
====================================================
  Execution time = 2.4567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3246e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332592094565
                                         uncertainty =       0.003369914535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332592094565
                                         uncertainty =       0.003369914535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407711285
  error estimate for blocks of size 2^( 2) =       0.000419371926
  error estimate for blocks of size 2^( 3) =       0.000431513161
  error estimate for blocks of size 2^( 4) =       0.000443005411
  error estimate for blocks of size 2^( 5) =       0.000453757897
  error estimate for blocks of size 2^( 6) =       0.000460798137
  error estimate for blocks of size 2^( 7) =       0.000466859601

      target function =                  N/A
              le_mean =     -16.910454652437
             les_mean =     286.295933370430
             stat err =       0.000456105262
             autocorr =       1.251482262912
              std dev =       0.576590829386
             le_variance =       0.332456984532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691045465244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910454652437       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910454652437       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910454652437       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910454642456       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910454648780       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910454648765       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910454665810       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910454687005       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.070102e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910454652437       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910454652437       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910454652437       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910454654739       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910454653291       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910454612301       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910454657898       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910454631203       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.675309e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910454652437       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910454652437       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910454652437       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910454519852       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910454621160       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910454614786       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910454612966       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910454594959       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.688632e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0904e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8618
    reference variance = 0.400026
====================================================
  Execution time = 2.4257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3277e-01
  Total weights = 2.0000e+06
  Execution time = 2.7033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212805
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212805
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905610
  error estimate for blocks of size 2^( 2) =       0.000419634999
  error estimate for blocks of size 2^( 3) =       0.000432150443
  error estimate for blocks of size 2^( 4) =       0.000444110561
  error estimate for blocks of size 2^( 5) =       0.000455603261
  error estimate for blocks of size 2^( 6) =       0.000461491585
  error estimate for blocks of size 2^( 7) =       0.000466301646

      target function =                  N/A
              le_mean =     -16.911029348768
             les_mean =     286.315687441982
             stat err =       0.000456876763
             autocorr =       1.254523451833
              std dev =       0.576865645951
             le_variance =       0.332773973478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212811
                                         uncertainty =       0.003945988365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212811
                                         uncertainty =       0.003945988365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905610
  error estimate for blocks of size 2^( 2) =       0.000419634999
  error estimate for blocks of size 2^( 3) =       0.000432150443
  error estimate for blocks of size 2^( 4) =       0.000444110561
  error estimate for blocks of size 2^( 5) =       0.000455603261
  error estimate for blocks of size 2^( 6) =       0.000461491585
  error estimate for blocks of size 2^( 7) =       0.000466301646

      target function =                  N/A
              le_mean =     -16.911029348768
             les_mean =     286.315687441988
             stat err =       0.000456876763
             autocorr =       1.254523451825
              std dev =       0.576865645955
             le_variance =       0.332773973483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212808
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212808
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905610
  error estimate for blocks of size 2^( 2) =       0.000419634999
  error estimate for blocks of size 2^( 3) =       0.000432150443
  error estimate for blocks of size 2^( 4) =       0.000444110561
  error estimate for blocks of size 2^( 5) =       0.000455603261
  error estimate for blocks of size 2^( 6) =       0.000461491585
  error estimate for blocks of size 2^( 7) =       0.000466301646

      target function =                  N/A
              le_mean =     -16.911029348768
             les_mean =     286.315687441985
             stat err =       0.000456876763
             autocorr =       1.254523451835
              std dev =       0.576865645953
             le_variance =       0.332773973481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212806
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332861212806
                                         uncertainty =       0.003945988364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905610
  error estimate for blocks of size 2^( 2) =       0.000419634999
  error estimate for blocks of size 2^( 3) =       0.000432150443
  error estimate for blocks of size 2^( 4) =       0.000444110561
  error estimate for blocks of size 2^( 5) =       0.000455603261
  error estimate for blocks of size 2^( 6) =       0.000461491585
  error estimate for blocks of size 2^( 7) =       0.000466301646

      target function =                  N/A
              le_mean =     -16.911029348768
             les_mean =     286.315687441982
             stat err =       0.000456876763
             autocorr =       1.254523451834
              std dev =       0.576865645951
             le_variance =       0.332773973479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911029348768        initial
     2.3842e+07     2.3842e+08             1.0701e-11       -16.911029348768  <--
     9.5367e+07     9.5367e+08             2.6753e-12       -16.911029348768
     3.8147e+08     3.8147e+09             6.6886e-13       -16.911029348768

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 3.7857e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.174771
====================================================
  Execution time = 2.4617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4436e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344405386725
                                         uncertainty =       0.009409245639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344405386725
                                         uncertainty =       0.009409245639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414947608
  error estimate for blocks of size 2^( 2) =       0.000426354815
  error estimate for blocks of size 2^( 3) =       0.000437789532
  error estimate for blocks of size 2^( 4) =       0.000448811372
  error estimate for blocks of size 2^( 5) =       0.000457875029
  error estimate for blocks of size 2^( 6) =       0.000464132856
  error estimate for blocks of size 2^( 7) =       0.000466619721

      target function =                  N/A
              le_mean =     -16.910435292373
             les_mean =     286.307184640499
             stat err =       0.000459359745
             autocorr =       1.225516990227
              std dev =       0.586824535226
             le_variance =       0.344363035143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691043529237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910435292373       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910435292373       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910435292373       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910435292373       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910435292649       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910435294606       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910435288741       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910435290697       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.501245e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910435292373       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910435292373       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910435292373       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910435292373       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910435292373       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910435304656       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910435301186       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910435289984       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 8.753229e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910435292373       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910435292373       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910435292373       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910435292373       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910435296306       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910435322745       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910435292001       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910435158198       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.188348e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0957e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9415
    reference variance = 0.375885
====================================================
  Execution time = 2.4238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3609e-01
  Total weights = 2.0000e+06
  Execution time = 2.6955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779456
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779456
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409932522
  error estimate for blocks of size 2^( 2) =       0.000421953173
  error estimate for blocks of size 2^( 3) =       0.000434752924
  error estimate for blocks of size 2^( 4) =       0.000446332633
  error estimate for blocks of size 2^( 5) =       0.000458290498
  error estimate for blocks of size 2^( 6) =       0.000465988237
  error estimate for blocks of size 2^( 7) =       0.000470602042

      target function =                  N/A
              le_mean =     -16.910531925264
             les_mean =     286.302179172425
             stat err =       0.000460303352
             autocorr =       1.260850301551
              std dev =       0.579732132187
             le_variance =       0.336089345090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779457
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779457
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409932522
  error estimate for blocks of size 2^( 2) =       0.000421953173
  error estimate for blocks of size 2^( 3) =       0.000434752924
  error estimate for blocks of size 2^( 4) =       0.000446332633
  error estimate for blocks of size 2^( 5) =       0.000458290498
  error estimate for blocks of size 2^( 6) =       0.000465988237
  error estimate for blocks of size 2^( 7) =       0.000470602042

      target function =                  N/A
              le_mean =     -16.910531925264
             les_mean =     286.302179172423
             stat err =       0.000460303352
             autocorr =       1.260850301549
              std dev =       0.579732132188
             le_variance =       0.336089345091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779457
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779457
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409932522
  error estimate for blocks of size 2^( 2) =       0.000421953173
  error estimate for blocks of size 2^( 3) =       0.000434752924
  error estimate for blocks of size 2^( 4) =       0.000446332633
  error estimate for blocks of size 2^( 5) =       0.000458290498
  error estimate for blocks of size 2^( 6) =       0.000465988237
  error estimate for blocks of size 2^( 7) =       0.000470602042

      target function =                  N/A
              le_mean =     -16.910531925264
             les_mean =     286.302179172424
             stat err =       0.000460303352
             autocorr =       1.260850301548
              std dev =       0.579732132188
             le_variance =       0.336089345091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779456
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336155779456
                                         uncertainty =       0.002936548399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409932522
  error estimate for blocks of size 2^( 2) =       0.000421953173
  error estimate for blocks of size 2^( 3) =       0.000434752924
  error estimate for blocks of size 2^( 4) =       0.000446332633
  error estimate for blocks of size 2^( 5) =       0.000458290498
  error estimate for blocks of size 2^( 6) =       0.000465988237
  error estimate for blocks of size 2^( 7) =       0.000470602042

      target function =                  N/A
              le_mean =     -16.910531925264
             les_mean =     286.302179172425
             stat err =       0.000460303352
             autocorr =       1.260850301549
              std dev =       0.579732132187
             le_variance =       0.336089345090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910531925264        initial  <--
     5.9605e+06     5.9605e+07             3.5012e-11       -16.910531925264
     2.3842e+07     2.3842e+08             8.7532e-12       -16.910531925264
     9.5367e+07     9.5367e+08             2.1883e-12       -16.910531925264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8017
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8868
    reference variance = 0.24317
====================================================
  Execution time = 2.4468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332204418132
                                         uncertainty =       0.003852992482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332204418132
                                         uncertainty =       0.003852992482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407540575
  error estimate for blocks of size 2^( 2) =       0.000419426700
  error estimate for blocks of size 2^( 3) =       0.000432339910
  error estimate for blocks of size 2^( 4) =       0.000444541937
  error estimate for blocks of size 2^( 5) =       0.000455191491
  error estimate for blocks of size 2^( 6) =       0.000463109426
  error estimate for blocks of size 2^( 7) =       0.000466909024

      target function =                  N/A
              le_mean =     -16.910250891471
             les_mean =     286.288763686266
             stat err =       0.000457437969
             autocorr =       1.259861235796
              std dev =       0.576349407788
             le_variance =       0.332178639858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691025089147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910250891471       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910250891471       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910250891471       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910250858929       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910250862169       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910250870492       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910250858023       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910250939120       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.713189e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910250891471       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910250891471       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910250891471       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910250985694       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910251009933       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910250892594       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910250832416       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910250617165       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 9.284248e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910250891471       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910250891471       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910250891471       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910250891471       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910250886233       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910250766263       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910249955718       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910250959109       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.318670e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0789e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9737
    reference variance = 0.690939
====================================================
  Execution time = 2.4222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.0000e+06
  Execution time = 2.7179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443524
  error estimate for blocks of size 2^( 2) =       0.000421885722
  error estimate for blocks of size 2^( 3) =       0.000434246932
  error estimate for blocks of size 2^( 4) =       0.000447170556
  error estimate for blocks of size 2^( 5) =       0.000458091901
  error estimate for blocks of size 2^( 6) =       0.000467100668
  error estimate for blocks of size 2^( 7) =       0.000474259836

      target function =                  N/A
              le_mean =     -16.911179212972
             les_mean =     286.324909978262
             stat err =       0.000461655740
             autocorr =       1.265114005215
              std dev =       0.580454798812
             le_variance =       0.336927773464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494994
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494994
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443524
  error estimate for blocks of size 2^( 2) =       0.000421885722
  error estimate for blocks of size 2^( 3) =       0.000434246932
  error estimate for blocks of size 2^( 4) =       0.000447170556
  error estimate for blocks of size 2^( 5) =       0.000458091901
  error estimate for blocks of size 2^( 6) =       0.000467100668
  error estimate for blocks of size 2^( 7) =       0.000474259836

      target function =                  N/A
              le_mean =     -16.911179212972
             les_mean =     286.324909978263
             stat err =       0.000461655740
             autocorr =       1.265114005214
              std dev =       0.580454798813
             le_variance =       0.336927773465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443524
  error estimate for blocks of size 2^( 2) =       0.000421885722
  error estimate for blocks of size 2^( 3) =       0.000434246932
  error estimate for blocks of size 2^( 4) =       0.000447170556
  error estimate for blocks of size 2^( 5) =       0.000458091901
  error estimate for blocks of size 2^( 6) =       0.000467100668
  error estimate for blocks of size 2^( 7) =       0.000474259836

      target function =                  N/A
              le_mean =     -16.911179212972
             les_mean =     286.324909978263
             stat err =       0.000461655740
             autocorr =       1.265114005213
              std dev =       0.580454798813
             le_variance =       0.336927773464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336791494993
                                         uncertainty =       0.004556256654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443524
  error estimate for blocks of size 2^( 2) =       0.000421885722
  error estimate for blocks of size 2^( 3) =       0.000434246932
  error estimate for blocks of size 2^( 4) =       0.000447170556
  error estimate for blocks of size 2^( 5) =       0.000458091901
  error estimate for blocks of size 2^( 6) =       0.000467100668
  error estimate for blocks of size 2^( 7) =       0.000474259836

      target function =                  N/A
              le_mean =     -16.911179212972
             les_mean =     286.324909978262
             stat err =       0.000461655740
             autocorr =       1.265114005212
              std dev =       0.580454798812
             le_variance =       0.336927773464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911179212972        initial  <--
     5.9605e+07     5.9605e+08             3.7132e-12       -16.911179212972
     2.3842e+08     2.3842e+09             9.2842e-13       -16.911179212972
     9.5367e+08     9.5367e+09             2.3187e-13       -16.911179212972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8747
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.297707
====================================================
  Execution time = 2.4400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.9757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347684332905
                                         uncertainty =       0.012500566304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347684332905
                                         uncertainty =       0.012500566304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417026354
  error estimate for blocks of size 2^( 2) =       0.000428572477
  error estimate for blocks of size 2^( 3) =       0.000440440664
  error estimate for blocks of size 2^( 4) =       0.000452686444
  error estimate for blocks of size 2^( 5) =       0.000464144608
  error estimate for blocks of size 2^( 6) =       0.000470304304
  error estimate for blocks of size 2^( 7) =       0.000473914696

      target function =                  N/A
              le_mean =     -16.909524569791
             les_mean =     286.279842962579
             stat err =       0.000465262513
             autocorr =       1.244712701376
              std dev =       0.589764325925
             le_variance =       0.347821960134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690952456979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909524569791       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909524569791       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909524535384       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909524937767       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909524388366       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909524569080       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 3.360924e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909524569791       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909524598923       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909524581746       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909524102854       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909524509544       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909523949226       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 8.394087e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909524569791       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909524569791       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909532310148       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909524569791       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909522775154       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909530783851       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909524436747       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 2.121812e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2903e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.199786
====================================================
  Execution time = 2.3966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3210e-01
  Total weights = 2.0000e+06
  Execution time = 2.7029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407491018
  error estimate for blocks of size 2^( 2) =       0.000419116153
  error estimate for blocks of size 2^( 3) =       0.000431398718
  error estimate for blocks of size 2^( 4) =       0.000443310209
  error estimate for blocks of size 2^( 5) =       0.000454901834
  error estimate for blocks of size 2^( 6) =       0.000463297409
  error estimate for blocks of size 2^( 7) =       0.000470411563

      target function =                  N/A
              le_mean =     -16.910528691970
             les_mean =     286.298078336215
             stat err =       0.000457980254
             autocorr =       1.263157267057
              std dev =       0.576279324907
             le_variance =       0.332097860315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153398
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153398
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407491018
  error estimate for blocks of size 2^( 2) =       0.000419116153
  error estimate for blocks of size 2^( 3) =       0.000431398718
  error estimate for blocks of size 2^( 4) =       0.000443310209
  error estimate for blocks of size 2^( 5) =       0.000454901834
  error estimate for blocks of size 2^( 6) =       0.000463297409
  error estimate for blocks of size 2^( 7) =       0.000470411563

      target function =                  N/A
              le_mean =     -16.910528691970
             les_mean =     286.298078336215
             stat err =       0.000457980254
             autocorr =       1.263157267058
              std dev =       0.576279324907
             le_variance =       0.332097860315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407491018
  error estimate for blocks of size 2^( 2) =       0.000419116153
  error estimate for blocks of size 2^( 3) =       0.000431398718
  error estimate for blocks of size 2^( 4) =       0.000443310209
  error estimate for blocks of size 2^( 5) =       0.000454901834
  error estimate for blocks of size 2^( 6) =       0.000463297409
  error estimate for blocks of size 2^( 7) =       0.000470411563

      target function =                  N/A
              le_mean =     -16.910528691970
             les_mean =     286.298078336215
             stat err =       0.000457980254
             autocorr =       1.263157267056
              std dev =       0.576279324907
             le_variance =       0.332097860315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332155153397
                                         uncertainty =       0.004070107718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407491018
  error estimate for blocks of size 2^( 2) =       0.000419116153
  error estimate for blocks of size 2^( 3) =       0.000431398718
  error estimate for blocks of size 2^( 4) =       0.000443310209
  error estimate for blocks of size 2^( 5) =       0.000454901834
  error estimate for blocks of size 2^( 6) =       0.000463297409
  error estimate for blocks of size 2^( 7) =       0.000470411563

      target function =                  N/A
              le_mean =     -16.910528691970
             les_mean =     286.298078336215
             stat err =       0.000457980254
             autocorr =       1.263157267051
              std dev =       0.576279324907
             le_variance =       0.332097860315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910528691970        initial  <--
     5.9605e+08     5.9605e+09             3.3609e-13       -16.910528691970
     2.3842e+09     2.3842e+10             8.3941e-14       -16.910528691970
     9.5367e+09     9.5367e+10             2.1218e-14       -16.910528691970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5773
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8788
    reference variance = 0.154088
====================================================
  Execution time = 2.4398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3048e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330409754792
                                         uncertainty =       0.003141107656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330409754792
                                         uncertainty =       0.003141107656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406494701
  error estimate for blocks of size 2^( 2) =       0.000418716016
  error estimate for blocks of size 2^( 3) =       0.000431840099
  error estimate for blocks of size 2^( 4) =       0.000443778448
  error estimate for blocks of size 2^( 5) =       0.000456074453
  error estimate for blocks of size 2^( 6) =       0.000465243543
  error estimate for blocks of size 2^( 7) =       0.000470001960

      target function =                  N/A
              le_mean =     -16.910841911894
             les_mean =     286.307049887078
             stat err =       0.000458774601
             autocorr =       1.273763958813
              std dev =       0.574870318642
             le_variance =       0.330475883256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691084191189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841911894       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841911894       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841911894       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910837713538       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910842586206       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910840252282       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910841559001       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910841595797       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 3.462467e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841911894       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841911894       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841911894       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910841911894       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910841647642       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910852779889       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910838990105       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910837878939       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 8.672051e-15

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910841911894       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910841911894       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910841911894       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910841911894       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910840565107       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910851110068       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910781676190       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910848799069       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910809321144       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910863609623       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911581995613       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911289231090       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.913736914314       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911966680677       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911108962555       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.899675154619       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911669243410       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910098680623       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908495846286       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911444356807       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.899478645820       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.913491176266       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.921376407684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905828907721       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.899640857066       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.920522109418       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.913899769021       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913589081670       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.924726799036       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910250391150       residual = 9.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.925551504276       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.908107157694       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.907105628990       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.908610483790       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.926454883264       residual = 2.81e-02           smallest_sin_value = 9.98e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.174588e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0701e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.19305
====================================================
  Execution time = 2.4349e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3360e-01
  Total weights = 2.0000e+06
  Execution time = 2.6980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408409308
  error estimate for blocks of size 2^( 2) =       0.000420320333
  error estimate for blocks of size 2^( 3) =       0.000432319775
  error estimate for blocks of size 2^( 4) =       0.000444399502
  error estimate for blocks of size 2^( 5) =       0.000452837422
  error estimate for blocks of size 2^( 6) =       0.000460706960
  error estimate for blocks of size 2^( 7) =       0.000464582450

      target function =                  N/A
              le_mean =     -16.910426719521
             les_mean =     286.296127995755
             stat err =       0.000455631583
             autocorr =       1.244618861259
              std dev =       0.577577982840
             le_variance =       0.333596326262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408409308
  error estimate for blocks of size 2^( 2) =       0.000420320333
  error estimate for blocks of size 2^( 3) =       0.000432319775
  error estimate for blocks of size 2^( 4) =       0.000444399502
  error estimate for blocks of size 2^( 5) =       0.000452837422
  error estimate for blocks of size 2^( 6) =       0.000460706960
  error estimate for blocks of size 2^( 7) =       0.000464582450

      target function =                  N/A
              le_mean =     -16.910426719521
             les_mean =     286.296127995755
             stat err =       0.000455631583
             autocorr =       1.244618861267
              std dev =       0.577577982840
             le_variance =       0.333596326262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408409308
  error estimate for blocks of size 2^( 2) =       0.000420320333
  error estimate for blocks of size 2^( 3) =       0.000432319775
  error estimate for blocks of size 2^( 4) =       0.000444399502
  error estimate for blocks of size 2^( 5) =       0.000452837422
  error estimate for blocks of size 2^( 6) =       0.000460706960
  error estimate for blocks of size 2^( 7) =       0.000464582450

      target function =                  N/A
              le_mean =     -16.910426719521
             les_mean =     286.296127995755
             stat err =       0.000455631583
             autocorr =       1.244618861261
              std dev =       0.577577982840
             le_variance =       0.333596326262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333595233866
                                         uncertainty =       0.004356129714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408409308
  error estimate for blocks of size 2^( 2) =       0.000420320333
  error estimate for blocks of size 2^( 3) =       0.000432319775
  error estimate for blocks of size 2^( 4) =       0.000444399502
  error estimate for blocks of size 2^( 5) =       0.000452837422
  error estimate for blocks of size 2^( 6) =       0.000460706960
  error estimate for blocks of size 2^( 7) =       0.000464582450

      target function =                  N/A
              le_mean =     -16.910426719521
             les_mean =     286.296127995755
             stat err =       0.000455631583
             autocorr =       1.244618861260
              std dev =       0.577577982840
             le_variance =       0.333596326262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910426719521        initial  <--
     5.9605e+09     5.9605e+10             3.4625e-14       -16.910426719521
     2.3842e+10     2.3842e+11             8.6721e-15       -16.910426719521
     9.5367e+10     9.5367e+11             2.1746e-15       -16.910426719521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.9891
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.240802
====================================================
  Execution time = 2.4274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333163046171
                                         uncertainty =       0.005740312540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333163046171
                                         uncertainty =       0.005740312540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408115632
  error estimate for blocks of size 2^( 2) =       0.000419721282
  error estimate for blocks of size 2^( 3) =       0.000431614924
  error estimate for blocks of size 2^( 4) =       0.000442661370
  error estimate for blocks of size 2^( 5) =       0.000451814495
  error estimate for blocks of size 2^( 6) =       0.000458733094
  error estimate for blocks of size 2^( 7) =       0.000462391601

      target function =                  N/A
              le_mean =     -16.909878621351
             les_mean =     286.277111560461
             stat err =       0.000453900140
             autocorr =       1.236955777939
              std dev =       0.577162661814
             le_variance =       0.333116738192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690987862135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909878621351       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909878621351       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909878621351       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909899883452       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909854283937       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909860619579       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909859017114       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909745934975       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909812183800       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909777131398       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910219339794       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910356349409       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910373845904       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907678622941       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914353323698       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907528035830       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.917419248304       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905792879359       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.915143558234       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905405462242       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903494978044       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909615153015       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.912096262028       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910678854614       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.911117988475       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.913819066884       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.913819613562       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908545527856       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908152490952       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.902854377122       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911346784442       residual = 3.59e-04           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 2.877074e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909878621351       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909878621351       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909878621351       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909878621351       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909727549078       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909878621351       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909739662108       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909981840795       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910142310065       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908971600930       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909504082458       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910942557715       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910696671651       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.900955039119       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893254088929       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905227375341       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907821808233       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.917528287628       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.913561722012       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.921458776994       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.885936329695       residual = 7.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.864939887269       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.899032614878       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.939271263274       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903028975771       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902625991929       residual = 7.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.896962428402       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913599788191       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.916280121677       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.934427922811       residual = 8.96e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.930469393752       residual = 6.58e-02           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.858297581302       residual = 3.77e-01           smallest_sin_value = 9.95e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 5.927892e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909878621351       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909878621351       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909878621351       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 3.628727e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0733e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9625
    reference variance = 0.317132
====================================================
  Execution time = 2.4607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4036e-01
  Total weights = 2.0000e+06
  Execution time = 2.7012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531069
  error estimate for blocks of size 2^( 2) =       0.000424668928
  error estimate for blocks of size 2^( 3) =       0.000437930379
  error estimate for blocks of size 2^( 4) =       0.000450373150
  error estimate for blocks of size 2^( 5) =       0.000462398859
  error estimate for blocks of size 2^( 6) =       0.000472269684
  error estimate for blocks of size 2^( 7) =       0.000478131845

      target function =                  N/A
              le_mean =     -16.909546112712
             les_mean =     286.273113333076
             stat err =       0.000465793384
             autocorr =       1.274891742516
              std dev =       0.583407032285
             le_variance =       0.340363765320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531069
  error estimate for blocks of size 2^( 2) =       0.000424668928
  error estimate for blocks of size 2^( 3) =       0.000437930379
  error estimate for blocks of size 2^( 4) =       0.000450373150
  error estimate for blocks of size 2^( 5) =       0.000462398859
  error estimate for blocks of size 2^( 6) =       0.000472269684
  error estimate for blocks of size 2^( 7) =       0.000478131845

      target function =                  N/A
              le_mean =     -16.909546112712
             les_mean =     286.273113333076
             stat err =       0.000465793384
             autocorr =       1.274891742516
              std dev =       0.583407032285
             le_variance =       0.340363765320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531069
  error estimate for blocks of size 2^( 2) =       0.000424668928
  error estimate for blocks of size 2^( 3) =       0.000437930379
  error estimate for blocks of size 2^( 4) =       0.000450373150
  error estimate for blocks of size 2^( 5) =       0.000462398859
  error estimate for blocks of size 2^( 6) =       0.000472269684
  error estimate for blocks of size 2^( 7) =       0.000478131845

      target function =                  N/A
              le_mean =     -16.909546112712
             les_mean =     286.273113333076
             stat err =       0.000465793384
             autocorr =       1.274891742516
              std dev =       0.583407032285
             le_variance =       0.340363765320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340414824207
                                         uncertainty =       0.005913113208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531069
  error estimate for blocks of size 2^( 2) =       0.000424668928
  error estimate for blocks of size 2^( 3) =       0.000437930379
  error estimate for blocks of size 2^( 4) =       0.000450373150
  error estimate for blocks of size 2^( 5) =       0.000462398859
  error estimate for blocks of size 2^( 6) =       0.000472269684
  error estimate for blocks of size 2^( 7) =       0.000478131845

      target function =                  N/A
              le_mean =     -16.909546112712
             les_mean =     286.273113333076
             stat err =       0.000465793384
             autocorr =       1.274891742515
              std dev =       0.583407032285
             le_variance =       0.340363765320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909546112712        initial
     5.9605e+10     5.9605e+11             2.8771e-15       -16.909546112712
     2.3842e+11     2.3842e+12             5.9279e-16       -16.909546112712
     9.5367e+11     9.5367e+12             3.6287e-17       -16.909546112712  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+11     and shift_s =   9.5367e+12
*****************************************************************************

  Execution time = 3.8200e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9393
    reference variance = 0.165835
====================================================
  Execution time = 2.4307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330549610475
                                         uncertainty =       0.004660106044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330549610475
                                         uncertainty =       0.004660106044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406600398
  error estimate for blocks of size 2^( 2) =       0.000418510897
  error estimate for blocks of size 2^( 3) =       0.000430876533
  error estimate for blocks of size 2^( 4) =       0.000442406566
  error estimate for blocks of size 2^( 5) =       0.000452693401
  error estimate for blocks of size 2^( 6) =       0.000459932503
  error estimate for blocks of size 2^( 7) =       0.000463907602

      target function =                  N/A
              le_mean =     -16.910785055263
             les_mean =     286.305298786775
             stat err =       0.000454735018
             autocorr =       1.250780784864
              std dev =       0.575019796869
             le_variance =       0.330647766792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078505526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910785055263       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910785055263       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910785055263       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910785055263       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910785055263       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910835209573       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908250536140       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911163143139       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911864754561       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909444271080       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910523415897       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911892851028       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.919392114351       residual = 9.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911247371406       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.912939215877       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908075950541       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904489956517       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.915916954840       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910891773959       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.927296180331       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.896734613431       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.877951422849       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.927912487715       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893969439861       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910879057290       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908931029958       residual = 7.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.891118863421       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.936464266121       residual = 9.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.928854077532       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.939379426082       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.893230519745       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.897070512265       residual = 3.19e-02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.872194614408       residual = 1.87e-01           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 8.621443e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910785055263       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910785055263       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910785055263       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910785055263       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910681394699       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910668041783       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910773633835       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910734498412       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911352048282       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908885620113       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.916105038645       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908131157904       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.923478082577       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.914014466168       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.922062553106       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.884043735268       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.969190385589       residual = 4.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.930124307765       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.896718870663       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.860013732109       residual = 3.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.882008745546       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.010663097819       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.865658440254       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.922781549389       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.860582716243       residual = 3.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.732395326430       residual = 3.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.951076498682       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.956054374460       residual = 3.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.876119565614       residual = 4.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.935893074536       residual = 8.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905452158560       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.502571243091       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.919093252513       residual = 5.20e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -17.010145618366       residual = 1.59e+00           smallest_sin_value = 9.96e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 5.302086e-17

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910785055263       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910785055263       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910785055263       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 1.325521e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0669e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8341
    reference variance = 0.313151
====================================================
  Execution time = 2.4230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2347e-01
  Total weights = 2.0000e+06
  Execution time = 2.7260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402160025
  error estimate for blocks of size 2^( 2) =       0.000413703673
  error estimate for blocks of size 2^( 3) =       0.000426304522
  error estimate for blocks of size 2^( 4) =       0.000438104163
  error estimate for blocks of size 2^( 5) =       0.000449117973
  error estimate for blocks of size 2^( 6) =       0.000458088621
  error estimate for blocks of size 2^( 7) =       0.000464194032

      target function =                  N/A
              le_mean =     -16.910972395261
             les_mean =     286.304452562429
             stat err =       0.000452376197
             autocorr =       1.265323848005
              std dev =       0.568740161137
             le_variance =       0.323465370890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402160025
  error estimate for blocks of size 2^( 2) =       0.000413703673
  error estimate for blocks of size 2^( 3) =       0.000426304522
  error estimate for blocks of size 2^( 4) =       0.000438104163
  error estimate for blocks of size 2^( 5) =       0.000449117973
  error estimate for blocks of size 2^( 6) =       0.000458088621
  error estimate for blocks of size 2^( 7) =       0.000464194032

      target function =                  N/A
              le_mean =     -16.910972395261
             les_mean =     286.304452562429
             stat err =       0.000452376197
             autocorr =       1.265323848005
              std dev =       0.568740161137
             le_variance =       0.323465370890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402160025
  error estimate for blocks of size 2^( 2) =       0.000413703673
  error estimate for blocks of size 2^( 3) =       0.000426304522
  error estimate for blocks of size 2^( 4) =       0.000438104163
  error estimate for blocks of size 2^( 5) =       0.000449117973
  error estimate for blocks of size 2^( 6) =       0.000458088621
  error estimate for blocks of size 2^( 7) =       0.000464194032

      target function =                  N/A
              le_mean =     -16.910972395261
             les_mean =     286.304452562429
             stat err =       0.000452376197
             autocorr =       1.265323848005
              std dev =       0.568740161137
             le_variance =       0.323465370890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525891505
                                         uncertainty =       0.003728553518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402160025
  error estimate for blocks of size 2^( 2) =       0.000413703673
  error estimate for blocks of size 2^( 3) =       0.000426304522
  error estimate for blocks of size 2^( 4) =       0.000438104163
  error estimate for blocks of size 2^( 5) =       0.000449117973
  error estimate for blocks of size 2^( 6) =       0.000458088621
  error estimate for blocks of size 2^( 7) =       0.000464194032

      target function =                  N/A
              le_mean =     -16.910972395261
             les_mean =     286.304452562429
             stat err =       0.000452376197
             autocorr =       1.265323848006
              std dev =       0.568740161137
             le_variance =       0.323465370890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910972395261        initial
     2.3842e+11     2.3842e+12             8.6214e-16       -16.910972395261
     9.5367e+11     9.5367e+12             5.3021e-17       -16.910972395261
     3.8147e+12     3.8147e+13             1.3255e-17       -16.910972395261  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+12     and shift_s =   3.8147e+13
*****************************************************************************

  Execution time = 3.7844e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.214458
====================================================
  Execution time = 2.4308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326889779878
                                         uncertainty =       0.002976157114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326889779878
                                         uncertainty =       0.002976157114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404268871
  error estimate for blocks of size 2^( 2) =       0.000416125606
  error estimate for blocks of size 2^( 3) =       0.000428329146
  error estimate for blocks of size 2^( 4) =       0.000439439875
  error estimate for blocks of size 2^( 5) =       0.000448286031
  error estimate for blocks of size 2^( 6) =       0.000454440032
  error estimate for blocks of size 2^( 7) =       0.000458596170

      target function =                  N/A
              le_mean =     -16.910870648287
             les_mean =     286.304412560350
             stat err =       0.000450190527
             autocorr =       1.240086844348
              std dev =       0.571722520697
             le_variance =       0.326866640672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691087064829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.80e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.80e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910870648287       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0840e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.276557
====================================================
  Execution time = 2.5956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3732e-01
  Total weights = 2.0000e+06
  Execution time = 2.7173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410682344
  error estimate for blocks of size 2^( 2) =       0.000422395010
  error estimate for blocks of size 2^( 3) =       0.000434401446
  error estimate for blocks of size 2^( 4) =       0.000446277141
  error estimate for blocks of size 2^( 5) =       0.000456772728
  error estimate for blocks of size 2^( 6) =       0.000463736401
  error estimate for blocks of size 2^( 7) =       0.000469009620

      target function =                  N/A
              le_mean =     -16.909719822137
             les_mean =     286.275944270440
             stat err =       0.000458948973
             autocorr =       1.248868578641
              std dev =       0.580792541206
             le_variance =       0.337319975920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410682344
  error estimate for blocks of size 2^( 2) =       0.000422395010
  error estimate for blocks of size 2^( 3) =       0.000434401446
  error estimate for blocks of size 2^( 4) =       0.000446277141
  error estimate for blocks of size 2^( 5) =       0.000456772728
  error estimate for blocks of size 2^( 6) =       0.000463736401
  error estimate for blocks of size 2^( 7) =       0.000469009620

      target function =                  N/A
              le_mean =     -16.909719822137
             les_mean =     286.275944270440
             stat err =       0.000458948973
             autocorr =       1.248868578641
              std dev =       0.580792541206
             le_variance =       0.337319975920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410682344
  error estimate for blocks of size 2^( 2) =       0.000422395010
  error estimate for blocks of size 2^( 3) =       0.000434401446
  error estimate for blocks of size 2^( 4) =       0.000446277141
  error estimate for blocks of size 2^( 5) =       0.000456772728
  error estimate for blocks of size 2^( 6) =       0.000463736401
  error estimate for blocks of size 2^( 7) =       0.000469009620

      target function =                  N/A
              le_mean =     -16.909719822137
             les_mean =     286.275944270440
             stat err =       0.000458948973
             autocorr =       1.248868578641
              std dev =       0.580792541206
             le_variance =       0.337319975920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332232330
                                         uncertainty =       0.005356731402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410682344
  error estimate for blocks of size 2^( 2) =       0.000422395010
  error estimate for blocks of size 2^( 3) =       0.000434401446
  error estimate for blocks of size 2^( 4) =       0.000446277141
  error estimate for blocks of size 2^( 5) =       0.000456772728
  error estimate for blocks of size 2^( 6) =       0.000463736401
  error estimate for blocks of size 2^( 7) =       0.000469009620

      target function =                  N/A
              le_mean =     -16.909719822137
             les_mean =     286.275944270440
             stat err =       0.000458948973
             autocorr =       1.248868578641
              std dev =       0.580792541206
             le_variance =       0.337319975920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909719822137        initial  <--
     9.5367e+11     9.5367e+12             0.0000e+00       -16.909719822137
     3.8147e+12     3.8147e+13             0.0000e+00       -16.909719822137
     1.5259e+13     1.5259e+14             0.0000e+00       -16.909719822137

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5863
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9821
    reference variance = 0.235795
====================================================
  Execution time = 2.4255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3827e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338357130457
                                         uncertainty =       0.004881999421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338357130457
                                         uncertainty =       0.004881999421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411261735
  error estimate for blocks of size 2^( 2) =       0.000422812238
  error estimate for blocks of size 2^( 3) =       0.000435504627
  error estimate for blocks of size 2^( 4) =       0.000447000456
  error estimate for blocks of size 2^( 5) =       0.000457549769
  error estimate for blocks of size 2^( 6) =       0.000464784795
  error estimate for blocks of size 2^( 7) =       0.000468242625

      target function =                  N/A
              le_mean =     -16.910762544950
             les_mean =     286.312162111628
             stat err =       0.000459394411
             autocorr =       1.247770772372
              std dev =       0.581611923084
             le_variance =       0.338272429074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691076254495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910762544950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0566e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.200219
====================================================
  Execution time = 2.3871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3473e-01
  Total weights = 2.0000e+06
  Execution time = 2.7193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409103921
  error estimate for blocks of size 2^( 2) =       0.000421207374
  error estimate for blocks of size 2^( 3) =       0.000433335800
  error estimate for blocks of size 2^( 4) =       0.000445078565
  error estimate for blocks of size 2^( 5) =       0.000456539465
  error estimate for blocks of size 2^( 6) =       0.000466863200
  error estimate for blocks of size 2^( 7) =       0.000470489072

      target function =                  N/A
              le_mean =     -16.910290976260
             les_mean =     286.292672770394
             stat err =       0.000459742576
             autocorr =       1.262880233239
              std dev =       0.578560313161
             le_variance =       0.334732035965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409103921
  error estimate for blocks of size 2^( 2) =       0.000421207374
  error estimate for blocks of size 2^( 3) =       0.000433335800
  error estimate for blocks of size 2^( 4) =       0.000445078565
  error estimate for blocks of size 2^( 5) =       0.000456539465
  error estimate for blocks of size 2^( 6) =       0.000466863200
  error estimate for blocks of size 2^( 7) =       0.000470489072

      target function =                  N/A
              le_mean =     -16.910290976260
             les_mean =     286.292672770394
             stat err =       0.000459742576
             autocorr =       1.262880233239
              std dev =       0.578560313161
             le_variance =       0.334732035965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409103921
  error estimate for blocks of size 2^( 2) =       0.000421207374
  error estimate for blocks of size 2^( 3) =       0.000433335800
  error estimate for blocks of size 2^( 4) =       0.000445078565
  error estimate for blocks of size 2^( 5) =       0.000456539465
  error estimate for blocks of size 2^( 6) =       0.000466863200
  error estimate for blocks of size 2^( 7) =       0.000470489072

      target function =                  N/A
              le_mean =     -16.910290976260
             les_mean =     286.292672770394
             stat err =       0.000459742576
             autocorr =       1.262880233239
              std dev =       0.578560313161
             le_variance =       0.334732035965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334815379338
                                         uncertainty =       0.003607476147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409103921
  error estimate for blocks of size 2^( 2) =       0.000421207374
  error estimate for blocks of size 2^( 3) =       0.000433335800
  error estimate for blocks of size 2^( 4) =       0.000445078565
  error estimate for blocks of size 2^( 5) =       0.000456539465
  error estimate for blocks of size 2^( 6) =       0.000466863200
  error estimate for blocks of size 2^( 7) =       0.000470489072

      target function =                  N/A
              le_mean =     -16.910290976260
             les_mean =     286.292672770394
             stat err =       0.000459742576
             autocorr =       1.262880233239
              std dev =       0.578560313161
             le_variance =       0.334732035965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910290976260        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -16.910290976260
     3.8147e+13     3.8147e+14             0.0000e+00       -16.910290976260
     1.5259e+14     1.5259e+15             0.0000e+00       -16.910290976260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5322
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.7904
    reference variance = 0.555131
====================================================
  Execution time = 2.4414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335844040341
                                         uncertainty =       0.009079017671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335844040341
                                         uncertainty =       0.009079017671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409767157
  error estimate for blocks of size 2^( 2) =       0.000421100882
  error estimate for blocks of size 2^( 3) =       0.000432648046
  error estimate for blocks of size 2^( 4) =       0.000444137003
  error estimate for blocks of size 2^( 5) =       0.000454157937
  error estimate for blocks of size 2^( 6) =       0.000461149277
  error estimate for blocks of size 2^( 7) =       0.000467420267

      target function =                  N/A
              le_mean =     -16.910600332654
             les_mean =     286.304221689109
             stat err =       0.000456716121
             autocorr =       1.242276841435
              std dev =       0.579498271158
             le_variance =       0.335818246275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691060033265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910600332654       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0809e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9823
    reference variance = 0.275259
====================================================
  Execution time = 2.4142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2973e-01
  Total weights = 2.0000e+06
  Execution time = 2.7018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406035002
  error estimate for blocks of size 2^( 2) =       0.000417847884
  error estimate for blocks of size 2^( 3) =       0.000430093324
  error estimate for blocks of size 2^( 4) =       0.000442186657
  error estimate for blocks of size 2^( 5) =       0.000451765573
  error estimate for blocks of size 2^( 6) =       0.000457351008
  error estimate for blocks of size 2^( 7) =       0.000464016432

      target function =                  N/A
              le_mean =     -16.911193970350
             les_mean =     286.318210183883
             stat err =       0.000453829917
             autocorr =       1.249278589761
              std dev =       0.574220206840
             le_variance =       0.329728845943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406035002
  error estimate for blocks of size 2^( 2) =       0.000417847884
  error estimate for blocks of size 2^( 3) =       0.000430093324
  error estimate for blocks of size 2^( 4) =       0.000442186657
  error estimate for blocks of size 2^( 5) =       0.000451765573
  error estimate for blocks of size 2^( 6) =       0.000457351008
  error estimate for blocks of size 2^( 7) =       0.000464016432

      target function =                  N/A
              le_mean =     -16.911193970350
             les_mean =     286.318210183883
             stat err =       0.000453829917
             autocorr =       1.249278589761
              std dev =       0.574220206840
             le_variance =       0.329728845943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406035002
  error estimate for blocks of size 2^( 2) =       0.000417847884
  error estimate for blocks of size 2^( 3) =       0.000430093324
  error estimate for blocks of size 2^( 4) =       0.000442186657
  error estimate for blocks of size 2^( 5) =       0.000451765573
  error estimate for blocks of size 2^( 6) =       0.000457351008
  error estimate for blocks of size 2^( 7) =       0.000464016432

      target function =                  N/A
              le_mean =     -16.911193970350
             les_mean =     286.318210183883
             stat err =       0.000453829917
             autocorr =       1.249278589761
              std dev =       0.574220206840
             le_variance =       0.329728845943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329850624650
                                         uncertainty =       0.003439052962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406035002
  error estimate for blocks of size 2^( 2) =       0.000417847884
  error estimate for blocks of size 2^( 3) =       0.000430093324
  error estimate for blocks of size 2^( 4) =       0.000442186657
  error estimate for blocks of size 2^( 5) =       0.000451765573
  error estimate for blocks of size 2^( 6) =       0.000457351008
  error estimate for blocks of size 2^( 7) =       0.000464016432

      target function =                  N/A
              le_mean =     -16.911193970350
             les_mean =     286.318210183883
             stat err =       0.000453829917
             autocorr =       1.249278589761
              std dev =       0.574220206840
             le_variance =       0.329728845943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911193970350        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -16.911193970350
     3.8147e+14     3.8147e+15             0.0000e+00       -16.911193970350
     1.5259e+15     1.5259e+16             0.0000e+00       -16.911193970350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.8010
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27976 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.286707
====================================================
  Execution time = 2.4310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332038594763
                                         uncertainty =       0.003939088399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332038594763
                                         uncertainty =       0.003939088399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407405606
  error estimate for blocks of size 2^( 2) =       0.000419409957
  error estimate for blocks of size 2^( 3) =       0.000431944827
  error estimate for blocks of size 2^( 4) =       0.000443825486
  error estimate for blocks of size 2^( 5) =       0.000455418560
  error estimate for blocks of size 2^( 6) =       0.000463503046
  error estimate for blocks of size 2^( 7) =       0.000468128383

      target function =                  N/A
              le_mean =     -16.909651066341
             les_mean =     286.268257675326
             stat err =       0.000457718869
             autocorr =       1.262244915232
              std dev =       0.576158533653
             le_variance =       0.331958655901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690965106634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909651066341       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0680e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.241917
====================================================
  Execution time = 2.4052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5392e-01
  Total weights = 2.0000e+06
  Execution time = 2.6900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420663328
  error estimate for blocks of size 2^( 2) =       0.000431757097
  error estimate for blocks of size 2^( 3) =       0.000444159686
  error estimate for blocks of size 2^( 4) =       0.000455390263
  error estimate for blocks of size 2^( 5) =       0.000466054530
  error estimate for blocks of size 2^( 6) =       0.000473579072
  error estimate for blocks of size 2^( 7) =       0.000481942520

      target function =                  N/A
              le_mean =     -16.910741935857
             les_mean =     286.327107915023
             stat err =       0.000469241596
             autocorr =       1.244295987367
              std dev =       0.594907783454
             le_variance =       0.353915270814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420663328
  error estimate for blocks of size 2^( 2) =       0.000431757097
  error estimate for blocks of size 2^( 3) =       0.000444159686
  error estimate for blocks of size 2^( 4) =       0.000455390263
  error estimate for blocks of size 2^( 5) =       0.000466054530
  error estimate for blocks of size 2^( 6) =       0.000473579072
  error estimate for blocks of size 2^( 7) =       0.000481942520

      target function =                  N/A
              le_mean =     -16.910741935857
             les_mean =     286.327107915023
             stat err =       0.000469241596
             autocorr =       1.244295987367
              std dev =       0.594907783454
             le_variance =       0.353915270814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420663328
  error estimate for blocks of size 2^( 2) =       0.000431757097
  error estimate for blocks of size 2^( 3) =       0.000444159686
  error estimate for blocks of size 2^( 4) =       0.000455390263
  error estimate for blocks of size 2^( 5) =       0.000466054530
  error estimate for blocks of size 2^( 6) =       0.000473579072
  error estimate for blocks of size 2^( 7) =       0.000481942520

      target function =                  N/A
              le_mean =     -16.910741935857
             les_mean =     286.327107915023
             stat err =       0.000469241596
             autocorr =       1.244295987367
              std dev =       0.594907783454
             le_variance =       0.353915270814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353975388104
                                         uncertainty =       0.010852686012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420663328
  error estimate for blocks of size 2^( 2) =       0.000431757097
  error estimate for blocks of size 2^( 3) =       0.000444159686
  error estimate for blocks of size 2^( 4) =       0.000455390263
  error estimate for blocks of size 2^( 5) =       0.000466054530
  error estimate for blocks of size 2^( 6) =       0.000473579072
  error estimate for blocks of size 2^( 7) =       0.000481942520

      target function =                  N/A
              le_mean =     -16.910741935857
             les_mean =     286.327107915023
             stat err =       0.000469241596
             autocorr =       1.244295987367
              std dev =       0.594907783454
             le_variance =       0.353915270814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910741935857        initial  <--
     9.5367e+14     9.5367e+15             0.0000e+00       -16.910741935857
     3.8147e+15     3.8147e+16             0.0000e+00       -16.910741935857
     1.5259e+16     1.5259e+17             0.0000e+00       -16.910741935857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5968
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.082931e-01 1 1  ON 0
 uu_1                 1.425284e-01 1 1  ON 1
 uu_2                 4.384802e-02 1 1  ON 2
 uu_3                -1.971487e-02 1 1  ON 3
 uu_4                -6.883763e-02 1 1  ON 4
 uu_5                -1.039250e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.427852e-01 1 1  ON 7
 uu_8                -1.341349e-01 1 1  ON 8
 uu_9                -1.064379e-01 1 1  ON 9
 ud_0                 4.382216e-01 1 1  ON 10
 ud_1                 1.805404e-01 1 1  ON 11
 ud_2                 6.627707e-02 1 1  ON 12
 ud_3                -2.937955e-03 1 1  ON 13
 ud_4                -5.896497e-02 1 1  ON 14
 ud_5                -1.020673e-01 1 1  ON 15
 ud_6                -1.322142e-01 1 1  ON 16
 ud_7                -1.522240e-01 1 1  ON 17
 ud_8                -1.562185e-01 1 1  ON 18
 ud_9                -1.478752e-01 1 1  ON 19
 eO_0                -7.603879e-01 1 1  ON 20
 eO_1                -4.435497e-01 1 1  ON 21
 eO_2                -2.476257e-02 1 1  ON 22
 eO_3                 3.023262e-01 1 1  ON 23
 eO_4                 5.303561e-01 1 1  ON 24
 eO_5                 4.927296e-01 1 1  ON 25
 eO_6                 2.640639e-01 1 1  ON 26
 eO_7                -4.057136e-02 1 1  ON 27
 eO_8                -2.285136e-01 1 1  ON 28
 eO_9                -9.032931e-02 1 1  ON 29
eH1_0                -2.542037e-01 1 1  ON 30
eH1_1                -1.504170e-01 1 1  ON 31
eH1_2                -1.054758e-01 1 1  ON 32
eH1_3                -5.332200e-02 1 1  ON 33
eH1_4                -1.854860e-03 1 1  ON 34
eH1_5                 3.355772e-02 1 1  ON 35
eH1_6                 9.692389e-02 1 1  ON 36
eH1_7                 1.565973e-01 1 1  ON 37
eH1_8                 1.898948e-01 1 1  ON 38
eH1_9                 8.545936e-02 1 1  ON 39
eH2_0                -2.478345e-01 1 1  ON 40
eH2_1                -1.443391e-01 1 1  ON 41
eH2_2                -9.967375e-02 1 1  ON 42
eH2_3                -4.743523e-02 1 1  ON 43
eH2_4                 3.772618e-03 1 1  ON 44
eH2_5                 3.875896e-02 1 1  ON 45
eH2_6                 1.009219e-01 1 1  ON 46
eH2_7                 1.585011e-01 1 1  ON 47
eH2_8                 1.906394e-01 1 1  ON 48
eH2_9                 6.358449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8284e+01 secs
  Total Execution time = 2.7584e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
